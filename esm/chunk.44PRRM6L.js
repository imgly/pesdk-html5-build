var os=Object.defineProperty,Ip=Object.prototype.hasOwnProperty,T=Object.assign,De=(e,t)=>()=>(t||(t={exports:{}},e(t.exports,t)),t.exports),Cl=e=>os(e,"__esModule",{value:!0}),Fe=(e,t)=>{Cl(e);for(var i in t)os(e,i,{get:t[i],enumerable:!0})},Pp=(e,t)=>{if(Cl(e),typeof t=="object"||typeof t=="function")for(let i in t)!Ip.call(e,i)&&i!=="default"&&os(e,i,{get:()=>t[i],enumerable:!0});return e},Ne=e=>e&&e.__esModule?e:Pp(os({},"default",{value:e,enumerable:!0}),e),Ae=(e,t,i)=>new Promise((r,o)=>{var s=l=>{try{a(i.next(l))}catch(h){o(h)}},n=l=>{try{a(i.throw(l))}catch(h){o(h)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(s,n);a((i=i.apply(e,t)).next())});var qi=De((Vi,Hi)=>{(function(e){var t=typeof Vi=="object"&&Vi&&!Vi.nodeType&&Vi,i=typeof Hi=="object"&&Hi&&!Hi.nodeType&&Hi,r=typeof global=="object"&&global;(r.global===r||r.window===r||r.self===r)&&(e=r);var o,s=2147483647,n=36,a=1,l=26,h=38,c=700,p=72,d=128,m="-",x=/^xn--/,b=/[^\x20-\x7E]/,g=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},_=n-a,f=Math.floor,D=String.fromCharCode,v;function w(A){throw RangeError(y[A])}function I(A,M){for(var G=A.length,ue=[];G--;)ue[G]=M(A[G]);return ue}function P(A,M){var G=A.split("@"),ue="";G.length>1&&(ue=G[0]+"@",A=G[1]),A=A.replace(g,".");var Y=A.split("."),ne=I(Y,M).join(".");return ue+ne}function N(A){for(var M=[],G=0,ue=A.length,Y,ne;G<ue;)Y=A.charCodeAt(G++),Y>=55296&&Y<=56319&&G<ue?(ne=A.charCodeAt(G++),(ne&64512)==56320?M.push(((Y&1023)<<10)+(ne&1023)+65536):(M.push(Y),G--)):M.push(Y);return M}function H(A){return I(A,function(M){var G="";return M>65535&&(M-=65536,G+=D(M>>>10&1023|55296),M=56320|M&1023),G+=D(M),G}).join("")}function q(A){return A-48<10?A-22:A-65<26?A-65:A-97<26?A-97:n}function J(A,M){return A+22+75*(A<26)-((M!=0)<<5)}function ie(A,M,G){var ue=0;for(A=G?f(A/c):A>>1,A+=f(A/M);A>_*l>>1;ue+=n)A=f(A/_);return f(ue+(_+1)*A/(A+h))}function ae(A){var M=[],G=A.length,ue,Y=0,ne=d,ge=p,Oe,Le,Nt,Ht,Ye,xt,kt,li,Ci;for(Oe=A.lastIndexOf(m),Oe<0&&(Oe=0),Le=0;Le<Oe;++Le)A.charCodeAt(Le)>=128&&w("not-basic"),M.push(A.charCodeAt(Le));for(Nt=Oe>0?Oe+1:0;Nt<G;){for(Ht=Y,Ye=1,xt=n;!(Nt>=G&&w("invalid-input"),kt=q(A.charCodeAt(Nt++)),(kt>=n||kt>f((s-Y)/Ye))&&w("overflow"),Y+=kt*Ye,li=xt<=ge?a:xt>=ge+l?l:xt-ge,kt<li);xt+=n)Ci=n-li,Ye>f(s/Ci)&&w("overflow"),Ye*=Ci;ue=M.length+1,ge=ie(Y-Ht,ue,Ht==0),f(Y/ue)>s-ne&&w("overflow"),ne+=f(Y/ue),Y%=ue,M.splice(Y++,0,ne)}return H(M)}function ke(A){var M,G,ue,Y,ne,ge,Oe,Le,Nt,Ht,Ye,xt=[],kt,li,Ci,Bn;for(A=N(A),kt=A.length,M=d,G=0,ne=p,ge=0;ge<kt;++ge)Ye=A[ge],Ye<128&&xt.push(D(Ye));for(ue=Y=xt.length,Y&&xt.push(m);ue<kt;){for(Oe=s,ge=0;ge<kt;++ge)Ye=A[ge],Ye>=M&&Ye<Oe&&(Oe=Ye);for(li=ue+1,Oe-M>f((s-G)/li)&&w("overflow"),G+=(Oe-M)*li,M=Oe,ge=0;ge<kt;++ge)if(Ye=A[ge],Ye<M&&++G>s&&w("overflow"),Ye==M){for(Le=G,Nt=n;!(Ht=Nt<=ne?a:Nt>=ne+l?l:Nt-ne,Le<Ht);Nt+=n)Bn=Le-Ht,Ci=n-Ht,xt.push(D(J(Ht+Bn%Ci,0))),Le=f(Bn/Ci);xt.push(D(J(Le,0))),ne=ie(G,li,ue==Y),G=0,++ue}++G,++M}return xt.join("")}function Pe(A){return P(A,function(M){return x.test(M)?ae(M.slice(4).toLowerCase()):M})}function de(A){return P(A,function(M){return b.test(M)?"xn--"+ke(M):M})}if(o={version:"1.3.2",ucs2:{decode:N,encode:H},decode:ae,encode:ke,toASCII:de,toUnicode:Pe},typeof define=="function"&&typeof define.amd=="object"&&define.amd)define("punycode",function(){return o});else if(t&&i)if(Hi.exports==t)i.exports=o;else for(v in o)o.hasOwnProperty(v)&&(t[v]=o[v]);else e.punycode=o})(Vi)});var Yi=De((Yy,El)=>{"use strict";El.exports={isString:function(e){return typeof e=="string"},isObject:function(e){return typeof e=="object"&&e!==null},isNull:function(e){return e===null},isNullOrUndefined:function(e){return e==null}}});var Xi=De((Xy,Rl)=>{"use strict";function Bp(e,t){return Object.prototype.hasOwnProperty.call(e,t)}Rl.exports=function(e,t,i,r){t=t||"&",i=i||"=";var o={};if(typeof e!="string"||e.length===0)return o;var s=/\+/g;e=e.split(t);var n=1e3;r&&typeof r.maxKeys=="number"&&(n=r.maxKeys);var a=e.length;n>0&&a>n&&(a=n);for(var l=0;l<a;++l){var h=e[l].replace(s,"%20"),c=h.indexOf(i),p,d,m,x;c>=0?(p=h.substr(0,c),d=h.substr(c+1)):(p=h,d=""),m=decodeURIComponent(p),x=decodeURIComponent(d),Bp(o,m)?Array.isArray(o[m])?o[m].push(x):o[m]=[o[m],x]:o[m]=x}return o}});var Qi=De((Qy,kl)=>{"use strict";var Co=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};kl.exports=function(e,t,i,r){return t=t||"&",i=i||"=",e===null&&(e=void 0),typeof e=="object"?Object.keys(e).map(function(o){var s=encodeURIComponent(Co(o))+i;return Array.isArray(e[o])?e[o].map(function(n){return s+encodeURIComponent(Co(n))}).join(t):s+encodeURIComponent(Co(e[o]))}).join(t):r?encodeURIComponent(Co(r))+i+encodeURIComponent(Co(e)):""}});var Zi=De(Eo=>{"use strict";Eo.decode=Eo.parse=Xi();Eo.encode=Eo.stringify=Qi()});var er=De(Ji=>{"use strict";var Mp=qi(),zt=Yi();Ji.parse=Ro;Ji.resolve=Lp;Ji.resolveObject=Np;Ji.format=zp;Ji.Url=vt;function vt(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Up=/^([a-z0-9.+-]+:)/i,Gp=/:[0-9]*$/,jp=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Kp=["<",">",'"',"`"," ","\r",`
`,"	"],Wp=["{","}","|","\\","^","`"].concat(Kp),Mn=["'"].concat(Wp),Ol=["%","/","?",";","#"].concat(Mn),Fl=["/","?","#"],Vp=255,Al=/^[+a-z0-9A-Z_-]{0,63}$/,Hp=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,qp={javascript:!0,"javascript:":!0},Ln={javascript:!0,"javascript:":!0},$i={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Nn=Zi();function Ro(e,t,i){if(e&&zt.isObject(e)&&e instanceof vt)return e;var r=new vt;return r.parse(e,t,i),r}vt.prototype.parse=function(e,t,i){if(!zt.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),o=r!==-1&&r<e.indexOf("#")?"?":"#",s=e.split(o),n=/\\/g;s[0]=s[0].replace(n,"/"),e=s.join(o);var a=e;if(a=a.trim(),!i&&e.split("#").length===1){var l=jp.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],t?this.query=Nn.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=Up.exec(a);if(h){h=h[0];var c=h.toLowerCase();this.protocol=c,a=a.substr(h.length)}if(i||h||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var p=a.substr(0,2)==="//";p&&!(h&&Ln[h])&&(a=a.substr(2),this.slashes=!0)}if(!Ln[h]&&(p||h&&!$i[h])){for(var d=-1,m=0;m<Fl.length;m++){var x=a.indexOf(Fl[m]);x!==-1&&(d===-1||x<d)&&(d=x)}var b,g;d===-1?g=a.lastIndexOf("@"):g=a.lastIndexOf("@",d),g!==-1&&(b=a.slice(0,g),a=a.slice(g+1),this.auth=decodeURIComponent(b)),d=-1;for(var m=0;m<Ol.length;m++){var x=a.indexOf(Ol[m]);x!==-1&&(d===-1||x<d)&&(d=x)}d===-1&&(d=a.length),this.host=a.slice(0,d),a=a.slice(d),this.parseHost(),this.hostname=this.hostname||"";var y=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!y)for(var _=this.hostname.split(/\./),m=0,f=_.length;m<f;m++){var D=_[m];if(!D)continue;if(!D.match(Al)){for(var v="",w=0,I=D.length;w<I;w++)D.charCodeAt(w)>127?v+="x":v+=D[w];if(!v.match(Al)){var P=_.slice(0,m),N=_.slice(m+1),H=D.match(Hp);H&&(P.push(H[1]),N.unshift(H[2])),N.length&&(a="/"+N.join(".")+a),this.hostname=P.join(".");break}}}this.hostname.length>Vp?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=Mp.toASCII(this.hostname));var q=this.port?":"+this.port:"",J=this.hostname||"";this.host=J+q,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!qp[c])for(var m=0,f=Mn.length;m<f;m++){var ie=Mn[m];if(a.indexOf(ie)===-1)continue;var ae=encodeURIComponent(ie);ae===ie&&(ae=escape(ie)),a=a.split(ie).join(ae)}var ke=a.indexOf("#");ke!==-1&&(this.hash=a.substr(ke),a=a.slice(0,ke));var Pe=a.indexOf("?");if(Pe!==-1?(this.search=a.substr(Pe),this.query=a.substr(Pe+1),t&&(this.query=Nn.parse(this.query)),a=a.slice(0,Pe)):t&&(this.search="",this.query={}),a&&(this.pathname=a),$i[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var q=this.pathname||"",de=this.search||"";this.path=q+de}return this.href=this.format(),this};function zp(e){return zt.isString(e)&&(e=Ro(e)),e instanceof vt?e.format():vt.prototype.format.call(e)}vt.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",i=this.pathname||"",r=this.hash||"",o=!1,s="";this.host?o=e+this.host:this.hostname&&(o=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&zt.isObject(this.query)&&Object.keys(this.query).length&&(s=Nn.stringify(this.query));var n=this.search||s&&"?"+s||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||$i[t])&&o!==!1?(o="//"+(o||""),i&&i.charAt(0)!=="/"&&(i="/"+i)):o||(o=""),r&&r.charAt(0)!=="#"&&(r="#"+r),n&&n.charAt(0)!=="?"&&(n="?"+n),i=i.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),n=n.replace("#","%23"),t+o+i+n+r};function Lp(e,t){return Ro(e,!1,!0).resolve(t)}vt.prototype.resolve=function(e){return this.resolveObject(Ro(e,!1,!0)).format()};function Np(e,t){return e?Ro(e,!1,!0).resolveObject(t):t}vt.prototype.resolveObject=function(e){if(zt.isString(e)){var t=new vt;t.parse(e,!1,!0),e=t}for(var i=new vt,r=Object.keys(this),o=0;o<r.length;o++){var s=r[o];i[s]=this[s]}if(i.hash=e.hash,e.href==="")return i.href=i.format(),i;if(e.slashes&&!e.protocol){for(var n=Object.keys(e),a=0;a<n.length;a++){var l=n[a];l!=="protocol"&&(i[l]=e[l])}return $i[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(e.protocol&&e.protocol!==i.protocol){if(!$i[e.protocol]){for(var h=Object.keys(e),c=0;c<h.length;c++){var p=h[c];i[p]=e[p]}return i.href=i.format(),i}if(i.protocol=e.protocol,!e.host&&!Ln[e.protocol]){for(var f=(e.pathname||"").split("/");f.length&&!(e.host=f.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),f[0]!==""&&f.unshift(""),f.length<2&&f.unshift(""),i.pathname=f.join("/")}else i.pathname=e.pathname;if(i.search=e.search,i.query=e.query,i.host=e.host||"",i.auth=e.auth,i.hostname=e.hostname||e.host,i.port=e.port,i.pathname||i.search){var d=i.pathname||"",m=i.search||"";i.path=d+m}return i.slashes=i.slashes||e.slashes,i.href=i.format(),i}var x=i.pathname&&i.pathname.charAt(0)==="/",b=e.host||e.pathname&&e.pathname.charAt(0)==="/",g=b||x||i.host&&e.pathname,y=g,_=i.pathname&&i.pathname.split("/")||[],f=e.pathname&&e.pathname.split("/")||[],D=i.protocol&&!$i[i.protocol];if(D&&(i.hostname="",i.port=null,i.host&&(_[0]===""?_[0]=i.host:_.unshift(i.host)),i.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(f[0]===""?f[0]=e.host:f.unshift(e.host)),e.host=null),g=g&&(f[0]===""||_[0]==="")),b)i.host=e.host||e.host===""?e.host:i.host,i.hostname=e.hostname||e.hostname===""?e.hostname:i.hostname,i.search=e.search,i.query=e.query,_=f;else if(f.length)_||(_=[]),_.pop(),_=_.concat(f),i.search=e.search,i.query=e.query;else if(!zt.isNullOrUndefined(e.search)){if(D){i.hostname=i.host=_.shift();var v=i.host&&i.host.indexOf("@")>0?i.host.split("@"):!1;v&&(i.auth=v.shift(),i.host=i.hostname=v.shift())}return i.search=e.search,i.query=e.query,(!zt.isNull(i.pathname)||!zt.isNull(i.search))&&(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!_.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var w=_.slice(-1)[0],I=(i.host||e.host||_.length>1)&&(w==="."||w==="..")||w==="",P=0,N=_.length;N>=0;N--)w=_[N],w==="."?_.splice(N,1):w===".."?(_.splice(N,1),P++):P&&(_.splice(N,1),P--);if(!g&&!y)for(;P--;P)_.unshift("..");g&&_[0]!==""&&(!_[0]||_[0].charAt(0)!=="/")&&_.unshift(""),I&&_.join("/").substr(-1)!=="/"&&_.push("");var H=_[0]===""||_[0]&&_[0].charAt(0)==="/";if(D){i.hostname=i.host=H?"":_.length?_.shift():"";var v=i.host&&i.host.indexOf("@")>0?i.host.split("@"):!1;v&&(i.auth=v.shift(),i.host=i.hostname=v.shift())}return g=g||i.host&&_.length,g&&!H&&_.unshift(""),_.length?i.pathname=_.join("/"):(i.pathname=null,i.path=null),(!zt.isNull(i.pathname)||!zt.isNull(i.search))&&(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=e.auth||i.auth,i.slashes=i.slashes||e.slashes,i.href=i.format(),i};vt.prototype.parseHost=function(){var e=this.host,t=Gp.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}});var Be=De((Il,ko)=>{(function(){var e,t,i,r,o,s;typeof performance!="undefined"&&performance!==null&&performance.now?ko.exports=function(){return performance.now()}:typeof process!="undefined"&&process!==null&&process.hrtime?(ko.exports=function(){return(e()-o)/1e6},t=process.hrtime,e=function(){var n;return n=t(),n[0]*1e9+n[1]},r=e(),s=process.uptime()*1e9,o=r-s):Date.now?(ko.exports=function(){return Date.now()-i},i=Date.now()):(ko.exports=function(){return new Date().getTime()-i},i=new Date().getTime())}).call(Il)});var tr=De(($y,zn)=>{var Oo=function(){function e(c){return r.appendChild(c.dom),c}function t(c){for(var p=0;p<r.children.length;p++)r.children[p].style.display=p===c?"block":"none";i=c}var i=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",function(c){c.preventDefault(),t(++i%r.children.length)},!1);var o=(performance||Date).now(),s=o,n=0,a=e(new Oo.Panel("FPS","#0ff","#002")),l=e(new Oo.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var h=e(new Oo.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:r,addPanel:e,showPanel:t,begin:function(){o=(performance||Date).now()},end:function(){n++;var c=(performance||Date).now();if(l.update(c-o,200),c>s+1e3&&(a.update(1e3*n/(c-s),100),s=c,n=0,h)){var p=performance.memory;h.update(p.usedJSHeapSize/1048576,p.jsHeapSizeLimit/1048576)}return c},update:function(){o=this.end()},domElement:r,setMode:t}};Oo.Panel=function(e,t,i){var r=Infinity,o=0,s=Math.round,n=s(window.devicePixelRatio||1),a=80*n,l=48*n,h=3*n,c=2*n,p=3*n,d=15*n,m=74*n,x=30*n,b=document.createElement("canvas");b.width=a,b.height=l,b.style.cssText="width:80px;height:48px";var g=b.getContext("2d");return g.font="bold "+9*n+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=i,g.fillRect(0,0,a,l),g.fillStyle=t,g.fillText(e,h,c),g.fillRect(p,d,m,x),g.fillStyle=i,g.globalAlpha=.9,g.fillRect(p,d,m,x),{dom:b,update:function(y,_){r=Math.min(r,y),o=Math.max(o,y),g.fillStyle=i,g.globalAlpha=1,g.fillRect(0,0,a,d),g.fillStyle=t,g.fillText(s(y)+" "+e+" ("+s(r)+"-"+s(o)+")",h,c),g.drawImage(b,p+n,d,m-n,x,p,d,m-n,x),g.fillRect(p+m-n,d,n,x),g.fillStyle=i,g.globalAlpha=.9,g.fillRect(p+m-n,d,n,s((1-y/_)*x))}}};typeof zn=="object"&&(zn.exports=Oo)});var ir=De((eb,Pl)=>{"use strict";Pl.exports=(e,t=1,i)=>{if(i=T({indent:" ",includeEmptyLines:!1},i),typeof e!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof e}\``);if(typeof t!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof t}\``);if(typeof i.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof i.indent}\``);if(t===0)return e;const r=i.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return e.replace(r,i.indent.repeat(t))}});var rr=De(()=>{});var or=De((rb,Bl)=>{"use strict";const Ml=rr(),Ll=/\s+at.*(?:\(|\s)(.*)\)?/,Yp=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,Xp=typeof Ml.homedir=="undefined"?"":Ml.homedir();Bl.exports=(e,t)=>(t=Object.assign({pretty:!1},t),e.replace(/\\/g,"/").split(`
`).filter(i=>{const r=i.match(Ll);if(r===null||!r[1])return!0;const o=r[1];return o.includes(".app/Contents/Resources/electron.asar")||o.includes(".app/Contents/Resources/default_app.asar")?!1:!Yp.test(o)}).filter(i=>i.trim()!=="").map(i=>t.pretty?i.replace(Ll,(r,o)=>r.replace(o,o.replace(Xp,"~"))):i).join(`
`))});var sr=De((ob,Nl)=>{"use strict";const Qp=ir(),Zp=or(),Jp=e=>e.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,"");class $p extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);e=[...e].map(i=>i instanceof Error?i:i!==null&&typeof i=="object"?Object.assign(new Error(i.message),i):new Error(i));let t=e.map(i=>typeof i.stack=="string"?Jp(Zp(i.stack)):String(i)).join(`
`);t=`
`+Qp(t,4),super(t),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(const e of this._errors)yield e}}Nl.exports=$p});var Ot=De((Un,zl)=>{"use strict";const em=sr();zl.exports=(o,s,...n)=>Ae(Un,[o,s,...n],function*(e,t,{concurrency:i=Infinity,stopOnError:r=!0}={}){return new Promise((a,l)=>{if(typeof t!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(i)||i===Infinity)&&i>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${i}\` (${typeof i})`);const h=[],c=[],p=e[Symbol.iterator]();let d=!1,m=!1,x=0,b=0;const g=()=>{if(d)return;const y=p.next(),_=b;if(b++,y.done){m=!0,x===0&&(!r&&c.length!==0?l(new em(c)):a(h));return}x++,(()=>Ae(Un,null,function*(){try{const f=yield y.value;h[_]=yield t(f,_),x--,g()}catch(f){r?(d=!0,l(f)):(c.push(f),x--,g())}}))()};for(let y=0;y<i&&!(g(),m);y++);})})});var lr=De(tm=>{Fe(tm,{default:()=>Gn});class Gn{constructor(e){this._editor=e}serialize(...e){const t=new ar(this._editor);return t.serialize(...e)}deserialize(e){const t=new nr(this._editor,e);return t.deserialize()}}Gn.version="1.0.0"});var ur=De(im=>{Fe(im,{default:()=>jn});class jn{constructor(e){this._editor=e}serialize(...e){const t=new dr(this._editor);return t.serialize(...e)}deserialize(e){const t=new hr(this._editor,e);return t.deserialize()}}jn.version="1.0.1"});var mr=De(rm=>{Fe(rm,{default:()=>Kn});class Kn{constructor(e){this._editor=e}serialize(...e){const t=new pr(this._editor);return t.serialize(...e)}deserialize(e){const t=new cr(this._editor,e);return t.deserialize()}}Kn.version="2.0.0"});var _r=De(om=>{Fe(om,{default:()=>Wn});class Wn{constructor(e){this._editor=e}serialize(...e){const t=new fr(this._editor);return t.serialize(...e)}deserialize(e){const t=new gr(this._editor,e);return t.deserialize()}}Wn.version="3.0.0"});var xr=De(sm=>{Fe(sm,{default:()=>Vn});class Vn{constructor(e){this._editor=e}serialize(...e){const t=new br(this._editor);return t.serialize(...e)}deserialize(e){const t=new yr(this._editor,e);return t.deserialize()}}Vn.version="3.1.0"});var Tr=De(nm=>{Fe(nm,{default:()=>Hn});class Hn{constructor(e){this._editor=e}serialize(...e){const t=new wr(this._editor);return t.serialize(...e)}deserialize(e){const t=new vr(this._editor,e);return t.deserialize()}}Hn.version="3.2.0"});var Cr=De(am=>{Fe(am,{default:()=>qn});class qn{constructor(e){this._editor=e}serialize(...e){const t=new Sr(this._editor);return t.serialize(...e)}deserialize(e){const t=new Dr(this._editor,e);return t.deserialize()}}qn.version="3.4.0"});var kr=De(lm=>{Fe(lm,{default:()=>Yn});class Yn{constructor(e){this._editor=e}serialize(...e){const t=new Rr(this._editor);return t.serialize(...e)}deserialize(e){const t=new Er(this._editor,e);return t.deserialize()}}Yn.version="3.5.0"});var Ar=De(hm=>{Fe(hm,{default:()=>Xn});class Xn{constructor(e){this._editor=e}serialize(...e){const t=new Fr(this._editor);return t.serialize(...e)}deserialize(e){const t=new Or(this._editor,e);return t.deserialize()}}Xn.version="3.6.0"});var Br=De(dm=>{Fe(dm,{default:()=>Qn});class Qn{constructor(e){this._editor=e}serialize(...e){const t=new Pr(this._editor);return t.serialize(...e)}deserialize(e){const t=new Ir(this._editor,e);return t.deserialize()}}Qn.version="3.7.0"});var Nr=De(um=>{Fe(um,{default:()=>Zn});class Zn{constructor(e){this._editor=e}serialize(...e){const t=new Lr(this._editor);return t.serialize(...e)}deserialize(e){const t=new Mr(this._editor,e);return t.deserialize()}}Zn.version="3.8.0"});var zr=De(cm=>{Fe(cm,{default:()=>Jn});class Jn{constructor(e){this._editor=e}serialize(...e){const t=new ns(this._editor);return t.serialize(...e)}deserialize(e){const t=new ss(this._editor,e);return t.deserialize()}}Jn.version="3.9.0"});var Ul;(function(e){e.OBJECT="object"})(Ul||(Ul={}));var Fo;(function(e){e.UNDO="undo",e.REDO="redo",e.DELETE="delete",e.BRING_TO_FRONT="bringtofront",e.EDIT="edit",e.DUPLICATE="duplicate",e.ADD="add",e.FLIP="flip",e.INVERT="invert",e.CLOSE="close",e.EXPORT="export"})(Fo||(Fo={}));var Je;(function(e){e.LIBRARY="library",e.ART_FILTER="artFilter",e.TRANSFORM="transform",e.FILTER="filter",e.ADJUSTMENT="adjustment",e.FOCUS="focus",e.STICKER="sticker",e.TEXT="text",e.TEXT_DESIGN="textdesign",e.OVERLAY="overlay",e.FRAME="frame",e.BRUSH="brush"})(Je||(Je={}));var Ur;(function(e){e.TEXT="text",e.CARD="card"})(Ur||(Ur={}));var Gl;(function(e){e.LARGE="large",e.MEDIUM="medium",e.SMALL="small"})(Gl||(Gl={}));var jl;(function(e){e.ERROR="error",e.WARNING="warning",e.INFO="info",e.TEXT_EDIT="textEdit"})(jl||(jl={}));var qt;(function(e){e.IMAGE="image",e.DATA_URL="data-url",e.BLOB="blob",e.MSBLOB="ms-blob"})(qt||(qt={}));var Ei;(function(e){e.PNG="image/png",e.JPEG="image/jpeg",e.RAW="raw"})(Ei||(Ei={}));class $b{constructor(){this.order="default";this.language="en";this.theme="dark";this.assetBaseUrl="assets/";this.displayResizeWarning=!0;this.displayCloseWarning=!0;this.displayCanvasRendererWarning=!0;this.displayToolControlBarTitle=!0;this.forceCrop=!1;this.enableZoom=!0;this.defaultTool=Je.FILTER}}Je.FILTER,Je.FOCUS,Je.ADJUSTMENT,Je.LIBRARY,Je.OVERLAY,Je.STICKER,Je.TEXT,Je.TEXT_DESIGN,Je.FRAME,Je.BRUSH,Je.TRANSFORM;var Xe;(function(e){e.BRIGHTNESS="brightness",e.CONTRAST="contrast",e.SATURATION="saturation",e.CLARITY="clarity",e.SHADOWS="shadows",e.HIGHLIGHTS="highlights",e.EXPOSURE="exposure",e.GAMMA="gamma",e.BLACKS="blacks",e.WHITES="whites",e.TEMPERATURE="temperature",e.SHARPNESS="sharpness"})(Xe||(Xe={}));const tx=Object.values(Xe).reduce((e,t)=>(e[t]=!0,e),{});function Kl(e){return e.lightColor!==void 0}function Wl(e){return e.lutURI!==void 0}var B;(function(e){e.Desert="imgly_duotone_desert",e.Peach="imgly_duotone_peach",e.Clash="imgly_duotone_clash",e.Plum="imgly_duotone_plum",e.Breezy="imgly_duotone_breezy",e.DeepBlue="imgly_duotone_deepblue",e.Frog="imgly_duotone_frog",e.Sunset="imgly_duotone_sunset",e.AD1920="imgly_lut_ad1920",e.Greyed="imgly_lut_bw",e.Dusty="imgly_lut_x400",e.Litho="imgly_lut_litho",e.Sepia="imgly_lut_sepiahigh",e.Weathered="imgly_lut_plate",e.HardStuff="imgly_lut_sin",e.Polaroid="imgly_lut_blues",e.Sunny70s="imgly_lut_front",e.Oldtimer="imgly_lut_texas",e.Inferno="imgly_lut_celsius",e.Snappy="imgly_lut_cool",e.Chestnut="imgly_lut_chest",e.Softy="imgly_lut_winter",e.Pebble="imgly_lut_kdynamic",e.Moss="imgly_lut_fall",e.Lemon="imgly_lut_lenin",e.GreenGap="imgly_lut_pola669",e.Colla="imgly_lut_elder",e.Solanus="imgly_lut_orchid",e.Kalmen="imgly_lut_bleached",e.Joran="imgly_lut_bleachedblue",e.Levante="imgly_lut_breeze",e.Zephyr="imgly_lut_blueshadows",e.Golden="imgly_lut_sunset",e.LowFire="imgly_lut_eighties",e.Sunrise="imgly_lut_evening",e.FlatBlack="imgly_lut_k2",e.Pumpkin="imgly_lut_nogreen",e.Ancient="imgly_lut_ancient",e.Candy="imgly_lut_cottoncandy",e.Classic="imgly_lut_classic",e.Colorful="imgly_lut_colorful",e.Creamy="imgly_lut_creamy",e.Fixie="imgly_lut_fixie",e.Food="imgly_lut_food",e.Fridge="imgly_lut_fridge",e.Glam="imgly_lut_glam",e.Gobblin="imgly_lut_gobblin",e.Hicon="imgly_lut_highcontrast",e.HighCarb="imgly_lut_highcarb",e.K1="imgly_lut_k1",e.K6="imgly_lut_k6",e.Keen="imgly_lut_keen",e.Lomo="imgly_lut_lomo",e.Lomo100="imgly_lut_lomo100",e.Lucid="imgly_lut_lucid",e.Mellow="imgly_lut_mellow",e.Neat="imgly_lut_neat",e.Pale="imgly_lut_pale",e.Pitched="imgly_lut_pitched",e.PolaSX="imgly_lut_polasx",e.Pro400="imgly_lut_pro400",e.Quozi="imgly_lut_quozi",e.Settled="imgly_lut_settled",e.Seventies="imgly_lut_seventies",e.Soft="imgly_lut_soft",e.Steel="imgly_lut_steel",e.Summer="imgly_lut_summer",e.Tender="imgly_lut_tender",e.Twilight="imgly_lut_twilight"})(B||(B={}));var Ut;(function(e){e.DuoTone="imgly_filter_category_duotone",e.BW="imgly_filter_category_bw",e.Vintage="imgly_filter_category_vintage",e.Smooth="imgly_filter_category_smooth",e.Cold="imgly_filter_category_cold",e.Warm="imgly_filter_category_warm",e.Legacy="imgly_filter_category_legacy"})(Ut||(Ut={}));var Ri;(function(e){e.RADIAL="radial",e.LINEAR="linear",e.MIRRORED="mirrored",e.GAUSSIAN="gaussian"})(Ri||(Ri={}));var oe;(function(e){e.NORMAL="normal",e.OVERLAY="overlay",e.SOFT_LIGHT="softLight",e.HARD_LIGHT="hardLight",e.MULTIPLY="multiply",e.DARKEN="darken",e.COLOR_BURN="colorBurn",e.SCREEN="screen",e.LIGHTEN="lighten"})(oe||(oe={}));function Vl(e){return e.provider===void 0||e.provider==="file"}function Hl(e){return e.provider==="google"}var ql;(function(e){e.CommonCategory="imgly_transforms_common",e.FacebookCategory="imgly_transforms_facebook",e.TwitterCategory="imgly_transforms_twitter",e.InstagramCategory="imgly_transforms_instagram",e.Custom="imgly_transform_common_custom",e.Square="imgly_transform_common_square",e.ThreeByFour="imgly_transform_common_3",e.FourByThree="imgly_transform_common_4",e.NineBySixteen="imgly_transform_common_9",e.SixteenByNine="imgly_transform_common_16",e.FacebookPost="imgly_transform_facebook_post",e.FacebookProfile="imgly_transform_facebook_profile",e.FacebookTitle="imgly_transform_facebook_title",e.InstagramLandscape="imgly_transform_instagram_landscape",e.InstagramPortrait="imgly_transform_instagram_portrait",e.InstagramSquare="imgly_transform_instagram_square",e.InstagramStory="imgly_transform_instagram_story",e.TwitterPost="imgly_transform_twitter_post",e.TwitterProfile="imgly_transform_twitter_profile",e.TwitterTitle="imgly_transform_twitter_title"})(ql||(ql={}));var Yl;(function(e){e.EXPORT="export",e.CLOSE="close",e.HISTORY_CHANGE="historyChange",e.EDITOR_READY="editorReady",e.ERROR_IMAGE_LOADING="errorImageLoading"})(Yl||(Yl={}));class Ao{constructor(){this.events={}}addListener(e,t){const i=this.events[e]||(this.events[e]=[]);return i.push(t),this}removeListener(e,t){const i=this.events[e];if(!i)return this;const r=i.lastIndexOf(t);return r===-1?this:(i.splice(r,1),this)}removeAllListeners(e){return this.events[e]=void 0,this}on(e,t){return this.addListener(e,t)}off(e,t){return this.removeListener(e,t)}emit(e,...t){const i=this.events[e];return!i||!i.length?!1:(i.slice(0).forEach(r=>r.apply(null,t)),!0)}}var pt={load(e,t={cors:!0,value:"anonymous"}){const i=()=>Promise.resolve([e,e]);return i().then(([r,o])=>this._createAndLoadImage(r,o,t))},loadImage(e,t={cors:!0,value:"anonymous"}){return this._loadWithoutExif(e,t)},_loadWithoutExif(e,t={cors:!0,value:"anonymous"}){return new Promise((i,r)=>{const o=new window.Image;o.addEventListener("load",()=>{i(o)}),o.addEventListener("error",()=>{r(new Error(`Failed to load image at ${e}`))}),t.cors&&(o.crossOrigin=t.value),o.src=e})},_createAndLoadImage(e,t,i={cors:!0,value:"anonymous"}){return new Promise((r,o)=>{{const s=this._loadWithoutExif(t,i).then(a=>r(a)),n=new Promise((a,l)=>{this._loadAsDataURL(t,i).then(h=>{const c=new window.Image;c.addEventListener("load",()=>{a(c)}),c.src=h,c.rawSource=h}).catch(h=>{s.then(c=>a(c))})});return this._stringEndsWith(t,".svg")?s.then(a=>r(a)):n.then(a=>r(a))}})},_stringEndsWith(e,t,i=e.length){return(i===void 0||i>e.length)&&(i=e.length),e.substring(i-t.length,i)===t},_loadAsDataURL(e,t={cors:!0,value:"anonymous"}){return new Promise((i,r)=>{const o=new XMLHttpRequest;o.onload=function(){const s=new FileReader;s.onloadend=function(){s.error&&r(s.error),i(s.result)},s.readAsDataURL(o.response)},o.open("GET",e),o.responseType="blob",o.withCredentials=t.cors&&t.value==="use-credentials",o.send()})},loadXHR(e,t){return new Promise((i,r)=>{let o;window.XDomainRequest?(o=new window.XDomainRequest,t&&o.overrideMimeType(t),o.onload=function(){i(o)},o.onerror=function(s){r(s)}):window.XMLHttpRequest&&(o=new window.XMLHttpRequest,t&&o.overrideMimeType(t),o.onreadystatechange=function(s){o.readyState===4&&(o.status===200?i(o):r(new Error(`HTTP Status ${o.status}`)))}),o.open("GET",e,!0),o.send()})}};const pm=function(){"use strict";var t,i,r,o=Object.prototype.toString,s=typeof setImmediate!="undefined"?function(_){return setImmediate(_)}:setTimeout;try{Object.defineProperty({},"x",{}),t=function(_,f,D,v){return Object.defineProperty(_,f,{value:D,writable:!0,configurable:v!==!1})}}catch(y){t=function(f,D,v){return f[D]=v,f}}r=function(){var _,f,D;function v(w,I){this.fn=w,this.self=I,this.next=void 0}return{add:function(I,P){D=new v(I,P),f?f.next=D:_=D,f=D,D=void 0},drain:function(){var I=_;for(_=f=i=void 0;I;)I.fn.call(I.self),I=I.next}}}();function n(y,_){r.add(y,_),i||(i=s(r.drain))}function a(y){var _,f=typeof y;return y!=null&&(f=="object"||f=="function")&&(_=y.then),typeof _=="function"?_:!1}function l(){for(var y=0;y<this.chain.length;y++)h(this,this.state===1?this.chain[y].success:this.chain[y].failure,this.chain[y]);this.chain.length=0}function h(y,_,f){var D,v;try{_===!1?f.reject(y.msg):(_===!0?D=y.msg:D=_.call(void 0,y.msg),D===f.promise?f.reject(TypeError("Promise-chain cycle")):(v=a(D))?v.call(D,f.resolve,f.reject):f.resolve(D))}catch(w){f.reject(w)}}function c(y){var _,f=this;if(f.triggered)return;f.triggered=!0,f.def&&(f=f.def);try{(_=a(y))?n(function(){var D=new m(f);try{_.call(y,function(){c.apply(D,arguments)},function(){p.apply(D,arguments)})}catch(v){p.call(D,v)}}):(f.msg=y,f.state=1,f.chain.length>0&&n(l,f))}catch(D){p.call(new m(f),D)}}function p(y){var _=this;if(_.triggered)return;_.triggered=!0,_.def&&(_=_.def),_.msg=y,_.state=2,_.chain.length>0&&n(l,_)}function d(y,_,f,D){for(var v=0;v<_.length;v++)(function(I){y.resolve(_[I]).then(function(N){f(I,N)},D)})(v)}function m(y){this.def=y,this.triggered=!1}function x(y){this.promise=y,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function b(y){if(typeof y!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var _=new x(this);this.then=function(D,v){var w={success:typeof D=="function"?D:!0,failure:typeof v=="function"?v:!1};return w.promise=new this.constructor(function(P,N){if(typeof P!="function"||typeof N!="function")throw TypeError("Not a function");w.resolve=P,w.reject=N}),_.chain.push(w),_.state!==0&&n(l,_),w.promise},this.catch=function(D){return this.then(void 0,D)};try{y.call(void 0,function(D){c.call(_,D)},function(D){p.call(_,D)})}catch(f){p.call(_,f)}}var g=t({},"constructor",b,!1);return b.prototype=g,t(g,"__NPO__",0,!1),t(b,"resolve",function(_){var f=this;return _&&typeof _=="object"&&_.__NPO__===1?_:new f(function(v,w){if(typeof v!="function"||typeof w!="function")throw TypeError("Not a function");v(_)})}),t(b,"reject",function(_){return new this(function(D,v){if(typeof D!="function"||typeof v!="function")throw TypeError("Not a function");v(_)})}),t(b,"all",function(_){var f=this;return o.call(_)!="[object Array]"?f.reject(TypeError("Not an array")):_.length===0?f.resolve([]):new f(function(v,w){if(typeof v!="function"||typeof w!="function")throw TypeError("Not a function");var I=_.length,P=Array(I),N=0;d(f,_,function(q,J){P[q]=J,++N===I&&v(P)},w)})}),t(b,"race",function(_){var f=this;return o.call(_)!="[object Array]"?f.reject(TypeError("Not an array")):new f(function(v,w){if(typeof v!="function"||typeof w!="function")throw TypeError("Not a function");d(f,_,function(P,N){v(N)},w)})}),b};var Xl=typeof global=="undefined"?window:global;const Ql=typeof Promise!="undefined"?Promise:pm();Xl.Promise=Xl.Promise||Ql;var W=Ql;const $n=Ne(er()),mm=5e3,Io=typeof window!="undefined"?window:global;class Ft{constructor(e){this._url=e,this._parsedUrl=$n.default.parse(this._url,!0)}_isJSONPRequest(){const{query:e}=this._parsedUrl;for(const t in e){const i=e[t];if(i==="?")return!0}return!1}load(){return this._isJSONPRequest()?this._loadJSONP():this._loadJSON()}_loadJSON(){return new W((e,t)=>{let i;Io.XDomainRequest?(i=new Io.XDomainRequest,i.onload=function(){const r=JSON.parse(i.responseText);e(r)},i.onerror=function(r){t(r)},i.open("GET",this._url,!0),i.send()):Io.XMLHttpRequest&&(i=new XMLHttpRequest,i.onreadystatechange=function(r){if(i.readyState===4)if(i.status===200){const o=JSON.parse(i.responseText);e(o)}else t(new Error(`HTTP Status ${i.status}`))},i.open("GET",this._url,!0),i.send())})}_loadJSONP(){let e=!1,t=!1;const i=`pesdk${Math.round(Math.random()*99999999999999)}`;return new W((r,o)=>{const s=this._createJSONPNode(i);Io[i]=n=>{this._removeJSONPNode(s),e||(t=!0,r(n))},Io.setTimeout(()=>{t||(this._removeJSONPNode(s),e=!0,o(new Error("Timeout of 5 seconds exceeded.")))},mm)})}_createJSONPNode(e){const t=this._buildJSONPUrl(e),i=document.querySelector("head"),r=document.createElement("script");return r.src=t,i.appendChild(r),r}_removeJSONPNode(e){e.parentNode.removeChild(e)}_buildJSONPUrl(e){const{query:t}=this._parsedUrl;let i=null;for(const r in t)if(t[r]==="?"){i=r;break}return delete this._parsedUrl.search,t[i]=e,$n.default.format(this._parsedUrl)}}const ea={};Fe(ea,{ImageLoader:()=>pt,JSONLoader:()=>Ft});class Zl{static head(e){return e[0]}static tail(e){return e.slice(1)}static last(e){return e[e.length-1]}static init(e){return e.slice(0,e.length-1)}static remove(e,t){return e.filter((i,r,o)=>!t(i,r,o))}static findIndex(e,t){for(let i=0;i<e.length;i++)if(t(e[i]))return i;return-1}static find(e,t){for(let i=0;i<e.length;i++)if(t(e[i]))return e[i];return}static flatten(e){return e.reduce(function(t,i){return t.concat(Array.isArray(i)?Zl.flatten(i):i)},[])}static range(e,t){const i=[];if(t>e)for(let r=e;r<t;r++)i.push(r);return i}static repeat(e,t){const i=[];for(let r=0;r<t;r++)i[r]=e;return i}static zip(e,t){const i=Math.min(e.length,t.length),r=[];for(let o=0;o<i;o++)r[o]=[e[o],t[o]];return r}}var Jl=Zl;const hi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",gm={encode(e){let t="",i,r,o,s,n,a,l,h=0;do i=e[h++],r=e[h++],o=e[h++],s=i>>2,n=(i&3)<<4|r>>4,a=(r&15)<<2|o>>6,l=o&63,isNaN(r)?a=l=64:isNaN(o)&&(l=64),t=t+hi.charAt(s)+hi.charAt(n)+hi.charAt(a)+hi.charAt(l),i=r=o="",s=n=a=l="";while(h<e.length);return t},decode(e){let t,i,r,o,s,n,a,l=0;const h=[],c=/[^A-Za-z0-9+/=]/g;if(c.exec(e))throw new Error(`There were invalid base64 characters in the input text.
Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='
Expect errors in decoding.`);e=e.replace(/[^A-Za-z0-9+/=]/g,"");do o=hi.indexOf(e.charAt(l++)),s=hi.indexOf(e.charAt(l++)),n=hi.indexOf(e.charAt(l++)),a=hi.indexOf(e.charAt(l++)),t=o<<2|s>>4,i=(s&15)<<4|n>>2,r=(n&3)<<6|a,h.push(t),n!==64&&h.push(i),a!==64&&h.push(r),t=i=r="",o=s=n=a="";while(l<e.length);return h}};var mt=gm;class di{static isArray(e){return Object.prototype.toString.call(e)==="[object Array]"}static mapRange(e,t,i){return(e-t.getMin())*i.getLength()/t.getLength()+i.getMin()}static isPlainObject(e){if(typeof e!="object"||!e)return!1;if(typeof Object.getPrototypeOf=="function"){const t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}return Object.prototype.toString.call(e)==="[object Object]"}static isMobile(){if(typeof navigator=="undefined")return!1;const e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}static isBrowser(){return typeof window!="undefined"}static isNode(){return typeof window=="undefined"&&typeof global!="undefined"}static values(e){const t=[];for(const i in e)t.push(e[i]);return t}static generateUUID(){let e=new Date().getTime();return typeof window.performance!="undefined"&&typeof window.performance.now=="function"&&(e+=window.performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const i=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(t==="x"?i:i&3|8).toString(16)})}static isDOMElement(e){return typeof HTMLElement=="object"?e instanceof HTMLElement:e&&typeof e=="object"&&e!==null&&e.nodeType===1&&typeof e.nodeName=="string"}static isTouchEvent(e){return e.type.indexOf("touch")!==-1}static resizeVectorToFit(e,t){const i=Math.min(t.x/e.x,t.y/e.y),r=e.clone().multiply(i);return r}static resizeVectorToFill(e,t){const i=e.x/e.y,r=t.x/t.y;return i>r?t.clone().set(t.y*i,t.y):t.clone().set(t.x,t.x/i)}static isExtendable(e){return typeof e!="undefined"&&e!==null&&(typeof e=="object"||typeof e=="function")}static defaults(e,...t){const i={};for(const r in e)i[r]=e[r];for(let r=0;r<t.length;r++){const o=t[r];for(const s in o)typeof i[s]=="undefined"&&(i[s]=o[s])}return i}static deepMerge(e,...t){const i=(r,o)=>{if(o===void 0)return i(null,r);if(Array.isArray(o))return[...o];if(!di.isPlainObject(o))return o;if(!di.isPlainObject(r))return T({},o);const s=T({},r);return Object.keys(o).forEach(n=>{const a=o[n];if(a===void 0)return;s[n]=i(r[n],a)}),s};return t.reduce(i,e)}static deepDefaults(e,...t){const i=[...t].reverse();return di.deepMerge(...i,e)}static deepClone(e){const t={};for(const i in e)di.isExtendable(e[i])?t[i]=di.deepClone(e[i]):t[i]=e[i];return t}static getDeepProperty(e,t){if(typeof t=="string")return e[t];if(!Array.isArray(t))return;const i=(r,o)=>{let s;try{s=o(r)}catch(n){if(!(n instanceof TypeError))throw n}return s};return t.reduce((r,o)=>r?typeof o=="function"?i(r,o):r[o]:null,e)}static extend(e,...t){const i={};for(const r in e)i[r]=e[r];for(let r=0;r<t.length;r++){const o=t[r];for(const s in o)i[s]=o[s]}return i}static clone(e){return this.extend({},e)}static createBlobURIFromDataURI(e){const t=typeof window=="undefined"?global:window;if(!t.Blob||!t.URL||!ArrayBuffer||!Uint8Array)return e;const i=mt.decode(e.split(",")[1]),r=e.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(i.length),s=new Uint8Array(o);for(let a=0;a<i.length;a++)s[a]=i[a];const n=new t.Blob([o],{type:r});return t.URL.createObjectURL(n)}static getUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0,i=e==="x"?t:t&3|8;return i.toString(16)})}static createCanvas(){return document.createElement("canvas")}static convertHtmlImageToRGBACanvas(e,t){const i=t||di.createCanvas();i.width=e.width,i.height=e.height;const r=i.getContext("2d");return r.clearRect(0,0,i.width,i.height),r.drawImage(e,0,0,e.width,e.height),i}static isPowerOfTwo(e){return(e.x&e.x-1)===0&&(e.y&e.y-1)===0}static nextLowestPOT(e){for(let t=1;t<32;t<<=1)e|=e>>t;return e-(e>>1)}static nextHighestPOT(e){e--;for(let t=1;t<32;t<<=1)e|=e>>t;return e+1}static moveArrayItem(e,t,i){if(i>=e.length){let r=i-e.length;for(;r--+1;)e.push(void 0)}e.splice(i,0,e.splice(t,1)[0])}static ensureCanvasDimensions(e,t){return e.width!==t.x||e.height!==t.y?(e.width=t.x,e.height=t.y,!0):!1}static byteArrayToString(e){return e.map(t=>String.fromCharCode(t)).join("")}static clamp(e,t,i){return Math.max(t,Math.min(e,i))}static wildCardMatch(e,t){return new RegExp(`^${t.split("*").join(".*")}$`).test(e)}static flipObject(e){const t={};for(const i in e)t[e[i]]=i;return t}static cloneOptions(e){const t={};for(const i in e){let r=e[i];Array.isArray(r)?r=r.slice():r.clone&&(r=r.clone()),t[i]=r}return t}static ISODateString(e){function t(i){return i<10?`0${i}`:i}return`${e.getUTCFullYear()}-${t(e.getUTCMonth()+1)}-${t(e.getUTCDate())}T${t(e.getUTCHours())}:${t(e.getUTCMinutes())}:${t(e.getUTCSeconds())}Z`}static getCrossOriginValue(e){return e?e==="none"?void 0:e:"anonymous"}static shallowEqual(e,t){if(e===t)return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;const o=hasOwnProperty.bind(t);for(let s=0;s<i.length;s++)if(!o(i[s])||e[i[s]]!==t[i[s]])return!1;return!0}static enableIf(e,t){return e?t:void 0}static invariant(e,t){if(!e){const i=new Error(t);throw i}}static executePromises(e){const t=e.length;let i=0;const r=[],o=[];return new Promise((s,n)=>{const a=()=>{i++,i>=t&&(o.length<=0?s(r):n(o))},l=c=>{r.push(c),a()},h=c=>{o.push(c),a()};e.forEach(c=>{c.then(l).catch(h)})})}}di.Array=Jl;var S=di;const fm=[{name:"trace",type:"trace",background:"#EEEEEE",color:"#AAAAAA"},{name:"info",type:"log",background:"#BDE5F8",color:"#00529B"},{name:"warn",type:"warn",background:"#FEEFB3",color:"#9F6000"},{name:"error",type:"error",background:"#FFBABA",color:"#D8000C"},{name:"log",type:"log",background:"#EEEEEE",color:"#1f4f6b"}],$l=()=>console&&console.group&&console.groupCollapsed&&console.groupEnd,_m=()=>typeof navigator!="undefined"&&navigator.userAgent.match(/Gecko|WebKit/i)&&!navigator.userAgent.match(/Trident/),ym=(e,t)=>["background: #2D7BFF; line-height: 20px; padding: 4px 0","background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0",`background: ${e}; color: ${t}; line-height: 20px; padding: 4px 0; font-weight: bold`,"background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0"];class bm{constructor(e="warn",t=fm){this._levels=[...t],this._maxLevel=this.getLevelIndexByName(e),this._consoleFuncs={trace:(...i)=>{$l()?(console.groupCollapsed(...i),console.trace(),console.groupEnd()):console.trace(...i)}},this._levels.forEach(({name:i})=>{this[i]=(r,...o)=>{this._log(i,r,...o)}})}getLevelIndexByName(e){return S.Array.findIndex(this._levels,t=>t.name===e)}getLevelObjectByName(e){return S.Array.find(this._levels,t=>t.name===e)}canLog(e){const t=this.getLevelIndexByName(e);return t<0?!1:t>=this._maxLevel}setLevel(e){const t=this.getLevelIndexByName(e);if(t<0)return;this._maxLevel=t}_log(e,t,...i){const r=this.getLevelObjectByName(e);if(!r||!this.canLog(e))return;const{name:o,type:s,background:n,color:a}=r,l=i.filter(d=>d!==void 0).map(d=>d.toObject?JSON.parse(JSON.stringify(d.toObject())):d),h=this._consoleFuncs[s]||console[s]?(...d)=>console[s](...d):(...d)=>console.log(...d),c=l.length,p=ym(n,a);if(!_m()){const d=l.length;if(d<=0){h(`PhotoEditorSDK | ${t} `);return}if(d===1&&typeof l[0]=="string"){h(`PhotoEditorSDK | ${t} | ${l[0]}`);return}h(`PhotoEditorSDK | ${t} | `,...l);return}if(c<=0){h(`%c  %c PhotoEditorSDK %c  %c ${t} %c %c  `,...p);return}if(c===1&&typeof l[0]=="string"){h(`%c  %c PhotoEditorSDK %c  %c ${t} %c  ${l[0]}  %c  `,...p);return}$l()?(console.groupCollapsed(`%c  %c PhotoEditorSDK %c  %c ${t} %c`,...S.Array.init(p)),h(...l),console.groupEnd()):h(`%c  %c PhotoEditorSDK %c  %c ${t} %c`,...S.Array.init(p),...l)}image(e="",t){{let i=new window.Image;const r=()=>{const{width:o}=i,{height:s}=i;e&&console.log(e),console.log("%c+",`
        font-size: 1px;
        padding: 0px ${Math.floor(o/2)}px;
        line-height: ${s}px;
        background: url(${i.src});
        color: transparent;
        background-repeat: no-repeat;
        background-size: ${o}px ${s}px;`)};return i.onload=r,t instanceof window.HTMLCanvasElement?i.src=t.toDataURL():t instanceof window.Image?(i=t,r()):typeof t=="string"?i.src=t:this.log(e,t),i}}texture(e="",t){{if(!t){this.log(e,"texture: null or undefined");return}const i=t.getBaseTexture(),r=i.getRenderers(),o=S.Array.find(r,a=>a&&a.constructor.type==="WebGL"),{width:s,height:n}=i.getFrame();if(o){const a=o.getContext(),l=i.getGLTextureForRenderer(o);this.logGlTexture(a,l,s,n,e)}else ta.image(e,i.getSource())}}logGlTexture(e,t,i=150,r=150,o){{e.bindTexture(e.TEXTURE_2D,t);const s=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0);const n=new Uint8Array(i*r*4);e.readPixels(0,0,i,r,e.RGBA,e.UNSIGNED_BYTE,n),e.deleteFramebuffer(s);const a=document.createElement("canvas");a.width=i,a.height=r;const l=a.getContext("2d"),h=l.createImageData(i,r);return h.data.set(n),l.putImageData(h,0,0),ta.image(o,a)}}}const ta=new bm("warn");var F=ta;const Se={};Fe(Se,{ImageFormat:()=>ki,OptionType:()=>u,RenderType:()=>gt,RendererType:()=>re,UniformType:()=>k});const gt={IMAGE:"image",DATAURL:"data-url",BUFFER:"buffer",BLOB:"blob",MSBLOB:"ms-blob"},ki={PNG:"image/png",JPEG:"image/jpeg",RAW:"raw"},u={NUMBER:"number",VECTOR2:"vector2",COLOR_MATRIX:"color-matrix",COLOR:"color",ARRAY:"array",OBJECT:"object",STRING:"string",BOOLEAN:"boolean",CONFIGURABLE:"configurable",IMAGE:"image",FUNCTION:"function",TEXTURE:"texture",ALL:"*"},k={SAMPLER2D:"sampler2d",INT:"i",INT1:"1i",INT2:"2i",INT3:"3i",INT4:"4i",FLOAT:"f",FLOAT1:"1f",FLOAT2:"2f",FLOAT_VECTOR2:"2fv",FLOAT3:"3f",FLOAT4:"4f",MAT3:"mat3",MAT3FV:"mat3fv",MAT4:"mat4"},re={WEBGL:"webgl",CANVAS:"canvas"};class wt{constructor(e,t,i,r=1){this.r=e,this.g=t,this.b=i,this.a=r}toRGBA(){const e=[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255),this.a.toFixed(2)];return`rgba(${e.join(",")})`}set(e,t,i,r=this.a){return this.r=e,this.g=t,this.b=i,this.a=r,this}toRGB(){return[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255)]}toHex(){const e=[this._componentToHex(Math.round(this.r*255)),this._componentToHex(Math.round(this.g*255)),this._componentToHex(Math.round(this.b*255))];return`#${e.join("")}`}toGLColor(){return[this.r,this.g,this.b,this.a]}toArray(){return this.toGLColor()}toRGBGLColor(){return[this.r,this.g,this.b]}toHSV(){const e=Math.max(this.r,this.g,this.b),t=Math.min(this.r,this.g,this.b);let i,r;const o=e,s=e-t;if(r=e===0?0:s/e,e===t)i=0;else{switch(e){case this.r:i=(this.g-this.b)/s,this.g<this.b&&(i+=6);break;case this.g:i=(this.b-this.r)/s+2;break;case this.b:i=(this.r-this.g)/s+4;break}i/=6}return[i,r,o]}fromHSV(e,t,i){return this.copy(wt.fromHSV(e,t,i)),this}static fromHSV(e,t,i,r=1){let[o,s,n]=[];const a=Math.floor(e*6),l=e*6-a,h=i*(1-t),c=i*(1-l*t),p=i*(1-(1-l)*t);switch(a%6){case 0:o=i,s=p,n=h;break;case 1:o=c,s=i,n=h;break;case 2:o=h,s=i,n=p;break;case 3:o=h,s=c,n=i;break;case 4:o=p,s=h,n=i;break;case 5:o=i,s=h,n=c;break}return new wt(o,s,n,r)}static fromArray(e){return new wt(e[0],e[1],e[2],e[3])}static fromHex(e){const[t,i,r]=e.match(/[0-9A-fa-f]{1,2}/g);return new wt(parseInt(t,16)/255,parseInt(i,16)/255,parseInt(r,16)/255,1)}clone(){return new wt(this.r,this.g,this.b,this.a)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this.a+=e.a,this}minus(e){return this.r-=e.r,this.g-=e.g,this.b-=e.b,this.a-=e.a,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this.a*=e,this}divideScalar(e){return this.r/=e,this.g/=e,this.b/=e,this.a/=e,this}clamp(e,t){return this.r=Math.min(Math.max(this.r,e),t),this.g=Math.min(Math.max(this.g,e),t),this.b=Math.min(Math.max(this.b,e),t),this.a=Math.min(Math.max(this.a,e),t),this}mix(e,t){return this.r=(1-t)*this.r+t*e.r,this.g=(1-t)*this.g+t*e.g,this.b=(1-t)*this.b+t*e.b,this.a=(1-t)*this.a+t*e.a,this}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}_componentToHex(e){const t=e.toString(16);return t.length===1?`0${t}`:t}toString(){return`Color(${this.r}, ${this.g}, ${this.b}, ${this.a})`}static get TRANSPARENT(){return new wt(0,0,0,0)}static get WHITE(){return new wt(1,1,1,1)}static get BLACK(){return new wt(0,0,0,1)}static get RED(){return new wt(1,0,0,1)}static get BLUE(){return new wt(0,0,1,1)}static get GREEN(){return new wt(0,1,0,1)}}var E=wt;const xm=12;class vm{constructor(){this._maxListeners=xm,this._events={},this._pipeDestinations=[]}pipeEvents(e){this._pipeDestinations.push(e)}unpipeEvents(e){const t=this._pipeDestinations.indexOf(e);if(t===-1)return;this._pipeDestinations.splice(t,1)}on(e,t){if(typeof e=="undefined")throw new Error(`Invalid event type: \`${e}\``);if(typeof t!="function")throw new TypeError;const i=this._events[e]||(this._events[e]=[]);return i.indexOf(t)!==-1?this:(i.push(t),this._maxListeners&&i.length>this._maxListeners&&(F.warn("EventEmitter",`Possible memory leak detected, added ${i.length} \`${e}\` listeners (current limit is ${this._maxListeners})`),typeof console!="undefined"&&console.trace()),this)}once(e,t){if(typeof e=="undefined")throw new Error(`Invalid event type: \`${e}\``);const i=this;function r(){i.off(e,r),t.apply(null,arguments)}return this.on(e,r)}off(e,...t){if(typeof e=="undefined")throw new Error(`Invalid event type: \`${e}\``);if(t.length===0)return this._events[e]=null,this;const i=t[0];if(typeof i!="function")throw new TypeError;const r=this._events[e];if(!r||!r.length)return this;const o=r.indexOf(i);return o===-1?this:(r.splice(o,1),this)}emit(e,...t){if(typeof e=="undefined")throw new Error(`Invalid event type: \`${e}\``);this._pipeDestinations.forEach(r=>{r.emit(e,...t)});const i=this._events[e];return!i||!i.length?!1:(i.slice(0).forEach(r=>r.apply(null,t)),!0)}setMaxListeners(e){if(parseInt(e,10)!==e)throw new TypeError;this._maxListeners=e}}var Qe=vm;var At={checkFramebufferStatus(e,t){const i=t.checkFramebufferStatus(t.FRAMEBUFFER),r={[t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT]:"Incomplete attachment",[t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT]:"Missing attachment",[t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS]:"Incomplete dimensions",[t.FRAMEBUFFER_UNSUPPORTED]:"Framebuffer unsupported"};i!==t.FRAMEBUFFER_COMPLETE&&F.warn(e,`Framebuffer incomplete: ${r[i]}`)},determineGPUName(e){let t=null,i=null;e||(i=document.createElement("canvas"),e=i.getContext("experimental-webgl")||i.getContext("webgl"));const r=e&&e.getExtension("WEBGL_debug_renderer_info");return r&&(t=e.getParameter(r.UNMASKED_RENDERER_WEBGL),i&&i.remove()),t},isGPUBlacklisted(e,t=null){return!1}};class st{constructor(e,t){this.x=e,this.y=t,typeof this.x=="undefined"&&(this.x=0),typeof this.y=="undefined"&&(this.y=0)}set(e,t){return this.x=e,this.y=t,this}clone(){return new st(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}clamp(e,t){const i=e!==null&&typeof e!="undefined",r=t!==null&&typeof t!="undefined";return!(e instanceof st)&&i&&(e=new st(e,e)),!(t instanceof st)&&r&&(t=new st(t,t)),i&&(this.x=Math.max(e.x,this.x),this.y=Math.max(e.y,this.y)),r&&(this.x=Math.min(t.x,this.x),this.y=Math.min(t.y,this.y)),this}divide(e,t){return e instanceof st?(this.x/=e.x,this.y/=e.y):(this.x/=e,this.y/=typeof t=="undefined"?e:t),this}subtract(e,t){return e instanceof st?(this.x-=e.x,this.y-=e.y):(this.x-=e,this.y-=typeof t=="undefined"?e:t),this}multiply(e,t){return e instanceof st?(this.x*=e.x,this.y*=e.y):(this.x*=e,this.y*=typeof t=="undefined"?e:t),this}add(e,t){return e instanceof st?(this.x+=e.x,this.y+=e.y):(this.x+=e,this.y+=typeof t=="undefined"?e:t),this}dot(e,t){return e instanceof st?this.x*e.x+this.y*e.y:this.x*e+this.y*(typeof t=="undefined"?e:t)}equals(e,t){return e instanceof st?e.x===this.x&&e.y===this.y:e===this.x&&t===this.y}flip(){const e=this.x;return this.x=this.y,this.y=e,this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}floor(){return this.x|=0,this.y|=0,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}len(){return Math.sqrt(this.x*this.x+this.y*this.y)}min(){return Math.min(this.x,this.y)}max(){return Math.max(this.x,this.y)}toObject(){return{x:this.x,y:this.y}}toString(){return`Vector2({ x: ${this.x}, y: ${this.y} })`}roundDecimal(e){return this.x=parseFloat(this.x.toFixed(e)),this.y=parseFloat(this.y.toFixed(e)),this}asArray(e=!1){return e?[this.y,this.x]:[this.x,this.y]}static fromObject(e){return new st(e.x,e.y)}static get NULL(){return new st(0,0)}}var L=st;class eh{constructor(){this.reset()}multiply(e){let t,i,r,o,s,n;return t=this.a*e.a+this.b*e.c,i=this.a*e.b+this.b*e.d,r=this.c*e.a+this.d*e.c,o=this.c*e.b+this.d*e.d,s=this.tx*e.a+this.ty*e.c+e.tx,n=this.tx*e.b+this.ty*e.d+e.ty,this.a=t,this.b=i,this.c=r,this.d=o,this.tx=s,this.ty=n,this}applyToVector(e){const{x:t,y:i}=e;return e=e.clone(),e.x=this.a*t+this.c*i+this.tx,e.y=this.b*t+this.d*i+this.tx,e}applyInverseToVector(e){const t=1/(this.a*this.d+this.c*-this.b),{x:i,y:r}=e;return e=e.clone(),e.x=this.d*t*i+-this.c*t*r+(this.ty*this.c-this.tx*this.d)*t,e.y=this.a*t*r+-this.b*t*i+(-this.ty*this.a+this.tx*this.b)*t,e}rectangleToCoordinates(e,t=new L(0,0)){const i=e.width*(1-t.x),r=e.width*-t.x,o=e.height*(1-t.y),s=e.height*-t.y,n=[];return n.push(new L(this.a*r+this.c*s+this.tx,this.d*s+this.b*r+this.ty)),n.push(new L(this.a*i+this.c*s+this.tx,this.d*s+this.b*i+this.ty)),n.push(new L(this.a*i+this.c*o+this.tx,this.d*o+this.b*i+this.ty)),n.push(new L(this.a*r+this.c*o+this.tx,this.d*o+this.b*r+this.ty)),n}reset(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}toArray(){const e=[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1];return typeof Float32Array=="undefined"?e:new Float32Array(e)}toString(){return`Matrix({ a: ${this.a}, b: ${this.b}, c: ${this.c}, d: ${this.d}, tx: ${this.tx}, ty: ${this.ty} })`}static get IDENTITY(){return new eh}}var Tt=eh;class as{constructor(e=0,t=0,i=0,r=0){this.x=e,this.y=t,this.width=i,this.height=r}set(e,t,i,r){return this.x=e,this.y=t,this.width=i,this.height=r,this}clone(){return new as(this.x,this.y,this.width,this.height)}copy(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}equals(e,t,i,r){if(e instanceof as)return e.x===this.x&&e.y===this.y&&e.width===this.width&&e.height===this.height;const o=e;return o===this.x&&t===this.y&&i===this.width&&r===this.height}translate(e,t){return e instanceof L&&(t=e.y,e=e.x),this.x+=e,this.y+=t,this}scale(e,t){return e instanceof L?(t=e.y,e=e.x):t===void 0&&(t=e),this.width*=e,this.height*=t,this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.width=Math.round(this.width),this.height=Math.round(this.height),this}getPosition(){return new L(this.x,this.y)}getSize(){return new L(this.width,this.height)}insetBy(e,t){return this.x+=e,this.y+=t,this.width-=2*e,this.height-=2*t,this}intersects(e){const t=new L(this.x,this.y),i=new L(this.x+this.width,this.y+this.height),r=new L(e.x,e.y),o=new L(e.x+e.width,e.y+e.height);return!(r.x>i.x||t.x>o.x||o.y<t.y||i.y<r.y)}toString(){return`Rectangle({ x: ${this.x}, y: ${this.y}, width: ${this.width}, height: ${this.height} })`}static FromDiagonalPoints(e,t){let i=!1;t.x-e.x<0&&(i=!0);const r=i?t:e,o=i?e:t,s=o.x-r.x,n=o.y-r.y;return new as(r.x,r.y,s,n)}}var Ce=as;const ia={};Fe(ia,{BATCH_SIZE:()=>Oi,Color:()=>E,Constants:()=>Se,EventEmitter:()=>Qe,GLUtils:()=>At,Log:()=>F,Matrix:()=>Tt,Rectangle:()=>Ce,Utils:()=>S,VERTEX_BYTE_SIZE:()=>Yt,VERTEX_SIZE:()=>th,Vector2:()=>L});const Oi=2e3,th=5,Yt=th*4;class wm{constructor(){this._position=new L(0,0),this._scale=new L(1,1),this._pivot=new L(0,0),this._rotation=0,this._lastRotation=null,this._alpha=1,this._visible=!0,this._worldTransform=new Tt,this._parent=null,this._shaders=[],this._boundsNeedUpdate=!0,this._bounds=new Ce(0,0,1,1),this._localBoundsNeedUpdate=!0,this._localBounds=new Ce(0,0,1,1),this._tint=16777215,this._filterRectangle=new Ce(0,0,0,0)}renderWebGL(e){F.warn(this.constructor.name,"`renderWebGL` is abstract and not implemented in inherited class")}renderCanvas(e){F.warn(this.constructor.name,"`renderCanvas` is abstract and not implemented in inherited class")}updateTransform(){const e=this._parent?this._parent.getWorldTransform():Tt.IDENTITY,t=this._worldTransform,i=this._rotation!==this._lastRotation;i&&(this._sinRotation=Math.sin(this._rotation),this._cosRotation=Math.cos(this._rotation),this._lastRotation=this._rotation),t.a=this._cosRotation*this._scale.x,t.b=this._sinRotation*this._scale.x,t.c=-this._sinRotation*this._scale.y,t.d=this._cosRotation*this._scale.y,t.tx=this._position.x,t.ty=this._position.y,(this._pivot.x||this._pivot.y)&&(t.tx-=this._pivot.x*t.a+this._pivot.y*t.c,t.ty-=this._pivot.x*t.b+this._pivot.y*t.d),t.multiply(e),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}addShader(e){this._shaders.push(e)}removeShader(e){const t=this._shaders.indexOf(e);return t!==-1?(this._shaders.splice(t,1),!0):!1}removeShaderAt(e){return this._shaders[e]?(this._shaders.splice(e,1),!0):!1}getBounds(){return this._bounds.clone()}getPosition(){return this._position}setPosition(e,t){e instanceof L?this._position.copy(e):this._position.set(e,t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getScale(){return this._scale}setScale(e,t){e instanceof L?this._scale.copy(e):this._scale.set(e,t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getPivot(){return this._pivot}setPivot(e,t){e instanceof L?this._pivot.copy(e):this._pivot.set(e,t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getRotation(){return this._rotation}setRotation(e){this._rotation=e,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getAlpha(){return this._alpha}setAlpha(e){this._alpha=e}getWorldAlpha(){return this._parent?this._parent.getAlpha()*this._alpha:this._alpha}getWorldTransform(){return this._worldTransform}getParent(){return this._parent}setParent(e){this._parent=e}getFilterRectangle(){return this._filterRectangle}setFilterRectangle(e){this._filterRectangle.copy(e)}getTint(){return this._tint}setTint(e){this._tint=e}isVisible(){return this._visible}setVisible(e){this._visible=e}}var Gr=wm;class Tm extends Gr{constructor(...e){super(...e);this._children=[],this._filters=[]}addFilter(e){this._filters.push(e)}removeFilter(e){const t=this._filters.indexOf(e);return t!==-1?(this._filters.splice(t,1),!0):!1}setFilters(e){this._filters=e}addChild(e){const t=e.getParent();t!==null&&t.removeChild(e),e.setParent(this),this._children.push(e)}prependChild(e){const t=e.getParent();t!==null&&t.removeChild(e),e.setParent(this),this._children.unshift(e)}hasChild(e){const t=this._children.indexOf(e);return t!==-1}removeChild(e){const t=this._children.indexOf(e);t!==-1?(this._children.splice(t,1),e.setParent(null)):F.info(this.constructor.name,"Tried to remove a child that does not exist")}clearChildren(){this._children=[]}renderWebGL(e){if(!this._visible)return;const t=e.getFilterManager();this._filters&&this._filters.length&&t.pushFilters(this,this._filters),e.getCurrentObjectRenderer().start(),this._renderWebGL(e),this._children.forEach(i=>{i.renderWebGL(e)}),e.getCurrentObjectRenderer().flush(),this._filters&&this._filters.length&&t.popFilters(),e.getCurrentObjectRenderer().start()}_renderWebGL(e){}renderCanvas(e){if(!this._visible)return;const t=e.getFilterManager();this._filters&&this._filters.length&&t.pushFilters(this,this._filters),this._renderCanvas(e),this._children.forEach(i=>{i.renderCanvas(e)}),this._filters&&this._filters.length&&t.popFilters()}_renderCanvas(e){}updateTransform(){super.updateTransform(),this._children.forEach(e=>{e.updateTransform()})}getLocalBounds(){return this._localBoundsNeedUpdate&&(this._localBoundsNeedUpdate=!1),this._localBounds.clone()}getBounds(){return this._boundsNeedUpdate&&(this._boundsNeedUpdate=!1),this._bounds.clone()}getChildren(){return this._children}getFilters(){return this._filters}dispose(){}}var ls=Tm;"use strict";var Dm=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],Sm=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function rh(e,t,i,r,o,s){if(isNaN(s)||s<1)return;s|=0;var n=e.data,a,l,h,c,p,d,m,x,b,g,y,_,f,D,v,w,I,P,N,H,q,J,ie,ae,ke=s+s+1,Pe=r-1,de=o-1,A=s+1,M=A*(A+1)/2,G=new ih,ue,Y=G;for(h=1;h<ke;h++)Y=Y.next=new ih,h==A&&(ue=Y);Y.next=G;var ne=null,ge=null;m=d=0;var Oe=Dm[s],Le=Sm[s];for(l=0;l<o;l++){for(w=I=P=N=x=b=g=y=0,_=A*(H=n[d]),f=A*(q=n[d+1]),D=A*(J=n[d+2]),v=A*(ie=n[d+3]),x+=M*H,b+=M*q,g+=M*J,y+=M*ie,Y=G,h=0;h<A;h++)Y.r=H,Y.g=q,Y.b=J,Y.a=ie,Y=Y.next;for(h=1;h<A;h++)c=d+((Pe<h?Pe:h)<<2),x+=(Y.r=H=n[c])*(ae=A-h),b+=(Y.g=q=n[c+1])*ae,g+=(Y.b=J=n[c+2])*ae,y+=(Y.a=ie=n[c+3])*ae,w+=H,I+=q,P+=J,N+=ie,Y=Y.next;for(ne=G,ge=ue,a=0;a<r;a++)n[d+3]=ie=y*Oe>>Le,ie!==0?(ie=255/ie,n[d]=(x*Oe>>Le)*ie,n[d+1]=(b*Oe>>Le)*ie,n[d+2]=(g*Oe>>Le)*ie):n[d]=n[d+1]=n[d+2]=0,x-=_,b-=f,g-=D,y-=v,_-=ne.r,f-=ne.g,D-=ne.b,v-=ne.a,c=m+((c=a+s+1)<Pe?c:Pe)<<2,w+=ne.r=n[c],I+=ne.g=n[c+1],P+=ne.b=n[c+2],N+=ne.a=n[c+3],x+=w,b+=I,g+=P,y+=N,ne=ne.next,_+=H=ge.r,f+=q=ge.g,D+=J=ge.b,v+=ie=ge.a,w-=H,I-=q,P-=J,N-=ie,ge=ge.next,d+=4;m+=r}for(a=0;a<r;a++){for(I=P=N=w=b=g=y=x=0,d=a<<2,_=A*(H=n[d]),f=A*(q=n[d+1]),D=A*(J=n[d+2]),v=A*(ie=n[d+3]),x+=M*H,b+=M*q,g+=M*J,y+=M*ie,Y=G,h=0;h<A;h++)Y.r=H,Y.g=q,Y.b=J,Y.a=ie,Y=Y.next;for(p=r,h=1;h<=s;h++)d=p+a<<2,x+=(Y.r=H=n[d])*(ae=A-h),b+=(Y.g=q=n[d+1])*ae,g+=(Y.b=J=n[d+2])*ae,y+=(Y.a=ie=n[d+3])*ae,w+=H,I+=q,P+=J,N+=ie,Y=Y.next,h<de&&(p+=r);for(d=a,ne=G,ge=ue,l=0;l<o;l++)c=d<<2,n[c+3]=ie=y*Oe>>Le,ie>0?(ie=255/ie,n[c]=x*Oe>>Le,n[c+1]=b*Oe>>Le,n[c+2]=g*Oe>>Le):n[c]=n[c+1]=n[c+2]=0,x-=_,b-=f,g-=D,y-=v,_-=ne.r,f-=ne.g,D-=ne.b,v-=ne.a,c=a+((c=l+A)<de?c:de)*r<<2,x+=w+=ne.r=n[c],b+=I+=ne.g=n[c+1],g+=P+=ne.b=n[c+2],y+=N+=ne.a=n[c+3],ne=ne.next,_+=H=ge.r,f+=q=ge.g,D+=J=ge.b,v+=ie=ge.a,w-=H,I-=q,P-=J,N-=ie,ge=ge.next,d+=r}}function ih(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}let oh;oh=window.Image;var Ve=oh;class ui{constructor(e=1,t=0,i=0,r=0,o=0,s=0,n=1,a=0,l=0,h=0,c=0,p=0,d=1,m=0,x=0,b=0,g=0,y=0,_=1,f=0){this.set(e,t,i,r,o,s,n,a,l,h,c,p,d,m,x,b,g,y,_,f)}set(e,t,i,r,o,s,n,a,l,h,c,p,d,m,x,b,g,y,_,f){this.a=e,this.b=t,this.c=i,this.d=r,this.e=o,this.f=s,this.g=n,this.h=a,this.i=l,this.j=h,this.k=c,this.l=p,this.m=d,this.n=m,this.o=x,this.p=b,this.q=g,this.r=y,this.s=_,this.t=f}reset(){this.a=1,this.b=0,this.c=0,this.d=0,this.e=0,this.f=0,this.g=1,this.h=0,this.i=0,this.j=0,this.k=0,this.l=0,this.m=1,this.n=0,this.o=0,this.p=0,this.q=0,this.r=0,this.s=1,this.t=0}apply(e){const t=this.a*e.r+this.b*e.g+this.c*e.b+this.d*e.a+this.e,i=this.f*e.r+this.g*e.g+this.h*e.b+this.i*e.a+this.j,r=this.k*e.r+this.l*e.g+this.m*e.b+this.n*e.a+this.o,o=this.p*e.r+this.q*e.g+this.r*e.b+this.s*e.a+this.t;return new E(t,i,r,o)}multiply(e){let t,i,r,o,s,n,a,l,h,c,p,d,m,x,b,g,y,_,f,D;const v=e,w=this;return t=v.a*w.a+v.b*w.f+v.c*w.k+v.d*w.p,i=v.a*w.b+v.b*w.g+v.c*w.l+v.d*w.q,r=v.a*w.c+v.b*w.h+v.c*w.m+v.d*w.r,o=v.a*w.d+v.b*w.i+v.c*w.n+v.d*w.s,n=v.f*w.a+v.g*w.f+v.h*w.k+v.i*w.p,a=v.f*w.b+v.g*w.g+v.h*w.l+v.i*w.q,l=v.f*w.c+v.g*w.h+v.h*w.m+v.i*w.r,h=v.f*w.d+v.g*w.i+v.h*w.n+v.i*w.s,p=v.k*w.a+v.l*w.f+v.m*w.k+v.n*w.p,d=v.k*w.b+v.l*w.g+v.m*w.l+v.n*w.q,m=v.k*w.c+v.l*w.h+v.m*w.m+v.n*w.r,x=v.k*w.d+v.l*w.i+v.m*w.n+v.n*w.s,g=v.p*w.a+v.q*w.f+v.r*w.k+v.s*w.p,y=v.p*w.b+v.q*w.g+v.r*w.l+v.s*w.q,_=v.p*w.c+v.q*w.h+v.r*w.m+v.s*w.r,f=v.p*w.d+v.q*w.i+v.r*w.n+v.s*w.s,s=v.a*w.e+v.b*w.j+v.c*w.o+v.d*w.t+v.e,c=v.f*w.e+v.g*w.j+v.h*w.o+v.i*w.t+v.j,b=v.k*w.e+v.l*w.j+v.m*w.o+v.n*w.t+v.o,D=v.p*w.e+v.q*w.j+v.r*w.o+v.s*w.t+v.t,this.a=t,this.b=i,this.c=r,this.d=o,this.e=s,this.f=n,this.g=a,this.h=l,this.i=h,this.j=c,this.k=p,this.l=d,this.m=m,this.n=x,this.o=b,this.p=g,this.q=y,this.r=_,this.s=f,this.t=D,this}clone(){const e=new ui;return e.set(this.a,this.b,this.c,this.d,this.e,this.f,this.g,this.h,this.i,this.j,this.k,this.l,this.m,this.n,this.o,this.p,this.q,this.r,this.s,this.t),e}equals(e){return this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f&&this.g===e.g&&this.h===e.h&&this.i===e.i&&this.j===e.j&&this.k===e.k&&this.l===e.l&&this.m===e.m&&this.n===e.n&&this.o===e.o&&this.p===e.p&&this.q===e.q&&this.r===e.r&&this.s===e.s&&this.t===e.t}getOffsets(){return[this.e,this.j,this.o,this.t]}toString(){return`ColorMatrix( ${this.a}, ${this.b}, ${this.c}, ${this.d}, ${this.e},
      ${this.f}, ${this.g}, ${this.h}, ${this.i}, ${this.j},
      ${this.k}, ${this.l}, ${this.m}, ${this.n}, ${this.o},
      ${this.p}, ${this.q}, ${this.r}, ${this.s}, ${this.t} )`}toArray(){return"abcdefghijklmnopqrst".split("").map(e=>this[e])}static get IDENTITY(){return new ui}static createBrightnessMatrix(e){const t=new ui;return t.e=e,t.j=e,t.o=e,t}static createContrastMatrix(e){const t=new ui,i=(1-e)/2;return t.a=t.g=t.m=e,t.e=t.j=t.o=i,t}static createSaturationMatrix(e=1){const t=new ui,i=1-e,r=.213*i,o=.715*i,s=.072*i;return t.a=r+e,t.b=o,t.c=s,t.f=r,t.g=o+e,t.h=s,t.k=r,t.l=o,t.m=s+e,t}static createExposureMatrix(e=0){const t=Math.pow(2,e);return new ui(t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0)}static createLinearMatrix(e=1,t=0){const i=new ui;return i.a=i.g=i.m=e,i.e=i.j=i.o=t,i}}var Po=ui;class hs extends Qe{constructor(e={},t={}){super();this.availableOptions=this.availableOptions||{},this.availableOptions=S.extend(this.availableOptions,t),this._onConfigurableUpdate=this._onConfigurableUpdate.bind(this),this._initOptions(e)}_buildConfigError(e){let t="";return this.constructor.name&&(t=`${this.constructor.name}: `),t+=e,new Error(t)}_onOptionsChange(){}validateSettings(){return new W((e,t)=>{for(const i in this.availableOptions){const r=this.availableOptions[i];if(r.required&&typeof this._options[i]=="undefined")return t(this._buildConfigError(`Option \`${i}\` is required.`))}e()})}_initOptions(e={}){this._options={};let t,i,r;const o=this;for(t in this.availableOptions){if(r=t.charAt(0).toUpperCase()+t.slice(1),i=this.availableOptions[t],[u.STRING,u.NUMBER,u.BOOLEAN,u.OBJECT,u.VECTOR2,u.COLOR,u.CONFIGURABLE,u.COLOR_MATRIX,u.ARRAY,u.IMAGE,u.FUNCTION,u.ALL].indexOf(i.type)===-1)throw this._buildConfigError(`Unknown option type: \`${i.type}\``);const s=function(a,l){o[`set${r}`]=function(h,c,p){o.setOption(a,h,c,p)},o[`get${r}`]=function(){return o.getOption(a)}};if(s(t,i),i.type===u.CONFIGURABLE&&(this._options[t]=new hs(void 0,i.structure||{}),this._options[t].on("update",this._onConfigurableUpdate)),!(t in e)||typeof e[t]=="undefined")if(typeof i.default!="undefined"){let n=i.default;typeof i.default=="function"&&(n=i.default()),this[`set${r}`](n,!1,!0)}else i.type!==u.CONFIGURABLE&&(this._options[t]=void 0)}for(t in e){if(typeof this.availableOptions[t]=="undefined")throw new Error(`Invalid option: ${t}`);typeof e[t]!="undefined"&&(r=t.charAt(0).toUpperCase()+t.slice(1),this[`set${r}`](e[t],!1,!0))}}set(e,t=!0){for(const i in e)this.setOption(i,e[i],!1);this._onOptionsChange(),t&&this.emit("update",this,e)}getOption(e){return this._options[e]}hasOption(e){return!!this.availableOptions[e]}getOptionDefault(e){const t=this.availableOptions[e];if(!t)throw new Error(`Invalid option: ${e}`);return t.default}resetOptions(){this.set(this.getDefaultOptions())}getDefaultOptions(){const e={};for(const t in this.availableOptions){const i=this.availableOptions[t].default;if(typeof i=="undefined")continue;e[t]=i}return e}getOptions(){return T({},this._options)}equals(e){const t=e.getOptions();return this.optionsEqual(t)}optionsEqual(e){for(const t in e){const i=e[t];if(!this._optionEquals(t,i))return!1}return!0}_optionEquals(e,t){const i=this.availableOptions[e];if(typeof i=="undefined")throw new Error(`Invalid option: ${e}`);const r=this.availableOptions[e].type,o=this._options[e];if(o===t)return!0;if(typeof t=="undefined"||typeof o=="undefined")return!1;switch(r){case u.OBJECT:return typeof o.optionsEqual=="function"?o.optionsEqual(t._options):o===t;case u.STRING:case u.NUMBER:case u.BOOLEAN:case u.FUNCTION:case"*":return o===t;case u.VECTOR2:return o.equals(t);case u.COLOR:case u.COLOR_MATRIX:return t.equals(o);case u.CONFIGURABLE:return o.optionsEqual(t);case u.ARRAY:return this._arrayOptionEquals(e,t);case u.IMAGE:return o.src===t.src}}_arrayOptionEquals(e,t){const i=this._options[e];if(t.length!==i.length)return!1;let r=!0;for(let o=0;o<i.length;o++){const s=i[o],n=t[o];if(s instanceof hs){if(typeof n=="undefined"||!s.optionsEqual(n)){r=!1;break}}else if(n!==s){r=!1;break}}return r}serializeOptions(e=Object.keys(this._options),t=!1){const i={};return e.forEach(r=>{if(typeof this.availableOptions[r]=="undefined")return F.warn(`Trying to serialize a key that does not exist: ${r}`);if(this.availableOptions[r].serializable===!1)return;i[r]=this.serializeOption(r,t)}),i}serializeOption(e,t=!1){const i=this.availableOptions[e],r=i.type,o=this._options[e];if(!o)return o;if(i.serializable===!1)throw new Error(`Option \`${e}\` is not serializable.`);switch(r){case u.STRING:case u.NUMBER:case u.BOOLEAN:case u.OBJECT:case u.FUNCTION:case u.ALL:return o;case u.VECTOR2:return t?o.toObject():o.clone();case u.COLOR:case u.COLOR_MATRIX:return t?o.toArray():o.clone();case u.CONFIGURABLE:return o.serializeOptions(void 0,t);case u.ARRAY:return o.slice(0);case u.IMAGE:return t?o.src:o}}setOption(e,t,i=!0,r=!1){const o=this.availableOptions[e];if(!o)throw new Error(`Invalid option: ${e}`);if(typeof o.setter!="undefined"&&(t=o.setter.call(this,t,r)),typeof o.validation!="undefined"&&o.validation(t),t===null||typeof t=="undefined"){if(o.required)throw this._buildConfigError(`Option \`${e}\` is required.`);this._options[e]=t}else switch(o.type){case u.STRING:{if(typeof t!==u.STRING)throw this._buildConfigError(`Option \`${e}\` has to be a string.`);const{available:s}=o;if(typeof s!="undefined"&&s.indexOf(t)===-1)throw this._buildConfigError(`Invalid value for \`${e}\` (valid values are: ${o.available.join(", ")})`);this._options[e]=t;break}case u.NUMBER:if(typeof t!==u.NUMBER)throw this._buildConfigError(`Option \`${e}\` has to be a number.`);this._options[e]=t;break;case u.BOOLEAN:if(typeof t!==u.BOOLEAN)throw this._buildConfigError(`Option \`${e}\` has to be a boolean.`);this._options[e]=t;break;case u.VECTOR2:if(!(t instanceof L)&&!(typeof t=="object"&&"x"in t&&"y"in t))throw this._buildConfigError(`Option \`${e}\` has to be an instance of Vector2 or an Object holding x and y values.`);t instanceof L?this._options[e]=t.clone():this._options[e]=L.fromObject(t);break;case u.COLOR:if(!(t instanceof E))throw this._buildConfigError(`Option \`${e}\` has to be an instance of Color.`);this._options[e]=t;break;case u.COLOR_MATRIX:if(!(t instanceof Po))throw this._buildConfigError(`Option \`${e}\` has to be an instance of ColorMatrix.`);this._options[e]=t.clone();break;case u.FUNCTION:if(typeof t!="function")throw this._buildConfigError(`Option \`${e}\` has to be a function.`);this._options[e]=t;break;case u.OBJECT:case"*":this._options[e]=t;break;case u.IMAGE:if(typeof t=="string"){const s=new Ve;s.crossOrigin=S.getCrossOriginValue(o.crossOrigin),s.src=t,this._options[e]=s}else if(t instanceof Ve||typeof HTMLCanvasElement!="undefined"&&t instanceof HTMLCanvasElement||typeof HTMLImageElement!="undefined"&&t instanceof HTMLImageElement)this._options[e]=t;else throw this._buildConfigError(`Option \`${e}\` has to be an Image, Canvas or String.`);break;case u.CONFIGURABLE:t instanceof hs?this._options[e]=t:this._options[e].set(t);break;case u.ARRAY:if(!(t instanceof Array))throw this._buildConfigError(`Option \`${e}\` has to be an Array.`);this._options[e]=t.slice(0);break;default:throw this._buildConfigError(`Unknown option type: \`${o.type}\``)}i&&(this._onOptionsChange(),this.emit("update",this,{[e]:t}))}_onConfigurableUpdate(...e){this.emit("update",...e)}hasChanges(){const e=this.getDefaultOptions();return!this.optionsEqual(e)}}var Q=hs;const{Log:ra,Utils:Cm}=ia;class Em{constructor(e,t,i,r,o){this._renderer=e,this._vertexSource=t,this._fragmentSource=i,this._uniforms=r||{},this._uniformLocations={},this._attributes=o||[],this._attributeLocations={},this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange),this._init()}_init(){this._compile();const e=this._renderer.getContext();e.useProgram(this._program),this._cacheUniformLocations(),this._cacheAttributeLocations()}_onContextChange(){this._init()}setupBuffers(e,t){const i=this._renderer.getContext();i.bindBuffer(i.ARRAY_BUFFER,e),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t),i.vertexAttribPointer(this._attributeLocations.a_position,2,i.FLOAT,!1,Yt,0),i.vertexAttribPointer(this._attributeLocations.a_texCoord,2,i.FLOAT,!1,Yt,2*4),i.vertexAttribPointer(this._attributeLocations.a_color,4,i.UNSIGNED_BYTE,!0,Yt,4*4)}syncUniforms(){Object.keys(this._uniforms).forEach(e=>{this.syncUniform(e)})}syncUniform(e){const t=this._renderer.getContext(),i=this._uniforms[e],r=this._uniformLocations[e];switch(i.type){case k.SAMPLER2D:t.uniform1i(r,i.value);break;case k.INT:case k.INT1:t.uniform1i(r,i.value);break;case k.INT2:t.uniform2i(r,i.value[0],i.value[1]);break;case k.INT3:t.uniform3i(r,i.value[0],i.value[1],i.value[2]);break;case k.INT4:t.uniform4i(r,i.value[0],i.value[1],i.value[2],i.value[3]);break;case k.FLOAT:case k.FLOAT1:t.uniform1f(r,i.value);break;case k.FLOAT2:t.uniform2f(r,i.value[0],i.value[1]);break;case k.FLOAT3:t.uniform3f(r,i.value[0],i.value[1],i.value[2]);break;case k.FLOAT4:t.uniform4f(r,i.value[0],i.value[1],i.value[2],i.value[3]);break;case k.FLOAT_VECTOR2:t.uniform2fv(r,i.value);break;case k.MAT3:case k.MAT3FV:t.uniformMatrix3fv(r,!1,i.value);break;case k.MAT4:t.uniformMatrix4fv(r,!1,i.value);break;default:ra.warn(this.constructor.name,`Unknown uniform type: ${i.type}`)}}_cacheAttributeLocations(){const e=this._renderer.getContext();this._attributes.forEach(t=>{this._attributeLocations[t]=e.getAttribLocation(this._program,t)})}_cacheUniformLocations(){const e=this._renderer.getContext(),t=Object.keys(this._uniforms);t.forEach(i=>{this._uniformLocations[i]=e.getUniformLocation(this._program,i)})}_addPrecisionToSource(e){const t=this._renderer.getMaxFloatPrecision();let i="mediump";return Cm.isMobile()&&t==="highp"&&(i="highp"),`precision ${i} float;
${e}`}_compile(){const e=this._renderer.getContext(),t=this._compileShader(e.VERTEX_SHADER,this._vertexSource);this._vertexShader=t;const i=this._addPrecisionToSource(this._fragmentSource),r=this._compileShader(e.FRAGMENT_SHADER,i);this._fragmentShader=r;const o=e.createProgram();e.attachShader(o,t),e.attachShader(o,r),e.linkProgram(o);const s=e.getProgramParameter(o,e.LINK_STATUS);if(s)this._program=o;else{let n=e.getProgramInfoLog(o);e.isContextLost()&&(n="WebGL context lost"),e.deleteProgram(o),ra.error(this.constructor.name,`WebGL program linking error: ${n}`)}}_compileShader(e,t){const i=this._renderer.getContext(),r=i.createShader(e);i.shaderSource(r,t),i.compileShader(r);const o=i.getShaderParameter(r,i.COMPILE_STATUS);if(!o){let s=i.getShaderInfoLog(r);i.isContextLost()&&(s="WebGL context lost"),i.deleteShader(r),ra.error(this.constructor.name,`WebGL shader compilation error: ${s}`)}return r}setUniform(e,t,i=!1){this._uniforms[e].value=t,i&&this.syncUniform(e)}setUniforms(e,t=!1){for(const i in e)this._uniforms[i].value=e[i],t&&this.syncUniform(i)}getUniforms(){return this._uniforms}getAttributes(){return this._attributes}getAttributeLocations(){return this._attributeLocations}getProgram(){return this._program}dispose(){const e=this._renderer.getContext();e.deleteProgram(this._program),e.deleteShader(this._vertexShader),e.deleteShader(this._fragmentShader),this._uniforms=null,this._uniformLocations=null,this._attributes=null,this._attributeLocations=null,this._renderer.off("context",this._onContextChange)}}var jr=Em;var sh=`uniform sampler2D u_image;
varying vec2 v_texCoord;
varying vec4 v_color;

void main() {
  gl_FragColor = texture2D(u_image, v_texCoord) * v_color;
}
`;var nh=`attribute vec2 a_position;
attribute vec2 a_texCoord;
attribute vec4 a_color;
varying vec2 v_texCoord;
varying vec4 v_color;
uniform mat3 u_projMatrix;

void main() {
  gl_Position = vec4((u_projMatrix * vec3(a_position, 1)).xy, 0, 1);
  v_texCoord = a_texCoord;
  v_color = vec4(a_color.rgb * a_color.a, a_color.a);
}
`;const{UniformType:ah}=Se;class Xt extends jr{constructor(e,t,i){t=t||Xt.defaultVertexSource,i=i||Xt.defaultFragmentSource,super(e,t,i,Xt.defaultUniforms,Xt.defaultAttributes)}}Xt.defaultVertexSource=nh;Xt.defaultFragmentSource=sh;const Rm=new Tt;Xt.defaultUniforms={u_image:{type:ah.SAMPLER2D,value:0},u_projMatrix:{type:ah.MAT3,value:Rm.toArray()}};Xt.defaultAttributes=["a_position","a_texCoord","a_color"];var Qt=Xt;const{OptionType:oa,UniformType:sa,RendererType:lh}=Se;class km extends Q{_initOptions(e={}){this._shaders=[],this._availableUniforms=Qt.defaultUniforms,this._attributes=Qt.defaultAttributes,this._vertexSource=Qt.defaultVertexSource,this._fragmentSource=Qt.defaultFragmentSource,this._initUniforms(),super._initOptions(e)}_initUniforms(){this._uniforms={};for(const e in this._availableUniforms){const t=this._availableUniforms[e];this._uniforms[e]={type:t.type,value:t.default||null}}for(const e in this.availableOptions){const t=this.availableOptions[e];t.uniformType?this._uniforms[`u_${e}`]={type:t.uniformType,value:t.default||null}:F.trace(this.constructor.name,`Option \`${e}\` is missing a \`uniformType\`!`)}}setOption(e,t,i=!0){super.setOption(e,t,i);let r=t;const o=this.availableOptions[e];if(!o.uniformType)return;const s=`u_${e}`;switch(o.type){case oa.COLOR:o.uniformType===sa.FLOAT4?r=t.toGLColor():o.uniformType===sa.FLOAT3&&(r=t.toRGBGLColor());break;case oa.VECTOR2:r=[t.x,t.y];break;case oa.COLOR_MATRIX:{r=[t.a,t.b,t.c,t.d,t.f,t.g,t.h,t.i,t.k,t.l,t.m,t.n,t.p,t.q,t.r,t.s];const n=[t.e,t.j,t.o,t.t];this._uniforms[`${s}_vec`]={value:n,type:sa.FLOAT4}}}this.setUniform(s,r)}setUniform(e,t,i=!1){this._uniforms[e].value=t}setUniforms(e,t=!1){for(const i in e)this._uniforms[i].value=e[i],t&&this.syncUniform(i)}syncUniform(e){this._shaders.forEach(t=>{t.syncUniform(e)})}syncUniforms(){this._shaders.forEach(e=>{e.syncUniforms()})}getShaderForRenderer(e){const t=e.getContext();let i=this._shaders[t.id];return i||(i=new jr(e,this._vertexSource,this._fragmentSource,this._uniforms,this._attributes),this._shaders[t.id]=i),i}apply(e,t,i,r=!1){e.isOfType(lh.WEBGL)?this._applyWebGL(e,t,i,r):e.isOfType(lh.CANVAS)&&this._applyCanvas(e,t,i,r)}_applyWebGL(e,t,i,r=!1){const o=e.getContext(),s=this.getShaderForRenderer(e);e.setRenderTarget(i),r&&i.clear(),e.setShader(s);const n=e.getCurrentRenderTarget().getProjectionMatrix().toArray();s.setUniform("u_projMatrix",n),s.syncUniforms(),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,t.getTexture()),o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0)}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=i.getContext();F.warn(this.constructor.name,"`_applyCanvas` is not implemented. Just copying image data from `inputTarget` to `outputTarget`."),s.clearRect(0,0,o.width,o.height),s.drawImage(o,0,0)}dispose(){this._shaders.forEach(e=>e.dispose()),this._shaders=[]}_blurImage(e,t,i){const r=10,o=e.getCanvas(),s=Math.min(1,r/(i*Math.min(o.width,o.height))),n=S.createCanvas();n.width=Math.round(o.width*s),n.height=Math.round(o.height*s);const a=n.getContext("2d");a.drawImage(o,0,0,o.width,o.height,0,0,n.width,n.height);const l=i*Math.min(n.width,n.height),h=a.getImageData(0,0,n.width,n.height);rh(h,0,0,n.width,n.height,l),a.putImageData(h,0,0),t.getContext().drawImage(n,0,0,n.width,n.height,0,0,o.width,o.height)}}var Gt=km;var hh=`uniform sampler2D u_image;
varying vec2 v_texCoord;
varying vec4 v_color;

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4(color.a > 0. ? color.rgb / color.a : vec3(0), color.a);
}
`;class na extends Gt{constructor(){super();this._fragmentSource=hh}}var dh=`uniform sampler2D u_image;
varying vec2 v_texCoord;
uniform vec4 u_color;

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4(mix(color.rgb, u_color.rgb, u_color.a), color.a) * color.a;
}
`;const{OptionType:Om,UniformType:Fm}=Se;class uh extends Gt{constructor(...e){super(...e);this._fragmentSource=dh}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),{color:a}=this._options,l=s.getImageData(0,0,o.width,o.height),h=n.getImageData(0,0,o.width,o.height),c=o.width*o.height,p=new E,d=new E;for(let m=0;m<c*4;m+=4){p.set(l.data[m]/255,l.data[m+1]/255,l.data[m+2]/255,l.data[m+3]/255),d.set(h.data[m]/255,h.data[m+1]/255,h.data[m+2]/255,h.data[m+3]/255);const x=d.r+p.a*(p.r-d.r);h.data[m]=(x+p.a*(a.r-x))*255;const b=d.g+p.a*(p.g-d.g);h.data[m+1]=(b+p.a*(a.g-b))*255;const g=d.b+p.a*(p.b-d.b);h.data[m+2]=(g+p.a*(a.b-g))*255}n.putImageData(h,0,0)}}uh.prototype.availableOptions={color:{type:Om.COLOR,default:E.WHITE,uniformType:Fm.FLOAT4}};var ch=uh;var ph=`uniform sampler2D u_image;
varying vec2 v_texCoord;
uniform vec4 u_color;
uniform int u_mode;

vec3 W = vec3(0.2125, 0.7154, 0.0721);

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  if (u_mode == 0) {
    gl_FragColor = color * color.a;
  } else if (u_mode == 1) {
    gl_FragColor = vec4(mix(color.rgb, u_color.rgb, u_color.a), color.a) * color.a;
  } else if (u_mode == 2) {
    float luminance = dot(color.rgb, W);
    vec3 colorized = vec3(luminance) * u_color.rgb;
    gl_FragColor = vec4(mix(color.rgb, colorized, u_color.a), color.a) * color.a;
  }
}
`;const{OptionType:mh,UniformType:gh}=Se;class Kr extends Gt{constructor(...e){super(...e);this._fragmentSource=ph}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=s.getImageData(0,0,o.width,o.height),{mode:l,color:h}=this._options,{r:c,g:p,b:d,a:m}=h,x=[.2125,.7154,.0721];switch(l){case Kr.MODES.SOLID:for(let b=0;b<o.width*o.height;b++){const g=b*4;a.data[g]+=(c*255-a.data[g])*m,a.data[g+1]+=(p*255-a.data[g+1])*m,a.data[g+2]+=(d*255-a.data[g+2])*m}break;case Kr.MODES.COLORIZED:for(let b=0;b<o.width*o.height;b++){const g=b*4,y=a.data[g]/255*x[0]+a.data[g+1]/255*x[1]+a.data[g+2]/255*x[2],_=new E(y*c,y*p,y*d);a.data[g]+=(_.r*255-a.data[g])*m,a.data[g+1]+=(_.g*255-a.data[g+1])*m,a.data[g+2]+=(_.b*255-a.data[g+2])*m}break}n.putImageData(a,0,0)}}Kr.MODES={NONE:0,SOLID:1,COLORIZED:2};Kr.prototype.availableOptions={color:{type:mh.COLOR,default:E.WHITE,uniformType:gh.FLOAT4},mode:{type:mh.NUMBER,default:Kr.MODES.NONE,uniformType:gh.INT}};var fh=Kr;var _h=`uniform sampler2D u_image;
varying vec2 v_texCoord;
uniform sampler2D u_overlayImage;
uniform int u_blendMode;
uniform float u_alpha;

const float EPSILON = 0.000001;

vec4 overlay(vec4 a, vec4 b) {
    vec3 result = mix(
          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),
          2.0 * a.rgb * b.rgb,
          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)
      );
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 hardLight(vec4 b, vec4 a) {
    vec3 result = mix(
          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),
          2.0 * a.rgb * b.rgb,
          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)
      );
    return mix(b, vec4(result, b.a), u_alpha * a.a);
}

vec4 softLight(vec4 a, vec4 b) {
    vec3 result = mix(
          2.0 * a.rgb * (1.0 - b.rgb) + (2.0 * b.rgb - 1.0) * sqrt(a.rgb),
          2.0 * a.rgb * b.rgb + a.rgb * a.rgb * (1.0 - 2.0 * b.rgb),
          vec3(b.r < 0.5, b.g < 0.5, b.b < 0.5)
      );
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 multiply(vec4 a, vec4 b) {
    vec3 result = a.rgb * b.rgb;
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 darken(vec4 a, vec4 b) {
    vec3 result = min(a.rgb, b.rgb);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 lighten(vec4 a, vec4 b) {
    vec3 result = max(a.rgb, b.rgb);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 screen(vec4 a, vec4 b) {
    vec3 result = 1.0 - (1.0 - a.rgb) * (1.0 - b.rgb);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 colorBurn(vec4 a, vec4 b) {
    vec3 result = clamp(1.0 - (1.0 - a.rgb) / max(b.rgb, EPSILON), 0.0, 1.0);
    return mix(a, vec4(result, a.a), u_alpha * b.a);
}

vec4 normal(vec4 a, vec4 b) {
    return mix(a, vec4(b.rgb, a.a), u_alpha * b.a);
}

void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  vec4 overlayColor = texture2D(u_overlayImage, v_texCoord);

  vec4 resultColor;
  if (u_blendMode == 0) {
    resultColor = normal(color, overlayColor);
  } else if (u_blendMode == 1) {
    resultColor = overlay(color, overlayColor);
  } else if (u_blendMode == 2) {
    resultColor = hardLight(color, overlayColor);
  } else if (u_blendMode == 3) {
    resultColor = softLight(color, overlayColor);
  } else if (u_blendMode == 4) {
    resultColor = multiply(color, overlayColor);
  } else if (u_blendMode == 5) {
    resultColor = darken(color, overlayColor);
  } else if (u_blendMode == 6) {
    resultColor = lighten(color, overlayColor);
  } else if (u_blendMode == 7) {
    resultColor = screen(color, overlayColor);
  } else if (u_blendMode == 8) {
    resultColor = colorBurn(color, overlayColor);
  }
  gl_FragColor = vec4(resultColor.rgb * resultColor.a, resultColor.a);
}
`;const{OptionType:ds,UniformType:aa}=Se,la=1e-6;class ft extends Gt{constructor(...e){super(...e);this._fragmentSource=_h,this._lastImage=null}_applyCanvas(e,t,i,r=!1){const o=this._options.overlayTexture.getRenderTarget().getContext(),s=t.getCanvas(),n=t.getContext(),a=i.getContext(),l=n.getImageData(0,0,s.width,s.height),h=o.getImageData(0,0,s.width,s.height),{blendMode:c,alpha:p}=this._options,d=new E,m=new E,x=new E;for(let b=0;b<s.width*s.height*4;b+=4){d.set(l.data[b]/255,l.data[b+1]/255,l.data[b+2]/255,l.data[b+3]/255),m.set(h.data[b]/255,h.data[b+1]/255,h.data[b+2]/255,h.data[b+3]/255);let g,y,_,f,D,v,w,I,P;switch(c){case ft.BLEND_MODES.NORMAL:x.set(d.r+m.a*p*(m.r-d.r),d.g+m.a*p*(m.g-d.g),d.b+m.a*p*(m.b-d.b),d.a);break;case ft.BLEND_MODES.OVERLAY:g=1-2*(1-d.r)*(1-m.r),y=2*d.r*m.r,_=g+(d.r<.5?1:0)*(y-g),f=1-2*(1-d.g)*(1-m.g),D=2*d.g*m.g,v=f+(d.g<.5?1:0)*(D-f),w=1-2*(1-d.b)*(1-m.b),I=2*d.b*m.b,P=w+(d.b<.5?1:0)*(I-w),x.set(d.r+m.a*p*(_-d.r),d.g+m.a*p*(v-d.g),d.b+m.a*p*(P-d.b),d.a);break;case ft.BLEND_MODES.HARD_LIGHT:g=1-2*(1-m.r)*(1-d.r),y=2*m.r*d.r,_=g+(m.r<.5?1:0)*(y-g),f=1-2*(1-m.g)*(1-d.g),D=2*m.g*d.g,v=f+(m.g<.5?1:0)*(D-f),w=1-2*(1-m.b)*(1-d.b),I=2*m.b*d.b,P=w+(m.b<.5?1:0)*(I-w),x.set(d.r+m.a*p*(_-d.r),d.g+m.a*p*(v-d.g),d.b+m.a*p*(P-d.b),d.a);break;case ft.BLEND_MODES.SOFT_LIGHT:g=2*d.r*(1-m.r)+(2*m.r-1)*Math.sqrt(d.r),y=2*d.r*m.r+d.r*d.r*(1-2*m.r),_=g+(m.r<.5?1:0)*(y-g),f=2*d.g*(1-m.g)+(2*m.g-1)*Math.sqrt(d.g),D=2*d.g*m.g+d.g*d.g*(1-2*m.g),v=f+(m.g<.5?1:0)*(D-f),w=2*d.b*(1-m.b)+(2*m.b-1)*Math.sqrt(d.b),I=2*d.b*m.b+d.b*d.b*(1-2*m.b),P=w+(m.b<.5?1:0)*(I-w),x.set(d.r+m.a*p*(_-d.r),d.g+m.a*p*(v-d.g),d.b+m.a*p*(P-d.b),d.a);break;case ft.BLEND_MODES.MULTIPLY:_=d.r*m.r,v=d.g*m.g,P=d.b*m.b,x.set(d.r+m.a*p*(_-d.r),d.g+m.a*p*(v-d.g),d.b+m.a*p*(P-d.b),d.a);break;case ft.BLEND_MODES.DARKEN:_=Math.min(d.r,m.r),v=Math.min(d.g,m.g),P=Math.min(d.b,m.b),x.set(d.r+m.a*p*(_-d.r),d.g+m.a*p*(v-d.g),d.b+m.a*p*(P-d.b),d.a);break;case ft.BLEND_MODES.LIGHTEN:_=Math.max(d.r,m.r),v=Math.max(d.g,m.g),P=Math.max(d.b,m.b),x.set(d.r+m.a*p*(_-d.r),d.g+m.a*p*(v-d.g),d.b+m.a*p*(P-d.b),d.a);break;case ft.BLEND_MODES.SCREEN:_=1-(1-d.r)*(1-m.r),v=1-(1-d.g)*(1-m.g),P=1-(1-d.b)*(1-m.b),x.set(d.r+m.a*p*(_-d.r),d.g+m.a*p*(v-d.g),d.b+m.a*p*(P-d.b),d.a);break;case ft.BLEND_MODES.COLOR_BURN:_=Math.max(0,Math.min(1,1-(1-d.r)/Math.max(m.r,la))),v=Math.max(0,Math.min(1,1-(1-d.g)/Math.max(m.g,la))),P=Math.max(0,Math.min(1,1-(1-d.b)/Math.max(m.b,la))),x.set(d.r+m.a*p*(_-d.r),d.g+m.a*p*(v-d.g),d.b+m.a*p*(P-d.b),d.a);break}l.data[b]=x.r*255,l.data[b+1]=x.g*255,l.data[b+2]=x.b*255,l.data[b+3]=x.a*255}a.putImageData(l,0,0)}}ft.BLEND_MODES={NORMAL:0,OVERLAY:1,HARD_LIGHT:2,SOFT_LIGHT:3,MULTIPLY:4,DARKEN:5,LIGHTEN:6,SCREEN:7,COLOR_BURN:8};ft.prototype.availableOptions={blendMode:{type:ds.NUMBER,default:ft.BLEND_MODES.NORMAL,uniformType:aa.INT},overlayImage:{type:ds.NUMBER,required:!0,uniformType:aa.SAMPLER2D},overlayTexture:{type:ds.OBJECT,required:!0},alpha:{type:ds.NUMBER,default:1,uniformType:aa.FLOAT}};var yh=ft;const ha={};Fe(ha,{ColorOverlayFilter:()=>ch,OverlayFilter:()=>yh,TintFilter:()=>fh,UnpremultiplyFilter:()=>na});class xe extends Qe{constructor(e){super();this.id=xe.id++,this._onSourceLoaded=this._onSourceLoaded.bind(this),this._renderers=[],this._glTextures={},this._source=e,this._dirty=!0,this._glUnit=0,this._mipMapping=!1,this._magFilter=xe.DefaultMagFilter,this._minFilter=xe.DefaultMinFilter,this._repeatX=xe.ClampToEdge,this._repeatY=xe.ClampToEdge,this._pixelRatio=1,this._loaded=!1,this._frame=new Ce(0,0,100,100),e&&this._loadSource()}resizeTo(e){if(this._frame.width===e.x&&this._frame.height===e.y)return;this._frame.width=e.x,this._frame.height=e.y,this._dirty=!0}_loadSource(){const e=this._source,t=e.complete,i=e.constructor.name==="Canvas"||e.tagName&&e.tagName.toUpperCase()==="CANVAS";if(t||i)return this._onSourceLoaded();e.addEventListener&&e.addEventListener("load",this._onSourceLoaded)}_onSourceLoaded(){this._loaded=!0,this.emit("loaded"),this.update()}_updateGLFilters(){const e=new L(this._source.width,this._source.height);S.isPowerOfTwo(e)?(F.info(this.constructor.name,"Mip-mapping enabled"),this._minFilter=xe.TrilinearFilter,this._mipMapping=!0):(this._minFilter=xe.LinearFilter,this._mipMapping=!1)}update(){(this._frame.width!==this._source.width||this._frame.height!==this._source.height)&&(this._frame=new Ce(0,0,this._source.width,this._source.height),this._dirty=!0),this._updateGLFilters(),this.emit("update")}getRenderers(){return[...this._renderers]}getGLFilter(e,t){switch(t){case"min":return this.constructor.getGLFilter(e,this._minFilter);case"mag":return this.constructor.getGLFilter(e,this._magFilter)}}static getGLFilter(e,t){switch(t){case xe.LinearFilter:return e.LINEAR;case xe.NearestFilter:return e.NEAREST;case xe.BilinearFilter:return e.LINEAR_MIPMAP_NEAREST;case xe.TrilinearFilter:return e.LINEAR_MIPMAP_LINEAR}}isLoaded(){return this._loaded}setLoaded(e){this._loaded=e}getSource(){return this._source}setSource(e){this._source=e}getGLTextureForRenderer(e){return this._glTextures[e.id]}setGLTextureForRenderer(e,t){this._renderers[t.id]=t,this._glTextures[t.id]=e}getFrame(){return this._frame}setFrame(e){this._frame=e}getDimensions(){return new L(this._frame.width,this._frame.height)}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e}getGLUnit(){return this._glUnit}setGLUnit(e){this._glUnit=e}setMinFilter(e){this._minFilter=e}getMinFilter(){return this._minFilter}setMagFilter(e){this._magFilter=e}getMagFilter(){return this._magFilter}setRepeatX(e){this._repeatX=e}getRepeatX(){return this._repeatX}setRepeatY(e){this._repeatY=e}getRepeatY(){return this._repeatY}getGLRepeat(e,t){const i=t==="x"?this.getRepeatX():this.getRepeatY();switch(i){case xe.ClampToEdge:return e.CLAMP_TO_EDGE;case xe.Repeat:return e.REPEAT;case xe.MirroredRepeat:return e.MIRRORED_REPEAT}}isDirty(){return this._dirty}setDirty(e){this._dirty=e}disposeGLTextures(){this._renderers.forEach(e=>{this.disposeGLTexturesForRenderer(e)})}disposeGLTexturesForRenderer(e){if(!this._glTextures[e.id])return;const t=e.getContext();t.deleteTexture(this._glTextures[e.id]),delete this._glTextures[e.id],this._renderers[e.id]||delete this._renderers[e.id]}isMipMappingEnabled(){return this._mipMapping}setMipMappingEnabled(e){this._mipMapping=e}dispose(e=null){this.disposeGLTextures(),this._source=void 0}}xe.NearestFilter=0;xe.LinearFilter=1;xe.BilinearFilter=2;xe.TrilinearFilter=3;xe.DefaultMagFilter=xe.NearestFilter;xe.DefaultMinFilter=xe.LinearFilter;xe.ClampToEdge=0;xe.Repeat=1;xe.MirroredRepeat=2;xe.id=0;var $e=xe;class Am{constructor(e,t,i,r,o){this._width=e,this._height=t,this._pixelRatio=i,this._baseTexture=new $e,this._canvas=r||this._createCanvas(),this._context=o||this._canvas.getContext("2d"),this._baseTexture.setSource(this._canvas),this._canvas.width=this._width*this._pixelRatio,this._canvas.height=this._height*this._pixelRatio,this._filterStack=[{renderTarget:this,filter:[]}]}_createCanvas(){return S.createCanvas()}clear(){const e=this._context;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}resizeTo(e){this._baseTexture.resizeTo(e),this._width!==e.x&&(this._width=e.x,this._canvas.width=this._width*this._pixelRatio),this._height!==e.y&&(this._height=e.y,this._canvas.height=this._height*this._pixelRatio)}getCanvas(){return this._canvas}getContext(){return this._context}getFilterStack(){return this._filterStack}getWidth(){return this._width}getHeight(){return this._height}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e}getDimensions(){return new L(this._width,this._height)}getBaseTexture(){return this._baseTexture}dispose(){this._canvas=null,this._context=null,this._baseTexture.dispose()}}var ci=Am;class Im{constructor(e){this._renderer=e,this._filterStack=[{renderTarget:e.getCurrentRenderTarget(),filters:[]}],this._currentFrame=null,this._textures=[],this._textureFrame=new Ce(0,0,e.getWidth(),e.getHeight())}resizeTo(e){this._textureFrame.width=e.x,this._textureFrame.height=e.y,this._textures.forEach(t=>t.resizeTo(e))}pushFilters(e,t){const i=e.getBounds();this._currentFrame=i;const r=this._getOrCreateRenderTarget();this._renderer.setRenderTarget(r),this._filterStack.push({renderTarget:r,filters:t}),r.clear()}popFilters(){const{filters:e,renderTarget:t}=this._filterStack.pop(),i=this._filterStack[this._filterStack.length-1],r=t,o=i.renderTarget;return e.length===1?(e[0].apply(this._renderer,r,o),this._textures.push(r)):this._applyFilters(e,r,o),e}_applyFilters(e,t,i){let r=t,o=this._getOrCreateRenderTarget(!0);const s=e[e.length-1];e.forEach((n,a)=>{const l=n===s;if(l)n.apply(this._renderer,r,i);else{n.apply(this._renderer,r,o);const h=r;r=o,o=h}}),this._textures.push(r),this._textures.push(o)}_getOrCreateRenderTarget(e){let t=this._textures.pop();return t||(t=new ci(this._textureFrame.width,this._textureFrame.height,1)),e&&t.clear(),t}setFilterStack(e){this._filterStack=e}dispose(){}}var Wr=Im;class Pm{constructor(e){this._renderer=e,this._context=this._renderer.getContext(),this._vertices=new Float32Array([0,0,100,0,100,100,0,100]),this._uvs=new Float32Array([0,0,1,0,1,1,0,1]),this._indices=new Uint16Array([0,1,2,0,3,2]),this._colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]),this._initBuffers(),this._uploadBuffers()}map(e,t){const{x:i,y:r}=t;this._uvs[2]=t.width/e.width,this._uvs[4]=this._uvs[2],this._uvs[5]=t.height/e.height,this._uvs[7]=this._uvs[5],this._vertices[0]=i,this._vertices[1]=r,this._vertices[2]=i+t.width,this._vertices[3]=r,this._vertices[4]=this._vertices[2],this._vertices[5]=r+t.height,this._vertices[6]=i,this._vertices[7]=this._vertices[5],this._uploadBuffers()}_initBuffers(){const e=this._context;this._vertexBuffer&&(e.deleteBuffer(this._vertexBuffer),this._vertexBuffer=null),this._indexBuffer&&(e.deleteBuffer(this._indexBuffer),this._indexBuffer=null),this._vertexBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,(8+8+16)*4,e.DYNAMIC_DRAW),this._indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indices,e.STATIC_DRAW)}_uploadBuffers(){const e=this._context;e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,this._vertices),e.bufferSubData(e.ARRAY_BUFFER,8*4,this._uvs),e.bufferSubData(e.ARRAY_BUFFER,(8+8)*4,this._colors)}getVertexBuffer(){return this._vertexBuffer}getIndexBuffer(){return this._indexBuffer}dispose(){const e=this._context;this._vertexBuffer&&(e.deleteBuffer(this._vertexBuffer),this._vertexBuffer=null),this._indexBuffer&&(e.deleteBuffer(this._indexBuffer),this._indexBuffer=null)}}var bh=Pm;class Bm{constructor(e,t,i,r,o=!1){this._renderer=e,this._gl=e.getContext(),this._width=t,this._height=i,this._frame=null,this._pixelRatio=r,this._projectionMatrix=new Tt,this._mipMapping=!1,this._baseTexture=new $e;const s=this._baseTexture.getFrame();s.width=t,s.height=i,this._baseTexture.setPixelRatio(r),this._baseTexture.setLoaded(!0),this._framebuffer=null,this._isRoot=o,this._filterStack=[{renderTarget:this,filter:[]}],o||this._initFrameBuffer()}resizeTo(e){this._width=e.x|0,this._height=e.y|0,this._baseTexture.resizeTo(e),this._isRoot||this._resizeTexture(),this._baseTexture.setMinFilter(this._getMinFilter()),this._baseTexture.setMagFilter(this._getMagFilter()),this._calculateProjectionMatrix()}_getMinFilter(){let e=$e.DefaultMinFilter;return this._mipMapping&&(e=$e.TrilinearFilter),e}_getMagFilter(){return $e.DefaultMagFilter}_resizeTexture(){const e=this._gl,t=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this._texture&&(e.deleteTexture(this._texture),this._texture=null),this._texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,i,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._texture,0),this._baseTexture.setGLTextureForRenderer(this._texture,this._renderer),this._renderer._options.debug&&At.checkFramebufferStatus("WebGLRenderTarget#_initFramebuffer",e);const r=new L(this._width,this._height);S.isPowerOfTwo(r)?(F.info("WebGLRenderTarget","Mip-mapping enabled"),this._mipMapping=!0):this._mipMapping=!1,this._baseTexture.setMipMappingEnabled(this._mipMapping)}activate(){const e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),this._calculateProjectionMatrix(),e.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),e.disable(e.STENCIL_TEST)}clear(e=E.TRANSPARENT){const t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._framebuffer),this._renderer._options.debug&&At.checkFramebufferStatus("WebGLRenderTarget#clear",t),t.clearColor.apply(t,e.toGLColor()),t.clear(t.COLOR_BUFFER_BIT)}_calculateProjectionMatrix(){const e=this._projectionMatrix;e.reset();const t=this._frame||new Ce(0,0,this._width,this._height),{x:i,y:r}=t;this._isRoot?(e.a=1/this._width*2,e.d=-1/this._height*2,e.tx=-1-i*e.a,e.ty=1-r*e.d):(e.a=1/this._width*2,e.d=1/this._height*2,e.tx=-1-i*e.a,e.ty=-1-r*e.d)}_initFrameBuffer(){const e=this._gl;this._framebuffer&&(e.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._texture&&(e.deleteTexture(this._texture),this._texture=null),this._framebuffer=e.createFramebuffer(),this._texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._texture),e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._texture,0),this._baseTexture.setGLTextureForRenderer(this._texture,this._renderer),this.resizeTo(new L(this._width,this._height)),this._renderer._options.debug&&At.checkFramebufferStatus("WebGLRenderTarget#_initFramebuffer",e)}getProjectionMatrix(){return this._projectionMatrix}getTexture(){return this._texture}getFrame(){return this._frame}setFrame(e){this._frame=e}getFilterStack(){return this._filterStack}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e,this._isRoot||this._resizeTexture()}getBaseTexture(){return this._baseTexture}dispose(){const e=this._gl;this._baseTexture.dispose(),this._framebuffer&&(e.deleteFramebuffer(this._framebuffer),this._framebuffer=null),this._texture&&(e.deleteTexture(this._texture),this._texture=null)}}var pi=Bm;const{RendererType:Mm}=Se;class Lm{constructor(e){this._renderer=e,this._filterStack=[{filters:[]}],this._currentFrame=null,this._renderTargets=[],this._textureFrame=new Ce(0,0,e.getWidth(),e.getHeight()),this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange),this._onContextChange()}resizeTo(e){this._textureFrame.width=e.x,this._textureFrame.height=e.y,this._renderTargets.forEach(t=>t.resizeTo(e))}getFilterStack(){return this._filterStack}setFilterStack(e){this._filterStack=e}_getOrCreateRenderTarget(e){let t=this._renderTargets.pop();return t||(t=new pi(this._renderer,this._textureFrame.width,this._textureFrame.height,1)),t.setFrame(this._currentFrame),e&&t.clear(),t}pushFilters(e,t){const i=e.getBounds();this._currentFrame=i;const r=e.getFilterRectangle();r.width>0&&r.height>0&&(this._currentFrame=r);const o=this._getOrCreateRenderTarget();this._renderer.setRenderTarget(o),o.clear(),this._filterStack.push({renderTarget:o,filters:t})}popFilters(){const{filters:e,renderTarget:t}=this._filterStack.pop(),i=this._filterStack[this._filterStack.length-1],r=t,o=i.renderTarget;this._quad.map(this._textureFrame,r.getFrame());const s=e[0].getShaderForRenderer(this._renderer),n=this._quad.getVertexBuffer(),a=this._quad.getIndexBuffer(),l=this._renderer.getContext();l.bindBuffer(l.ARRAY_BUFFER,n),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,a);const h=s.getAttributeLocations();return l.vertexAttribPointer(h.a_position,2,l.FLOAT,!1,0,0),l.vertexAttribPointer(h.a_texCoord,2,l.FLOAT,!1,0,2*4*4),l.vertexAttribPointer(h.a_color,4,l.FLOAT,!1,0,4*4*4),this._renderer.updateTexture(r.getBaseTexture(),!1),e.length===1?(e[0].apply(this._renderer,r,o),this._renderTargets.push(r)):this._applyFilters(e,r,o),e}_applyFilters(e,t,i){let r=t,o=this._getOrCreateRenderTarget(!0);this._renderer.updateTexture(o.getBaseTexture(),!1);const s=e[e.length-1];e.forEach((n,a)=>{const l=n===s;if(l)n.apply(this._renderer,r,i,!0);else{n.apply(this._renderer,r,o,!0);const h=r;r=o,o=h}}),this._renderTargets.push(r),this._renderTargets.push(o)}_onContextChange(){this._renderTargets.length=0,this._renderer.isOfType(Mm.WEBGL)&&(this._quad&&this._quad.dispose(),this._quad=new bh(this._renderer))}dispose(){this._renderer.off("context",this._onContextChange),this._quad&&this._quad.dispose(),this._renderTargets.forEach(e=>{e.dispose()})}}var Vr=Lm;const xh=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Be();class Nm{constructor(e){this._context=e,this._tracking=!1;const t=this;for(const i in e){const r=e[i];typeof r=="function"?this[i]=function(...o){const s=e[i];if(!t._tracking)return s.apply(e,o);const n=xh(),a=s.apply(e,o),l=xh()-n,h={functionName:i,arguments:o,duration:l};return t._trackedCalls.push(h),a}:this._makePropertyWrapper(i)}}_makePropertyWrapper(e){const t=["_context","_trackedCalls","_tracking"];if(t.indexOf(e)!==-1)return;const i=this._context;this.__defineGetter__(e,()=>i[e]),this.__defineSetter__(e,r=>{i[e]=r})}startFrame(){this._tracking=!0,this._trackedCalls=[]}endFrame(){const e="Rendering";F.log(e,"Frame rendering results:"),F.log(e,`Context calls: ${this._trackedCalls.length}`);const t={};this._trackedCalls.forEach(({functionName:r,duration:o})=>{t[r]=t[r]||{totalDuration:0,calls:0},t[r].totalDuration+=o,t[r].calls++});let i=[];for(const r in t){const o=t[r];o.averageDuration=o.totalDuration/o.calls,i.push({functionName:r,data:o})}i.sort((r,o)=>o.data.totalDuration-r.data.totalDuration),i=i.slice(0,3),i.forEach(r=>{F.log(e,`${r.functionName}: ${r.data.calls} calls, ${r.data.totalDuration.toFixed(2)}ms`)})}}var us=Nm;const zm={defaults:(e,...t)=>{const i={};for(const r in e)i[r]=e[r];for(let r=0;r<t.length;r++){const o=t[r];for(const s in o)typeof i[s]=="undefined"&&(i[s]=o[s])}return i},extend:(e,...t)=>{const i={};for(const r in e)i[r]=e[r];for(let r=0;r<t.length;r++){const o=t[r];for(const s in o)i[s]=o[s]}return i}};var vh=zm;class Um extends Qe{constructor(e,t,i={}){super();this._options=vh.defaults(i,{pixelRatio:1,transparent:!1,clearColor:E.BLACK}),this.setMaxListeners(0),this._width=e||800,this._height=t||600,this._dimensions=new L(this._width,this._height),this._maxTextureSize=null,this._pixelRatio=this._options.pixelRatio,this._clearColor=this._options.transparent?E.TRANSPARENT:this._options.clearColor||E.BLACK}setCanvas(e){const t=this._canvas;this._canvas=e,t!==e&&(this._createContext(),this._onBeforeContext(),this._setupContext()),this.resizeTo(new L(this._width,this._height))}getCanvas(){return this._canvas}_onBeforeContext(){}resizeTo(e,t=!0){this._width=e.x*this._pixelRatio,this._height=e.y*this._pixelRatio,t&&(this._canvas.width=this._width,this._canvas.height=this._height,this._canvas.style&&(this._canvas.style.width=`${this._width/this._pixelRatio}px`,this._canvas.style.height=`${this._height/this._pixelRatio}px`)),this._dimensions=e.clone()}_createContext(){F.warn(this.constructor.name,"`_createContext` is abstract and not implemented in inherited class")}_setupContext(){F.warn(this.constructor.name,"`_setupContext` is abstract and not implemented in inherited class")}render(e){F.warn(this.constructor.name,"`render` is abstract and not implemented in inherited class")}getMaxDimensions(){return null}getContext(){return this._context}getWidth(){return this._dimensions.x}getHeight(){return this._dimensions.y}getDimensions(){return this._dimensions}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e,this._defaultRenderTarget&&this._defaultRenderTarget.setPixelRatio(e)}getMaxTextureSize(){return this._maxTextureSize}getFilterManager(){return this._filterManager}setFilterManager(e){this._filterManager=e}static isSupported(){return!0}isOfType(e){return this._type===e}dispose(){F.warn(this.constructor.name,"`dispose` is abstract and not implemented in inherited class")}}var cs=Um;const{RendererType:Gm}=Se;class ps extends cs{constructor(...e){super(...e);this._type=Gm.CANVAS,this.setCanvas(this._options.canvas||this._createCanvas())}_createCanvas(){return S.createCanvas()}_createContext(){const e=this._canvas;let t=e.getContext("2d");return this._options.debug&&(t=new us(t)),this.id=t.id=ps.contextId++,this._context=t,t.renderer=this,this.emit("context",t),t}_setupContext(){const e=this._context;"imageSmoothingEnabled"in e?e.imageSmoothingEnabled=!0:["moz","webkit","ms"].forEach(t=>{e[t]&&(e[t]=!0)}),this._defaultRenderTarget=new ci(this._width,this._height,this._pixelRatio,this._canvas,this._context),this.setRenderTarget(this._defaultRenderTarget),this._filterManager=new Wr(this)}render(e){const t=this._renderTarget.getContext(),i=e.getParent();e.setParent(this._fakeObject),e.updateTransform(),e.setParent(i),t.setTransform(1,0,0,1,0,0),t.globalAlpha=1;const{width:r,height:o}=this._canvas;t.clearRect(0,0,r,o),this._clearColor.a!==0&&(t.save(),t.fillStyle=this._clearColor.toRGBA(),t.fillRect(0,0,r,o),t.restore()),this.renderDisplayObject(e,this._renderTarget)}renderDisplayObject(e,t){const i=this._renderTarget;this._filterManager.setFilterStack(t.getFilterStack()),this.setRenderTarget(t),e.renderCanvas(this),this.setRenderTarget(i)}getCurrentRenderTarget(){return this._renderTarget}setRenderTarget(e){this._renderTarget=e}getContext(){return this._renderTarget.getContext()}dispose(){this._filterManager.dispose()}}ps.contextId=0;ps.type="Canvas2D";var da=ps;class Bo{constructor(e,t,i){this.width=e,this.height=t,this.data=i}static fromNodeCanvasImage(e){}}const mi=Ne(tr());class ua{constructor(e){this._context=e,this._domAvailable=typeof document!="undefined",this._hookIntoContext(),this._textures={},this._framebuffers={},this._programs={},this._shaders={},this._buffers={},this._boundTexture=null,this._id=0,this._enums={},this._setupStats(),this._createEnumMap(),this._updateMemoryStats=this._updateMemoryStats.bind(this),this._updateMemoryStats()}_createEnumMap(){for(const e in this._context){const t=this._context[e];typeof t=="number"&&(this._enums[t]=e)}}_enumValueToString(e){const t=this._enums[e];return typeof t=="undefined"?e:t}_setupStats(){if(!this._domAvailable)return;this._stats=new mi.default,this._stats.showPanel(3),this._memPanel=this._stats.addPanel(new mi.default.Panel("MB [WebGL]","#43ADEB","#282828")),this._texPanel=this._stats.addPanel(new mi.default.Panel("Textures","#43ADEB","#282828")),this._bufPanel=this._stats.addPanel(new mi.default.Panel("Buffers","#43ADEB","#282828")),this._fboPanel=this._stats.addPanel(new mi.default.Panel("FBOs","#43ADEB","#282828")),this._prgPanel=this._stats.addPanel(new mi.default.Panel("Programs","#43ADEB","#282828")),this._shdPanel=this._stats.addPanel(new mi.default.Panel("Shaders","#43ADEB","#282828"))}_updatePanel(e){if(!this._domAvailable)return;this._stats.begin();switch(e){case"tex":this._texPanel.update(this.getTexturesCount(),50);break;case"buf":this._bufPanel.update(this.getBuffersCount(),50);break;case"fbo":this._fboPanel.update(this.getFBOCount(),50);break;case"prg":this._prgPanel.update(this.getProgramCount(),50);break;case"shd":this._shdPanel.update(this.getShaderCount(),50);break}this._stats.end()}getTexturesCount(){return Object.keys(this._textures).length}getBuffersCount(){return Object.keys(this._buffers).length}getFBOCount(){return Object.keys(this._framebuffers).length}getProgramCount(){return Object.keys(this._programs).length}getShaderCount(){return Object.keys(this._shaders).length}_updateMemoryStats(){if(!this._domAvailable)return;const e=this._getMemoryUsage()/1e3/1e3;this._memPanel.update(e,400),setTimeout(this._updateMemoryStats,1e3)}_getMemoryUsage(){let e=0;for(const t in this._textures)e+=this._textures[t].memory;for(const t in this._buffers)e+=this._buffers[t].memory;return e}_hookIntoContext(){for(const e in this._context){const t=this._context[e];typeof t=="function"?this[e]=function(...i){const r=this._context[e];return this._trackGLCall(r,e,i)}:this._makePropertyWrapper(e)}}_makePropertyWrapper(e){const t=["_context"];if(t.indexOf(e)!==-1)return;const i=this._context;this.__defineGetter__(e,()=>i[e]),this.__defineSetter__(e,r=>{i[e]=r})}_trackGLCall(e,t,i){const r=["texImage2D","bindTexture","createTexture","deleteTexture","createBuffer","bindBuffer","bufferData","deleteBuffer","createFramebuffer","deleteFramebuffer","createProgram","deleteProgram","createShader","deleteShader"];let o;r.indexOf(t)!==-1?o=this[`_${t}`](i):o=e.apply(this._context,i);const s=this._context.getError();if(s!==0){let n=i.join(", ");n.length>100&&(n=`${n.substr(0,100)}...`),console.error(new Error(`WebGL Error ${this._enumValueToString(s)} in ${t}(${n})`))}return o}_createProgram(){const e=this._context.createProgram();return e._wmmId=this._id++,this._programs[e._wmmId]=e,this._updatePanel("prg"),e}_deleteProgram([e]){if(!e||!this._programs[e._wmmId])return;delete this._programs[e._wmmId],this._context.deleteProgram(e),this._updatePanel("prg")}_createShader([e]){const t=this._context.createShader(e);return t._wmmId=this._id++,this._shaders[t._wmmId]=t,this._updatePanel("shd"),t}_deleteShader([e]){if(!e||!this._shaders[e._wmmId])return;delete this._shaders[e._wmmId],this._context.deleteShader(e),this._updatePanel("shd")}_createFramebuffer(){const e=this._context.createFramebuffer();return e._wmmId=this._id++,this._framebuffers[e._wmmId]=e,this._updatePanel("fbo"),e}_deleteFramebuffer([e]){if(!e||!this._framebuffers[e._wmmId])return;delete this._framebuffers[e._wmmId],this._context.deleteFramebuffer(e),this._updatePanel("fbo")}_createBuffer(){const e=this._context.createBuffer();return e._wmmId=this._id++,this._buffers[e._wmmId]={buffer:e,memory:0},this._updatePanel("buf"),e}_bindBuffer([e,t]){this._context.bindBuffer(e,t),this._boundBuffer=t._wmmId}_bufferData([e,t,i]){this._context.bufferData(e,t,i);let r;typeof t=="number"?r=t:"byteLength"in t?r=t.byteLength:"length"in t&&(r=t.length),this._buffers[this._boundBuffer].memory=r}_deleteBuffer([e]){if(!e||!this._buffers[e._wmmId])return;delete this._buffers[e._wmmId],this._context.deleteBuffer(e),this._updatePanel("buf")}_createTexture(){const e=this._context.createTexture();return e._wmmId=this._id++,this._textures[e._wmmId]={texture:e,memory:0},this._updatePanel("tex"),e}_deleteTexture([e]){if(!e||!this._textures[e._wmmId])return;delete this._textures[e._wmmId],this._context.deleteTexture(e),this._updatePanel("tex")}_bindTexture([e,t]){this._context.bindTexture(e,t),this._boundTexture=t._wmmId}_texImage2D(e){let[,,t,i,r,o,,,s]=e;typeof s=="undefined"&&(s=o),this._context.texImage2D.apply(this._context,e);const n=this._calculateByteCountForTexture(t,i,r,s);this._textures[this._boundTexture].memory=n}_calculateByteCountForTexture(e,t,i,r){if(r!==null)if("width"in r)t=r.width,i=r.height;else return r.length;let o=1;switch(e){case this._context.ALPHA:o=1;break;case this._context.RGB:o=3;break;case this._context.RGBA:o=4;break}return t*i*o}}class jm{constructor(e){this._renderer=e,this._onContextChange=this._onContextChange.bind(this),this._renderer.on("context",this._onContextChange)}_onContextChange(){}start(){}stop(){this.flush()}flush(){}dispose(){this._renderer.off("context",this._onContextChange),this._renderer=null}}var ms=jm;class Km extends ms{constructor(...e){super(...e);this._maxBatchSize=Oi,this._vertices=new ArrayBuffer(Oi*4*Yt),this._positions=new Float32Array(this._vertices),this._colors=new Uint32Array(this._vertices),this._indices=new Uint16Array(Oi*6);for(let t=0,i=0;t<Oi*6;t+=6,i+=4)this._indices[t+0]=i+0,this._indices[t+1]=i+1,this._indices[t+2]=i+2,this._indices[t+3]=i+0,this._indices[t+4]=i+2,this._indices[t+5]=i+3;this._shaders=[],this._sprites=[],this._currentBatchSize=0,this._onContextChange()}render(e){const t=e.getTexture(),i=t.getFrame(),r=t.getBaseTexture();this._currentBatchSize>=this._maxBatchSize&&this.flush();const o=t.getUVs();if(!o)return;const s=this._currentBatchSize*Yt;this._addVertexCoordinates(e,s,i),this._addTextureUVs(e,s,o),this._addColors(e,s),this._sprites[this._currentBatchSize]=e,this._currentBatchSize++}_addColors(e,t){const i=this._colors,r=e.getTint(),o=(r>>16)+(r&65280)+((r&255)<<16)+(e.getWorldAlpha()*255<<24);i[t+4]=i[t+9]=i[t+14]=i[t+19]=o}_addTextureUVs(e,t,i){const r=this._positions;let o=i.getUVsAt(0);r[t+2]=o.x,r[t+3]=o.y,o=i.getUVsAt(1),r[t+7]=o.x,r[t+8]=o.y,o=i.getUVsAt(2),r[t+12]=o.x,r[t+13]=o.y,o=i.getUVsAt(3),r[t+17]=o.x,r[t+18]=o.y}_addVertexCoordinates(e,t,i){const r=this._positions,o=e.getWorldTransform(),s=e.getAnchor(),n=o.rectangleToCoordinates(i,s),a=5;for(let l=0;l<4;l++)r[t+l*a]=n[l].x,r[t+l*a+1]=n[l].y}_onContextChange(){const e=this._renderer.getContext();this._shader=this._renderer.shaders.default,this._vertexBuffer&&(this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer=null),this._vertexBuffer=e.createBuffer(),this._indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indices,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this._vertices,e.DYNAMIC_DRAW)}start(){this._shader.setupBuffers(this._vertexBuffer,this._indexBuffer)}flush(){const e=this._renderer,t=e.getContext();if(this._currentBatchSize===0)return;if(this._currentBatchSize>Oi*.5)t.bufferSubData(t.ARRAY_BUFFER,0,this._vertices);else{const p=this._positions.subarray(0,this._currentBatchSize*Yt);t.bufferSubData(t.ARRAY_BUFFER,0,p)}let i=0,r=null,o=null,s=null,n=null,a=!1,l=!1,h=null,c=0;for(let p=0,d=this._currentBatchSize;p<d;p++){if(h=this._sprites[p],o=h.getTexture().getBaseTexture(),n=h.getShader()||this._shader,a=s!==n,l=r!==o,(l||a)&&(this._renderBatch(r,i,c),c=p,i=0,r=o,a)){s=n,e.setShader(s);const m=e.getCurrentRenderTarget(),x=m.getProjectionMatrix().toArray();s.setUniform("u_projMatrix",x),s.syncUniforms(),t.activeTexture(t.TEXTURE0)}i++}this._renderBatch(r,i,c),this._currentBatchSize=0,this._sprites=[]}_renderBatch(e,t,i){if(t===0)return;const r=this._renderer,o=r.getContext();let s=e.getGLTextureForRenderer(r);s||(s=r.getOrCreateGLTexture(e)),e.isDirty()&&(r.updateTexture(e),e.setDirty(!1)),o.activeTexture(o.TEXTURE0+e.getGLUnit()),o.bindTexture(o.TEXTURE_2D,s);const n=t*6,a=i*6*2;o.drawElements(o.TRIANGLES,n,o.UNSIGNED_SHORT,a)}dispose(){const e=this._renderer,t=e.getContext();for(const i in this._sprites)i.dispose();this._vertexBuffer&&(t.deleteBuffer(this._vertexBuffer),this._vertexBuffer=null),this._indexBuffer&&(t.deleteBuffer(this._indexBuffer),this._indexBuffer=null),this._vertices=null,this._positions=null,this._colors=null,this._indices=null,super.dispose()}}var wh=Km;const{RendererType:Wm}=Se;class gs extends cs{constructor(...e){super(...e);this._type=Wm.WEBGL,this._fakeObject=new Gr,this._onContextLost=this._onContextLost.bind(this),this._onContextRestored=this._onContextRestored.bind(this),this.setCanvas(this._options.canvas||S.createCanvas()),this._cachedBlitCanvas=S.createCanvas(),this.shaders=this._initShaders(),this.renderers=this._initRenderers()}_onContextLost(e){e.preventDefault(),F.warn(this.constructor.name,"WebGL context has been lost - trying to restore.")}_onContextCreationError(e){e.preventDefault(),F.warn(this.constructor.name,`Failed to create WebGL context: ${e.statusMessage||"Unknown error"}`)}_onContextRestored(){F.warn(this.constructor.name,"WebGL context has been restored. Clearing all textures."),this._createContext(),this._setupContext(),this.emit("context-restored")}_onBeforeContext(){this._filterManager&&this._filterManager.dispose(),this._filterManager=new Vr(this),this._currentObjectRenderer=new ms(this)}setShader(e){this._currentShader=e,this._context.useProgram(e.getProgram()),this._setAttributesForShader(e)}setCanvas(e){this._canvas&&this._removeContextEventListeners(),super.setCanvas(e),this._canvas.addEventListener&&this._addContextEventListeners()}_addContextEventListeners(){this._canvas.addEventListener("webglcontextlost",this._onContextLost),this._canvas.addEventListener("webglcontextrestored",this._onContextRestored),this._canvas.addEventListener("webglcontextcreationerror",this._onContextCreationError)}_removeContextEventListeners(){this._canvas.removeEventListener("webglcontextlost",this._onContextLost),this._canvas.removeEventListener("webglcontextrestored",this._onContextRestored),this._canvas.removeEventListener("webglcontextcreationerror",this._onContextCreationError)}_setAttributesForShader(e){const t=this._context,i=e.getAttributes(),r=e.getAttributeLocations();i.forEach(o=>{const s=r[o];t.enableVertexAttribArray(s)})}_initShaders(){return{default:new Qt(this)}}_initRenderers(){return{sprite:new wh(this)}}_createContext(){const e=this._canvas;let t=null;const i={preserveDrawingBuffer:!0};if(t=e.getContext("webgl",i)||e.getContext("experimental-webgl",i),typeof window!="undefined"&&window.WebGLDebugUtils&&this._options.debug){const r=(o,s)=>{console.error(`gl.${o}(${window.WebGLDebugUtils.glFunctionArgsToString(o,s)})`)};t=window.WebGLDebugUtils.makeDebugContext(t,null,r)}return this._options.debug&&(t=new us(t),t=new ua(t)),this.id=t.id=gs.contextId++,this._context=t,t.renderer=this,this._maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.emit("context",t),t}_setupContext(){const e=this._context;e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),this._defaultRenderTarget=new pi(this,this._width,this._height,this._pixelRatio,!0),this.setRenderTarget(this._defaultRenderTarget),this._getMaxPrecision()}_getMaxPrecision(){const e=this._context,t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);this._maxFloatPrecision=t.precision!==0?"highp":"mediump";const i=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_INT);this._maxIntPrecision=i.rangeMax!==0?"highp":"lowp"}resizeTo(e,t=!0){super.resizeTo(e,t),this._currentRenderTarget&&this._currentRenderTarget.resizeTo(e)}setRenderTarget(e=this._defaultRenderTarget){this._currentRenderTarget=e,this._currentRenderTarget.activate()}setObjectRenderer(e){this._currentObjectRenderer.stop(),this._currentObjectRenderer=e,this._currentObjectRenderer.start()}render(e){this.setRenderTarget(this._defaultRenderTarget),this._defaultRenderTarget.clear(this._clearColor);const t=e.getParent();e.setParent(this._fakeObject),e.updateTransform(),e.setParent(t),this.renderDisplayObject(e,this._defaultRenderTarget)}renderDisplayObject(e,t){this.setRenderTarget(t),this._filterManager.setFilterStack(t.getFilterStack()),e.renderWebGL(this),this._currentObjectRenderer.flush()}clear(){const e=this._context;e.clearColor.apply(e,this._clearColor.toGLColor()),e.clear(e.COLOR_BUFFER_BIT)}save(){return{renderTarget:this._currentRenderTarget,objectRenderer:this._currentObjectRenderer,filterStack:this._filterManager.getFilterStack()}}restore(e){this.setRenderTarget(e.renderTarget),this._filterManager.setFilterStack(e.filterStack),this._currentObjectRenderer=e.objectRenderer}getOrCreateGLTexture(e){const t=this._context;let i=e.getGLTextureForRenderer(this);return i||(i=t.createTexture(),e.setGLTextureForRenderer(i,this)),i}updateTexture(e,t=!0){let i=e.getSource();const r=!!i,o=this._context,s=e.getGLUnit(),n=this.getOrCreateGLTexture(e);if(o.activeTexture(o.TEXTURE0+s),o.bindTexture(o.TEXTURE_2D,n),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),t&&r)if(i instanceof Bo)o.texImage2D(o.TEXTURE_2D,0,o.RGBA,i.width,i.height,0,o.RGBA,o.UNSIGNED_BYTE,i.data);else{const a=S.convertHtmlImageToRGBACanvas(i,this._cachedBlitCanvas);o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,a)}e.isMipMappingEnabled()?o.generateMipmap(o.TEXTURE_2D):(o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,e.getGLRepeat(o,"x")),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,e.getGLRepeat(o,"y"))),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,e.getGLFilter(o,"min")),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,e.getGLFilter(o,"mag")),o.activeTexture(o.TEXTURE0)}getMaxDimensions(){let e=this.maxTextureDimensions;if(e===void 0){{const t=S.createCanvas(),i=t.getContext("webgl")||t.getContext("experimental-webgl");if(!i)e=null;else{const r=i.getParameter(i.MAX_TEXTURE_SIZE),o=i.getExtension("WEBGL_lose_context");o&&o.loseContext(),e=r}}this.maxTextureDimensions=e}return e}getCurrentRenderTarget(){return this._currentRenderTarget}getCurrentObjectRenderer(){return this._currentObjectRenderer}static isSupported(){{const e=S.createCanvas();e.addEventListener("webglcontextcreationerror",this.prototype._onContextCreationError);const t=e.getContext("webgl")||e.getContext("experimental-webgl");let i=!!t;if(i){const r=At.determineGPUName(t),o=At.isGPUBlacklisted(r);i&=!o}return e.removeEventListener("webglcontextcreationerror",this.prototype._onContextCreationError),i}return!0}getMaxFloatPrecision(){return this._maxFloatPrecision}getMaxIntPrecision(){return this._maxIntPrecision}dispose(){this._filterManager.dispose(),this._currentObjectRenderer.dispose(),this._defaultRenderTarget.dispose();for(const i in this.shaders)this.shaders[i].dispose(),delete this.shaders[i];this._removeContextEventListeners();const e=this._context,t=e.getExtension("WEBGL_lose_context");t&&t.loseContext()}}gs.contextId=0;gs.type="WebGL";var fs=gs;var Th={TextureShader:Qt};const Hr={EXPORT:"export",CLOSE:"close",OPERATION_CREATED:"operation:created",OPERATION_UPDATED:"operation:updated",OPERATION_REMOVED:"operation:removed",EDITOR_READY:"editor:ready",WINDOW_RESIZE:"window:resize",ZOOM_DONE:"editor:zoom_done",HISTORY_UNDO:"history:undo",HISTORY_UPDATED:"history:update",FEATURES_DISABLED:"editor:features:disabled",FEATURES_ENABLED:"editor:features:enabled",FEATURES_UPDATED:"editor:features:updated",TRANSFORM_REAPPLY_RATIO:"transform:reapply_ratio"};var Zt={DEFAULTS:{FILTERS:[{identifier:"imgly_filters_duotone",defaultName:"DuoTone",assetFileName:"duotone",filters:[{identifier:"imgly_duotone_desert",defaultName:"Desert",lightColor:"#e1de9a",darkColor:"#cb2129"},{identifier:"imgly_duotone_peach",defaultName:"Peach",lightColor:"#e9abb8",darkColor:"#0040ff"},{identifier:"imgly_duotone_clash",defaultName:"Clash",lightColor:"#f41a0f",darkColor:"#23007c"},{identifier:"imgly_duotone_plum",defaultName:"Plum",lightColor:"#74d7ff",darkColor:"#23007c"},{identifier:"imgly_duotone_breezy",defaultName:"Breezy",lightColor:"#68fdff",darkColor:"#c20000"},{identifier:"imgly_duotone_deepblue",defaultName:"Deep Blue",lightColor:"#2de9eb",darkColor:"#58007c"},{identifier:"imgly_duotone_frog",defaultName:"Frog",lightColor:"#5bff60",darkColor:"#7f23a9"},{identifier:"imgly_duotone_sunset",defaultName:"Sunset",lightColor:"#f8ea46",darkColor:"#c400be"}]},{identifier:"imgly_filters_bw",assetFileName:"b&w",defaultName:"Black & White",filters:[{identifier:"imgly_lut_ad1920",defaultName:"1920 A.D.",lutImage:"filters/imgly_lut_ad1920_5_5_128.png"},{identifier:"imgly_lut_bw",defaultName:"Greyed",lutImage:"filters/imgly_lut_bw_5_5_128.png"},{identifier:"imgly_lut_x400",defaultName:"Dusty",lutImage:"filters/imgly_lut_dusty_5_5_128.png"},{identifier:"imgly_lut_litho",defaultName:"Litho",lutImage:"filters/imgly_lut_litho_5_5_128.png"},{identifier:"imgly_lut_sepiahigh",defaultName:"Sepia",lutImage:"filters/imgly_lut_sepia_5_5_128.png"},{identifier:"imgly_lut_plate",defaultName:"Weathered",lutImage:"filters/imgly_lut_weathered_5_5_128.png"},{identifier:"imgly_lut_sin",defaultName:"Hard Stuff",lutImage:"filters/imgly_lut_hard_stuff_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8}]},{identifier:"imgly_filters_retro",assetFileName:"vintage",defaultName:"Vintage",filters:[{identifier:"imgly_lut_blues",defaultName:"Polaroid",lutImage:"filters/imgly_lut_polaroid_5_5_128.png"},{identifier:"imgly_lut_front",defaultName:"Sunny 70s",lutImage:"filters/imgly_lut_sunny_70s_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_texas",defaultName:"Oldtimer",lutImage:"filters/imgly_lut_oldtimer_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_celsius",defaultName:"Inferno",lutImage:"filters/imgly_lut_inferno_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_cool",defaultName:"Snappy",lutImage:"filters/imgly_lut_snappy_5_5_128.png"}]},{identifier:"imgly_filters_analog",assetFileName:"smooth",defaultName:"Smooth",filters:[{identifier:"imgly_lut_chest",defaultName:"Chestnut",lutImage:"filters/imgly_lut_chestnut_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_winter",defaultName:"Softly",lutImage:"filters/imgly_lut_softly_5_5_128.png"},{identifier:"imgly_lut_kdynamic",defaultName:"Pebble",lutImage:"filters/imgly_lut_pebble_5_5_128.png"},{identifier:"imgly_lut_fall",defaultName:"Moss",lutImage:"filters/imgly_lut_moss_5_5_128.png"},{identifier:"imgly_lut_lenin",defaultName:"Lemon",lutImage:"filters/imgly_lut_lemon_5_5_128.png"},{identifier:"imgly_lut_pola669",defaultName:"Green Gap",lutImage:"filters/imgly_lut_green_gap_5_5_128.png"}]},{identifier:"imgly_filters_winter",assetFileName:"cold",defaultName:"Cold",filters:[{identifier:"imgly_lut_elder",defaultName:"Colla",lutImage:"filters/imgly_lut_colla_5_5_128.png"},{identifier:"imgly_lut_orchid",defaultName:"Solanus",lutImage:"filters/imgly_lut_solanus_5_5_128.png"},{identifier:"imgly_lut_bleached",defaultName:"Kalmen",lutImage:"filters/imgly_lut_kalmen_5_5_128.png"},{identifier:"imgly_lut_bleachedblue",defaultName:"Joran",lutImage:"filters/imgly_lut_joran_5_5_128.png"},{identifier:"imgly_lut_breeze",defaultName:"Levante",lutImage:"filters/imgly_lut_levante_5_5_128.png"},{identifier:"imgly_lut_blueshadows",defaultName:"Zephyr",lutImage:"filters/imgly_lut_zephyr_5_5_128.png"}]},{identifier:"imgly_filters_summer",assetFileName:"warm",defaultName:"Warm",filters:[{identifier:"imgly_lut_sunset",defaultName:"Golden",lutImage:"filters/imgly_lut_golden_5_5_128.png"},{identifier:"imgly_lut_eighties",defaultName:"Low Fire",lutImage:"filters/imgly_lut_low_fire_5_5_128.png"},{identifier:"imgly_lut_evening",defaultName:"Sunrise",lutImage:"filters/imgly_lut_sunrise_5_5_128.png"},{identifier:"imgly_lut_k2",defaultName:"Flat Black",lutImage:"filters/imgly_lut_flat_black_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_nogreen",defaultName:"Pumpkin",lutImage:"filters/imgly_lut_pumpkin_5_5_128.png"}]},{identifier:"imgly_filters_legacy",defaultName:"Legacy",assetFileName:"legacy",filters:[{identifier:"imgly_lut_ancient",defaultName:"Ancient",lutImage:"filters/imgly_lut_ancient_5_5_128.png"},{identifier:"imgly_lut_cottoncandy",defaultName:"Candy",lutImage:"filters/imgly_lut_cottoncandy_5_5_128.png"},{identifier:"imgly_lut_classic",defaultName:"Classic",lutImage:"filters/imgly_lut_classic_5_5_128.png"},{identifier:"imgly_lut_colorful",defaultName:"Colorful",lutImage:"filters/imgly_lut_colorful_5_5_128.png"},{identifier:"imgly_lut_creamy",defaultName:"Creamy",lutImage:"filters/imgly_lut_creamy_5_5_128.png"},{identifier:"imgly_lut_fixie",defaultName:"Fixie",lutImage:"filters/imgly_lut_fixie_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_food",defaultName:"Food",lutImage:"filters/imgly_lut_food_5_5_128.png"},{identifier:"imgly_lut_fridge",defaultName:"Fridge",lutImage:"filters/imgly_lut_fridge_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_glam",defaultName:"Glam",lutImage:"filters/imgly_lut_glam_5_5_128.png"},{identifier:"imgly_lut_gobblin",defaultName:"Gobblin",lutImage:"filters/imgly_lut_gobblin_5_5_128.png"},{identifier:"imgly_lut_highcontrast",defaultName:"Hicon",lutImage:"filters/imgly_lut_highcontrast_5_5_128.png"},{identifier:"imgly_lut_highcarb",defaultName:"High Carb",lutImage:"filters/imgly_lut_highcarb_5_5_128.png"},{identifier:"imgly_lut_k1",defaultName:"K1",lutImage:"filters/imgly_lut_k1_5_5_128.png"},{identifier:"imgly_lut_k6",defaultName:"K6",lutImage:"filters/imgly_lut_k6_5_5_128.png"},{identifier:"imgly_lut_keen",defaultName:"Keen",lutImage:"filters/imgly_lut_keen_5_5_128.png"},{identifier:"imgly_lut_lomo",defaultName:"Lomo",lutImage:"filters/imgly_lut_lomo_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_lomo100",defaultName:"Lomo 100",lutImage:"filters/imgly_lut_lomo100_5_5_128.png"},{identifier:"imgly_lut_lucid",defaultName:"Lucid",lutImage:"filters/imgly_lut_lucid_5_5_128.png"},{identifier:"imgly_lut_mellow",defaultName:"Mellow",lutImage:"filters/imgly_lut_mellow_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_neat",defaultName:"Neat",lutImage:"filters/imgly_lut_neat_5_5_128.png"},{identifier:"imgly_lut_pale",defaultName:"Pale",lutImage:"filters/imgly_lut_pale_5_5_128.png"},{identifier:"imgly_lut_pitched",defaultName:"Pitched",lutImage:"filters/imgly_lut_pitched_5_5_128.png"},{identifier:"imgly_lut_polasx",defaultName:"Pola SX",lutImage:"filters/imgly_lut_polasx_5_5_128.png"},{identifier:"imgly_lut_pro400",defaultName:"Pro 400",lutImage:"filters/imgly_lut_pro400_5_5_128.png"},{identifier:"imgly_lut_quozi",defaultName:"Quozi",lutImage:"filters/imgly_lut_quozi_5_5_128.png"},{identifier:"imgly_lut_settled",defaultName:"Settled",lutImage:"filters/imgly_lut_settled_5_5_128.png"},{identifier:"imgly_lut_seventies",defaultName:"Seventies",lutImage:"filters/imgly_lut_seventies_5_5_128.png"},{identifier:"imgly_lut_soft",defaultName:"Soft",lutImage:"filters/imgly_lut_soft_5_5_128.png"},{identifier:"imgly_lut_steel",defaultName:"Steel",lutImage:"filters/imgly_lut_steel_5_5_128.png"},{identifier:"imgly_lut_summer",defaultName:"Summer",lutImage:"filters/imgly_lut_summer_5_5_128.png"},{identifier:"imgly_lut_tender",defaultName:"Tender",lutImage:"filters/imgly_lut_tender_5_5_128.png"},{identifier:"imgly_lut_twilight",defaultName:"Twilight",lutImage:"filters/imgly_lut_twilight_5_5_128.png"}]}],OVERLAYS:[{identifier:"imgly_overlay_golden",defaultName:"Golden",image:"overlays/imgly_overlay_golden.jpg",thumbnail:"overlays/imgly_overlay_golden_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_bokeh",defaultName:"Bokeh",image:"overlays/imgly_overlay_bokeh.jpg",thumbnail:"overlays/imgly_overlay_bokeh_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_hearts",defaultName:"Hearts",image:"overlays/imgly_overlay_hearts.jpg",thumbnail:"overlays/imgly_overlay_hearts_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak1",defaultName:"Light Leak",image:"overlays/imgly_overlay_lightleak1.jpg",thumbnail:"overlays/imgly_overlay_lightleak1_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak2",defaultName:"Light Leak 2",image:"overlays/imgly_overlay_lightleak2.jpg",thumbnail:"overlays/imgly_overlay_lightleak2_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_rain",defaultName:"Rain",image:"overlays/imgly_overlay_rain.jpg",thumbnail:"overlays/imgly_overlay_rain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_wood",defaultName:"Wood",image:"overlays/imgly_overlay_wood.jpg",thumbnail:"overlays/imgly_overlay_wood_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_mosaic",defaultName:"Mosaic",image:"overlays/imgly_overlay_mosaic.jpg",thumbnail:"overlays/imgly_overlay_mosaic_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_chop",defaultName:"Chop",image:"overlays/imgly_overlay_chop.jpg",thumbnail:"overlays/imgly_overlay_chop_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_vintage",defaultName:"Vintage",image:"overlays/imgly_overlay_vintage.jpg",thumbnail:"overlays/imgly_overlay_vintage_thumb.jpg",blendMode:"darken"},{identifier:"imgly_overlay_metal",defaultName:"Metal",image:"overlays/imgly_overlay_metal.jpg",thumbnail:"overlays/imgly_overlay_metal_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_paper",defaultName:"Paper",image:"overlays/imgly_overlay_paper.jpg",thumbnail:"overlays/imgly_overlay_paper_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_painting",defaultName:"Painting",image:"overlays/imgly_overlay_painting.jpg",thumbnail:"overlays/imgly_overlay_painting_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_grain",defaultName:"Grain",image:"overlays/imgly_overlay_grain.jpg",thumbnail:"overlays/imgly_overlay_grain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_clouds",defaultName:"Clouds",image:"overlays/imgly_overlay_clouds.jpg",thumbnail:"overlays/imgly_overlay_clouds_thumb.jpg",blendMode:"softLight"},{identifier:"imgly_overlay_wall1",defaultName:"Wall",image:"overlays/imgly_overlay_wall1.jpg",thumbnail:"overlays/imgly_overlay_wall1_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_wall2",defaultName:"Wall 2",image:"overlays/imgly_overlay_wall2.jpg",thumbnail:"overlays/imgly_overlay_wall2_thumb.jpg",blendMode:"overlay"}],FRAME_CATEGORIES:[{identifier:"imgly_frame_generic",defaultName:"Generic",metaData:{backgroundImage:"frames/generic.png"},frames:[{identifier:"imgly_frame_dia",defaultName:"Dia",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_left.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_right.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",defaultName:"Art Decor",tintable:!0,layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",defaultName:"Black Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",defaultName:"Low Poly",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",defaultName:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}}]}],STICKER_CATEGORIES:[{identifier:"imgly_sticker_emoticons",defaultName:"Emoticons",metaData:{backgroundImage:"stickers/emoticons/background.png"},stickers:[{identifier:"imgly_sticker_emoticons_alien",defaultName:"Alien",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_alien.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_alien.png"],width:1e3,height:935}}},{identifier:"imgly_sticker_emoticons_angel",defaultName:"Angel",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angel.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angel.png"]}}},{identifier:"imgly_sticker_emoticons_angry",defaultName:"Angry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angry.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angry.png"]}}},{identifier:"imgly_sticker_emoticons_anxious",defaultName:"Anxious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_anxious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_anxious.png"]}}},{identifier:"imgly_sticker_emoticons_asleep",defaultName:"Asleep",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_asleep.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_asleep.png"]}}},{identifier:"imgly_sticker_emoticons_attention",defaultName:"Attention",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_attention.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_attention.png"]}}},{identifier:"imgly_sticker_emoticons_baby_chicken",defaultName:"Baby Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_baby_chicken.png"],width:61,height:42},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_baby_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_batman",defaultName:"Batman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_batman.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_batman.png"]}}},{identifier:"imgly_sticker_emoticons_beer",defaultName:"Beer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_beer.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_beer.png"]}}},{identifier:"imgly_sticker_emoticons_blush",defaultName:"Blush",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_blush.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_blush.png"]}}},{identifier:"imgly_sticker_emoticons_boxer",defaultName:"Boxer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_boxer.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_boxer.png"]}}},{identifier:"imgly_sticker_emoticons_business",defaultName:"Business",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_business.png"],width:60,height:63},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_business.png"]}}},{identifier:"imgly_sticker_emoticons_chicken",defaultName:"Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_chicken.png"],width:63,height:55},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_cool",defaultName:"Cool",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cool.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cool.png"]}}},{identifier:"imgly_sticker_emoticons_cry",defaultName:"Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cry.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cry.png"]}}},{identifier:"imgly_sticker_emoticons_deceased",defaultName:"Deceased",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_deceased.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_deceased.png"]}}},{identifier:"imgly_sticker_emoticons_devil",defaultName:"Devil",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_devil.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_devil.png"]}}},{identifier:"imgly_sticker_emoticons_duckface",defaultName:"Duckface",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_duckface.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_duckface.png"]}}},{identifier:"imgly_sticker_emoticons_furious",defaultName:"Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_furious.png"],width:62,height:61},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_furious.png"]}}},{identifier:"imgly_sticker_emoticons_grin",defaultName:"Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_grin.png"]}}},{identifier:"imgly_sticker_emoticons_guitar",defaultName:"Guitar",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_guitar.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_guitar.png"]}}},{identifier:"imgly_sticker_emoticons_harry_potter",defaultName:"Harry Potter",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_harry_potter.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_harry_potter.png"]}}},{identifier:"imgly_sticker_emoticons_hippie",defaultName:"Hippie",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hippie.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hippie.png"]}}},{identifier:"imgly_sticker_emoticons_hitman",defaultName:"Hitman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hitman.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hitman.png"]}}},{identifier:"imgly_sticker_emoticons_humourous",defaultName:"Humourous",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_humourous.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_humourous.png"]}}},{identifier:"imgly_sticker_emoticons_idea",defaultName:"Idea",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_idea.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_idea.png"]}}},{identifier:"imgly_sticker_emoticons_impatient",defaultName:"Impatient",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_impatient.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_impatient.png"]}}},{identifier:"imgly_sticker_emoticons_kiss",defaultName:"Kiss",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kiss.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kiss.png"]}}},{identifier:"imgly_sticker_emoticons_kisses",defaultName:"Kisses",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kisses.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kisses.png"]}}},{identifier:"imgly_sticker_emoticons_laugh",defaultName:"Laugh",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_laugh.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_laugh.png"]}}},{identifier:"imgly_sticker_emoticons_loud_cry",defaultName:"Loud Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loud_cry.png"],width:64,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loud_cry.png"]}}},{identifier:"imgly_sticker_emoticons_loving",defaultName:"Loving",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loving.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loving.png"]}}},{identifier:"imgly_sticker_emoticons_masked",defaultName:"Masked",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_masked.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_masked.png"]}}},{identifier:"imgly_sticker_emoticons_music",defaultName:"Music",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_music.png"],width:62,height:54},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_music.png"]}}},{identifier:"imgly_sticker_emoticons_nerd",defaultName:"Nerd",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_nerd.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_nerd.png"]}}},{identifier:"imgly_sticker_emoticons_ninja",defaultName:"Ninja",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_ninja.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_ninja.png"]}}},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",defaultName:"Not Speaking To You",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_not_speaking_to_you.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_not_speaking_to_you.png"]}}},{identifier:"imgly_sticker_emoticons_pig",defaultName:"Pig",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pig.png"],width:63,height:41},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pig.png"]}}},{identifier:"imgly_sticker_emoticons_pumpkin",defaultName:"Pumpkin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pumpkin.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pumpkin.png"]}}},{identifier:"imgly_sticker_emoticons_question",defaultName:"Question",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_question.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_question.png"]}}},{identifier:"imgly_sticker_emoticons_rabbit",defaultName:"Rabbit",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_rabbit.png"],width:65,height:47},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_rabbit.png"]}}},{identifier:"imgly_sticker_emoticons_sad",defaultName:"Sad",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sad.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sad.png"]}}},{identifier:"imgly_sticker_emoticons_sick",defaultName:"Sick",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sick.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sick.png"]}}},{identifier:"imgly_sticker_emoticons_skateboard",defaultName:"Skateboard",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skateboard.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skateboard.png"]}}},{identifier:"imgly_sticker_emoticons_skull",defaultName:"Skull",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skull.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skull.png"]}}},{identifier:"imgly_sticker_emoticons_sleepy",defaultName:"Sleepy",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sleepy.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sleepy.png"]}}},{identifier:"imgly_sticker_emoticons_smile",defaultName:"Smile",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smile.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smile.png"]}}},{identifier:"imgly_sticker_emoticons_smoking",defaultName:"Smoking",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smoking.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smoking.png"]}}},{identifier:"imgly_sticker_emoticons_sobbing",defaultName:"Sobbing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sobbing.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sobbing.png"]}}},{identifier:"imgly_sticker_emoticons_star",defaultName:"Star",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_star.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_star.png"]}}},{identifier:"imgly_sticker_emoticons_steaming_furious",defaultName:"Steaming Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_steaming_furious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_steaming_furious.png"]}}},{identifier:"imgly_sticker_emoticons_sunbathing",defaultName:"Sunbathing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sunbathing.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sunbathing.png"]}}},{identifier:"imgly_sticker_emoticons_tired",defaultName:"Tired",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tired.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tired.png"]}}},{identifier:"imgly_sticker_emoticons_tongue_out_wink",defaultName:"Tongue Out Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tongue_out_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tongue_out_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wave",defaultName:"Wave",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wave.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wave.png"]}}},{identifier:"imgly_sticker_emoticons_wide_grin",defaultName:"Wide Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wide_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wide_grin.png"]}}},{identifier:"imgly_sticker_emoticons_wink",defaultName:"Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wrestler",defaultName:"Wrestler",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wrestler.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wrestler.png"]}}}]},{identifier:"imgly_sticker_shapes",defaultName:"Shapes",metaData:{backgroundImage:"stickers/shapes/background.png"},stickers:[{identifier:"imgly_sticker_shapes_arrow_02",defaultName:"Arrow 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236}}},{identifier:"imgly_sticker_shapes_arrow_03",defaultName:"Arrow 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_01",defaultName:"Badge 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_04",defaultName:"Badge 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589}}},{identifier:"imgly_sticker_shapes_badge_06",defaultName:"Badge 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733}}},{identifier:"imgly_sticker_shapes_badge_08",defaultName:"Badge 4",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_11",defaultName:"Badge 5",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_12",defaultName:"Badge 6",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903}}},{identifier:"imgly_sticker_shapes_badge_13",defaultName:"Badge 7",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718}}},{identifier:"imgly_sticker_shapes_badge_15",defaultName:"Badge 8",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_18",defaultName:"Badge 9",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_19",defaultName:"Badge 10",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_19.png"],width:2127,height:481},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_19.png"],width:2127,height:481}}},{identifier:"imgly_sticker_shapes_badge_20",defaultName:"Badge 11",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404}}},{identifier:"imgly_sticker_shapes_badge_28",defaultName:"Badge 12",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_32",defaultName:"Badge 13",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_35",defaultName:"Badge 14",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002}}},{identifier:"imgly_sticker_shapes_badge_36",defaultName:"Badge 15",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668}}},{identifier:"imgly_sticker_shapes_spray_01",defaultName:"Spray 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039}}},{identifier:"imgly_sticker_shapes_spray_03",defaultName:"Spray 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779}}},{identifier:"imgly_sticker_shapes_spray_04",defaultName:"Spray 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248}}}]}]}};let ca={};ca=window.navigator;var gi,Vm=244837814094590,Dh=(Vm&16777215)==15715070;function R(e,t,i){e!=null&&(typeof e=="number"?this.fromNumber(e,t,i):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}function ce(){return new R(null)}function Hm(e,t,i,r,o,s){for(;--s>=0;){var n=t*this[e++]+i[r]+o;o=Math.floor(n/67108864),i[r++]=n&67108863}return o}function qm(e,t,i,r,o,s){for(var n=t&32767,a=t>>15;--s>=0;){var l=this[e]&32767,h=this[e++]>>15,c=a*l+h*n;l=n*l+((c&32767)<<15)+i[r]+(o&1073741823),o=(l>>>30)+(c>>>15)+a*h+(o>>>30),i[r++]=l&1073741823}return o}function Ym(e,t,i,r,o,s){for(var n=t&16383,a=t>>14;--s>=0;){var l=this[e]&16383,h=this[e++]>>14,c=a*l+h*n;l=n*l+((c&16383)<<14)+i[r]+o,o=(l>>28)+(c>>14)+a*h,i[r++]=l&268435455}return o}Dh&&ca.appName=="Microsoft Internet Explorer"?(R.prototype.am=qm,gi=30):Dh&&ca.appName!="Netscape"?(R.prototype.am=Hm,gi=26):(R.prototype.am=Ym,gi=28);R.prototype.DB=gi;R.prototype.DM=(1<<gi)-1;R.prototype.DV=1<<gi;var pa=52;R.prototype.FV=Math.pow(2,pa);R.prototype.F1=pa-gi;R.prototype.F2=2*gi-pa;var Xm="0123456789abcdefghijklmnopqrstuvwxyz",_s=new Array,qr,Dt;qr="0".charCodeAt(0);for(Dt=0;Dt<=9;++Dt)_s[qr++]=Dt;qr="a".charCodeAt(0);for(Dt=10;Dt<36;++Dt)_s[qr++]=Dt;qr="A".charCodeAt(0);for(Dt=10;Dt<36;++Dt)_s[qr++]=Dt;function Sh(e){return Xm.charAt(e)}function Ch(e,t){var i=_s[e.charCodeAt(t)];return i==null?-1:i}function Qm(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function Zm(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function fi(e){var t=ce();return t.fromInt(e),t}function Jm(e,t){var i;if(t==16)i=4;else if(t==8)i=3;else if(t==256)i=8;else if(t==2)i=1;else if(t==32)i=5;else if(t==4)i=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var r=e.length,o=!1,s=0;--r>=0;){var n=i==8?e[r]&255:Ch(e,r);if(n<0){e.charAt(r)=="-"&&(o=!0);continue}o=!1,s==0?this[this.t++]=n:s+i>this.DB?(this[this.t-1]|=(n&(1<<this.DB-s)-1)<<s,this[this.t++]=n>>this.DB-s):this[this.t-1]|=n<<s,s+=i,s>=this.DB&&(s-=this.DB)}i==8&&(e[0]&128)!=0&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&R.ZERO.subTo(this,this)}function $m(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t}function eg(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var i=(1<<t)-1,r,o=!1,s="",n=this.t,a=this.DB-n*this.DB%t;if(n-- >0)for(a<this.DB&&(r=this[n]>>a)>0&&(o=!0,s=Sh(r));n>=0;)a<t?(r=(this[n]&(1<<a)-1)<<t-a,r|=this[--n]>>(a+=this.DB-t)):(r=this[n]>>(a-=t)&i,a<=0&&(a+=this.DB,--n)),r>0&&(o=!0),o&&(s+=Sh(r));return o?s:"0"}function tg(){var e=ce();return R.ZERO.subTo(this,e),e}function ig(){return this.s<0?this.negate():this}function rg(e){var t=this.s-e.s;if(t!=0)return t;var i=this.t;if(t=i-e.t,t!=0)return this.s<0?-t:t;for(;--i>=0;)if((t=this[i]-e[i])!=0)return t;return 0}function ys(e){var t=1,i;return(i=e>>>16)!=0&&(e=i,t+=16),(i=e>>8)!=0&&(e=i,t+=8),(i=e>>4)!=0&&(e=i,t+=4),(i=e>>2)!=0&&(e=i,t+=2),(i=e>>1)!=0&&(e=i,t+=1),t}function og(){return this.t<=0?0:this.DB*(this.t-1)+ys(this[this.t-1]^this.s&this.DM)}function sg(e,t){var i;for(i=this.t-1;i>=0;--i)t[i+e]=this[i];for(i=e-1;i>=0;--i)t[i]=0;t.t=this.t+e,t.s=this.s}function ng(e,t){for(var i=e;i<this.t;++i)t[i-e]=this[i];t.t=Math.max(this.t-e,0),t.s=this.s}function ag(e,t){var i=e%this.DB,r=this.DB-i,o=(1<<r)-1,s=Math.floor(e/this.DB),n=this.s<<i&this.DM,a;for(a=this.t-1;a>=0;--a)t[a+s+1]=this[a]>>r|n,n=(this[a]&o)<<i;for(a=s-1;a>=0;--a)t[a]=0;t[s]=n,t.t=this.t+s+1,t.s=this.s,t.clamp()}function lg(e,t){t.s=this.s;var i=Math.floor(e/this.DB);if(i>=this.t){t.t=0;return}var r=e%this.DB,o=this.DB-r,s=(1<<r)-1;t[0]=this[i]>>r;for(var n=i+1;n<this.t;++n)t[n-i-1]|=(this[n]&s)<<o,t[n-i]=this[n]>>r;r>0&&(t[this.t-i-1]|=(this.s&s)<<o),t.t=this.t-i,t.clamp()}function hg(e,t){for(var i=0,r=0,o=Math.min(e.t,this.t);i<o;)r+=this[i]-e[i],t[i++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r-=e.s;i<this.t;)r+=this[i],t[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<e.t;)r-=e[i],t[i++]=r&this.DM,r>>=this.DB;r-=e.s}t.s=r<0?-1:0,r<-1?t[i++]=this.DV+r:r>0&&(t[i++]=r),t.t=i,t.clamp()}function dg(e,t){var i=this.abs(),r=e.abs(),o=i.t;for(t.t=o+r.t;--o>=0;)t[o]=0;for(o=0;o<r.t;++o)t[o+i.t]=i.am(0,r[o],t,o,0,i.t);t.s=0,t.clamp(),this.s!=e.s&&R.ZERO.subTo(t,t)}function ug(e){for(var t=this.abs(),i=e.t=2*t.t;--i>=0;)e[i]=0;for(i=0;i<t.t-1;++i){var r=t.am(i,t[i],e,2*i,0,1);(e[i+t.t]+=t.am(i+1,2*t[i],e,2*i+1,r,t.t-i-1))>=t.DV&&(e[i+t.t]-=t.DV,e[i+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(i,t[i],e,2*i,0,1)),e.s=0,e.clamp()}function cg(e,t,i){var r=e.abs();if(r.t<=0)return;var o=this.abs();if(o.t<r.t){t!=null&&t.fromInt(0),i!=null&&this.copyTo(i);return}i==null&&(i=ce());var s=ce(),n=this.s,a=e.s,l=this.DB-ys(r[r.t-1]);l>0?(r.lShiftTo(l,s),o.lShiftTo(l,i)):(r.copyTo(s),o.copyTo(i));var h=s.t,c=s[h-1];if(c==0)return;var p=c*(1<<this.F1)+(h>1?s[h-2]>>this.F2:0),d=this.FV/p,m=(1<<this.F1)/p,x=1<<this.F2,b=i.t,g=b-h,y=t==null?ce():t;for(s.dlShiftTo(g,y),i.compareTo(y)>=0&&(i[i.t++]=1,i.subTo(y,i)),R.ONE.dlShiftTo(h,y),y.subTo(s,s);s.t<h;)s[s.t++]=0;for(;--g>=0;){var _=i[--b]==c?this.DM:Math.floor(i[b]*d+(i[b-1]+x)*m);if((i[b]+=s.am(0,_,i,g,0,h))<_)for(s.dlShiftTo(g,y),i.subTo(y,i);i[b]<--_;)i.subTo(y,i)}t!=null&&(i.drShiftTo(h,t),n!=a&&R.ZERO.subTo(t,t)),i.t=h,i.clamp(),l>0&&i.rShiftTo(l,i),n<0&&R.ZERO.subTo(i,i)}function pg(e){var t=ce();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(R.ZERO)>0&&e.subTo(t,t),t}function Fi(e){this.m=e}function mg(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function gg(e){return e}function fg(e){e.divRemTo(this.m,null,e)}function _g(e,t,i){e.multiplyTo(t,i),this.reduce(i)}function yg(e,t){e.squareTo(t),this.reduce(t)}Fi.prototype.convert=mg;Fi.prototype.revert=gg;Fi.prototype.reduce=fg;Fi.prototype.mulTo=_g;Fi.prototype.sqrTo=yg;function bg(){if(this.t<1)return 0;var e=this[0];if((e&1)==0)return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function Ai(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function xg(e){var t=ce();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(R.ZERO)>0&&this.m.subTo(t,t),t}function vg(e){var t=ce();return e.copyTo(t),this.reduce(t),t}function wg(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var i=e[t]&32767,r=i*this.mpl+((i*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(i=t+this.m.t,e[i]+=this.m.am(0,r,e,t,0,this.m.t);e[i]>=e.DV;)e[i]-=e.DV,e[++i]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function Tg(e,t){e.squareTo(t),this.reduce(t)}function Dg(e,t,i){e.multiplyTo(t,i),this.reduce(i)}Ai.prototype.convert=xg;Ai.prototype.revert=vg;Ai.prototype.reduce=wg;Ai.prototype.mulTo=Dg;Ai.prototype.sqrTo=Tg;function Sg(){return(this.t>0?this[0]&1:this.s)==0}function Cg(e,t){if(e>4294967295||e<1)return R.ONE;var i=ce(),r=ce(),o=t.convert(this),s=ys(e)-1;for(o.copyTo(i);--s>=0;)if(t.sqrTo(i,r),(e&1<<s)>0)t.mulTo(r,o,i);else{var n=i;i=r,r=n}return t.revert(i)}function Eg(e,t){var i;return e<256||t.isEven()?i=new Fi(t):i=new Ai(t),this.exp(e,i)}R.prototype.copyTo=Qm;R.prototype.fromInt=Zm;R.prototype.fromString=Jm;R.prototype.clamp=$m;R.prototype.dlShiftTo=sg;R.prototype.drShiftTo=ng;R.prototype.lShiftTo=ag;R.prototype.rShiftTo=lg;R.prototype.subTo=hg;R.prototype.multiplyTo=dg;R.prototype.squareTo=ug;R.prototype.divRemTo=cg;R.prototype.invDigit=bg;R.prototype.isEven=Sg;R.prototype.exp=Cg;R.prototype.toString=eg;R.prototype.negate=tg;R.prototype.abs=ig;R.prototype.compareTo=rg;R.prototype.bitLength=og;R.prototype.mod=pg;R.prototype.modPowInt=Eg;R.ZERO=fi(0);R.ONE=fi(1);function Rg(){var e=ce();return this.copyTo(e),e}function kg(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Og(){return this.t==0?this.s:this[0]<<24>>24}function Fg(){return this.t==0?this.s:this[0]<<16>>16}function Ag(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function Ig(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function Pg(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),i=Math.pow(e,t),r=fi(i),o=ce(),s=ce(),n="";for(this.divRemTo(r,o,s);o.signum()>0;)n=(i+s.intValue()).toString(e).substr(1)+n,o.divRemTo(r,o,s);return s.intValue().toString(e)+n}function Bg(e,t){this.fromInt(0),t==null&&(t=10);for(var i=this.chunkSize(t),r=Math.pow(t,i),o=!1,s=0,n=0,a=0;a<e.length;++a){var l=Ch(e,a);if(l<0){e.charAt(a)=="-"&&this.signum()==0&&(o=!0);continue}n=t*n+l,++s>=i&&(this.dMultiply(r),this.dAddOffset(n,0),s=0,n=0)}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(n,0)),o&&R.ZERO.subTo(this,this)}function Mg(e,t,i){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,i),this.testBit(e-1)||this.bitwiseTo(R.ONE.shiftLeft(e-1),ma,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(R.ONE.shiftLeft(e-1),this);else{var r=new Array,o=e&7;r.length=(e>>3)+1,t.nextBytes(r),o>0?r[0]&=(1<<o)-1:r[0]=0,this.fromString(r,256)}}function Lg(){var e=this.t,t=new Array;t[0]=this.s;var i=this.DB-e*this.DB%8,r,o=0;if(e-- >0)for(i<this.DB&&(r=this[e]>>i)!=(this.s&this.DM)>>i&&(t[o++]=r|this.s<<this.DB-i);e>=0;)i<8?(r=(this[e]&(1<<i)-1)<<8-i,r|=this[--e]>>(i+=this.DB-8)):(r=this[e]>>(i-=8)&255,i<=0&&(i+=this.DB,--e)),(r&128)!=0&&(r|=-256),o==0&&(this.s&128)!=(r&128)&&++o,(o>0||r!=this.s)&&(t[o++]=r);return t}function Ng(e){return this.compareTo(e)==0}function zg(e){return this.compareTo(e)<0?this:e}function Ug(e){return this.compareTo(e)>0?this:e}function Gg(e,t,i){var r,o,s=Math.min(e.t,this.t);for(r=0;r<s;++r)i[r]=t(this[r],e[r]);if(e.t<this.t){for(o=e.s&this.DM,r=s;r<this.t;++r)i[r]=t(this[r],o);i.t=this.t}else{for(o=this.s&this.DM,r=s;r<e.t;++r)i[r]=t(o,e[r]);i.t=e.t}i.s=t(this.s,e.s),i.clamp()}function jg(e,t){return e&t}function Kg(e){var t=ce();return this.bitwiseTo(e,jg,t),t}function ma(e,t){return e|t}function Wg(e){var t=ce();return this.bitwiseTo(e,ma,t),t}function Eh(e,t){return e^t}function Vg(e){var t=ce();return this.bitwiseTo(e,Eh,t),t}function Rh(e,t){return e&~t}function Hg(e){var t=ce();return this.bitwiseTo(e,Rh,t),t}function qg(){for(var e=ce(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e}function Yg(e){var t=ce();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function Xg(e){var t=ce();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function Qg(e){if(e==0)return-1;var t=0;return(e&65535)==0&&(e>>=16,t+=16),(e&255)==0&&(e>>=8,t+=8),(e&15)==0&&(e>>=4,t+=4),(e&3)==0&&(e>>=2,t+=2),(e&1)==0&&++t,t}function Zg(){for(var e=0;e<this.t;++e)if(this[e]!=0)return e*this.DB+Qg(this[e]);return this.s<0?this.t*this.DB:-1}function Jg(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function $g(){for(var e=0,t=this.s&this.DM,i=0;i<this.t;++i)e+=Jg(this[i]^t);return e}function ef(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this[t]&1<<e%this.DB)!=0}function tf(e,t){var i=R.ONE.shiftLeft(e);return this.bitwiseTo(i,t,i),i}function rf(e){return this.changeBit(e,ma)}function of(e){return this.changeBit(e,Rh)}function sf(e){return this.changeBit(e,Eh)}function nf(e,t){for(var i=0,r=0,o=Math.min(e.t,this.t);i<o;)r+=this[i]+e[i],t[i++]=r&this.DM,r>>=this.DB;if(e.t<this.t){for(r+=e.s;i<this.t;)r+=this[i],t[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<e.t;)r+=e[i],t[i++]=r&this.DM,r>>=this.DB;r+=e.s}t.s=r<0?-1:0,r>0?t[i++]=r:r<-1&&(t[i++]=this.DV+r),t.t=i,t.clamp()}function af(e){var t=ce();return this.addTo(e,t),t}function lf(e){var t=ce();return this.subTo(e,t),t}function hf(e){var t=ce();return this.multiplyTo(e,t),t}function df(){var e=ce();return this.squareTo(e),e}function uf(e){var t=ce();return this.divRemTo(e,t,null),t}function cf(e){var t=ce();return this.divRemTo(e,null,t),t}function pf(e){var t=ce(),i=ce();return this.divRemTo(e,t,i),new Array(t,i)}function mf(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function gf(e,t){if(e==0)return;for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}function Mo(){}function kh(e){return e}function ff(e,t,i){e.multiplyTo(t,i)}function _f(e,t){e.squareTo(t)}Mo.prototype.convert=kh;Mo.prototype.revert=kh;Mo.prototype.mulTo=ff;Mo.prototype.sqrTo=_f;function yf(e){return this.exp(e,new Mo)}function bf(e,t,i){var r=Math.min(this.t+e.t,t);for(i.s=0,i.t=r;r>0;)i[--r]=0;var o;for(o=i.t-this.t;r<o;++r)i[r+this.t]=this.am(0,e[r],i,r,0,this.t);for(o=Math.min(e.t,t);r<o;++r)this.am(0,e[r],i,r,0,t-r);i.clamp()}function xf(e,t,i){--t;var r=i.t=this.t+e.t-t;for(i.s=0;--r>=0;)i[r]=0;for(r=Math.max(t-this.t,0);r<e.t;++r)i[this.t+r-t]=this.am(t-r,e[r],i,0,0,this.t+r-t);i.clamp(),i.drShiftTo(1,i)}function Yr(e){this.r2=ce(),this.q3=ce(),R.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function vf(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=ce();return e.copyTo(t),this.reduce(t),t}function wf(e){return e}function Tf(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function Df(e,t){e.squareTo(t),this.reduce(t)}function Sf(e,t,i){e.multiplyTo(t,i),this.reduce(i)}Yr.prototype.convert=vf;Yr.prototype.revert=wf;Yr.prototype.reduce=Tf;Yr.prototype.mulTo=Sf;Yr.prototype.sqrTo=Df;function Cf(e,t){var i=e.bitLength(),r,o=fi(1),s;if(i<=0)return o;i<18?r=1:i<48?r=3:i<144?r=4:i<768?r=5:r=6,i<8?s=new Fi(t):t.isEven()?s=new Yr(t):s=new Ai(t);var n=new Array,a=3,l=r-1,h=(1<<r)-1;if(n[1]=s.convert(this),r>1){var c=ce();for(s.sqrTo(n[1],c);a<=h;)n[a]=ce(),s.mulTo(c,n[a-2],n[a]),a+=2}var p=e.t-1,d,m=!0,x=ce(),b;for(i=ys(e[p])-1;p>=0;){for(i>=l?d=e[p]>>i-l&h:(d=(e[p]&(1<<i+1)-1)<<l-i,p>0&&(d|=e[p-1]>>this.DB+i-l)),a=r;(d&1)==0;)d>>=1,--a;if((i-=a)<0&&(i+=this.DB,--p),m)n[d].copyTo(o),m=!1;else{for(;a>1;)s.sqrTo(o,x),s.sqrTo(x,o),a-=2;a>0?s.sqrTo(o,x):(b=o,o=x,x=b),s.mulTo(x,n[d],o)}for(;p>=0&&(e[p]&1<<i)==0;)s.sqrTo(o,x),b=o,o=x,x=b,--i<0&&(i=this.DB-1,--p)}return s.revert(o)}function Ef(e){var t=this.s<0?this.negate():this.clone(),i=e.s<0?e.negate():e.clone();if(t.compareTo(i)<0){var r=t;t=i,i=r}var o=t.getLowestSetBit(),s=i.getLowestSetBit();if(s<0)return t;for(o<s&&(s=o),s>0&&(t.rShiftTo(s,t),i.rShiftTo(s,i));t.signum()>0;)(o=t.getLowestSetBit())>0&&t.rShiftTo(o,t),(o=i.getLowestSetBit())>0&&i.rShiftTo(o,i),t.compareTo(i)>=0?(t.subTo(i,t),t.rShiftTo(1,t)):(i.subTo(t,i),i.rShiftTo(1,i));return s>0&&i.lShiftTo(s,i),i}function Rf(e){if(e<=0)return 0;var t=this.DV%e,i=this.s<0?e-1:0;if(this.t>0)if(t==0)i=this[0]%e;else for(var r=this.t-1;r>=0;--r)i=(t*i+this[r])%e;return i}function kf(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return R.ZERO;for(var i=e.clone(),r=this.clone(),o=fi(1),s=fi(0),n=fi(0),a=fi(1);i.signum()!=0;){for(;i.isEven();)i.rShiftTo(1,i),t?((!o.isEven()||!s.isEven())&&(o.addTo(this,o),s.subTo(e,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;r.isEven();)r.rShiftTo(1,r),t?((!n.isEven()||!a.isEven())&&(n.addTo(this,n),a.subTo(e,a)),n.rShiftTo(1,n)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);i.compareTo(r)>=0?(i.subTo(r,i),t&&o.subTo(n,o),s.subTo(a,s)):(r.subTo(i,r),t&&n.subTo(o,n),a.subTo(s,a))}if(r.compareTo(R.ONE)!=0)return R.ZERO;if(a.compareTo(e)>=0)return a.subtract(e);if(a.signum()<0)a.addTo(e,a);else return a;return a.signum()<0?a.add(e):a}var et=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Of=(1<<26)/et[et.length-1];function Ff(e){var t,i=this.abs();if(i.t==1&&i[0]<=et[et.length-1]){for(t=0;t<et.length;++t)if(i[0]==et[t])return!0;return!1}if(i.isEven())return!1;for(t=1;t<et.length;){for(var r=et[t],o=t+1;o<et.length&&r<Of;)r*=et[o++];for(r=i.modInt(r);t<o;)if(r%et[t++]==0)return!1}return i.millerRabin(e)}function Af(e){var t=this.subtract(R.ONE),i=t.getLowestSetBit();if(i<=0)return!1;var r=t.shiftRight(i);e=e+1>>1,e>et.length&&(e=et.length);for(var o=ce(),s=0;s<e;++s){o.fromInt(et[Math.floor(Math.random()*et.length)]);var n=o.modPow(r,this);if(n.compareTo(R.ONE)!=0&&n.compareTo(t)!=0){for(var a=1;a++<i&&n.compareTo(t)!=0;)if(n=n.modPowInt(2,this),n.compareTo(R.ONE)==0)return!1;if(n.compareTo(t)!=0)return!1}}return!0}R.prototype.chunkSize=Ag;R.prototype.toRadix=Pg;R.prototype.fromRadix=Bg;R.prototype.fromNumber=Mg;R.prototype.bitwiseTo=Gg;R.prototype.changeBit=tf;R.prototype.addTo=nf;R.prototype.dMultiply=mf;R.prototype.dAddOffset=gf;R.prototype.multiplyLowerTo=bf;R.prototype.multiplyUpperTo=xf;R.prototype.modInt=Rf;R.prototype.millerRabin=Af;R.prototype.clone=Rg;R.prototype.intValue=kg;R.prototype.byteValue=Og;R.prototype.shortValue=Fg;R.prototype.signum=Ig;R.prototype.toByteArray=Lg;R.prototype.equals=Ng;R.prototype.min=zg;R.prototype.max=Ug;R.prototype.and=Kg;R.prototype.or=Wg;R.prototype.xor=Vg;R.prototype.andNot=Hg;R.prototype.not=qg;R.prototype.shiftLeft=Yg;R.prototype.shiftRight=Xg;R.prototype.getLowestSetBit=Zg;R.prototype.bitCount=$g;R.prototype.testBit=ef;R.prototype.setBit=rf;R.prototype.clearBit=of;R.prototype.flipBit=sf;R.prototype.add=af;R.prototype.subtract=lf;R.prototype.multiply=hf;R.prototype.divide=uf;R.prototype.remainder=cf;R.prototype.divideAndRemainder=pf;R.prototype.modPow=Cf;R.prototype.modInverse=kf;R.prototype.pow=yf;R.prototype.gcd=Ef;R.prototype.isProbablePrime=Ff;R.prototype.square=df;var Oh=R;function Fh(e){var t=8,i=0;function r(g,y){var _=(g&65535)+(y&65535),f=(g>>16)+(y>>16)+(_>>16);return f<<16|_&65535}function o(g,y){return g>>>y|g<<32-y}function s(g,y){return g>>>y}function n(g,y,_){return g&y^~g&_}function a(g,y,_){return g&y^g&_^y&_}function l(g){return o(g,2)^o(g,13)^o(g,22)}function h(g){return o(g,6)^o(g,11)^o(g,25)}function c(g){return o(g,7)^o(g,18)^s(g,3)}function p(g){return o(g,17)^o(g,19)^s(g,10)}function d(g,y){var _=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),f=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),D=new Array(64),v,w,I,P,N,H,q,J,ie,ae,ke,Pe;g[y>>5]|=128<<24-y%32,g[(y+64>>9<<4)+15]=y;for(var ie=0;ie<g.length;ie+=16){v=f[0],w=f[1],I=f[2],P=f[3],N=f[4],H=f[5],q=f[6],J=f[7];for(var ae=0;ae<64;ae++)ae<16?D[ae]=g[ae+ie]:D[ae]=r(r(r(p(D[ae-2]),D[ae-7]),c(D[ae-15])),D[ae-16]),ke=r(r(r(r(J,h(N)),n(N,H,q)),_[ae]),D[ae]),Pe=r(l(v),a(v,w,I)),J=q,q=H,H=N,N=r(P,ke),P=I,I=w,w=v,v=r(ke,Pe);f[0]=r(v,f[0]),f[1]=r(w,f[1]),f[2]=r(I,f[2]),f[3]=r(P,f[3]),f[4]=r(N,f[4]),f[5]=r(H,f[5]),f[6]=r(q,f[6]),f[7]=r(J,f[7])}return f}function m(g){for(var y=Array(),_=(1<<t)-1,f=0;f<g.length*t;f+=t)y[f>>5]|=(g.charCodeAt(f/t)&_)<<24-f%32;return y}function x(g){g=g.replace(/\r\n/g,`
`);for(var y="",_=0;_<g.length;_++){var f=g.charCodeAt(_);f<128?y+=String.fromCharCode(f):f>127&&f<2048?(y+=String.fromCharCode(f>>6|192),y+=String.fromCharCode(f&63|128)):(y+=String.fromCharCode(f>>12|224),y+=String.fromCharCode(f>>6&63|128),y+=String.fromCharCode(f&63|128))}return y}function b(g){for(var y=i?"0123456789ABCDEF":"0123456789abcdef",_="",f=0;f<g.length*4;f++)_+=y.charAt(g[f>>2]>>(3-f%4)*8+4&15)+y.charAt(g[f>>2]>>(3-f%4)*8&15);return _}return e=x(e),b(d(m(e),e.length*t))}const If=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/g,Pf=/^(0|[1-9]\d*)\.(0|[1-9]\d*)(\.(0|[1-9]\d*))?(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/g;class Xr{get major(){return this._major}get minor(){return this._minor}get patch(){return this._patch}constructor(e,t=!1){const i=t?Pf:If,r=i.exec(e);i.lastIndex=0,this._major=r[1],this._minor=r[2],this._patch=r[3]||0}equals(e){return this._major===e._major&&this._minor===e._minor&&this._patch===e._patch}isMoreRecentThan(e){if(this._major<e.major)return!1;if(this._major>e.major)return!0;if(this._minor<e.minor)return!1;if(this._minor>e.minor)return!0;if(this._patch<=e.patch)return!1;if(this._patch>e.patch)return!0}}const He=e=>S.byteArrayToString(mt.decode(e));function Bf(e){return e.map(t=>`0${(t&255).toString(16)}`.slice(-2)).join("")}const Mf="TDNSeVlXTnJQMkZ3YVV0bGVUMD0=",Lf="ZW50ZXJwcmlzZV9saWNlbnNl",Ah="YXBwX2lkZW50aWZpZXJz",Nf="cGxhdGZvcm0=",Ih="ZmVhdHVyZXM=",ga="ZXhwaXJlc19hdA==",zf="ZG9tYWlucw==",Uf="YXBpX3Rva2Vu",fa="c2lnbmF0dXJl",Gf="dmVyc2lvbg==";class jf{constructor(e){this._version="2.4",this._l=typeof e=="string"?e.trim():e,this._e=this._parseBigInt("65537",10),this._n=this._parseBigInt("681984042382424091378806337544846672160292647422517223678775230983366046720611873368204040735766698395282492937192783016867164773742859209434481353888637963692711665138989982680829529436715362566735813634679619274059040232728883894511099669775400556584329435375723951309340934658571478665059403241851229195311069345899870108307225910988692123234379186643268583453907260879685992156955936561142314233983397819356937109343127504441076920088455337597736475086676246750168976219763398350254797168313954762459542746440628077261880980924552698138857743609502132632199713575442848784271304503226045319991689413234228439044522583790713890093165912455428688507463773064216328753265963237930998706891042679105987175588970202082466871461192706070321938250462103821558100761330890228135620208935801286878657384108721268761878694436895194628411397454202904351577771506916746612289964053490210990342857409030179406810634136188751670648983222653319056818302012063874664196648868156305696644664362171542503665321455971335955948698828939948786720193132672749776162913092000667953299803216404664087988046584107737900256954976744353601826341965438148646041640662195744770544094748295945844184507459808803114917301124088082458306086473490516969815873631",10),this._parseLicense()}v(){return this._sigValid()&&!this.isExp()}_jsonValid(){try{this._decLic=JSON.parse(this._l)}catch(e){return this._decLic={},!1}return!0}_hostnameValid(){if(typeof window=="undefined")return!0;if(!this._decLic[He(Ah)].length)return!0;const{hostname:e}=window.location;let t=!1;return this._decLic[He(Ah)].forEach(i=>{S.wildCardMatch(e,i)&&(t=!0)}),t}_platformValid(){const e=this._decLic[He(Nf)],t="HTML5";return t===e}c(){return new Promise((e,t)=>{const i=this._validateError();i!==null&&t(i),e()})}validate(){const e=this._validateError();return!(e!==null)}_validateError(){const e=typeof this._l;if(e!=="string"||!this._jsonValid()){const t=new Error;return t.code="ELICINVFMT",t}if(!this._sigValid()){const t=new Error;return t.code="ELICINV",t}if(!this._hostnameValid()){const t=new Error;return t.code="ELICINVHOST",t}if(!this._platformValid()){const t=new Error;return t.code="ELICINVPLAT",t}if(this.isExp()){const t=new Error;return t.code="ELICEXP",t}return null}isToolAllowed(e){return this._includesFeature(e)}isWhiteLabel(){return this._includesFeature("whitelabel",new Xr("2.4",!0))}areCustomAssetsAllowed(){return this._includesFeature("customassets",new Xr("2.4",!0))}t(){if(this._decLic.enterprise_license)return Promise.resolve();if(this._includesFeature("noexporttracking",new Xr("2.4",!0)))return Promise.resolve();const e=this._decLic[He(zf)][0]+He(He(Mf))+this._decLic[He(Uf)],t=new Ft(e);return t.load()}isENT(){return this._decLic?this._decLic[He(Lf)]:!1}_sigValid(){return this._verify(this._message,this._sig)}exp(){return!!this._decLic[He(ga)]}dl(){return Math.ceil((this._expAt()-Date.now())/(60*60*24*1e3))}isExp(e=Date.now()){return this._decLic[He(ga)]===null?!1:e>this._expAt()}_expAt(){return this._decLic[He(ga)]*1e3}_verify(e,t){let i,r;r=this._encodeMessage(e),i=this._decodeSignature(t),i=i.substr(-64);const o=r===i;return o}_encodeMessage(e){const t=Fh(e);return t}_decodeSignature(e){let t;return e=mt.decode(e),e=Bf(e),e=this._parseBigInt(e,16),t=e.modPowInt(this._e,this._n),t=t.toString(16),t}_parseBigInt(e,t){return new Oh(e,t)}_parseLicense(){if(typeof this._l!="string")return;if(!this._jsonValid())return;this._sig=this._decLic[He(fa)]||"",delete this._decLic[He(fa)],this._sig=this._sig.replace(/[^A-Za-z0-9+/=]/g,""),this._message=this._l.replace(new RegExp(`,"${He(fa)}":"([^"]*)"`),"")}_includesFeature(e,t=new Xr("1.0",!0)){const i=new Xr(this._decLic[He(Gf)],!0);return t.isMoreRecentThan(i)?!0:this._decLic[He(Ih)]&&this._decLic[He(Ih)].indexOf(e)!==-1}}class Ph{v(){return!0}c(){return Promise.resolve()}isToolAllowed(e){return!0}isWhiteLabel(){return!1}areCustomAssetsAllowed(){return!0}t(){return Promise.resolve()}isENT(){return!1}exp(){return!1}dl(){return 0}isExp(e=Date.now()){return!1}}var bs=jf;const Ii=typeof window=="undefined"?global:window;let Jt=Ii.requestAnimationFrame,_i=Ii.cancelAnimationFrame,Bh=0;const xs=["ms","moz","webkit","o"];for(let e=0;e<xs.length&&!Jt;++e)Jt=Ii[`${xs[e]}RequestAnimationFrame`],_i=Ii[`${xs[e]}CancelAnimationFrame`]||Ii[`${xs[e]}CancelRequestAnimationFrame`];Jt&&(Jt=Jt.bind(Ii));_i&&(_i=_i.bind(Ii));Jt||(Jt=function(e,t){const i=new Date().getTime(),r=Math.max(0,16-(i-Bh)),o=setTimeout(function(){e(i+r)},r);return Bh=i+r,o});_i||(_i=function(e){clearTimeout(e)});class Kf{constructor(e=new L(0,0),t=new L(1,1),i=new L(2,-1),r=new L(2,0)){this._p0=e.clone(),this._p1=t.clone(),this._p2=i.clone(),this._p3=r.clone(),this._segments=[],this._length=-1,this._sample=[]}set(e=new L(0,0),t=new L(1,1),i=new L(2,1),r=new L(2,0)){this._p0=e.clone(),this._p1=t.clone(),this._p2=i.clone(),this._p3=r.clone()}getLength(){return this._length}calculateSegments(e=100){let t=0,i=0;const r=[],o=1/e;let s=this._p0.clone();for(let n=1;n<=e;n++){const a=[];a.push({t,s:i,point:s}),t+=o,t=Math.min(t,1);const l=this.evalAt(t),h=l.clone().subtract(s);i+=h.len(),a.push({t,s:i,point:l}),r.push(a),s=l}return this._segments=r,this._length=i,i}evalAt(e){e=this.normalizeParameter(e);const t=this._p0.clone().multiply((1-e)**3),i=this._p1.clone().multiply(3*(1-e)*(1-e)*e),r=this._p2.clone().multiply(3*(1-e)*e*e),o=this._p3.clone().multiply(e*e*e);return t.add(i).add(r).add(o)}isInSegment(e,t){return e=this.normalizeArcLength(e),e>=t[0].s&&e<=t[1].s}getArcLengthSegment(e){e=this.normalizeArcLength(e);for(let t=0;t<this._segments.length;t++){const i=this._segments[t];if(this.isInSegment(e,i))return i}return null}normalizeArcLength(e){return Math.max(Math.min(this._length,e),0)}normalizeParameter(e){return Math.max(Math.min(1,e),0)}getParameterForArcLength(e){const t=this.normalizeArcLength(e),i=this.getArcLengthSegment(t);if(!i)return F.warn("CubicBezierCurve#getParameterForArcLength","Segment not found."),-1;const r=(t-i[1].s)/(i[0].s-i[1].s);return r*i[0].t+(1-r)*i[1].t}evalAtArcLength(e){return this.evalAt(this.getParameterForArcLength(e))}approximateAtArcLength(e){const t=this.normalizeArcLength(e),i=this.getArcLengthSegment(t);if(!i)return-1;const r=(t-i[1].s)/(i[0].s-i[1].s);return i[0].point.clone().multiply(r).add(i[1].point.clone().multiply(1-r))}parameterSample(e=100){const t=1/e,i=[];let r=0;for(let o=0;o<=e+1;o++)i.push(this.evalAt(r)),r+=t;return this._sample=i,[...i]}arcLengthApproxSample(e=100,t=!1,i=!1){const r=this._length/e,o=[];let s=0;for(let n=t?1:0;n<e+1;n++)o.push(this.approximateAtArcLength(s)),s+=r;return i&&o.pop(),this._sample=o,[...o]}}var _a=Kf;class Wf{constructor(e,t){this.min=e,this.max=t}getMin(){return this.min}getMax(){return this.max}getLength(){return this.max-this.min}contains(e){return this.min<=e&&e<=this.max}}var ya=Wf;class _t{constructor(e,t,i){this.x=e,this.y=t,this.z=i,typeof this.x=="undefined"&&(this.x=0),typeof this.y=="undefined"&&(this.y=0),typeof this.z=="undefined"&&(this.z=0)}set(e,t,i){return this.x=e,this.y=t,this.z=i,this}clone(){return new _t(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}clamp(e,t){const i=e!==null&&typeof e!="undefined",r=t!==null&&typeof t!="undefined";return!(e instanceof _t)&&i&&(e=new _t(e,e,e)),!(t instanceof _t)&&r&&(t=new _t(t,t,t)),i&&(this.x=Math.max(e.x,this.x),this.y=Math.max(e.y,this.y),this.z=Math.max(e.z,this.z)),r&&(this.x=Math.min(t.x,this.x),this.y=Math.min(t.y,this.y),this.z=Math.min(t.z,this.z)),this}divide(e){return e instanceof _t?(this.x/=e.x,this.y/=e.y,this.z/=e.z):(this.x/=e,this.y/=e,this.z/=e),this}subtract(e){return e instanceof _t?(this.x-=e.x,this.y-=e.y,this.z-=e.z):(this.x-=e,this.y-=e,this.z-=e),this}multiply(e){return e instanceof _t?(this.x*=e.x,this.y*=e.y,this.z*=e.z):(this.x*=e,this.y*=e,this.z*=e),this}add(e){return e instanceof _t?(this.x+=e.x,this.y+=e.y,this.z+=e.z):(this.x+=e,this.y+=e,this.z+=e),this}equals(e){return e instanceof _t?e.x===this.x&&e.y===this.y&&e.z===this.z:e===this.x&&e===this.y&&e===this.z}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}fract(){return this.x%=1,this.y%=1,this.z%=1,this}toInt(){return this.x|=0,this.y|=0,this.z|=0,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this.z=Math.abs(this.z),this}len(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}min(){return Math.min(Math.min(this.x,this.y),this.z)}max(){return Math.max(Math.max(this.x,this.y),this.z)}toObject(){return{x:this.x,y:this.y,z:this.z}}toString(){return`Vector3({ x: ${this.x}, y: ${this.y}, z: ${this.z} })`}roundDecimal(e){return this.x=parseFloat(this.x.toFixed(e)),this.y=parseFloat(this.y.toFixed(e)),this.z=parseFloat(this.z.toFixed(e)),this}static fromObject(e){return new _t(e.x,e.y,e.z)}static get NULL(){return new _t(0,0,0)}}var ba=_t;const O={};Fe(O,{ColorMatrix:()=>Po,CubicBezierCurve:()=>_a,Matrix:()=>Tt,Range:()=>ya,Rectangle:()=>Ce,Vector2:()=>L,Vector3:()=>ba});const Lo={};Fe(Lo,{Base64:()=>mt,Color:()=>E,ColorMatrix:()=>Po,Configurable:()=>Q,Constants:()=>Se,CubicBezierCurve:()=>_a,Engine:()=>C,EventEmitter:()=>Qe,Events:()=>Hr,FreeLicenseChecker:()=>Ph,GLUtils:()=>At,LicenseChecker:()=>bs,Log:()=>F,Matrix:()=>Tt,Promise:()=>W,Range:()=>ya,Rectangle:()=>Ce,Utils:()=>S,Vector2:()=>L,Vector3:()=>ba,cancelAnimationFrame:()=>_i,requestAnimationFrame:()=>Jt});Function.prototype.name===void 0&&Object.defineProperty!==void 0&&Object.defineProperty(Function.prototype,"name",{get(){const e=/function\s([^(]{1,})\(/,t=e.exec(this.toString());return t&&t.length>1?t[1].trim():""},set(e){}});class xa{constructor(){this._container=new C.Container,this._sprite=new C.Sprite,this._container.addChild(this._sprite)}render(e,t,i){const r=i.getDimensions(),o=this._getNextHighestPOT(r);this._renderTexture?this._renderTexture.resizeTo(o):this._renderTexture=new C.RenderTexture(e,o.x,o.y);const s=this._renderTexture.getDimensions();this._sprite.setTexture(i),this._sprite.updateTransform(),this._renderTexture.clear(),this._renderTexture.render(this._container),this._updateSprite(e,t,r,s)}_updateSprite(e,t,i,r){t.setTexture(this._renderTexture),this._renderTexture.setFrame(new Ce(0,0,i.x,i.y))}_getNextHighestPOT(e){return new L(S.nextHighestPOT(e.x),S.nextHighestPOT(e.y))}getRenderTexture(){return this._renderTexture}dispose(){if(!this._renderTexture)return;this._renderTexture.dispose(),this._renderTexture=null}}class Vf extends ls{constructor(e){super();this._onTextureUpdate=this._onTextureUpdate.bind(this),this._texture=e,this._shader=null,this._width=0,this._height=0,this._anchor=new L(0,0),this._canvasSmoothingEnabled=!0,this.setTexture(e)}_onTextureUpdate(){this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}_renderWebGL(e){const t=e.save();this._smoothDownscaling&&(this._potRenderer||(this._potRenderer=new xa),this._potRenderer.render(e,this,this._texture)),e.restore(t),e.setObjectRenderer(e.renderers.sprite),e.renderers.sprite.render(this)}_renderCanvas(e){const t=this._worldTransform,i=this._texture.getFrame(),{width:r,height:o}=i,s=e.getCurrentRenderTarget().getPixelRatio(),n=this._anchor.x*-r|0,a=this._anchor.y*-o|0,l=e.getContext();l.setTransform(t.a,t.b,t.c,t.d,t.tx*s,t.ty*s),l.globalAlpha=this.getWorldAlpha();const h=this._texture.getBaseTexture(),c=h.getPixelRatio(),p=h.getSource();l.imageSmoothingEnabled=this._canvasSmoothingEnabled,e.beforeDraw&&e.beforeDraw(l),l.drawImage(p,0,0,(p.naturalWidth||r)*c,(p.naturalHeight||o)*c,n*s,a*s,r*s,o*s)}isAtPosition(e){const t=this._worldTransform.applyInverseToVector(e),i=this._texture.getFrame(),{width:r,height:o}=i,s=new L(-r,-o);s.multiply(this._anchor);const n=s.clone().add(r,o);return!(t.x<s.x||t.x>n.x||t.y<s.y||t.y>n.y)}getLocalBounds(){if(this._localBoundsNeedUpdate){const e=this._localBounds,t=this._texture.getFrame();e.x=-t.width*this._anchor.x,e.y=-t.height*this._anchor.y,e.width=t.width,e.height=t.height,this._localBoundsNeedUpdate=!1}return this._localBounds.clone()}getBounds(){if(this._boundsNeedUpdate){const e=this._bounds,t=this._texture.getFrame(),i=this._worldTransform,r=this._anchor,o=i.rectangleToCoordinates(t,r);let s=o[0].x,n=o[0].y,a=s,l=n;o.forEach(({x:h,y:c})=>{s=Math.min(s,h),n=Math.min(n,c),a=Math.max(a,h),l=Math.max(l,c)}),e.x=s,e.width=Math.abs(a-s),e.y=n,e.height=Math.abs(l-n),this._boundsNeedUpdate=!1}return this._bounds.clone()}getTexture(){return this._texture}clearTexture(e=!0){if(!this._texture)return;this._texture.off("update",this._onTextureUpdate),e&&this._texture.dispose(),this._texture=null,this._potRenderer&&(e&&this._potRenderer.dispose(),this._potRenderer=null)}setTexture(e){if(!e)return;this._texture&&this._texture.off("update",this._onTextureUpdate),this._potRenderer&&this._potRenderer.getRenderTexture().getBaseTexture().setDirty(!0),this._texture=e,e.getBaseTexture().isLoaded()&&this._onTextureUpdate(),e.on("update",this._onTextureUpdate)}getShader(){return this._shader}setShader(e){this._shader=e}getWidth(){return this._width}setWidth(e){this._scale.x=e/this._texture.getFrame().width,this._width=e,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getHeight(){return this._height}setHeight(e){this._scale.y=e/this._texture.getFrame().height,this._height=e,this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}getDimensions(){return new L(this._width,this._height)}getAnchor(){return this._anchor}setAnchor(e,t){e instanceof L?this._anchor.copy(e):this._anchor.set(e,t),this._boundsNeedUpdate=!0,this._localBoundsNeedUpdate=!0}isSmoothDownscaling(){return this._smoothDownscaling}setSmoothDownscaling(e){this._smoothDownscaling=e}dispose(e=!1,t=!1){this._texture&&this._texture.off("update",this._onTextureUpdate),(e||t)&&this._texture.dispose(t),this._potRenderer&&this._potRenderer.dispose()}}var Mh=Vf;class Hf{constructor(){this._uvs=[new L(0,0),new L(1,0),new L(1,1),new L(0,1)]}update(e,t){let i=this._uvs[0];i.x=e.x/t.width,i.y=e.y/t.height,i=this._uvs[1],i.x=(e.x+e.width)/t.width,i.y=e.y/t.height,i=this._uvs[2],i.x=(e.x+e.width)/t.width,i.y=(e.y+e.height)/t.height,i=this._uvs[3],i.x=e.x/t.width,i.y=(e.y+e.height)/t.height}getUVsAt(e){return this._uvs[e]}getUVs(){return this._uvs}}var Lh=Hf;class va extends Qe{constructor(e,t){super();if(!(e instanceof $e))throw new Error("`baseTexture` should be an instance of BaseTexture");this._uvs=new Lh,this._frame=t?t.clone():null,this._frameLocked=!!t,this._onBaseTextureLoaded=this._onBaseTextureLoaded.bind(this),this._onBaseTextureUpdated=this._onBaseTextureUpdated.bind(this),this._frame||(this._frame=new Ce(0,0,1,1)),this.setBaseTexture(e)}static fromImage(e){const t=new $e(e);return new va(t)}static fromCanvas(e){const t=new $e(e);return new va(t)}_onBaseTextureLoaded(){if(!this._frameLocked){const e=this._baseTexture.getFrame().clone();this.setFrame(e)}this._baseTexture.on("update",this._onBaseTextureUpdated)}_onBaseTextureUpdated(){const{width:e,height:t}=this._baseTexture.getFrame();this._frame.width=e,this._frame.height=t,this.emit("update")}_updateUVs(){this._uvs.update(this._frame,this._baseTexture.getFrame())}getBaseTexture(){return this._baseTexture}setBaseTexture(e){if(this._baseTexture=e,!this._baseTexture.isLoaded())this._baseTexture.once("loaded",this._onBaseTextureLoaded);else{const{width:t,height:i}=e.getFrame();this._frameLocked||(this._frame=new Ce(0,0,t,i)),this._onBaseTextureLoaded()}}getFrame(){return this._frame}setFrame(e){this._frame=e,this._updateUVs()}getWidth(){return this._frame.width}getHeight(){return this._frame.height}getUVs(){return this._uvs}getDimensions(){return new L(this._frame.width,this._frame.height)}dispose(e=!0){e&&this._baseTexture.dispose()}}var vs=va;const{RendererType:Qr}=Se;class qf extends vs{constructor(e,t=100,i=100,r=1){super(new $e,new Ce(0,0,t,i));this._loaded=!0,this._width=t,this._height=i,this._pixelRatio=r,this._renderer=e,this._setupFilterManager(),this._setupBuffer(),this.setBaseTexture(this._renderTarget.getBaseTexture()),this._updateUVs()}_setupFilterManager(){this._filterManager&&this._filterManager.dispose(),this._renderer.isOfType(Qr.WEBGL)?this._filterManager=new Vr(this._renderer):this._renderer.isOfType(Qr.CANVAS)&&(this._filterManager=new Wr(this._renderer)),this._filterManager.resizeTo(new L(this._width,this._height))}_setupBuffer(){this._renderer.isOfType(Qr.WEBGL)?this._setupWebGLRenderTarget():this._renderer.isOfType(Qr.CANVAS)&&this._setupCanvasRenderTarget()}_setupWebGLRenderTarget(){this._renderTarget&&this._renderTarget.dispose(),this._renderTarget=new pi(this._renderer,this._width,this._height,this._pixelRatio)}_setupCanvasRenderTarget(){this._renderTarget&&this._renderTarget.dispose(),this._renderTarget=new ci(this._width,this._height,this._pixelRatio)}clear(e){this._renderTarget.clear(e)}resizeTo(e){if(this._width===e.x&&this._height===e.y)return;this._width=e.x,this._height=e.y,this._frame.width=e.x,this._frame.height=e.y,this._renderTarget.resizeTo(e),this._filterManager.resizeTo(e)}render(e){if(this._renderer.isOfType(Qr.WEBGL))this._renderWebGL(e);else if(this._renderer.isOfType(Qr.CANVAS))this._renderCanvas(e);else throw new Error(`RenderTexture does not support rendering via ${this._renderer.constructor.name}`)}_renderWebGL(e){this._renderTarget.activate(),e.getWorldTransform().reset(),e.getChildren().forEach(i=>{i.updateTransform()});const t=this._renderer.getFilterManager();this._renderer.setFilterManager(this._filterManager),this._renderer.renderDisplayObject(e,this._renderTarget),this._renderer.setFilterManager(t)}_renderCanvas(e){e.getWorldTransform().reset(),e.getChildren().forEach(i=>{i.updateTransform()});const t=this._renderer.getFilterManager();this._renderer.setFilterManager(this._filterManager),this._renderer.renderDisplayObject(e,this._renderTarget),this._renderer.setFilterManager(t)}getRenderTarget(){return this._renderTarget}dispose(){this._renderTarget.dispose(),this._filterManager.dispose(),super.dispose()}}var Nh=qf;const Yf={WebGLRenderer:fs,CanvasRenderer:da,WebGLFilterManager:Vr,CanvasFilterManager:Wr,DisplayObject:Gr,Container:ls,BaseTexture:$e,Texture:vs,RenderTexture:Nh,WebGLRenderTarget:pi,CanvasRenderTarget:ci,Sprite:Mh,Shaders:Th,Shader:jr,Filter:Gt,Filters:ha,PixelArrayImage:Bo,autoDetectRenderer(e,t,i={}){return fs.isSupported()?new fs(e,t,i):new da(e,t,i)}};var C=Yf;class Xf{static current(){return process.env.ENV}static isTest(){return process.env.ENV==="test"}static isDevelopment(){return process.env.ENV==="development"}static isProduction(){return process.env.ENV==="production"||!this.isTest()&&!this.isDevelopment()}}var zh=Xf;class Qf{constructor(e){this._head=0,this._buf=e}peekInt8(){return this._buf[this._head]}peekInt16(e=!1){const t=this._buf[this._head],i=this._buf[this._head+1];return e?(i<<8)+t:(t<<8)+i}peekInt24(e=!1){const t=this._buf[this._head],i=this._buf[this._head+1],r=this._buf[this._head+2];return e?(r<<16)+(i<<8)+t:(t<<16)+(i<<8)+r}peekInt32(e=!1){const t=this._buf[this._head],i=this._buf[this._head+1],r=this._buf[this._head+2],o=this._buf[this._head+3];return e?(o<<32)+(r<<16)+(i<<8)+t:(t<<32)+(i<<16)+(r<<8)+o}writeInt8(e){this._buf[this._head]=e&255}writeInt16(e){this._buf[this._head]=e>>8,this._buf[this._head+1]=e&255}readInt8(){const e=this.peekInt8();return this._head+=1,e}readInt16(e=!1){const t=this.peekInt16(e);return this._head+=2,t}readInt24(e=!1){const t=this.peekInt24(e);return this._head+=3,t}readInt32(e=!1){const t=this.peekInt32(e);return this._head+=4,t}readString(e){let t="";for(let i=0;i<e;i++){const r=this.readInt8();t+=String.fromCharCode(r)}return t}getHead(){return this._head}setHead(e){this._head=e}}var Pi=Qf;const Zf={SOI:65496,SOS:65498,APP0:65504,APP1:65505,JFIF:65504,EXIF:65505},Jf={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"};var Zr={MARKERS:Zf,EXIF_TAGS:Jf};const{invariant:wa}=S,{MARKERS:$f,EXIF_TAGS:Uh}=Zr;class e_{constructor(e){this._buf=e,this._stream=new Pi(this._buf),this._stream.setHead(0),this._parse(),this._bigEndian=!1}isValid(){this._stream.setHead(0);const e=this._stream.readInt16();if(e!==$f.EXIF)return!1;const t=this._stream.readInt16();if(!(t>0))return!1;const i=this._stream.readString(4);return!(i!=="Exif")}_parse(){if(!this.isValid())return;this._stream.setHead(10);const e=this._stream.getHead();this._bigEndian=!1;const t=this._stream.readInt16();t===18761?this._bigEndian=!1:t===19789?this._bigEndian=!0:wa(!1,"Invalid TIFF data: No endian type found"),wa(this._stream.readInt16(!this._bigEndian)===42,"Invalid TIFF data: No 0x002A");const i=this._stream.readInt32(!this._bigEndian);wa(i>=8,"Invalid TIFF data: First IFD offset < 8");const r=e+i,o=this._readTags(this._stream,e,r,this._bigEndian);this._tags=o.tags,this._tagData=o.tagData}getTags(){return this._tags}getTagData(){return this._tagData}setOrientation(e){if(this._tagData.Orientation){const{entryOffset:t}=this._tagData.Orientation;this._stream.setHead(t+8),this._stream.writeInt16(this._bigEndian?e:(e&255)<<8|e>>8&255)}}_readTags(e,t,i,r){e.setHead(i);const o=e.readInt16(!r),s={},n=[];for(let a=0;a<o;a++){const l=i+a*12+2;e.setHead(l);let h=e.readInt16(!r),c,p,d;if(Uh[h]){h=Uh[h],c=e.readInt16(!r),p=e.readInt32(!r),d=e.readInt32(!r)+t;let m=null;switch(c){case 1:case 7:if(p===1)m=e.readInt8(!r);else{m=[];for(let x=0;x<p;x++)m.push(e.readInt8(!r))}break;case 2:e.setHead(p>4?d:l+8),m=e.readString(p);break;case 3:if(e.setHead(p>2?d:l+8),p===1)m=e.readInt16(!r);else{m=[];for(let x=0;x<p;x++)m.push(e.readInt16(!r))}break;case 4:case 9:if(e.setHead(p>1?d:l+8),p===1)m=e.readInt32(!r);else{m=[];for(let x=0;x<p;x++)m.push(e.readInt32(!r))}break;case 5:case 10:if(e.setHead(d),p===1){const x=e.readInt32(!r),b=e.readInt32(!r);m=x/b}else{m=[];for(let x=0;x<p;x++){const b=e.readInt32(!r),g=e.readInt32(!r),y=b/g;m.push(y)}}break}s[h]=m,n[h]={value:m,numValues:p,entryOffset:l,valueOffset:d,type:c}}}return{tags:s,tagData:n}}getBuffer(){return this._buf}}var Gh=e_;const{MARKERS:t_}=Zr;class i_{constructor(e){this._buf=e,this._stream=new Pi(this._buf),this._stream.setHead(0)}isValid(){this._stream.setHead(0);const e=this._stream.readInt16();if(e!==t_.APP0)return!1;const t=this._stream.readInt16();if(!(t>=16))return!1;const i=this._stream.readString(4),r=this._stream.readInt8();return i==="JFIF"?r===0:!1}setUnitDensity(e){this._stream.setHead(11),this._stream.writeInt8(e)}setDensityX(e){this._stream.setHead(12),this._stream.writeInt16(e)}setDensityY(e){this._stream.setHead(14),this._stream.writeInt16(e)}getUnitDensity(){return this._stream.setHead(11),this._stream.readInt8()}getDensityX(){return this._stream.setHead(12),this._stream.readInt16()}getDensityY(){return this._stream.setHead(14),this._stream.readInt16()}getBuffer(){return this._buf}}var Ta=i_;const{invariant:PS}=S,{MARKERS:No}=Zr,ws="data:image/jpeg;base64,",r_=new RegExp(`^${ws}`,"i");class yi{constructor(e){this._buf=e,this._stream=new Pi(this._buf),this._stream.setHead(0),this._segments=this._sliceIntoSegments(this._buf),this._exifData=new Gh(this._getMarkerBuffer(No.EXIF)),this._jfifData=new Ta(this._getMarkerBuffer(No.JFIF))}static toDataURL(e){return ws+mt.encode(e)}static fromDataURL(e){const t=e.replace(ws,""),i=mt.decode(t);return i}restoreSegmentsInArray(e){return e=this.restoreExifTagsToImageData(e),this.restoreJfifSegmentToImageData(e)}restoreSegments(e){let t=yi.fromDataURL(e);return t=this.restoreSegmentsInArray(t),yi.toDataURL(t)}restoreExifTagsToImageData(e){if(!this._exifData.isValid())return e;const t=this._sliceIntoSegments(e),i=t[1][0],r=e.slice(0,i),o=e.slice(i);let s=r.concat(this._exifData.getBuffer());return s=s.concat(o),s}restoreJfifSegmentToImageData(e){if(!this._jfifData.isValid())return e;const t=this._sliceIntoSegments(e),i=this._findSegment(No.JFIF,t);let r=[];if(i){const o=i[0],s=i[1],n=e.slice(0,o),a=e.slice(o,s),l=e.slice(s),h=new Ta(a);h.setDensityX(this._jfifData.getDensityX()),h.setDensityY(this._jfifData.getDensityY()),h.setUnitDensity(this._jfifData.getUnitDensity()),r=n.concat(a).concat(l)}else return e;return r}restoreExifTags(e){const t=yi.fromDataURL(e),i=this.restoreExifTagsToImageData(t);return yi.toDataURL(i)}restoreJfifSegment(e){if(!this._jfifData.isValid())return e;const t=yi.fromDataURL(e),i=this.restoreJfifSegmentToImageData(t);return yi.toDataURL(i)}setOrientation(e){return this._exifData.setOrientation(e)}static isJPEG(e){return r_.test(e)}static bufferIsJPEG(e){return e[0]===255&&e[1]===216&&e[2]===255}static fromBase64String(e){const t=e.replace(ws,""),i=mt.decode(t);return new yi(i)}_findSegment(e,t=this._segments){for(let i=0;i<t.length;i++){const r=t[i][0],o=t[i][1];this._stream.setHead(r);const s=this._stream.peekInt16();if(s===e)return[r,o]}return!1}_getLastSegment(e=this._segments){return e[e.length-1]}_getMarkerBuffer(e,t=this._segments){const i=this._findSegment(e,t);if(i){const r=i[0],o=i[1];return this._buf.slice(r,o)}return!1}_sliceIntoSegments(e){const t=new Pi(e),i=[];for(;t.getHead()<e.length;){const r=t.readInt16();if(r===No.SOI)continue;if(r===No.SOS)break;if(r>=65280&&r<=65535){const o=t.readInt16(),s=t.getHead()+o-2;i.push([t.getHead()-4,s]),t.setHead(s)}else throw new Error(`Invalid marker: 0x${r.toString(16)}`)}return this._stream.setHead(0),i}getTags(){return this._exifData.getTags()}getTagData(){return this._exifData.getTagData()}dispose(){this._buf=[],this._segments=[]}}var zo=yi;class jh extends Qe{constructor(e=[]){super();this._onOperationUpdate=this._onOperationUpdate.bind(this),this._cacheEnabled=!0,this._stack=e,this._stack.forEach(t=>{t.on("update",this._onOperationUpdate)})}clear(){this.forEach(e=>this.remove(e)),this._stack=[]}hasChanges(){return this._stack.filter(e=>!!e).some(e=>e.hasChanges())}_onOperationUpdate(e,t){this.emit(Hr.OPERATION_UPDATED,e,t)}enableCache(){this._cacheEnabled=!0}disableCache(){this._cacheEnabled=!1}forEach(e){return this._stack.filter(t=>!!t).forEach(e)}render(e,t){const i=t,r=this._stack.filter(l=>!!l).filter(l=>l.getEnabled());r.reverse();const o=r.filter(l=>!l.isDirtyForRenderer(e.getRenderer()))[0],s=r.indexOf(o);r.reverse();let n=0;s!==-1&&(n=r.length-s-1);for(let l=0;l<n;l++)F.info(this.constructor.name,`Skipping ${r[l].constructor.name}`);let a=W.resolve(i);for(let l=n;l<r.length;l++){const h=r[l];let c,p;a=a.then(d=>h.render(d).then(m=>(c&&m!==c&&!this._cacheEnabled&&p.disposeRenderTextures(),c=m,p=h,m)))}return a.then(l=>{const h=!r.some(c=>c.isDirtyForRenderer(e.getRenderer()));return{outputTexture:l,renderDone:h}})}validateSettings(){return W.all(this._stack.filter(e=>!!e).map(e=>e.validateSettings()))}setAllToDirty(e=!1){this.forEach(t=>t.setDirty(!0,e))}updateDirtinessForRenderer(e){let t=!1;for(let i=0;i<this._stack.length;i++){const r=this._stack[i];if(!r)continue;r.isDirtyForRenderer(e)&&(t=!0),t&&r.setDirtyForRenderer(!0,e)}}push(e){this._stack.push(e),e.on("update",this._onOperationUpdate)}pop(){const e=this._stack.pop();e&&(e.off("update",this._onOperationUpdate),e.dispose())}unshift(e){this._stack.unshift(e),e.on("update",this._onOperationUpdate)}clone(){return new jh(this._stack.slice(0))}get(e){return this._stack[e]}getByIdentifier(e){return S.Array.find(this._stack,t=>t&&t.constructor.identifier===e)}getIndexByIdentifier(e){return S.Array.findIndex(this._stack,t=>t&&t.constructor.identifier===e)}moveToTop(e){const t=S.Array.findIndex(this._stack,r=>r&&r.constructor.identifier===e);if(t<0||t===this._stack.length-1)return;const i=this.getByIdentifier(e);this._stack.splice(t,1),this._stack[this._stack.length]=i}set(e,t){this._stack[e]&&(this._stack[e].off("update",this._onOperationUpdate),this._stack[e].dispose()),this._stack[e]=t,t.on("update",this._onOperationUpdate)}remove(e){const t=this._stack.indexOf(e);if(t===-1)return;this._stack[t]&&(this._stack[t].off("update",this._onOperationUpdate),this._stack[t].dispose()),this._stack.splice(t,1)}removeAt(e){this._stack[e]&&(this._stack[e].off("update",this._onOperationUpdate),this._stack[e].dispose()),delete this._stack[e]}getStack(){return this._stack}dispose(){this.forEach(e=>{e.dispose()})}}var Ts=jh;const Kh=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Be();class o_{constructor(e,t){this._tag=e,this._name=t,this._start=Kh()}stop(){const e=Kh(),t=e-this._start,i=Math.round(1e3/t);F.info(this._tag,`${this._name} took ${t.toFixed(2)}ms (${i} FPS)`)}}var Ds=o_;class Wh extends Q{constructor(e,t={}){super(t,{enabled:{type:u.BOOLEAN,default:!0,serializable:!1}});this._sdk=e,this._cacheEnabled=!1,this._dirtiness={},this._sprite=new C.Sprite,this._container=new C.Container,this._container.addChild(this._sprite)}_onOptionsChange(){this.setDirty(!0)}render(e){if(!this.getEnabled())return F.info(this.constructor.name,"Disabled - skipping"),W.resolve(e);if(!this._renderTexture){const o=e.getDimensions().floor();this._renderTexture=new C.RenderTexture(this._sdk.getRenderer(),o.x,o.y)}const t=this._sdk.getRenderer();let i,r;if(F.canLog("info")&&(r=new Ds(this.constructor.name,"Rendering")),this.isDirtyForRenderer(t)){this._sprite.setTexture(e);const o=this.getNewDimensions(e.getDimensions()).floor();this._renderTexture.resizeTo(o),this._renderTexture.clear(),i=this._render(e).then((s=!1)=>(this.setDirtyForRenderer(s,t),this._renderTexture))}else F.info(this.constructor.name,"Rendering from cache"),i=W.resolve(this._renderTexture);return i.then(o=>(r&&r.stop(),o))}_render(e){let t;return this._sdk.getRenderer().isOfType(re.WEBGL)?t=this._renderWebGL.bind(this):t=this._renderCanvas.bind(this),t(e)}_renderWebGL(e){throw new Error("Operation#_renderWebGL is abstract and not implemented in inherited class.")}_renderCanvas(e){throw new Error("Operation#_renderCanvas is abstract and not implemented in inherited class.")}getNewDimensions(e){return e.clone()}onBeforeExport(){this.transform&&this._tempTransformChange&&this.transform(this._tempTransformChange),this._onBeforeExport()}onAfterExport(){this.transform&&this._tempInverseTransformChange&&this.transform(this._tempInverseTransformChange),this._onAfterExport()}_onBeforeExport(){}_onAfterExport(){}setTemporaryTransformChange(e,t){this._tempTransformChange=e,this._tempInverseTransformChange=t}reset(){this._dirty=!0,this._glslPrograms={}}isDirtyForRenderer(e){const t=this._dirtiness[e.id];return typeof t=="undefined"?!0:t}setDirtyForRenderer(e,t,i=!1){this._dirtiness[t.id]=e}setDirty(e,t=!1){for(const i in this._dirtiness)this.setDirtyForRenderer(e,{id:i},t)}getSDK(){return this._sdk}getInputDimensions(e=!0){let t=this._sdk.getInputDimensions();e&&t.multiply(this._sdk.getZoom()).floor();let i;return this._sdk.getOperationsStack().forEach(r=>{if(i)return;if(r===this){i=!0;return}t=r.getNewDimensions(t)}),t.floor()}clone(){const e=this.constructor;return new e(this._sdk,this.serializeOptions())}disposeRenderTextures(){this._renderTexture&&this._renderTexture.dispose(),this._renderTexture=null}dispose(){this.disposeRenderTextures(),this._sprite.dispose()}}Wh.identifier=null;var he=Wh;const{OptionType:s_}=Se;class Da extends he{getRotation(){let e=0;switch(this.getTags().Orientation){case 7:case 8:e=-90;break;case 3:case 4:e=-180;break;case 5:case 6:e=90;break}return e}_getFlipVertically(){const{Orientation:e}=this.getTags();return[5,7].indexOf(e)!==-1}_getFlipHorizontally(){const{Orientation:e}=this.getTags();return[2,4].indexOf(e)!==-1}_getFinalOptions(){return{rotation:this.getRotation(),flipVertically:this._getFlipVertically(),flipHorizontally:this._getFlipHorizontally()}}_render(e){const t=this._getFinalOptions(),i=t.rotation%360,r=i*(Math.PI/180);this._sprite.setScale(t.flipHorizontally?-1:1,t.flipVertically?-1:1),this._sprite.setRotation(r),this._sprite.setAnchor(.5,.5),this._sprite.updateTransform();const o=this._sprite.getBounds();return this._renderTexture.resizeTo(new L(o.width,o.height)),this._sprite.setPosition(this._renderTexture.getDimensions().divide(2)),this._renderTexture.render(this._container),W.resolve()}getNewDimensions(e){const t=this._getFinalOptions();return e=e.clone(),t.rotation%180&&e.flip(),e}applyTo(e){const t=this._getFinalOptions(),i=S.createCanvas();Math.abs(t.rotation%180)===90?(i.width=e.height,i.height=e.width):(i.width=e.width,i.height=e.height);const r=i.getContext("2d"),o=t.rotation*Math.PI/180,s=.5*(i.width-e.width),n=.5*(i.height-e.height);return r.translate(s,n),r.translate(.5*e.width,.5*e.height),r.rotate(o),r.translate(-.5*e.width,-.5*e.height),t.flipVertically&&(r.translate(0,e.height),r.scale(1,-1)),t.flipHorizontally&&(r.translate(e.width,0),r.scale(-1,1)),r.drawImage(e,0,0),i}}Da.identifier="exif-orientation";Da.prototype.availableOptions={tags:{type:s_.OBJECT,default:{}}};var Vh=Da;const Jr={};Fe(Jr,{ExifOrientationOperation:()=>Vh});class Hh extends Q{constructor(e,t={}){super(t);this._sdk=e}export(){const{imageFormat:e}=this._options,t=i=>i.renderDone?i:this._sdk.render().then(r=>t(r));return this.validateSettings().then(()=>this._prepareSDK().then(i=>t(i))).then(i=>{const{outputTexture:r,renderDone:o}=i,s=this._sdk.getRenderer();let n=s.getCanvas();return s.isOfType(re.WEBGL)&&(n=this._createCanvasFromTexture(r)),this._encodeImageFormat(n)}).then(i=>this._restoreExifMetadata(i,e)).then(i=>this._restoreSDK().then(()=>i))}_restoreExifMetadata(e,t,i){if(t===ki.JPEG){const r=this._sdk.getExif();r&&(typeof e=="string"&&(e=r.restoreSegments(e)))}return Promise.resolve(e)}_encodeAsDataURL(e,t,i){return S.isBrowser?Promise.resolve(e.toDataURL(t,i)):new Promise((r,o)=>{e.toDataURL(t,i,(s,n)=>{s?o(s):r(n)})})}_encodeAsHTMLImage(e,t,i){return this._encodeAsDataURL(e,t,i).then(r=>{const o=new Ve;return o.src=r,Promise.resolve(o)})}_encodeAsBuffer(e,t,i){return Promise.reject(new Error("Unsupported platform for RenderType"))}_encodeAsMSBlob(e,t,i){return Promise.resolve(e.msToBlob())}_encodeAsBLOB(e,t,i){return new Promise((r,o)=>{e.toBlob(s=>{r(s)},t,i)})}_encodeImageFormat(e){const{imageFormat:t,quality:i}=this._options;let{renderType:r}=this._options;r===gt.BLOB&&e.msToBlob&&!e.toBlob&&(r=gt.MSBLOB);switch(r){case gt.IMAGE:return this._encodeAsHTMLImage(e,t,i);case gt.DATAURL:return this._encodeAsDataURL(e,t,i);case gt.BUFFER:return this._encodeAsBuffer(e,t,i);case gt.MSBLOB:return this._encodeAsMSBlob(e,t,i);case gt.BLOB:return this._encodeAsBLOB(e,t,i)}return Promise.reject(new Error(`Unsupported RenderType: ${r}!`))}_prepareSDK(){const e=this._sdk.getRenderer();this._sdkSettings={dimensions:e.getDimensions().clone(),textureQuality:this._sdk.getTextureQuality(),pixelRatio:this._sdk.getPixelRatio(),renderMode:this._sdk.getRenderMode()},this._sdk.setRenderMode("export"),this._sdk.setTextureQuality(1);const t=e.isOfType(re.CANVAS);e.setPixelRatio(1),e.resizeTo(this._sdk.getFinalDimensions(),t),this._sdk.setAllOperationsToDirty(!0);const i=this._sdk.getOperationsStack();return i.forEach(r=>{r.disposeRenderTextures()}),i.disableCache(),this._sdk.render()}_restoreSDK(){const e=this._sdk.getOperationsStack();e.enableCache(),this._sdk.setRenderMode(this._sdkSettings.renderMode);const t=this._sdk.getRenderer(),i=t.isOfType(re.CANVAS);return t.setPixelRatio(this._sdkSettings.pixelRatio),t.resizeTo(this._sdkSettings.dimensions,i),this._sdk.setTextureQuality(this._sdkSettings.textureQuality),this._sdk.setAllOperationsToDirty(!0),this._sdk.render()}_createCanvasFromTexture(e){const t=this._sdk.getRenderer(),i=this._sdk.getFinalDimensions(),r=this._sdk.getRenderer().getContext(),o=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,o);const s=e.getBaseTexture().getGLTextureForRenderer(t);r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,s,0);const n=new Uint8Array(i.x*i.y*4);r.readPixels(0,0,i.x,i.y,r.RGBA,r.UNSIGNED_BYTE,n);const a=this._checkPixelsForTransparency(n);let l;if(a){const d=new C.Sprite(e);d.setFilters([new C.Filters.UnpremultiplyFilter]);const m=new C.Container;m.addChild(d),l=new C.RenderTexture(t,i.x,i.y),l.render(m);const x=l.getBaseTexture().getGLTextureForRenderer(t);r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,x,0),r.readPixels(0,0,i.x,i.y,r.RGBA,r.UNSIGNED_BYTE,n),t.setRenderTarget(),l.dispose()}const h=S.createCanvas();h.width=i.x,h.height=i.y;const c=h.getContext("2d"),p=c.createImageData(i.x,i.y);return p.data.set(n),c.putImageData(p,0,0),r.deleteFramebuffer(o),h}_checkPixelsForTransparency(e){const t=this._sdk.getFinalDimensions(),i=t.x*t.y*4;let r;for(let o=3;o<i;o+=4)if(r=e[o],r!==255)return!0;return!1}}Hh.prototype.availableOptions={renderType:{type:u.STRING,available:S.values(gt),default:gt.IMAGE},imageFormat:{type:u.STRING,available:S.values(ki),default:ki.PNG},quality:{type:u.NUMBER,default:.8}};var qh=Hh;const fe=e=>Uo.byteArrayToString(n_.decode(e)),{Rectangle:a_,Constants:l_,Engine:St,Utils:Uo,EventEmitter:h_,Events:Sa,Vector2:Ca,Log:It,Base64:n_,Color:d_}=Lo,{RenderType:u_,ImageFormat:c_,RendererType:Yh}=l_;class p_ extends h_{constructor(e,t={}){super();if(this._onOperationUpdate=this._onOperationUpdate.bind(this),this._onContextRestored=this._onContextRestored.bind(this),this.version="3.9.0",this[fe("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]=!0,this._preferredRenderer=e,this._options=Uo.defaults(t,{extensions:{},renderMode:"dynamic",versionCheck:!0,displayWelcomeMessage:!0,image:null,canvas:null,transparent:!1,clearColor:d_.TRANSPARENT,textureQuality:1,zoom:1,spriteScale:1,rotation:0,smoothDownscaling:!1,smoothUpscaling:!1,crossOrigin:"anonymous",logLevel:"warn",pixelRatio:typeof window!="undefined"&&window.devicePixelRatio||1}),this._options.smoothUpscaling&&(St.BaseTexture.DefaultMagFilter=St.BaseTexture.LinearFilter),this._options.extensions=Uo.defaults(this._options.extensions,{operations:[],controls:[],languages:[]}),It.setLevel(this._options.logLevel),this[fe("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]=!1,!this[fe("X29wdGlvbnM=")][fe("bGljZW5zZQ==")])this[fe("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]=!0,this._l=new Lo[fe("RnJlZUxpY2Vuc2VDaGVja2Vy")];else{if(!this._v())return;const r=Lo[fe("TGljZW5zZUNoZWNrZXI=")];this._l=new r(this[fe("X29wdGlvbnM=")][fe("bGljZW5zZQ==")]),this._cv(!0).then(()=>{this._ct()}).catch(o=>{It.error(fe("TGljZW5zaW5n"),o.message)})}this._defaultRenderMode=this._options.renderMode,this._renderMode=this._options.renderMode,this._textureQuality=this._options.textureQuality,this._offset=new Ca,this._zoom=this._options.zoom,this._spriteScale=this._options.spriteScale,this._rotation=this._options.rotation,this._operations={},this._operationsStack=null,this.setOperationsStack(new Ts),this._container=new St.Container,this._sprite=new St.Sprite,this._container.addChild(this._sprite),this._inputTexture=this._options.inputTexture,this._currentInputTexture=null,this._currentTexture=null,this._resizedTexture=null,this._resizedContainer=new St.Container,this._resizedSprite=new St.Sprite,this._resizedContainer.addChild(this._resizedSprite),this._texturesToDispose=[],this.setSmoothDownscaling(this._options.smoothDownscaling),this._registerOperations(),this._initRenderer();const i=this._renderer.constructor.type;this._options.displayWelcomeMessage,this[fe("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]&&It.log(fe("VGhlIFBob3RvRWRpdG9yIFNESyBpcyBhIGNvbW1lcmNpYWwgcHJvZHVjdC4gQmVmb3JlIGJlaW5nIGFibGUgdG8gdXNlIGl0IHdpdGhvdXQgbGltaXRhdGlvbnMsIHlvdSBuZWVkIHRvIHVubG9jayB0aGUgU0RLIHdpdGggYSBsaWNlbnNlIGZpbGUuIFlvdSBjYW4gb2J0YWluIGEgdGltZS1saW1pdGVkIGV2YWx1YXRpb24gbGljZW5zZSBieSBzdGFydGluZyBhIHRyaWFsIGF0IGh0dHBzOi8vd3d3LnBob3RvZWRpdG9yc2RrLmNvbS91c2Vycy9uZXcgb3IgeW91IGNhbiBwdXJjaGFzZSBhIGxpY2Vuc2UgYnkgcmVxdWVzdGluZyBhIHF1b3RlIGF0IGh0dHBzOi8vd3d3LnBob3RvZWRpdG9yc2RrLmNvbS9wcmljaW5nLgoKQmVjYXVzZSB5b3UgZGlkIG5vdCBzcGVjaWZ5IGEgbGljZW5zZSBmaWxlIHlldCwgdGhlIFNESyB3aWxsIG5vdyBkaXNwbGF5IGEgd2F0ZXJtYXJrIGltYWdlIG9uIHRvcCBvZiBhbnkgcGhvdG9zIHlvdSBkaXNwbGF5IG9yIGV4cG9ydCB3aXRoIGl0LiBGb3IgaW5zdHJ1Y3Rpb25zIGZvciBob3cgdG8gdW5sb2NrIHRoZSBTREssIHBsZWFzZSB2aXNpdCBodHRwczovL2RvY3MucGhvdG9lZGl0b3JzZGsuY29tL2d1aWRlcy9odG1sNS92NC9pbnRyb2R1Y3Rpb24vZ2V0dGluZ19zdGFydGVkLg==")),this._options.image&&this.setImage(this._options.image,this._options.exif)}_v(){return this[fe("X29wdGlvbnM=")][fe("bGljZW5zZQ==")]?!0:(It.error(fe("TGljZW5zaW5n"),fe("Tm8gYGxpY2Vuc2VgIG9wdGlvbiBnaXZlbi4=")),It.error(fe("TGljZW5zaW5n"),fe("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),!1)}_ct(){if(this._l.exp()){const e=this._l.isExp();e?It.error(fe("TGljZW5zaW5n"),fe("WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCB1cyBhdCBzYWxlc0BwaG90b2VkaXRvcnNkay5jb20gdG8gb2J0YWluIGEgbGljZW5zZS4=")):It.warn(fe("TGljZW5zaW5n"),fe("WW91ciB0cmlhbCBsaWNlbnNlIHdpbGwgZXhwaXJlIGluICVkIGRheXMu").replace("%d",this._l.dl()))}}_cv(e=!1){return this._l.c().catch(t=>{this[fe("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]=!1;let i=fe("SW52YWxpZCBsaWNlbnNlLg==");throw e&&(t.code==="ELICEXP"?i=fe("WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCB1cyBhdCBzYWxlc0BwaG90b2VkaXRvcnNkay5jb20gdG8gb2J0YWluIGEgbGljZW5zZS4="):t.code==="ELICINVHOST"?i=`${fe("VGhpcyBsaWNlbnNlIGlzIG5vdCB2YWxpZCBmb3IgdGhlIGhvc3RuYW1lIA==")+window.location.hostname}.`:t.code==="ELICINVPLAT"?i=fe("VGhpcyBsaWNlbnNlIGlzIG5vdCB2YWxpZCBmb3IgdGhlIGN1cnJlbnQgcGxhdGZvcm0u"):t.code==="ELICINVFMT"?i=fe("SW52YWxpZCBsaWNlbnNlIGZvcm1hdC4gUGxlYXNlIG1ha2Ugc3VyZSB5b3UncmUgcGFzc2luZyB5b3VyIGxpY2Vuc2UgYXMgYSBzdHJpbmcsIG5vdCBhcyBgJGZvcm1hdGAu").replace("$format",typeof this._options.license):t.code==="ELICINV"?i=fe("SW52YWxpZCBsaWNlbnNlISBQbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc3VwcG9ydEBwaG90b2VkaXRvcnNkay5jb20gdG8gb2J0YWluIGEgbGljZW5zZSBvciBsb2cgaW4gdG8geW91ciBjdXN0b21lciBkYXNoYm9hcmQu"):i=fe("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),t.message=i,new Error(t)})}_t(){this._l.t()}_fl(){return this[fe("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]}_onOperationUpdate(...e){this.emit(Sa.OPERATION_UPDATED,...e)}_onContextRestored(){It.warn(this.constructor.name,"Trying to re-render after WebGL context has been restored."),this.setAllOperationsToDirty(),this._operationsStack.forEach(e=>{e.disposeRenderTextures()}),this.render()}export(e=u_.DATAURL,t=c_.PNG,i=.8){return this._cv(!0).then(()=>{this.hasChanges()&&this._t(),this._operationsStack.forEach(o=>{o.onBeforeExport()});const r=new qh(this,{renderType:e,imageFormat:t,quality:i});return r.export().then(o=>(this._operationsStack.forEach(s=>{s.onAfterExport()}),Promise.resolve(o)))})}render(e=!0){if(!this._inputTexture)throw new Error("You need to set an image before calling PhotoEditorSDK#render.");const t=this._renderer.getContext();t.startFrame&&t.startFrame();let i;It.canLog("info")&&(i=new Ds("","Frame rendering")),It.info("","Rendering starts");const r=this._operationsStack;return r.updateDirtinessForRenderer(this._renderer),this._prepareTexture().then(o=>{this._renderMode==="export"&&(o=this._inputTexture),this._currentTexture=o,this._sprite.setTexture(o),this._container.updateTransform()}).then(()=>r.validateSettings()).then(()=>((this._fl()||!this[fe("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")])&&(r.getByIdentifier("license-watermark")?r.moveToTop("license-watermark"):this.createOperation("license-watermark")),r.render(this,this._currentTexture))).then(o=>{const{outputTexture:s}=o;this._currentTexture=s,this._sprite.setTexture(this._currentTexture);switch(this._renderMode){case"dynamic":{const n=this._renderer.getDimensions().clone().divide(2).add(this._offset);this._container.setScale(this._zoom/this.getTextureScale(),this._zoom/this.getTextureScale()),this._container.setPosition(n),this._sprite.setAnchor(.5,.5),this._sprite.setScale(this._spriteScale,this._spriteScale),this._sprite.setRotation(this._rotation);break}case"export":this._container.setScale(1,1),this._container.setPosition(0,0),this._sprite.setAnchor(0,0),this._sprite.setPosition(0,0),this._sprite.setScale(this._spriteScale,this._spriteScale),this._sprite.setRotation(0);break;case"adapter":this._container.setScale(1,1),this._container.setPosition(0,0),this._sprite.setAnchor(0,0),this._sprite.setPosition(0,0),this._sprite.setScale(1,1),this._sprite.setRotation(0);break}return e&&this._renderer.render(this._container),o}).then(o=>(i&&i.stop(),t.endFrame&&t.endFrame(),this._disposeTextures(),o))}getTextureScale(){return Math.min(1,this._textureQuality*this._options.pixelRatio)}_prepareTexture(){return new Promise((e,t)=>{const i=this.getTextureScale();if(this._textureQuality===1)return e(this._inputTexture);const r=this.getInputDimensions().multiply(i).floor();let o;this._resizedTexture?this._resizedTexture.getDimensions().equals(r)||(this._resizedTexture.resizeTo(r),o=!0):(this._resizedTexture=new St.RenderTexture(this._renderer,r.x,r.y),o=!0),o&&(this._resizedSprite.setScale(i,i),this._resizedSprite.setTexture(this._inputTexture),this._resizedTexture.render(this._resizedContainer)),e(this._resizedTexture)})}_registerOperations(){this._operations={};for(const e in Jr){const t=Jr[e];this._operations[t.identifier]=t}this._operations=Uo.extend(this._operations,this._options.extensions.operations)}registerOperations(e){e.forEach(t=>{this._operations[t.identifier]=t})}setAllOperationsToDirty(e=!1){this._operationsStack.setAllToDirty(e)}createOperation(e,t={},i=!0){const r=this._operations[e];if(!r)throw new Error(`No operation with identifier \`${e}\` found.`);const o=new r(this,t);return i&&this.addOperation(o),o}addOperation(e){this._operationsStack.push(e)}removeOperation(e){this._operationsStack.remove(e)}getInputDimensions(){const e=this._inputTexture.getFrame();return new Ca(e.width,e.height)}getFinalDimensions(e=!1){let t=this.getInputDimensions();const i=this._operationsStack;return i.forEach(r=>{if(!r.getEnabled())return;t=r.getNewDimensions(t)}),e&&t.multiply(this._spriteScale),t.floor()}getOutputDimensions(e=!1){return this.getFinalDimensions(e).clone().multiply(this._zoom).floor()}getOutputTextureDimensions(e=!1){const t=this.getTextureScale();let i=this.getInputDimensions().multiply(t).floor();return this._operationsStack.forEach(r=>{i=r.getNewDimensions(i)}),i}getCrossOrigin(){return Uo.getCrossOrigin(this._options.crossOrigin||"Anonymous")}_initRenderer(){const e={canvas:this._options.canvas,pixelRatio:this._options.pixelRatio,debug:this._options.debug,transparent:this._options.transparent,clearColor:this._options.clearColor};let t,i;if(this._renderMode!=="export"&&this._options.canvas){const{canvas:r}=this._options;t=r.width,i=r.height}else if(this._inputTexture){const r=this.getFinalDimensions();t=r.x,i=r.y}else t=1,i=1;switch(this._preferredRenderer){case Yh.WEBGL:this._renderer=St.autoDetectRenderer(t,i,e),this._renderer.on("context-restored",this._onContextRestored);break;case Yh.CANVAS:this._renderer=new St.CanvasRenderer(t,i,e),this._renderer.on("context-restored",this._onContextRestored);break;default:It.warn("PhotoEditorSDK",`PhotoEditorSDK Error: Renderer \`${this._preferredRenderer}\` not supported. Falling back to automatically detected renderer.`),this._renderer=St.autoDetectRenderer(t,i,e)}}resizeTo(e){this._renderer.resizeTo(e,!0)}reset(){this._operationsStack.clear()}parseExif(e){if(!e)return;let{src:t}=e,i=!1,r=null;if(i=zo.isJPEG(t),r=t,i){let o=null;try{o=zo.fromBase64String(r)}catch(s){}return o||void 0}}_handleExifOrientation(){const e=this._exif.getTags();if(e&&e.Orientation){const t=e.Orientation!==1&&e.Orientation!==2,i=[2,4,5,7].indexOf(e.Orientation)!==-1;if(t||i){if(typeof navigator=="undefined")this._exifOperation||(this._exifOperation=this.createOperation("exif-orientation")),this._exifOperation.setTags(e);else{const r=window&&window.navigator&&window.navigator.userAgent||"";(!!r.match(/msie|trident/i)||r.indexOf("Edge")!==-1||!CSS.supports("image-orientation","from-image"))&&(this._exifOperation||(this._exifOperation=this.createOperation("exif-orientation")),this._exifOperation.setTags(e))}this._exif.setOrientation(1)}}}correctExifOrientation(e){const t=this.parseExif(e);if(!t)return e;const i=t.getTags();if(i&&i.Orientation){const r=i.Orientation!==1&&i.Orientation!==2,o=[2,4,5,7].indexOf(i.Orientation)!==-1;if(r||o){if(typeof navigator=="undefined"){const s=this.createOperation("exif-orientation",{},!1);s.setTags(i),e=s.applyTo(e)}else{const s=window&&window.navigator&&window.navigator.userAgent||"";if(!!s.match(/msie|trident/i)||s.indexOf("Edge")!==-1||!CSS.supports("image-orientation","from-image")){const n=this.createOperation("exif-orientation",{},!1);n.setTags(i),e=n.applyTo(e)}}return t.setOrientation(1),i.Orientation=1,e}}return e}hasImage(){return this._image!==null&&typeof this._image!="undefined"}getImage(){return this._image}disposeTexture(e){this._texturesToDispose.push(e)}_disposeTextures(){for(let e=0;e<this._texturesToDispose.length;e++)this._texturesToDispose[e].dispose();this._texturesToDispose=[]}setImage(e,t=null,i=null){this._disposeTextures(),this._exifOperation&&(this.removeOperation(this._exifOperation),this._exifOperation=null),this._options.image=e,this._image=e,this._exif=t||this.parseExif(e),this._exif&&this._handleExifOrientation();const r=new St.BaseTexture(this._image),o=new a_(0,0,this._image.naturalWidth||this._image.width,this._image.naturalHeight||this._image.height);i&&(o.width=i.x,o.height=i.y),this._resizedTexture&&this._resizedTexture.dispose(),this._resizedTexture=null,this._inputTexture&&this.disposeTexture(this._inputTexture.getBaseTexture()),this._inputTexture=new St.Texture(r,o),this._currentTexture=this._inputTexture,this._sprite.clearTexture(!1),this._sprite.setTexture(this._inputTexture),this.emit("new-image"),this.setAllOperationsToDirty(!0)}setInputTexture(e){this._inputTexture=e}getCanvas(){return this._renderer.getCanvas()}setCanvas(e){this._renderer.setCanvas(e)}getSprite(){return this._sprite}getContainer(){return this._container}getOperationsStack(){return this._operationsStack}setOperationsStack(e){this._operationsStack&&this._operationsStack.off(Sa.OPERATION_UPDATED,this._onOperationUpdate),this._operationsStack=e,this._operationsStack.on(Sa.OPERATION_UPDATED,this._onOperationUpdate)}getOperations(){return this._operations}getRenderer(){return this._renderer}getOffset(){return this._offset}setOffset(e,t){e instanceof Ca?this._offset.copy(e):this._offset.set(e,t)}getRenderMode(){return this._renderMode}setRenderMode(e){this._renderMode=e}getZoom(){return this._zoom}setZoom(e){this._zoom=e,this._container.setScale(this._zoom,this._zoom),this._container.updateTransform()}getTextureQuality(){return this._renderMode==="export"?1:this._textureQuality}setTextureQuality(e){e!==this._textureQuality&&this.setAllOperationsToDirty(!0),this._textureQuality=Math.min(1,e),this._textureQuality===1&&this._resizedTexture&&(this._resizedTexture.dispose(),this._resizedTexture=null)}getSpriteScale(){return this._spriteScale}setSpriteScale(e){this._spriteScale=e,this._sprite.setScale(e,e),this._sprite.updateTransform()}getPixelRatio(){return this._options.pixelRatio}getExif(){return this._exif}getOptions(){return this._options}getInputTexture(){return this._inputTexture}setSmoothDownscaling(e){this._options.smoothDownscaling=e,this._sprite.setSmoothDownscaling(e),this._resizedSprite.setSmoothDownscaling(e)}setRotation(e){this._rotation=e}getRotation(){return this._rotation}hasChanges(){return this.getOperationsStack().hasChanges()}dispose(){this._operationsStack.dispose(),this._renderer.dispose(),this._exif&&this._exif.dispose(),this._resizedTexture&&this._resizedTexture.dispose()}}var Te=p_;Te.version="3.9.0";Te.Math=O;Te.Operations=Jr;Te.Engine=C;Te.Color=E;Te.LicenseChecker=bs;Te.Operation=he;Te.EventEmitter=Qe;Te.Utils=S;Te.Env=zh;Te.OperationsStack=Ts;Te.EXIF=zo;Te.Image=Ve;Te.Promise=W;Te.Configurable=Q;Te.Log=F;Te.Loaders=ea;Te.RenderType=gt;Te.ImageFormat=ki;Te.OptionType=u;Te.RendererType=re;Te.UniformType=k;Te.Base64=mt;const m_={};Te.UI=m_;var V=Te;var Xh=`precision highp float;

varying vec2 v_texCoord;
uniform sampler2D u_image;

uniform float u_gamma;
uniform float u_shadows;
uniform float u_highlights;
uniform float u_whites;
uniform float u_blacks;

uniform mat4 u_colorMatrix;
uniform vec4 u_colorOffset;

const float EPSILON = 0.0000001;

float calculateLuminance(vec3 rgb) {
    // This is the luminance calculation part of the RGB to HSL formular.
    vec4 p = mix(
        vec4(rgb.gb, 0.0, -1.0 / 3.0),
        vec4(rgb.bg, -1.0, 2.0 / 3.0),
        vec4(rgb.g < rgb.b)
    );

    vec4 q = mix(
        vec4(rgb.r, p.yzx),
        vec4(p.xyw, rgb.r),
        vec4(rgb.r < p.x)
    );

    float croma = q.x - min(q.w, q.y);
    float luminance = q.x - croma * 0.5;
    return luminance;
}

vec3 map(vec3 x, float in_min, float in_max, float out_min, float out_max){
  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;
}

void main() {

  vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);
  color.rgb /= max(color.a, EPSILON); // Revert premultiplied alpha

  // Apply gamma
  if (u_gamma != 1.0) {
    color.rgb = pow(color.rgb, vec3(1.0 / max(u_gamma, EPSILON)));
  }

  // Apply shadows and highlights
  float luminance = calculateLuminance(color.rgb);

  float shadow = u_shadows >= 0.0
    ? clamp(
          pow(luminance, 1.0 / (u_shadows + 1.0))
          + pow(luminance, 2.0 / (u_shadows + 1.0)) * -0.76
          - luminance
    , 0.0, max(u_shadows, 1.0))
    : -clamp(
          pow(luminance, 1.0 / (-u_shadows + 1.0))
          + pow(luminance, 2.0 / (-u_shadows + 1.0)) * -0.76
          - luminance
    , 0.0, max(-u_shadows, 1.0));

  float highlight = u_highlights < 0.0
    ? clamp(
          1.0
          - pow(1.0 - luminance, 1.0 / (1.0 - u_highlights))
          - pow(1.0 - luminance, 2.0 / (1.0 - u_highlights)) * -0.8
          - luminance
     , -1.0, 0.0)
    : -clamp(
          1.0
          - pow(1.0 - luminance, 1.0 / (1.0 + u_highlights))
          - pow(1.0 - luminance, 2.0 / (1.0 + u_highlights)) * -0.8
          - luminance
     , -1.0, 0.0);

  // Bright color need more contrast and dark color need more brightness.
  // This is to keep saturatation because the color information of a dark colors is lost.
  float shadowContrast   = shadow * luminance * luminance;
  float shadowBrightness = shadow - shadowContrast;

  float offset = luminance + shadowContrast + highlight;
  color.rgb = clamp(offset * ((color.rgb + shadowBrightness) / max(luminance, EPSILON)), 0.0, 1.0);
  
  // Apply Color Matrix
  color.rgb = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0).rgb;
  color.rgb = map(color.rgb, 0.0, 1.0, u_blacks / 2.0, 1.0 + u_whites / 2.0);
  color = clamp(color, 0.0, 1.0);
  color.rgb *= color.a; // Reset premultiplied alpha

  gl_FragColor = color;
}
`;const{ColorMatrix:g_}=O,$r=1e-7;function Ea(e,t,i,r,o){return(e-t)*(o-r)/(i-t)+r}const f_=e=>{const t=Math.max(e.r,e.g,e.b),i=Math.min(e.r,e.g,e.b);return(t+i)/2};class Qh extends C.Filter{constructor(){super();this._fragmentSource=Xh}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=s.getImageData(0,0,o.width,o.height),{colorMatrix:l,gamma:h,shadows:c,highlights:p,whites:d,blacks:m}=this._options,x=h!==1,b=c!==0||p!==0;let g=new E(0,0,0,0);for(let y=0;y<o.width*o.height;y++){const _=y*4;if(g.r=a.data[_]/255,g.g=a.data[_+1]/255,g.b=a.data[_+2]/255,x&&(g.r=Math.pow(g.r,1/Math.max(h,$r)),g.g=Math.pow(g.g,1/Math.max(h,$r)),g.b=Math.pow(g.b,1/Math.max(h,$r))),b){const f=f_(g),D=c>=0?S.clamp(Math.pow(f,1/(c+1))+Math.pow(f,2/(c+1))*-.76-f,0,Math.max(c,1)):-S.clamp(Math.pow(f,1/(-c+1))+Math.pow(f,2/(-c+1))*-.76-f,0,Math.max(-c,1)),v=p<0?S.clamp(1-Math.pow(1-f,1/(1-p))-Math.pow(1-f,2/(1-p))*-.8-f,-1,0):-S.clamp(1-Math.pow(1-f,1/(1+p))-Math.pow(1-f,2/(1+p))*-.8-f,-1,0),w=D*f*f,I=D-w,P=f+w+v;g.r=S.clamp(P*((g.r+I)/Math.max(f,$r)),0,1),g.g=S.clamp(P*((g.g+I)/Math.max(f,$r)),0,1),g.b=S.clamp(P*((g.b+I)/Math.max(f,$r)),0,1)}g=l.apply(g).clamp(0,1),g.r=Ea(g.r,0,1,m/2,1+d/2),g.g=Ea(g.g,0,1,m/2,1+d/2),g.b=Ea(g.b,0,1,m/2,1+d/2),a.data[_]=g.r*255,a.data[_+1]=g.g*255,a.data[_+2]=g.b*255}n.putImageData(a,0,0)}}Qh.prototype.availableOptions={gamma:{type:u.NUMBER,default:1,uniformType:k.FLOAT},shadows:{type:u.NUMBER,default:0,uniformType:k.FLOAT},highlights:{type:u.NUMBER,default:1,uniformType:k.FLOAT},whites:{type:u.NUMBER,default:0,uniformType:k.FLOAT},blacks:{type:u.NUMBER,default:0,uniformType:k.FLOAT},colorMatrix:{type:u.COLOR_MATRIX,default:new g_,uniformType:k.MAT4},colorOffset:{type:u.ARRAY,default:[],uniformType:k.FLOAT4}};var Ss=Qh;var Zh=`precision mediump float;

// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE
uniform sampler2D u_image;

// Size of one pixel == vec2(1.0 / u_image.width, 1.0 / u_image.height)
uniform vec2 u_pixelDimension;

// Range (-1.0 - 1.0)
uniform float u_clarity;

varying vec2 v_texCoord;

uniform mat4 u_colorMatrix;
uniform vec4 u_colorOffset;

const float EPSILON = 0.000001;

vec4 unpremultiply(vec4 col) {
    col.rgb /= max(col.a, EPSILON);
    return col;
}

void main() {
    vec4 color = texture2D(u_image, v_texCoord);
    color = unpremultiply(color);

    // L = Left, R = Right, C = Center, T = Top, B = Bottom
    vec4 colLB = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x, -u_pixelDimension.y));
    vec4 colLC = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,                 0.0));
    vec4 colLT = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,  u_pixelDimension.y));

    vec4 colCL = texture2D(u_image, v_texCoord + vec2(                0.0, -u_pixelDimension.y));
    vec4 colCR = texture2D(u_image, v_texCoord + vec2(                0.0,  u_pixelDimension.y));
    
    vec4 colRB = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x, -u_pixelDimension.y));
    vec4 colRC = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,                 0.0));
    vec4 colRT = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,  u_pixelDimension.y));

    vec4 mergedColor = color;
    mergedColor.rgb += unpremultiply(colLB).rgb + unpremultiply(colLC).rgb + unpremultiply(colLT).rgb;
    mergedColor.rgb += unpremultiply(colCL).rgb + unpremultiply(colCR).rgb;
    mergedColor.rgb += unpremultiply(colRB).rgb + unpremultiply(colRC).rgb + unpremultiply(colRT).rgb;

    mergedColor /= 9.0;

    float grayValue = clamp(color.r * 0.3 + color.g * 0.59 + color.b * 0.1, 0.111111, 0.999999);
    // 1.0 and 0.0 result in white not black, therefore we clamp

    // Here we create a function that will map values below 0.1 to 0. Values above 0.2 will be mapped to 1,
    // and for values between 0.1 and 0.2 it will produce a gradient.
    // The funtion is mirror at 0.5, meaning values between 0.8 and 0.9 will result in a decending gradient.
    // And values above 0.9 will be mapped to 0.
    float frequenceFactor = min(smoothstep(1.0 - grayValue, 0.0, 0.11), smoothstep(grayValue, 0.0, 0.11));

    // here we apply the high pass filter. Its strength is determined by the uniform ,
    // and the frequence factor. That means the only the mid tones are affected by this filter.
    // Clarity input is ranging from -1 to 1. But we want to strengthen the effect.
    // Therefore we see this little magic number '3.7'.
    color.rgb = clamp(color + clamp((color - mergedColor) * u_clarity * 3.7 * frequenceFactor, 0.0, 10.0), 0.0, 1.0).rgb;

    // apply exposure but only to the mid tones.
    color.rgb = color.rgb * pow(2.0, u_clarity * 0.27 * frequenceFactor);

    // apply contrast and desaturation matrix
    color.rgb = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0).rgb;

    color.rgb *= color.a; // Premultiply alpha

    gl_FragColor = clamp(color, 0.0, 1.0);
}
`;const{Vector2:__,ColorMatrix:y_}=O;class Jh extends C.Filter{constructor(){super();this._fragmentSource=Zh}_applyCanvas(e,t,i,r=!1){const o=i.getContext(),s=t.getCanvas(),n=t.getContext(),{clarity:a}=this._options,{colorMatrix:l}=this._options,h=new E(this._options.colorOffset[0],this._options.colorOffset[1],this._options.colorOffset[2],this._options.colorOffset[3]),{width:c}=s,{height:p}=s,d=n.getImageData(0,0,c,p),m=o.createImageData(c,p);this.canvasShader(d,m,a,l,h),o.putImageData(m,0,0)}canvasShader(e,t,i,r,o){const s=(g,y,_)=>Math.min(Math.max(g,y),_),n=(g,y,_)=>{const f=s((_-g)/(y-g),0,1);return f*f*(3-2*f)},a=e.width*4,{length:l}=e.data,h=l-1,c=0,p=e.data,d=t.data,m=new E,x=255*9,b=g=>(g=g<c?c:g,g=g>h?h:g,p[g]);for(let g=0;g<l;g+=4){let y=b(g+0),_=b(g+1),f=b(g+2),D=b(g+3);const v=(y+b(g-4-a+0)+b(g-4+0)+b(g-4+a+0)+b(g-a+0)+b(g+a+0)+b(g+4-a+0)+b(g+4+0)+b(g+4+a))/x,w=(_+b(g-4-a+1)+b(g-4+1)+b(g-4+a+1)+b(g-a+1)+b(g+a+1)+b(g+4-a+1)+b(g+4+1)+b(g+4+a+1))/x,I=(f+b(g-4-a+2)+b(g-4+2)+b(g-4+a+2)+b(g-a+2)+b(g+a+2)+b(g+4-a+2)+b(g+4+2)+b(g+4+a+2))/x,P=(D+b(g-4-a+3)+b(g-4+3)+b(g-4+a+3)+b(g-a+3)+b(g+a+3)+b(g+4-a+3)+b(g+4+3)+b(g+4+a+3))/x;y/=255,_/=255,f/=255,D/=255;const N=s(y*.3+_*.59+f*.1,.111111,.999999),H=Math.min(n(1-N,0,.11),n(N,0,.11)),q=i*3.7*H,J=Math.pow(2,i*.27*H),ie=s(y+s((y-v)*q,0,10),0,1)*J,ae=s(_+s((_-w)*q,0,10),0,1)*J,ke=s(f+s((f-I)*q,0,10),0,1)*J,Pe=s(D+s((D-P)*q,0,10),0,1);m.set(ie,ae,ke,Pe);const de=r.apply(m).clamp(0,1);d[g+0]=de.r*255,d[g+1]=de.g*255,d[g+2]=de.b*255,d[g+3]=de.a*255}}}Jh.prototype.availableOptions={clarity:{type:u.NUMBER,default:0,uniformType:k.FLOAT},pixelDimension:{type:u.VECTOR2,default:new __(100,100),uniformType:k.FLOAT2},colorMatrix:{type:u.COLOR_MATRIX,default:new y_,uniformType:k.MAT4},colorOffset:{type:u.ARRAY,default:[],uniformType:k.FLOAT4}};var $h=Jh;var ed=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform vec2 u_pixelDimension;
uniform float u_sharpness;
 
const float EPSILON = 0.000001;
 
void main() {
    vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);

    float factor        = mix(0.2, -1.0, float(u_sharpness > 0.0));
    vec4 sharpenedColor = mix(0.2,  5.0, float(u_sharpness > 0.0)) * color;
 
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2(-1.0,  0.0)), 0.0, 1.0);
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 0.0, -1.0)), 0.0, 1.0);
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 0.0,  1.0)), 0.0, 1.0);
    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 1.0,  0.0)), 0.0, 1.0);
 
    color.rgb /= max(color.a, EPSILON); // unpremultiply
    sharpenedColor.rgb /= max(sharpenedColor.a, EPSILON); // unpremultiply
 
    sharpenedColor = clamp(sharpenedColor, 0.0, 1.0);
 
    color = clamp(mix(color, sharpenedColor, abs(u_sharpness)), 0.0, 1.0);
      
    gl_FragColor = vec4(color.rgb * color.a, color.a); // premultiply
}`;const{Vector2:b_}=O;class td extends C.Filter{constructor(){super();this._fragmentSource=ed}_applyCanvas(e,t,i,r=!1){const o=i.getContext(),s=t.getCanvas(),n=t.getContext(),{sharpness:a}=this._options,{width:l}=s,{height:h}=s,c=n.getImageData(0,0,l,h),p=o.createImageData(l,h);this.canvasShader(c,p,a),o.putImageData(p,0,0)}canvasShader(e,t,i){const r=(f,D,v)=>Math.min(Math.max(f,D),v),o=1e-6,{width:s}=e,{height:n}=e,a=e.data,l=t.data,h=(f,D,v)=>f*(1-v)+D*v,c=f=>r(a[f]/255,0,1),p=(f,D)=>{const v=r(f,0,s-1),w=r(D,0,n-1);return 4*(v+s*w)},d=[],m=[],x=[-1,0,0,1],b=[0,-1,1,0],g=i>0?-1:.2,y=i>0?5:.2,_=Math.abs(i);for(let f=0;f<s;f++)for(let D=0;D<n;D++){const v=p(f,D);d[0]=c(v+0),d[1]=c(v+1),d[2]=c(v+2),d[3]=c(v+3),m[0]=y*d[0]*d[3],m[1]=y*d[1]*d[3],m[2]=y*d[2]*d[3],m[3]=y*d[3];for(let w=0;w<4;w++){const I=x[w],P=b[w],N=p(f+I,D+P),H=c(N+3);m[3]+=g*H;for(let q=0;q<3;q++)m[q]+=g*c(N+q)*H}for(let w=0;w<3;w++)m[w]/=Math.max(m[3],o),m[w]=r(m[w],0,1);m[3]=r(m[3],0,1);for(let w=0;w<4;w++)d[w]=r(h(d[w],m[w],_),0,1),l[v+w]=d[w]*255}}}td.prototype.availableOptions={sharpness:{type:u.NUMBER,default:0,uniformType:k.FLOAT},pixelDimension:{type:u.VECTOR2,default:new b_(100,100),uniformType:k.FLOAT2}};var id=td;var rd=`precision mediump float;

// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE
uniform sampler2D u_image;

// Range (-1.0 - 1.0)
uniform float u_temperature;

const lowp vec3 warmFilter = vec3(0.93, 0.54, 0.0);

const mediump mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.596, -0.274, -0.322, 0.212, -0.523, 0.311);
const mediump mat3 YIQtoRGB = mat3(1.0, 0.956, 0.621, 1.0, -0.272, -0.647, 1.0, -1.105, 1.702);

const float EPSILON = 0.0000001;

varying vec2 v_texCoord;
void main() {
  float temperature = u_temperature;
  const float tint = 0.0;
  vec4 source = texture2D(u_image, v_texCoord);

  source.rgb /= max(source.a, EPSILON);   // Revert premultiplied alpha

  vec3 yiq = RGBtoYIQ * source.rgb;
  yiq.b = clamp(yiq.b + tint*0.5226*0.1, -0.5226, 0.5226);
  vec3 rgb = YIQtoRGB * yiq;

  vec3 processed = mix(
    (1.0 - 2.0 * (1.0 - rgb) * (1.0 - warmFilter)),
    (2.0 * rgb * warmFilter),
    vec3(rgb.r < 0.5, rgb.g < 0.5, rgb.b < 0.5)
  );

  vec4 color = vec4(mix(rgb, processed, temperature), source.a);

  color.rgb *= color.a;   // Premultiply alpha again

  gl_FragColor = color;
}
`;const{Vector3:iE}=O;class od extends C.Filter{constructor(){super();this._fragmentSource=rd}_applyCanvas(e,t,i,r=!1){const o=i.getContext(),s=t.getCanvas(),n=t.getContext(),{temperature:a}=this._options,{width:l}=s,{height:h}=s,c=n.getImageData(0,0,l,h),p=o.createImageData(l,h);this.canvasShader(c,p,a),o.putImageData(p,0,0)}canvasShader(e,t,i){const r=(g,y,_)=>Math.min(Math.max(g,y),_),o=(g,y,_)=>g*(1-_)+y*_,s=(g,y)=>{const _=g[0]*y[0]+g[3]*y[1]+g[6]*y[2],f=g[1]*y[0]+g[4]*y[1]+g[7]*y[2],D=g[2]*y[0]+g[5]*y[1]+g[8]*y[2];return[_,f,D]},{length:n}=e.data,a=n-1,l=0,h=e.data,c=t.data,p=g=>(g=g<l?l:g,g=g>a?a:g,h[g]),d=[.93,.54,0],m=[.299,.587,.114,.596,-.274,-.322,.212,-.523,.311],x=[1,.956,.621,1,-.272,-.647,1,-1.105,1.702],b=0;for(let g=0;g<n;g+=4){const y=p(g+0)/255,_=p(g+1)/255,f=p(g+2)/255,D=p(g+3)/255,v=[y,_,f],w=s(m,v);w.z=r(w.z+b*.5226*.1,-.5226,.5226);const I=s(x,w),P=[I[0]<.5?2*I[0]*d[0]:1-2*(1-I[0])*(1-d[0]),I[1]<.5?2*I[1]*d[1]:1-2*(1-I[1])*(1-d[1]),I[2]<.5?2*I[2]*d[2]:1-2*(1-I[2])*(1-d[2])];c[g+0]=o(I[0],P[0],i)*255,c[g+1]=o(I[1],P[1],i)*255,c[g+2]=o(I[2],P[2],i)*255,c[g+3]=D*255}}}od.prototype.availableOptions={temperature:{type:u.NUMBER,default:0,uniformType:k.FLOAT}};var sd=od;const{ColorMatrix:bi}=O;class Cs extends he{constructor(...e){super(...e);this._clarityFilter=new $h,this._temperatureFilter=new sd,this._sharpnessFilter=new id,this._filter=new Ss,this._sprite.setFilters([this._clarityFilter,this._temperatureFilter,this._filter])}_render(e){const t=e.getDimensions();t.x=1/t.x,t.y=1/t.y;const i=new bi;i.multiply(bi.createSaturationMatrix(-.3*this._options.clarity+1)),i.multiply(bi.createContrastMatrix(.1*this._options.clarity+1)),this._clarityFilter.set({clarity:this._options.clarity,pixelDimension:t,colorMatrix:i,colorOffset:i.getOffsets()}),this._temperatureFilter.set({temperature:this._options.temperature}),this._sharpnessFilter.set({sharpness:this._options.sharpness,pixelDimension:t});const r=new bi;r.multiply(bi.createExposureMatrix(this._options.exposure)),r.multiply(bi.createSaturationMatrix(this._options.saturation+1)),r.multiply(bi.createContrastMatrix((this._options.contrast>0?this._options.contrast*2:this._options.contrast)+1)),r.multiply(bi.createBrightnessMatrix(this._options.brightness)),this._filter.set({gamma:this._options.gamma,shadows:this._options.shadows,highlights:this._options.highlights,whites:this._options.whites,blacks:this._options.blacks,colorMatrix:r,colorOffset:r.getOffsets()});const o=[];return this._options.clarity!==0&&o.push(this._clarityFilter),this._options.sharpness!==0&&o.push(this._sharpnessFilter),this._options.temperature!==0&&o.push(this._temperatureFilter),o.push(this._filter),this._sprite.setFilters(o),this._renderTexture.render(this._container),W.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._clarityFilter.dispose(),this._temperatureFilter.dispose(),this._sharpnessFilter.dispose()}}Cs.identifier="adjustments";Cs.prototype.availableOptions={brightness:{type:u.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},saturation:{type:u.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},contrast:{type:u.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},gamma:{type:u.NUMBER,default:1,minValue:.5,midValue:1,maxValue:2},exposure:{type:u.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},shadows:{type:u.NUMBER,default:0,minValue:-2,midValue:0,maxValue:2},highlights:{type:u.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},clarity:{type:u.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},whites:{type:u.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},blacks:{type:u.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},temperature:{type:u.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},sharpness:{type:u.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1}};V.Operations.AdjustmentsOperation=Cs;var nd=Cs;var ad=`/*
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 * @license
 */

uniform sampler2D u_image;
uniform float u_blurRadius;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(gl_FragCoord.xy / u_texSize.xy);
    float radius = u_blurRadius;

    const float steps = 30.0;

    for (float t = -steps; t <= steps; t++) {
        float percent = (t + offset - 0.5) / steps;
        float weight = 1.0 - abs(percent);

        // Somehow \`sample\` is a keyword in headless-gl
        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

        color += _sample * weight;
        total += weight;
    }

    gl_FragColor = color / total;
}
`;const{Vector2:Es}=O;class ld extends C.Filter{constructor(...e){super(...e);this._fragmentSource=ad,this._lastBlurRadius=null,this._lastDimensions=new Es(0,0),this._blurredRenderTarget=new C.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=!1,o=null){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}const s=t.getCanvas(),n=t.getContext(),a=i.getContext();this._lastBlurRadius===this._options.blurRadius&&a.drawImage(s,0,0);const l=n.getImageData(0,0,s.width,s.height),h=a.getImageData(0,0,s.width,s.height);let c=this._options.blurRadius;const{delta:p}=this._options,d=30;for(let m=0;m<s.width;m++)for(let x=0;x<s.height;x++){const b=m+x*s.width,g=b*4;let y=0,_=0,f=0,D=0,v=0;o&&(c=o(m/s.width,x/s.height));const w=this._random(m,1-x/s.height);for(let I=-d;I<=d;I++){const P=(I+w-.5)/d,N=1-Math.abs(P),H=p.x*P*c,q=p.y*P*c,J=Math.max(Math.min(m+H,s.width-1),0),ie=Math.max(Math.min(x+q,s.height-1),0),ae=(Math.round(ie)*s.width+Math.round(J))*4,ke=l.data[ae+3],Pe=ke*l.data[ae],de=ke*l.data[ae+1],A=ke*l.data[ae+2];y+=Pe*N,_+=de*N,f+=A*N,D+=ke*N,v+=N}y/=v,_/=v,f/=v,D/=v,h.data[g]=y/D,h.data[g+1]=_/D,h.data[g+2]=f/D,h.data[g+3]=D}a.putImageData(h,0,0),this._lastDimensions.copy(new Es(s.width,s.height))}_renderLQBlur(e,t,i,r){const o=t.getDimensions(),s=!this._lastDimensions.equals(o);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio()),this._blurredRenderTarget.resizeTo(t.getDimensions()),i.setPixelRatio(t.getPixelRatio()),i.resizeTo(t.getDimensions()),(this._lastBlurRadius!==this._options.blurRadius||s)&&(this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius);const n=i.getContext();n.drawImage(this._blurredRenderTarget.getCanvas(),0,0),this._lastDimensions.copy(o)}_random(e,t){const i=12.9898,r=78.233,o=43758.5453,s=e*i+t*r,n=s-3.14*Math.floor(s/3.14),a=Math.sin(n)*o;return a-Math.floor(a)}}ld.prototype.availableOptions={blurRadius:{type:u.NUMBER,default:30,uniformType:k.FLOAT},delta:{type:u.VECTOR2,default:new Es(1,1),uniformType:k.FLOAT2},texSize:{type:u.VECTOR2,default:new Es(100,100),uniformType:k.FLOAT2},blurQuality:{type:u.STRING,default:"low"}};var nt=ld;const{Vector2:hd}=O;class Rs extends he{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius;const t={blurQuality:{type:u.STRING}};this._horizontalFilter=new nt({},t),this._verticalFilter=new nt({},t),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new hd(.5,.5)),this._verticalFilter.setDelta(new hd(-.5,.5)),this._filter=new nt({},t)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){return this._options.highQualityCanvasBlur?this._renderBlur(e):this._renderLQCanvasBlur(e)}_renderBlur(e){const t=e.getDimensions(),i=t.min(),{blurRadius:r}=this._options,o={blurRadius:r*i,texSize:t,blurQuality:"high"};return this._horizontalFilter.set(o),this._verticalFilter.set(o),this._renderTexture.render(this._container),W.resolve()}_renderLQCanvasBlur(e){const{blurRadius:t}=this._options,i=e.getDimensions();return this._filter.set({blurRadius:t,texSize:i,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),W.resolve()}transform(e){const t=this.getBlurRadius(),i=e.applyToRelativeSize(t);this.set({blurRadius:i},!1)}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}}Rs.identifier="blur";Rs.prototype.availableOptions={blurRadius:{type:u.NUMBER,default:.025},highQualityCanvasBlur:{type:u.BOOLEAN,default:!1}};V.Operations.BlurOperation=Rs;var dd=Rs;var ud=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_filteredImage;
uniform float u_intensity;

void main() {
  vec4 color0 = texture2D(u_image, v_texCoord);
  vec4 color1 = texture2D(u_filteredImage, v_texCoord);
  gl_FragColor = mix(color0, color1, u_intensity);
}
`;class cd extends C.Filter{constructor(){super();this._fragmentSource=ud}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=i.getContext(),{filteredCanvas:n}=this._options;s.save(),s.globalAlpha=1-this._options.intensity,s.drawImage(o,0,0),s.globalAlpha=this._options.intensity,s.drawImage(n,0,0),s.restore()}}cd.prototype.availableOptions={filteredImage:{type:u.NUMBER,default:1,uniformType:k.INT},filteredCanvas:{type:u.OBJECT,default:null},intensity:{type:u.NUMBER,default:1,uniformType:k.FLOAT}};class x_{constructor(e=1){this._intensity=e,this._stack=[],this._dirtiness={},this._renderTextures={},this._container=new C.Container,this._sprite=new C.Sprite,this._container.addChild(this._sprite),this._blendFilter=new cd}push(e){this._stack.push(e)}clear(){this._stack=[]}render(e,t,i){if(this.isEmpty())return W.resolve();const r=e.getRenderer();this._sprite.setTexture(t);let o=this._renderTextures[r.id];if(!o){const a=e.getSprite().getTexture().getFrame();o=new C.RenderTexture(e.getRenderer(),a.width,a.height),this._renderTextures[r.id]=o}const s=i.getDimensions();o.resizeTo(s);const n=this.isDirtyForRenderer(r);if(n){this._stack.forEach(l=>{l.update(e)});const a=this._stack.map(l=>l.getFilter());this._sprite.setFilters(a),o.render(this._container),this.setDirtyForRenderer(!1,r)}if(this._blendFilter.setIntensity(this._intensity),r.isOfType(re.CANVAS))this._blendFilter.setFilteredCanvas(o.getRenderTarget().getCanvas());else if(r.isOfType(re.WEBGL)){const a=o.getBaseTexture();a.setGLUnit(this._blendFilter.getFilteredImage()),r.updateTexture(a,!1)}return this._sprite.setFilters([this._blendFilter]),i.clear(E.TRANSPARENT),i.render(this._container),n&&this.disposeRenderTextures(),W.resolve()}setIntensity(e){this._intensity=e}isEmpty(){return this._stack.length===0}isDirtyForRenderer(e){return e.id in this._dirtiness||(this._dirtiness[e.id]=!0),this._dirtiness[e.id]}setDirtyForRenderer(e,t){this._dirtiness[t.id]=e}setDirty(e){for(const t in this._dirtiness)this._dirtiness[t]=e}disposeRenderTextures(){for(const e in this._renderTextures)this._renderTextures[e].dispose(),delete this._renderTextures[e]}dispose(){this.disposeRenderTextures(),this._stack.forEach(e=>e.dispose()),this._stack=[],this._blendFilter.dispose(),this._sprite.dispose()}}var Ra=x_;class Go extends Q{constructor(e={},t={}){super(e,T({intensity:{type:u.NUMBER,default:1,setter(i){return this._stack&&this._stack.setIntensity(i),i}},dirty:{type:u.BOOLEAN,default:!0}},t));this._stack=new Ra(this._options.intensity)}render(e,t,i){return this._stack.render(e,t,i).then(r=>(this.setDirty(!1),r))}setDirtyForRenderer(e,t){this._stack.setDirtyForRenderer(e,t)}disposeRenderTextures(){this._stack.disposeRenderTextures()}dispose(){this._stack.dispose()}}Go.identifier=null;Go.isIdentity=!1;Go.displayName=null;Go.PrimitivesStack=Ra;var z=Go;var pd=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_brightness;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4((texColor.rgb + vec3(u_brightness) * texColor.a), texColor.a);;
}
`;class v_ extends Q{update(){}getFilter(){return this._filter}dispose(){this._filter&&(this._filter.dispose(),this._filter=null)}}var ye=v_;class ka extends C.Filter{constructor(){super();this._fragmentSource=pd}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=s.getImageData(0,0,o.width,o.height);let{brightness:l}=this._options;if(l===0){n.putImageData(a,0,0);return}l*=255;for(let h=0;h<o.width*o.height;h++){const c=h*4;a.data[c]+=l,a.data[c+1]+=l,a.data[c+2]+=l}n.putImageData(a,0,0)}}ka.prototype.availableOptions={brightness:{type:u.NUMBER,default:0,uniformType:k.FLOAT}};class md extends ye{constructor(...e){super(...e);this._filter=new ka}update(){this._filter.setBrightness(this._options.brightness)}}md.prototype.availableOptions=ka.prototype.availableOptions;var Bi=md;var gd=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_contrast;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = vec4(((texColor.rgb - vec3(0.5)) * u_contrast + vec3(0.5) * texColor.a), texColor.a);
}
`;class Oa extends C.Filter{constructor(){super();this._fragmentSource=gd}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=s.getImageData(0,0,o.width,o.height),{contrast:l}=this._options;if(l===1)return;for(let h=0;h<o.width*o.height;h++){const c=h*4;a.data[c]=(a.data[c]-127)*l+127,a.data[c+1]=(a.data[c+1]-127)*l+127,a.data[c+2]=(a.data[c+2]-127)*l+127}n.putImageData(a,0,0)}}Oa.prototype.availableOptions={contrast:{type:u.NUMBER,default:1,uniformType:k.FLOAT}};class fd extends ye{constructor(...e){super(...e);this._filter=new Oa}update(){this._filter.setContrast(this._options.contrast)}}fd.prototype.availableOptions=Oa.prototype.availableOptions;var at=fd;var _d=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform mat4 u_colorMatrix;
uniform vec4 u_colorMatrixOffset;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = texColor * u_colorMatrix + u_colorMatrixOffset;
}
`;const{ColorMatrix:w_}=O;class Fa extends C.Filter{constructor(){super();this._fragmentSource=_d}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=s.getImageData(0,0,o.width,o.height),{colorMatrix:l}=this._options;let h=new E(0,0,0,0);for(let c=0;c<o.width*o.height;c++){const p=c*4;h.r=a.data[p]/255,h.g=a.data[p+1]/255,h.b=a.data[p+2]/255,h=l.apply(h),a.data[p]=h.r*255,a.data[p+1]=h.g*255,a.data[p+2]=h.b*255}n.putImageData(a,0,0)}}Fa.prototype.availableOptions={colorMatrix:{type:u.COLOR_MATRIX,default:new w_,uniformType:k.MAT4},colorMatrixOffset:{type:u.ARRAY,default:[],uniformType:k.FLOAT4}};class yd extends ye{constructor(...e){super(...e);this._filter=new Fa}update(){this._filter.setColorMatrix(this._options.colorMatrix)}}yd.prototype.availableOptions=Fa.prototype.availableOptions;var ks=yd;var bd=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_desaturation;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  vec3 grayXfer = vec3(0.3, 0.59, 0.11);
  vec3 gray = vec3(dot(grayXfer, texColor.xyz));
  gl_FragColor = vec4(mix(texColor.xyz, gray, u_desaturation) * texColor.a, texColor.a);
}
`;class Aa extends C.Filter{constructor(){super();this._fragmentSource=bd}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=s.getImageData(0,0,o.width,o.height),l=[.3,.59,.11],{desaturation:h}=this._options;for(let c=0;c<o.width*o.height;c++){const p=c*4,d=l[0]*a.data[p]/255+l[1]*a.data[p+1]/255+l[2]*a.data[p+2]/255;a.data[p]+=(d*255-a.data[p])*h,a.data[p+1]+=(d*255-a.data[p+1])*h,a.data[p+2]+=(d*255-a.data[p+2])*h}n.putImageData(a,0,0)}}Aa.prototype.availableOptions={desaturation:{type:u.NUMBER,default:1,uniformType:k.FLOAT}};class xd extends ye{constructor(...e){super(...e);this._filter=new Aa}update(){this._filter.setDesaturation(this._options.desaturation)}}xd.prototype.availableOptions=Aa.prototype.availableOptions;var jt=xd;var vd=`precision highp float;

uniform sampler2D u_image;
uniform vec4 u_lightColor;
uniform vec4 u_darkColor;
uniform float u_intensity;
varying vec2 v_texCoord;

const float EPSILON = 0.0000001;
const vec3 GRAYSCALE_WEIGHTS = vec3(0.2126, 0.7152, 0.0722);

vec4 duotoneKernel(vec4 sampledCol, vec4 light, vec4 dark, float intensity) {
  vec4 color = clamp(sampledCol, 0.0, 1.0);
  color.rgb /= max(color.a, EPSILON);
  color = clamp(color, 0.0, 1.0); // necessary to get rid of all extended sRGB issues with OpenGL ES
 
  // Apply intensity as "symmetric gamma"
  if (intensity > 0.0) {
    color.rgb = 1.0 - pow(1.0 - color.rgb, vec3(max(intensity + 1.0, EPSILON)));
  } else {
    color.rgb = pow(color.rgb, vec3(max(-intensity + 1.0, EPSILON)));
  }
 
  // Colorimetric (perceptual luminance-preserving) RGB to grayscale conversion
  // https://en.wikipedia.org/wiki/Grayscale#Colorimetric_(perceptual_luminance-preserving)_conversion_to_grayscale
  float luminance = dot(GRAYSCALE_WEIGHTS, color.rgb);
 
  // Apply DuoTone
  vec4 duotone = mix(dark, light, clamp(luminance, 0.0, 1.0));
  duotone.a *= color.a;
  
  duotone.rgb *= duotone.a;

  return duotone;
}

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  gl_FragColor = duotoneKernel(texColor, u_lightColor, u_darkColor, u_intensity);
}`;class Ia extends C.Filter{constructor(){super();this._fragmentSource=vd}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=s.getImageData(0,0,o.width,o.height),{lightColor:l,darkColor:h,intensity:c}=this._options;for(let p=0;p<o.width*o.height;p++){const d=p*4,m=a.data[d]/255,x=a.data[d+1]/255,b=a.data[d+2]/255,g=a.data[d+3]/255,y=new E(m,x,b,g),_=this._duoToneKernel(y,l,h,c);a.data[d]=_.r*255,a.data[d+1]=_.g*255,a.data[d+2]=_.b*255,a.data[d+3]=_.a*255}n.putImageData(a,0,0)}_duoToneKernel(e,t,i,r){const o=1e-7;if(e.clone().clamp(0,1),r>0){const l=Math.max(r+1,o);e.r=1-Math.pow(1-e.r,l),e.g=1-Math.pow(1-e.g,l),e.b=1-Math.pow(1-e.b,l)}else{const l=Math.max(-r+1,o);e.r=Math.pow(e.r,l),e.g=Math.pow(e.g,l),e.b=Math.pow(e.b,l)}const s=.2126*e.r+.7152*e.g+.0722*e.b,n=Math.min(Math.max(s,0),1),a=i.clone().mix(t,n);return a.a*=e.a,a}}Ia.prototype.availableOptions={lightColor:{type:u.COLOR,default:E.RED,uniformType:k.FLOAT4},darkColor:{type:u.COLOR,default:E.BLACK,uniformType:k.FLOAT4},intensity:{type:u.NUMBER,default:.5,uniformType:k.FLOAT}};class wd extends ye{constructor(...e){super(...e);this._filter=new Ia}update(){this._filter.setLightColor(this._options.lightColor),this._filter.setDarkColor(this._options.darkColor);const e=2*this._options.intensity-1;this._filter.setIntensity(e)}}wd.prototype.availableOptions=Ia.prototype.availableOptions;var Os=wd;var Td=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform vec3 u_gamma;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  vec3 rgb = vec3(texColor.r, texColor.g, texColor.b);
  rgb = pow(rgb, u_gamma);
  gl_FragColor = vec4(rgb * texColor.a, texColor.a);;
}
`;class Pa extends C.Filter{constructor(){super();this._fragmentSource=Td}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=s.getImageData(0,0,o.width,o.height),{gamma:l}=this._options,h=new Float32Array(256);for(let d=0;d<256;d++)h[d]=255*Math.pow(d/255,l.r);const c=new Float32Array(256);for(let d=0;d<256;d++)c[d]=255*Math.pow(d/255,l.g);const p=new Float32Array(256);for(let d=0;d<256;d++)p[d]=255*Math.pow(d/255,l.b);for(let d=0;d<o.width*o.height;d++){const m=d*4;a.data[m]=h[a.data[m]],a.data[m+1]=c[a.data[m+1]],a.data[m+2]=p[a.data[m+2]]}n.putImageData(a,0,0)}}Pa.prototype.availableOptions={gamma:{type:u.COLOR,default:E.WHITE,uniformType:k.FLOAT3}};class Dd extends ye{constructor(...e){super(...e);this._filter=new Pa}update(){this._filter.setGamma(this._options.gamma)}}Dd.prototype.availableOptions=Pa.prototype.availableOptions;var Fs=Dd;var Sd=`varying vec2 v_texCoord;
uniform sampler2D u_image;

uniform vec3 u_color;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);

  vec2 textureCoord = v_texCoord - vec2(0.5, 0.5);
  textureCoord /= 0.75;

  float d = 1.0 - dot(textureCoord, textureCoord);
  d = clamp(d, 0.2, 1.0);
  vec3 newColor = texColor.rgb * d * u_color.rgb;
  gl_FragColor = vec4(vec3(newColor) * texColor.a, texColor.a);
}
`;class Ba extends C.Filter{constructor(){super();this._fragmentSource=Sd}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=s.getImageData(0,0,o.width,o.height),{color:l}=this._options;let h;for(let c=0;c<o.width;c++)for(let p=0;p<o.height;p++){const d=(o.width*p+c)*4,m=c/o.width,x=p/o.height,b=(m-.5)/.75,g=(x-.5)/.75,y=b*b,_=g*g;h=1-(y+_),h=Math.min(Math.max(h,.1),1),a.data[d]*=h*l.r,a.data[d+1]=a.data[d+1]*(h*l.g),a.data[d+2]=a.data[d+2]*(h*l.b),a.data[d+3]=255}n.putImageData(a,0,0)}}Ba.prototype.availableOptions={color:{type:u.COLOR,default:E.WHITE,uniformType:k.FLOAT3}};class Cd extends ye{constructor(...e){super(...e);this._filter=new Ba}update(){this._filter.setColor(this._options.color)}}Cd.prototype.availableOptions=Ba.prototype.availableOptions;var eo=Cd;var Ed=`varying vec2 v_texCoord;
uniform sampler2D u_image;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  texColor.b = texColor.g * 0.33;
  texColor.r = texColor.r * 0.6;
  texColor.b += texColor.r * 0.33;
  texColor.g = texColor.g * 0.7;
  gl_FragColor = texColor;
}
`;class T_ extends C.Filter{constructor(){super();this._fragmentSource=Ed}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=s.getImageData(0,0,o.width,o.height);for(let l=0;l<o.width;l++)for(let h=0;h<o.height;h++){const c=(o.width*h+l)*4;a.data[c+2]=a.data[c+1]*.33,a.data[c]*=.6,a.data[c+2]+=a.data[c]*.33,a.data[c+1]=a.data[c+1]*.7,a.data[c+3]=255}n.putImageData(a,0,0)}}class D_ extends ye{constructor(...e){super(...e);this._filter=new T_}}var As=D_;var Rd=`varying vec2 v_texCoord;
uniform sampler2D u_image;
vec3 W = vec3(0.2125, 0.7154, 0.0721);

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float luminance = dot(texColor.rgb, W);
  gl_FragColor = vec4(vec3(luminance) * texColor.a, texColor.a);
}
`;class S_ extends C.Filter{constructor(){super();this._fragmentSource=Rd}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=s.getImageData(0,0,o.width,o.height);for(let l=0;l<o.width;l++)for(let h=0;h<o.height;h++){const c=(o.width*h+l)*4,p=a.data[c]*.2125+a.data[c+1]*.7154+a.data[c+2]*.0721;a.data[c]=p,a.data[c+1]=p,a.data[c+2]=p}n.putImageData(a,0,0)}}class C_ extends ye{constructor(...e){super(...e);this._filter=new S_}}var to=C_;var kd=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_lookupTable;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float r = texture2D(u_lookupTable, vec2(texColor.r, 0.0)).r;
  float g = texture2D(u_lookupTable, vec2(texColor.g, 0.0)).g;
  float b = texture2D(u_lookupTable, vec2(texColor.b, 0.0)).b;

  gl_FragColor = vec4(vec3(r, g, b) * texColor.a, texColor.a);
}
`;class Od extends C.Filter{constructor(...e){super(...e);this._fragmentSource=kd}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=s.getImageData(0,0,o.width,o.height),l=this._options.lookupTableData;for(let h=0;h<o.width*o.height;h++){const c=h*4,p=a.data[c];a.data[c]=l[p*4];const d=a.data[c+1];a.data[c+1]=l[1+d*4];const m=a.data[c+2];a.data[c+2]=l[2+m*4]}n.putImageData(a,0,0)}}Od.prototype.availableOptions={lookupTable:{type:u.NUMBER,default:1,uniformType:k.INT},lookupTableData:{type:u.ARRAY,default:[]}};class E_ extends ye{constructor(...e){super(...e);this._filter=new Od({lookupTable:this._options.textureGLUnit}),this._textures={},this._renderers={}}update(e){const t=e.getRenderer();t.isOfType(re.WEBGL)?this._updateWebGLTexture(e):t.isOfType(re.CANVAS)&&this._filter.setLookupTableData(this._options.data)}_updateWebGLTexture(e){if(typeof this._options.data=="undefined")throw new Error("LookupTable: No data specified.");const t=new Uint8Array(this._options.data),i=e.getRenderer(),{id:r}=i;this._renderers[r]=i,this._textures[r]||(this._textures[r]=new C.BaseTexture);const o=this._textures[r],s=new C.PixelArrayImage(256,1,t);o.setSource(s),o.setGLUnit(this._options.textureGLUnit),i.isOfType(re.WEBGL)&&i.updateTexture(o)}dispose(){super.dispose();for(const e in this._textures)this._textures[e].dispose(),delete this._textures[e];delete this._options.data}}var Is=E_;var Fd=`/**
 * Based off of GPUImage's LookupFilter:
 * https://github.com/BradLarson/GPUImage/blob/master/framework/Source/GPUImageLookupFilter.m
 */

varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_lookupTable;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float blueColor = texColor.b * 63.0;

  vec2 quad1;
  quad1.y = floor(floor(blueColor) / 8.0);
  quad1.x = floor(blueColor) - (quad1.y * 8.0);

  vec2 quad2;
  quad2.y = floor(ceil(blueColor) / 8.0);
  quad2.x = ceil(blueColor) - (quad2.y * 8.0);

  vec2 texCoord1;
  texCoord1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);
  texCoord1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);

  vec2 texCoord2;
  texCoord2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);
  texCoord2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);

  vec4 newColor1 = texture2D(u_lookupTable, texCoord1);
  vec4 newColor2 = texture2D(u_lookupTable, texCoord2);

  vec4 newColor = mix(newColor1, newColor2, fract(blueColor));
  gl_FragColor = mix(texColor, vec4(newColor.rgb, texColor.w), texColor.a);
}
`;const{Vector2:Ad}=O,Id=3;class Pd extends C.Filter{constructor(){super();this._precomputeQuads(),this._fragmentSource=Fd}_precomputeQuads(){this._quads=[];for(let e=0;e<256;e++){const t=e/255*63,i=new Ad;i.y=(t|0)*.125|0,i.x=(t|0)-i.y*8,this._quads.push(i)}}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=this._options.lookupTableImage,l=this._createImageCanvas(a),h=l.getContext("2d"),c=s.getImageData(0,0,o.width,o.height),p=h.getImageData(0,0,a.width,a.height),d=new Ad;for(let m=0;m<o.width*o.height*4;m+=4){const x=c.data[m],b=c.data[m+1],g=c.data[m+2],y=c.data[m+3]/255,_=this._quads[g],f=64;d.x=_.x*f,d.y=_.y*f,d.x+=Math.floor(x/4),d.y+=Math.floor(b/4);const D=(a.width*d.y+d.x)*4|0;let v=p.data[D];v=x*(1-y)+v*y;let w=p.data[D+1];w=b*(1-y)+w*y;let I=p.data[D+2];I=g*(1-y)+I*y,c.data[m]=v,c.data[m+1]=w,c.data[m+2]=I}n.putImageData(c,0,0)}_createImageCanvas(e){const t=S.createCanvas();t.width=e.width,t.height=e.height;const i=t.getContext("2d");return i.drawImage(e,0,0),t}}Pd.prototype.availableOptions={lookupTable:{type:u.NUMBER,default:Id,uniformType:k.INT},lookupTableImage:{type:u.IMAGE,uniformType:null}};class Bd extends ye{constructor(...e){super(...e);this._filter=new Pd,this._textures={}}update(e){const t=e.getRenderer();t.isOfType(re.WEBGL)?this._updateWebGLTexture(e):t.isOfType(re.CANVAS)&&this._filter.setLookupTableImage(this._options.image)}_updateWebGLTexture(e){const t=e.getRenderer(),{id:i}=t;this._textures[i]||(this._textures[i]=new C.BaseTexture);const r=this._textures[i];r.setSource(this._options.image),r.setGLUnit(Id),t.updateTexture(r)}dispose(){super.dispose();for(const e in this._textures)delete this._textures[e]}}Bd.prototype.availableOptions={image:{type:u.IMAGE}};var Ps=Bd;var Md=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform float u_saturation;

const vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float luminance = dot(texColor.rgb, luminanceWeighting);

  vec3 greyScaleColor = vec3(luminance);

  gl_FragColor = vec4(mix(greyScaleColor, texColor.rgb, u_saturation) * texColor.a, texColor.a);
}
`;class Ma extends C.Filter{constructor(){super();this._fragmentSource=Md}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=s.getImageData(0,0,o.width,o.height),{saturation:l}=this._options;for(let h=0;h<o.width;h++)for(let c=0;c<o.height;c++){const p=(o.width*c+h)*4,d=a.data[p]*.2125+a.data[p+1]*.7154+a.data[p+2]*.0721;a.data[p]=d*(1-l)+a.data[p]*l,a.data[p+1]=d*(1-l)+a.data[p+1]*l,a.data[p+2]=d*(1-l)+a.data[p+2]*l}n.putImageData(a,0,0)}}Ma.prototype.availableOptions={saturation:{type:u.NUMBER,default:0,uniformType:k.FLOAT}};class Ld extends ye{constructor(...e){super(...e);this._filter=new Ma}update(){this._filter.setSaturation(this._options.saturation)}}Ld.prototype.availableOptions=Ma.prototype.availableOptions;var lt=Ld;var Nd=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform vec3 u_color;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  vec4 overlayVec4 = vec4(u_color, texColor.a);
  gl_FragColor = max(overlayVec4 * texColor.a, texColor);
}
`;class La extends C.Filter{constructor(){super();this._fragmentSource=Nd}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=s.getImageData(0,0,o.width,o.height);for(let l=0;l<o.width;l++)for(let h=0;h<o.height;h++){const c=(o.width*h+l)*4;a.data[c]=Math.max(this._options.color.r*255,a.data[c]),a.data[c+1]=Math.max(this._options.color.g*255,a.data[c+1]),a.data[c+2]=Math.max(this._options.color.b*255,a.data[c+2])}n.putImageData(a,0,0)}}La.prototype.availableOptions={color:{type:u.COLOR,default:E.WHITE,uniformType:k.FLOAT3}};class zd extends ye{constructor(...e){super(...e);this._filter=new La}update(){this._filter.setColor(this._options.color)}}zd.prototype.availableOptions=La.prototype.availableOptions;var Bs=zd;class Ud extends Is{constructor(...e){super(...e);this._options.rgbControlPoints||(this._options.rgbControlPoints={red:this._options.controlPoints,green:this._options.controlPoints,blue:this._options.controlPoints}),this._updateLookupTable()}_updateLookupTable(){const e=this._calculateSplineCurve(this._options.rgbControlPoints.red),t=this._calculateSplineCurve(this._options.rgbControlPoints.green),i=this._calculateSplineCurve(this._options.rgbControlPoints.blue);this._options.data=this._buildLookupTable(e,t,i)}_buildLookupTable(e,t,i){const r=[];for(let o=0;o<256;o++)r.push(Math.min(Math.max(o+e[o],0),255)),r.push(Math.min(Math.max(o+t[o],0),255)),r.push(Math.min(Math.max(o+i[o],0),255)),r.push(255);return r}_calculateSplineCurve(e){e=e.sort(function(s,n){return s[0]>n[0]});const t=this._getSplineCurve(e),i=t[0];let r;if(i[0]>0)for(r=0;r<i[0];r++)t.unshift([0,0]);const o=[];for(r=0;r<t.length;r++){const s=t[r],n=[s[0],s[0]];let a=Math.sqrt(Math.pow(n[0]-s[0],2)+Math.pow(n[1]-s[1],2));n[1]>s[1]&&(a=-a),o.push(a)}return o}_getSplineCurve(e){const t=this._secondDerivative(e),i=t.length,r=[];let o;for(o=0;o<i;o++)r[o]=t[o];const s=[];for(o=0;o<i-1;o++){const n=e[o],a=e[o+1];for(let l=n[0];l<a[0];l++){const h=(l-n[0])/(a[0]-n[0]),c=1-h,p=h,d=a[0]-n[0];let m=c*n[1]+p*a[1]+d*d/6*((c*c*c-c)*r[o]+(p*p*p-p)*r[o+1]);m>255?m=255:m<0&&(m=0),s.push([l,m])}}return s.length===255&&s.push(e[e.length-1]),s}_secondDerivative(e){const t=e.length;if(t<=0||t===1)return null;const i=[],r=[];let o,s;for(i[0]=[0,1,0],o=1;o<t-1;o++){const a=e[o-1],l=e[o],h=e[o+1];i[o]=i[o]||[],i[o][0]=(l[0]-a[0])/6,i[o][1]=(h[0]-a[0])/3,i[o][2]=(h[0]-l[0])/6,r[o]=(h[1]-l[1])/(h[0]-l[0])-(l[1]-a[1])/(l[0]-a[0])}for(r[0]=0,r[t-1]=0,i[t-1]=[0,1,0],o=1;o<t;o++)s=i[1][0]/i[o-1][1],i[o][1]-=s*i[o-1][2],i[o][0]=0,r[o]-=s*r[o-1];for(o=t-2;o>0;o--)s=i[o][2]/i[o+1][1],i[o][1]-=s*i[o+1][0],i[o][2]=0,r[o]-=s*r[o+1];const n=[];for(o=0;o<t;o++)n[o]=r[o]/i[o][1];return n}}Ud.prototype.availableOptions={rgbControlPoints:{type:u.OBJECT},controlPoints:{type:u.ARRAY,default:[]},textureGLUnit:{type:u.NUMBER,default:1}};var $=Ud;var Gd=`varying vec2 v_texCoord;
uniform sampler2D u_image;

void main() {
  vec4 texColor = texture2D(u_image, v_texCoord);
  float gray = texColor.r * 0.3 + texColor.g * 0.3 + texColor.b * 0.3;
  gray -= 0.2;
  gray = clamp(gray, 0.0, 1.0);
  gray += 0.15;
  gray *= 1.4;
  gl_FragColor = vec4(vec3(gray) * texColor.a, texColor.a);
}
`;class R_ extends C.Filter{constructor(){super();this._fragmentSource=Gd}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=s.getImageData(0,0,o.width,o.height);for(let l=0;l<o.width;l++)for(let h=0;h<o.height;h++){const c=(o.width*h+l)*4;let p=a.data[c]/255*.3+a.data[c+1]/255*.3+a.data[c+2]/255*.3;p-=.2,p=Math.max(0,Math.min(1,p)),p+=.15,p*=1.4,p*=255,a.data[c]=p,a.data[c+1]=p,a.data[c+2]=p}n.putImageData(a,0,0)}}class k_ extends ye{constructor(...e){super(...e);this._filter=new R_}}var Ms=k_;var jd=`precision highp float;

uniform sampler2D u_image;

uniform sampler2D u_lookupTable;

uniform float u_resolution;     // Texture-Resolution, must be power of 2: 64, 128, 256, 512, 1024, 2048, 4096
uniform float u_horizontalTileCount; // Horizontal Blue Tiles
uniform float u_verticalTileCount; // Vertical Blue Tiles

varying vec2 v_texCoord;

const float EPSILON = 0.000001;

// Try to get the exact pixel of the lut map image
vec3 lutColor(int texPosX, int texPosY) {
    return texture2D(u_lookupTable, (0.5 / u_resolution) + vec2(float(texPosX), float(texPosY)) / u_resolution).rgb;
}

vec3 bilinearInterpolate(vec3 cRfGf, vec3 cRfGc, vec3 cRcGf, vec3 cRcGc, float redFract, float greenFract) {
    return mix(mix(cRfGf, cRcGf, redFract), mix(cRfGc, cRcGc, redFract), greenFract);
}

void main() {
    vec4 inputColor = clamp(texture2D(u_image, v_texCoord.xy), 0.0, 1.0);

    vec3 sourceColor = vec3(inputColor.rgb / max(inputColor.a, EPSILON)); 

    vec3 ranges = vec3(
        floor(u_resolution / u_horizontalTileCount - 1.0),
        floor(u_resolution / u_verticalTileCount - 1.0),
        floor(u_horizontalTileCount * u_horizontalTileCount - 1.0)
    );
    
    vec3 tmp = sourceColor * ranges;
    ivec3 floors = ivec3(tmp);
    ivec3 ceils = ivec3(ceil(tmp));
    vec3 fracts = fract(tmp);

    // Map tile index to tile pixel pos.
    ivec2 pixelsPerTile = ivec2(
        u_resolution / u_horizontalTileCount, 
        u_resolution / u_verticalTileCount
      );

    ivec2 tileFloor; // Blue tile index
    tileFloor.y = floors.z / int(u_horizontalTileCount);
    tileFloor.x = (floors.z - (tileFloor.y * int(u_horizontalTileCount)));

    ivec2 tileCeil; // Blue tile index
    tileCeil.y = ceils.z / int(u_horizontalTileCount);
    tileCeil.x = (ceils.z - (tileCeil.y * int(u_horizontalTileCount)));
    
    tileFloor *= pixelsPerTile;
    tileCeil *= pixelsPerTile; 
    
    
    // Interpolate between red and green
    vec3 lutColorFB = bilinearInterpolate(
        lutColor(tileFloor.x + floors.x, tileFloor.y + floors.y),
        lutColor(tileFloor.x + floors.x, tileFloor.y + ceils.y),
        lutColor(tileFloor.x + ceils.x,  tileFloor.y + floors.y),
        lutColor(tileFloor.x + ceils.x,  tileFloor.y + ceils.y),
        fracts.x, fracts.y
    );
    vec3 lutColorCB = bilinearInterpolate(
        lutColor(tileCeil.x + floors.x, tileCeil.y + floors.y),
        lutColor(tileCeil.x + floors.x, tileCeil.y + ceils.y),
        lutColor(tileCeil.x + ceils.x,  tileCeil.y + floors.y),
        lutColor(tileCeil.x + ceils.x,  tileCeil.y + ceils.y),
        fracts.x, fracts.y
    );

    // Interpolate between the blue values
    vec3 interpolation = mix(lutColorFB, lutColorCB, fracts.z);

    // Round Color Values to prevent that for ex. 254.999999 is cutting to 254 instead of 255;
    interpolation = clamp(floor(interpolation * 255. + .5) / 255., 0.0, 1.0);

    gl_FragColor = vec4(interpolation.rgb * inputColor.a, inputColor.a);
}
`;const{Vector2:Ls,Vector3:Kd}=O,Wd=3;class Vd extends C.Filter{constructor(){super();this._precomputeQuads(),this._fragmentSource=jd}_precomputeQuads(){this._quads=[];for(let e=0;e<256;e++){const t=e/255*63,i=new Ls;i.y=(t|0)*.125|0,i.x=(t|0)-i.y*8,this._quads.push(i)}}_applyCanvas(e,t,i,r=!1){const{resolution:o,horizontalTileCount:s,verticalTileCount:n}=this._options,a=t.getCanvas(),l=t.getContext(),h=i.getContext(),c=this._options.lookupTableImage,p=this._createImageCanvas(c),d=p.getContext("2d");let m={width:128,height:128};o?m={width:o,height:o}:c.width&&c.height&&(m={width:c.width,height:c.height});const x=l.getImageData(0,0,a.width,a.height),b=d.getImageData(0,0,m.width,m.height),g=new Kd(m.width/s-1|0,m.height/n-1|0,s*n-1|0),y=new E,_=new E,f=new E,D=new E,v=new E,w=new E,I=new E,P=new E,N=new Ls,H=new Ls,q=(de,A,M,G)=>{de.r=A.r*(1-G)+M.r*G,de.g=A.g*(1-G)+M.g*G,de.b=A.b*(1-G)+M.b*G},J=(de,A,M)=>{A=.5+A|0,M=.5+M|0;const G=(M*m.width+A)*4;de.r=b.data[G]/255,de.g=b.data[G+1]/255,de.b=b.data[G+2]/255,de.a=b.data[G+3]/255},ie=new E,ae=new E,ke=(de,A,M,G,ue,Y,ne)=>{q(ie,A,G,Y),q(ae,M,ue,Y),q(de,ie,ae,ne)},Pe=new Ls(m.width,m.height).divide(s,n).floor();for(let de=0;de<a.width*a.height*4;de+=4){y.set(x.data[de]/255,x.data[de+1]/255,x.data[de+2]/255,x.data[de+3]/255);const A=new Kd(y.r*g.x,y.g*g.y,y.b*g.z),M=A.clone().floor().toInt(),G=A.clone().ceil().toInt(),ue=A.clone().fract();N.y=M.z/s|0,N.x=M.z-N.y*s|0,H.y=G.z/s|0,H.x=G.z-H.y*s|0,N.multiply(Pe),H.multiply(Pe),J(v,N.x+M.x,N.y+M.y),J(w,N.x+M.x,N.y+G.y),J(I,N.x+G.x,N.y+M.y),J(P,N.x+G.x,N.y+G.y),ke(f,v,w,I,P,ue.x,ue.y),J(v,H.x+M.x,H.y+M.y),J(w,H.x+M.x,H.y+G.y),J(I,H.x+G.x,H.y+M.y),J(P,H.x+G.x,H.y+G.y),ke(D,v,w,I,P,ue.x,ue.y),q(_,f,D,ue.z),x.data[de]=Math.ceil(_.r*255),x.data[de+1]=Math.ceil(_.g*255),x.data[de+2]=Math.ceil(_.b*255)}h.putImageData(x,0,0)}_createImageCanvas(e){const t=S.createCanvas();t.width=e.width,t.height=e.height;const i=t.getContext("2d");return i.drawImage(e,0,0),t}}Vd.prototype.availableOptions={lookupTable:{type:u.NUMBER,default:Wd,uniformType:k.INT},lookupTableImage:{type:u.IMAGE,uniformType:null},resolution:{type:u.NUMBER,uniformType:k.FLOAT},horizontalTileCount:{type:u.NUMBER,default:5,uniformType:k.FLOAT},verticalTileCount:{type:u.NUMBER,default:5,uniformType:k.FLOAT}};class Hd extends ye{constructor(...e){super(...e);this._filter=new Vd,this._textures={}}update(e){const t=e.getRenderer();t.isOfType(re.WEBGL)?this._updateWebGLTexture(e):t.isOfType(re.CANVAS)&&this._filter.setLookupTableImage(this._options.image);const{resolution:i,verticalTileCount:r,horizontalTileCount:o,image:s}=this._options;this._filter.set({resolution:i||s.width,verticalTileCount:r,horizontalTileCount:o})}_updateWebGLTexture(e){const t=e.getRenderer(),{id:i}=t;this._textures[i]||(this._textures[i]=new C.BaseTexture);const r=this._textures[i];r.setSource(this._options.image),r.setGLUnit(Wd),r.setMinFilter(C.BaseTexture.NearestFilter),t.updateTexture(r)}dispose(){super.dispose();for(const e in this._textures)delete this._textures[e]}}Hd.prototype.availableOptions={image:{type:u.IMAGE},resolution:{type:u.NUMBER},horizontalTileCount:{type:u.NUMBER,default:5},verticalTileCount:{type:u.NUMBER,default:5}};var Ns=Hd;const Na={};Fe(Na,{Brightness:()=>Bi,ColorMatrixPrimitive:()=>ks,Contrast:()=>at,Desaturation:()=>jt,DuoTone:()=>Os,Gamma:()=>Fs,Glow:()=>eo,Gobblin:()=>As,Grayscale:()=>to,LookupTable:()=>Is,LookupTableImage:()=>Ps,Saturation:()=>lt,SoftColorOverlay:()=>Bs,ThreeDLookupTableImage:()=>Ns,ToneCurve:()=>$,X400:()=>Ms});class za extends z{constructor(...e){super(...e);this._stack.push(new Bi({brightness:0}))}render(e,t,i){return this._stack.isEmpty()&&this._stack.push(new Bi({brightness:0})),super.render(e,t,i)}}za.isIdentity=!0;za.identifier="identity";var zs=za;class qd extends z{constructor(...e){super(...e);this._stack.push(new at({contrast:.63})),this._stack.push(new Bi({brightness:.12})),this._stack.push(new $({rgbControlPoints:{red:[[0,38],[94,94],[148,142],[175,187],[255,255]],green:[[0,0],[77,53],[171,190],[255,255]],blue:[[0,10],[48,85],[174,228],[255,255]]}}))}}qd.identifier="a15";var Yd=qd;class Xd extends z{constructor(...e){super(...e);this._stack.push(new jt({desaturation:.5})),this._stack.push(new $({rgbControlPoints:{red:[[0,0],[170,170],[212,219],[234,242],[255,255]],green:[[0,0],[170,168],[234,231],[255,255]],blue:[[0,0],[170,170],[212,208],[255,255]]}}))}}Xd.identifier="breeze";var Qd=Xd;class Zd extends z{constructor(...e){super(...e);this._stack.push(new to)}}Zd.identifier="bw";var Jd=Zd;class $d extends z{constructor(...e){super(...e);this._stack.push(new to),this._stack.push(new at({contrast:1.5}))}}$d.identifier="bwhard";var eu=$d;class tu extends z{constructor(...e){super(...e);this._stack.push(new $({rgbControlPoints:{red:[[0,69],[55,110],[202,230],[255,255]],green:[[0,44],[89,93],[185,141],[255,189]],blue:[[0,76],[39,82],[218,138],[255,171]]}}))}}tu.identifier="celsius";var iu=tu;class ru extends z{constructor(...e){super(...e);this._stack.push(new $({rgbControlPoints:{red:[[0,0],[44,44],[124,143],[221,204],[255,255]],green:[[0,0],[130,127],[213,199],[255,255]],blue:[[0,0],[51,52],[219,204],[255,255]]}}))}}ru.identifier="chest";var ou=ru;class Ua extends z{constructor(...e){super(...e,{intensity:{type:u.NUMBER,default:.5,required:!0,setter(t){return this._filterPrimitive&&(this._filterPrimitive.setIntensity(t),this._stack.setIntensity(1)),this._dirty=!0,t}}});this._filterPrimitive=new Os({lightColor:this._options.lightColor||E.WHITE,darkColor:this._options.darkColor||E.BLACK,intensity:this._options.intensity||.5}),this._stack.push(this._filterPrimitive)}}Ua.prototype.availableOptions={lightColor:{type:u.COLOR,default:E.WHITE,required:!0,setter(e){return this._filterPrimitive&&this._filterPrimitive.setLightColor(e),this.setDirty&&this.setDirty(!0),e}},darkColor:{type:u.COLOR,default:E.BLACK,required:!0,setter(e){return this._filterPrimitive&&this._filterPrimitive.setDarkColor(e),this.setDirty&&this.setDirty(!0),e}},intensity:{type:u.NUMBER,default:.5,required:!0}};Ua.identifier="duotone";var su=Ua;class nu extends z{constructor(...e){super(...e);this._stack.push(new $({rgbControlPoints:{red:[[0,0],[44,28],[63,48],[128,132],[235,248],[255,255]],green:[[0,0],[20,10],[60,45],[190,209],[211,231],[255,255]],blue:[[0,31],[41,62],[150,142],[234,212],[255,224]]}}))}}nu.identifier="fixie";var au=nu;class lu extends z{constructor(...e){super(...e);this._stack.push(new lt({saturation:1.35})),this._stack.push(new at({contrast:1.1}))}}lu.identifier="food";var hu=lu;class du extends z{constructor(...e){super(...e);this._stack.push(new $({rgbControlPoints:{red:[[0,9],[21,11],[45,24],[255,220]],green:[[0,12],[21,21],[42,42],[150,150],[170,173],[255,210]],blue:[[0,28],[43,72],[128,185],[255,220]]}}))}}du.identifier="fridge";var uu=du;class cu extends z{constructor(...e){super(...e);this._stack.push(new $({rgbControlPoints:{red:[[0,65],[28,67],[67,113],[125,183],[187,217],[255,229]],green:[[0,52],[42,59],[104,134],[169,209],[255,240]],blue:[[0,52],[65,68],[93,104],[150,153],[255,198]]}}))}}cu.identifier="front";var pu=cu;class mu extends z{constructor(...e){super(...e);this._stack.push(new at({contrast:1.1})),this._stack.push(new $({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[127,127],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}}))}}mu.identifier="glam";var gu=mu;class fu extends z{constructor(...e){super(...e);this._stack.push(new As)}}fu.identifier="gobblin";var _u=fu;class yu extends z{constructor(...e){super(...e);this._stack.push(new $({controlPoints:[[0,0],[53,32],[91,80],[176,205],[255,255]]})),this._stack.push(new lt({saturation:.9}))}}yu.identifier="k1";var bu=yu;class xu extends z{constructor(...e){super(...e);this._stack.push(new $({controlPoints:[[0,0],[54,33],[77,82],[94,103],[122,126],[177,193],[229,232],[255,255]]})),this._stack.push(new Bs({color:new E(40/255,40/255,40/255)}))}}xu.identifier="k2";var vu=xu;class wu extends z{constructor(...e){super(...e);this._stack.push(new lt({saturation:.5}))}}wu.identifier="k6";var Tu=wu;class Du extends z{constructor(...e){super(...e);this._stack.push(new $({controlPoints:[[0,0],[17,27],[46,69],[90,112],[156,200],[203,243],[255,255]]})),this._stack.push(new lt({saturation:.7}))}}Du.identifier="kdynamic";var Su=Du;class Cu extends z{constructor(...e){super(...e);this._stack.push(new jt({desaturation:.4})),this._stack.push(new $({rgbControlPoints:{red:[[0,20],[40,20],[106,111],[129,153],[190,223],[255,255]],green:[[0,20],[40,20],[62,41],[106,108],[132,159],[203,237],[255,255]],blue:[[0,40],[40,40],[73,60],[133,160],[191,297],[203,237],[237,239],[255,255]]}}))}}Cu.identifier="lenin";var Eu=Cu;class Ru extends z{constructor(...e){super(...e);this._stack.push(new $({controlPoints:[[0,0],[87,20],[131,156],[183,205],[255,200]]}))}}Ru.identifier="lomo";var ku=Ru;class Ou extends z{constructor(...e){super(...e);this._stack.push(new $({rgbControlPoints:{red:[[0,0],[41,84],[87,134],[255,255]],green:[[0,0],[255,216]],blue:[[0,0],[255,131]]}}))}}Ou.identifier="mellow";var Fu=Ou;const{ColorMatrix:O_}=O;class Au extends z{constructor(...e){super(...e);const t=new O_(.8158218291630716,0,0,0,-.01779810181190647,0,.8098360655737704,0,0,.0916393442622953,0,0,.4596336773932402,0,.12760574782432707,0,0,0,1,0);this._stack.push(new ks({colorMatrix:t}));const i=new E(.8,.6,.9);this._stack.push(new Fs({gamma:i}))}}Au.identifier="metal";var Iu=Au;class Pu extends z{constructor(...e){super(...e);this._stack.push(new $({rgbControlPoints:{red:[[0,40],[255,230]],green:[[0,10],[255,225]],blue:[[0,20],[255,181]]}})),this._stack.push(new eo)}}Pu.identifier="morning";var Bu=Pu;class Mu extends z{constructor(...e){super(...e);this._stack.push(new $({rgbControlPoints:{red:[[0,0],[115,130],[195,215],[255,255]],green:[[0,0],[148,153],[172,215],[255,255]],blue:[[0,46],[58,75],[178,205],[255,255]]},textureGLUnit:2})),this._stack.push(new $({controlPoints:[[0,0],[117,151],[189,217],[255,255]],textureGLUnit:3})),this._stack.push(new jt({desaturation:.65}))}}Mu.identifier="orchid";var Lu=Mu;class Nu extends z{constructor(...e){super(...e);this._stack.push(new $({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[34,34],[99,76],[176,190],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}})),this._stack.push(new lt({saturation:.8})),this._stack.push(new at({contrast:1.5}))}}Nu.identifier="pola";var zu=Nu;class Uu extends z{constructor(...e){super(...e);this._stack.push(new $({rgbControlPoints:{red:[[0,0],[56,18],[196,209],[255,255]],green:[[0,38],[71,84],[255,255]],blue:[[0,0],[131,133],[204,211],[255,255]]}})),this._stack.push(new lt({saturation:.8})),this._stack.push(new at({contrast:1.5}))}}Uu.identifier="pola669";var Gu=Uu;class ju extends z{constructor(...e){super(...e);this._stack.push(new jt({desaturation:.65})),this._stack.push(new $({rgbControlPoints:{red:[[0,50],[40,78],[118,170],[181,211],[255,255]],green:[[0,27],[28,45],[109,157],[157,195],[179,208],[206,212],[255,240]],blue:[[0,50],[12,55],[46,103],[103,162],[194,182],[241,201],[255,219]]}}))}}ju.identifier="quozi";var Ku=ju;class Wu extends z{constructor(...e){super(...e);this._stack.push(new $({rgbControlPoints:{red:[[0,129],[75,153],[181,227],[255,255]],green:[[0,8],[111,85],[212,158],[255,226]],blue:[[0,5],[75,22],[193,90],[255,229]]}})),this._stack.push(new eo)}}Wu.identifier="semired";var Vu=Wu;class Hu extends z{constructor(...e){super(...e);this._stack.push(new $({rgbControlPoints:{red:[[0,0],[62,82],[141,154],[255,255]],green:[[0,39],[56,96],[192,176],[255,255]],blue:[[0,0],[174,99],[255,235]]},textureGLUnit:2})),this._stack.push(new $({controlPoints:[[0,0],[55,20],[158,191],[255,255]],textureGLUnit:3}))}}Hu.identifier="sunny";var qu=Hu;class Yu extends z{constructor(...e){super(...e);this._stack.push(new $({rgbControlPoints:{red:[[0,72],[89,99],[176,212],[255,237]],green:[[0,49],[255,192]],blue:[[0,72],[255,151]]}}))}}Yu.identifier="texas";var Xu=Yu;class Qu extends z{constructor(...e){super(...e);this._stack.push(new Ms)}}Qu.identifier="x400";var Zu=Qu;class Ga extends z{constructor(...e){super(...e);this._lutPrimitive=new Ps({image:this._options.image}),this._stack.push(this._lutPrimitive)}}Ga.prototype.availableOptions={image:{type:u.IMAGE,required:!0,setter(e){return this._lutPrimitive&&this._lutPrimitive.setImage(e),this.setDirty(!0),e}}};Ga.identifier="lut";var Ju=Ga;class ja extends z{constructor(...e){super(...e);const{image:t,resolution:i,verticalTileCount:r,horizontalTileCount:o}=this._options;this._lutPrimitive=new Ns({image:t,resolution:i,verticalTileCount:r,horizontalTileCount:o}),this._stack.push(this._lutPrimitive)}}ja.prototype.availableOptions={image:{type:u.IMAGE,required:!0,setter(e){return this._lutPrimitive&&this._lutPrimitive.setImage(e),this.setDirty(!0),e}},resolution:{type:u.NUMBER},horizontalTileCount:{type:u.NUMBER,default:5},verticalTileCount:{type:u.NUMBER,default:5}};ja.identifier="3d-lut";var $u=ja;const Ka={};Fe(Ka,{A15Filter:()=>Yd,BWFilter:()=>Jd,BWHardFilter:()=>eu,BreezeFilter:()=>Qd,CelsiusFilter:()=>iu,ChestFilter:()=>ou,DuoToneFilter:()=>su,FixieFilter:()=>au,FoodFilter:()=>hu,FridgeFilter:()=>uu,FrontFilter:()=>pu,GlamFilter:()=>gu,GobblinFilter:()=>_u,IdentityFilter:()=>zs,K1Filter:()=>bu,K2Filter:()=>vu,K6Filter:()=>Tu,KDynamicFilter:()=>Su,LUTFilter:()=>Ju,LeninFilter:()=>Eu,LomoFilter:()=>ku,MellowFilter:()=>Fu,MetalFilter:()=>Iu,MorningFilter:()=>Bu,OrchidFilter:()=>Lu,Pola669Filter:()=>Gu,PolaFilter:()=>zu,QuoziFilter:()=>Ku,SemiredFilter:()=>Vu,SunnyFilter:()=>qu,TexasFilter:()=>Xu,ThreeDLUTFilter:()=>$u,X400Filter:()=>Zu});class Mi extends he{_render(e){return this._selectedFilter.render(this._sdk,e,this._renderTexture)}render(e){return this._selectedFilter.getDirty()&&this.setDirty(!0),this.getEnabled()?super.render(e):(this.setDirtyForRenderer(!1,this._sdk.getRenderer()),W.resolve(e))}setDirtyForRenderer(e,t){super.setDirtyForRenderer(e,t),this._selectedFilter.setDirtyForRenderer(e,t)}disposeRenderTextures(){super.disposeRenderTextures(),this._selectedFilter&&this._selectedFilter.disposeRenderTextures()}dispose(){super.dispose(),this._selectedFilter&&this._selectedFilter.dispose()}restoreSnapshot(e){const t=T({},e);if(delete t.filter,e.filter){const i=e.filter.constructor;i.identifier==="3d-lut"?this.setFilter(new i({image:e.filter.getImage(),resolution:e.filter.getResolution(),horizontalTileCount:e.filter.getHorizontalTileCount(),verticalTileCount:e.filter.getVerticalTileCount()})):i.identifier==="duotone"?this.setFilter(new i({lightColor:e.filter.getLightColor(),darkColor:e.filter.getDarkColor(),intensity:e.filter.getIntensity()})):this.setFilter(new i)}this.set(t)}resetToDefaultFilterIntensity(){const e=this._selectedFilter&&this._selectedFilter.availableOptions,t=e&&e.intensity.default;this.setIntensity(t||1)}}Mi.identifier="filter";Mi.prototype.availableOptions={identifier:{type:u.STRING,default:"identity"},intensity:{type:u.NUMBER,default:1,setter(e){return this._selectedFilter&&this._selectedFilter.setIntensity(e),e}},filter:{type:u.OBJECT,default:new zs,setter(e){return this._selectedFilter&&(this._selectedFilter.dispose(),this._selectedFilter=null),this._selectedFilter=e,typeof this._options.intensity!="undefined"&&this._selectedFilter.set({intensity:this._options.intensity}),e}}};Mi.FilterPrimitives=Na;Mi.Filters=Ka;Mi.Filter=z;V.Operations.FilterOperation=Mi;var ec=Mi;const{Vector2:cA}=O;class Us extends he{constructor(...e){super(...e);this._flipContainer=new C.Container}_render(e){const{outputResolution:t,flipHorizontally:i,flipVertically:r}=this._options;if(i||r){const o=e.getDimensions();this._flipRenderTexture?this._flipRenderTexture.resizeTo(o):(this._flipRenderTexture=new C.RenderTexture(this._sdk.getRenderer(),o.x,o.y),this._flipSprite=new C.Sprite(this._flipRenderTexture),this._flipContainer.addChild(this._flipSprite));const s=i?-1:1,n=r?-1:1;this._flipSprite.setScale(s,n),this._flipSprite.setPivot(0,0),this._flipSprite.setPosition(o.x*(1-s)*.5,o.y*(1-n)*.5),this._flipRenderTexture.clear(),this._flipRenderTexture.render(this._container),this._renderTexture.render(this._flipContainer)}else this._renderTexture.render(this._container);return W.resolve()}}Us.identifier="flip";Us.prototype.availableOptions={flipHorizontally:{type:u.BOOLEAN,default:!1},flipVertically:{type:u.BOOLEAN,default:!1}};V.Operations.FlipOperation=Us;var tc=Us;const{Vector2:io}=O;class jo extends he{constructor(...e){super(...e);this._colorOverlayFilter=new C.Filters.ColorOverlayFilter({color:this.getTintColor()}),this._frameContainer=new C.Container,this._resetSprites(),this._options.frame&&this._createSpritesForFrame(this._options.frame)}_resetSprites(){this._spriteGroups={top:{},left:{},right:{},bottom:{}},this._sprites=[],this._repeatSprites={top:[],left:[],right:[],bottom:[]}}_createSpritesForFrame(e){if(!e)return this._disposeSprites();const{imageGroups:t,layoutMode:i}=e;this._layoutMode=i||"horizontal-inside",this._disposeSprites(),["top","left","right","bottom"].forEach(r=>{if(typeof t[r]=="undefined")return;["start","mid","end"].forEach(o=>{if(typeof t[r][o]=="undefined")return;let s=t[r][o];"image"in s&&(s=s.image);const n=C.Texture.fromImage(s),a=new C.Sprite(n);this._spriteGroups[r][o]=a,this._sprites.push(a),this._frameContainer.addChild(a)})})}_render(e){const t=this._renderTexture.getDimensions();return this._options.frame&&(this._colorOverlayFilter.setColor(this.getTintColor()),this._updateSprites(e)),this._frameRenderTexture?this._frameRenderTexture.resizeTo(t):(this._frameRenderTexture=new C.RenderTexture(this._sdk.getRenderer(),t.x,t.y),this._frameSprite=new C.Sprite(this._frameRenderTexture),this._container.addChild(this._frameSprite)),this._frameSprite.setAlpha(this._options.alpha),this._options.frame&&this._options.frame.tintable?this._frameSprite.setFilters([this._colorOverlayFilter]):this._frameSprite.setFilters([]),this._frameRenderTexture.clear(),this._frameRenderTexture.render(this._frameContainer),this._renderTexture.render(this._container),W.resolve()}_updateSprites(e){const t=e.getDimensions();this._frameWidth=Math.ceil(e.getDimensions().min()*this._options.scale),this._updateHorizontalSpriteGroup(e,"top",0),this._updateHorizontalSpriteGroup(e,"bottom",t.y-this._frameWidth),this._updateVerticalSpriteGroup(e,"left",0),this._updateVerticalSpriteGroup(e,"right",t.x-this._frameWidth)}_updateHorizontalSpriteGroup(e,t,i=0){const r=e.getDimensions(),o=this._layoutMode==="vertical-inside",s=this._spriteGroups[t].start,n=this._spriteGroups[t].mid,a=this._spriteGroups[t].end;let l=0,h=0,c,p;if(s){c=s.getTexture().getDimensions(),p=c.y/c.x,l=Math.floor(this._frameWidth/p);const d=new io(0,i);d.x=o?this._frameWidth:0,s.setPosition(d),s.setHeight(this._frameWidth),s.setWidth(l)}if(a){c=a.getTexture().getDimensions(),p=c.y/c.x,h=Math.floor(this._frameWidth*p);const d=new io(r.x-h,i);d.x-=o?this._frameWidth:0,a.setPosition(d),a.setHeight(this._frameWidth),a.setWidth(h)}if(n){c=n.getTexture().getDimensions(),p=c.y/c.x;const d=new io(l,i);let m=r.x-l-h;if(o&&(d.x+=this._frameWidth,m-=this._frameWidth*2),n.setPosition(d),n.setWidth(m),n.setHeight(this._frameWidth),this._options.frame.imageGroups[t].mid.mode==="repeat"){const x=this._frameWidth/p,b=Math.ceil(m/x);let g=0;if(b!==-1){let y=Math.round(m/b);n.setWidth(y),g+=y,this._ensureRepeatSpritesExist(b-1,t,n);for(let _=0;_<b-1;_++){y=Math.round((m-g)/(b-_-1));const f=this._repeatSprites[t][_],D=d.clone().add(g,0).floor();f.setPosition(D),f.setWidth(y),f.setHeight(this._frameWidth),g+=y}}}}}_ensureRepeatSpritesExist(e,t,i){i.getTexture().setMaxListeners(e+1);const r=this._repeatSprites[t].length;if(e>r){const o=e-r;for(let s=0;s<o;s++){const n=new C.Sprite(i.getTexture());this._repeatSprites[t].push(n),this._frameContainer.addChild(n),this._sprites.push(n)}}else if(e<r){const o=this._repeatSprites[t].splice(e);o.forEach(s=>{const n=this._sprites.indexOf(s);if(n===-1)return;this._sprites.splice(n,1),this._frameContainer.removeChild(s),s.dispose()})}}_updateVerticalSpriteGroup(e,t,i=0){const r=e.getDimensions(),o=this._layoutMode==="horizontal-inside",s=this._spriteGroups[t].start,n=this._spriteGroups[t].mid,a=this._spriteGroups[t].end;let l=0,h=0,c,p;if(s){c=s.getTexture().getDimensions(),p=c.y/c.x,l=Math.floor(this._frameWidth*p);const d=new io(i,0);d.y=o?this._frameWidth:0,s.setPosition(d),s.setWidth(this._frameWidth),s.setHeight(l)}if(a){c=a.getTexture().getDimensions(),p=c.y/c.x,h=Math.floor(this._frameWidth*p);const d=new io(i,r.y-h);d.y-=o?this._frameWidth:0,a.setPosition(d),a.setWidth(this._frameWidth),a.setHeight(h)}if(n){c=n.getTexture().getDimensions(),p=c.y/c.x;const d=new io(i,l);let m=r.y-l-h;if(o&&(d.y+=this._frameWidth,m-=this._frameWidth*2),n.setPosition(d),n.setHeight(m),n.setWidth(this._frameWidth),this._options.frame.imageGroups[t].mid.mode==="repeat"){const x=this._frameWidth*p,b=Math.ceil(m/x);let g=0;if(b!==-1){let y=Math.round(m/b);n.setHeight(y),g+=y,this._ensureRepeatSpritesExist(b-1,t,n);for(let _=0;_<b-1;_++){y=Math.round((m-g)/(b-_-1));const f=this._repeatSprites[t][_],D=d.clone().add(0,g).floor();f.setPosition(D),f.setHeight(y),f.setWidth(this._frameWidth),g+=y}}}}}_disposeSprites(){this._sprites.forEach(e=>{this._frameContainer.removeChild(e),e.getTexture().dispose(),e.dispose()}),this._resetSprites()}dispose(){super.dispose(),this._disposeSprites(),this._colorOverlayFilter&&this._colorOverlayFilter.dispose(),this._frameRenderTexture&&this._frameRenderTexture.dispose()}static validateFrame(e){if(!e)return;const{imageGroups:t,layoutMode:i}=e;if(typeof e.identifier!="string")throw new Error("Frame needs a property `identifier` of type String.");if(typeof e.imageGroups!="object")throw new Error("Frame needs a property `imageGroups` of type Object.");const r=o=>{const{start:s,end:n,mid:a}=t[o];if(typeof t[o]=="undefined")return;if(typeof t[o]!="object")throw new Error(`Frame: \`imageGroups.${o}\` needs to be of type Object.`);if(typeof s!="undefined"&&!(s instanceof Ve||typeof HTMLImageElement!="undefined"&&s instanceof HTMLImageElement))throw new Error(`Frame: \`imageGroups.${o}.start\` needs to be of type Image.`);if(typeof a!="undefined"&&!(s instanceof Ve||typeof HTMLImageElement!="undefined"&&s instanceof HTMLImageElement)&&typeof a!="object")throw new Error(`Frame: \`imageGroups.${o}.mid\` needs to be of type Image or Object.`);if(typeof n!="undefined"&&!(n instanceof Ve||typeof HTMLImageElement!="undefined"&&n instanceof HTMLImageElement))throw new Error(`Frame: \`imageGroups.${o}.end\` needs to be of type Image.`)};if(typeof i!="undefined"&&["vertical-inside","horizontal-inside"].indexOf(i)===-1)throw new Error("Frame: `layoutMode` must be one of vertical-inside, horizontal-inside");if(typeof tintable!="undefined"&&typeof tintable!="boolean")throw new Error("Frame: `tintable` needs to be of type Boolean.");r("top"),r("left"),r("right"),r("bottom")}}jo.identifier="frame";jo.prototype.availableOptions={frame:{type:u.OBJECT,validation:jo.validateFrame,setter(e,t){return t||this._createSpritesForFrame(e),e},default:null},alpha:{type:u.NUMBER,default:1},tintColor:{type:u.COLOR,default:new E(1,1,1,0)},scale:{type:u.NUMBER,default:.1}};V.Operations.FrameOperation=jo;var ic=jo;const F_="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAMAAADDpiTIAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDA4NDFGODc4N0ZCMTFFOEFCRjZEQ0E4MkRCQzYyNjIiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDA4NDFGODg4N0ZCMTFFOEFCRjZEQ0E4MkRCQzYyNjIiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMDg0MUY4NTg3RkIxMUU4QUJGNkRDQTgyREJDNjI2MiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMDg0MUY4Njg3RkIxMUU4QUJGNkRDQTgyREJDNjI2MiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Ppk6b2UAAAASUExURQAAAP///8zMzDMzM2ZmZpmZmer1GSkAABunSURBVHja7F3rgt6mDlzr8v6v3O5ukqaJbQSS0GDjn+c0+9lomBkJEB8fD3tEPvbz5ocO3oPw6vgfx+aA9z56HBsBL37k+H50D8UrHz6OjYAd/42ANxvAjYC3G8BfD+0ReacB3AjYBmAj4IXPcfJQVVFQaFuQSgNYiwBW2uxTbADrEMDyA4p7RaLUABYhgP8D4i5H1xrAAgT8mvzbgWIYgLkI4D9VaGtAuQGYiAD5G4NbAxAEYAoCvmz/rkJAVQAmxoKvCGhrAIABSEeAXP/81oDiDDAfASx36NvFQAgDkIcA1kLh2U+HAKTMx1b4twlAyADTEMBUgLn9DAtAcDyYCo3HfroywAQEiFl2tgbgCEAYAuzh34lgUQaokheRnvBvE1BjAOiuNiATw79NQE0GyB9JCOgN/zYBJQIgd/+nIybcH/5tAgoEQO/hMYqAofBvDZgvANTOEAYWh1mPYwNgCQFgQ45Is8K/TcB0ARBTlaAPAY7wbxNQJgD3oevIz+3WX8+YYmtAlQDEIMAcfhI+p6WtAVUCcI8AEzWzPfyXvLQBME8A1F4ssiDA7P1Ibn5tV4PnCUBPubA9NcUafr79N9sEFArALY3flwOs4q/ceDPaGhD+aJev44Fk0Mr+ym2+2QCYIwDUSxg38iyD4T8FwK4EzHGA/BGFAKP3V7ZBZ5uAUgG4n9EyXPhTtmJtA2CGA6RBR89j5k+5g562CZggADJEG395dHaGf5uAIgfYrraoJRUQb/i3CUh/OkpAtoKQ9k1/5W6F2gBId4AmkqWGEZTOqp/domwTkOwA1fFvf8bHMv1NRb3tAqFKAFYEGKY/yShH7fWgXAcovn/+ObMNub+Mk9Q2AakOkLwAOgK83wZAnQNk91+IEf9tApAdYCsVCBD/XQoqcYAU8UdC9/XKdoHfbCs8gwAk5K9EiP82AX9NNSJhxiKATiNIEgPUF5qAX8NAGgMCiTp4I3nsv13gxTwg8usBhTVg0Azvf//35eUACGACCTx6SVnsf/mqLzQB5wEbBgEHUrTJCGog9l8JALo9QxVD2xQYoqjpf/7tGwBOIuDgo9eS2ttpu0CDzvYRgUaHSdOm//kffx0ALDJL5iJLNAHcAtRfttu1QHPBzSgGGt96gbOm/3aBvdWWthhwRvcdyWvtuAHQu+7awACl9F7RvKY+2wX2L7rdYCCFAD6MXWY2ACYB4AYDlDRROU0EZBeDx9oqnmIgiwDMjYZCoPWyNICP4cdy5D6KUTVJBLYLdADgz/oAZ3n1a6LShL+7ATAqBZrZf5OTROD1LlAO9/OjIpNKAGki8HoA0BHwfElBKgF8jJ4232nADAB80UAuAWSJwOvTgCgA5BXrGmql4QCglwOAhKJQoTPAKuED8B86fnvkt+f3//15ScDn97MQHAEMNh0acYGi9P1YtO/7UZUl8XAtgcxKWATgPnM8QwO/0SDLYIFvx9OJgfghoPjf0TQD9BMJqwHgj25c42KgU17X9UMBNGcGwjJ1II4aJZ7zvqO/xHFm14oDQBhYd0UOYCAnm4o5dzg7+L/DAAsDHZXQXgzwLM3q9IFTaH/6uGRkwT4M0DzO6vixoPzWQwEfCwOgBwNpFXXHr5VH/wEA+DDe0ZD3naOHT4uZH3OpabASbiBSmQlaw+8JRPThLMD4UkgLAzz1pVuvDRN+tIuJXIuhd5yauqTae/wIJ/xwFoCd3H05tDz5rW9GFin8cJsN2B26cxpIxrnYKQAr/HD7zSTgDaXA6lopgMHC/0gAaMFnim1sFS38cLuNAhokcInQWXRH4KY/3n7DgE3RFQpgoQD2Tf9f+3z+t//r/4+IdmwdgtxxHAAAquE5akwvGY770HaeH4jQFhoYHgC9weOie9hPA+yY/t+r9THx+cLCKRDgNhwHAKAK5nRDsNIZ+5yNGitcSeMHgFbBXK5toHbEXvM26axwHYEfAFQGc7rgHnPuTzK9XsmPA0DhV8q5DbTRf+bMv34/OAvgPxdV+JV8utamtujXMJQ+DwCVXzmY6CuX4ZMXAIC6ASCFb1+t+68DQO1XDnS4mze2uoAFcG8HKDY6ghv+Re6kcwOg9isZN/yLXEjl3g9S3GGnQwNmG/A1bqPxAqC6vYZZA+ZvxaQNACAKEISRRWw+5QVA+X0LBJT4N7mJnweA8iZ7Ajn9V0kCHwAAhpz+H8tcTC7hAKD6gUYY9VVuJXYCAKDHnmKew1pEARIAoABTDWDxbYWVwBwACBAA6kR3kSTQDQCpFzqGPIari1gAbwQB7t1UyBMYtIgF8AKgvtc+Qx7AWEYB4gGAkgUK2rCC3kKxOgAEswvHMgqwPAAwT+CuowCrA0AxD+CuowCLA4Ax47+QAiwOAELk/6UUYG0ABDYOf2cV6MO9HFwLAALtwLGQAiwNAFQCWEkBVgYAAxaAllOAlQGgmA5wLQVYGACwBLCUAngX9AsBQKgEsJQCrAsAVAe4mAJ493TVLQejpoBFXROrAFC2IWQpAgBWAO+23qotYbAO8LxtzQfw41NxLgIAbAq4mgIsCgBcAlhNARIAIEWjjEEADGpNJwJgwufiOsDFigABmXxJIQA2BTzdogZtAd2ZfAUAzveBQYymLKcArUz+99sRQAAA7ADXs4CnmP3tGgz6+woN+r5CI4ZAnpUCrlcE+BhrtvnzYo1/cTC/FMjA93DoakWAz/tfD9cznwGAHeDHsZACfM7ejquOeloxvzUFXMYCfoX+SHto+iRDGWV8C3h1k9E6AAB2gOAW8Cv2x5Rn9r3xKD4L1gJOjH02AGgxAqhXAD6/2zv1yUM9sgO8UCcpfLvJE3/CjEROAT+gGlUmG/0iAEATgMD0Kq1g/SkhgXaA9x1L50GAEW5MT4oJcgrYbFo9AwJVmj+JAhYmgAkQqOf9dF+GnALa1tT00byfTQHQDtB4hWXKtVVQUz9xYkKngOZF9WAIMGT0U6T5CQTwDQFeg/h/bglSVZHPPUKnm4Sun1c5wL5dNUFuUJOCLtcbAH/SDkt7K4FOmGIwS21aYZI1NvByG/SBaiNvAsi1AhwTehVmnw7RBB9IjyKAICtA3tAzx8xS1mwKwHaAg1PRbQWkatbPV2jkfWAOMZbpwPua9utVaYGPAvm02KkDhBD7CRyN7QDP4WnN0V06YL85O39fSmadDtsB8tXbMaXrAFVP/CkUwNAO8DwI329ng4BDB7Q98bl0HAidXBIJoAMCEjs3ZrH+JKGWZQnADoFhEiCM4GemgoydAkr7q00Q0Lifr7owK4kCsFPAJgF8h8li1sZGCokdU7h6xRTwhPYsENCoFyCo2aAJfxM7BTzHvOaQAD+cAlZ0gBeQZ00hAUJySPHTldZzgNfwNLjBfhKAooBwwX4QAVitgEa8RJlHCk4FV3SADXhqeE1AoLKk2KRdF3SALXgarID6x7xskoRyNjgBjDqetg70kQBUJhjq2lbcBybj/3QU5Qw1TQKX7lbcB2aEZzsf0GUpIE63sVNA8sGzqQMdMoDVmyZMuBWaADRl3g7+McKngKMOSBPNbt9XchgJCNZUiaFu6BSQYzZ2aJQXxKKAEPO2YjeI/iFvkoA+hwJo/t+YrHJDIy4xMoDllwNm74r9wMboqUkCsiAF+PUbeR+YBJ+FlAAZ4IdRAPI+MA4/Dd0iAYsMKBYFOBkc2QFyxjm/VjrAq1GAMxUEdoCccxi+RQLyKgoAPgp0GSj326nTCCxBATSDPkriH3EAhnxGAIwCODilgSCAy/jHoFNdCECjgOFU8GKdleufy3wtyp6IywgsQQHqnQeQD6dTjGX0GMw6DzI5rxd/ySZOYzjBKGDQy9Fy8dcJ88YEADQKGMrmZLn4R4/w3bZhHqAPAaMAehgBxM8wHfYaa1CAPIsABCf+eBTQvaazoAOMvhhOPVBDo4DuVd0FU8CvL2KM+ONRQO/x2WPVJ6otizP+eMsofT6QjuPdEFC31VCwgnCXD5Rj6ccPAfLXGuAooGdJgI7j1RAIiD/edvoOCtBj/cdjB0Pif2G80Sjg7IX4eMQzCgEOir+lcyHmkoAeD3mkNP4XA46fCvLxmGeg3RsHrjXBbaixpYJ0POhRros/3pY6kw+U41lPwDmo4bgtmQqef720n3N+kZyn455WLYs/3rZ6AwWMZ6+T4W6/q9d3ut/F23AHa5q2xPPG0ysfZgw43t+p27qED9QYzqqAu/VGqKL4412y0KAAX+JSkvbYaKAtA5QR/+VSQWfeUpT2mGiAR8s/zg9Yygd64VoGd0sHeBlL/70AFjQRuNkd5hfxOrizp+mnRNeT29oCeVDIb+Mr0x4e7veXGn9fJ9OpPjAieqWL4E0IaK/9D8GuFs6KLp6O4O/iygcPHO7Pjv8qIsAxlbzqtKcBAe2x/1HAFTQROJ/qQTlc+QrY/cFe7fiPw2CLJgIdK/4cxS/1LucMAXLMiP/VgIO1D4wCKUDl41YH1DYOofe+womAdR0tvNSEQAJqiv8E1S0UAckSgEapCcMJSFv+o00LnAhQGgF8oLSX1XsEyDEx/ldvUycCnEcAMCtgcvdlk+N/NeXq1gRy7s9FSQWbKKcjP/03vYwAU0B4qWn+Rw7tcJapU67MBkjmOMCcixtAAM99F7CbJYNeDGczZO8xJ+LZpKugFMAJ4/4BjwAteBWBpADN+OOKjgAtGfEqG8CZSgi0GVKr7V9rxMtsgGZOBaDNkAoS/8s3ITgKoKw/XqN3VGz/miNeZQRl+k6oIqwbEECV411mBClxMJAoIPaW+Iy8S6AogBP/eI3l5XL5b1kRBqIAyhz0Irnj6tFvkhDSzJBMxDMU2VXbv3J7pJM9QF3OI6jyXzwwaRRAaI63MAlXhDrkZKsmaEi/hKRU/TAIAmhiJbCWArjGfnFKP6PsYeE0AsBb/aAS2OEgIMMHMiDVXcNS5/8k0tBkpIKKmPNWpKbdfXcVZlQyaQ9tHxTBxH9OVcKUCmr4MANvhtWZcMNDQHQqaNC9MgqQeSJwb/8FSSGDU0HYlHeqCHBjmgsQQcamgibhqzsWN2nM22ePBGh+RKaCtsQX7lgcT4y/NP+b2UYgMhU0Oh+09gg0L/5s4UqIA/WZlS+0HjmhI25tPaE42UCYDzSnPnA9cubEX+1+SespgGO5D1sEdH78GwggqaYAiplcinZ7Tmrrvj5lV5SqUIwPvEgn0LqmZ/Zv7e08pyiFwYhU8BJFaF3T01r33ZX/LmLZ7HDL61DAZZzhbs+hHB94G//hytkkCPh5+uYvrHGXsibGXz3OeY4QuK3azR+Ao4CM+5yGL54w5E4zMoLUG0PgLtCa1RjFBHVL+YyESyiAfN8v4aWmVLhLSfytW0ezzYCPpxsyv+hdyiHx59Hhm00DHqvWRM+CF6nGlECNDs5aRE3FgMMbN+P7aB8YsbRrP0GQh4Fxnjb8S7RUMNCWSMyyZ8cmUkp6hn/MwB2rXaQaEv++z5OhfaS4T9aAg/nAyM1d+qT4Sx7nZvpALoz/aIdjyIfyOBch7THkf2MO9zE6wOm5d1LaI6Xxf4wOaHruneUDqTj+tuuwVyQApDbSd5wkxfF/BAQ0vNQ0zwdSefwfAIHs3BuBAm4ce4SsLQ0BmbQGk5QKOsATaWvWhQAl597ZqaBAxP9zuBZNCjk394agAHUt/z67LqDTlmGzKEBh4v8x2GkClQBW2R3Gw/Gfe9R8LQeIuSQgA++jARsA/Lnmcg5wpVSQxyelvDv+7e9HSwX7KaCRn+mrDQANglpWooBppzovf4cAnmETrMtTQNOaSeKbFXumADe3BgWMF4K/xiGCBHhaqhHHTjwObMaigDEvExokQo6/axov0TPCUQyK+R5Fjr9PyJ9BAS0j4DzSycj679VxtFSQxl6ntYdTw2kJJf7eCKL5QBl9nQYCHAmhQsffzeH6DAow9HiJFQDCiL9/bxfaQaFhCmgu1gySwHiZpS4FnMshKBTQPsyhYSOMEv8QBacFKIBd0XKQACMngEEenh9DAYY1e40YYRQDGMXeYD7QQwFtGeirCQi0AYwib7RUkFxf1SYBdo4MigGIs29gB4XE91kcd1uWQhuAwAQOTOi8b9Pcxm80g4wtAIHSDZYKipeQ2vs3TXgiaAEIVW6sJQF2f1lbBmh0iQlFAGJjBuYD1f9pAZ1/CVoAgllb8Smg89sMTV6UJ44waAq4EAVkdHqSKR57AQJAwzuHvIyBBK6tgEILQMKExVoSoJiXMZDAhRVgbAeYAE8sCpCg0pSl3ZuaLxHSBxMAmumlqA+0NHdQ4whjO0BCRFUoBYx9oYUE/rIC+i4HCGd7+PzUH0eO1x0EPB1r1ksBwSjg3+BT9L4+6oSArucAI/Sp3gfeBN83B03dHX5BgN+WAkKkgq3g+77S1unrBwT0bSlgufdlIdMBfM9n2ro8fUJgRQIIClJBKvg58e3dFzh86pxAQN+XAtb4QLZO/Cg9ctwC8NRVQNskgYh9SByGu/3BEED2GlX6Ghj3cf6cakcy86SngOkME3JDmjP0YeUOWpgAJmj01fCQMo9HXvyhD6x30LIEMMGl3zXEo08UcE/gP+d8bIc1zeM5fAKYUqprb6omEvkMLp/H/N/5/jnhKaW1XtAF7n0d4J92FGicAv6GgqllXVTwIy9r7YHAqwgA9bYsCr+13ewGUQhg2jZFekH0e9wgyirAtPV6rMbolHlTuwUC2ASQgk56+tTvgsCjukGE+8BVp74dAigEMHW3hr4l+AYIQBNAVoWK3xP8JgT4hQRQB4CK4N9DAKQKPHvDJtUYvtLZJgRMALO3bNP8ic+QLEvvJICJpQCqnvj3qAd+tVRw8stif/XNIAQwf8M+vyv2lzIrwASg838yKPQCF/tLzDMsNLPfjRIi37edBIFmH3EpSBgAnKv9uKFHt4Alp3blbDT4azf3IBDAAYBrAWvOa/Ed53xt+1I9u8VS9Wu3mCwHAFwLWNO5g32CyMsBAFYBis5ssw90jLuqZudZDAtYtUJB7wKAohJAWSv3cADoagRAqC82ZzKFA4CQASCoFrCudxv5KJHWAgCqBSxsV6dvAgCsAhQ27ZE3AQBVASrbdvGbAECYBFDauO9NAEAtApS27nwTAATTAtZ27nSWcpYCAKgC1LbvfhEAQBWguHGrs5anC60GgZaBi6/weBEAMBWgunPzewDAkEWA+t7tPhVfaEcIpgLU397wGgBAKgDA5Q1vAQCkAiDcW/0WACBWgQRgX63TBK4DAEAFEIST6m8BAKACXPVn+dgAeIUCEEavGmcpeBkAoCnAZfvK2W/lXA1cBQBoCiAwJ6vkHQAAUwDF6Van7wCAIinAXffi6W9F7wAAAa0EC9ThWueC/iIAYCAFUKiOtd6THYsAAEcBms3rdQPgyQrQbstG5S8kzqkFCACUJNB0d8Xc8fMGcA0AgCSBtq6Mc5FJrwAARBnQenXN1Ddzn+6lFQBwNvTTFcDemp/XBgDgtnCAJLDnEkuphaU+DwDlSWDfNbYz383N4EsAoDgJ7L7FmBfixhUAUKsAAzfZz0OnuPlnBQBIHcuyDHXb5HW4cQUAlCWBpmtrqdIG+tOjRQEgM6Jvmvxc2bYmQBwXAECBBWBj9A/i872BkyggID1aAACTLYA5+D/jXHiFkd8CrNAncGIS2BP87+n/+ZTZwABuXKFT6BQL8NlWvbO/vt4Q8ZxpFKAACwCAL641oa9+9+yP/NfdCv0Xq8j9G/Ia3LhAs2hp3nDzfb1RDxz4+yaF4Us1/hhoqqGAiF0SC9wX0BOi/12I8eP5N9I/nv+uzjicD0kbo1yhAN2/+jAATHrU8o4Vd4X0/yj+lkCGCz+xTaakQBvleQAQtPCfjnHFqnBI53T8HWEEzv5lFHBOjequBG8A3IWfu3LV6Rbwm6Ie1SqYVwj/VTikaGBINgDitf+eXKdfGSKet10IAIps/ZovqoXSaMMAPAAInfuLKEBssOX+t6atAGOmSqb6QIp5e/i1IF4k+le1gCwfyEHfAL8WJLW2j/3vmiMCGoRj+KUACVi5GQp+XzZ9Q8sEQoznH7REd4CBvRrzg39NAVJPANcYWOm2gO+NG9lAEM8Wk/OXQ3JGf+aGtA4AfgeC5gGB4wMTb6sljOAWuzn4DyD83NQTCQZJoOZwEYgray4MgL/BIPrfhqDWjiH93CnEEj5djxk+UOKczkMAcAGJkye7DiYzRCDQ7h5PBUDZWhjli0BubURfDgCvCeYEb2kgAO060ZJngjYALnwgJRMAfww1MjjWywLT7ZQkgCp0Yt3gK4IG3gWAjMWw5Iuk9P6Ps24A+ABAOSGKEoH25kN2ScG7koCcPJgz7bVp76EDAxsAARwoef7avPt41A5sAESIoKbJa8/m4yEM6MsAICkTlbNmV+/xg34MyMsAkLQpMutKUeqPWScGeAMgRAUpZX4N7jvtwcDbAJCzHHbdW5bjYWX6k9a84G0eMMcFStIA+zaef26o2gCw2GrvcpAmueyAoydNMXgfAML3hEiazdaQiN2LgbwOAMEu0FCK5zoC+PmXromANwBcAJBEn0WhinLhCN4HgEgXyJlOO+Hc0QkINgAco6Cp5VbKKdz+HwTv84BxLjD5VilNPHPyubv+vQCIMQGd+zA44C1jPfunMaTXLQVdDS0H0EgsAuacO+UXWoAIEzCw/YIiAPbKcE0BQBe1ju3C6yPbXbWb6wJ7hnZ0E6a6f2MTAIALNLA/uVOBWYeOtwb0Ti5L+PnDjYBZbQc2ADrX2MlG9OxMBeY1HnnpM3YBt8n7yW2SSDacbQcIaAJM4f/VjkU8ySBtB4hXCtLOgq+OpwKyHSCcCTAVfv7fjYlGEXBhIHbQkgGgzvD/2VyaR9eFaDtArFKQreyr1pnciqVsB1jkAtkRfmJzKBsImNBvZD92E2Bc9JFO48hbAAABIKPhv75boB8BWwBgTID5ZI10G7rrgtAWABQTYF7xlZGU7nJO0y4BQJgAc/h14IKWGwRsAYCoBJjDb6nsS8fuAN5ndwBMgNjv5hn9oSsEbAGoNQFHT/jt81KtCNDtAKsTQXtbhZ4Le40I2AJQDoAjI/x3P6VbAKBMQKD360fAFgAAExDo/Yy/JQ08bgEA0wCSYLTJ7X+wBQALADQ8IaWBANoCgG8CSFJ+Ta4NwBYAIBNAkoU32QKArwEkiYxzUX3aawDJj84M/0f/mcJtAEA0gGQ64rYATAEATQ1/JwK2AECYAIo14roFYKlEkLgAczsDRDEByjWsswUAQQNIefpv7oNgMIkgSQnqtgHA0ABKFWBD8rEzwEoN0Ozp10TANgB1GkAygX1bCNgCUKUBOmno7xGwM8CJAKAJvr8TAdsAlJgA5TLkbQNQ+Mg85TciYBuA2SaAtGTMeXcCwMgDykb8FAHbALy7CrENwLsRsOP/cgRsA/g+C7IN4EbANoAbAdsAbATs+L/2kW0ANwK2AXz1w4+L/z8CDADebzi4XHs84QAAAABJRU5ErkJggg==";var rc=F_;var oc=`uniform sampler2D u_image;
uniform sampler2D u_watermarkTex;

varying vec2 v_texCoord;


void main() {
  vec4 color = texture2D(u_image, v_texCoord);
  vec4 watermarkColor = texture2D(u_watermarkTex, v_texCoord);

  if (watermarkColor.r > 0.8) {
    gl_FragColor = mix(color, watermarkColor, 0.3);
  } else {
    gl_FragColor = color;
  }
}
`;class sc extends C.Filter{constructor(...e){super(...e);this._fragmentSource=oc}_applyWebGL(e,t,i,r=!1){const o=e.getContext(),{canvas:s}=o,n=this.getShaderForRenderer(e),a=t.getFrame(),l=this._watermarkCanvas;(!l||a.width!==l.width||a.height!==l.height)&&this._createWatermarkCanvas(a.width,a.height);const h=C.Texture.fromCanvas(this._watermarkCanvas),c=h.getBaseTexture();e.updateTexture(c),c.setGLUnit(1),e.setRenderTarget(i),r&&i.clear(),e.setShader(n);const p=e.getCurrentRenderTarget().getProjectionMatrix().toArray();n.setUniform("u_projMatrix",p),n.syncUniforms(),o.uniform1i(o.getUniformLocation(n.getProgram(),"u_watermarkTex"),1),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,t.getTexture()),o.activeTexture(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,c.getGLTextureForRenderer(e)),o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0),h.dispose()}_createWatermarkCanvas(e,t){const i=this._options.watermarkImage,r=S.createCanvas();r.width=e,r.height=t;const o=r.getContext("2d");let s,n,a,l,h;e>t?(s=e/i.width,a=(t-i.height*s)/2,n=0):(s=t/i.height,a=0,n=(e-i.width*s)/2),o.drawImage(i,0,0,i.width,i.height,n,a,i.width*s,i.height*s),this._watermarkCanvas=r,this._watermarkContext=o}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),a=this._options.watermarkImage;this._createWatermarkCanvas(o.width,o.height);const l=s.getImageData(0,0,o.width,o.height),h=this._watermarkContext.getImageData(0,0,o.width,o.height),c=new E,p=new E,d=new E;for(let m=0;m<o.width*o.height*4;m+=4)c.set(l.data[m]/255,l.data[m+1]/255,l.data[m+2]/255,l.data[m+3]/255),p.set(h.data[m]/255,h.data[m+1]/255,h.data[m+2]/255,h.data[m+3]/255),p.r>.8?d.copy(c.clone().mix(p,.3)):d.copy(c),l.data[m]=d.r*255,l.data[m+1]=d.g*255,l.data[m+2]=d.b*255,l.data[m+3]=d.a*255;n.putImageData(l,0,0)}}sc.prototype.availableOptions={watermarkImage:{type:u.OBJECT,required:!0}};var nc=sc;class Gs extends he{constructor(...e){super(...e);this._applyWatermarkFilter=()=>(this._watermarkFilter||(this._watermarkFilter=new nc({watermarkImage:this._watermarkImage})),this._sprite.setFilters([this._watermarkFilter]),this._renderTexture.render(this._container),W.resolve());this._loadWatermarkImage=()=>this._watermarkImage?W.resolve():new W((e,t)=>{this._watermarkImage=new Ve,this._watermarkImage.onload=e,this._watermarkImage.src=rc});this._watermarkFilter=null,this._watermarkImage=null}_render(e){return this._loadWatermarkImage().then(this._applyWatermarkFilter)}dispose(){this._watermarkFilter&&this._watermarkFilter.dispose(),super.dispose()}}Gs.identifier="license-watermark";Gs.prototype.availableOptions={};V.Operations.LicenseWatermarkOperation=Gs;var ac=Gs;var lc=`/*!
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 */

uniform sampler2D u_image;
uniform float u_blurRadius;
uniform vec2 u_controlPoint1;
uniform vec2 u_controlPoint2;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    vec2 vector = u_controlPoint2 - u_controlPoint1;
    float offset = random(gl_FragCoord.xy / u_texSize.xy);

    float radius = smoothstep(0.0, 1.0,
      abs(
        clamp(dot(v_texCoord - u_controlPoint1, vector) / dot(vector, vector), 0.0, 1.0)
      )
    ) * u_blurRadius;

    for (float t = -30.0; t <= 30.0; t++) {
      float percent = (t + offset - 0.5) / 30.0;
      float weight = 1.0 - abs(percent);
      vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

      color += _sample * weight;
      total += weight;
    }

    gl_FragColor = color / total;
}
`;const{Vector2:$t}=O;class hc extends C.Filter{constructor(...e){super(...e);this._fragmentSource=lc,this._lastBlurRadius=null,this._lastControlPoint1=new $t,this._lastControlPoint2=new $t,this._blurFilter=new nt,this._blurredRenderTarget=new C.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new C.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=!1){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}const o=t.getDimensions(),s=!i.getDimensions().equals(o),n=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||s;if(n){const a=new $t(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(a);const l={blurRadius:this._options.blurRadius,texSize:o},h=(x,b,g)=>Math.min(Math.max(x,b),g),c=(x,b,g)=>{const y=h((g-x)/(b-x),0,1);return y*y*(3-2*y)},p=this._options.controlPoint2.clone().subtract(this._options.controlPoint1.clone()),{blurRadius:d}=this._options,m=(x,b)=>c(0,1,Math.abs(h(new $t(x,b).subtract(this._options.controlPoint1).dot(p)/p.dot(p),0,1)))*d;this._blurFilter.set(l),this._blurFilter._applyCanvas(e,t,i,r,m),this._lastBlurRadius=this._options.blurRadius}}_renderLQBlur(e,t,i,r=!1){const o=t.getDimensions(),s=!this._blurredRenderTarget.getDimensions().equals(o);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio()),this._blurredRenderTarget.resizeTo(t.getDimensions()),this._maskRenderTarget.setPixelRatio(t.getPixelRatio()),this._maskRenderTarget.resizeTo(t.getDimensions());const n=!this._lastControlPoint1.equals(this._options.controlPoint1)||!this._lastControlPoint2.equals(this._options.controlPoint2)||s,a=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||s;n&&(this._renderMask(),this._lastControlPoint1=this._options.controlPoint1.clone(),this._lastControlPoint2=this._options.controlPoint2.clone()),a&&(this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(t,i)}_renderMask(){const e=this._maskRenderTarget.getCanvas(),t=this._maskRenderTarget.getContext(),i=new $t(e.width,e.height),r=this._options.controlPoint1.clone().multiply(i),o=this._options.controlPoint2.clone().multiply(i),s=t.createLinearGradient(r.x,r.y,o.x,o.y);s.addColorStop(0,"#FFFFFF"),s.addColorStop(1,"#000000"),t.fillStyle=s,t.fillRect(0,0,e.width,e.height)}_applyMask(e,t){const i=t.getContext(),r=e.getCanvas(),o=e.getContext(),s=this._blurredRenderTarget.getContext(),n=this._maskRenderTarget.getContext(),a=o.getImageData(0,0,r.width,r.height),l=a.data,h=s.getImageData(0,0,r.width,r.height).data,c=n.getImageData(0,0,r.width,r.height).data;let p;for(let d=0;d<r.width*r.height*4;d+=4)p=c[d]/255,l[d]=p*l[d]+(1-p)*h[d],l[d+1]=p*l[d+1]+(1-p)*h[d+1],l[d+2]=p*l[d+2]+(1-p)*h[d+2];i.putImageData(a,0,0)}dispose(){super.dispose(),this._blurFilter.dispose(),this._blurredRenderTarget.dispose(),this._maskRenderTarget.dispose()}}hc.prototype.availableOptions={blurRadius:{type:u.NUMBER,default:30,uniformType:k.FLOAT},controlPoint1:{type:u.VECTOR2,default:new $t(0,.5),uniformType:k.FLOAT2},controlPoint2:{type:u.VECTOR2,default:new $t(1,.5),uniformType:k.FLOAT2},delta:{type:u.VECTOR2,default:new $t(1,1),uniformType:k.FLOAT2},texSize:{type:u.VECTOR2,default:new $t(100,100),uniformType:k.FLOAT2}};var js=hc;const{Vector2:Ks}=O;class Ws extends he{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius,this._lastControlPoint1=this._options.controlPoint1.clone(),this._lastControlPoint2=this._options.controlPoint2.clone();const t={blurQuality:{type:u.STRING}};this._horizontalFilter=new js({},t),this._verticalFilter=new js({},t),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new Ks(.5,.5)),this._verticalFilter.setDelta(new Ks(-.5,.5)),this._filter=new js({},t)}rotate(e){const{controlPoint1:t}=this._options,{controlPoint2:i}=this._options;e===90?(t.flip(),t.x=1-t.x,i.flip(),i.x=1-i.x):e===-90&&(t.flip(),t.y=1-t.y,i.flip(),i.y=1-i.y),this.set({controlPoint1:t,controlPoint2:i})}flip(e){const{controlPoint1:t}=this._options,{controlPoint2:i}=this._options;switch(e){case"horizontal":t.x=1-t.x,i.x=1-i.x;break;case"vertical":t.y=1-t.y,i.y=1-i.y;break}this.set({controlPoint1:t,controlPoint2:i})}transform(e){const t={};["controlPoint1","controlPoint2"].forEach(i=>{const r=this.getOption(i);t[i]=e.applyToRelativePoint(r)}),["blurRadius"].forEach(i=>{const r=this.getOption(i);t[i]=e.applyToRelativeSize(r)}),this.set(t,!1)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){return this._options.highQualityCanvasBlur?this._renderBlur(e):this._renderLQCanvasBlur(e)}_renderBlur(e){const t=e.getDimensions(),i=t.min(),{blurRadius:r,controlPoint1:o,controlPoint2:s}=this._options,n={blurRadius:r*i,controlPoint1:o.clone(),controlPoint2:s.clone(),texSize:t,blurQuality:"high"};return this._horizontalFilter.set(n),this._verticalFilter.set(n),this._renderTexture.render(this._container),W.resolve()}_renderLQCanvasBlur(e){const t=e.getDimensions(),{blurRadius:i,controlPoint1:r,controlPoint2:o}=this._options;return this._filter.set({blurRadius:i,controlPoint1:r.clone(),controlPoint2:o.clone(),texSize:t,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),W.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}}Ws.identifier="linear-focus";Ws.prototype.availableOptions={controlPoint1:{type:u.VECTOR2,default:new Ks(0,.5)},controlPoint2:{type:u.VECTOR2,default:new Ks(1,.5)},blurRadius:{type:u.NUMBER,default:.025},highQualityCanvasBlur:{type:u.BOOLEAN,default:!1}};V.Operations.LinearFocusOperation=Ws;var dc=Ws;var uc=`/*
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 * @license
 */

uniform sampler2D u_image;
uniform float u_blurRadius;
uniform float u_gradientSize;
uniform float u_size;
uniform vec2 u_start;
uniform vec2 u_end;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(gl_FragCoord.xy / u_texSize.xy);

    vec2 normal = normalize(vec2(u_start.y - u_end.y, u_end.x - u_start.x));
    float radius = smoothstep(0.0, 1.0,
      (abs(
        dot(v_texCoord * u_texSize - u_start, normal)
      ) - u_size) / u_gradientSize
    ) * u_blurRadius;

    for (float t = -30.0; t <= 30.0; t++) {
        float percent = (t + offset - 0.5) / 30.0;
        float weight = 1.0 - abs(percent);
        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

        color += _sample * weight;
        total += weight;
    }

    gl_FragColor = color / total;
}
`;const{Vector2:ei}=O;class cc extends C.Filter{constructor(...e){super(...e);this._fragmentSource=uc,this._lastBlurRadius=null,this._lastGradientRadius=null,this._lastStart=new ei,this._lastEnd=new ei,this._blurFilter=new nt,this._blurredRenderTarget=new C.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new C.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=!1){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}const o=t.getDimensions(),s=!i.getDimensions().equals(o),n=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||s;if(n){const a=new ei(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(a);const l={blurRadius:this._options.blurRadius,texSize:o},h=(f,D,v)=>Math.min(Math.max(f,D),v),c=(f,D,v)=>{const w=h((v-f)/(D-f),0,1);return w*w*(3-2*w)},{blurRadius:p,gradientSize:d,size:m,start:x,end:b,texSize:g}=this._options,y=new ei(x.y-b.y,b.x-x.x);y.divide(y.len());const _=(f,D)=>c(0,1,(Math.abs(g.clone().multiply(f,D).subtract(x).dot(y))-m)/d)*p;this._blurFilter.set(l),this._blurFilter._applyCanvas(e,t,i,r,_),this._lastBlurRadius=this._options.blurRadius}}_renderLQBlur(e,t,i,r=!1){const o=t.getDimensions(),s=!this._blurredRenderTarget.getDimensions().equals(o);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio()),this._blurredRenderTarget.resizeTo(t.getDimensions()),this._maskRenderTarget.setPixelRatio(t.getPixelRatio()),this._maskRenderTarget.resizeTo(t.getDimensions());const n=!this._lastStart.equals(this._options.start)||!this._lastEnd.equals(this._options.end)||this._lastGradientRadius!==this._options.size||s,a=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||s;n&&(this._renderMask(),this._lastStart=this._options.start.clone(),this._lastEnd=this._options.end.clone(),this._lastGradientRadius=this._options.size),a&&(this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(t,i)}_renderMask(){const e=this._maskRenderTarget.getCanvas(),t=this._maskRenderTarget.getContext(),i=this._maskRenderTarget.getPixelRatio(),r=new ei(e.width,e.height),o=this._options.size*r.min()*i,s=this._options.gradientSize*r.min()*i,n=this._options.start.clone().multiply(r),a=this._options.end.clone().multiply(r),l=a.clone().subtract(n),h=n.clone().add(l.clone().divide(2)),c=l.len(),p=l.clone().divide(c),d=h.clone().add((o+s)*p.y,-(o+s)*p.x),m=h.clone().add(-(o+s)*p.y,(o+s)*p.x),x=t.createLinearGradient(d.x,d.y,m.x,m.y),b=m.clone().subtract(d).len();x.addColorStop(0,"#000000"),x.addColorStop(s/2/b,"#FFFFFF"),x.addColorStop(1-s/2/b,"#FFFFFF"),x.addColorStop(1,"#000000"),t.fillStyle=x,t.fillRect(0,0,e.width,e.height)}_applyMask(e,t){const i=t.getContext(),r=e.getCanvas(),o=e.getContext(),s=this._blurredRenderTarget.getContext(),n=this._maskRenderTarget.getContext(),a=o.getImageData(0,0,r.width,r.height),l=a.data,h=s.getImageData(0,0,r.width,r.height).data,c=n.getImageData(0,0,r.width,r.height).data;let p;for(let d=0;d<r.width*r.height*4;d+=4)p=c[d]/255,l[d]=p*l[d]+(1-p)*h[d],l[d+1]=p*l[d+1]+(1-p)*h[d+1],l[d+2]=p*l[d+2]+(1-p)*h[d+2];i.putImageData(a,0,0)}dispose(){super.dispose(),this._blurFilter.dispose()}}cc.prototype.availableOptions={blurRadius:{type:u.NUMBER,default:30,uniformType:k.FLOAT},size:{type:u.NUMBER,default:50,uniformType:k.FLOAT},gradientSize:{type:u.NUMBER,default:50,uniformType:k.FLOAT},start:{type:u.VECTOR2,default:new ei(0,.5),uniformType:k.FLOAT2},end:{type:u.VECTOR2,default:new ei(1,.5),uniformType:k.FLOAT2},delta:{type:u.VECTOR2,default:new ei(1,1),uniformType:k.FLOAT2},texSize:{type:u.VECTOR2,default:new ei(100,100),uniformType:k.FLOAT2}};var Vs=cc;const{Vector2:Hs}=O;class qs extends he{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius,this._lastSize=this._options.size,this._lastGradientSize=this._options.gradientSize;const t={blurQuality:{type:u.STRING}};this._horizontalFilter=new Vs({},t),this._verticalFilter=new Vs({},t),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new Hs(.5,.5)),this._verticalFilter.setDelta(new Hs(-.5,.5)),this._filter=new Vs({},t),this._renderBlur.bind(this)}rotate(e){const{start:t}=this._options,{end:i}=this._options;e===90?(t.flip(),t.x=1-t.x,i.flip(),i.x=1-i.x):e===-90&&(t.flip(),t.y=1-t.y,i.flip(),i.y=1-i.y),this.set({start:t,end:i})}flip(e){const{start:t}=this._options,{end:i}=this._options;switch(e){case"horizontal":t.x=1-t.x,i.x=1-i.x;break;case"vertical":t.y=1-t.y,i.y=1-i.y;break}this.set({start:t,end:i})}transform(e){const t={};["start","end"].forEach(i=>{const r=this.getOption(i);t[i]=e.applyToRelativePoint(r)}),["blurRadius","size","gradientSize"].forEach(i=>{const r=this.getOption(i);t[i]=e.applyToRelativeSize(r)}),this.set(t,!1)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){return this._options.highQualityCanvasBlur?this._renderBlur(e):this._renderLQCanvasBlur(e)}_renderBlur(e){const t=e.getDimensions(),i=t.min(),r=this._options.start.clone(),o=this._options.end.clone(),{blurRadius:s,size:n,gradientSize:a}=this._options,l={blurRadius:s*i,size:n*i,gradientSize:a*i,start:r.clone().multiply(t),end:o.clone().multiply(t),texSize:t,blurQuality:"high"};return this._horizontalFilter.set(l),this._verticalFilter.set(l),this._renderTexture.render(this._container),W.resolve()}_renderLQCanvasBlur(e){const t=e.getDimensions(),{blurRadius:i,size:r,gradientSize:o,start:s,end:n}=this._options;return this._filter.set({blurRadius:i,gradientSize:o,size:r,start:s.clone(),end:n.clone(),texSize:t,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),W.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}}qs.identifier="mirrored-focus";qs.prototype.availableOptions={start:{type:u.VECTOR2,default:new Hs(0,.5)},end:{type:u.VECTOR2,default:new Hs(1,.5)},blurRadius:{type:u.NUMBER,default:.025},size:{type:u.NUMBER,default:.1},gradientSize:{type:u.NUMBER,default:.1},highQualityCanvasBlur:{type:u.BOOLEAN,default:!1}};V.Operations.MirroredFocusOperation=qs;var pc=qs;const{Vector2:A_}=O;class Ys extends he{_render(e){const t=this._options.rotation%360,i=t*(Math.PI/180),r=t===90||t===270,o=this._options.flipHorizontally!==this._options.flipVertically,s=r&&o?!this._options.flipVertically:this._options.flipVertically,n=r&&o?!this._options.flipHorizontally:this._options.flipHorizontally;this._sprite.setScale(n?-1:1,s?-1:1),this._sprite.setRotation(i),this._sprite.setAnchor(.5,.5),this._sprite.updateTransform();const a=this._sprite.getBounds();return this._renderTexture.resizeTo(new A_(a.width,a.height)),this._sprite.setPosition(this._renderTexture.getDimensions().divide(2).round()),this._renderTexture.render(this._container),W.resolve()}getNewDimensions(e){return e=e.clone(),this._options.rotation%180&&e.flip(),e}flip(e){const{rotation:t}=this._options;(t===90||t===270)&&(e==="vertical"?e="horizontal":e="vertical");switch(e){case"vertical":this.setFlipVertically(!this.getFlipVertically());break;case"horizontal":this.setFlipHorizontally(!this.getFlipHorizontally());break}}}Ys.identifier="orientation";Ys.prototype.availableOptions={rotation:{type:u.NUMBER,default:0,validation(e){if(e%90!==0)throw new Error("OrientationOperation: `rotation` has to be a multiple of 90.")},setter:e=>(e+360)%360},flipVertically:{type:u.BOOLEAN,default:!1},flipHorizontally:{type:u.BOOLEAN,default:!1}};V.Operations.OrientationOperation=Ys;var mc=Ys;const{Vector2:Xs}=O;class Qs extends he{constructor(...e){super(...e);this._flipContainer=new C.Container}_render(e){const{position:t,rotation:i,scale:r,pivot:o,outputResolution:s}=this._options,n=this._sdk.getTextureScale(),a=s.clone().multiply(n).ceil();return this._renderTexture.resizeTo(a),this._sprite.setRotation(i),this._sprite.setPosition(t),this._sprite.setPivot(o),this._sprite.setScale(r),this._renderTexture.render(this._container),W.resolve()}getNewDimensions(e){const t=this._sdk.getTextureScale();return this._options.outputResolution.clone().multiply(t).ceil()}}Qs.identifier="output";Qs.prototype.availableOptions={position:{type:u.VECTOR2,default:new Xs(0,0)},rotation:{type:u.NUMBER,default:0},scale:{type:u.VECTOR2,default:new Xs(1,1)},pivot:{type:u.VECTOR2,default:new Xs(0,0)},outputResolution:{type:u.VECTOR2,default:new Xs(100,100)}};V.Operations.OutputOperation=Qs;var gc=Qs;const{OverlayFilter:Zs}=C.Filters,{Vector2:fc}=O,I_=4;class Ko extends he{constructor(...e){super(...e);this._overlayTexture=C.Texture.fromImage(this._options.image),this._overlayContainer=new C.Container,this._overlaySprite=new C.Sprite,this._overlaySprite.setTexture(this._overlayTexture),this._overlaySprite.setAnchor(0,0),this._overlayContainer.addChild(this._overlaySprite),this._overlayFilter=new C.Filters.OverlayFilter({overlayImage:this._overlayTexture.getBaseTexture().getGLUnit(),overlayTexture:this._overlayTexture}),this._sprite.setFilters([this._overlayFilter]),this._renderedOverlaySprite=new C.Sprite,this._renderedOverlayContainer=new C.Container,this._renderedOverlayContainer.addChild(this._renderedOverlaySprite),this._overlayRendered=!1,this._lastInputDimensions=new fc(0,0)}setOption(e,t){if(super.setOption(e,t),e==="image"&&t&&this._sdk){const i=this._sdk.getRenderer(),r=this._overlayTexture.getBaseTexture();r.setSource(t),i.isOfType(re.WEBGL)&&i.updateTexture(r),this._overlayRendered=!1}}_render(e){const t=e.getDimensions(),{image:i,alpha:r,blendMode:o}=this._options;return i?((!this._overlayRendered||!this._lastInputDimensions.equals(t))&&(this._renderOverlayToRenderTexture(e),this._overlayRendered=!0,this._lastInputDimensions.copy(t)),this._overlayFilter.set({blendMode:o,overlayImage:this._overlayRenderTexture.getBaseTexture().getGLUnit(),overlayTexture:this._overlayRenderTexture,alpha:r}),this._sprite.setFilters([this._overlayFilter]),this._renderTexture.render(this._container),W.resolve()):(this._sprite.setFilters([]),this._renderTexture.render(this._container),W.resolve())}_renderOverlayToRenderTexture(e){const t=this._sdk.getRenderer(),i=e.getDimensions();this._overlayRenderTexture||(this._overlayRenderTexture=new C.RenderTexture(t,i.x,i.y),this._renderedOverlaySprite.setTexture(this._overlayRenderTexture));const{width:r,height:o}=this._options.image,s=S.resizeVectorToFill(new fc(r,o),i),{flipHorizontally:n,flipVertically:a}=this._options,l=n?-1:1,h=a?-1:1;this._overlaySprite.setWidth(s.x*l),this._overlaySprite.setHeight(s.y*h),this._overlaySprite.setPosition(i.x*(1-l)*.5,i.y*(1-h)*.5);const c=this._overlayRenderTexture.getBaseTexture();this._overlayRenderTexture.resizeTo(i),t.isOfType(re.WEBGL)&&(c.setGLUnit(I_),t.updateTexture(c,!1)),this._overlayRenderTexture.render(this._overlayContainer)}dispose(){super.dispose(),this._overlaySprite&&this._overlaySprite.dispose(),this._overlayRenderTexture&&this._renderedOverlaySprite.dispose(),this._overlayFilter&&this._overlayFilter.dispose(),this._overlayTexture&&this._overlayTexture.dispose(),this._overlayRenderTexture&&this._overlayRenderTexture.dispose(),this._renderedOverlaySprite&&this._renderedOverlaySprite.dispose()}}Ko.identifier="overlay";Ko.BLEND_MODES=Zs.BLEND_MODES;Ko.prototype.availableOptions={identifier:{type:u.STRING},image:{type:u.IMAGE},blendMode:{type:u.NUMBER,default:Zs.BLEND_MODES.MULTIPLY,available:Object.keys(Zs.BLEND_MODES).map(e=>Zs.BLEND_MODES[e])},alpha:{type:u.NUMBER,default:1},flipHorizontally:{type:u.BOOLEAN,default:!1},flipVertically:{type:u.BOOLEAN,default:!1}};V.Operations.OverlayOperation=Ko;var _c=Ko;var yc=`/*
 * Based on evanw's glfx.js tilt shift shader:
 * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js
 * @license
 */

uniform sampler2D u_image;
uniform float u_radius;
uniform float u_blurRadius;
uniform float u_gradientRadius;
uniform vec2 u_position;
uniform vec2 u_delta;
uniform vec2 u_texSize;
varying vec2 v_texCoord;

const float blurSteps = 30.0;
const float EPSILON = 0.000000001;

float random(vec2 co)
{
    highp float a = 12.9898;
    highp float b = 78.233;
    highp float c = 43758.5453;
    highp float dt = dot(co.xy,vec2(a,b));
    highp float sn = mod(dt, 3.14);
    return fract(sin(sn) * c);
}

void main() {
    vec4 color = vec4(0.0);
    float total = 0.0;

    vec2 coord = v_texCoord * u_texSize;
    vec2 diff = coord - u_position;
    float dist = sqrt(diff.x * diff.x + diff.y * diff.y);

    float blurPercentage = smoothstep( 
      0.0, 1.0,
      (abs(dist) - u_radius) / u_gradientRadius
    );

    float radius = blurPercentage * u_blurRadius;
    float offset = random(gl_FragCoord.xy / u_texSize.xy);

    for (float t = -blurSteps; t <= blurSteps; t++) {
        float percent = (t + offset - 0.5) / blurSteps;
        float weight = 1.0 - abs(percent);
        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);

        color += _sample * weight;
        total += weight;
    }

    gl_FragColor = color / max(total, EPSILON);
}
`;const{Vector2:ro}=O;class bc extends C.Filter{constructor(...e){super(...e);this._fragmentSource=yc,this._lastBlurRadius=null,this._lastGradientRadius=null,this._lastPosition=new ro,this._blurFilter=new nt,this._blurredRenderTarget=new C.CanvasRenderTarget(100,100,1),this._maskRenderTarget=new C.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=!1){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}const o=t.getDimensions(),s=!i.getDimensions().equals(o),{blurRadius:n,position:a,texSize:l,gradientRadius:h}=this._options,c=t.getBaseTexture().isDirty()||this._lastBlurRadius!==n||s;if(c){const p=new ro(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(p);const d={blurRadius:n,texSize:o},m=(g,y,_)=>Math.min(Math.max(g,y),_),x=(g,y,_)=>{const f=m((_-g)/(y-g),0,1);return f*f*(3-2*f)},b=(g,y)=>x(0,1,(Math.abs(l.clone().multiply(g,y).subtract(a).len())-this._options.radius)/(h*2))*n;this._blurFilter.set(d),this._blurFilter._applyCanvas(e,t,i,r,b),this._lastBlurRadius=n}}_renderLQBlur(e,t,i,r=!1){const o=t.getDimensions(),s=!this._blurredRenderTarget.getDimensions().equals(o);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio()),this._blurredRenderTarget.resizeTo(t.getDimensions()),this._maskRenderTarget.setPixelRatio(t.getPixelRatio()),this._maskRenderTarget.resizeTo(t.getDimensions());const n=!this._lastPosition.equals(this._options.position)||this._lastGradientRadius!==this._options.gradientRadius||s,a=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||s;n&&(this._renderMask(),this._lastPosition=this._options.position.clone(),this._lastGradientRadius=this._options.gradientRadius),a&&(this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius),this._lastBlurRadius=this._options.blurRadius),this._applyMask(t,i)}_renderMask(){const e=this._maskRenderTarget.getCanvas(),t=this._maskRenderTarget.getContext(),i=new ro(e.width,e.height),r=this._maskRenderTarget.getPixelRatio(),o=this._options.position.clone().multiply(i);let{radius:s,gradientRadius:n}=this._options;s*=e.height,n*=e.height;const a=t.createRadialGradient(o.x,o.y,0,o.x,o.y,(s+n)*r);a.addColorStop(0,"#FFFFFF"),a.addColorStop(s/(s+n),"#FFFFFF"),a.addColorStop(1,"#000000"),t.fillStyle=a,t.fillRect(0,0,i.x,i.y)}_applyMask(e,t){const i=t.getContext(),r=e.getCanvas(),o=e.getContext(),s=this._blurredRenderTarget.getContext(),n=this._maskRenderTarget.getContext(),a=o.getImageData(0,0,r.width,r.height),l=a.data,h=s.getImageData(0,0,r.width,r.height).data,c=n.getImageData(0,0,r.width,r.height).data;let p;for(let d=0;d<r.width*r.height*4;d+=4)p=c[d]/255,l[d]=p*l[d]+(1-p)*h[d],l[d+1]=p*l[d+1]+(1-p)*h[d+1],l[d+2]=p*l[d+2]+(1-p)*h[d+2];i.putImageData(a,0,0)}dispose(){super.dispose(),this._blurFilter.dispose(),this._blurredRenderTarget.dispose(),this._maskRenderTarget.dispose()}}bc.prototype.availableOptions={blurRadius:{type:u.NUMBER,default:30,uniformType:k.FLOAT},radius:{type:u.NUMBER,default:50,uniformType:k.FLOAT},gradientRadius:{type:u.NUMBER,default:25,uniformType:k.FLOAT},position:{type:u.VECTOR2,default:new ro(.5,.5),uniformType:k.FLOAT2},delta:{type:u.VECTOR2,default:new ro(1,1),uniformType:k.FLOAT2},texSize:{type:u.VECTOR2,default:new ro(100,100),uniformType:k.FLOAT2}};var Js=bc;const{Vector2:Wa}=O;class $s extends he{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius,this._lastGradientRadius=this._options.gradientRadius;const t={blurQuality:{type:u.STRING}};this._horizontalFilter=new Js({},t),this._verticalFilter=new Js({},t),this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new Wa(.5,.5)),this._verticalFilter.setDelta(new Wa(-.5,.5)),this._filter=new Js({},t)}rotate(e){const{position:t}=this._options;e===90?(t.flip(),t.x=1-t.x):e===-90&&(t.flip(),t.y=1-t.y),this.set({position:t})}flip(e){const{position:t}=this._options;switch(e){case"horizontal":t.x=1-t.x;break;case"vertical":t.y=1-t.y;break}this.set({position:t})}transform(e){const t={},i=this.getPosition();t.position=e.applyToRelativePoint(i),["radius","blurRadius","gradientRadius"].forEach(r=>{const o=this.getOption(r);t[r]=e.applyToRelativeSize(o)}),this.set(t,!1)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){return this._options.highQualityCanvasBlur?this._renderBlur(e):this._renderLQCanvasBlur(e)}_renderBlur(e){const t=e.getDimensions(),i=t.min(),{position:r,blurRadius:o,radius:s,gradientRadius:n}=this._options,a={blurRadius:o*i,radius:s*i,gradientRadius:n*i,position:r.clone().multiply(t),texSize:t,blurQuality:"high"};return this._horizontalFilter.set(a),this._verticalFilter.set(a),this._renderTexture.render(this._container),W.resolve()}_renderLQCanvasBlur(e){const{blurRadius:t,radius:i,gradientRadius:r,position:o}=this._options,s=e.getDimensions();return this._filter.set({blurRadius:t,radius:i,gradientRadius:r,position:o,texSize:s,blurQuality:"low"}),this._sprite.setFilters([this._filter]),this._renderTexture.render(this._container),W.resolve()}dispose(){super.dispose(),this._filter.dispose(),this._verticalFilter.dispose(),this._horizontalFilter.dispose()}hasChanges(){return!0}}$s.identifier="radial-focus";$s.prototype.availableOptions={position:{type:u.VECTOR2,default:new Wa(.5,.5)},radius:{type:u.NUMBER,default:.25},gradientRadius:{type:u.NUMBER,default:.125},blurRadius:{type:u.NUMBER,default:.025},highQualityCanvasBlur:{type:u.BOOLEAN,default:!1}};V.Operations.RadialFocusOperation=$s;var xc=$s;var vc=`varying vec2 v_texCoord;
uniform sampler2D u_image;
uniform sampler2D u_filterImage;
uniform sampler2D u_maskImage;

void main() {
  vec4 color0 = texture2D(u_image, v_texCoord);
  vec4 color1 = texture2D(u_filterImage, v_texCoord);
  vec4 mask = texture2D(u_maskImage, v_texCoord);
  gl_FragColor = mix(color0, color1, mask);
}
`;class wc extends C.Filter{constructor(){super();this._fragmentSource=vc}_applyCanvas(e,t,i,r=!1){const o=t.getCanvas(),s=t.getContext(),n=i.getContext(),{maskCanvas:a,filterCanvas:l}=this._options,h=a.getContext("2d"),c=l.getContext("2d"),p=h.getImageData(0,0,o.width,o.height).data,d=s.getImageData(0,0,o.width,o.height),m=d.data,x=c.getImageData(0,0,o.width,o.height).data;let b;for(let g=0;g<o.width*o.height*4;g+=4)b=p[g]/255,m[g]=b*x[g]+(1-b)*m[g],m[g+1]=b*x[g+1]+(1-b)*m[g+1],m[g+2]=b*x[g+2]+(1-b)*m[g+2];n.putImageData(d,0,0)}}wc.prototype.availableOptions={maskImage:{type:u.NUMBER,default:1,uniformType:k.INT},maskCanvas:{type:u.OBJECT,default:null},filterImage:{type:u.NUMBER,default:2,uniformType:k.INT},filterCanvas:{type:u.OBJECT,default:null}};var Tc=wc;const{Vector2:en}=O;class P_ extends Q{constructor(e,t){super(t);this._isDisposed=!1,this._operation=e,this._dirtiness={},this.id=S.getUUID(),this._renderTextures={},this._identitySprite=new C.Sprite,this._sprite=new C.Sprite,this._hitTestSprite=new C.Sprite,this._renderers=[]}applyScale(e){}applyRotation(e){const t=this._operation.getInputDimensions();let i=this.getRotation()*180/Math.PI;i+=e,this.setRotation(i*Math.PI/180);const r=(e+360)%360,o=r*Math.PI/180,s=Math.cos(o),n=Math.sin(o),a=this._options.position.clone().subtract(.5).multiply(t),l=new en(a.x*s-a.y*n,a.x*n+a.y*s).divide(t.clone().flip());this.setPosition(new en(.5,.5).add(l))}applyFlip(e){const t=this.getPosition().clone();switch(e){case"horizontal":t.x=1-this._options.position.x;break;case"vertical":t.y=1-this._options.position.y;break}this.setPosition(t)}applyTransform(e){const t={};t.rotation=e.applyToRotation(this.getRotation()),t.position=e.applyToRelativePoint(this.getPosition()),this._options.dimensions&&(t.dimensions=e.applyToDimensions(this.getDimensions())),this.set(t,!1)}getDisplayObject(){return this._sprite}getHitTestDisplayObject(){return this._sprite}_getTexture(){throw new Error("Sprite#_getTexture is abstract and not implemented in child class.")}_prepareRenderTexture(e){if(this._renderTexture)this._renderTexture.clear();else{const t=this._getTexture();this._renderTextureContainer=new C.Container,this._renderTextureSprite=new C.Sprite(t),this._renderTextureContainer.addChild(this._renderTextureSprite),this._renderTexture=this._getRenderTexture(e.getRenderer(),t.getDimensions())}}_rendersToRenderTexture(e){return e.getOptions().smoothDownscaling&&e.getRenderer().isOfType(re.WEBGL)}_optionEquals(e,t){return e==="type"?!0:super._optionEquals(e,t)}update(e,t){if(this._isDisposed)return;this._rendersToRenderTexture(e)&&(this._prepareRenderTexture(e),this._renderToRenderTexture(e)),this._updateSprite(t)}_updateSprite(e){const t=[this._sprite,this._hitTestSprite];t.forEach(i=>{if(!i.getTexture())return;i.setAnchor(this._options.anchor),i.setPosition(this._options.position.clone().multiply(e)),typeof this._options.alpha!="undefined"&&i.setAlpha(this._options.alpha);let{dimensions:r}=this._options;r&&(r=r.clone().multiply(this._operation.getSDK().getTextureScale()),i.setWidth(r.x),i.setHeight(r.y)),i.updateTransform();const o=i.getTexture().getFrame(),s=new en(o.width,o.height);i.setPivot(this._options.pivot.clone().multiply(s)),i.setRotation(this._options.rotation),i.updateTransform()})}_renderToRenderTexture(e){const t=this._getTexture().getDimensions(),i=this._getRenderTexture(e.getRenderer(),t),r=t.clone();if(this._options.smoothDownscaling&&(r.x=S.nextHighestPOT(r.x),r.y=S.nextHighestPOT(r.y)),this._renderTexture.resizeTo(r),this._renderTexture.render(this._renderTextureContainer),this._options.smoothDownscaling){const o=r.clone().subtract(t.x,t.y).divide(r),s=i.getUVs().getUVs();s[0].x=s[3].x=0,s[1].x=s[2].x=1-o.x,s[0].y=s[1].y=0,s[2].y=s[3].y=1-o.y}this._sprite.setTexture(i)}isDirtyForRenderer(e){return e.id in this._dirtiness||(this._dirtiness[e.id]=!0),this._dirtiness[e.id]}setDirtyForRenderer(e,t){this._renderers[t.id]=t,this._dirtiness[t.id]=e}setDirty(e){for(const t in this._dirtiness)this.setDirtyForRenderer(e,this._renderers[t])}_getRenderTexture(e,t=new en(100,100)){return this._renderTextures[e.id]||(this._renderTextures[e.id]=new C.RenderTexture(e,t.x,t.y,1)),this._renderTextures[e.id]}dispose(){this._isDisposed=!0;for(const e in this._renderTextures)this._renderTextures[e].dispose()}canBeDuplicated(){return!0}canBeDeleted(){return!0}canMaskCanvas(){return!1}canAdjustPadding(){return!1}canBeTakenToFront(){return!0}canBeFlippedHorizontally(){return!0}}var Kt=P_;const{Vector2:B_}=O;class Li extends Q{constructor(...e){super(...e);this._lastOptions={},this._lastInputDimensions=new B_(0,0),this._brush=null}getBrushImage(e){if(this._brush&&this.optionsEqual(this._lastOptions)&&e.equals(this._lastInputDimensions))return this._brush;const{image:t,size:i}=this._options;t.width=t.height=Math.ceil(i*e.min());const r=S.createCanvas();r.width=t.width,r.height=t.height;const o=r.getContext("2d");o.drawImage(t,0,0,r.width,r.height);const s=this._tintImageData(o.getImageData(0,0,r.width,r.height),r.width,r.height);return o.putImageData(s,0,0),this._lastOptions=this.serializeOptions(["size","color"]),this._brush=r,this._lastInputDimensions=e.clone(),r}_tintImageData(e){const{color:t}=this._options;for(let i=0;i<e.data.length;i+=4)e.data[i]+=(t.r*255-e.data[i])*t.a,e.data[i+1]+=(t.g*255-e.data[i+1])*t.a,e.data[i+2]+=(t.b*255-e.data[i+2])*t.a;return e}clone(){const e=this.constructor;return new e(this._options)}}Li.prototype.availableOptions={identifier:{type:u.STRING},image:{type:u.IMAGE},size:{type:u.NUMBER,default:.05},color:{type:u.COLOR,default:E.RED}};class oo extends Li{getBrushImage(e){if(this._brush&&this.optionsEqual(this._lastOptions)&&e.equals(this._lastInputDimensions))return this._brush;let{size:t,hardness:i,color:r}=this._options;const o=S.createCanvas();o.width=o.height=Math.ceil(t*e.min());const s=o.getContext("2d");if(r=r.clone(),r.a=1,o.width===1)s.fillStyle=r.toRGBA(),s.fillRect(0,0,1,1);else{const n=s.createRadialGradient(o.width/2,o.height/2,Math.min(o.width/2-1,o.width/2*i),o.width/2,o.height/2,o.width/2);n.addColorStop(0,r.toRGBA());const a=r.clone();a.a=0,n.addColorStop(1,a.toRGBA()),s.fillStyle=n,s.fillRect(0,0,o.width,o.height)}return this._lastOptions=this.serializeOptions(["size","color","hardness"]),this._brush=o,this._lastInputDimensions=e.clone(),o}}oo.identifier="imgly_brush_radial";oo.prototype.availableOptions=S.extend(Li.prototype.availableOptions,{hardness:{type:u.NUMBER,default:1}});const{Vector2:M_,CubicBezierCurve:L_}=O;class N_{constructor(e,t,i=3){this._path=e,this._drawnCanvases=[],this._position=t,this._smooth=i}getBezierCurve(e,t,i,r){if(!t)return null;let o,s;r?(o=(r.x-t.x)/this._smooth,s=(r.y-t.y)/this._smooth):(o=(i.x-t.x)/this._smooth,s=(i.y-t.y)/this._smooth);let n,a;e?(n=(i.x-e.x)/this._smooth,a=(i.y-e.y)/this._smooth):(n=(i.x-t.x)/this._smooth,a=(i.y-t.y)/this._smooth);const l=t.clone().add(n,a),h=i.clone().subtract(o,s);return new L_(t,l,h,i)}renderToCanvas(e,t,i,r,o,s=1){if(this._drawnCanvases.indexOf(t)!==-1)return;const n=new M_(t.width,t.height),a=t.getContext("2d"),l=this._position.clone().multiply(n),h=r?r.getPosition().clone().multiply(n):null,c=i?i.getPosition().clone().multiply(n):null,p=o?o.getPosition().clone().multiply(n):null,d=l.clone().subtract(h).len(),m=e.width/10,x=this.getBezierCurve(c,h,l,p);let b;if(!x)b=[l];else{x.calculateSegments(20);const g=x.getLength();b=x.arcLengthApproxSample(Math.ceil(g/m))}for(let g=0;g<b.length;g++){const y=b[g];let _=e.width*.5/(m*2);_*=1-s,_=1/(1+_),a.globalAlpha=_,a.drawImage(e,y.x-e.width/2,y.y-e.height/2,e.width,e.height)}a.globalAlpha=1,this._drawnCanvases.push(t)}setPosition(e){this._position=e}getPosition(){return this._position.clone()}setDirty(){this._drawnCanvases=[]}}var Dc=N_;class Sc extends Q{constructor(e,t,i){super(t);this._operation=e,this._canvas=i||S.createCanvas(),this._context=this._canvas.getContext("2d")}serializeOption(e,t=!1){return e==="controlPoints"?this._options.controlPoints.map(i=>{const r=i.getPosition();return t?r.toObject():r.clone()}):super.serializeOption(e,t)}_optionEquals(e,t){if(e==="controlPoints"){const{controlPoints:i}=this._options;for(let r=0,o=i.length;r<o;r++)if(!i[r].getPosition().equals(t[r]))return!1;return!0}return super._optionEquals(e,t)}render(e){const{controlPoints:t,size:i}=this._options;if(t.length<2)return;const r=this.getBrush(),o=r&&r.getHardness?r.getHardness():1;S.ensureCanvasDimensions(this._canvas,e),(!this._brush||this._lastBrushSize!==i||!e.equals(this._brushInputDimensions))&&(this._brushInputDimensions=e.clone(),this._lastBrushSize=i);let s,n,a,l;for(let h=0;h<t.length;h++)s=t[h-2],n=t[h-1],a=t[h],l=t[h+1],a.renderToCanvas(this._options.brush.getBrushImage(e),this._canvas,s,n,l,o)}_createBrush(e){let{size:t,hardness:i,color:r}=this._options;const o=S.createCanvas();o.width=o.height=Math.ceil(t*e.min());const s=o.getContext("2d");if(r=r.clone(),r.a=1,o.width===1)s.fillStyle=r.toRGBA(),s.fillRect(0,0,1,1);else{const n=s.createRadialGradient(o.width/2,o.height/2,Math.min(o.width/2-1,o.width/2*i),o.width/2,o.height/2,o.width/2);n.addColorStop(0,r.toRGBA());const a=r.clone();a.a=0,n.addColorStop(1,a.toRGBA()),s.fillStyle=n,s.fillRect(0,0,o.width,o.height)}return o}addControlPoint(e){const t=new Dc(this,e);this._options.controlPoints.push(t),this.emit("update",this)}getCanvas(){return this._canvas}setCanvas(e){this._canvas=e,this._context=e.getContext("2d")}setDirty(){this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._options.controlPoints.forEach(e=>{e.setDirty()})}forEachControlPoint(e){this._options.controlPoints.forEach(e)}renderToCanvas(e){const t=e.getContext("2d");t.save(),t.globalAlpha=this._options.brush.getColor().a,t.drawImage(this._canvas,0,0),t.restore()}getCanvasDimensions(){return this._canvasDimensions}}Sc.prototype.availableOptions={id:{type:u.STRING,default:()=>S.getUUID()},brush:{type:u.OBJECT,required:!0},controlPoints:{type:u.ARRAY,default:[]},closed:{type:u.BOOLEAN,default:!1}};var Wo=Sc;const{Vector2:tn}=O;class so extends Kt{constructor(...e){super(...e);this._persistedPaths=[],this._outputCanvasDirty=!0,this._outputCanvas=S.createCanvas(),this._outputContext=this._outputCanvas.getContext("2d"),this._persistCanvas=S.createCanvas(),this._persistContext=this._persistCanvas.getContext("2d"),this._nextCanvas=S.createCanvas(),this._texture=C.Texture.fromCanvas(this._outputCanvas),this._sprite.setTexture(this._texture),this._onPathUpdate=this._onPathUpdate.bind(this)}applyFlip(e){this._options.paths.forEach(t=>{t.forEachControlPoint(i=>{const r=i.getPosition().clone();switch(e){case"horizontal":r.x=1-r.x;break;case"vertical":r.y=1-r.y;break}i.setPosition(r)}),t.setDirty(!0)}),this._reset()}applyRotation(e){this._options.paths.forEach(t=>{t.forEachControlPoint(i=>{const r=i.getPosition().clone();e===90?(r.flip(),r.x=1-r.x):e===-90&&(r.flip(),r.y=1-r.y),i.setPosition(r)}),t.setDirty(!0)}),this._reset()}applyTransform(e){let t=null;this._options.paths.forEach(i=>{i.forEachControlPoint(o=>{o.setPosition(e.applyToRelativePoint(o.getPosition()))});const r=i.getBrush();r!==t&&(r.setSize(e.applyToRelativeSize(r.getSize())),t=r),i.setDirty(!0)}),this._reset()}clearCanvas(){if(!this._outputCanvas)return;this._outputCanvasDirty=!0;const{width:e,height:t}=this._outputCanvas;this._outputContext.clearRect(0,0,e,t)}clearPersistCanvas(){if(!this._persistCanvas)return;const{width:e,height:t}=this._persistCanvas;this._persistContext.clearRect(0,0,e,t)}serializeOptions(e,t=!1){const i=super.serializeOptions(e,t);return e||(i.type="brush"),i}serializeOption(e,t=!1){return e==="paths"?this._options.paths.map(i=>i.serializeOptions(void 0,t)):super.serializeOption(e,t)}createPath(e){const t=new Wo(this._operation,{brush:e},this._nextCanvas);return t.on("update",this._onPathUpdate),this._options.paths.push(t),this.setDirty(!0),t}_onPathUpdate(){this._operation.setDirty(!0),this.setDirty(!0)}_onPathPersist(e){e.renderToCanvas(this._persistCanvas),this._nextCanvas=e.getCanvas();const t=this._nextCanvas.getContext("2d");t.clearRect(0,0,this._nextCanvas.width,this._nextCanvas.height),this._persistedPaths.push(e)}_getTexture(){return this._texture}setDirtyForRenderer(e,t,i=!1){super.setDirtyForRenderer(e,t,i),e&&i&&(this._persistedPaths=[],this.clearPersistCanvas(),this._options.paths.forEach(r=>{r.setDirty(!0)}))}setDirty(e,t=!1){for(const i in this._dirtiness)this.setDirtyForRenderer(e,this._renderers[i],t)}render(e){const t=this._operation.getSDK().getRenderer();if(!this.isDirtyForRenderer(t))return;S.ensureCanvasDimensions(this._outputCanvas,e),S.ensureCanvasDimensions(this._persistCanvas,e),this._options.paths.forEach(i=>{i.render(e),i.getClosed()&&this._persistedPaths.indexOf(i)===-1&&this._onPathPersist(i)}),this.clearCanvas(),this._outputContext.drawImage(this._persistCanvas,0,0),this._options.paths.forEach(i=>{i.getClosed()||i.renderToCanvas(this._outputCanvas)}),this.setDirtyForRenderer(!1,t)}update(e,t){t&&(S.ensureCanvasDimensions(this._outputCanvas,t),S.ensureCanvasDimensions(this._persistCanvas,t),this._texture.getBaseTexture().update()),this.render(t);const i=e.getRenderer();i.isOfType(re.WEBGL)&&i.updateTexture(this._texture.getBaseTexture()),super.update(e,t)}_reset(){this._persistedPaths=[],this._operation&&this._operation.setDirty(!0),this.setDirty(!0),this.clearCanvas(),this.clearPersistCanvas()}getCanvas(){return this._outputCanvas}_createRadialBrush(){return new oo}_getTempCanvas(){return this._nextCanvas}dispose(){super.dispose(),this._texture&&this._texture.getBaseTexture().dispose()}}so.prototype.availableOptions={id:{type:u.STRING,default:()=>S.getUUID()},position:{type:u.VECTOR2,default:new tn(0,0)},scale:{type:u.VECTOR2,default:new tn(1,1)},anchor:{type:u.VECTOR2,default:new tn(0,0)},pivot:{type:u.VECTOR2,default:new tn(0,0)},rotation:{type:u.NUMBER,default:0},paths:{type:u.ARRAY,default:[],setter(e){return e=e.map(t=>{if(t instanceof Wo)return t;const{brush:i,closed:r}=t,o=new Wo(this._operation,{brush:i,closed:r},this._nextCanvas);return t.controlPoints.forEach(s=>{o.addControlPoint(s)}),o}),this._reset(),e}}};so.type="brush";so.Brush=Li;so.Path=Wo;so.Brushes={RadialBrush:oo};var Ni=so;const{Vector2:Cc}=O;class rn extends he{constructor(...e){super(...e);const t=this._sdk.getRenderer();this._lastBlurRadius=null,this._blurredRenderTexture=new C.RenderTexture(t,100,100,1),this._maskRenderTexture=new C.RenderTexture(t,100,100,1),this._brushSprite=new Ni(this),this._brushSpriteContainer=new C.Container;const i=this._brushSprite.getDisplayObject();if(this._brushSpriteContainer.addChild(i),this._outputSprite=new C.Sprite,this._outputContainer=new C.Container,this._outputContainer.addChild(this._outputSprite),this._maskFilter=new Tc,t.isOfType(re.WEBGL)){this._horizontalFilter=new nt,this._verticalFilter=new nt,this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]),this._horizontalFilter.setDelta(new Cc(1,1)),this._verticalFilter.setDelta(new Cc(-1,1));let r=this._maskRenderTexture.getBaseTexture();r.setGLUnit(this._maskFilter.getMaskImage()),t.updateTexture(r,!1),r=this._blurredRenderTexture.getBaseTexture(),r.setGLUnit(this._maskFilter.getFilterImage()),t.updateTexture(r,!1)}else t.isOfType(re.CANVAS)&&(this._blurFilter=new nt,this._sprite.setFilters([this._blurFilter]),this._maskFilter.setMaskCanvas(this._maskRenderTexture.getRenderTarget().getCanvas()),this._maskFilter.setFilterCanvas(this._blurredRenderTexture.getRenderTarget().getCanvas()));this._outputSprite.setFilters([this._maskFilter])}flip(e){this._brushSprite.applyFlip(e),this.setDirty(!0,!0),this._lastBlurRadius=null}rotate(e){this._brushSprite.applyRotation(e),this.setDirty(!0,!0),this._lastBlurRadius=null}transform(e,t){this._brushSprite.applyTransform(e,t),this.setDirty(!0,!0),this._lastBlurRadius=null}_render(e){return this._renderBlur(e),this._renderMask(e),this._outputSprite.setTexture(e),this._renderTexture.render(this._outputContainer),W.resolve()}_renderMask(e){const t=e.getDimensions(),i=this._maskRenderTexture.getDimensions();i.equals(t)||this._maskRenderTexture.resizeTo(t),this._brushSprite.update(this._sdk,t),this._maskRenderTexture.clear(E.BLACK),this._maskRenderTexture.render(this._brushSpriteContainer);const r=this._sdk.getRenderer();r.isOfType(re.WEBGL)&&r.updateTexture(this._maskRenderTexture.getBaseTexture(),!1)}_renderBlur(e){const t=e.getDimensions(),i=this._blurredRenderTexture.getDimensions();i.equals(t)||this._blurredRenderTexture.resizeTo(t);const{blurRadius:r}=this._options;if(this._lastBlurRadius!==r||!i.equals(t)){const s=this._sdk.getRenderer();let n;if(s.isOfType(re.WEBGL)){const a=t.min();n={blurRadius:r*a,texSize:t},this._horizontalFilter.set(n),this._verticalFilter.set(n)}else s.isOfType(re.CANVAS)&&(n={blurRadius:r},this._blurFilter.set(n));this._blurredRenderTexture.render(this._container),this._lastBlurRadius=r}const o=this._sdk.getRenderer();o.isOfType(re.WEBGL)&&o.updateTexture(this._blurredRenderTexture.getBaseTexture(),!1)}getBrush(){return this._brushSprite}createPath(e,t=1){const i=new Ni.Brushes.RadialBrush({size:e,hardness:t,color:E.WHITE}),r=this._brushSprite.createPath(i);return this._options.paths.push(r),this.setDirty(!0),r}setDirtyForRenderer(e,t,i){super.setDirtyForRenderer(e,t,i),this._brushSprite.setDirtyForRenderer(e,t,i)}dispose(){super.dispose();const e=this._sdk.getRenderer();e.isOfType(re.WEBGL)?(this._verticalFilter.dispose(),this._horizontalFilter.dispose()):this._blurFilter.dispose(),this._brushSprite.dispose(),this._maskFilter.dispose(),this._blurredRenderTexture.dispose(),this._maskRenderTexture.dispose()}hasChanges(){return!0}}rn.identifier="selective-blur";rn.prototype.availableOptions={blurRadius:{type:u.NUMBER,default:.05},paths:{type:u.ARRAY,default:[],setter(e){return this._brushSprite&&this._brushSprite.setPaths(e),e}}};V.Operations.SelectiveBlurOperation=rn;var Ec=rn;const{Vector2:zi,ColorMatrix:on}=O;class Va extends Kt{constructor(...e){super(...e);const{image:t}=this._options,i=t.src||t.filePath||t.toDataUrl&&t.toDataURL();this._isSVG=i&&!!i.match(/\w+\.svg(?=\?|$)/i),this._isSVG&&(this._canvas=S.createCanvas(),this._context=this._canvas.getContext("2d"),this._options.smoothDownscaling=!1),t&&this._onImageUpdate(),this._tintFilter=new C.Filters.TintFilter,this._adjustmentsFilter=new Ss,this._lastRenderedDimensions=zi.NULL,this._lastRenderedInputDimensions=zi.NULL,this._onOptionsChange=this._onOptionsChange.bind(this),this._options.adjustments.on("update",this._onOptionsChange)}applyScale(e){this.setDimensions(this.getDimensions().multiply(e))}serializeOptions(e,t=!1){const i=super.serializeOptions(e,t);return e||(i.type="sticker"),i}_rendersToRenderTexture(e){const t=this._options.smoothDownscaling&&!this._isSVG&&e.getRenderer().isOfType(re.WEBGL);return t||this._hasAdjustments()||this._options.tintMode!=="none"}_getTexture(){return this._inputTexture}update(e,t){const{dimensions:i,image:r}=this._options;i.equals(zi.NULL)&&i.set(r.width,r.height),this._sprite.setSmoothDownscaling(this._isSVG?!1:this.getSmoothDownscaling());const o=!this._lastRenderedInputDimensions.equals(t)||!this._lastRenderedDimensions.equals(i)||this._lastRenderedImage!==r;if(o&&this._isSVG&&e.getRenderer().isOfType(re.WEBGL)){r.width=Math.round(i.x),r.height=Math.round(i.y);const n=4096,a=r.width/r.height;r.width>n&&(r.width=n,r.height=Math.round(r.width/a)),r.height>n&&(r.height=n,r.width=Math.round(r.height*a)),this._canvas.width=r.width,this._canvas.height=r.height,this._context.clearRect(0,0,r.width,r.height),this._context.drawImage(r,0,0,r.width,r.height),this._inputTexture.getBaseTexture().update()}this._rendersToRenderTexture(e)&&this._prepareRenderTexture(e);const s=[];if(this._rendersToRenderTexture(e)){if(this._hasAdjustments()){s.push(this._adjustmentsFilter);const{adjustments:n}=this._options,a=new on;a.multiply(on.createBrightnessMatrix(n.getBrightness())),a.multiply(on.createSaturationMatrix(n.getSaturation())),a.multiply(on.createContrastMatrix(n.getContrast())),this._adjustmentsFilter.set({colorMatrix:a})}this._options.tintMode&&this._options.tintMode!=="none"&&(s.push(this._tintFilter),this._tintFilter.set({mode:C.Filters.TintFilter.MODES[this._options.tintMode.toUpperCase()],color:this._options.tintColor}),this._sprite.getTexture()&&this._sprite.getTexture()._baseTexture&&this._sprite.getTexture()._baseTexture.setDirty(!0)),this._renderTextureSprite.setFilters(s)}this._rendersToRenderTexture(e)?this._renderToRenderTexture(e):this._sprite.setTexture(this._inputTexture),this._updateSprite(t),this._applyFlip(),this._lastRenderedDimensions.copy(i),this._lastRenderedInputDimensions.copy(t),this._lastRenderedImage=r}_applyFlip(){const e=this._sprite.getScale(),{flipHorizontally:t,flipVertically:i}=this._options;(t&&e.x>0||!t&&e.x<0)&&(e.x*=-1),(i&&e.y>0||!i&&e.y<0)&&(e.y*=-1),this._sprite.setScale(e)}applyFlip(e){super.applyFlip(e);const t={rotation:this._options.rotation},i=t.rotation/Math.PI*180,r=i*-1;t.rotation=r*Math.PI/180;switch(e){case"horizontal":t.flipHorizontally=!this._options.flipHorizontally,this.set(t);break;case"vertical":t.flipVertically=!this._options.flipVertically,this.set(t);break}}_hasAdjustments(){const{adjustments:e}=this._options;return e.getBrightness()!==0||e.getSaturation()!==1||e.getContrast()!==1}_onImageUpdate(){let e=this._options.image;const t=this._operation.getSDK().getRenderer();this._isSVG&&t.isOfType(re.WEBGL)&&(e=this._canvas),this._inputTexture&&(this._inputTexture.dispose(),this._inputTexture=null),this._inputTexture=C.Texture.fromImage(e),this._identitySprite.setTexture(this._inputTexture),this._sprite.setTexture(this._inputTexture),this._renderTexture&&(this._renderTextureSprite.setTexture(this._inputTexture),this._renderTexture.resizeTo(this._inputTexture.getDimensions())),this.setDirty(!0)}scalesUniformly(){return this._options.resizeMode==="keepAspect"}setOption(e,t,i=!0){super.setOption(e,t,i),e==="image"&&this._identitySprite&&this._onImageUpdate()}_onOptionsChange(){const e=this._dirtiness;for(const t in e)e[t]=!0}dispose(){super.dispose(),this._inputTexture&&(this._inputTexture.dispose(),this._inputTexture=null),this._tintFilter.dispose(),this._adjustmentsFilter.dispose(),this._options.adjustments.off("updated",this._onOptionsChange)}}Va.prototype.availableOptions={id:{type:u.STRING,default:()=>S.getUUID()},identifier:{type:u.STRING,default:""},image:{type:u.IMAGE,required:!0},position:{type:u.VECTOR2,default:zi.NULL},dimensions:{type:u.VECTOR2,default:zi.NULL},anchor:{type:u.VECTOR2,default:new zi(0,0)},pivot:{type:u.VECTOR2,default:new zi(.5,.5)},rotation:{type:u.NUMBER,default:0},flipHorizontally:{type:u.BOOLEAN,default:!1},flipVertically:{type:u.BOOLEAN,default:!1},smoothDownscaling:{type:u.BOOLEAN,default:!1},tintColor:{type:u.COLOR,default:E.WHITE},tintMode:{type:u.STRING,default:"none",available:["none","solid","colorized"]},resizeMode:{type:u.STRING,default:"keepAspect",available:["keepAspect","unrestricted"]},alpha:{type:u.NUMBER,default:1},adjustments:{type:u.CONFIGURABLE,structure:{brightness:{type:u.NUMBER,default:0},saturation:{type:u.NUMBER,default:1},contrast:{type:u.NUMBER,default:1}}}};Va.type="sticker";var sn=Va;class ee{constructor(e){this._seed=e===void 0?ee.TimeSeed():e}seed(e){this._seed=e===void 0?ee.TimeSeed():e}next(){let e=this._seed|0;const t=e/ee.SEED_DIVIDER|0,i=e%ee.SEED_DIVIDER|0;return e=ee.SEED_LOW_MULTIPLY*i-ee.SEED_HIGH_MULTIPLY*t,e<=0&&(e+=ee.MAX),e===-1&&(e=ee.MAX-1),this._seed=e,e}nextInRange(e,t){return t===void 0&&(t=e,e=0),e+this.next()%(t-e+1)}nextBool(e=1,t=1){return this.nextInRange(e+t-1)>=e}static TimeSeed(){return Date.now()}pickNext(e){return Array.isArray(e)?e[this.next()%e.length]:null}}ee.MAX=2147483647,ee.SEED_DIVIDER=127773,ee.SEED_LOW_MULTIPLY=16807,ee.SEED_HIGH_MULTIPLY=2836;const{Rectangle:z_}=O;class Ee{constructor(e=0,t=0){this.width=e,this.height=t}set(e,t){this.width=e,this.height=t}aspect(){return this.width/this.height}rectangle(e,t){return new z_(e,t,this.width,this.height)}clone(){return new Ee(this.width,this.height)}scale(e,t){return t===void 0&&(t=e),this.width*=e,this.height*=t,this}copy(e){return this.width=e.width,this.height=e.height,this}fitInWidthWithOther(e,t=new Ee){return this.copy(Ee.fitTwoInWidth(e,this,t)[0]),this}static fitTwoInWidth(e,t,i){const r=t.width*i.height+t.height*i.width,o=i.height*e/r,s=t.width*o,n=t.height*o;return[new Ee(s,n),new Ee(e-s,n)]}}const Rc=Ne(Ot());class kc extends Q{loadImages(e){return Ae(this,null,function*(){return Rc.default(e,t=>Ae(this,null,function*(){return this.addImage(t.path,t.fullPath,t.image)}))})}addImage(e,t,i,r="anonymous"){const o=this.getImages();return i?(o[e]={fullPath:t,image:i},Promise.resolve({fullPath:t,image:i})):new Promise((s,n)=>{i=new Ve,i.onload=()=>{o[e]={fullPath:t,image:i},s({fullPath:t,image:i})},i.crossOrigin=S.getCrossOriginValue(r),i.onerror=n,i.src=t})}getImage(e){const t=this.getImages(),i=t[e];return i?i.image:null}getVariation(e){return this.getFonts()[e]}addFont(e,t){const i=this.getFonts();return i[e]=t,t}}kc.prototype.availableOptions={images:{type:u.OBJECT,default:{}},fonts:{type:u.OBJECT,default:{}}};const me=new kc;class ht extends Q{constructor(e){super(e);const t=me.getVariation(this.getFontIdentifier());t||F.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.set({fontVariation:t}),this._metrics=null,this._canvas=S.createCanvas(),this._context=this._canvas.getContext("2d"),this._isDirty=!0}_onOptionsChange(){this._isDirty=!0}setOption(e,t,i=!0,r=!1){super.setOption(e,t,i,r),e==="fontIdentifier"&&!r&&this.updateFontVariation()}updateFontVariation(){const e=me.getVariation(this.getFontIdentifier());return e||F.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.setFontVariation(e),e}setOptions(e={}){this._options=T(T({},this._options),e),this._isDirty=!0}_applyTextOptions(e=this._context,t={}){const{fontSize:i,fontVariation:r,lineHeight:o,textColor:s,alignment:n}=T(T({},this._options),t),{fontStyle:a,fontWeight:l,fontFamily:h}=r.serializeOptions();e.font=`${a} ${l} ${i}px / ${o} ${h}`,e.fillStyle=s,e.textBaseline="alphabetic",e.textAlign=n||"left"}getTextMetrics(){return(!this._metrics||this._isDirty)&&this._calculateTextMetrics(),T({},this._metrics)}getSizeValue(){return(!this._metrics||this._isDirty)&&this._calculateTextMetrics(),new Ee(this._metrics.width,this._metrics.height)}fitWidth(e){const t=this.getFontVariation();if(!t){F.warn("TextDesignFont#fitText: missing font variation");return}this._applyTextOptions(this._context,{fontSize:50});const i=this._context.measureText(this.getText()).width,r=e/i,o=Math.floor(r*50);return this.setFontSize(o),this._calculateTextMetrics(),this.getTextMetrics()}fitHeight(e){const t=this.getFontVariation();if(!t){F.warn("TextDesignFont#fitText: missing font variation");return}const i=this._calculateTextMetrics({fontSize:50}).height,r=e/i,o=Math.floor(r*50);return this.setFontSize(o),this._calculateTextMetrics(),this.getTextMetrics()}_calculateTextMetrics(e={}){const t=this._canvas,i=this._context,r=T(T({},this._options),e),o=this.getText();this._applyTextOptions(i,r);const s=Math.ceil(i.measureText(o).width),n=Math.floor(s+r.fontSize*2),a=Math.floor(r.fontSize*3);t.width=n,t.height=a;const l=Math.floor(r.fontSize),h=Math.floor(a*(3/5));this._applyTextOptions(i,r),i.fillText(o,l,h);const c=i.getImageData(0,0,t.width,t.height).data,p=G_(c,n,a,h,this._options.excludeAccents),d=U_(c,n,a,h,this._options.excludeAccents),m=s,x=p+d;return this._metrics={width:m,height:x,ascender:p,descender:d},this._isDirty=!1,T({},this._metrics)}draw(e=this._context,t=0,i=0,r,o=!1){e.save(),(!this._metrics||this._isDirty)&&this._calculateTextMetrics(),this._applyTextOptions(e,r),e.fillText(this.getText(),t,i+this._metrics.ascender),o&&(K_(e,t,i,this._metrics.width,this._metrics.height),j_(e,i+this._metrics.ascender,t,t+this._metrics.width)),e.restore()}}const W_=(e,t,i,r)=>{const o=i*(r*4)+t*4,s={r:e[o],g:e[o+1],b:e[o+2],a:e[o+3]};return s},V_=e=>e.a<=254,Oc=(e,t,i)=>{let r=!0;for(let o=0;o<i;o++){const s=W_(e,o,t,i);if(!V_(s)){r=!1;break}}return r},U_=(e,t,i,r,o=!1)=>{let s=0;for(let n=r+1;n<i;n++)if(!Oc(e,n,t))s=n-r+1;else if(o)break;return s},G_=(e,t,i,r,o=!1)=>{let s=0;for(let n=r-1;n>=0;n--)if(!Oc(e,n,t))s=r-n;else if(o)break;return s},H_=(e,t,i,r,o)=>{e.beginPath(),e.moveTo(t,i),e.lineTo(r,o),e.stroke()},j_=(e,t,i,r,o="red")=>{e.save(),e.strokeStyle=o,H_(e,i,t,r,t),e.restore()},K_=(e,t,i,r,o,s="blue")=>{e.save(),e.strokeStyle=s,e.strokeRect(t,i,r,o),e.restore()};ht.prototype.availableOptions={text:{type:u.STRING,default:""},fontIdentifier:{type:u.STRING,default:"imgly_font_open_sans_bold"},fontVariation:{type:u.OBJECT,default:null},lineHeight:{type:u.NUMBER,default:1},fontSize:{type:u.NUMBER,default:22},textColor:{type:u.STRING,default:"black"},strokeStyle:{type:u.STRING,default:"black"},outlineWidth:{type:u.NUMBER,default:0},textBaseline:{type:u.STRING,default:"alphabetic"},excludeAccents:{type:u.BOOLEAN,default:!1}};class dt extends Q{}dt.prototype.availableOptions={text:{type:u.STRING,default:""},frame:{type:u.OBJECT,default:null},font:{type:u.OBJECT,default:null}};class Pt extends Q{}Pt.prototype.availableOptions={tintColor:{type:u.COLOR,default:E.BLACK},textColor:{type:u.COLOR,default:E.BLACK},alignment:{type:u.STRING,default:"left",available:["left","center","right"]},lineSpacing:{type:u.NUMBER,default:1},fontIdentifier:{type:u.STRING,default:"imgly_font_open_sans_bold"}};const{Rectangle:q_}=O;class yt extends Q{constructor(e){super(e);this.setSize(new Ee(this.getWidth(),0)),this.serverImageSmoothingFix=!1}_getFrame(){const e=this.getSize();return new q_(0,0,e.width,e.height)}_getTextFrame(){return this._getFrame()}_getTextFrameForElement(e){return e.getFrame().clone()}_calculateLayoutElements(){F.warn("TextDesignRow is an abstract class.")}_getLayoutElements(){return this._options.elements.length<=0&&this.layout(),this.getElements()}_fontSize(e){return F.warn("TextDesignRow#_fontSize not implemented. @TODO: Is it necessary?"),0}layout(){return this.setElements(this._calculateLayoutElements()),this}textFrame(e,t){return e.getFrame().clone()}willRender(e){}didRender(e){}render(e){e.save(),this._getLayoutElements().forEach(t=>{const{text:i,frame:r,font:o}=t.serializeOptions(),s=this.getAttributes();o.draw(e,r.x,r.y,{textColor:s.getTextColor().toRGBA(),alignment:s.getAlignment()})}),e.restore()}}yt.prototype.availableOptions={words:{type:u.OBJECT,default:null},width:{type:u.NUMBER,default:100},attributes:{type:u.CONFIGURABLE,default:new Pt},shearingAngle:{type:u.NUMBER,default:0},elements:{type:u.ARRAY,default:[]},size:{type:u.OBJECT,default:null}};const{Rectangle:Y_}=O;class bt extends yt{_calculateLayoutElements(){if(this.getWords().size()<=0)return[];const{orientation:e,width:t,size:i,relativeRowOffset:r,attributes:o}=this.serializeOptions(),{fontIdentifier:s}=o,n=this.getWords().joined(3),a=e===bt.Orientations.Left?[n[0],n[1],n[2]]:[n[1],n[2],n[0]],l=S.Array.range(0,2).map(q=>new ht({text:a[q],fontIdentifier:s,fontSize:60})),h=l.map(q=>q.getSizeValue()),c=h[0].width>h[1].width?0:1,p=(c+1)%2;l[p].fitWidth(h[c].width),h[p]=l[p].getSizeValue();const d=(h[p].height+h[c].height)/(1-r),m=new ht({text:a[2],fontIdentifier:s});m.fitHeight(d);const x=m.getSizeValue().width,b=h[c].width,g=t/(x+b),y=g*x,_=g*b,f=g*d,D=r*f;i.set(t,f);const v=S.Array.range(0,3).map(q=>new ht({text:a[q],fontIdentifier:s}));v[0].fitWidth(_),v[1].fitWidth(_),v[2].fitWidth(y);const w=e===bt.Orientations.Left?0:y,I=e===bt.Orientations.Left?_:0,P=[w,w,I],N=[0,v[0].getSizeValue().height+D,0],H=v.map((q,J)=>new Y_(P[J],N[J],q.getSizeValue().width,q.getSizeValue().height));return v.map((q,J)=>new dt({text:a[J],font:v[J],frame:H[J]}))}}bt.Orientations={Right:"RIGHT",Left:"LEFT"};bt.prototype.availableOptions=T(T({},yt.prototype.availableOptions),{orientation:{type:u.STRING,default:bt.Orientations.Left,available:[bt.Orientations.Right,bt.Orientations.Left]},relativeRowOffset:{type:u.NUMBER,default:.05}});const{Rectangle:X_}=O;class te{constructor(e=0,t=0,i=0,r=0){this.top=e,this.left=t,this.bottom=i,this.right=r}multiply(e){this.top*=e,this.left*=e,this.bottom*=e,this.right*=e}toObject(){return T({},this)}equals(e,t=0){return Math.abs(e.top-this.top)<=t&&Math.abs(e.left-this.left)<=t&&Math.abs(e.bottom-this.bottom)<=t&&Math.abs(e.right-this.right)<=t}scale(e=1,t){return t===void 0&&(t=e),this.top*=t,this.bottom*=t,this.left*=e,this.right*=e,this}clone(){return new te(this.top,this.left,this.bottom,this.right)}applyToRectangle(e){return new X_(e.x+this.left,e.y+this.top,e.width-this.left-this.right,e.height-this.top-this.bottom)}static get ZERO(){return new te(0,0,0,0)}}class Re extends yt{_calculateLayoutElements(){const{attributes:e,imageInsets:t,size:i,width:r}=this.serializeOptions(),o=this.getWords().joined(1)[0]||"",{fontIdentifier:s}=e,n=new ht({text:o,fontIdentifier:s});n.fitWidth(this._getTextFrame().width);const a=n.getTextMetrics().height+t.top+t.bottom;i.height=a;const l=this._getTextFrame(),h=new dt({text:o,frame:l,font:n});return[h]}}Re.prototype.availableOptions=T(T({},yt.prototype.availableOptions),{imageInsets:{type:u.OBJECT,default:new te}});const{Rectangle:ti,Vector2:Ze}=O,Ha=(e,t,i,r)=>{e.drawImage(t,i.x,i.y,i.width,i.height,r.x,r.y,r.width,r.height)},Ct=(e,t,i,r="source-over",o=!1)=>{e.save(),e.fillStyle=i.toRGBA(),e.globalCompositeOperation=r,e.fillRect(t.x,t.y,t.width,t.height),o&&(e.strokeStyle=i.toRGBA(),e.strokeWith=1,e.strokeRect(t.x,t.y,t.width,t.height)),e.restore()},nn=(e,t,i,r,o="source-over",s=!1)=>{e.save(),e.fillStyle=r.toRGBA(),e.globalCompositeOperation=o,i=Math.min(Math.max(i,0),Math.min(t.height,t.width)*.5);const n=t.x,a=t.x+t.width,l=t.y,h=t.y+t.height;e.beginPath(),e.moveTo(n+i,l),e.arcTo(a,l,a,h,i),e.arcTo(a,h,n,h,i),e.arcTo(n,h,n,l,i),e.arcTo(n,l,a,l,i),e.closePath(),e.fill(),s&&e.stroke(),e.restore()},no=(e,t,i,r=4)=>{e.save(),e.strokeStyle=i.toRGBA(),e.lineWidth=r,e.strokeRect(t.x,t.y,t.width,t.height),e.restore()},qa=(e,t,i,r="source-over")=>{e.save();const o=t.height/2,s=t.y+o;let n=t.x+o;const a=t.x+t.width;for(e.fillStyle=i.toRGBA(),e.globalCompositeOperation=r;n<a;)e.beginPath(),e.arc(n,s,o,0,2*Math.PI),e.fill(),n+=o*4;e.restore()},Fc=(e,t)=>{const i=t.applyToRectangle(e),{x:r,y:o,width:s,height:n}=e,a=[ti.FromDiagonalPoints(new Ze(0,0),new Ze(i.x,i.y)),ti.FromDiagonalPoints(new Ze(0,i.y+i.height),new Ze(i.x,n)),ti.FromDiagonalPoints(new Ze(i.x+i.width,i.y+i.height),new Ze(s,n)),ti.FromDiagonalPoints(new Ze(i.x+i.width,0),new Ze(s,i.y))].map(h=>h.translate(r,o)),l=[ti.FromDiagonalPoints(new Ze(i.x,0),new Ze(i.x+i.width,i.y)),ti.FromDiagonalPoints(new Ze(0,i.y),new Ze(i.x,i.y+i.height)),ti.FromDiagonalPoints(new Ze(i.x,i.y+i.height),new Ze(i.x+i.width,n)),ti.FromDiagonalPoints(new Ze(i.x+i.width,i.y),new Ze(s,i.y+i.height))].map(h=>h.translate(r,o));return{corners:a,bars:l,center:i}},Ac=(e,t,i,r)=>{const o=t.naturalWidth||t.width,s=t.naturalHeight||t.height,n=Fc(new ti(0,0,o,s),r),a=Fc(i,r);Ha(e,t,n.center,a.center),S.Array.zip(n.corners,a.corners).forEach(([l,h])=>Ha(e,t,l,h)),S.Array.zip(n.bars,a.bars).forEach(([l,h])=>Ha(e,t,l,h))},ii=(e,t,i,r,o="source-atop")=>{if(e.save(),r&&(e.globalAlpha=r.a),e.drawImage(t,i.x,i.y,i.width,i.height),r&&(e.globalAlpha=1),r){const s=r.clone();s.a=1,Ct(e,i,s,o)}e.restore()};class xi extends Re{_getTextColor(){return this.getAutoAdjustTextColor()&&!this.getIsMasked()?this.getBackgroundColor().equals(E.WHITE)?E.BLACK:E.WHITE:this.getAttributes().getTextColor().clone()}_getTextFrame(){return this.getImageInsets().applyToRectangle(this._getFrame())}_getTextFrameForElement(e){const t=super._getTextFrameForElement(e),i=this.getImageInsets();return(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&(t.y-=i.top),t}willRender(e){const t=this.getAttributes();t.setTextColor(this._getTextColor());const i=this.getImage();if(i){const r=this.getCapInsets(),o=this._getFrame();r&&!r.equals(te.ZERO)?Ac(e,i,o,r):e.drawImage(i,o.x,o.y,o.width,o.height),Ct(e,o,this.getBackgroundColor(),"source-atop",!0)}(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&i&&(e.save(),e.globalCompositeOperation="destination-out")}didRender(e){super.didRender(e),(this.getIsMasked()||this.getIsUsedInInvertedLayout())&&e.restore()}}xi.prototype.availableOptions=T(T({},Re.prototype.availableOptions),{image:{type:u.IMAGE,default:null},capInsets:{type:u.OBJECT,default:new te},backgroundColor:{type:u.COLOR,default:E.WHITE},autoAdjustTextColor:{type:u.BOOLEAN,default:!0},isMasked:{type:u.BOOLEAN,default:!0},isUsedInInvertedLayout:{type:u.BOOLEAN,default:!1}});class Bt extends Q{insetsForWidth(e){return this.getRelativeInsets().clone().scale(e)}static get Small(){return new Bt({imagePath:"text-design/images/imgly_text_design_asset_banderole_small.png",fontIdentifier:"imgly_font_campton_bold",relativeInsets:new te(.05,.2,.05,.2)})}static get Rectangle(){return new Bt({imagePath:"text-design/images/imgly_text_design_asset_black_background.png",fontIdentifier:"imgly_font_campton_bold",relativeInsets:new te(.05,.05,.05,.05),needsImageSmoothingFix:!0})}static get Celebrate1(){return new Bt({imagePath:"text-design/images/imgly_text_design_asset_celebrate_01.png",fontIdentifier:"imgly_font_rasa_500",relativeInsets:new te(.05,.2,.05,.2)})}static get Celebrate2(){return new Bt({imagePath:"text-design/images/imgly_text_design_asset_celebrate_02.png",fontIdentifier:"imgly_font_rasa_500",relativeInsets:new te(.05,.2,.05,.2)})}}Bt.prototype.availableOptions={image:{type:u.IMAGE,default:null},imagePath:{type:u.STRING,default:null},relativeInsets:{type:u.OBJECT,default:new te},fontIdentifier:{type:u.STRING,default:"imgly_font_open_sans_bold"},needsImageSmoothingFix:{type:u.BOOLEAN,default:!1}};class Ya extends Q{getSize(){const e=this.getRows(),t=this.getWidth(),i=e.length-1;let r=e.reduce((s,n)=>s+n.getSize().height,0);r+=(i+1)*this.getRelativeLineSpacing()*t;const o=this.getRelativeInsets().clone().scale(t);return r+=o.top+o.bottom,new Ee(t,r)}}Ya.prototype.availableOptions={text:{type:u.STRING,default:""},lines:{type:u.ARRAY,default:[]},relativeInsets:{type:u.OBJECT,default:new te},relativeLineSpacing:{type:u.NUMBER,default:0},rows:{type:u.OBJECT,default:[]},background:{type:u.OBJECT,default:null},width:{type:u.NUMBER,default:0}};class tt{constructor(e){this.words=[],e&&this.splitIntoWords(e)}splitIntoWords(e){return this.words=e.match(/\S+/g)||[],[...this.words]}get(){return[...this.words]}getWord(e){return this.words[e]}set(e){return this.words=[...e],this}slice(e,t){return tt.fromWords(this.words.slice(e,t))}getLowerCase(){return this.words.map(e=>e.toLowerCase())}getUpperCase(){return this.words.map(e=>e.toUpperCase())}size(){return this.words.length}countNumberOfCharacters(){return this.words.reduce((e,t)=>e+t.length,0)}joined(e){const t=this.size(),i=Math.floor(t/e),r=t%e;let o=0,s=0;return S.Array.range(0,e).map(n=>{o=s;const a=i+(n<r?1:0);return s=Math.min(o+a,t),S.Array.range(o,s).reduce((l,h)=>l+(h===o?"":" ")+this.words[h],"")})}static fromWords(e){const t=new tt;return t.words=[...e],t}}const Q_=10,Z_=4,J_=.4;class je extends Q{constructor(e){super(e);this._relativeInsets=new te,this._background=null,this._fontRandomizer=new ee(0),this._lineNumberRandomizer=new ee(0),this._wordsPerLineRandomizer=new ee(0),this._seedPool=[this._fontRandomizer,this._lineNumberRandomizer,this._wordsPerLineRandomizer]}seed(e){this._seedPool.forEach(t=>t.seed(e))}getImagePaths(){return[]}onImagesLoaded(){}getMaximumNumberOfTries(){return Q_}getMinLineCountOfRandom(){return Z_}getRandomAdditionalLinePercentage(){return J_}_fontForRow(e,t){return this._fontRandomizer.pickNext(this.getFontIdentifiers())}_modifiedText(e){return e.replace(`
`," ").replace("	"," ")}_minimumNumberOfLines(e){return Math.ceil(Math.sqrt(e.size()))}_maximumNumberOfLines(e){return e.size()}_calculatedNumberOfLines(e){let t=this._minimumNumberOfLines(e);if(e.size()>=this.getMinLineCountOfRandom()){const i=Math.floor(Math.max(1,t*this.getRandomAdditionalLinePercentage()));t+=this._lineNumberRandomizer.nextInRange(0,i)}return Math.min(t,this._maximumNumberOfLines(e))}_randomizedNumberOfWordsPerLine(e,t){if(e>t)return F.warn("TextDesign#_randomizedNumberOfWordsPerLine: Invalid number of lines"),t;const i=S.Array.repeat(1,e);return S.Array.range(e,t).forEach(r=>{const o=this._wordsPerLineRandomizer.nextInRange(0,e-1);i[o]+=1}),i}_textLines(e){const t=new tt(e),i=this._calculatedNumberOfLines(t),r=this._randomizedNumberOfWordsPerLine(i,t.size());return r.reduce((o,s)=>({index:o.index+s,lines:[...o.lines,t.slice(o.index,Math.min(o.index+s,t.size()))]}),{index:0,lines:[]}).lines}_validTextLines(e){let t=this._textLines(e),i=0;do if(i=S.Array.findIndex(t,r=>r.countNumberOfCharacters()<3),i>=0){const r=t[i-1],o=t[i+1],s=r?r.countNumberOfCharacters():Number.MAX_SAFE_INTEGER,n=o?o.countNumberOfCharacters():Number.MAX_SAFE_INTEGER;s<n&&r?(r.words=[...r.words,...t[i].words],t=[...t.slice(0,i),...t.slice(i+1)]):o&&(o.words=[...t[i].words,...o.words],t=[...t.slice(0,i),...t.slice(i+1)])}while(i>-1&&t.length>1);return t}_modifiedLines(e){return e}_getBackground(){return this._background}generateLayoutData(e,t){const i=this._modifiedText(e),r=this._modifiedLines(this._validTextLines(i)),o=t*(1-this._relativeInsets.left-this._relativeInsets.right),s=this._layoutRows(r,o);return new Ya({text:i,relativeInsets:this._relativeInsets.clone(),relativeLineSpacing:this.getRelativeLineSpacing(),background:this._background||this._getBackground(),lines:r,rows:s,width:t})}_layoutRows(e,t){return e.map((i,r)=>this._randomLayoutRow(i,r,t,new Pt({fontIdentifier:this._fontForRow(r,i)})).layout())}_randomLayoutRow(e,t,i,r){return new Re({words:e,width:i,attributes:r})}}je.defaultFontIdentifiers=[],je.identifier="textdesign";je.prototype.availableOptions={fontIdentifiers:{type:u.ARRAY,default:[]},relativeLineSpacing:{type:u.NUMBER,default:0}};class qe extends je{constructor(...e){super(...e);this.getImagePaths=()=>{const e=this.getBanderoles();return e&&e.map(t=>t.getImagePath())||[]};this.onImagesLoaded=()=>{const e=this.getBanderoles();e&&e.forEach(t=>{const i=me.getImage(t.getImagePath());if(!i){F.warn(`TextDesignBlocks#onImagesLoaded: Image not found '${t.getImagePath()}'`);return}t.setImage(i)})};this._rowTypeLessThan3WordsRandomizer=new ee(0),this._rowTypeMoreThan3WordsRandomizer=new ee(0),this._banderolesRandomizer=new ee(0),this._seedPool=[...this._seedPool,this._rowTypeLessThan3WordsRandomizer,this._rowTypeMoreThan3WordsRandomizer,this._banderolesRandomizer]}_modifiedText(e){return super._modifiedText(e).toUpperCase()}generateLayoutData(e,t){return this._options.hasMaskedText=!1,super.generateLayoutData(e,t)}_randomLayoutRow(e,t,i,r){if(e.size()<3){const s=this._rowTypeLessThan3WordsRandomizer.nextInRange(0,2)===0;return this._layoutRow(e,i,r,s)}const o=this._rowTypeMoreThan3WordsRandomizer.nextInRange(0,3);switch(o){case 0:return new bt({words:e,width:i,attributes:r,orientation:bt.Orientations.Left});case 1:return new bt({words:e,width:i,attributes:r,orientation:bt.Orientations.Right});case 2:return this._layoutRow(e,i,r,!0);case 3:return new Re({words:e,width:i,attributes:r});default:throw new Error(`TextDesignBlocks#_randomLayoutRow: Invalid randomValue generated: ${o}.`)}}_layoutRow(e,t,i,r){if(this.getHasMaskedText()&&(r=!1),r){this.setHasMaskedText(!0);const o=this._banderolesRandomizer.pickNext(this.getBanderoles()),s=new xi({words:e,width:t,attributes:new Pt({alignment:"left",fontIdentifier:o.getFontIdentifier()}),image:o.getImage(),imageInsets:o.insetsForWidth(t),capInsets:null,backgroundColor:E.WHITE});return o.getNeedsImageSmoothingFix()&&(s.serverImageSmoothingFix=!0),s}return new Re({words:e,width:t,attributes:i})}}qe.defaultFontIdentifiers=["imgly_font_campton_bold"],qe.identifier="imgly_text_design_blocks",qe.defaultBanderoles=[Bt.Rectangle,Bt.Small];qe.prototype.availableOptions=T(T({},je.prototype.availableOptions),{fontIdentifiers:{type:u.ARRAY,default:qe.defaultFontIdentifiers},relativeLineSpacing:{type:u.NUMBER,default:.025/3},hasMaskedText:{type:u.BOOLEAN,default:!1},banderoles:{type:u.ARRAY,default:qe.defaultBanderoles}});class ao extends qe{constructor(...e){super(...e);this._exclusiveFont=null}generateLayoutData(e,t){return this._exclusiveFont=this._fontRandomizer.pickNext(this.getFontIdentifiers()),super.generateLayoutData(e,t)}_fontForRow(e,t){return this._exclusiveFont||super._fontForRow(e,t)}_layoutRow(e,t,i,r){return new Re({words:e,width:t,attributes:i})}}ao.defaultFontIdentifiers=["imgly_font_ostrich_sans_heavy","imgly_font_ostrich_sans_bold","imgly_font_ostrich_sans_black"],ao.identifier="imgly_text_design_blocks_condensed";ao.prototype.availableOptions=T(T({},qe.prototype.availableOptions),{fontIdentifiers:{type:u.ARRAY,default:ao.defaultFontIdentifiers}});const{Rectangle:Vo}=O;class ze extends yt{constructor(...e){super(...e);this.setSize(new Ee(this.getWidth(),this.getHeight()))}_calculateLayoutElements(){return[new dt({frame:this._getTextFrame()})]}render(e){const t=this._getFrame(),i=this.getType(),r=this.getAttributes(),o=r.getTextColor(),s=t.height/3;let n=new Vo(t.x,t.y,t.width,s),a=new Vo(t.x,t.y+s*2,t.width,s);switch(i){case ze.FormType.Rect:Ct(e,t,o);break;case ze.FormType.DoubleRect:Ct(e,n,o),Ct(e,a,o);break;case ze.FormType.DoubleRectFirstPunctuated:qa(e,n,o),Ct(e,a,o);break;case ze.FormType.DoubleRectSecondPunctuated:Ct(e,n,o),qa(e,a,o);break;case ze.FormType.LongLine:{const l=t.height/2,h=new Vo(t.x,t.y,t.width,l);nn(e,h,h.height*.5,o);break}case ze.FormType.LongAndShortLine:{const l=t.height*.2,h=l*.75;n=new Vo(t.x,t.y+l,t.width,l);const c=t.x+t.width*.25,p=t.y+t.height-h;a=new Vo(c,p,t.width*.5,h),nn(e,n,n.height*.5,o),nn(e,a,a.height*.5,o);break}default:break}}}ze.FormType={Rect:"RECT",DoubleRect:"DOUBLE_RECT",DoubleRectFirstPunctuated:"DOUBLE_RECT_FIRST_PUNCTUATED",DoubleRectSecondPunctuated:"DOUBLE_RECT_SECOND_PUNCTUATED",LongLine:"LONG_LINE",LongAndShortLine:"LONG_AND_SHORT_LINE"};ze.prototype.availableOptions=T(T({},yt.prototype.availableOptions),{height:{type:u.NUMBER,default:100},type:{type:u.STRING,default:ze.FormType.Rect,available:S.values(ze.FormType)}});class ri extends qe{_layoutRow(e,t,i,r){return new Re({words:e,width:t,attributes:i})}_layoutRows(e,t){const i=super._layoutRows(e,t),r=.032*t,o=.08*t,s=new ze({width:t,height:r,type:ze.FormType.LongLine,shearingAngle:0}).layout(),n=new ze({width:t,height:o,type:ze.FormType.LongAndShortLine,shearingAngle:0}).layout();return[s,...i,n]}}ri.defaultFontIdentifiers=["imgly_font_sue_ellen_francisco"],ri.identifier="imgly_text_design_blocks_light";ri.prototype.availableOptions=T(T({},qe.prototype.availableOptions),{fontIdentifiers:{type:u.ARRAY,default:ri.defaultFontIdentifiers}});class lo extends ri{_layoutRows(e,t){return e.map((i,r)=>this._randomLayoutRow(i,r,t,new Pt({fontIdentifier:this._fontForRow(r,i)})).layout())}_layoutRow(e,t,i,r){return new Re({words:e,width:t,attributes:i})}}lo.defaultFontIdentifiers=["imgly_font_sue_ellen_francisco"],lo.identifier="imgly_text_design_blocks_light-v3_1_0";lo.prototype.availableOptions=T(T({},ri.prototype.availableOptions),{fontIdentifiers:{type:u.ARRAY,default:lo.defaultFontIdentifiers}});const{Rectangle:$_}=O;class Mt extends Re{getImageSize(){const e=this.getLeftImage(),t=this.getRightImage(),i=this.getWords(),r=this.getAttributes(),o=r.getFontIdentifier(),s=e?new Ee(e.width,e.height):new Ee,n=i.joined(1)[0];if(!n)return s;const a=new ht({text:n,fontIdentifier:o,fontSize:50}),l=a.getSizeValue(),h=t?2:1;s.scale(h,1);const c=s.clone().fitInWidthWithOther(this._getFrame().width,l);return c.scale(1/h,1),c}_getTextFrame(){const e=super._getTextFrame().clone(),t=this.getImageSize(),i=this.getRightImage(),r=this.getImagePosition();return i?(e.x+=t.width,e.width-=2*t.width):r===Mt.ImagePosition.Left&&(e.x+=t.width),e}_calculateLayoutElements(){const e=super._calculateLayoutElements(),t=this._getFrame(),i=this.getRightImage(),r=this.getImageSize(),o=this.getImagePosition(),s=this._getTextFrame(),n=this.getAttributes(),a=n.getFontIdentifier(),l=new ht({text:"stickerClock",fontIdentifier:a});l.fitWidth(this._getTextFrame().width);const h=new $_().set(t.x,t.y,r.width,r.height);if(!i&&o===Mt.ImagePosition.Right&&(h.x+=s.width),e.push(new dt({text:"stickerClock",frame:h,font:l})),i){const c=e[0];if(c){const p=h.clone();p.translate(c.getFrame().width+p.width,0),e.push(new dt({text:"stickerClock",frame:p,font:l}))}}return e}render(e){const t=this._getLayoutElements(),i=this.getAttributes(),r=i.getTextColor(),o=this.getLeftImage(),s=this.getRightImage(),n=t[0],a=t[1],{font:l}=n.serializeOptions(),h=this._getTextFrameForElement(n);if(l.draw(e,h.x,h.y,{textColor:i.getTextColor().toRGBA(),alignment:i.getAlignment()}),o){const c=a.getFrame();e.drawImage(o,c.x,c.y,c.width,c.height),Ct(e,c,r,"source-atop")}if(t.length>2){const c=t[2],p=c.getFrame().clone();e.drawImage(s,p.x,p.y,p.width,p.height),Ct(e,p,r,"source-atop")}}}Mt.ImagePosition={Left:"LEFT",right:"RIGHT"};Mt.prototype.availableOptions=T(T({},Re.prototype.availableOptions),{leftImage:{type:u.IMAGE,default:null},rightImage:{type:u.IMAGE,default:null},imagePosition:{type:u.STRING,default:Mt.ImagePosition.Left,available:[Mt.ImagePosition.Left,Mt.ImagePosition.Right]}});class it extends qe{_fontForRow(e,t){const i=this.getFontIdentifiers();return i[e%i.length]}_minimumNumberOfLines(e){return Math.max(Math.floor(super._minimumNumberOfLines(e)*.7),1)}_maximumNumberOfLines(e){return Math.max(Math.floor(e.countNumberOfCharacters()/5),1)}_randomLayoutRow(e,t,i,r){return this._createSingleRow(it.RowType.Single,e,i,r)}_createSingleRow(e,t,i,r){const o=r.getFontIdentifier(),s=o==="imgly_font_amberlight"||o==="imgly_font_handycheera_regular"?new tt().set(t.getLowerCase()):t;switch(e){case it.RowType.Single:return new Re({words:s,width:i,attributes:r});case it.RowType.SingleImage:return new Mt({words:s,width:i,attributes:r});default:return F.warn(`TextDesignCelebrate#_createSingleRow: Invalid row type '${e}'`),null}}}it.defaultFontIdentifiers=["imgly_font_handycheera_regular","imgly_font_rasa_regular"],it.defaultBanderoles=[Bt.Celebrate1,Bt.Celebrate2],it.identifier="imgly_text_design_celebrate",it.RowType={Single:"SINGLE",SingleImage:"SINGLE_IMAGE"};it.prototype.availableOptions=T(T({},qe.prototype.availableOptions),{relativeLineSpacing:{type:u.NUMBER,default:.01875},fontIdentifiers:{type:u.ARRAY,default:it.defaultFontIdentifiers},banderoles:{type:u.ARRAY,default:it.defaultBanderoles}});class Ke extends yt{constructor(...e){super(...e);this.setSize(new Ee(this.getWidth(),this.getHeight()))}_getImageFrame(){const e=this._getTextFrame().clone(),t=this.getImage();if(this.getDrawingModeAspectFit()&&t){const i=Math.min(e.width/t.width,e.height/t.height),r=t.width*i,o=t.height*i;e.x+=(e.width-r)/2,e.y+=(e.height-o)/2,e.width=r,e.height=o}return e}_calculateLayoutElements(){return[new dt({text:"",frame:this._getImageFrame(),font:new ht})]}render(e){const t=this.getImage(),i=this._getImageFrame(),r=this.getAttributes(),o=r.getTextColor();ii(e,t,i,o)}}Ke.RowImages={decorative1:"text-design/images/imgly_text_design_asset_decorative_01.png",decorative2:"text-design/images/imgly_text_design_asset_decorative_02.png",decorative3:"text-design/images/imgly_text_design_asset_decorative_05.png",decorative4:"text-design/images/imgly_text_design_asset_decorative_06.png",celebrate1:"text-design/images/imgly_text_design_asset_celebrate_03.png",celebrate2:"text-design/images/imgly_text_design_asset_celebrate_04.png",celebrate3:"text-design/images/imgly_text_design_asset_celebrate_05.png"};Ke.prototype.availableOptions=T(T({},yt.prototype.availableOptions),{words:{type:u.OBJECT,default:new tt},height:{type:u.NUMBER,default:0},image:{type:u.IMAGE,default:null},imagePath:{type:u.STRING,default:Ke.RowImages.decorative1},drawingModeAspectFit:{type:u.BOOLEAN,default:!1},attributes:{type:u.CONFIGURABLE,default:new Pt}});class ho extends it{constructor(...e){super(...e);this.getImagePaths=()=>{const e=this.getBanderoles();return[...e&&e.map(t=>t.getImagePath())||[],...this._celebrateTypes]};this.onImagesLoaded=()=>{const e=this.getBanderoles();e&&e.forEach(t=>{const i=me.getImage(t.getImagePath());if(!i){F.warn(`TextDesignBlocks#onImagesLoaded: Image not found '${t.getImagePath()}'`);return}t.setImage(i)})};this._celebrateTypes=[Ke.RowImages.celebrate1,Ke.RowImages.celebrate2,Ke.RowImages.celebrate3],this._exclusiveFont=null,this._typeRandomizer=new ee(0),this._useMaskedRandomizer=new ee(0),this._seedPool.push(this._typeRandomizer),this._seedPool.push(this._useMaskedRandomizer)}_fontForRow(e,t){const i=this.getFontIdentifiers();return i[e%(i.length-1)]}_layoutRows(e,t){const i=this._typeRandomizer.pickNext(this._celebrateTypes),r=me.getImage(i);r||F.warn(`TextDesignCelebrateSimple#_layoutRows: Image not fount '${i}'`);const o=new Ke({width:t,height:t*.5,drawingModeAspectFit:!0,image:r}).layout(),s=super._layoutRows(e,t);return[o,...s]}_randomLayoutRow(e,t,i,r){const o=e.countNumberOfCharacters(),s=13,n=4;o<n&&r.setFontIdentifier("imgly_font_rasa_regular");const a=this._useMaskedRandomizer.nextBool(2,1);return o<s&&a&&!this.getHasMaskedText()?this._layoutRow(e,i,r,!0):super._randomLayoutRow(e,t,i,r)}}ho.identifier="imgly_text_design_celebrate_simple",ho.defaultFontIdentifiers=["imgly_font_amberlight","imgly_font_rasa_regular","imgly_font_rasa_500"];ho.prototype.availableOptions=T(T({},it.prototype.availableOptions),{fontIdentifiers:{type:u.ARRAY,default:ho.defaultFontIdentifiers}});class uo extends Q{render(e,t,i,r,o){F.warn("TextDesignBackground#render: Abstract class")}}uo.prototype.availableOptions={};const{Rectangle:an}=O;class oi extends uo{getImagePaths(){const{topImagePath:e,bottomImagePath:t,leftImagePath:i,rightImagePath:r}=this._options;return[e,t,i,r].filter(o=>o!=="")}render(e,t,i,r,o){const s=i.clone().scale(t.width),n=t.rectangle(0,0),a=me.getImage(this.getTopImagePath()),l=me.getImage(this.getLeftImagePath()),h=me.getImage(this.getRightImagePath()),c=me.getImage(this.getBottomImagePath());if(a){const p=a.width/a.height,d=s.top*this.getTopImageFillRate(),m=d*p,x=n.width/2,b=x-m/2,g=new an(b,0,m,d);ii(e,a,g,r)}if(c){const p=c.width/c.height,d=s.bottom*this.getBottomImageFillRate(),m=d*p,x=n.width/2,b=x-m/2,g=new an(b,n.height-d,m,d);ii(e,c,g,r)}if(l){const p=l.width/l.height,d=s.left*this.getLeftImageFillRate(),m=d/p,x=n.height/2,b=x-m/2,g=new an(0,b,d,m);ii(e,l,g,r)}if(h){const p=h.width/h.height,d=s.right*this.getRightImageFillRate(),m=d/p,x=n.height/2,b=x-m/2,g=new an(n.width-d,b,d,m);ii(e,h,g,r)}}}oi.prototype.availableOptions={topImagePath:{type:u.STRING,default:""},leftImagePath:{type:u.STRING,default:""},bottomImagePath:{type:u.STRING,default:""},rightImagePath:{type:u.STRING,default:""},topImageFillRate:{type:u.NUMBER,default:1},leftImageFillRate:{type:u.NUMBER,default:1},bottomImageFillRate:{type:u.NUMBER,default:1},rightImageFillRate:{type:u.NUMBER,default:1}};oi.Backgrounds=[new oi({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_1.png",leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_2.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_2.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_3.png",topImageFillRate:.8,leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.8}),new oi({leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_1.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_1.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_2.png",leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.6}),new oi({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background3_1.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background3_2.png",topImageFillRate:.6,bottomImageFillRate:.6}),new oi({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_1.png",leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_3.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_3.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_2.png",topImageFillRate:.1,leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.6})];class si extends je{constructor(...e){super(...e);this._relativeInsets=new te(.1,.1,.1,.1),this._alreadyContainsARowWithScriptFont=!1,this._backgroundsRandomizer=new ee(0),this._seedPool.push(this._backgroundsRandomizer)}getImagePaths(){return S.Array.flatten(oi.Backgrounds.map(e=>e.getImagePaths()))}_getBackground(){return this._backgroundsRandomizer.pickNext(oi.Backgrounds)}generateLayoutData(e,t){return this._alreadyContainsARowWithScriptFont=!1,this._background=this._getBackground(),super.generateLayoutData(e,t)}_modifiedText(e){return super._modifiedText(e).toUpperCase()}_fontForRow(e,t){let i=super._fontForRow(e,t);return i==="imgly_font_petit_formal_script"&&(this._alreadyContainsARowWithScriptFont&&(i="imgly_font_bungee_inline"),this._alreadyContainsARowWithScriptFont=!0),i}_randomLayoutRow(e,t,i,r){const o=r.getFontIdentifier()==="imgly_font_petit_formal_script";return new Re({words:o?new tt().set(e.getLowerCase()):e,width:i,attributes:r})}}si.identifier="imgly_text_design_equal_width",si.defaultFontIdentifiers=["imgly_font_ultra","imgly_font_bungee_inline","imgly_font_petit_formal_script"];si.prototype.availableOptions=T(T({},je.prototype.availableOptions),{fontIdentifiers:{type:u.ARRAY,default:si.defaultFontIdentifiers},relativeLineSpacing:{type:u.NUMBER,default:.025}});class co extends si{constructor(...e){super(...e);this._relativeInsets=new te}_getBackground(){return null}}co.defaultFontIdentifiers=["imgly_font_ultra"],co.identifier="imgly_text_design_equal_width_fat";co.prototype.availableOptions=T(T({},si.prototype.availableOptions),{fontIdentifiers:{type:u.ARRAY,default:co.defaultFontIdentifiers}});class Z extends Q{insetsForWidth(e){const t=this.getRelativeInsets().clone();return t.scale(e)}}Z.prototype.availableOptions={imagePath:{type:u.STRING,default:""},minimumHeightRatio:{type:u.NUMBER,default:0},sizeToFitContent:{type:u.BOOLEAN,default:!0},capInsets:{type:u.OBJECT,default:new te},relativeInsets:{type:u.OBJECT,default:new te}};Z.Box=new Z({imagePath:"text-design/images/imgly_text_design_asset_black_background.png",relativeInsets:new te(.1,.1,.1,.1)});Z.Badge1=new Z({imagePath:"text-design/images/imgly_text_design_asset_badge1.png",relativeInsets:new te(.3,.18,.2,.18)});Z.Badge2=new Z({imagePath:"text-design/images/imgly_text_design_asset_badge2.png",relativeInsets:new te(.3,.18,.2,.18)});Z.Badge3=new Z({imagePath:"text-design/images/imgly_text_design_asset_badge3.png",relativeInsets:new te(.3,.18,.2,.18)});Z.Badge4=new Z({imagePath:"text-design/images/imgly_text_design_asset_badge4.png",relativeInsets:new te(.3,.18,.2,.18)});Z.SpeechBubble1=new Z({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble_small2.png",relativeInsets:new te(.04,.07,.12,.07),capInsets:new te(19*3,57*3,41*3,17*3)});Z.SpeechBubble2=new Z({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble3.png",relativeInsets:new te(.04,.07,.12,.07),capInsets:new te(2*3,35*3,29*3,5*3)});Z.SpeechBubble3=new Z({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble_small.png",relativeInsets:new te(.165664675,.2,.165664675,.2),minimumHeightRatio:.7});Z.SpeechBubble4=new Z({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble4.png",relativeInsets:new te(.124800224,.2,.291200523,.2),minimumHeightRatio:.7});Z.SpeechBubble5=new Z({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble5.png",relativeInsets:new te(.114892823,.27,.15984926,.27)});Z.Watercolor1=new Z({imagePath:"text-design/images/imgly_text_design_asset_watercolor_01.png",minimumHeightRatio:.7,relativeInsets:new te(.2,.25,.2,.25)});Z.Watercolor2=new Z({imagePath:"text-design/images/imgly_text_design_asset_watercolor_02.png",minimumHeightRatio:.7,relativeInsets:new te(.08,.25,.3,.25)});Z.Watercolor3=new Z({imagePath:"text-design/images/imgly_text_design_asset_watercolor_03.png",minimumHeightRatio:.7,relativeInsets:new te(.1,.2,.15,.2)});class ey{constructor(e){this._context=e,this._lastFontStyle={}}getLines(){let e=[],t=[];const i=this._lines.length;for(let r=0;r<i;r++){const o=this._lines[r],s=this._buildWords(o),n=s.length;for(let a=0;a<n;a++){const l=s[a],h=t.concat(l).join("").replace(/\s+$/i,""),c=this._getWidth(h);if(c>this._maxWidth){t.length>0&&(e.push(t.join("")),t=[l]);const p=l.replace(/\s+$/i,"");if(this._getWidth(p)>this._maxWidth){const d=this._splitWord(l);e=e.concat(d.lines),d.rest&&(t=[d.rest])}}else t.push(l)}e.push(t.join("")),t=[]}return e.map(r=>this._trimLine(r,this._context.textAlign))}_trimLine(e,t){return e}_buildWords(e){const t=[];let i="";const r=e.length;for(let o=0;o<r;o++){const s=e[o];i+=s,(s===" "||s==="-"||o===r-1)&&(t.push(i),i="")}return t}_splitWord(e){const t={lines:[],rest:null},i=e.length;let r=[];for(let o=0;o<i;o++){const s=e[o];this._getWidth(r.concat(s).join(""))>this._maxWidth?(r.length>0&&t.lines.push(r.join("")),r=[s]):r.push(s),o===i-1&&r.length>0&&(t.rest=r.join(""))}return t}_fontStyleChanged(){return this._context.font!==this._lastFontStyle?(this._lastFontStyle=this._context.font,!0):!1}_getWidth(e){return this._context.measureText(e).width}setText(e){this._text=e,this._lines=e.split(`
`)}setMaxWidth(e){this._maxWidth=e}}var ln=ey;const{Vector2:Xa}=O;class ty{constructor(e,t){this._text=e,this._operation=t,this._textOptions={},this.rotation=0,this._createCanvas(),this._createTexture()}_createCanvas(){this._canvas=S.createCanvas(),this._context=this._canvas.getContext("2d"),this._textSplitter=new ln(this._context),this._finalCanvas=S.createCanvas(),this._finalContext=this._finalCanvas.getContext("2d")}_createTexture(){this._texture=C.Texture.fromCanvas(this._canvas),this._finalTexture=C.Texture.fromCanvas(this._finalCanvas)}_applyTextOptions(e,t){t.font=`${this._text.getFontStyle()} ${this._text.getFontWeight()} ${e.fontSize}px "${this._text.getFontFamily()}"`,this._text.getTextMetrics()?t.textBaseline="alphabetic":t.textBaseline="top",t.textAlign=this._text.getAlignment(),t.fillStyle=this._text.getColor().toRGBA(),t.strokeStyle=this._text.getOutlineColor().toRGBA();const i=this._text.getOutlineWidth();i>0&&(t.lineWidth=i)}_buildOutputLines(e){return this._textSplitter.setText(this._text.getText()),this._textSplitter.setMaxWidth(e),this._textSplitter.getLines().map(t=>t.replace(/\s+$/i,""))}_renderTextLine(e,t,i){const r=this._text.getAlignment(),o=new Xa(0,t);switch(r){case"left":o.x=i;break;case"center":o.x=this._canvas.width/2;break;case"right":o.x=this._canvas.width-i;break}this._context.save(),this._context.translate(o.x,o.y),this._context.fillText(e,0,0),this._context.restore();const s=this._text.getOutlineWidth();s>0&&(this._context.miterLimit=2,this._context.strokeText(e,o.x,o.y))}update(e,t){const i=this.calculateFontStyles(e,t);if(i){const{dimensions:r,lines:o}=this._calculateText(e,i,t);this._renderText(e,r,o,i,t),this._updateFinalTexture()}}_updateFinalTexture(){const{width:e,height:t}=this._canvas,{rotation:i}=this,r=Math.cos(i),o=Math.sin(i),s=new Xa(Math.abs(e*r)+Math.abs(t*o),Math.abs(e*o)+Math.abs(t*r));this._finalCanvas.width=s.x,this._finalCanvas.height=s.y,this._finalContext.save(),this._finalContext.translate(this._finalCanvas.width/2,this._finalCanvas.height/2),this._finalContext.rotate(i),this._finalContext.drawImage(this._canvas,-e/2,-t/2),this._finalContext.restore()}_renderText(e,t,i,r,o){this._canvas.width=t.x,this._canvas.height=t.y,this._text.getMaxHeight()&&(this._canvas.height=Math.min(this._text.getMaxHeight()*o.y,this._canvas.height)),this._context=this._canvas.getContext("2d"),this._context.fillStyle=this._text.getBackgroundColor().toRGBA(),this._context.fillRect(0,0,t.x,t.y),this._applyTextOptions(r,this._context);const s=this._padding(o),n=this._text.getTextMetrics(),a=this._text.getFontSize()*o.y,l=1/n.unitsPerEm*a,h=n.ascender*l;for(let c=0;c<i.length;c++){const p=i[c];this._renderTextLine(p,r.topPadding+r.lineHeight*c+s+h,s)}}calculateFontStyles(e,t){const i=this._text.getFontFamily(),r=this._text.getFontSize()*t.y,o=this._text.getAbsoluteTextHeight(t),s=o*this._text.getLineHeight(),n=o*(this._text.getLineHeight()-1)/2,a={fontFamily:i,fontSize:r,lineHeight:s,topPadding:n};return(this._textOptions.fontFamily!==i||this._textOptions.fontSize!==r||this._textOptions.lineHeight!==s)&&(this._textOptions=a),a}_calculateText(e,t,i){const r=this._text.getMaxWidth()*i.x;this._applyTextOptions(t,this._context);const o=new Xa;let s=this._text.getText().split(`
`);typeof r!="undefined"&&(o.x=r,s=this._buildOutputLines(r));for(let l=0;l<s.length;l++){const h=s[l];o.x=Math.max(o.x,this._context.measureText(h).width)}const{lineHeight:n}=t;o.y=s.length*n;const a=this._padding(i);return o.y+=a*2,o.x+=a*2,{dimensions:o,lines:s}}_padding(e){const t=this._text.getAbsoluteTextHeight(e),i=.2;return t*i}getTexture(){return this._texture}getFinalTexture(){return this._finalTexture}getDimensions(e,t){const i=this.calculateFontStyles(e,t),{dimensions:r}=this._calculateText(e,i,t);return r}dispose(){this._measurementElement&&document.body.removeChild(this._measurementElement),this._texture&&(this._texture.dispose(),this._texture=null),this._finalTexture&&(this._finalTexture.dispose(),this._finalTexture=null)}}var Ic=ty;const{Vector2:Pc}=O;class hn extends Q{constructor(e){super(e);this._textOptions={},this._createCanvas()}_createCanvas(){this._canvas=S.createCanvas(),this._context=this._canvas.getContext("2d"),this._textSplitter=new ln(this._context),this._finalCanvas=S.createCanvas(),this._finalContext=this._finalCanvas.getContext("2d"),this.updateFontVariation()}setOption(e,t,i=!0,r=!1){super.setOption(e,t,i,r),e==="fontIdentifier"&&!r&&this.updateFontVariation()}updateFontVariation(){const e=me.getVariation(this.getFontIdentifier());return e||F.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`),this.setFontVariation(e),e}_applyTextOptions(e={},t=this._context){const{fontSize:i,fontVariation:r,lineHeight:o,textColor:s,alignment:n}=T(T({},this._options),e),{fontStyle:a,fontWeight:l,fontFamily:h}=r.serializeOptions();t.font=`${a} ${l} ${i}px "${h}"`,t.fillStyle=s,t.textBaseline="top",t.textAlign=n||"left"}_buildOutputLines(e){return this._textSplitter.setText(this.getText()),this._textSplitter.setMaxWidth(e),this._textSplitter.getLines()}_renderTextLine(e,t){const i=this.getAlignment(),r=new Pc(0,t);switch(i){case"center":r.x=this._canvas.width/2;break;case"right":r.x=this._canvas.width;break}this._context.fillText(e,r.x,r.y)}update(){const e=this.calculateFontStyles();if(e){const{dimensions:t,lines:i}=this._calculateText(e);this._dimensions=t,this._renderText(t,i,e)}}draw(e,t=0,i=0){this.update(),e.drawImage(this._canvas,t,i,this._dimensions.x,this._dimensions.y)}_renderText(e,t,i){this._canvas.width=e.x,this._canvas.height=e.y,this._context=this._canvas.getContext("2d"),this._applyTextOptions(i,this._context);for(let r=0;r<t.length;r++){const o=t[r];this._renderTextLine(o,i.topPadding+i.lineHeight*r)}}getFontFamily(){const e=this.getFontVariation();return e.getFontFamily()}calculateFontStyles(){const e=this.getFontFamily(),t=this.getFontSize(),i=this.getAbsoluteTextHeight(),r=i*this.getLineHeight(),o=i*(this.getLineHeight()-1)/2,s={fontFamily:e,fontSize:t,textHeight:i,lineHeight:r,topPadding:o};return this._textOptions=T({},s),s}getTextMetrics(){const e=this.getFontVariation();return e.getTextMetrics()}getAbsoluteTextHeight(){const e=this.getFontSize(),t=this.getTextMetrics();if(t){const i=1/t.unitsPerEm*e,r=t.ascender*i,o=t.descender*i;return r+Math.abs(o)}return e*this.getLineHeight()*1.1}_calculateText(e){this._applyTextOptions(e,this._context);const t=new Pc;let i=this.getText().split(`
`),r;if(typeof r!="undefined")t.x=r,i=this._buildOutputLines(r);else for(let s=0;s<i.length;s++){const n=i[s];t.x=Math.max(t.x,this._context.measureText(n).width)}const{lineHeight:o}=e;return t.y=i.length*o,{dimensions:t,lines:i}}getDimensions(){const e=this.calculateFontStyles(),{dimensions:t}=this._calculateText(e);return t}fitMaxHeight(){this.update();const e=this.getDimensions(),t=this.getText().split(`
`),i=this.getMaxHeight()/e.y}fitMaxWidth(){const e=this.getDimensions().x,t=this.getMaxWidth()/e;this.setFontSize(this.getFontSize()*t),this._textOptions.fontSize=this.getFontSize()}fitInFrame(e){this.setMaxWidth(e.width),this.setMaxHeight(e.height),this.fitMaxWidth(),this.fitMaxHeight()}getSize(){const e=this.getDimensions();return new Ee(e.x,e.y)}}hn.prototype.availableOptions={text:{type:u.STRING,default:""},fontIdentifier:{type:u.STRING,default:"imgly_font_open_sans_bold"},fontVariation:{type:u.OBJECT,default:null},lineHeight:{type:u.NUMBER,default:1},fontSize:{type:u.NUMBER,default:22},textColor:{type:u.STRING,default:"black"},strokeStyle:{type:u.STRING,default:"black"},outlineWidth:{type:u.NUMBER,default:0},textBaseline:{type:u.STRING,default:"alphabetic"},excludeAccents:{type:u.BOOLEAN,default:!0},maxWidth:{type:u.NUMBER,default:100},maxHeight:{type:u.NUMBER,default:0},alignment:{type:u.STRING,default:"left",available:["left","center","right"]}};class Ui extends xi{_calculateLayoutElements(){const e=this.getWords(),t=this._getTextFrame(),i=this.getAttributes(),r=i.getFontIdentifier(),o=this.getImageInsets(),s=new ht({text:e.getWord(0),fontIdentifier:r});s.fitWidth(t.width);const n=new dt({text:e.getWord(0),frame:t,font:s});n.setFrame(this._getTextFrameForElement(n));const a=this.getSize();return(this.getSizeToFitContent()||a.height<=1)&&(a.height=o.top+n.getFrame().height+o.bottom),a.height=Math.max(a.height,this.getMinimumHeight()),[n]}_getTextFrameForElement(e){const t=this.getWords(),i=t.getWord(0),r=this.getAttributes(),o=r.getFontIdentifier(),s=this.getImageInsets(),n=this.getImageInsets().applyToRectangle(this._getFrame()).scale(this.getTextScaleFactor()),a=new hn({text:i,fontIdentifier:o,alignment:r.getAlignment(),lineHeight:1});a.fitInFrame(n);const l=a.getSize();n.height=l.height;let h=l.height*this.getRowScaleFactor();this.getSizeToFitContent()&&(h+=s.top+s.bottom);const c=this._getFrame(),p=r.getAlignment();if(this.getCenteredVertically())n.y=c.height/2-h/2+s.top;else switch(p){case"left":n.y=c.height-h-s.bottom;break;case"center":n.y=c.height/2-h/2+h*this.getCenterOffset(),n.x=(c.width-n.width)/2;break;case"right":n.x=c.width-n.width-s.right;break;default:break}return n}render(e){e.save(),this._getLayoutElements().forEach(t=>{let{text:i,frame:r}=t.serializeOptions();const o=this.getAttributes(),s=o.getFontIdentifier(),n=new hn({text:i,fontIdentifier:s,alignment:o.getAlignment(),lineHeight:1,textColor:o.getTextColor().toRGBA()});r=this._getTextFrameForElement(t),n.fitInFrame(r),n.draw(e,r.x,r.y)}),e.restore()}}Ui.prototype.availableOptions=T(T({},xi.prototype.availableOptions),{centerOffset:{type:u.NUMBER,default:0},sizeToFitContent:{type:u.BOOLEAN,default:!1},textScaleFactor:{type:u.NUMBER,default:.95},rowScaleFactor:{type:u.NUMBER,default:1},minimumHeight:{type:u.NUMBER,default:0},centeredVertically:{type:u.BOOLEAN,default:!1}});class ve extends je{constructor(...e){super(...e);this._rowType=Z.Box,this._alignmentRandomizer=new ee(0),this._isMaskedRandomizer=new ee(0),this._seedPool.push(this._alignmentRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return[Z.Box.getImagePath()]}_modifiedText(e){return super._modifiedText(e).toLowerCase()}_modifiedLines(e){const t=new tt;return t.set([e.reduce((i,r)=>`${i}${i===""?"":`
`}${r.joined(1)[0]}`,"")]),[t]}_layoutRows(e,t){const i=super._layoutRows(e,t),r=i[0];if(r&&this.getSquareLayout()){const o=r.getSize();o.height=o.width}return i}getAlignment(){return this._alignmentRandomizer.pickNext(this.constructor.ValidAlignments||ve.ValidAlignments)}_randomLayoutRow(e,t,i,r){const o=this.getAlignment(),s=this._rowType,n=me.getImage(s.getImagePath());r.setAlignment(o);const a=new Ui({words:e,width:i,attributes:r,image:n,imageInsets:s.insetsForWidth(i),capInsets:s.getCapInsets(),backgroundColor:E.WHITE,centerOffset:0,textScaleFactor:.7,isMasked:this._isMaskedRandomizer.nextBool()});this._rowType===Z.Box&&(a.serverImageSmoothingFix=!0);const l=a.getSize();return this.getSquareLayout()?l.height=l.width:l.height=Math.max(l.height,l.width*s.getMinimumHeightRatio()),a}}ve.defaultFontIdentifiers=["imgly_font_galano_grotesque_bold"],ve.Alignment={Left:"left",Center:"center",Right:"right"},ve.ValidAlignments=[ve.Alignment.Left,ve.Alignment.Center,ve.Alignment.Right],ve.identifier="imgly_text_design_masked";ve.prototype.availableOptions=T(T({},je.prototype.availableOptions),{fontIdentifiers:{type:u.ARRAY,default:ve.defaultFontIdentifiers},squareLayout:{type:u.BOOLEAN,default:!0}});class Gi extends ve{constructor(...e){super(...e);this._possibleRowTypes=[Z.Badge1,Z.Badge2,Z.Badge3,Z.Badge4],this._rowTypesRandomizer=new ee(0),this._isMaskedRandomizer=new ee(0),this._seedPool.push(this._rowTypesRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return this._possibleRowTypes.map(e=>e.getImagePath())}_randomLayoutRow(e,t,i,r){this._rowType=this._rowTypesRandomizer.pickNext(this._possibleRowTypes),r.setLineSpacing(.9);const o=super._randomLayoutRow(e,t,i,r);return o.set({textScaleFactor:.9}),o}}Gi.defaultFontIdentifiers=["imgly_font_campton_bold"],Gi.identifier="imgly_text_design_masked_badge",Gi.ValidAlignments=[ve.Alignment.Center];Gi.prototype.availableOptions=T(T({},ve.prototype.availableOptions),{fontIdentifiers:{type:u.ARRAY,default:Gi.defaultFontIdentifiers}});class Et extends ve{constructor(...e){super(...e);this._possibleRowTypes=[Z.SpeechBubble1,Z.SpeechBubble3],this._rowTypesRandomizer=new ee(0),this._isMaskedRandomizer=new ee(0),this._seedPool.push(this._rowTypesRandomizer),this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return this._possibleRowTypes.map(e=>e.getImagePath())}_rowTypes(e){return this._possibleRowTypes}_randomLayoutRow(e,t,i,r){this._rowType=this._rowTypesRandomizer.pickNext(this._rowTypes(e)),r.setLineSpacing(.9);const o=super._randomLayoutRow(e,t,i,r);return o.set({textScaleFactor:1,minimumHeight:i*this._rowType.getMinimumHeightRatio(),sizeToFitContent:this._rowType.getSizeToFitContent(),centeredVertically:!0}),o}}Et.defaultFontIdentifiers=["imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_roboto_black","imgly_font_roboto_light"],Et.identifier="imgly_text_design_masked_speech_bubble";Et.prototype.availableOptions=T(T({},ve.prototype.availableOptions),{fontIdentifiers:{type:u.ARRAY,default:Et.defaultFontIdentifiers},squareLayout:{type:u.BOOLEAN,default:!1},alignment:{type:u.STRING,default:"left",available:ve.ValidAlignments}});class po extends Et{constructor(...e){super(...e);this._possibleRowTypes=[Z.SpeechBubble2,Z.SpeechBubble4,Z.SpeechBubble2,Z.SpeechBubble4,Z.SpeechBubble5],this._possibleRowTypesForMin15=this._possibleRowTypes.slice(0,2),this._possibleRowTypesForMax14=this._possibleRowTypes.slice(2)}_rowTypes(e){return e.countNumberOfCharacters()<15?this._possibleRowTypesForMax14:this._possibleRowTypesForMin15}}po.defaultFontIdentifiers=["imgly_font_permanent_marker"],po.identifier="imgly_text_design_masked_speech_bubble_comic";po.prototype.availableOptions=T(T({},Et.prototype.availableOptions),{fontIdentifiers:{type:u.ARRAY,default:po.defaultFontIdentifiers}});class mo extends ve{_modifiedText(e){return super._modifiedText(e).toUpperCase()}_randomLayoutRow(e,t,i,r){const o=this._alignmentRandomizer.pickNext(ve.ValidAlignments);return r.setAlignment(o),new Ui({words:e,width:i,attributes:r,image:null,backgroundColor:E.WHITE,centerOffset:0,sizeToFitContent:!0,isMasked:!1,autoAdjustTextColor:!1})}}mo.defaultFontIdentifiers=["imgly_font_abril_fatface_regular"],mo.identifier="imgly_text_design_multiline";mo.prototype.availableOptions=T(T({},ve.prototype.availableOptions),{fontIdentifiers:{type:u.ARRAY,default:mo.defaultFontIdentifiers}});const{Rectangle:iy}=O;class Qa extends Q{getContentFrame(){const e=this.getFrame().clone(),t=e.width*.1;return e.insetBy(t,t)}intersects(e){return this.getFrame().intersects(e.getFrame())}}Qa.prototype.availableOptions={frame:{type:u.OBJECT,default:new iy}};const{Rectangle:Bc}=O;class Wt extends uo{constructor(...e){super(...e);this._MAX_TRIES=1e3,this._PRECISION=1e3}render(e,t,i,r,o){const{imagePaths:s,relativeParticleSize:n}=this._options;if(s.length<=0)return;const a=t.width/t.height,l=new Bc(Math.round(i.left*this._PRECISION),Math.round(i.top*this._PRECISION*a),this._PRECISION,this._PRECISION);l.width-=l.x+Math.round(i.right*this._PRECISION),l.height-=l.y+Math.round(i.bottom*this._PRECISION*a);const h=[];let c=0,p=0;for(;c<this.getParticleCount()&&p<this._MAX_TRIES;){const d=n/2,m=Math.round(d*this._PRECISION),x=Math.round(d*this._PRECISION*a),b=Math.floor(this._PRECISION)-m,g=Math.floor(this._PRECISION)-x,y=o.nextInRange(m,b),_=o.nextInRange(x,g),f=new Bc(y-m,_-x,2*m,2*x);!f.intersects(l)&&!this.hasCollision(h,f)&&(h.push(new Qa({frame:f})),c+=1),p+=1}for(let d=0;d<h.length;d++){const m=h[d],x=o.pickNext(s),b=me.getImage(x),g=o.nextInRange(140,230)/255,y=t.width/this._PRECISION,_=t.height/this._PRECISION,f=m.getContentFrame();f.x*=y,f.y*=_,f.width*=y,f.height*=_;const D=r.clone();D.a=g,ii(e,b,f,D,"source-atop")}}hasCollision(e,t){for(let i=0;i<e.length;i++)if(t.intersects(e[i].getFrame()))return!0;return!1}}Wt.prototype.availableOptions=T(T({},uo.prototype.availableOptions),{particleCount:{type:u.NUMBER,default:50},relativeParticleSize:{type:u.NUMBER,default:.08},imagePaths:{type:u.ARRAY,default:[]}});class Ho extends Wt{}Ho.Images=["text-design/images/imgly_text_design_particle_brush_01.png","text-design/images/imgly_text_design_particle_brush_02.png","text-design/images/imgly_text_design_particle_brush_03.png","text-design/images/imgly_text_design_particle_brush_04.png","text-design/images/imgly_text_design_particle_brush_05.png","text-design/images/imgly_text_design_particle_brush_06.png","text-design/images/imgly_text_design_particle_brush_07.png","text-design/images/imgly_text_design_particle_brush_08.png","text-design/images/imgly_text_design_particle_brush_09.png","text-design/images/imgly_text_design_particle_brush_10.png"];Ho.prototype.availableOptions=T(T({},Wt.prototype.availableOptions),{imagePaths:{type:u.ARRAY,default:[...Ho.Images]},relativeParticleSize:{type:u.NUMBER,default:.12}});class qo extends Wt{}qo.Images=["text-design/images/imgly_text_design_particle_circle_01.png","text-design/images/imgly_text_design_particle_circle_02.png","text-design/images/imgly_text_design_particle_circle_03.png","text-design/images/imgly_text_design_particle_circle_04.png","text-design/images/imgly_text_design_particle_circle_05.png","text-design/images/imgly_text_design_particle_circle_06.png","text-design/images/imgly_text_design_particle_circle_07.png","text-design/images/imgly_text_design_particle_circle_08.png","text-design/images/imgly_text_design_particle_circle_09.png","text-design/images/imgly_text_design_particle_circle_10.png"];qo.prototype.availableOptions=T(T({},Wt.prototype.availableOptions),{imagePaths:{type:u.ARRAY,default:[...qo.Images]},relativeParticleSize:{type:u.NUMBER,default:.12}});class Yo extends Wt{}Yo.Images=["text-design/images/imgly_text_design_particle_triangle_01.png","text-design/images/imgly_text_design_particle_triangle_02.png","text-design/images/imgly_text_design_particle_triangle_03.png","text-design/images/imgly_text_design_particle_triangle_04.png","text-design/images/imgly_text_design_particle_triangle_05.png","text-design/images/imgly_text_design_particle_triangle_06.png","text-design/images/imgly_text_design_particle_triangle_07.png","text-design/images/imgly_text_design_particle_triangle_08.png","text-design/images/imgly_text_design_particle_triangle_09.png","text-design/images/imgly_text_design_particle_triangle_10.png"];Yo.prototype.availableOptions=T(T({},Wt.prototype.availableOptions),{imagePaths:{type:u.ARRAY,default:[...Yo.Images]}});class Ie extends je{constructor(...e){super(...e);this._relativeInsets=new te(0,0,0,0),this._INVALID_FONTS_IF_LESS_THEN_5_CHARS=["imgly_font_montserrat_light"],this._INVALID_FONTS_IF_LESS_THEN_4_CHARS=["imgly_font_montserrat_light","imgly_font_wolesbro"],this._lineCount=0,this._decorativeRowCreated=!1,this._useImageRowRandomizer=new ee(0),this._rowTypeRandomizer=new ee(0),this._lineDecorativeTypeRandomizer=new ee(0),this._seedPool.push(this._useImageRowRandomizer),this._seedPool.push(this._rowTypeRandomizer),this._seedPool.push(this._lineDecorativeTypeRandomizer)}getImagePaths(){return[...Ie.DecoratorImages,...Ie.RowImages]}_fontForRow(e,t){const i=t.countNumberOfCharacters();let r=this.getFontIdentifiers();return i<4?r=r.filter(o=>this._INVALID_FONTS_IF_LESS_THEN_4_CHARS.indexOf(o)<0):i<5&&(r=r.filter(o=>this._INVALID_FONTS_IF_LESS_THEN_5_CHARS.indexOf(o)<0)),r[e%r.length]}_modifiedText(e){return super._modifiedText(e).toUpperCase()}_modifiedLines(e){return this._lineCount=e.length,e}generateLayoutData(e,t){return this._decorativeRowCreated=!1,super.generateLayoutData(e,t)}_randomLayoutRow(e,t,i,r){const o=r.getFontIdentifier();let s=e;switch(o){case"imgly_font_wolesbro":s=new tt().set(e.getLowerCase());break;case"imgly_font_permanent_marker":s=new tt().set(e.getUpperCase());break;default:break}const n=this.getDecorativeRowsInTheMiddleOnly()&&(t===0||t===this._lineCount-1);if(this._useImageRowRandomizer.nextBool()||this._decorativeRowCreated||n)return new Re({words:s,width:i,attributes:r});this._decorativeRowCreated=!0;const[a,l]=this._randomDecoratorImages();return new Mt({words:e,width:i,attributes:r,leftImage:a,rightImage:l})}_layoutRows(e,t){const i=super._layoutRows(e,t);if(!this.getDecorationsVisible())return i;const r=.0625*t,o=new Ke({width:t,height:r,image:me.getImage(this._rowTypeRandomizer.pickNext(Ie.RowImages))}).layout(),s=new Ke({width:t,height:r,image:me.getImage(this._rowTypeRandomizer.pickNext(Ie.RowImages))}).layout();return[o,...i,s]}_randomDecoratorImages(){return this._lineDecorativeTypeRandomizer.nextInRange(0,1)?Ie.DecoratorImages.slice(0,2).map(e=>me.getImage(e)):Ie.DecoratorImages.slice(2).map(e=>me.getImage(e))}}Ie.defaultFontIdentifiers=["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro","imgly_font_montserrat_light"],Ie.identifier="imgly_text_design_sunshine",Ie.RowImages=[Ke.RowImages.decorative1,Ke.RowImages.decorative2,Ke.RowImages.decorative3,Ke.RowImages.decorative4],Ie.DecoratorImages=["text-design/images/imgly_text_design_asset_decorative_03.png","text-design/images/imgly_text_design_asset_decorative_04.png","text-design/images/imgly_text_design_asset_decorative_07.png","text-design/images/imgly_text_design_asset_decorative_08.png"];Ie.prototype.availableOptions=T(T({},je.prototype.availableOptions),{fontIdentifiers:{type:u.ARRAY,default:Ie.defaultFontIdentifiers},relativeLineSpacing:{type:u.NUMBER,default:.025/3*4},decorationsVisible:{type:u.BOOLEAN,default:!0},decorativeRowsInTheMiddleOnly:{type:u.BOOLEAN,default:!1}});class ut extends Ie{constructor(...e){super(...e);this._relativeInsets=new te(.3,.3,.3,.3),this._backgroundRandomizer=new ee(0),this._decoTypeRandomizer=new ee(0),this._seedPool.push(this._backgroundRandomizer),this._seedPool.push(this._decoTypeRandomizer)}getImagePaths(){return[...Ie.RowImages,...S.Array.flatten(ut.Backgrounds.map(e=>e.getImagePaths())),...ut.DecoratorImages]}_getBackground(){return this._backgroundRandomizer.pickNext(ut.Backgrounds)}_randomDecoratorImages(){switch(this._decoTypeRandomizer.nextInRange(0,2)){case 0:return ut.DecoratorImages.slice(0,2).map(e=>me.getImage(e));case 1:case 2:return ut.DecoratorImages.slice(2).map(e=>me.getImage(e));default:return F.warn("TextDesignParticles#_randomDecoratorImages: Number generated not in valid range."),ut.DecoratorImages.slice(2).map(e=>me.getImage(e))}}}ut.defaultFontIdentifiers=["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro","imgly_font_montserrat_light"],ut.identifier="imgly_text_design_particles",ut.Backgrounds=[new Ho,new qo,new Yo],ut.DecoratorImages=["text-design/images/imgly_text_design_particle_holder_01.png","text-design/images/imgly_text_design_particle_holder_02.png","text-design/images/imgly_text_design_particle_holder_03.png","text-design/images/imgly_text_design_particle_holder_04.png"];ut.prototype.availableOptions=T(T({},Ie.prototype.availableOptions),{fontIdentifiers:{type:u.ARRAY,default:ut.defaultFontIdentifiers},decorationsVisible:{type:u.BOOLEAN,default:!1},decorativeRowsInTheMiddleOnly:{type:u.BOOLEAN,default:!0}});class go extends je{constructor(...e){super(...e);this._relativeInsets=new te(.1,0,0,0),this._rowTypeRandomizer=new ee(0),this._seedPool.push(this._rowTypeRandomizer)}_modifiedText(e){return super._modifiedText(e).toUpperCase()}_randomLayoutRow(e,t,i,r){const o=super._randomLayoutRow(e,t,i,r);return o.setShearingAngle(this.getShearingAngle()),o}_layoutRows(e,t){const i=super._layoutRows(e,t),r=S.values(ze.FormType),o=30,s=new ze({width:t,height:o,type:this._rowTypeRandomizer.pickNext(r),shearingAngle:this.getShearingAngle()}).layout(),n=new ze({width:t,height:o,type:this._rowTypeRandomizer.pickNext(r),shearingAngle:this.getShearingAngle()}).layout();return[s,...i,n]}}go.defaultFontIdentifiers=["imgly_font_campton_bold"],go.identifier="imgly_text_design_rotated";go.prototype.availableOptions=T(T({},je.prototype.availableOptions),{fontIdentifiers:{type:u.ARRAY,default:go.defaultFontIdentifiers},relativeLineSpacing:{type:u.NUMBER,default:.025/3},shearingAngle:{type:u.NUMBER,default:-.1}});class Za extends Ie{constructor(...e){super(...e);this._relativeInsets=new te(0,.3,0,.3)}_layoutRows(e,t){const i=super._layoutRows(e,t);if(!this.getDecorationsVisible())return i;const r=25,o=new Ke({width:t,height:r,image:me.getImage(this._rowTypeRandomizer.pickNext(Ie.RowImages))}).layout(),s=new Ke({width:t,height:r,image:me.getImage(this._rowTypeRandomizer.pickNext(Ie.RowImages))}).layout();return[o,...i,s]}}Za.identifier="imgly_text_design_sunshine-v3_1_0";class fo extends Et{constructor(...e){super(...e);this._possibleRowTypes=[Z.Watercolor1,Z.Watercolor2,Z.Watercolor3]}}fo.defaultFontIdentifiers=["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro"],fo.identifier="imgly_text_design_watercolor";fo.prototype.availableOptions=T(T({},Et.prototype.availableOptions),{fontIdentifiers:{type:u.ARRAY,default:fo.defaultFontIdentifiers},alignment:{type:u.STRING,default:ve.Alignment.Center,available:ve.ValidAlignments}});const{Rectangle:ry}=O,dn=1e3;class Mc{constructor(){this._layoutData=null,this._layout=null,this._text="",this._seed=0,this._debugMode=!1,this.randomizer=new ee}createLayout(e,t,i){this._layout=e,this._text=t,this._seed=i,e.seed(i),this._layoutData=e.generateLayoutData(t,dn)}calculateAspect(){return this._layoutData?this._layoutData.getSize().aspect():(F.warn("TextDesignRenderer#calculateAspect: No layout data"),1)}draw(e,t,i,r){const o=this._layoutData;if(this._layoutData){const s=new Ee(dn,dn/t.aspect()),n=t.width/dn,a=o.getRelativeInsets().clone().scale(s.width),l=o.getRelativeLineSpacing()*s.width;let h=a.top;e.save(),this.randomizer.seed(this._seed);const c=o.getBackground();c&&c.render(e,t,o.getRelativeInsets(),r?E.WHITE:i,this.randomizer),e.scale(n,n),o.getRows().forEach(p=>{e.save();const d=p.getAttributes();if(e.transform(1,p.getShearingAngle(),0,1,a.left,h),d.setTextColor(r?E.WHITE:i.clone()),d.setTintColor(r?E.WHITE:i.clone()),(p instanceof xi||p instanceof Ui)&&(p.setBackgroundColor(r?E.WHITE:i.clone()),p.setIsUsedInInvertedLayout(r)),this._debugMode&&(p._debugMode=!0),p.willRender(e),p.render(e),p.didRender(e),this._debugMode){const m=p._getFrame(),x=p._getTextFrame();no(e,m,E.GREEN),no(e,x,E.BLUE),p._getLayoutElements().forEach(b=>{const g=b.getFrame(),y=p._getTextFrameForElement(b);no(e,g,new E(1,1,0)),no(e,y,new E(0,1,1))})}h+=p.getSize().height+l,e.restore()}),this._debugMode&&no(e,new ry(0,0,s.width,s.height),E.RED),e.restore()}}}const{Vector2:vi}=O;class Xo extends Kt{constructor(e,t){super(e,t);this._isDisposed=!1,this._renderer=new Mc,this._canvas=S.createCanvas(),this._context=this._canvas.getContext("2d"),this._texture=C.Texture.fromCanvas(this._canvas),this._sprite.setTexture(this._texture),this._aspect=1,this._isLayoutDirty=!0,this.getSeed()<0&&this.setSeed(ee.TimeSeed())}seed(e){this.setSeed(e||ee.TimeSeed()),this._isLayoutDirty=!0}_updateLayout(){const e=this.getLayout();return e?(this._renderer.createLayout(e,this.getText(),this.getSeed()),this._aspect=this._renderer.calculateAspect(),this._isLayoutDirty=!1,!0):null}applyTransform(e){super.applyTransform(e);const t={};this._options.dimensions&&(t.width=e.applyToRelativeSize(this.getWidth())),this.set(t,!1)}applyFlip(e){super.applyFlip(e);let{rotation:t}=this._options;switch(e){case"horizontal":t+=(Math.PI-t)*2,this.setRotation(t);break;case"vertical":t+=(Math.PI/2-t)*2,this.setRotation(t);break}}update(e,t){const i=this._isLayoutDirty;if(this._isDisposed||i&&!this._updateLayout())return;const r=this.getWidth()*t.min()/e.getTextureScale(),o=r/this._aspect,s=new vi(r,o),n=new vi(Math.round(r*2),Math.round(o*2)).clamp(new vi(1,1),new vi(Infinity,Infinity)),a=e.getRenderer(),l=a.getMaxDimensions()||Infinity;n.x>l&&(n.x=l,n.y=Math.round(n.x/this._aspect)),n.y>l&&(n.y=l,n.x=Math.round(n.y*this._aspect));const h=S.ensureCanvasDimensions(this._canvas,n);(i||h)&&(this._context.clearRect(0,0,this._canvas.width,this._canvas.height),this._renderer.draw(this._context,new Ee(n.x,n.y),this.getColor(),this.getInverted()),this.setDimensions(s),this._texture.getBaseTexture().update(),a.isOfType(re.WEBGL)&&a.updateTexture(this._texture.getBaseTexture())),super.update(e,t),this._applyFlip()}_applyFlip(){const e=this._sprite.getScale(),{flipHorizontally:t,flipVertically:i}=this._options;(t&&e.x>0||!t&&e.x<0)&&(e.x*=-1),(i&&e.y>0||!i&&e.y<0)&&(e.y*=-1),this._sprite.setScale(e)}_optionEquals(e,t){if(e==="layout"){const{layout:i}=this._options;return!i&&t||!t&&i||(!t.constructor||!i.constructor)?!1:!(i.constructor.identifier!==t.constructor.identifier)}return super._optionEquals(e,t)}serializeOptions(e,t=!1){if(e&&this.getPadding()<0){const r=e.indexOf("padding");r>-1&&e.splice(r,1)}const i=super.serializeOptions(e,t);return e||(i.type="textdesign"),i}_getTexture(){return this._texture}canBeFlippedHorizontally(){return!1}canBeDuplicated(){return!0}canMaskCanvas(){return!0}canAdjustPadding(){return!0}dispose(){this._isDisposed=!0,this._texture.dispose(),this._sprite.dispose()}}Xo.Layouts={TextDesignBlocks:qe,TextDesignBlocksCondensed:ao,TextDesignBlocksLight:ri,TextDesignCelebrate:it,TextDesignCelebrateSimple:ho,TextDesignEqualWidth:si,TextDesignEqualWidthFat:co,TextDesignMasked:ve,TextDesignMaskedBadge:Gi,TextDesignMaskedSpeechBubble:Et,TextDesignMaskedSpeechBubbleComic:po,TextDesignMultiline:mo,TextDesignWatercolor:fo,TextDesignSunshine:Ie,TextDesignParticles:ut,TextDesignRotated:go};Xo.LegacyLayouts={TextDesignBlocksLightV310:lo,TextDesignSunshineV310:Za};Xo.AssetManager=me;Xo.prototype.availableOptions={id:{type:u.STRING,default:()=>S.getUUID()},position:{type:u.VECTOR2,default:new vi(.5,.5)},dimensions:{type:u.VECTOR2,default:vi.NULL},anchor:{type:u.VECTOR2,default:new vi(0,0)},pivot:{type:u.VECTOR2,default:new vi(.5,.5)},rotation:{type:u.NUMBER,default:0},flipHorizontally:{type:u.BOOLEAN,default:!1},flipVertically:{type:u.BOOLEAN,default:!1},layout:{type:u.OBJECT,default:null,setter(e){return this._isLayoutDirty=!0,e}},text:{type:u.STRING,default:"",setter(e){return this._isLayoutDirty=!0,e}},color:{type:u.COLOR,default:E.BLACK,setter(e){return this._isLayoutDirty=!0,e}},padding:{type:u.NUMBER,default:.01,minValue:.01},width:{type:u.NUMBER,default:.8},inverted:{type:u.BOOLEAN,default:!1,setter(e){return this._isLayoutDirty=!0,e}},seed:{type:u.NUMBER,default:-1}};var un=Xo;const{Vector2:Ja}=O;class $a extends Kt{constructor(...e){super(...e);this._textRenderer=new Ic(this,this._operation),this._textRenderer.rotation=this.getRotation(),this._sprite.setTexture(this._textRenderer.getFinalTexture()),this._hitTestSprite.setTexture(this._textRenderer.getTexture())}serializeOptions(e,t=!1){const i=super.serializeOptions(e,t);return e||(i.type="text"),i}getDOMStyle(e,t){const i=this.getFontSize()*t.y;return{fontWeight:this._options.fontWeight,fontSize:`${i}px`,fontStyle:this._options.fontStyle,fontFamily:this._options.fontFamily,lineHeight:`${this.getAbsoluteTextHeight(t)*this.getLineHeight()}px`,color:this._options.color.toRGBA(),backgroundColor:this._options.backgroundColor.toRGBA(),textAlign:this._options.alignment}}getAbsoluteTextHeight(e){const t=this.getFontSize()*e.y,i=this.getTextMetrics();if(i){const r=1/i.unitsPerEm*t,o=i.ascender*r,s=i.descender*r;return o+Math.abs(s)}return t*this.getLineHeight()*1.1}getDimensions(e,t){return this._textRenderer.getDimensions(e,t)}applyFlip(e){super.applyFlip(e);let{rotation:t}=this._options;switch(e){case"horizontal":t+=(Math.PI-t)*2,this.setRotation(t);break;case"vertical":t+=(Math.PI/2-t)*2,this.setRotation(t);break}}applyTransform(e){super.applyTransform(e),this.set({fontSize:e.scaleSize(this.getFontSize(),"y"),maxWidth:e.scaleSize(this.getMaxWidth(),"x")},!1)}applyRotation(e){super.applyRotation(e);const t=(e+360)%360,i=this._operation.getInputDimensions();(t===90||t===270)&&(this.setMaxWidth(this.getMaxWidth()/i.x*i.y),this.setFontSize(this.getFontSize()/i.y*i.x))}setOption(e,t){const{flipHorizontally:i,flipVertically:r}=this._options;if(e==="rotation"){let o=t;i&&(o=Math.PI*2-o),r&&(o=Math.PI*2-o),this._options.rotation=o,this._textRenderer&&(this._textRenderer.rotation=o),this._rotation=o,this.emit("update");return}super.setOption(e,t)}getOption(e){return e==="rotation"?this._rotation:super.getOption(e)}getHitTestDisplayObject(){return this._hitTestSprite}update(e,t){if(this._sprite.setVisible(this._options.visible),!this._options.visible)return;this._textRenderer.update(e,t);const i=this._textRenderer.getFinalTexture(),r=i.getBaseTexture();r.update();const o=e.getRenderer();o.isOfType(re.WEBGL)&&o.updateTexture(i.getBaseTexture()),super.update(e,t),this._sprite.setRotation(0),this._textRenderer.getTexture().getBaseTexture().update(),this._hitTestSprite.setRotation(this._rotation),this._hitTestSprite.updateTransform(),this._applyFlip()}_applyFlip(){const e=this._sprite.getScale(),{flipHorizontally:t,flipVertically:i}=this._options;(t&&e.x>0||!t&&e.x<0)&&(e.x*=-1,this.setRotation(this._rotation)),(i&&e.y>0||!i&&e.y<0)&&(e.y*=-1,this.setRotation(this._rotation)),this._sprite.setScale(e)}_getTexture(){return this._textRenderer.getFinalTexture()}dispose(){super.dispose(),this._textRenderer.dispose(),this._hitTestSprite.dispose(),this._sprite.dispose()}canBeFlippedHorizontally(){return!1}canAdjustPadding(){return!1}}$a.prototype.availableOptions={id:{type:u.STRING,default:()=>S.getUUID()},fontSize:{type:u.NUMBER,default:.1},characterSpacing:{type:u.NUMBER,default:0},lineHeight:{type:u.NUMBER,default:1.1},fontIdentifier:{type:u.STRING},fontFamily:{type:u.STRING,default:"Times New Roman"},fontWeight:{type:u.ALL,default:"normal"},fontStyle:{type:u.STRING,default:"normal"},textMetrics:{type:u.OBJECT,default:null},outlineWidth:{type:u.NUMBER,default:0},outlineColor:{type:u.COLOR,default:E.BLACK},alignment:{type:u.STRING,default:"left",available:["left","center","right"]},verticalAlignment:{type:u.STRING,default:"top",available:["top","center","bottom"]},color:{type:u.COLOR,default:new E(1,0,0,1)},backgroundColor:{type:u.COLOR,default:E.TRANSPARENT},position:{type:u.VECTOR2,default:new Ja(.5,.5)},anchor:{type:u.VECTOR2,default:new Ja(0,0)},pivot:{type:u.VECTOR2,default:new Ja(.5,.5)},rotation:{type:u.NUMBER,default:0},text:{type:u.STRING,required:!0},maxWidth:{type:u.NUMBER,default:.5},maxHeight:{type:u.NUMBER,default:0},visible:{type:u.BOOLEAN,default:!0},flipHorizontally:{type:u.BOOLEAN,default:!1},flipVertically:{type:u.BOOLEAN,default:!1}};$a.type="text";var cn=$a;const{Vector2:el}=O;class wi extends he{constructor(...e){super(...e);this.setSmoothDownscaling(this._sdk.getOptions().smoothDownscaling),this._onSpriteUpdate=this._onSpriteUpdate.bind(this),this._maskCanvas=S.createCanvas();const t=this._options.sprites.slice();t.forEach(i=>{this.removeSprite(i),this.addSprite(i)})}getSpritesOfType(e){return this._options.sprites.filter(t=>t instanceof e)}rotate(e){this._options.sprites.forEach(t=>{t.applyRotation(e)})}flip(e){this._options.sprites.forEach(t=>{t.applyFlip(e)})}_onSpriteUpdate(e,t){this.emit("update",this),this.setDirty(!0)}_applyRotation(e,t){this._options.sprites.forEach(i=>i.applyRotation(e,t))}transform(e){this._options.sprites.forEach(t=>t.applyTransform(e))}scale(e){this._options.sprites.forEach(t=>t.applyScale(e))}serializeOption(e,t=!1){return e==="sprites"?this._options.sprites.map(i=>i.serializeOptions(void 0,t)):super.serializeOption(e,t)}createSticker(e){return new sn(this,e)}createText(e){return new cn(this,e)}createBrush(e){return new Ni(this,e)}createTextDesign(e){return new un(this,e)}addSprite(e){this._options.sprites.push(e);const t=this.getSmoothDownscaling();e.setSmoothDownscaling&&e.setSmoothDownscaling(t),this._container.addChild(e.getDisplayObject()),this.setDirty(!0),e.on("update",this._onSpriteUpdate),this.emit("update",this,this._options.sprites)}removeSprite(e){const{sprites:t}=this._options,i=t.indexOf(e);return i!==-1?(e.off("update",this._onSpriteUpdate),this._container.removeChild(e.getDisplayObject()),t.splice(i,1),this.setDirty(!0),!0):!1}_getOrientatedStageSize(){const e=this._sdk.getSprite().getTexture().getFrame(),t=this._sdk.getOperationsStack().getByIdentifier("orientation");if(t){const r=t?t.getRotation():0,o=r===270||r===90;return o?new el(e.height,e.width):new el(e.width,e.height)}const i=this._sdk.getOperationsStack().getByIdentifier("output");return i?i.getOutputResolution():new el(e.width,e.height)}_render(e){const t=this._container,{sprites:i}=this._options,r=e.getDimensions().clone().floor();let o=new C.Container;return o.addChild(this._sprite),W.all(i.map(s=>s.validateSettings())).then(()=>{i.forEach(s=>s.update(this._sdk,r))}).then(()=>{this._renderTexture.clear(),i.forEach(s=>{s.getInverted&&s.getInverted()?(this._renderTexture.render(o),this._renderTexture.render(this._renderMaskedSprite(s.getDisplayObject(),s.getColor?s.getColor():E.WHITE,s.getPadding?s.getPadding():-1)),o=new C.Container):o.addChild(s.getDisplayObject())}),this._renderTexture.render(o),t.addChild(this._sprite),i.forEach(s=>t.addChild(s.getDisplayObject()))})}_renderMaskedSprite(e,t,i){const r=this._maskCanvas,o=e.getWorldTransform(),s=this._getOrientatedStageSize();S.ensureCanvasDimensions(r,s);const n=r.getContext("2d");if(n.clearRect(0,0,r.width,r.height),n.save(),n.fillStyle=t.toRGBA(),i<0)n.fillRect(0,0,s.x,s.y);else{const h=Math.abs(e.getWidth()/e.getScale().x),c=Math.abs(e.getHeight()/e.getScale().y),p=h*i;n.transform(o.a,o.b,o.c,o.d,o.tx,o.ty),n.fillRect(-p,-p,h+p*2,c+p*2)}n.restore(),n.save(),n.globalCompositeOperation="destination-out",e._renderCanvas({getCurrentRenderTarget:()=>({getPixelRatio:()=>1}),beforeDraw:h=>{const c=e.getWidth(),p=e.getHeight(),d=e.getScale(),m=d.x<0,x=d.y<0;h.translate(c,p),h.scale(m?-1:1,x?-1:1),h.translate(-c,-p)},getContext:()=>n}),n.restore();const a=new C.Container,l=new C.Sprite(C.Texture.fromCanvas(r));return a.addChild(l),a}takeSpriteToFront(e){const{sprites:t}=this._options,i=t.indexOf(e);if(i===-1)return;S.moveArrayItem(t,i,t.length-1);const r=e.getDisplayObject();this._container.removeChild(r),this._container.addChild(r),this.setDirty(!0)}getSpritesAtPosition(e,t){const i=[];this._options.sprites.forEach(h=>h.update(this._sdk,t));const r=this._sdk.getSprite(),o=r.getWorldTransform().applyInverseToVector(e),{width:s,height:n}=r.getTexture().getFrame(),a=r.getAnchor().clone().multiply(-s,-n);o.subtract(a);const l=this._options.sprites.slice(0).reverse();for(let h=0,c=l.length;h<c;h++){const p=l[h];p.getHitTestDisplayObject().isAtPosition(o)&&i.push(p)}return i}setDirtyForRenderer(e,t,i){super.setDirtyForRenderer(e,t,i),this._options.sprites.forEach(r=>{r.setDirtyForRenderer(e,t,i)})}dispose(){super.dispose(),this._options.sprites.forEach(e=>{e.dispose()})}}wi.StickerSprite=sn;wi.TextSprite=cn;wi.BrushSprite=Ni;wi.TextDesignSprite=un;wi.identifier="sprite";wi.prototype.availableOptions={sprites:{type:u.ARRAY,default:[],setter(e,t){if(e=e.map((i,r)=>{if(i instanceof Kt)return i;const o=T({},i);delete o.type;switch(i.type){case"text":return new cn(this,o);case"sticker":return new sn(this,o);case"brush":return new Ni(this,o);case"textdesign":return new un(this,o);default:return F.error(this.constructor.name,`Invalid sprite type: ${i.type}`),null}}),!t){if(this._options.sprites){const i=this._options.sprites.slice();i.forEach(r=>{r.dispose(),this.removeSprite(r)})}e.forEach(i=>{this.addSprite(i)})}return e}},smoothDownscaling:{type:u.BOOLEAN,default:!1}};V.Operations.SpriteOperation=wi;var Lc=wi;const{Vector2:Nc}=O;class oy{constructor(e,t){this._options=t,this._oldOptions={start:e.getStart().clone(),end:e.getEnd().clone(),rotation:e.getRotation(),textureScale:e.getTextureScale()},this._inputDimensions=e.getInputDimensions(!1),this._rotationDelta=t.rotation-e.getRotation(),this._deltaCos=Math.cos(this._rotationDelta),this._deltaSin=Math.sin(this._rotationDelta),this._oldAbsoluteSize=this._oldOptions.end.clone().subtract(this._oldOptions.start).multiply(this._inputDimensions),this._newAbsoluteSize=t.end.clone().subtract(t.start).multiply(this._inputDimensions),this._absoluteStartDiff=this._oldOptions.start.clone().subtract(t.start).multiply(this._inputDimensions),this._scaleRatio=e.calculateScale(t.rotation)/e.calculateScale(),this._sizeFactor=this._newAbsoluteSize.clone().divide(this._oldAbsoluteSize),this._textureScaleFactor=this._options.textureScale/e.getTextureScale()}applyToRelativePoint(e){const t=this._oldOptions.start,i=this._oldOptions.end,r=t.clone().add(i.clone().subtract(t).divide(2)),o=r.multiply(this._inputDimensions),s=e.clone().multiply(this._oldAbsoluteSize).subtract(this._oldAbsoluteSize.clone().divide(2)),n=o.clone().add(s),a=n.clone().subtract(this._inputDimensions.clone().divide(2)),l=new Nc(a.x*this._deltaCos-a.y*this._deltaSin,a.x*this._deltaSin+a.y*this._deltaCos),h=this._inputDimensions.clone().divide(2).add(l),c=this._options.start.clone().multiply(this._inputDimensions);return h.clone().subtract(c).divide(this._newAbsoluteSize)}applyToRelativeSize(e){return e*this._oldAbsoluteSize.min()/this._newAbsoluteSize.min()}applyToDimensions(e){return e=e.clone().multiply(this._scaleRatio),this._options.textureScale&&e.multiply(this._textureScaleFactor),e}scaleSize(e,t="y"){return e/this._sizeFactor[t]}applyToRotation(e){return(e+this._rotationDelta)%(Math.PI*2)}invert(){const e=this._options.start.clone(),t=this._options.end.clone(),i=this._inputDimensions,r=-this._rotationDelta,o=Math.cos(r),s=Math.sin(r),n=this._oldAbsoluteSize,a=this._newAbsoluteSize,l=e.clone().subtract(t).multiply(i),h=1/this._scaleRatio,c=new Nc(1/this._sizeFactor.x,1/this._sizeFactor.y),p=1/this._textureScaleFactor,d=this._oldOptions;return this._oldOptions=this._options,this._options=d,this._inputDimensions=i,this._rotationDelta=r,this._deltaCos=o,this._deltaSin=s,this._oldAbsoluteSize=a,this._newAbsoluteSize=n,this._absoluteStartDiff=l,this._scaleRatio=h,this._sizeFactor=c,this._textureScaleFactor=p,this}}var zc=oy;const{Vector2:tl}=O;class Qo extends he{_render(e){this._sprite.setRotation(0);const t=e.getDimensions(),{start:i,end:r,rotation:o,textureScale:s}=this._options,n=r.clone().subtract(i),a=n.clone().divide(2),l=i.clone().add(a),h=this.calculateScale(),c=h*s,p=t.clone().multiply(c).multiply(a);return this._sprite.setAnchor(l),this._sprite.setRotation(o),this._sprite.setScale(c,c),this._sprite.setPosition(p),this._renderTexture.render(this._container),W.resolve()}calculateScale(e=this._options.rotation){const t=this.getInputDimensions(!1),i=new tl(Math.abs(t.x*Math.cos(e))+Math.abs(t.y*Math.sin(e)),Math.abs(t.x*Math.sin(e))+Math.abs(t.y*Math.cos(e))),r=t.clone().subtract(i.clone()).divide(2).abs();let o=1;return r.y>r.x?o=r.y*2/t.y+1:o=r.x*2/t.x+1,o}getNewDimensions(e){const{start:t,end:i,textureScale:r}=this._options,o=this.calculateScale(),s=e.clone().multiply(r*o).multiply(i.clone().subtract(t));return s.round()}flip(e){const{start:t,end:i}=this._options,r=t.clone();e==="horizontal"?(t.set(1-i.x,t.y),i.set(1-r.x,i.y)):e==="vertical"&&(t.set(t.x,1-i.y),i.set(i.x,1-r.y))}rotate(e){const{start:t,end:i}=this._options,r=(e+360)%360,o=Math.floor(r/90);for(let s=0;s<o;s++){const n=t.clone();t.set(1-i.y,n.x),i.set(1-n.y,i.x)}}_onBeforeExport(){this._wasEnabledBeforeExport=this.getEnabled(),this.setEnabled(!0)}_onAfterExport(){this.setEnabled(this._wasEnabledBeforeExport,!0)}}Qo.identifier="transform";Qo.prototype.availableOptions={start:{type:u.VECTOR2,default:new tl(0,0)},end:{type:u.VECTOR2,default:new tl(1,1)},textureScale:{type:u.NUMBER,default:1},rotation:{type:u.NUMBER,default:0}};Qo.TransformChange=zc;V.Operations.TransformOperation=Qo;var Uc=Qo;const{Vector2:sy}=O;class pn extends he{constructor(...e){super(...e);this._watermarkSprite=new C.Sprite,this._watermarkSprite.setAnchor(.5,.5),this._container.addChild(this._watermarkSprite)}_render(e){this._watermarkTexture||(this._watermarkTexture=C.Texture.fromImage(this._options.image),this._watermarkSprite.setTexture(this._watermarkTexture));const t=e.getDimensions(),{width:i,height:r}=this._options.image,o=S.resizeVectorToFit(new sy(i,r),t);return this._watermarkSprite.setPosition(t.clone().divide(2)),this._watermarkSprite.setWidth(o.x),this._watermarkSprite.setHeight(o.y),this._renderTexture.render(this._container),W.resolve()}dispose(){super.dispose(),this._watermarkSprite.dispose()}}pn.identifier="watermark";pn.prototype.availableOptions={image:{type:u.OBJECT,required:!0}};V.Operations.WatermarkOperation=pn;var Gc=pn;const ny=[nd,dd,ec,ic,ac,dc,pc,mc,_c,xc,Ec,Lc,Uc,Gc,gc,tc];V.AllOperations=ny;var jc=[{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}}]},{fontFamily:"Aleo",variations:[{identifier:"imgly_font_aleo_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_aleo_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:805,descender:-195}}]},{fontFamily:"Amatic SC",variations:[{identifier:"imgly_font_amaticsc",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_amaticsc.woff",textMetrics:{unitsPerEm:1e3,ascender:1016,descender:-245}}]},{fontFamily:"Archivo",variations:[{identifier:"imgly_font_archivo_black",fontWeight:"normal",filePath:"fonts/imgly_font_archivo_black.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:878,descender:-210}}]},{fontFamily:"Bungee Inline",variations:[{identifier:"imgly_font_bungee_inline",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_bungee_inline.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}}]},{fontFamily:"Campton Book",variations:[{identifier:"imgly_font_campton_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_campton_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}}]},{fontFamily:"Carter",variations:[{identifier:"imgly_font_carter_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_carter_one.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2264,descender:-890}}]},{fontFamily:"Codystar",variations:[{identifier:"imgly_font_codystar",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_codystar.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:953,descender:-255}}]},{fontFamily:"Fira Sans",variations:[{identifier:"imgly_font_fira_sans_regular",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_fira_sans_regular.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:935,descender:-265}}]},{fontFamily:"Galano Grotesque",variations:[{identifier:"imgly_font_galano_grotesque_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_galano_grotesque_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Krona One",variations:[{identifier:"imgly_font_krona_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_krona_one.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2030,descender:-530}}]},{fontFamily:"Kumar One Outline",variations:[{identifier:"imgly_font_kumar_one_outline",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_kumar_one_outline.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1137,descender:-642}}]},{fontFamily:"Lobster",variations:[{identifier:"imgly_font_lobster",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_lobster.woff",textMetrics:{unitsPerEm:1e3,ascender:1e3,descender:-250}}]},{fontFamily:"Molle",variations:[{identifier:"imgly_font_molle",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_molle.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1852,descender:-701}}]},{fontFamily:"Monoton",variations:[{identifier:"imgly_font_monoton",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_monoton.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2366,descender:-822}}]},{fontFamily:"Nixie One",variations:[{identifier:"imgly_font_nixie_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_nixie_one.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:926,descender:-210}}]},{fontFamily:"Notable",variations:[{identifier:"imgly_font_notable",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_notable.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1143,descender:-157}}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}}]},{fontFamily:"Oswald SemiBold",variations:[{identifier:"imgly_font_oswald_semi_bold",fontWeight:600,fontStyle:"normal",filePath:"fonts/imgly_font_oswald_semi_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1193,descender:-289}}]},{fontFamily:"Palanquin Dark SemiBold",variations:[{identifier:"imgly_font_palanquin_dark_semi_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_palanquin_dark_semi_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1320,descender:-491}}]},{fontFamily:"Poppins",variations:[{identifier:"imgly_font_poppins",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_poppins.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1050,descender:-350}}]},{fontFamily:"Permanent Marker",variations:[{identifier:"imgly_font_permanent_marker",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_permanent_marker.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}}]},{fontFamily:"Roboto Black",variations:[{identifier:"imgly_font_roboto_black_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_black_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Roboto Light",variations:[{identifier:"imgly_font_roboto_light_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_light_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Sancreek",variations:[{identifier:"imgly_font_sancreek",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_sancreek.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2104,descender:-738}}]},{fontFamily:"Stint Ultra Expanded",variations:[{identifier:"imgly_font_stint_ultra_expanded",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_stint_ultra_expanded.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1853,descender:-483}}]},{fontFamily:"Trashhand",variations:[{identifier:"imgly_font_trash_hand",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_trash_hand.woff",textMetrics:{unitsPerEm:1e3,ascender:759,descender:-304}}]},{fontFamily:"VT323",variations:[{identifier:"imgly_font_vt323",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_vt323.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Yeseva One",variations:[{identifier:"imgly_font_yeseva_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_yeseva_one.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:915,descender:-240}}]}];var Kc=[{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}}]},{fontFamily:"Abril Fatface",variations:[{identifier:"imgly_font_abril_fatface_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_abril_fatface_regular.woff",textMetrics:{unitsPerEm:1e3,ascender:1058,descender:-291}}]},{fontFamily:"Amberlight",variations:[{identifier:"imgly_font_amberlight",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_amberlight.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:750,descender:-250}}]},{fontFamily:"Bungee Inline",variations:[{identifier:"imgly_font_bungee_inline",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_bungee_inline.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}}]},{fontFamily:"Campton Book",variations:[{identifier:"imgly_font_campton_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_campton_bold.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}}]},{fontFamily:"Galano Grotesque",variations:[{identifier:"imgly_font_galano_grotesque_bold",fontWeight:"bold",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_galano_grotesque_bold.woff",default:!0,textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Handycheera",variations:[{identifier:"imgly_font_handycheera_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_handycheera_regular.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2199,descender:-808}}]},{fontFamily:"Montserrat Light",variations:[{identifier:"imgly_font_montserrat_light",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_montserrat_light.woff",textMetrics:{unitsPerEm:1e3,ascender:968,descender:-251}}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_heavy",fontWeight:900,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_heavy.woff",textMetrics:{unitsPerEm:1e3,ascender:674,descender:0}}]},{fontFamily:"Permanent Marker",variations:[{identifier:"imgly_font_permanent_marker",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_permanent_marker.woff",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}}]},{fontFamily:"Petit Formal Script",variations:[{identifier:"imgly_font_petit_formal_script",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_petit_formal_script.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2033,descender:-527}}]},{fontFamily:"Rasa",variations:[{identifier:"imgly_font_rasa_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_rasa_regular.woff",default:!0,textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_rasa_500",fontWeight:500,fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_rasa_500.woff",default:!0,textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}}]},{fontFamily:"Roboto Black",variations:[{identifier:"imgly_font_roboto_black",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_roboto_black.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_black_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_black_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Roboto Light",variations:[{identifier:"imgly_font_roboto_light",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_roboto_light.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_light_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Sue Ellen Francisco",variations:[{identifier:"imgly_font_sue_ellen_francisco",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_sue_ellen_francisco.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:1362,descender:-634}}]},{fontFamily:"Ultra",variations:[{identifier:"imgly_font_ultra",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_ultra.woff",default:!0,textMetrics:{unitsPerEm:2048,ascender:2066,descender:-561}}]},{fontFamily:"Wolesbro",variations:[{identifier:"imgly_font_wolesbro",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_wolesbro.woff",textMetrics:{unitsPerEm:1e3,ascender:925,descender:-575}}]}];var Wc=[{identifier:"imgly_transforms_common",defaultName:"Common Ratios",ratios:[{identifier:"imgly_transform_common_custom",defaultName:"Custom",ratio:"*",selected:!0},{identifier:"imgly_transform_common_square",defaultName:"Square",ratio:1},{identifier:"imgly_transform_common_4-3",defaultName:"4:3",ratio:4/3},{identifier:"imgly_transform_common_16-9",defaultName:"16:9",ratio:16/9}]},{identifier:"imgly_transforms_facebook",defaultName:"Facebook",ratios:[{identifier:"imgly_transform_facebook_profile",defaultName:"Profile Pic",dimensions:{x:300,y:300},forceDimensions:!1,lockDimensions:!0},{identifier:"imgly_transform_facebook_ad",defaultName:"Ad",dimensions:{x:1200,y:627}},{identifier:"imgly_transform_facebook_post",defaultName:"Post",dimensions:{x:940,y:788}},{identifier:"imgly_transform_facebook_cover",defaultName:"Cover",dimensions:{x:851,y:315}}]}];const Vc=[];typeof V.Operations.SpriteOperation!="undefined"&&Vc.push(V.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush);var Hc={TRANSFORM_RATIO_CATEGORIES:Wc,FONTS:jc,TEXT_DESIGN_FONTS:Kc,BRUSHES:Vc};const ay=T(T({},Hr),{LOAD:"load",SAVE:"save",EDITOR_RESIZE:"editor:resize",ZOOM:"editor:zoom",ZOOM_CHANGED:"editor:zoom_changed",HISTORY_REDO:"history:redo",HISTORY_BEFORE_REDO:"history:before-redo",TEXT_SCALED:"editor:text:scaled",TRANSFORM_RESIZE:"transform:resize",TRANSFORM_AFTER_EDIT:"transform:after-edit",ADDED_STICKER:"sticker:added-sticker",SPRITES_DESELECTED:"editor:sprite:deselected-all",CANVAS_FOCUS:"canvas:focus"});var qc=ay;var we={EVENTS:qc,DEFAULTS:Hc};function ly(){const{userAgent:e,appVersion:t}=navigator;return t.indexOf("MSIE")!==-1?t.match(/MSIE\s+?([0-9]+)/i)[1]:e.indexOf("Trident")!==-1?e.match(/rv:([0-9]+)/i)[1]:!1}var Yc={getIEVersion:ly};const hy=V.Utils,{Vector2:mn}=V.Math,dy={getInnerDimensionsForElement(e){const t=new mn(e.offsetWidth,e.offsetHeight),i=window.getComputedStyle(e,null);return t.x-=parseInt(i.getPropertyValue("padding-left"),10),t.x-=parseInt(i.getPropertyValue("padding-right"),10),t.y-=parseInt(i.getPropertyValue("padding-top"),10),t.y-=parseInt(i.getPropertyValue("padding-bottom"),10),t},getEventPosition(e){let t=e.clientX,i=e.clientY;if(e.type.indexOf("touch")!==-1){if(!e.touches.length)return;t=e.touches[0].clientX,i=e.touches[0].clientY}return new mn(t,i)},createTransparentPatternCanvas(){const e=document.createElement("canvas"),t=e.getContext("2d");return e.width=10,e.height=10,t.fillStyle="white",t.fillRect(0,0,e.width,e.height),t.fillStyle="#cccccc",t.fillRect(0,0,e.width/2,e.height/2),t.fillRect(e.width/2,e.height/2,e.width,e.height),e},supportsMSBlob(){const e=document.createElement("canvas");return typeof e.msToBlob!="undefined"},translate(e,t,i={}){let r=this.fetch(e,t);if(!r)return F.info("Utils#translate",`Unable to translate \`${t}\``),null;for(const o in i)r=r.replace(`\${${o}}`,i[o]);return r},fetch(e,t,i){t=t.replace(/\[(\w+)]/g,".$1"),t=t.replace(/^\./,"");const r=t.split(".");for(let o=0;o<r.length;o++){const s=r[o];if(e=e[s],!e)break}return typeof e=="undefined"?!1:e},isMobile(){const e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))},select(e,t,i=null){i||(i=o=>o);const r=[];return t.forEach(o=>{e.forEach(s=>{const n=i(s);n===o&&r.push(s)})}),r},getJSONP(e){const t=new Ft(e);return t.load()},cloneCategories(e,t){return e.map(i=>(i=hy.clone(i),i[t]=i[t].slice(0),i))},mergeCategories(e,t,i){e=this.cloneCategories(e,i);let r=null;return t.forEach(o=>{e.forEach(s=>{o.identifier===s.identifier&&(r=s)}),r?r[i]=r[i].concat(o[i]):e.push(o)}),e},wrapFiltersInCategories(e,t){return e.map(i=>{let r=i;return t in r||(r={identifier:`imgly_filters_wrapped-${i.identifier}`,displayFlat:!0,[t]:[i]}),r})},getStyleObject(e){const t=window.getComputedStyle(e),i={};for(const r in t){const o=t.getPropertyValue(r),s=r.replace(/-([a-z])/g,(n,a)=>a.toUpperCase());o!==""&&(i[s]=o)}return i},styleElement(e,t){for(const i in t)e.style[i]=t[i]},debounce(e,t,i){let r;return function(...o){const s=()=>{r=null,i||e.apply(this,o)},n=i&&!r;clearTimeout(r),r=setTimeout(s,t),n&&e.apply(this,o)}},getScrollbarWidth(){const e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);const t=e.offsetWidth;e.style.overflow="scroll";const i=document.createElement("div");i.style.width="100%",e.appendChild(i);const r=i.offsetWidth;return e.parentNode.removeChild(e),t-r},findIntegerFraction(e,t=100){let i=Number.MAX_VALUE,r=0,o=0,s=1,n=1;for(let a=0;a<t;a++){const l=s/n-e;if(l<0)s++;else if(l>0)n++;else return new mn(s,n);const h=Math.abs(s/n-e);h<i&&(i=h,r=s,o=n)}return new mn(r,o)},toFixed(e,t=2){const i=e.toFixed(t);return parseFloat(i)},capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)},flipObject(e){const t={};for(const i in e)t[e[i]]=i;return t},Browser:Yc};var rt=dy;const{Base64:gn}=V,{Color:pe}=V,{ColorMatrix:dN}=V.Math,{EventEmitter:Zo}=V,{EXIF:uN}=V,{OptionType:cN}=V,{Promise:_o}=V,le=V.Utils,{RenderType:Ti}=V,{ImageFormat:il}=V,U=V,{UniformType:pN}=V,{Vector2:se}=V.Math,{Rectangle:mN}=V.Math,{Range:gN}=V.Math,fN=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Be();class Vt{constructor(e,t,i=!1){this._ui=e,this._options=t,this._categoriesById={},this._filtersByIdentifier={identity:U.Operations.FilterOperation.Filters.IdentityFilter},this._categories=rt.wrapFiltersInCategories(Zt.DEFAULTS.FILTERS.slice(0),Vt.CATEGORY_ITEMS_PROPERTY),this._customAssetsAllowed=i||e.getEditor().getSDK()._l.areCustomAssetsAllowed(),this._customAssetsAllowed&&this._options.categories&&(this._options.categories=rt.wrapFiltersInCategories(this._options.categories,Vt.CATEGORY_ITEMS_PROPERTY)),this._initCategories()}instantiateFilterWithIdentifier(e){const t={value:this._ui._options.crossOrigin,cors:!0},i=this.getFilterByIdentifier(e);if(!i)return Promise.reject(new Error(`Unknown filter with identifier \`${e}\`!`));if(!(i.prototype instanceof U.Operations.FilterOperation.Filter)){const{lutImage:r,resolution:o,horizontalTileCount:s,verticalTileCount:n}=i;let{lightColor:a,darkColor:l}=i;if(a&&l)return a=pe.fromHex(a),l=pe.fromHex(l),Promise.resolve(new U.Operations.FilterOperation.Filters.DuoToneFilter({lightColor:a,darkColor:l}));let h;this._ui.getPreloader&&(h=this._ui.getPreloader().getAsset(r));let c;return h?c=Promise.resolve(h):c=pt.loadImage(this._ui.getAssetPath(r),t),c.then(()=>pt.loadImage(this._ui.getAssetPath(r),t).then(p=>new U.Operations.FilterOperation.Filters.ThreeDLUTFilter({image:p,resolution:o,horizontalTileCount:s,verticalTileCount:n})))}return Promise.resolve(new i)}_initCategories(){if(this._customAssetsAllowed&&this._options.categories&&(this._options.replaceCategories?this._categories=rt.wrapFiltersInCategories(this._options.categories,Vt.CATEGORY_ITEMS_PROPERTY):this._categories=rt.mergeCategories(this._categories,this._options.categories,Vt.CATEGORY_ITEMS_PROPERTY)),this._customAssetsAllowed&&this._options.availableFilters){const t=[];this._categories.forEach(i=>{const r=i.filters.filter(o=>this._options.availableFilters.indexOf(o.identifier)!==-1);r.length>0&&t.push({identifier:i.identifier,defaultName:i.defaultName,filters:r})}),this._categories=t}const e={identifier:"all",defaultName:"All",visible:!1,filters:this._categories.length<=0?[]:this._categories.map(t=>t.filters).reduce((t,i)=>t.concat(i))};this._categories.unshift(e),this._categoriesById.all=e,this._categories.forEach(t=>{this._categoriesById[t.identifier]=t}),e.filters.forEach(t=>{this._filtersByIdentifier[t.identifier]=t})}getFiltersForCategory(e){if(!this._categoriesById[e])throw new Error(`Unknown filter category '${e}'`);return this._categoriesById[e].filters}getItemsByCategory(e){return this.getFiltersForCategory(e)}getFilterByIdentifier(e){return this._filtersByIdentifier[e]}getCategories(){return this._categories}getCategoryByIdentifier(e){return this._categoriesById[e]}}Vt.CATEGORY_ITEMS_PROPERTY="filters";class fn extends Q{}fn.prototype.availableOptions={fontFamily:{type:u.STRING,required:!0},variations:{type:u.ARRAY,required:!0}};const uy={100:"Extra Light",200:"Light",300:"Book",400:"Regular",500:"Medium",600:"Semibold",700:"Bold",800:"Black",900:"Extra Black",bold:"Bold",normal:"Regular"};class yo extends Q{getLabel(){let e=uy[this._options.fontWeight];switch(this._options.fontStyle){case"italic":e+=" Italic";break}return e}}yo.prototype.availableOptions={identifier:{type:u.STRING,required:!0},fontFamily:{type:u.STRING,required:!0},fontWeight:{type:u.ALL,default:400},fontStyle:{type:u.STRING,default:"normal"},textMetrics:{type:u.OBJECT,default:null},provider:{type:u.STRING,available:["google","file"]},filePath:{type:u.STRING},default:{type:u.BOOLEAN,default:!1},font:{type:u.OBJECT}};const Di={imgly_font_bernier_regular:"imgly_font_sancreek",imgly_font_cheque_regular:"imgly_font_kumar_one_outline",imgly_font_gagalin_regular:"imgly_font_permanent_marker",imgly_font_hagin_caps_thin:"imgly_font_nixie_one",imgly_font_intro_inline:"imgly_font_bungee_inline",imgly_font_nexa_script:"imgly_font_molle",imgly_font_panton_blackitalic_caps:"imgly_font_roboto_black_italic",imgly_font_panton_lightitalic_caps:"imgly_font_roboto_light_italic",imgly_font_perfograma:"imgly_font_codystar",imgly_font_panton_black_caps:"imgly_font_roboto_black",imgly_font_panton_light_caps:"imgly_font_roboto_light",imgly_font_summer_font_light:"imgly_font_sue_ellen_francisco"},Jo=(e,t=!1)=>Di[e]?(t&&console.warn(`Font ${e} was deprecated. Please use ${Di[e]} instead.`),Di[e]):e;class ot{constructor(e,t){this._ui=e,this._options=t,this._fonts=[],this._variationsByIdentifier={},this._fontsByFontFamily={},this._initFonts()}_initFonts(){const{fonts:e,replaceFonts:t,availableVariations:i,isTextDesign:r}=this._options;let o=!0;o=this._ui.getEditor().getSDK()._l.areCustomAssetsAllowed(),e&&o&&e.forEach(({variations:a},l)=>{a&&a.forEach((h,c)=>{if(Di[h.identifier]){const p=Jo(h.identifier,!0);e[l].variations[c].identifier=p;const{fontFamily:d}=we.DEFAULTS.FONTS.find(m=>m.variations.some(x=>x.identifier===p));e[l].fontFamily=d}})});let s=r?we.DEFAULTS.TEXT_DESIGN_FONTS:we.DEFAULTS.FONTS;o&&(t?s=e:s=s.concat(e||[]));let n;s=s.map(a=>{const{fontFamily:l}=a;let{variations:h}=a;if(o&&i&&(h=h.filter(p=>i.indexOf(p.identifier)!==-1)),h.length===0)return null;const c=new fn({fontFamily:l});return h=h.map(p=>{const d=new yo(p);return d.setFontFamily(l),d.setFont(c),p.default&&!n&&(n=d),d.getTextMetrics()==null&&F.warn(`Missing font metrics for ${d.getIdentifier()}. The SDK will fall back to basic font rendering, which may lead to layout issues. Please provide font metrics for your custom fonts. See https://docs.photoeditorsdk.com/guides/html5/ for more details.`),this._variationsByIdentifier[d.getIdentifier()]=d,d}),c.setVariations(h),this._fontsByFontFamily[l]=c,c}).filter(a=>a),n||([n]=s[0].getVariations()),this._defaultVariation=n,this._fonts=s}getFonts(){return this._fonts}getFontByFontFamily(e){return this._fontsByFontFamily[e]}getVariationByIdentifier(e){return this._variationsByIdentifier[Jo(e)]}getVariationsByIdentifier(){return T({},this._variationsByIdentifier)}getDefaultVariation(){return this._defaultVariation}}class Lt{constructor(e,t={}){this._ui=e,this._options=t,this._defaultLayouts=U.Operations.SpriteOperation.TextDesignSprite.Layouts,this._legacyLayouts=U.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts,this._layouts=[],this._init()}_init(){const{availableLayouts:e}=this._options,t=T(T({},this._defaultLayouts),this._legacyLayouts);this._layouts=Object.keys(t).map(i=>({identifier:t[i].identifier,layout:t[i]})),e&&(e.push(...Object.values(this._legacyLayouts).map(i=>i.identifier)),this._layouts=this._layouts.filter(i=>e.indexOf(i.identifier)>=0))}getLayoutByIdentifier(e){const t=le.Array.find(this._layouts,i=>i.identifier===e);return t&&t.layout}getLayouts(){return[...this._layouts]}getDefaultLayout(){return this.getLayouts()[0]}}class bo{static downloadDataURL(e,t="photoeditorsdk-export"){const i=this.createBlobURLFromDataURL(e),r=this.getExtensionFromDataURL(e),o=document.createElement("a");o.download=`${t}.${r}`,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o)}static downloadMSBlob(e,t="photoeditorsdk-export"){navigator.msSaveBlob&&navigator.msSaveBlob(e,`${t}.png`)}static getExtensionFromDataURL(e){const t=e.split(",")[0].split(":")[1].split(";")[0];return t.split("/").pop()}static createBlobURLFromDataURL(e){if(!window.Blob||!window.URL||!ArrayBuffer||!Uint8Array)return e;const t=gn.decode(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),o=new Uint8Array(r);for(let n=0;n<t.length;n++)o[n]=t[n];const s=new window.Blob([r],{type:i});return window.URL.createObjectURL(s)}}class rl{constructor(e,t,i){this._sdk=e,this._options=t,this._download=i}export(){const e=this._getRenderType();return this._sdk.export(e,this._options.format,this._options.quality).then(t=>(this._download&&this._downloadData(e,t),t))}_downloadData(e,t){switch(e){case Ti.DATAURL:bo.downloadDataURL(t,this._options.fileBasename);break;case Ti.MSBLOB:bo.downloadMSBlob(t,this._options.fileBasename);break}}_getRenderType(){const e=this._options;return e.type!==Ti.IMAGE||!this._download?e.type:rt.supportsMSBlob()?Ti.MSBLOB:Ti.DATAURL}}class ol{constructor(e,t,i){this._editor=e,this._sdk=t,this._mediator=i,this._available=this._sdk.getOperations(),this._map={},this._stack=this._sdk.getOperationsStack(),this._preferredOrder=this._editor.getOptions().editor.operationsOrder,this._fixStack()}exists(e){return!!this._map[e]}add(e){const{identifier:t}=e.constructor;e.on("update",()=>{this._mediator.emit(we.EVENTS.OPERATION_UPDATED,e)});const i=this._preferredOrder.indexOf(t);if(i===-1)throw new Error(`EditorOperations#add: \`${t}\` does not appear in \`operationsOrder\``);this._stack.set(i,e),this._map[t]=e,this._mediator.emit(we.EVENTS.OPERATION_CREATED,e)}remove(e,t=!0){const i=typeof e=="object"?e.constructor.identifier:e,r=this._stack.getStack();e=this.get(i),delete this._map[i];const o=r.map(s=>s.constructor.identifier).indexOf(i);if(o!==-1){this._stack.removeAt(o);for(let s=o+1;s<r.length;s++){const n=r[s];if(!n)continue;n.setDirty(!0)}t&&this._mediator.emit(we.EVENTS.OPERATION_REMOVED,e)}}get(e){return this._map[e]}getOrCreate(e,t={}){if(this._map[e]){const o=this._map[e];return o.set(t,!1),o}const i=this._available[e],r=new i(this._sdk,t);return this.add(r),r}getStack(){return this._stack}reset(){this._map={}}_fixStack(){const e=this._stack.getStack().slice();this._stack.clear(),e.forEach(t=>{this.add(t)})}}class sl{constructor(e,t,i){this._image=e,this._maxPixels=t,this._maxDimensions=i}needsResize(){const e=new se(this._image.width,this._image.height),t=e.x*e.y,i=t>this._maxPixels,r=this._maxDimensions!==null&&(e.x>this._maxDimensions||e.y>this._maxDimensions);return i||r}resize(){let e=null,t=null;const i=this._maxDimensions;return new _o((r,o)=>{window.setTimeout(()=>{const s=new se(this._image.width,this._image.height),n=s.clone();if(n.x*n.y>this._maxPixels&&(n.copy(this._getDimensionsByMaxPixels()),e="maxMegaPixels"),i!==null&&(n.x>i||n.y>i)){const a=Math.min(i/n.x,i/n.y);n.multiply(a),e="maxDimensions"}n.floor(),t=this._createResizedImageCanvas(n),r({canvas:t,dimensions:n,reason:e})},1e3)})}_createResizedImageCanvas(e,t=e){const i=this._image,r=document.createElement("canvas");r.width=e.x,r.height=e.y;const o=e.clone().subtract(t).divide(2),s=r.getContext("2d");return s.drawImage(i,0,0,i.width,i.height,o.x,o.y,t.x,t.y),r}_getDimensionsByMaxPixels(){const e=this._image,t=this._maxPixels,i=e.width/e.height,r=e.height/e.width;return new se(Math.sqrt(t*i),Math.sqrt(t*r)).floor()}}const cy=30,py="abcdefghijklmnopqrstuvwxzy";class _n{constructor(e){this._fontVariation=e||new yo({fontFamily:"Times New Roman",fontWeight:"normal",fontStyle:"normal"}),this._createRuler()}_createRuler(){this._ruler=document.createElement("div"),this._ruler.innerText=py,document.body.appendChild(this._ruler),this._setRulerStyle()}_setRulerStyle(){this._ruler.style.cssText=`
      position: absolute;
      top: -9999px;
      left: -9999px;
      opacity: 0;
      display: inline-block;
      font: ${this._fontVariation.getFontStyle()} ${this._fontVariation.getFontWeight()} ${cy}px ${this._fontVariation.getFontFamily()};
    `}setFontVariation(e){this._fontVariation=e,this._setRulerStyle()}getWidth(){return this._ruler?this._ruler.offsetWidth:-1}dispose(){this._ruler&&(this._ruler.parentNode.removeChild(this._ruler),this._ruler=null)}}const Xc=typeof window!="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):Be(),my=50,gy=5e3;class nl{constructor(e){this._fontVariation=e,this._defaultFontRuler=new _n,this._customFontRuler=new _n(this._fontVariation)}observe(){const e=Xc();return new Promise((t,i)=>{const r=window.setInterval(()=>{const o=this._defaultFontRuler.getWidth()!==this._customFontRuler.getWidth();if(o)return window.clearInterval(r),t();if(Xc()-e>=gy){const s=new Error(`Failed to load font ${this._fontVariation.getFontFamily()}.`);return s.font=this._fontVariation,i(s)}},my)})}dispose(){this._defaultFontRuler.dispose(),this._customFontRuler.dispose()}}class $o{constructor(e){this._ui=e,this._fonts=[],this._observers=[]}add(e){this._fonts.push(e)}load(){return this._fonts.length===0?Promise.resolve():(this._observers=[],this._fonts.forEach(e=>{this._observers.push(new nl(e))}),S.executePromises(this._observers.map(e=>e.observe())))}dispose(){this._observers.forEach(e=>e.dispose())}}class al extends $o{load(){return Promise.resolve()}}const fy={italic:"i"};class ll extends $o{load(){return this._fonts.length&&this._addStylesheetTag(),super.load()}_addStylesheetTag(){const e=this._getFamiliesString(),t=document.createElement("link");t.rel="stylesheet",t.href=`https://fonts.googleapis.com/css?family=${e}`;const i=document.getElementsByTagName("head")[0];i.appendChild(t)}_getFamiliesString(){const e={};this._fonts.forEach(i=>{const r=i.getFontFamily(),o=i.getFontStyle(),s=i.getFontWeight();e[r]=e[r]||[],typeof s!="undefined"?e[r].push(`${s}${fy[o]||""}`):e[r].push(400)});const t=[];for(const i in e){const r=e[i],o=r.length?`:${r.join(",")}`:"",s=i.replace(" ","+")+o;t.push(s)}return t.join("|")}}class ji{constructor(e,t){this._ui=e,this._fonts=t,this._loadedFonts=[]}setFonts(e){this._fonts=e}needsToLoad(){for(let e=0;e<this._fonts.length;e++){let t;if(this._fonts[e].getVariations().forEach(i=>{t=t||i.getProvider()}),!t)continue;return!0}}fontLoaded(e){const t=e.getFontFamily();return this._loadedFonts.indexOf(t)!==-1}setFontLoaded(e){if(!this.fontLoaded(e)){const t=e.getFontFamily();this._loadedFonts.push(t)}}load(){const e=this._fonts,t={google:new ll(this._ui),file:new al(this._ui)},i=()=>{for(const o in t){const s=t[o];s.dispose()}};e.filter(o=>!this.fontLoaded(o)).forEach(o=>{o.getVariations().forEach(s=>{const n=s.getProvider();if(!n)return;const a=t[n];a.add(s)})});const r=[];for(const o in t)r.push(t[o].load());return Promise.all(r).then(()=>{i(),e.forEach(o=>{this.setFontLoaded(o)})}).catch(o=>{throw i(),o})}}class hl{constructor(e,t){this._ui=e,this._options=t,this._brushes=[],this._brushesById={},this._addBrushes(we.DEFAULTS.BRUSHES);const{brushes:i,replaceBrushes:r,availableBrushes:o}=this._options;this._options.brushes&&this._addBrushes(i,r),o&&(this._brushes=this._brushes.filter(s=>o.indexOf(s.identifier)!==-1))}_addBrushes(e,t){t&&(this._brushes=[],this._brushesById={}),e.forEach(i=>{this._brushes.push(i),this._brushesById[i.identifier]=i})}getBrushByIdentifier(e){return this._brushesById[e]}getBrushes(){return this._brushes}getFirstBrush(){return this._brushes[0]}}class _y{constructor(){this._assetsByGroupId={}}addAsset(e,t,i=!1){this._assetsByGroupId[e]?i?this._assetsByGroupId[e].unshift(t):this._assetsByGroupId[e].push(t):this._assetsByGroupId[e]=[t]}setAssets(e,t){this._assetsByGroupId[e]=t}getAssets(e){return this._assetsByGroupId[e]=this._assetsByGroupId[e]||[],this._assetsByGroupId[e]}}var Qc=_y;const dl="imgly_sticker_custom";class Ki{constructor(e,t,i){this._ui=e,this._options=t,this._dynamicAssetsLibrary=i||this._ui.getEditor().getDynamicAssetsLibrary()||new Qc,this._categoriesById={},this._categories=[],this._stickersById={},this._customStickerCanvas=S.createCanvas(),this.reload()}reload(){this._categoriesById={},this._categories=[],this._stickersById={};const e=this._ui.getEditor().getSDK()._l.areCustomAssetsAllowed();this._addCategories(Zt.DEFAULTS.STICKER_CATEGORIES);const{categories:t,replaceCategories:i}=this._options;if(e&&this._options.categories?this._addCategories(t,i):(this._updateCategoriesMap(),this._updateAllCategory()),e){const r=this._dynamicAssetsLibrary.getAssets("sticker");if(r.length>0){const o=this._createCustomStickerCategory(r);this._addCategories([o],!1,!0)}}}loadExternal(e){const t=new Ft(e);return t.load().then(i=>{this._addCategories(i.categories,this._options.replaceCategories)})}_addCategories(e,t=!1,i=!1){t?this._categories=e.slice(0):i?this._categories=this._mergeCategories(e,this._categories):this._categories=this._mergeCategories(this._categories,e),this._updateCategoriesMap(),this._updateAllCategory()}_mergeCategories(e,t){e=rt.cloneCategories(e,"stickers");for(const i of t){let r=!1;for(const o of e)if(i.identifier===o.identifier){for(const s of i.stickers){let n=!1;for(const a of o.stickers)if(s.identifier===a.identifier){Object.assign(a,s),n=!0;break}n||o.stickers.push(s)}r=!0;break}r||e.push(i)}return e}_updateCategoriesMap(){this._categoriesById={},this._categories.forEach(e=>{this._categoriesById[e.identifier]=e}),this._categories.forEach(e=>{e.stickers.forEach(t=>{this._stickersById[t.identifier]=t})}),typeof this._options.availableStickers!="undefined"&&this._options.availableStickers!==null&&(this._categories.forEach(e=>{e.identifier!==dl&&(e.stickers=e.stickers.filter(t=>this._options.availableStickers.indexOf(t.identifier)!==-1))}),this._categories=this._categories.filter(e=>e.stickers.length>0)),this._updateAllCategory()}_updateAllCategory(){this._allCategory={identifier:"all",defaultName:"All",stickers:this._categories.map(e=>e.stickers).reduce((e,t)=>e.concat(t),[])},this._categoriesById.all=this._allCategory}renderStickerThumbnailFromImage(e){const t=this._customStickerCanvas,i=t.getContext("2d");i.save();const r=62,o=r/e.width,s=o*e.height;t.width=r,t.height=r,i.clearRect(0,0,e.width,e.height),i.translate(0,.5*(t.height-s)),i.scale(o,o),i.drawImage(e,0,0);const n=t.toDataURL("image/png");return i.restore(),{data:n,width:r,height:s}}addCustomStickerFromImage(e,t,i="none"){const r=g=>{const y=this._ui.getEditor().getSDK(),_=y.getRenderer(),f=new se(g.width,g.height),D=this._ui.getEditor().getMaxMegapixels()*1e6;let v=_.getMaxDimensions();const w=f.x*f.y>D,I=v!==null&&(f.x>v||f.y>v);if(w){const N=g.width/g.height,H=g.height/g.width;v=new se(Math.sqrt(D*N),Math.sqrt(D*H)).floor().max()}const P=f.clone();return(w||I)&&(f.x/f.y>1?(P.x=v,P.y=v/f.x*f.y):(P.x=v/f.y*f.x,P.y=v)),P},o=(g,y)=>{const _=g.x/g.y;return _>1?new se(y,y/_):new se(y*_,y)},s=e.src.substring(0,14)==="data:image/svg",n=this._ui.getEditor().getSDK();e=n.correctExifOrientation(e);const a=o(new se(e.width,e.height),2048),l=s?a:r(e),h=this._customStickerCanvas,c=h.getContext("2d");c.save();const p=this.renderStickerThumbnailFromImage(e);s?(e.width>e.height?(h.width=2048,h.height=2048/e.width*e.height):(h.height=2048,h.width=2048/e.height*e.width),e.width=h.width,e.height=h.height):(h.width=l.x,h.height=l.y,c.scale(l.x/e.width,l.y/e.height)),c.drawImage(e,0,0,e.width,e.height);const d=h.toDataURL();c.restore();const m={identifier:S.generateUUID(),defaultName:t||"",tintMode:i,images:{mediaThumb:{uris:[p.data],rawData:!0,width:p.width,height:p.height},mediaBase:{uris:s?[d,e.src]:[d],rawData:!0,isSVG:s,width:l.x,height:l.y}}},x=this._dynamicAssetsLibrary;x.addAsset("sticker",m,!0);const b=x.getAssets("sticker");if(b.length===1){const g=this._createCustomStickerCategory(b);this._addCategories([g],!1,!0)}else this.getCategory(dl).stickers=b,this._updateAllCategory();this._updateCategoriesMap()}_createCustomStickerCategory(e){return{identifier:dl,defaultName:"Custom",metaData:{backgroundImage:e[e.length-1].images.mediaBase.uris[0],rawData:!0},stickers:e}}getStickersForCategory(e){if(!this._categoriesById[e])throw new Error(`Unknown sticker category '${e}'`);return this._categoriesById[e].stickers}getStickerByIdentifier(e){return this._stickersById[e]}getCategories(e=!1){return e?[this._allCategory].concat(this._categories):this._categories}getCategory(e){return this._categoriesById[e]}static getURLForSticker(e,t="base"){const{images:i}=e,r=t==="base"&&i.mediaBase||i.mediaThumb,o=r.uris||[r.uri];if(!rt.Browser.getIEVersion()){const n=o.filter(a=>/\.svg$/i.test(a));return n.length?n[0]:o[0]}const s=o.filter(n=>!/\.svg$/i.test(n));return s.length?s[0]:o[0]}}const Zc=Ne(Ot());let ul;typeof U.Operations.SpriteOperation!="undefined"&&(ul=U.Operations.SpriteOperation.BrushSprite);class nr{constructor(e,t){this._editor=e,this._ui=this._editor.getUI(),this._data=t,this._filterManager=new Vt(this._ui,this._getOptions("filter")),this._stickerManager=new Ki(this._ui,this._getOptions("sticker")),this._brushManager=new hl(this._ui,this._getOptions("brush")),this._fontManager=new ot(this._ui,this._getOptions("text"))}_getOptions(e){const{controls:t}=this._editor;let i={};t&&t.get(e)&&(i=t.get(e).defaultOptions);const r=this._editor.getOptions();return le.deepDefaults({},r.editor.controlsOptions[e]||{},i)}deserialize(){return this._validateVersion().then(()=>this._deserializeInputImage()).then(()=>this._deserializeOperations())}_validateVersion(){return this._data.version!==this.constructor.version?Promise.reject(new Error(`Invalid version ${this._data.version}, expected ${this.constructor.version}`)):Promise.resolve()}_deserializeInputImage(){return new Promise((e,t)=>{const{data:i,type:r}=this._data.inputImage;if(i&&r){const o=new window.Image;o.addEventListener("load",()=>{this._editor.setImage(o),e()}),o.src=`data:${r};base64,${i}`}else e()})}_deserializeOperations(){return Ae(this,null,function*(){const{operations:e}=this._data;return Zc.default(e,t=>Ae(this,null,function*(){return this._deserializeOperation(t)}))})}_deserializeOperation(e){switch(e.type){case"crop":return this._deserializeCropOperation(e);case"orientation":return this._deserializeOrientationOperation(e);case"filter":return this._deserializeFilterOperation(e);case"adjustments":return this._deserializeAdjustmentsOperation(e);case"sprite":return this._deserializeSpriteOperation(e);case"focus":return this._deserializeFocusOperation(e)}}_deserializeCropOperation(e){const{options:t}=e;let{rotation:i}=t;const r=se.fromObject(t.start),o=se.fromObject(t.end);i>Math.PI&&(i-=Math.PI*2);const s={start:r,end:o};typeof i!="undefined"&&(s.rotation=i);const n=this._editor.operations.getOrCreate("transform");return this._editor.broadcastTransform(n,s),n.set(s),Promise.resolve(n)}_deserializeOrientationOperation(e){const{options:t}=e,i=this._editor.operations.getOrCreate("orientation");return i?(i.set(t),Promise.resolve(i)):Promise.resolve()}_deserializeFilterOperation(e){const{options:t}=e;return this._filterManager.getFilterByIdentifier(t.name)?this._filterManager.instantiateFilterWithIdentifier(t.name).then(i=>{const r=this._editor.operations.getOrCreate("filter");return r.set({identifier:t.name,filter:i,intensity:t.intensity}),r}):(F.warn("Deserializer",`Unknown filter \`${t.name}\``),Promise.resolve())}_deserializeAdjustmentsOperation(e){const{AdjustmentsOperation:t}=U.Operations,{options:i}=e,r=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"],o={};return r.forEach(s=>{if(typeof i[s]=="undefined")return;const{minValue:n,midValue:a,maxValue:l}=t.prototype.availableOptions[s];let h=i[s];h=h<0?a+(a-n)*h:a+(l-a)*h,o[s]=h}),Promise.resolve(this._editor.operations.getOrCreate("adjustments",o))}_deserializeSpriteOperation(e){const{options:t}=e,i=this._editor.operations.getOrCreate("sprite");if(!i)return Promise.resolve();const r=t.sprites.map(o=>this._deserializeSprite(i,o)).filter(o=>o);return Promise.all(r).then(o=>(i.setSprites(o.filter(s=>s)),i))}_deserializeSprite(e,t){switch(t.type){case"sticker":return this._deserializeSticker(e,t);case"text":return this._deserializeText(e,t);case"brush":return this._deserializeBrush(e,t);case"textdesign":return this._deserializeTextDesign&&this._deserializeTextDesign(e,t)}}_deserializeSticker(e,t){const{SpriteOperation:i}=U.Operations,{options:r}=t,o=this._stickerManager.getStickerByIdentifier(r.name),s=this._stickerManager.getURLForSticker(o);return o?new Promise((n,a)=>{const l=new window.Image;l.addEventListener("load",()=>{const h=i.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:c,flipHorizontally:p,flipVertically:d}=r,m={identifier:r.name,image:l,position:se.fromObject(r.position),dimensions:se.fromObject(r.dimensions),rotation:c,flipHorizontally:p,flipVertically:d,adjustments:{}};typeof r.adjustments!="undefined"&&["brightness","contrast","saturation"].forEach(x=>{typeof r.adjustments[x]!="undefined"&&(m.adjustments[x]=r.adjustments[x]+h[x].default)}),n(e.createSticker(m))}),l.crossOrigin=this._editor.getCrossOrigin(),l.src=this._editor.getUI().getAssetPath(s)}):(F.warn("Deserializer",`Unknown sticker '${r.name}'. Skipping sprite.`),Promise.resolve())}_deserializeText(e,t){const{options:i}=t,{fontSize:r,lineHeight:o,fontFamily:s,fontWeight:n,alignment:a,rotation:l,maxWidth:h,color:c,backgroundColor:p}=i,d=new ji(this._ui);let m=this._fontManager.getFontByFontFamily(s);return m||(m=this._fontManager.getDefaultFont()),d.setFonts([m]),d.load().then(()=>{const x=e.createText({fontSize:r,lineHeight:o,fontFamily:s,fontWeight:n,alignment:a,rotation:l,maxWidth:h,text:i.text,color:pe.fromArray(c),backgroundColor:pe.fromArray(p),position:se.fromObject(i.position)});return x._edited=!0,x})}_deserializeBrush(e,t){const{options:i}=t,{paths:r}=i,o=e.createBrush();return r.forEach(s=>{this._deserializeBrushPath(o,s)}),Promise.resolve(o)}_deserializeBrushPath(e,t){const{points:i}=t,r=this._createBrushForPath(t),o=e.createPath(r);o.setClosed(!0),i.forEach(s=>{o.addControlPoint(se.fromObject(s))})}_createBrushForPath(e){const{color:t,size:i}=e,r=pe.fromArray(t),o={color:r,size:i},s=this._brushManager.getFirstBrush();if(s.prototype&&s.prototype instanceof ul){const l=s;return new l(o)}const n=le.extend({},s);delete n.image;class a extends ul{}return a.identifier=s.identifier,new a(le.extend({},n,o))}_deserializeFocusOperation(e){const{options:t}=e.options;switch(e.options.type){case"radial":{const{position:i,radius:r,gradientRadius:o,blurRadius:s}=t;return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:se.fromObject(i),radius:r,gradientRadius:o,blurRadius:s}))}case"linear":{const{start:i,end:r,size:o,gradientSize:s,blurRadius:n}=t;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:se.fromObject(i),end:se.fromObject(r),size:o,gradientSize:s,blurRadius:n}))}}}_getInputDimensionsForOperation(e){let t=!1,i=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(r=>{if(r===e&&(t=!0),t)return;i=r.getNewDimensions(i)}),i}}nr.version="1.0.0";const xo=Math.PI*2;class ar{constructor(e){this._editor=e,this._serializeOperations=this._serializeOperations.bind(this)}serialize(e={}){this._options=le.defaults(e,{image:!0});const t={version:this.constructor.version};return this._serializeInputImage(t).then(this._serializeOperations)}_serializeInputImage(e){const t=this._editor.getImage(),{width:i,height:r}=t;if(!this._options.image)return e.inputImage={width:i,height:r},Promise.resolve(e);const o=le.createCanvas();o.width=t.width,o.height=t.height;const s=o.getContext("2d");s.drawImage(t,0,0);const n=o.toDataURL(il.PNG);return e.inputImage={type:il.PNG,data:n.replace(/^data:image\/(.*?);base64,/,""),width:i,height:r},Promise.resolve(e)}_serializeOperations(e){const t=[],i=this._editor.operations.getStack();return i.forEach(r=>{const o=this._serializeOperation(r,t);o&&t.push(o)}),e.operations=t.filter(r=>r),Promise.resolve(e)}_serializeOperation(e,t){switch(e.constructor.identifier){case"transform":return this._serializeTransformOperation(e);case"orientation":return this._serializeOrientationOperation(e);case"filter":return this._serializeFilterOperation(e);case"adjustments":return this._serializeAdjustmentsOperation(e);case"sprite":return this._serializeSpriteOperation(e,t);case"radial-focus":return this._serializeRadialFocusOperation(e);case"mirrored-focus":return this._serializeLinearFocusOperation(e);default:F.warn(`Unable to serialize operation of type ${e.constructor.identifier}`)}}_serializeTransformOperation(e){const t=e.serializeOptions(["start","end","rotation"],!0);return t.rotation=(t.rotation+xo)%xo,{type:"crop",options:t}}_serializeOrientationOperation(e){return{type:"orientation",options:e.serializeOptions(["flipVertically","flipHorizontally","rotation"],!0)}}_serializeFilterOperation(e){return e.getIdentifier()==="identity"?null:{type:"filter",options:{intensity:e.getIntensity(),name:e.getIdentifier()}}}_serializeAdjustmentsOperation(e){const{availableOptions:t}=e,i=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"],r={};return i.forEach(o=>{const s=t[o],n=e.getOption(o),{minValue:a,midValue:l,maxValue:h}=s;r[o]=n<=l?(n-a)/(l-a)-1:(n-l)/(h-l)}),{type:"adjustments",options:r}}_serializeSpriteOperation(e,t){const i=t.filter(s=>s.type==="sprite");let r,o=!0;if(i.length?(r=i.pop(),o=!1):r={type:"sprite",options:{sprites:[]}},e.getSprites().forEach(s=>{let n=null;s instanceof e.constructor.StickerSprite?n=this._serializeSticker(e,s):s instanceof e.constructor.TextSprite?n=this._serializeText(e,s):s instanceof e.constructor.BrushSprite?n=this._serializeBrush(e,s):s instanceof e.constructor.TextDesignSprite&&(n=this._serializeTextDesign&&this._serializeTextDesign(e,s)),n&&r.options.sprites.push(n)}),o)return r}_serializeSticker(e,t){const i=t.getAdjustments(),r=t.serializeOptions(["identifier","position","dimensions","flipVertically","flipHorizontally","rotation"],!0);r.name=r.identifier,delete r.identifier,r.rotation=(r.rotation+xo)%xo;const o=i.availableOptions;return r.adjustments={brightness:i.getBrightness()-o.brightness.default,saturation:i.getSaturation()-o.saturation.default,contrast:i.getContrast()-o.contrast.default},{type:"sticker",options:r}}_serializeText(e,t){const i=t.serializeOptions(["fontSize","lineHeight","fontFamily","fontWeight","alignment","color","backgroundColor","position","rotation","text","maxWidth"],!0);return i.rotation=(i.rotation+xo)%xo,{type:"text",options:i}}_serializeBrush(e,t){return{type:"brush",options:{paths:t.getPaths().map(i=>this._serializePath(i))}}}_serializePath(e){const t=e.getBrush().serializeOptions(["color","size"],!0);return t.points=e.getControlPoints().map(i=>i.getPosition().toObject()),t}_serializeRadialFocusOperation(e){return{type:"focus",options:{type:"radial",options:e.serializeOptions(["position","radius","gradientRadius","blurRadius"],!0)}}}_serializeLinearFocusOperation(e){return{type:"focus",options:{type:"linear",options:e.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}}_getInputDimensionsForOperation(e){let t=!1,i=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(r=>{if(r===e&&(t=!0),t)return;i=r.getNewDimensions(i)}),i}}ar.version="1.0.0";class hr extends nr{_deserializeOperation(e){return e.type==="selective-blur"?this._deserializeSelectiveBlurOperation(e):super._deserializeOperation(e)}_deserializeCropOperation(e){const{options:t}=e;let{rotation:i}=t;const r=se.fromObject(t.start),o=se.fromObject(t.end),s=t.dimensions?se.fromObject(t.dimensions):null;if(o.x-r.x<=0||o.y-r.y<=0)throw new Error(`A crop should not result in negative or zero dimensions - start: ${r} - end: ${o}`);i>Math.PI&&(i-=Math.PI*2);const n={start:r,end:o};typeof i!="undefined"&&(n.rotation=i);const a=this._editor.operations.getOrCreate("transform");if(!a)return Promise.resolve();if(this._editor.broadcastTransform(a,n),a.set(n),s){const l=o.clone().subtract(r),h=a.getInputDimensions(!1).multiply(l);a.setTextureScale(s.x/h.x)}return Promise.resolve(a)}}hr.version="1.0.1";const Jc=Math.PI*2;class dr extends ar{_serializeTransformOperation(e){const t=e.serializeOptions(["start","end","rotation","textureScale"],!0);return t.rotation=(t.rotation+Jc)%Jc,t.textureScale!==1&&(t.dimensions=e.getNewDimensions(e.getInputDimensions(!1))),delete t.textureScale,{type:"crop",options:t}}}dr.version="1.0.1";const{OptionType:vo}=U;class yn extends U.Configurable{constructor(e,t={}){super(t);this._loaded=!1,this._loading=!1,this._ui=e,this._frame=U.Utils.deepClone(this._options)}load(){if(this._loaded)return Promise.resolve();if(this._loading)return Promise.reject(new Error("Called Frame#load while it's already loading"));this._loading=!0;const{imageGroups:e}=this._frame,t=[];return["top","left","right","bottom"].forEach(i=>{if(!(i in e))return;const r=e[i];["start","mid","end"].forEach(o=>{if(!(o in r))return;t.push(this._loadPart(i,o))})}),Promise.all(t).then(()=>{this._loaded=!0,this._loading=!1}).catch(i=>{this._loaded=!1,this._loading=!1})}_loadPart(e,t){const{imageGroups:i}=this._frame,r=i[e][t];let o=r;return typeof r!="string"&&"image"in r&&(o=r.image),pt.load(this._ui.getAssetPath(o)).then(s=>(typeof r!="string"?this._frame.imageGroups[e][t].image=s:this._frame.imageGroups[e][t]=s,s))}getFrame(){return this._frame}}yn.prototype.availableOptions={identifier:{type:vo.STRING,required:!0},defaultName:{type:vo.STRING},thumbnail:{type:vo.STRING},tintable:{type:vo.BOOLEAN,default:!1},layoutMode:{type:vo.STRING,default:"horizontal-inside",available:["horizontal-inside","vertical-inside"]},imageGroups:{type:vo.OBJECT,required:!0}};class cl{constructor(e,t){this._ui=e,this._options=t,this._categoriesById={},this._categories=[],this._framesById={},this._addCategories(Zt.DEFAULTS.FRAME_CATEGORIES),this._customAssetsAllowed=e.getEditor().getSDK()._l.areCustomAssetsAllowed();const{categories:i,replaceCategories:r}=this._options;this._customAssetsAllowed&&this._options.categories?this._addCategories(i,r):this._updateAllCategory()}_addCategories(e,t=!1){t?this._categories=e.slice(0):this._categories=rt.mergeCategories(this._categories,e,"frames"),this._categoriesById={},this._categories.forEach(r=>{this._categoriesById[r.identifier]=r});const{availableFrames:i}=this._options;this._customAssetsAllowed&&i&&this._categories.forEach(r=>{r.frames=r.frames.filter(o=>i.indexOf(o.identifier)!==-1)}),this._categories.forEach(r=>{r.frames.forEach(o=>{this._framesById[o.identifier]=o})}),this._updateAllCategory()}_updateAllCategory(){this._allCategory={identifier:"all",defaultName:"All",frames:this._categories.map(e=>e.frames).reduce((e,t)=>e.concat(t),[])},this._categoriesById.all=this._allCategory}getFramesForCategory(e){if(!this._categoriesById[e])throw new Error(`Unknown frame category '${e}'`);return this._categoriesById[e].frames}getFrameByIdentifier(e){return this._framesById[e]}getCategories(){return this._categories}getCategory(e){return this._categoriesById[e]}}class pl{constructor(e,t){this._ui=e,this._options=t,this._overlays=Zt.DEFAULTS.OVERLAYS.slice(0),this._overlaysByIdentifier={};const i=e.getEditor().getSDK()._l.areCustomAssetsAllowed();i&&t.overlays&&(t.replaceOverlays?this._overlays=t.overlays:this._overlays=this._overlays.concat(t.overlays)),i&&t.availableOverlays&&(this._overlays=this._overlays.filter(r=>t.availableOverlays.indexOf(r.identifier)!==-1)),this._overlays.forEach(r=>{this._overlaysByIdentifier[r.identifier]=r})}getOverlays(){return this._overlays}getOverlayByIdentifier(e){return this._overlaysByIdentifier[e]}}const{OverlayFilter:ni}=U.Engine.Filters;var wo={[ni.BLEND_MODES.NORMAL]:"normal",[ni.BLEND_MODES.OVERLAY]:"overlay",[ni.BLEND_MODES.HARD_LIGHT]:"hard light",[ni.BLEND_MODES.SOFT_LIGHT]:"soft light",[ni.BLEND_MODES.MULTIPLY]:"multiply",[ni.BLEND_MODES.DARKEN]:"darken",[ni.BLEND_MODES.LIGHTEN]:"lighten",[ni.BLEND_MODES.SCREEN]:"screen",[ni.BLEND_MODES.COLOR_BURN]:"color burn"};const yy=le.flipObject(wo);class cr extends hr{constructor(...e){super(...e);this._frameManager=new cl(this._ui,this._getOptions("frame"));const t=this._getOptions("overlay");t&&(this._overlayManager=new pl(this._ui,t))}_deserializeSprite(e,t){return t.type==="frame"?this._deserializeFrame(e,t):t.type==="overlay"?this._deserializeOverlay(e,t):super._deserializeSprite(e,t)}_deserializeOperation(e){return e.type==="transform"?this._deserializeTransformOperation(e):super._deserializeOperation(e)}_deserializeOrientationOperation(e){if(this._data.meta&&this._data.meta.platform!=="html5")return super._deserializeOrientationOperation(e);const{rotation:t,flipHorizontally:i,flipVertically:r}=e.options;let o=t===90&&!i&&!r;return o|=t===90&&i&&r,o|=t===270&&!i&&!r,o|=t===270&&i&&r,o&&(e.options.flipHorizontally=!e.options.flipHorizontally,e.options.flipVertically=!e.options.flipVertically),super._deserializeOrientationOperation(e)}_deserializeTransformOperation(e){return super._deserializeCropOperation(e).then(t=>{if(!t)return;const i=le.Array.find(this._data.operations,r=>r.type==="orientation");if(i){const{options:r}=i;let{rotation:o,flipHorizontally:s,flipVertically:n}=r;(o===90||o===270)&&((!s&&n||s&&!n)&&(s=!s,n=!n)),t.rotate(r.rotation),s&&(t.flip("horizontal"),t.setRotation(t.getRotation()*-1)),n&&(t.flip("vertical"),t.setRotation(t.getRotation()*-1))}return t})}_deserializeFrame(e,t){const{identifier:i}=t.options,r=this._frameManager.getFrameByIdentifier(i);if(!r)return F.warn("Deserializer",`Unknown frame \`${i}\`. Skipping frame.`),Promise.resolve();const o=new yn(this._ui,r);return o.load().then(()=>{this._editor.operations.getOrCreate("frame",{frame:o.getFrame()})})}_deserializeOverlay(e,t){const{blendMode:i,intensity:r,identifier:o}=t.options,s=this._overlayManager.getOverlayByIdentifier(o);if(!s)return F.warn("Deserializer",`Unknown overlay \`${o}\`. Skipping overlay.`),Promise.resolve();const n=this._editor.getUI().getAssetPath(s.image);return pt.load(n).then(a=>{this._editor.operations.getOrCreate("overlay",{alpha:r,identifier:o,blendMode:parseInt(yy[i||s.blendMode],10),image:a})})}_createBrushForPath(e){const t=super._createBrushForPath(e);return typeof e.hardness!="undefined"&&t.hasOption("hardness")&&t.setHardness(e.hardness),t}_deserializeSticker(e,t){const{SpriteOperation:i}=U.Operations,{options:r}=t,o=this._stickerManager.getStickerByIdentifier(r.identifier),s=Ki.getURLForSticker(o,"base");if(!o)return F.warn("Deserializer",`Unknown sticker \`${r.identifier}\`. Skipping sprite.`),Promise.resolve();const n=e.getInputDimensions(!1);return new Promise((a,l)=>{const h=new window.Image;h.addEventListener("load",()=>{const c=i.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:p,flipHorizontally:d,flipVertically:m}=r,x={identifier:r.identifier,image:h,position:se.fromObject(r.position),dimensions:se.fromObject(r.dimensions).multiply(n.min()),rotation:p,flipHorizontally:d,flipVertically:m,adjustments:{}};typeof r.adjustments!="undefined"&&["brightness","contrast","saturation"].forEach(b=>{typeof r.adjustments[b]!="undefined"&&(x.adjustments[b]=r.adjustments[b]+c[b].default)}),typeof r.tintColor!="undefined"&&typeof o.tintMode!="undefined"&&(x.tintColor=pe.fromArray(r.tintColor),x.tintMode=o.tintMode),a(e.createSticker(x))}),h.crossOrigin=this._editor.getCrossOrigin(),h.src=this._editor.getUI().getAssetPath(s)})}_deserializeFilterOperation(e){const{options:t}=e;return this._filterManager.getFilterByIdentifier(t.identifier)?this._filterManager.instantiateFilterWithIdentifier(t.identifier).then(i=>{const r=this._editor.operations.getOrCreate("filter");return r?(r.set({identifier:t.identifier,filter:i,intensity:t.intensity}),r):void 0}):(F.warn("Deserializer",`Unknown filter \`${t.identifier}\``),Promise.resolve())}_deserializeFocusOperation(e){const{options:t,type:i}=e.options;if(i!=="radial")return super._deserializeFocusOperation(e);const r=this._editor.getImage(),o=r.width/r.height,{start:s,end:n,gradientRadius:a,blurRadius:l}=t,h=se.fromObject(n).subtract(se.fromObject(s)).multiply(o,1).len();return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:se.fromObject(s),radius:h,gradientRadius:a,blurRadius:l}))}_deserializeText(e,t){const{options:i}=t,{fontSize:r,lineHeight:o,fontIdentifier:s,alignment:n,rotation:a,maxWidth:l,color:h,backgroundColor:c}=i,p=new ji(this._ui);let d=this._fontManager.getVariationByIdentifier(s);return d?p.setFonts([d.getFont()]):d=this._fontManager.getDefaultFont(),p.load().then(()=>{const m=e.getInputDimensions(!1),x=l*m.min()/m.x,b=e.createText({fontSize:r,lineHeight:o,fontFamily:d.getFontFamily(),fontWeight:d.getFontWeight(),fontIdentifier:d.getIdentifier(),alignment:n,rotation:a,maxWidth:x,text:i.text,color:pe.fromArray(h),backgroundColor:pe.fromArray(c),position:se.fromObject(i.position)});return b._edited=!0,b})}}cr.version="2.0.0";class pr extends dr{_serializeSticker(e,t){const i=e.getInputDimensions(!1),r=super._serializeSticker(e,t);return t.getTintMode()!=="none"&&(r.options.tintColor=t.serializeOption("tintColor",!0)),r.options.dimensions=t.getDimensions().clone().divide(i.min()).toObject(),r.options.identifier=r.options.name,delete r.options.name,r}_serializePath(e){const t=super._serializePath(e),i=e.getBrush();return i.hasOption("hardness")&&(t.hardness=i.getOption("hardness")),t}_serializeOperation(e,t){return e.constructor.identifier==="frame"?(this._serializeFrameOperation(e,t),null):e.constructor.identifier==="overlay"?(this._serializeOverlayOperation(e,t),null):super._serializeOperation(e,t)}_serializeFrameOperation(e,t){const i=t.filter(o=>o.type==="sprite");let r;i.length?r=i.pop():(r={type:"sprite",options:{sprites:[]}},t.push(r)),r.options.sprites.push({type:"frame",options:this._getFrameOptions(e)})}_serializeOverlayOperation(e,t){if(!e.getIdentifier())return;const i=t.filter(o=>o.type==="sprite");let r;i.length?r=i.pop():(r={type:"sprite",options:{sprites:[]}},t.push(r)),r.options.sprites.push({type:"overlay",options:{identifier:e.getIdentifier(),intensity:e.getAlpha(),blendMode:wo[e.getBlendMode()]}})}_getFrameOptions(e){return{identifier:e.getFrame().identifier}}_serializeOrientationOperation(e){const t=super._serializeOrientationOperation(e);return(t.options.rotation===90||t.options.rotation===270)&&(t.options.flipHorizontally=!t.options.flipHorizontally,t.options.flipVertically=!t.options.flipVertically),t}_serializeTransformOperation(e){const{operations:t}=this._editor;if(t.exists("orientation")){e=e.clone();const r=t.get("orientation");e.rotate(-r.getRotation()),r.getFlipVertically()&&(e.flip("vertical"),e.setRotation(e.getRotation()*-1)),r.getFlipHorizontally()&&(e.flip("horizontal"),e.setRotation(e.getRotation()*-1))}const i=super._serializeTransformOperation(e);return i.type="transform",i}_serializeText(e,t){const i=super._serializeText(e,t),r=e.getInputDimensions(!1);return i.options.fontIdentifier=t.getFontIdentifier(),i.options.maxWidth=i.options.maxWidth*r.x/r.min(),delete i.options.fontFamily,i}_serializeFilterOperation(e){const t=super._serializeFilterOperation(e);return t?(t.options.identifier=t.options.name,delete t.options.name,t):null}_serializeRadialFocusOperation(e){const t=super._serializeRadialFocusOperation(e),i=t.options.options;return i.start=i.position,delete i.position,i.end={x:i.start.x+i.radius,y:i.start.y},delete i.radius,t}}pr.version="2.0.0";let ml;typeof U.Operations.SpriteOperation!="undefined"&&(ml=U.Operations.SpriteOperation.BrushSprite.Brush);class gr extends cr{_deserializeSticker(e,t){const{SpriteOperation:i}=U.Operations,{options:r}=t,o=this._stickerManager.getStickerByIdentifier(r.identifier);if(!o)return F.warn("Deserializer",`Unknown sticker \`${r.identifier}\`. Skipping sprite.`),Promise.resolve();const{mediaBase:s}=o.images,n=Ki.getURLForSticker(o,"base"),a=s.rawData?s.uris[0]:this._editor.getUI().getAssetPath(n),l=e.getInputDimensions(!1);return pt.load(a).then(h=>{const c=i.StickerSprite.prototype.availableOptions.adjustments.structure,{rotation:p,flipHorizontally:d,flipVertically:m}=r,x={identifier:r.identifier,image:h,position:se.fromObject(r.position),dimensions:se.fromObject(r.dimensions).multiply(l.min()),rotation:p||0,flipHorizontally:d,flipVertically:m,resizeMode:o.resizeMode||"keepAspect",adjustments:{}};return typeof r.adjustments!="undefined"&&["brightness","contrast","saturation"].forEach(b=>{typeof r.adjustments[b]!="undefined"&&(x.adjustments[b]=r.adjustments[b]+c[b].default)}),typeof r.tintMode!="undefined"&&typeof r.tintColor!="undefined"?(x.tintColor=pe.fromArray(r.tintColor.rgba),x.tintMode=r.tintMode):typeof r.tintColor!="undefined"&&typeof o.tintMode!="undefined"&&(x.tintColor=pe.fromArray(r.tintColor.rgba),x.tintMode=o.tintMode),typeof r.alpha!="undefined"&&(x.alpha=r.alpha),e.createSticker(x)})}_deserializeTransformOperation(e){return super._deserializeTransformOperation(e).then(t=>t?(t._ratio=null,t):void 0)}_deserializeInputImage(){let{data:e,type:t,uri:i}=this._data.image;return e&&t&&(i=`data:${t};base64,${e}`),i?pt.load(i).then(r=>{this._editor.setImage(r)}):Promise.resolve()}_deserializeAdjustmentsOperation(e){const{AdjustmentsOperation:t}=U.Operations;return super._deserializeAdjustmentsOperation(e).then(i=>{if(!i)return null;const{options:r}=e,o=["gamma","whites","blacks","temperature"],s={};return o.forEach(n=>{if(typeof r[n]=="undefined")return;const{minValue:a,midValue:l,maxValue:h}=t.prototype.availableOptions[n];let c=r[n];c=c<0?l+(l-a)*c:l+(h-l)*c,s[n]=c}),i.set(s),i})}_deserializeFocusOperation(e){const{options:t}=e.options;switch(e.options.type){case"radial":return super._deserializeFocusOperation(e);case"linear":{const{start:i,end:r,blurRadius:o}=t;return Promise.resolve(this._editor.operations.getOrCreate("linear-focus",{controlPoint1:se.fromObject(i),controlPoint2:se.fromObject(r),blurRadius:o}))}case"mirrored":{const{start:i,end:r,size:o,gradientSize:s,blurRadius:n}=t;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:se.fromObject(i),end:se.fromObject(r),size:o,gradientSize:s,blurRadius:n}))}case"gaussian":{const{blurRadius:i}=t;return Promise.resolve(this._editor.operations.getOrCreate("blur",{blurRadius:i}))}}}_deserializeText(e,t){const{options:i}=t,{fontSize:r,lineHeight:o,fontIdentifier:s,alignment:n,rotation:a,maxWidth:l,color:h,backgroundColor:c}=i,p=this._ui.getFontLoader();let d=this._fontManager.getVariationByIdentifier(s);return d?p.setFonts([d.getFont()]):d=this._fontManager.getDefaultVariation(),p.load().then(()=>{const m=e.getInputDimensions(!1),x=l*m.min()/m.x,b=e.createText({fontSize:r,lineHeight:o,fontFamily:d.getFontFamily(),fontWeight:d.getFontWeight(),fontIdentifier:d.getIdentifier(),textMetrics:d.getTextMetrics(),alignment:n,rotation:a,maxWidth:x,text:i.text,color:pe.fromArray(h.rgba),backgroundColor:pe.fromArray(c.rgba),position:se.fromObject(i.position)});return b._edited=!0,b})}_createBrushForPath(e){const{identifier:t,color:i,size:r,hardness:o}=e.brush,s=pe.fromArray(i.rgba),n={color:s,size:r};typeof o!="undefined"&&(n.hardness=o);let a=this._brushManager.getBrushByIdentifier(t);if(a||(a=this._brushManager.getFirstBrush()),a.prototype&&a.prototype instanceof ml){const c=a;return new c(n)}const l=le.extend({},a);delete l.image;class h extends ml{}return h.identifier=a.identifier,new h(le.extend({},l,n))}_deserializeFrame(e,t){return super._deserializeFrame(e,t).then(()=>{const i=this._editor.operations.get("frame"),{size:r,alpha:o,tintColor:s}=t.options,n={};typeof r!="undefined"&&(n.scale=r),typeof o!="undefined"&&(n.alpha=o),typeof s!="undefined"&&(n.tintColor=pe.fromArray(s.rgba)),i.set(n)})}_deserializeTextDesign(e,t){const{options:i}=t,{position:r,rotation:o,flipHorizontally:s,flipVertically:n,text:a,color:l,width:h,seed:c,inverted:p}=i;let{identifier:d}=i;d===U.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?d=U.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:d===U.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(d=U.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);const m=new Lt(this._ui,this._getOptions("textdesign")),x=new ot(this._ui,{fonts:we.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:b}=e.constructor.TextDesignSprite,g=this._ui.getFontLoader(),y=m.getLayoutByIdentifier(d),_=new y;return g.setFonts(x.getFonts()),b.setFonts(T(T({},b.getFonts()),x.getVariationsByIdentifier())),g.load().then(()=>{const f=_.getImagePaths().map(D=>({path:D,fullPath:this._ui.getAssetPath(D),image:null}));return b.loadImages(f).then(()=>(_.onImagesLoaded(),e.createTextDesign({position:r,rotation:o,flipHorizontally:s,flipVertically:n,text:a,color:pe.fromArray(l.rgba),width:h,seed:c,inverted:p,layout:_})))})}}gr.version="3.0.0";class To extends Q{}To.prototype.availableOptions={identifier:{type:u.STRING,required:!0},defaultName:{type:u.STRING,required:!0},ratio:{type:u.ALL,required:!1,default:null},selected:{type:u.BOOLEAN,required:!1},dimensions:{type:u.VECTOR2,required:!1},lockDimensions:{type:u.BOOLEAN,required:!1,default:null},forceDimensions:{type:u.BOOLEAN,required:!1,default:null}};class fr extends pr{serialize(e={}){return super.serialize(e).then(t=>(t.meta={platform:"html5",version:this._editor.getSDK().version,createdAt:le.ISODateString(new Date)},t.image=t.inputImage,delete t.inputImage,t))}_serializeSticker(e,t){const i=super._serializeSticker(e,t);return i.options.alpha=t.getAlpha(),i.options.tintColor&&(i.options.tintColor={rgba:i.options.tintColor}),i}_serializeText(e,t){const i=super._serializeText(e,t);return i.options.color={rgba:i.options.color},i.options.backgroundColor={rgba:i.options.backgroundColor},i.options.flipHorizontally=!1,i.options.flipVertically=!1,delete i.options.fontWeight,i}_serializePath(e){const t=super._serializePath(e);delete t.hardness,delete t.size,delete t.color;const i=e.getBrush();t.brush=i.serializeOptions(["identifier","size","color"],!0),typeof t.brush.identifier=="undefined"&&delete t.brush.identifier,t.brush.color={rgba:t.brush.color};const r=i.getOption("hardness");return r!=="undefined"&&(t.brush.hardness=r),t}_serializeFrameOperation(e,t){super._serializeFrameOperation(e,t);const i=t.filter(o=>o.type==="sprite");let r;if(i.length){r=i.pop();const o=r.options.sprites.filter(a=>a.type==="frame")[0],s=e.getTintColor();s.equals(new pe(1,1,1,0))||(o.options.tintColor={rgba:e.serializeOption("tintColor",!0)});const n=e.serializeOptions(["scale","alpha"],!0);o.options=le.extend(o.options,n),o.options.size=o.options.scale,delete o.options.scale}}_serializeTransformOperation(e){const t=super._serializeTransformOperation(e);if(e._ratio){let i;e._ratio instanceof To?i=e._ratio.getIdentifier():i=e._ratio.identifier,t.options.meta={identifier:i}}return delete t.options.scale,t}_serializeAdjustmentsOperation(e){const t=super._serializeAdjustmentsOperation(e),i=["gamma","whites","blacks","temperature"],{availableOptions:r}=e,o={};return i.forEach(s=>{const n=r[s],a=e.getOption(s),{minValue:l,midValue:h,maxValue:c}=n;o[s]=a<=h?(a-l)/(h-l)-1:(a-h)/(c-h)}),t.options=T(T({},t.options),o),t}_serializeOperation(e,t){switch(e.constructor.identifier){case"mirrored-focus":return this._serializeMirroredFocusOperation(e);case"linear-focus":return this._serializeLinearFocusOperation(e);case"blur":return this._serializeBlurOperation(e);default:return super._serializeOperation(e,t)}}_serializeMirroredFocusOperation(e){return{type:"focus",options:{type:"mirrored",options:e.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}}_serializeLinearFocusOperation(e){const t=e.serializeOptions(["controlPoint1","controlPoint2","blurRadius"],!0);return t.start=t.controlPoint1,delete t.controlPoint1,t.end=t.controlPoint2,delete t.controlPoint2,{type:"focus",options:{type:"linear",options:t}}}_serializeBlurOperation(e){return{type:"focus",options:{type:"gaussian",options:e.serializeOptions(["blurRadius"],!0)}}}}fr.version="3.0.0";class yr extends gr{_deserializeTextDesign(e,t){const{options:i}=t,{position:r,rotation:o,flipHorizontally:s,flipVertically:n,text:a,color:l,width:h,seed:c,inverted:p}=i;let{identifier:d}=i;d===U.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?d=U.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:d===U.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(d=U.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);const m=new Lt(this._ui,this._getOptions("textdesign")),x=new ot(this._ui,{fonts:we.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:b}=e.constructor.TextDesignSprite,g=this._ui.getFontLoader(),y=m.getLayoutByIdentifier(d),_=new y;return g.setFonts(x.getFonts()),b.setFonts(T(T({},b.getFonts()),x.getVariationsByIdentifier())),g.load().then(()=>{const f=_.getImagePaths().map(D=>({path:D,fullPath:this._ui.getAssetPath(D),image:null}));return b.loadImages(f).then(()=>(_.onImagesLoaded(),e.createTextDesign({position:r,rotation:o,flipHorizontally:s,flipVertically:n,text:a,color:pe.fromArray(l.rgba),width:h,seed:c,inverted:p,layout:_})))})}}yr.version="3.1.0";class br extends fr{_serializeTextDesign(e,t){const i=t.serializeOptions(["position","rotation","flipHorizontally","flipVertically","text","color","width","seed","inverted"],!0);i.color={rgba:i.color};const r=t.getLayout();return r&&(i.identifier=r.constructor.identifier),{type:"textdesign",options:i}}}br.version="3.1.0";class vr extends yr{_deserializeTextDesign(e,t){const{options:i}=t,{position:r,rotation:o,flipHorizontally:s,flipVertically:n,text:a,color:l,width:h,seed:c,inverted:p}=i;let{identifier:d}=i;d===U.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier?d=U.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier:d===U.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier&&(d=U.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier);const m="padding"in i?i.padding/h:-1,x=new Lt(this._ui,this._getOptions("textdesign")),b=new ot(this._ui,{fonts:we.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:g}=e.constructor.TextDesignSprite,y=this._ui.getFontLoader(),_=x.getLayoutByIdentifier(d),f=new _;return y.setFonts(b.getFonts()),g.setFonts(T(T({},g.getFonts()),b.getVariationsByIdentifier())),y.load().then(()=>{const D=f.getImagePaths().map(v=>({path:v,fullPath:this._ui.getAssetPath(v),image:null}));return g.loadImages(D).then(()=>(f.onImagesLoaded(),e.createTextDesign({position:r,rotation:o,flipHorizontally:s,flipVertically:n,text:a,color:pe.fromArray(l.rgba),width:h,seed:c,inverted:p,layout:f,padding:m})))})}}vr.version="3.2.0";class wr extends br{_serializeTextDesign(e,t){const i=t.serializeOptions(["position","rotation","flipHorizontally","flipVertically","text","color","width","seed","inverted","padding"],!0);i.color={rgba:i.color};const r=t.getLayout();return r&&(i.identifier=r.constructor.identifier),i.padding*=i.width,{type:"textdesign",options:i}}}wr.version="3.2.0";class Dr extends vr{_deserializeOperation(e){return super._deserializeOperation(e)}_deserializeOrientationOperation(e){const{options:t}=e,i=this._editor.operations.getOrCreate("orientation");return i?(i.set(t),Promise.resolve(i)):Promise.resolve()}}Dr.version="3.4.0";class Sr extends wr{_serializeOperation(e,t){switch(e.constructor.identifier){case"artfilter":return this._serializeStyle(e);default:return super._serializeOperation(e,t)}}_serializeOrientationOperation(e){return{type:"orientation",options:e.serializeOptions(["flipVertically","flipHorizontally","rotation"],!0)}}_serializeStyle(e){const{identifier:t,intensity:i,blendMode:r}=e.getOptions(),{tileEdgeLength:o,overlappingFactor:s}=e.getStyleTransferModel().getOptions();return{type:"artFilter",options:{identifier:t,intensity:i,blendMode:wo[r],tileEdgeLength:o,overlappingFactor:s}}}}Sr.version="3.4.0";class Er extends Dr{_deserializeTextDesign(e,t){const{options:i}=t,{position:r,rotation:o,flipHorizontally:s,flipVertically:n,text:a,color:l,width:h,seed:c,inverted:p,identifier:d}=i,m="padding"in i?i.padding/h:-1,x=new Lt(this._ui,this._getOptions("textdesign")),b=new ot(this._ui,{fonts:we.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0}),{AssetManager:g}=e.constructor.TextDesignSprite,y=this._ui.getFontLoader(),_=x.getLayoutByIdentifier(d),f=new _;return y.setFonts(b.getFonts()),g.setFonts(T(T({},g.getFonts()),b.getVariationsByIdentifier())),y.load().then(()=>{const D=f.getImagePaths().map(v=>({path:v,fullPath:this._ui.getAssetPath(v),image:null}));return g.loadImages(D).then(()=>(f.onImagesLoaded(),e.createTextDesign({position:r,rotation:o,flipHorizontally:s,flipVertically:n,text:a,color:pe.fromArray(l.rgba),width:h,seed:c,inverted:p,layout:f,padding:m})))})}}Er.version="3.5.0";class Rr extends Sr{}Rr.version="3.5.0";class Or extends Er{_deserializeAdjustmentsOperation(e){const{AdjustmentsOperation:t}=U.Operations;return super._deserializeAdjustmentsOperation(e).then(i=>{if(!i)return null;const{options:r}=e,o="sharpness",s={};if(typeof r[o]=="undefined")return;const{minValue:n,midValue:a,maxValue:l}=t.prototype.availableOptions[o];let h=r[o];return h=h<0?a+(a-n)*h:a+(l-a)*h,s[o]=h,i.set(s),i})}}Or.version="3.6.0";class Fr extends Rr{_serializeAdjustmentsOperation(e){const t=super._serializeAdjustmentsOperation(e),i="sharpness",{availableOptions:r}=e,o={},s=r[i],n=e.getOption(i),{minValue:a,midValue:l,maxValue:h}=s;return o[i]=n<=l?(n-a)/(l-a)-1:(n-l)/(h-l),t.options=T(T({},t.options),o),t}}Fr.version="3.6.0";class Ir extends Or{deserialize(){return this._validateVersion().then(()=>this._deserializeAssetLibrary()).then(()=>this._deserializeInputImage()).then(()=>this._deserializeOperations())}_deserializeAssetLibrary(){return new Promise((e,t)=>{const i=this._data;if(!i.assetLibrary){e();return}const{assets:r}=i.assetLibrary,o=[];for(const s in r)o.push(this._deserializeCustomAssets(s,r[s]));return Promise.all(o).then(()=>{e()}).catch(s=>{console.error(s),t(s)})})}_deserializeCustomAssets(e,t){switch(e){case"stickers":return this._deserializeCustomStickerAssets(t);default:return Promise.reject(new Error(`Unknown asset type: ${e}`))}}_deserializeCustomStickerAssets(e){let t="none";const i=this._editor.getOptions().editor;i&&i.controlsOptions&&i.controlsOptions.sticker&&(t=i.controlsOptions.sticker.customStickerTintMode||"none");const r=e.map(o=>new Promise((s,n)=>{const{identifier:a,raster:l}=o,h=o.svg!==void 0;let c=`data:${l.type};base64,${l.data}`,p=new Ve;p.onload=()=>{const d=this._editor.getSDK();p=d.correctExifOrientation(p),p.toDataURL&&(c=p.toDataURL());let m={data:"",width:1,height:1};m=this._stickerManager.renderStickerThumbnailFromImage(p);const x={identifier:a,defaultName:o.name||"",tintMode:t,images:{mediaBase:{uris:[c],rawData:!0,isSVG:h,width:p.width,height:p.height},mediaThumb:{uris:[m.data],rawData:!0,width:m.width,height:m.height}}};if(h){const b=`data:image/svg+xml;base64,${o.svg.data}`;x.images.mediaBase.uris.push(b)}s(x)},p.onerror=()=>{n(new Error(`Invalid base64 data: ${c}`))},p.src=c}));return Promise.all(r).then(o=>{const s=this._editor.getDynamicAssetsLibrary();s.setAssets("sticker",o),this._stickerManager.reload()})}}Ir.version="3.7.0";class Pr extends Fr{serialize(e={}){return super.serialize(e).then(t=>this._serializeAssetLibrary(t).then(i=>i))}_serializeAssetLibrary(e){if(!this._editor.getDynamicAssetsLibrary)return Promise.resolve(e);const t=this._editor.getDynamicAssetsLibrary(),i=this._serializeCustomStickerAssets(e,t);return i.length===0||(e.assetLibrary={assets:{stickers:i}}),Promise.resolve(e)}_serializeCustomStickerAssets(e,t){const i=t.getAssets("sticker");if(i.length===0)return[];const r=e.operations.filter(n=>n.type==="sprite").flatMap(n=>n.options.sprites).filter(n=>n.type==="sticker").map(n=>n.options.identifier),o={};r.forEach(n=>{o[n]=!0});const s=i.filter(n=>o[n.identifier]);return s.map(n=>{const{identifier:a,defaultName:l,images:h}=n,c=h.mediaBase.uris[0],{isSVG:p}=h.mediaBase,d=/^data:(image\/(jpeg|png));base64,(.*)$/g,m=d.exec(c),x=m[1],b=m[3],g={identifier:a,name:l,raster:{type:x,data:b}};return l&&(g.name=l),p&&(g.svg={data:h.mediaBase.uris[1].replace(/^data:image\/svg\+xml;base64,/g,"")}),g})}}Pr.version="3.7.0";class Mr extends Ir{}Mr.version="3.8.0";class Lr extends Pr{_serializeSticker(e,t){const i=super._serializeSticker(e,t);return i.options.tintMode=t.getTintMode(),i}}Lr.version="3.8.0";class ss extends Mr{_deserializeTransformOperation(e){return super._deserializeCropOperation(e).then(t=>{if(!t)return;const i=le.Array.find(this._data.operations,r=>r.type==="orientation");if(i){const{options:r}=i;t.rotate(r.rotation),r.flipHorizontally&&(t.flip("horizontal"),t.setRotation(t.getRotation()*-1)),r.flipVertically&&(t.flip("vertical"),t.setRotation(t.getRotation()*-1))}return t._ratio=null,t})}_deserializeText(e,t){const{options:i}=t,{fontSize:r,lineHeight:o,fontIdentifier:s,alignment:n,rotation:a,maxWidth:l,color:h,backgroundColor:c}=i,p=this._ui.getFontLoader();let d=this._fontManager.getVariationByIdentifier(s);return d?p.setFonts([d.getFont()]):d=this._fontManager.getDefaultVariation(),p.load().then(()=>{const m=e.getInputDimensions(!1),x=m.min(),b=m.x,g=m.y,y=l*x/b,_=r*x/g,f=e.createText({fontSize:_,lineHeight:o,fontFamily:d.getFontFamily(),fontWeight:d.getFontWeight(),fontIdentifier:d.getIdentifier(),textMetrics:d.getTextMetrics(),alignment:n,rotation:a,maxWidth:y,text:i.text,color:pe.fromArray(h.rgba),backgroundColor:pe.fromArray(c.rgba),position:se.fromObject(i.position)});return f._edited=!0,f})}}ss.version="3.9.0";const $c=Math.PI*2;class ns extends Lr{_serializeTransformOperation(e){const{operations:t}=this._editor;if(t.exists("orientation")){e=e.clone();const o=t.get("orientation");o.getFlipVertically()&&(e.flip("vertical"),e.setRotation(e.getRotation()*-1)),o.getFlipHorizontally()&&(e.flip("horizontal"),e.setRotation(e.getRotation()*-1)),e.rotate(-o.getRotation())}const i=e.serializeOptions(["start","end","rotation","textureScale"],!0);i.rotation=(i.rotation+$c)%$c,i.textureScale!==1&&(i.dimensions=e.getNewDimensions(e.getInputDimensions(!1))),delete i.textureScale;const r={type:"transform",options:i};if(e._ratio){let o;e._ratio instanceof To?o=e._ratio.getIdentifier():o=e._ratio.identifier,r.options.meta={identifier:o}}return delete r.options.scale,r}_serializeText(e,t){const i=e.getInputDimensions(!1),r=super._serializeText(e,t);return r.options.fontSize=r.options.fontSize*i.y/i.min(),r}}ns.version="3.9.0";class by extends Zo{constructor(e,t,i,r=!1){super();this._ui=e,this._options=t,this._mediator=i,this._shallow=r,r||(this._initSDK(),this.operations=new ol(this,this._sdk,this._mediator))}_initFonts(){const e=le.defaults(this._options.editor.controlsOptions.text,{additionalFonts:[],replaceFonts:!1,availableVariations:null});this._fontManager=new ot(this._ui,e);const t=this._fontManager.getFonts(),i=this._ui.getFontLoader();i.setFonts(t),i.load()}setImage(e=this._options.editor.image,t=!0){t&&this.reset();let i=null;i=this._sdk.parseExif(e),this._setImage(e,i),this._initWatermark()}_initWatermark(){this._options.editor.watermarkImage&&(this._watermarkOperation=this.operations.getOrCreate("watermark",{image:this._options.editor.watermarkImage}))}_initSDK(){const{logLevel:e,displayWelcomeMessage:t,debug:i,license:r,crossOrigin:o}=this._options,{smoothDownscaling:s,smoothUpscaling:n,preferredRenderer:a,pixelRatio:l,transparent:h,clearColor:c}=this._options.editor;let p;Array.isArray(c)?p=pe.fromArray(c):typeof c=="string"?p=pe.fromHex(c):c instanceof pe&&(p=c.clone());const d={logLevel:e,debug:i,displayWelcomeMessage:t,pixelRatio:l,smoothDownscaling:s,smoothUpscaling:n,transparent:h,crossOrigin:o,clearColor:p,license:r};this._sdk=new U(a,d)}getMaxMegapixels(){const{maxMegaPixels:e}=this._options.editor;return e}getCrossOrigin(){return le.getCrossOriginValue(this._options.crossOrigin||"anonymous")}getOutputDimensions(e=!1){return this._sdk.getOutputDimensions(e)}getOutputTextureDimensions(e=!1){return this._sdk.getOutputTextureDimensions(e)}getFinalDimensions(e=!1){return this._sdk.getFinalDimensions(e)}_setImage(e=this._options.editor.image,t=null){this._sdk.setAllOperationsToDirty(),this._options.editor.image=e,this._sdk.setImage(e,t)}_ensureImageIsResized(){const e=this._sdk.getImage(),t=this._sdk.getRenderer(),i=this.getMaxMegapixels(),r=i?i*1e6:null,o=t.getMaxDimensions(),s=new sl(e,r,o);return!this._resizedImage&&s.needsResize()?s.resize().then(({canvas:n,dimensions:a,reason:l})=>(this._resizedImage=n,this._sdk.setImage(n),n)):_o.resolve(e)}export(e=!1){return this._watermarkOperation&&this._watermarkOperation.setEnabled(!1),this._sdk.setAllOperationsToDirty(),this._ensureImageIsResized().then(t=>{const i=this._options.editor.export,r=new rl(this._sdk,i,e);return r.export().then(o=>(this.emit("export",o),this._mediator.emit(we.EVENTS.EXPORT,o,this),this._watermarkOperation&&(this._watermarkOperation.setEnabled(!0),this._sdk.render()),this._sdk.setAllOperationsToDirty(),o))})}broadcastTransform(e,t){const i=new U.Operations.TransformOperation.TransformChange(e,t),r=["sprite","selective-blur","radial-focus","mirrored-focus","linear-focus","blur"];r.forEach(o=>{const s=this.operations.get(o);if(!s)return;s.transform(i)})}broadcastFlip(e){const t=["mirrored-focus","radial-focus","linear-focus","sprite","selective-blur"];t.forEach(i=>{const r=this.operations.get(i);if(!r)return;r.flip(e)})}broadcastRotate(e){const t=["transform","mirrored-focus","linear-focus","radial-focus","sprite","selective-blur"];t.forEach(i=>{const r=this.operations.get(i);if(!r)return;r.rotate(e)})}_initSerializers(){this._serializers={"1.0.0":lr().default,"1.0.1":ur().default,"2.0.0":mr().default,"3.0.0":_r().default,"3.1.0":xr().default,"3.2.0":Tr().default,"3.4.0":Cr().default,"3.5.0":kr().default,"3.6.0":Ar().default,"3.7.0":Br().default,"3.8.0":Nr().default,"3.9.0":zr().default}}serialize(e={},t="3.9.0"){const i=this._serializers[t];if(!i)return _o.reject(new Error(`No serializer for version ${t} found.`));const r=new i(this);return r.serialize(e)}deserialize(e){const t=this._serializers[e.version];if(!t)return _o.reject(new Error(`No serializer for version ${e.version} found.`));const i=new t(this);return i.deserialize(e)}save(e=!1,t=!1){const i=this._options.editor.save;return this.serialize({image:t}).then(r=>{const o=JSON.stringify(r,null,2);if(e){const s=`data:text/json;charset=utf-8;base64,${window.encodeURI(window.btoa(o))}`;bo.downloadDataURL(s,i.fileBasename)}return o})}reset(){this._sdk.reset(),this.operations.reset()}dispose(){this.stop(),this._sdk.dispose()}getRenderer(){return this._sdk.getRenderer()}getSDK(){return this._sdk}getInputDimensions(){return this._sdk.getInputDimensions()}getImage(){return this._sdk.getImage()}getOptions(){return this._options}getUI(){return this._ui}getMediator(){return this._mediator}}var ep=by;const Do=e=>le.byteArrayToString(gn.decode(e));class Si extends Zo{constructor(e={}){super();this._mediator=new Zo,this._fontLoader=new ji(this),this._options=e,this._initOptions(),this._initEvents(),this._disposed=!1,this._isReady=!1,this._editor=new ep(this,this._options,this._mediator),this._options.editor.image&&this._editor.setImage(this._options.editor.image),this._mediator.once(we.EVENTS.EDITOR_READY,()=>{this._isReady=!0}),F.setLevel(this._options.logLevel),this._v()}export(...e){return this._editor.export(...e)}serialize(...e){return this._editor.serialize(...e)}deserialize(e){return this._editor.deserialize(e)}getEditor(){return this._editor}isReady(){return this._isReady}onReady(e){this._isReady?e():this._mediator.once(we.EVENTS.EDITOR_READY,e)}createFilter(e){const t=new Vt(this,this._getOptions("filter"));return t.instantiateFilterWithIdentifier(e)}getTextDesignLayoutByID(e){const t=new Lt(this,this._getOptions("textDesign"));return new(t.getLayoutByIdentifier(e))}getTextDesignAssetManager(){return U.Operations.SpriteOperation.TextDesignSprite.AssetManager}getTextDesignFontManager(){const e=new ot(this,{fonts:we.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:!0,isTextDesign:!0});return e}_getOptions(e){const t=this.getEditor(),{controls:i}=t;let r={};i&&i.get(e)&&(r=i.get(e).defaultOptions);const o=t.getOptions();return le.deepDefaults({},o.editor.controlsOptions[e]||{},r)}_initOptions(){if(this._options=le.defaults(this._options,{language:"en",logLevel:"warn",crossOrigin:"anonymous",editor:{},assets:{},responsive:!1,preloader:!0,autoRun:!0}),this._options.editor=le.defaults(this._options.editor||{},{enableZoom:!0,enableDrag:!0,enableExport:!0,enableKeyboardControls:!0,enablePositionSnapping:!0,enableRotationSnapping:!0,enableSave:!1,enableLoad:!1,pixelRatio:typeof window!="undefined"&&window.devicePixelRatio||1,preferredRenderer:"webgl",transparent:!0,clearColor:[0,0,0,0],displayResizeMessage:!0,maxMegaPixels:{},displayCloseButton:!1,undoMode:"global",defaultControl:"filter",forceCrop:!1,snappingOptions:{},tools:["transform","filter","adjustments","focus","text","textdesign","sticker","brush","frame","overlay","library","artfilter"],controlsOrder:[["library"],["artfilter","transform","filter","adjustments","focus"],["text","textdesign","sticker","brush","frame","overlay"]],operationsOrder:["exif-orientation","artfilter","orientation","transform","filter","adjustments","radial-focus","mirrored-focus","linear-focus","blur","selective-blur","overlay","sprite","frame","watermark"],controlsOptions:{focus:{highQualityCanvasBlur:!1}}}),this._options.editor.snappingOptions=le.defaults(this._options.editor.snappingOptions,{position:{},rotation:{}}),this._options.editor.snappingOptions.position=le.defaults(this._options.editor.snappingOptions.position,{padding:{},threshold:20}),this._options.editor.snappingOptions.position.padding=le.defaults(this._options.editor.snappingOptions.position.padding,{left:.1,right:.1,top:.1,bottom:.1}),this._options.editor.snappingOptions.rotation=le.defaults(this._options.editor.snappingOptions.rotation,{angles:[0,45,90,135,180,225,270,315],threshold:20}),this._options.editor.controlsOptions.focus=le.defaults(this._options.editor.controlsOptions.focus,{highQualityCanvasBlur:!1}),this._options.editor.maxMegaPixels=le.defaults(this._options.editor.maxMegaPixels,{mobile:5,desktop:10}),this._options.editor.export=le.defaults(this._options.editor.export||{},{format:"image/png",type:Ti.IMAGE,download:!0,fileBasename:"photoeditorsdk-export",quality:.8}),this._options.editor.save=le.defaults(this._options.editor.save||{},{format:"text/json",download:!0,fileBasename:"photoeditorsdk-save"}),this._options.extensions=le.defaults(this._options.extensions||{},{languages:{},operations:[],controls:[]}),this._options.assets=le.defaults(this._options.assets||{},{baseUrl:"assets",resolver:null}),!(this._options.editor.image instanceof window.Image)){const e=new window.Image;this._options.editor.image&&(e.src=this._options.editor.image,this._options.editor.image=e)}}_v(){return this[Do("X29wdGlvbnM=")][Do("bGljZW5zZQ==")]?!0:(F.error(Do("TGljZW5zaW5n"),Do("Tm8gYGxpY2Vuc2VgIG9wdGlvbiBnaXZlbg==")),F.error(Do("TGljZW5zaW5n"),Do("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),!1)}_initEvents(){this._mediator.pipeEvents(this)}_disposeEvents(){this._mediator.unpipeEvents(this)}setImage(e){this._editor.setImage(e)}getAssetPath(e,t=!1,i=!1){let{baseUrl:r,resolver:o}=this._options.assets,s=`${r}/${e}`;o=o||(h=>h),e.match(/(ftp|http|https):\/\//)&&(s=e);const n=e.replace(/assets\//,"").split("/"),a=n[0];let l={};switch(a){case"art-filters":return l={identifier:n[1],type:n[2].split(".")[0]},o("art-filter",l);case"filters":return l={identifier:n[1].replace(/\.png$/g,"")},o("filter",l);case"fonts":return l={identifier:n[1].replace(/\.(woff|otf|ttf)$/g,"")},o("font",l);case"frames":return l={identifier:n[1],filename:n[2]},o("frame",l);case"overlays":return l={identifier:n[1].replace(/\.(png|jpg|jpeg)$/g,"")},o("overlay",l);case"stickers":{const h=n[3].endsWith(".svg"),c=n[3]==="thumbs";return l={category:n[1],identifier:(h?n[3]:n[4]).replace(/\.(png|svg)$/g,""),variant:h?"svg":c?"thumb":"base"},o("sticker",l)}case"text-design":return l={type:n[1]==="fonts"?"font":"image",identifier:n[2].replace(/\.(png|otf|ttf|woff2?)$/g,"")},o("text-design",l)}return typeof o!="undefined"&&o!==null&&(s=o(s)),s}getFontLoader(){return this._fontLoader}dispose(){if(this._disposed)throw new Error("This instance of PhotoEditorSDK is already disposed.");this._disposed=!0,this._disposeEvents()}render(e){return this.deserialize(e).then(()=>this.export())}}Si.prototype.identifier="engine-wrapper";Si.Constants=we;Si.Events=we.EVENTS;Si.Utils=rt;Si.JSONLoader=Ft;Si.SDK=U;const tp=()=>window&&window.navigator&&window.navigator.userAgent||"",ip=(e=tp())=>e.indexOf("Edge")!==-1,bn=(e=tp())=>!!e.match(/msie|trident/i);const v3=new RegExp(/\uD83D\uDC68\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D\uD83D\uDC68|\uD83D\uDC69\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|\uD83D\uDC68\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFE])|\uD83D\uDC68\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83D\uDC68\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83D\uDC68\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83D\uDC68\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFC-\uDFFF])|\uD83D\uDC69(?:\u200D\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFE])|\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFC-\uDFFF]))|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68\u200D(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC68\u200D\u2764\uFE0F\u200D\uD83D\uDC68|\uD83D\uDC69\u200D\u2764\uFE0F\u200D(?:\uD83D[\uDC68\uDC69])|\uD83E\uDDD1\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC68(?:\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|(?:\uD83D[\uDC67-\uDC69])\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]\uFE0F)|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83C\uDFF3\uFE0F\u200D\u26A7|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642])\uFE0F|(?:\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF]))\u200D[\u2695\u2696\u2708]\uFE0F|\uD83D\uDC69\u200D(?:\uD83D[\uDC67\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83D\uDC3B\u200D\u2744|\uD83C\uDFF4\u200D\u2620|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E-\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3C-\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDF])\u200D[\u2640\u2642])\uFE0F|\uD83E\uDDD1\u200D[\u2695\u2696\u2708]\uFE0F|(?:\uD83D[\uDC68\uDC69])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u200D[\u2695\u2696\u2708]\uFE0F)|\uD83D\uDC15\u200D\uD83E\uDDBA|\uD83D\uDC08\u200D\u2B1B|\uD83E\uDDD1\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDC66\uDC67\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|(?:[\u270A\u270B]|\uD83C[\uDF85\uDFC3\uDFC7]|\uD83D[\uDC43\uDC4A-\uDC4C\uDC4F\uDC50\uDC66-\uDC69\uDC6B-\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD7A\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDD77\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u26F9\u270C\u270D]|\uD83C[\uDFC2\uDFC4\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC46-\uDC49\uDC4D\uDC4E\uDD74\uDD75\uDD90])(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])|(?:[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9\u23EA\u23ED-\u23EF\u23F1-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7\u26F8\u26FA\u26FD\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2753\u2757\u2763\u2764\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE1A\uDE2F\uDE37\uDF0D-\uDF0F\uDF15\uDF1C\uDF21\uDF24-\uDF2C\uDF36\uDF78\uDF7D\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFA7\uDFAC-\uDFAE\uDFC6\uDFCD\uDFCE\uDFD4-\uDFE0\uDFED\uDFF3\uDFF5\uDFF7]|\uD83D[\uDC08\uDC15\uDC1F\uDC26\uDC3F\uDC41\uDC53\uDC6A\uDC7D\uDCA3\uDCB0\uDCB3\uDCBB\uDCBF\uDCCB\uDCDA\uDCDF\uDCE4-\uDCE6\uDCEA-\uDCED\uDCF7\uDCF9-\uDCFB\uDCFD\uDD08\uDD0D\uDD12\uDD13\uDD49\uDD4A\uDD50-\uDD67\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDE10\uDE87\uDE8D\uDE91\uDE94\uDE98\uDEAD\uDEB2\uDEB9\uDEBA\uDEBC\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3])\uFE0F|[\u23E9-\u23F3\u23F8-\u23FA\u25FB-\u25FE\u2614\u2615\u267F\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26C8\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6]/g);const gl=e=>{try{return new URL(e),!0}catch(t){return!1}};const xy=[{identifier:"basics",name:"Basics",items:[{identifier:Xe.BRIGHTNESS},{identifier:Xe.CONTRAST},{identifier:Xe.SATURATION},{identifier:Xe.GAMMA}]},{identifier:"refinements",name:"Refinements",items:[{identifier:Xe.CLARITY},{identifier:Xe.SHADOWS},{identifier:Xe.HIGHLIGHTS},{identifier:Xe.EXPOSURE},{identifier:Xe.BLACKS},{identifier:Xe.WHITES},{identifier:Xe.TEMPERATURE},{identifier:Xe.SHARPNESS}]}];var xn=xy;const vy=[{identifier:Ut.DuoTone,name:"DuoTone",thumbnailURI:"./categories/duotone.jpg",items:[{identifier:B.Desert,name:"Desert",thumbnailURI:"./items/imgly_duotone_desert.jpg",lightColor:"#e1de9a",darkColor:"#cb2129",defaultIntensity:.5},{identifier:B.Peach,name:"Peach",thumbnailURI:"./items/imgly_duotone_peach.jpg",lightColor:"#e9abb8",darkColor:"#0040ff",defaultIntensity:.5},{identifier:B.Clash,name:"Clash",thumbnailURI:"./items/imgly_duotone_clash.jpg",lightColor:"#f41a0f",darkColor:"#23007c",defaultIntensity:.5},{identifier:B.Plum,name:"Plum",thumbnailURI:"./items/imgly_duotone_plum.jpg",lightColor:"#74d7ff",darkColor:"#23007c",defaultIntensity:.5},{identifier:B.Breezy,name:"Breezy",thumbnailURI:"./items/imgly_duotone_breezy.jpg",lightColor:"#68fdff",darkColor:"#c20000",defaultIntensity:.5},{identifier:B.DeepBlue,name:"Deep Blue",thumbnailURI:"./items/imgly_duotone_deepblue.jpg",lightColor:"#2de9eb",darkColor:"#58007c",defaultIntensity:.5},{identifier:B.Frog,name:"Frog",thumbnailURI:"./items/imgly_duotone_frog.jpg",lightColor:"#5bff60",darkColor:"#7f23a9",defaultIntensity:.5},{identifier:B.Sunset,name:"Sunset",thumbnailURI:"./items/imgly_duotone_sunset.jpg",lightColor:"#f8ea46",darkColor:"#c400be",defaultIntensity:.5}]},{identifier:Ut.BW,name:"B & W",thumbnailURI:"./categories/b&w.jpg",items:[{identifier:B.AD1920,name:"1920 A.D.",thumbnailURI:"./items/imgly_lut_ad1920.jpg",lutURI:"./items/imgly_lut_ad1920_5_5_128.png",defaultIntensity:1},{identifier:B.Greyed,name:"Greyed",thumbnailURI:"./items/imgly_lut_bw.jpg",lutURI:"./items/imgly_lut_bw_5_5_128.png",defaultIntensity:1},{identifier:B.Dusty,name:"Dusty",thumbnailURI:"./items/imgly_lut_x400.jpg",lutURI:"./items/imgly_lut_dusty_5_5_128.png",defaultIntensity:1},{identifier:B.Litho,name:"Litho",thumbnailURI:"./items/imgly_lut_litho.jpg",lutURI:"./items/imgly_lut_litho_5_5_128.png",defaultIntensity:1},{identifier:B.Sepia,name:"Sepia",thumbnailURI:"./items/imgly_lut_sepiahigh.jpg",lutURI:"./items/imgly_lut_sepia_5_5_128.png",defaultIntensity:1},{identifier:B.Weathered,name:"Weathered",thumbnailURI:"./items/imgly_lut_plate.jpg",lutURI:"./items/imgly_lut_weathered_5_5_128.png",defaultIntensity:1},{identifier:B.HardStuff,name:"Hard Stuff",thumbnailURI:"./items/imgly_lut_sin.jpg",lutURI:"./items/imgly_lut_hard_stuff_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8}]},{identifier:Ut.Vintage,name:"Vintage",thumbnailURI:"./categories/vintage.jpg",items:[{identifier:B.Polaroid,name:"Polaroid",thumbnailURI:"./items/imgly_lut_blues.jpg",lutURI:"./items/imgly_lut_polaroid_5_5_128.png",defaultIntensity:1},{identifier:B.Sunny70s,name:"Sunny 70s",thumbnailURI:"./items/imgly_lut_front.jpg",lutURI:"./items/imgly_lut_sunny_70s_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:B.Oldtimer,name:"Oldtimer",thumbnailURI:"./items/imgly_lut_texas.jpg",lutURI:"./items/imgly_lut_oldtimer_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:B.Inferno,name:"Inferno",thumbnailURI:"./items/imgly_lut_celsius.jpg",lutURI:"./items/imgly_lut_inferno_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:B.Snappy,name:"Snappy",thumbnailURI:"./items/imgly_lut_cool.jpg",lutURI:"./items/imgly_lut_snappy_5_5_128.png",defaultIntensity:1}]},{identifier:Ut.Smooth,name:"Smooth",thumbnailURI:"./categories/smooth.jpg",items:[{identifier:B.Chestnut,name:"Chestnut",thumbnailURI:"./items/imgly_lut_chest.jpg",lutURI:"./items/imgly_lut_chestnut_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:B.Softy,name:"Softy",thumbnailURI:"./items/imgly_lut_winter.jpg",lutURI:"./items/imgly_lut_softly_5_5_128.png",defaultIntensity:1},{identifier:B.Pebble,name:"Pebble",thumbnailURI:"./items/imgly_lut_kdynamic.jpg",lutURI:"./items/imgly_lut_pebble_5_5_128.png",defaultIntensity:1},{identifier:B.Moss,name:"Moss",thumbnailURI:"./items/imgly_lut_fall.jpg",lutURI:"./items/imgly_lut_moss_5_5_128.png",defaultIntensity:1},{identifier:B.Lemon,name:"Lemon",thumbnailURI:"./items/imgly_lut_lenin.jpg",lutURI:"./items/imgly_lut_lemon_5_5_128.png",defaultIntensity:1},{identifier:B.GreenGap,name:"Green Gap",thumbnailURI:"./items/imgly_lut_pola669.jpg",lutURI:"./items/imgly_lut_green_gap_5_5_128.png",defaultIntensity:1}]},{identifier:Ut.Cold,name:"Cold",thumbnailURI:"./categories/cold.jpg",items:[{identifier:B.Colla,name:"Colla",thumbnailURI:"./items/imgly_lut_elder.jpg",lutURI:"./items/imgly_lut_colla_5_5_128.png",defaultIntensity:1},{identifier:B.Solanus,name:"Solanus",thumbnailURI:"./items/imgly_lut_orchid.jpg",lutURI:"./items/imgly_lut_solanus_5_5_128.png",defaultIntensity:1},{identifier:B.Kalmen,name:"Kalmen",thumbnailURI:"./items/imgly_lut_bleached.jpg",lutURI:"./items/imgly_lut_kalmen_5_5_128.png",defaultIntensity:1},{identifier:B.Joran,name:"Joran",thumbnailURI:"./items/imgly_lut_bleachedblue.jpg",lutURI:"./items/imgly_lut_joran_5_5_128.png",defaultIntensity:1},{identifier:B.Levante,name:"Levante",thumbnailURI:"./items/imgly_lut_breeze.jpg",lutURI:"./items/imgly_lut_levante_5_5_128.png",defaultIntensity:1},{identifier:B.Zephyr,name:"Zephyr",thumbnailURI:"./items/imgly_lut_blueshadows.jpg",lutURI:"./items/imgly_lut_zephyr_5_5_128.png",defaultIntensity:1}]},{identifier:Ut.Warm,name:"Warm",thumbnailURI:"./categories/warm.jpg",items:[{identifier:B.Golden,name:"Golden",thumbnailURI:"./items/imgly_lut_sunset.jpg",lutURI:"./items/imgly_lut_golden_5_5_128.png",defaultIntensity:1},{identifier:B.LowFire,name:"Low Fire",thumbnailURI:"./items/imgly_lut_eighties.jpg",lutURI:"./items/imgly_lut_low_fire_5_5_128.png",defaultIntensity:1},{identifier:B.Sunrise,name:"Sunrise",thumbnailURI:"./items/imgly_lut_evening.jpg",lutURI:"./items/imgly_lut_sunrise_5_5_128.png",defaultIntensity:1},{identifier:B.FlatBlack,name:"Flat Black",thumbnailURI:"./items/imgly_lut_k2.jpg",lutURI:"./items/imgly_lut_flat_black_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:B.Pumpkin,name:"Pumpkin",thumbnailURI:"./items/imgly_lut_nogreen.jpg",lutURI:"./items/imgly_lut_pumpkin_5_5_128.png",defaultIntensity:1}]},{identifier:Ut.Legacy,name:"Legacy",thumbnailURI:"./categories/legacy.jpg",items:[{identifier:B.Ancient,name:"Ancient",thumbnailURI:"./items/imgly_lut_ancient.jpg",lutURI:"./items/imgly_lut_ancient_5_5_128.png",defaultIntensity:1},{identifier:B.Candy,name:"Candy",thumbnailURI:"./items/imgly_lut_cottoncandy.jpg",lutURI:"./items/imgly_lut_cottoncandy_5_5_128.png",defaultIntensity:1},{identifier:B.Classic,name:"Classic",thumbnailURI:"./items/imgly_lut_classic.jpg",lutURI:"./items/imgly_lut_classic_5_5_128.png",defaultIntensity:1},{identifier:B.Colorful,name:"Colorful",thumbnailURI:"./items/imgly_lut_colorful.jpg",lutURI:"./items/imgly_lut_colorful_5_5_128.png",defaultIntensity:1},{identifier:B.Creamy,name:"Creamy",thumbnailURI:"./items/imgly_lut_creamy.jpg",lutURI:"./items/imgly_lut_creamy_5_5_128.png",defaultIntensity:1},{identifier:B.Fixie,name:"Fixie",thumbnailURI:"./items/imgly_lut_fixie.jpg",lutURI:"./items/imgly_lut_fixie_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:B.Food,name:"Food",thumbnailURI:"./items/imgly_lut_food.jpg",lutURI:"./items/imgly_lut_food_5_5_128.png",defaultIntensity:1},{identifier:B.Fridge,name:"Fridge",thumbnailURI:"./items/imgly_lut_fridge.jpg",lutURI:"./items/imgly_lut_fridge_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:B.Glam,name:"Glam",thumbnailURI:"./items/imgly_lut_glam.jpg",lutURI:"./items/imgly_lut_glam_5_5_128.png",defaultIntensity:1},{identifier:B.Gobblin,name:"Gobblin",thumbnailURI:"./items/imgly_lut_gobblin.jpg",lutURI:"./items/imgly_lut_gobblin_5_5_128.png",defaultIntensity:1},{identifier:B.Hicon,name:"Hicon",thumbnailURI:"./items/imgly_lut_highcontrast.jpg",lutURI:"./items/imgly_lut_highcontrast_5_5_128.png",defaultIntensity:1},{identifier:B.HighCarb,name:"High Carb",thumbnailURI:"./items/imgly_lut_highcarb.jpg",lutURI:"./items/imgly_lut_highcarb_5_5_128.png",defaultIntensity:1},{identifier:B.K1,name:"K1",thumbnailURI:"./items/imgly_lut_k1.jpg",lutURI:"./items/imgly_lut_k1_5_5_128.png",defaultIntensity:1},{identifier:B.K6,name:"K6",thumbnailURI:"./items/imgly_lut_k6.jpg",lutURI:"./items/imgly_lut_k6_5_5_128.png",defaultIntensity:1},{identifier:B.Keen,name:"Keen",thumbnailURI:"./items/imgly_lut_keen.jpg",lutURI:"./items/imgly_lut_keen_5_5_128.png",defaultIntensity:1},{identifier:B.Lomo,name:"Lomo",thumbnailURI:"./items/imgly_lut_lomo.jpg",lutURI:"./items/imgly_lut_lomo_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:B.Lomo100,name:"Lomo 100",thumbnailURI:"./items/imgly_lut_lomo100.jpg",lutURI:"./items/imgly_lut_lomo100_5_5_128.png",defaultIntensity:1},{identifier:B.Lucid,name:"Lucid",thumbnailURI:"./items/imgly_lut_lucid.jpg",lutURI:"./items/imgly_lut_lucid_5_5_128.png",defaultIntensity:1},{identifier:B.Mellow,name:"Mellow",thumbnailURI:"./items/imgly_lut_mellow.jpg",lutURI:"./items/imgly_lut_mellow_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:B.Neat,name:"Neat",thumbnailURI:"./items/imgly_lut_neat.jpg",lutURI:"./items/imgly_lut_neat_5_5_128.png",defaultIntensity:1},{identifier:B.Pale,name:"Pale",thumbnailURI:"./items/imgly_lut_pale.jpg",lutURI:"./items/imgly_lut_pale_5_5_128.png",defaultIntensity:1},{identifier:B.Pitched,name:"Pitched",thumbnailURI:"./items/imgly_lut_pitched.jpg",lutURI:"./items/imgly_lut_pitched_5_5_128.png",defaultIntensity:1},{identifier:B.PolaSX,name:"Pola SX",thumbnailURI:"./items/imgly_lut_polasx.jpg",lutURI:"./items/imgly_lut_polasx_5_5_128.png",defaultIntensity:1},{identifier:B.Pro400,name:"Pro 400",thumbnailURI:"./items/imgly_lut_pro400.jpg",lutURI:"./items/imgly_lut_pro400_5_5_128.png",defaultIntensity:1},{identifier:B.Quozi,name:"Quozi",thumbnailURI:"./items/imgly_lut_quozi.jpg",lutURI:"./items/imgly_lut_quozi_5_5_128.png",defaultIntensity:1},{identifier:B.Settled,name:"Settled",thumbnailURI:"./items/imgly_lut_settled.jpg",lutURI:"./items/imgly_lut_settled_5_5_128.png",defaultIntensity:1},{identifier:B.Seventies,name:"Seventies",thumbnailURI:"./items/imgly_lut_seventies.jpg",lutURI:"./items/imgly_lut_seventies_5_5_128.png",defaultIntensity:1},{identifier:B.Soft,name:"Soft",thumbnailURI:"./items/imgly_lut_soft.jpg",lutURI:"./items/imgly_lut_soft_5_5_128.png",defaultIntensity:1},{identifier:B.Steel,name:"Steel",thumbnailURI:"./items/imgly_lut_steel.jpg",lutURI:"./items/imgly_lut_steel_5_5_128.png",defaultIntensity:1},{identifier:B.Summer,name:"Summer",thumbnailURI:"./items/imgly_lut_summer.jpg",lutURI:"./items/imgly_lut_summer_5_5_128.png",defaultIntensity:1},{identifier:B.Tender,name:"Tender",thumbnailURI:"./items/imgly_lut_tender.jpg",lutURI:"./items/imgly_lut_tender_5_5_128.png",defaultIntensity:1},{identifier:B.Twilight,name:"Twilight",thumbnailURI:"./items/imgly_lut_twilight.jpg",lutURI:"./items/imgly_lut_twilight_5_5_128.png",defaultIntensity:1}]}];var vn=vy;const wy=[{identifier:Ri.RADIAL,thumbnailURI:"./items/radial.png"},{identifier:Ri.MIRRORED,thumbnailURI:"./items/mirrored.png"},{identifier:Ri.LINEAR,thumbnailURI:"./items/linear.png"},{identifier:Ri.GAUSSIAN,thumbnailURI:"./items/gaussian.png"}];var fl=wy;const Ty=[{identifier:"imgly_font_open_sans_bold",fontFamily:"Open Sans",fontWeight:"bold",fontURI:"./fonts/imgly_font_open_sans_bold.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}},{identifier:"imgly_font_aleo_bold",fontFamily:"Aleo",fontWeight:"bold",fontURI:"./fonts/imgly_font_aleo_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:805,descender:-195}},{identifier:"imgly_font_amaticsc",fontFamily:"Amatic SC",fontWeight:"normal",fontURI:"./fonts/imgly_font_amaticsc.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1016,descender:-245}},{identifier:"imgly_font_archivo_black",fontFamily:"Archivo",fontWeight:"normal",fontURI:"./fonts/imgly_font_archivo_black.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:878,descender:-210}},{identifier:"imgly_font_bungee_inline",fontFamily:"Bungee Inline",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_bungee_inline.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}},{identifier:"imgly_font_fira_sans_regular",fontFamily:"Fira Sans",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_fira_sans_regular.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:935,descender:-265}},{identifier:"imgly_font_campton_bold",fontFamily:"Campton Book",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_campton_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}},{identifier:"imgly_font_carter_one",fontFamily:"Carter One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_carter_one.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2264,descender:-890}},{identifier:"imgly_font_codystar",fontFamily:"Codystar",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_codystar.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:953,descender:-255}},{identifier:"imgly_font_galano_grotesque_bold",fontFamily:"Galano Grotesque",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_galano_grotesque_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}},{identifier:"imgly_font_krona_one",fontFamily:"Krona One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_krona_one.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2030,descender:-530}},{identifier:"imgly_font_kumar_one_outline",fontFamily:"Kumar One Outline",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_kumar_one_outline.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1137,descender:-642}},{identifier:"imgly_font_lobster",fontFamily:"Lobster",fontWeight:"normal",fontURI:"./fonts/imgly_font_lobster.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1e3,descender:-250}},{identifier:"imgly_font_molle",fontFamily:"Molle",fontWeight:"normal",fontStyle:"italic",fontURI:"./fonts/imgly_font_molle.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1852,descender:-701}},{identifier:"imgly_font_monoton",fontFamily:"Monoton",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_monoton.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2366,descender:-822}},{identifier:"imgly_font_nixie_one",fontFamily:"Nixie One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_nixie_one.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:926,descender:-210}},{identifier:"imgly_font_notable",fontFamily:"Notable",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_notable.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1143,descender:-157}},{identifier:"imgly_font_ostrich_sans_black",fontFamily:"Ostrich",fontWeight:800,fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_black.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontFamily:"Ostrich",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_oswald_semi_bold",fontFamily:"Oswald SemiBold",googleFamily:"Oswald",fontWeight:600,fontStyle:"normal",fontURI:"./fonts/imgly_font_oswald_semi_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1193,descender:-289}},{identifier:"imgly_font_palanquin_dark_semi_bold",fontFamily:"Palanquin Dark SemiBold",googleFamily:"Palanquin Dark",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_palanquin_dark_semi_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1320,descender:-491}},{identifier:"imgly_font_poppins",fontFamily:"Poppins",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_poppins.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1050,descender:-350}},{identifier:"imgly_font_permanent_marker",fontFamily:"Permanent Marker",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_permanent_marker.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}},{identifier:"imgly_font_roboto_black_italic",fontFamily:"Roboto Black",fontWeight:"bold",fontStyle:"italic",googleFamily:"Roboto",fontURI:"./fonts/imgly_font_roboto_black_italic.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light_italic",fontFamily:"Roboto Light",googleFamily:"Roboto",fontWeight:300,fontStyle:"italic",fontURI:"./fonts/imgly_font_roboto_light_italic.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_sancreek",fontFamily:"Sancreek",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_sancreek.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2104,descender:-738}},{identifier:"imgly_font_stint_ultra_expanded",fontFamily:"Stint Ultra Expanded",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_stint_ultra_expanded.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1853,descender:-483}},{identifier:"imgly_font_trash_hand",fontFamily:"Trash Hand",fontWeight:"normal",fontURI:"./fonts/imgly_font_trash_hand.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:759,descender:-304}},{identifier:"imgly_font_vt323",fontFamily:"VT323",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_vt323.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}},{identifier:"imgly_font_yeseva_one",fontFamily:"Yeseva One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_yeseva_one.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:915,descender:-240}},{identifier:"imgly_font_abril_fatface_regular",fontFamily:"Abril Fatface",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_abril_fatface_regular.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1058,descender:-291}},{identifier:"imgly_font_amberlight",fontFamily:"Amberlight",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_amberlight.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:750,descender:-250}},{identifier:"imgly_font_montserrat_light",fontFamily:"Montserrat Light",googleFamily:"Montserrat",fontWeight:300,fontStyle:"normal",fontURI:"./fonts/imgly_font_montserrat_light.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:968,descender:-251}},{identifier:"imgly_font_handycheera_regular",fontFamily:"Handycheera",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_handycheera_regular.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2199,descender:-808}},{identifier:"imgly_font_ostrich_sans_heavy",fontFamily:"Ostrich",fontWeight:900,fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_heavy.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:674,descender:0}},{identifier:"imgly_font_petit_formal_script",fontFamily:"Petit Formal Script",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_petit_formal_script.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2033,descender:-527}},{identifier:"imgly_font_rasa_500",fontFamily:"Rasa",fontWeight:500,fontStyle:"normal",fontURI:"./fonts/imgly_font_rasa_500.woff",format:"woff",textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_rasa_regular",fontFamily:"Rasa",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_rasa_regular.woff",format:"woff",textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_roboto_black",fontFamily:"Roboto Black",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_roboto_black.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light",fontFamily:"Roboto Light",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_roboto_light.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_sue_ellen_francisco",fontFamily:"Sue Ellen Francisco",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_sue_ellen_francisco.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:1362,descender:-634}},{identifier:"imgly_font_ultra",fontFamily:"Ultra",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_ultra.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2066,descender:-561}},{identifier:"imgly_font_wolesbro",fontFamily:"Wolesbro",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_wolesbro.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:925,descender:-575}}];var wn=Ty;const rp=["imgly_font_open_sans_bold","imgly_font_aleo_bold","imgly_font_amaticsc","imgly_font_archivo_black","imgly_font_bungee_inline","imgly_font_campton_bold","imgly_font_carter_one","imgly_font_codystar","imgly_font_fira_sans_regular","imgly_font_galano_grotesque_bold","imgly_font_krona_one","imgly_font_kumar_one_outline","imgly_font_lobster","imgly_font_molle","imgly_font_monoton","imgly_font_nixie_one","imgly_font_notable","imgly_font_ostrich_sans_black","imgly_font_ostrich_sans_bold","imgly_font_oswald_semi_bold","imgly_font_palanquin_dark_semi_bold","imgly_font_poppins","imgly_font_permanent_marker","imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_sancreek","imgly_font_stint_ultra_expanded","imgly_font_trash_hand","imgly_font_vt323","imgly_font_yeseva_one"],op=["imgly_font_abril_fatface_regular","imgly_font_amberlight","imgly_font_bungee_inline","imgly_font_campton_bold","imgly_font_galano_grotesque_bold","imgly_font_handycheera_regular","imgly_font_montserrat_light","imgly_font_ostrich_sans_black","imgly_font_ostrich_sans_bold","imgly_font_ostrich_sans_heavy","imgly_font_permanent_marker","imgly_font_petit_formal_script","imgly_font_rasa_500","imgly_font_rasa_regular","imgly_font_roboto_black","imgly_font_roboto_light","imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_sue_ellen_francisco","imgly_font_ultra","imgly_font_wolesbro"];const Dy=[{identifier:"imgly_frame_dia",name:"Dia",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"./items/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"./items/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"./items/imgly_frame_dia/imgly_frame_dia_left.png",end:"./items/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"./items/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"./items/imgly_frame_dia/imgly_frame_dia_right.png",end:"./items/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"./items/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",name:"Art Decor",tintable:!0,layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",name:"Black Passepartout",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",name:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",name:"Low Poly",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}}];var Tn=Dy;const Sy=[{identifier:"imgly_overlay_golden",name:"Golden",defaultBlendMode:oe.LIGHTEN,overlayURI:"./items/imgly_overlay_golden.jpg",thumbnailURI:"./items/imgly_overlay_golden_thumb.jpg"},{identifier:"imgly_overlay_lightleak1",name:"Lightleak",defaultBlendMode:oe.SCREEN,overlayURI:"./items/imgly_overlay_lightleak1.jpg",thumbnailURI:"./items/imgly_overlay_lightleak1_thumb.jpg"},{identifier:"imgly_overlay_rain",name:"Rain",defaultBlendMode:oe.OVERLAY,overlayURI:"./items/imgly_overlay_rain.jpg",thumbnailURI:"./items/imgly_overlay_rain_thumb.jpg"},{identifier:"imgly_overlay_mosaic",name:"Mosaic",defaultBlendMode:oe.MULTIPLY,overlayURI:"./items/imgly_overlay_mosaic.jpg",thumbnailURI:"./items/imgly_overlay_mosaic_thumb.jpg"},{identifier:"imgly_overlay_vintage",name:"Vintage",defaultBlendMode:oe.DARKEN,overlayURI:"./items/imgly_overlay_vintage.jpg",thumbnailURI:"./items/imgly_overlay_vintage_thumb.jpg"},{identifier:"imgly_overlay_paper",name:"Paper",defaultBlendMode:oe.MULTIPLY,overlayURI:"./items/imgly_overlay_paper.jpg",thumbnailURI:"./items/imgly_overlay_paper_thumb.jpg"},{identifier:"imgly_overlay_bokeh",name:"Bokeh",defaultBlendMode:oe.LIGHTEN,overlayURI:"./items/imgly_overlay_bokeh.jpg",thumbnailURI:"./items/imgly_overlay_bokeh_thumb.jpg"},{identifier:"imgly_overlay_hearts",name:"Hearts",defaultBlendMode:oe.SCREEN,overlayURI:"./items/imgly_overlay_hearts.jpg",thumbnailURI:"./items/imgly_overlay_hearts_thumb.jpg"},{identifier:"imgly_overlay_lightleak2",name:"Lightleak 2",defaultBlendMode:oe.LIGHTEN,overlayURI:"./items/imgly_overlay_lightleak2.jpg",thumbnailURI:"./items/imgly_overlay_lightleak2_thumb.jpg"},{identifier:"imgly_overlay_wood",name:"Wood",defaultBlendMode:oe.MULTIPLY,overlayURI:"./items/imgly_overlay_wood.jpg",thumbnailURI:"./items/imgly_overlay_wood_thumb.jpg"},{identifier:"imgly_overlay_chop",name:"Chop",defaultBlendMode:oe.MULTIPLY,overlayURI:"./items/imgly_overlay_chop.jpg",thumbnailURI:"./items/imgly_overlay_chop_thumb.jpg"},{identifier:"imgly_overlay_metal",name:"Metal",defaultBlendMode:oe.OVERLAY,overlayURI:"./items/imgly_overlay_metal.jpg",thumbnailURI:"./items/imgly_overlay_metal_thumb.jpg"},{identifier:"imgly_overlay_painting",name:"Painting",defaultBlendMode:oe.OVERLAY,overlayURI:"./items/imgly_overlay_painting.jpg",thumbnailURI:"./items/imgly_overlay_painting_thumb.jpg"},{identifier:"imgly_overlay_grain",name:"Grain",defaultBlendMode:oe.OVERLAY,overlayURI:"./items/imgly_overlay_grain.jpg",thumbnailURI:"./items/imgly_overlay_grain_thumb.jpg"},{identifier:"imgly_overlay_clouds",name:"Clouds",defaultBlendMode:oe.SOFT_LIGHT,overlayURI:"./items/imgly_overlay_clouds.jpg",thumbnailURI:"./items/imgly_overlay_clouds_thumb.jpg"},{identifier:"imgly_overlay_wall1",name:"Wall",defaultBlendMode:oe.LIGHTEN,overlayURI:"./items/imgly_overlay_wall1.jpg",thumbnailURI:"./items/imgly_overlay_wall1_thumb.jpg"},{identifier:"imgly_overlay_wall2",name:"Wall 2",defaultBlendMode:oe.OVERLAY,overlayURI:"./items/imgly_overlay_wall2.jpg",thumbnailURI:"./items/imgly_overlay_wall2_thumb.jpg"}];var Dn=Sy;const Cy=[{identifier:"imgly_sticker_emoticons",name:"Emoticons",thumbnailURI:"./categories/emoticons.png",items:[{identifier:"imgly_sticker_emoticons_grin",stickerURI:"./emoticons/imgly_sticker_emoticons_grin.svg",tintMode:"none",name:"Grin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_laugh",stickerURI:"./emoticons/imgly_sticker_emoticons_laugh.svg",tintMode:"none",name:"Laugh",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_smile",stickerURI:"./emoticons/imgly_sticker_emoticons_smile.svg",tintMode:"none",name:"Smile",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wink",stickerURI:"./emoticons/imgly_sticker_emoticons_wink.svg",tintMode:"none",name:"Wink",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_tongue_out_wink",stickerURI:"./emoticons/imgly_sticker_emoticons_tongue_out_wink.svg",tintMode:"none",name:"Tongue out wink",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_angel",stickerURI:"./emoticons/imgly_sticker_emoticons_angel.svg",tintMode:"none",name:"Angel",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_kisses",stickerURI:"./emoticons/imgly_sticker_emoticons_kisses.svg",tintMode:"none",name:"Kisses",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_loving",stickerURI:"./emoticons/imgly_sticker_emoticons_loving.svg",tintMode:"none",name:"Loving",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_kiss",stickerURI:"./emoticons/imgly_sticker_emoticons_kiss.svg",tintMode:"none",name:"Kiss",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wave",stickerURI:"./emoticons/imgly_sticker_emoticons_wave.svg",tintMode:"none",name:"Wave",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_nerd",stickerURI:"./emoticons/imgly_sticker_emoticons_nerd.svg",tintMode:"none",name:"Nerd",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_cool",stickerURI:"./emoticons/imgly_sticker_emoticons_cool.svg",tintMode:"none",name:"Cool",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_blush",stickerURI:"./emoticons/imgly_sticker_emoticons_blush.svg",tintMode:"none",name:"Blush",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_duckface",stickerURI:"./emoticons/imgly_sticker_emoticons_duckface.svg",tintMode:"none",name:"Duckface",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_furious",stickerURI:"./emoticons/imgly_sticker_emoticons_furious.svg",tintMode:"none",name:"Furious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_angry",stickerURI:"./emoticons/imgly_sticker_emoticons_angry.svg",tintMode:"none",name:"Angry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_steaming_furious",stickerURI:"./emoticons/imgly_sticker_emoticons_steaming_furious.svg",tintMode:"none",name:"Steaming Furious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sad",stickerURI:"./emoticons/imgly_sticker_emoticons_sad.svg",tintMode:"none",name:"Sad",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_anxious",stickerURI:"./emoticons/imgly_sticker_emoticons_anxious.svg",tintMode:"none",name:"Anxious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_cry",stickerURI:"./emoticons/imgly_sticker_emoticons_cry.svg",tintMode:"none",name:"Cry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sobbing",stickerURI:"./emoticons/imgly_sticker_emoticons_sobbing.svg",tintMode:"none",name:"Sobbing",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_loud_cry",stickerURI:"./emoticons/imgly_sticker_emoticons_loud_cry.svg",tintMode:"none",name:"Loud Cry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wide_grin",stickerURI:"./emoticons/imgly_sticker_emoticons_wide_grin.svg",tintMode:"none",name:"Wide grin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_impatient",stickerURI:"./emoticons/imgly_sticker_emoticons_impatient.svg",tintMode:"none",name:"Impatient",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_tired",stickerURI:"./emoticons/imgly_sticker_emoticons_tired.svg",tintMode:"none",name:"Tired",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_asleep",stickerURI:"./emoticons/imgly_sticker_emoticons_asleep.svg",tintMode:"none",name:"Asleep",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sleepy",stickerURI:"./emoticons/imgly_sticker_emoticons_sleepy.svg",tintMode:"none",name:"Sleepy",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_deceased",stickerURI:"./emoticons/imgly_sticker_emoticons_deceased.svg",tintMode:"none",name:"Deceased",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_attention",stickerURI:"./emoticons/imgly_sticker_emoticons_attention.svg",tintMode:"none",name:"Attention",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_question",stickerURI:"./emoticons/imgly_sticker_emoticons_question.svg",tintMode:"none",name:"Question",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",stickerURI:"./emoticons/imgly_sticker_emoticons_not_speaking_to_you.svg",tintMode:"none",name:"Not speaking to you",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sick",stickerURI:"./emoticons/imgly_sticker_emoticons_sick.svg",tintMode:"none",name:"Sick",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_pumpkin",stickerURI:"./emoticons/imgly_sticker_emoticons_pumpkin.svg",tintMode:"none",name:"Pumpkin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_boxer",stickerURI:"./emoticons/imgly_sticker_emoticons_boxer.svg",tintMode:"none",name:"Boxer",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_idea",stickerURI:"./emoticons/imgly_sticker_emoticons_idea.svg",tintMode:"none",name:"Idea",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_smoking",stickerURI:"./emoticons/imgly_sticker_emoticons_smoking.svg",tintMode:"none",name:"Smoking",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_beer",stickerURI:"./emoticons/imgly_sticker_emoticons_beer.svg",tintMode:"none",name:"Beer",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_skateboard",stickerURI:"./emoticons/imgly_sticker_emoticons_skateboard.svg",tintMode:"none",name:"Skateboard",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_guitar",stickerURI:"./emoticons/imgly_sticker_emoticons_guitar.svg",tintMode:"none",name:"Guitar",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_music",stickerURI:"./emoticons/imgly_sticker_emoticons_music.svg",tintMode:"none",name:"Music",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sunbathing",stickerURI:"./emoticons/imgly_sticker_emoticons_sunbathing.svg",tintMode:"none",name:"Sunbathing",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_hippie",stickerURI:"./emoticons/imgly_sticker_emoticons_hippie.svg",tintMode:"none",name:"Hippie",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_humourous",stickerURI:"./emoticons/imgly_sticker_emoticons_humourous.svg",tintMode:"none",name:"Humourous",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_hitman",stickerURI:"./emoticons/imgly_sticker_emoticons_hitman.svg",tintMode:"none",name:"Hitman",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_harry_potter",stickerURI:"./emoticons/imgly_sticker_emoticons_harry_potter.svg",tintMode:"none",name:"Harry Potter",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_business",stickerURI:"./emoticons/imgly_sticker_emoticons_business.svg",tintMode:"none",name:"Business",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_batman",stickerURI:"./emoticons/imgly_sticker_emoticons_batman.svg",tintMode:"none",name:"Batman",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_skull",stickerURI:"./emoticons/imgly_sticker_emoticons_skull.svg",tintMode:"none",name:"Skull",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_ninja",stickerURI:"./emoticons/imgly_sticker_emoticons_ninja.svg",tintMode:"none",name:"Ninja",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_masked",stickerURI:"./emoticons/imgly_sticker_emoticons_masked.svg",tintMode:"none",name:"Masked",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_alien",stickerURI:"./emoticons/imgly_sticker_emoticons_alien.svg",tintMode:"none",name:"Alien",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wrestler",stickerURI:"./emoticons/imgly_sticker_emoticons_wrestler.svg",tintMode:"none",name:"Wrestler",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_devil",stickerURI:"./emoticons/imgly_sticker_emoticons_devil.svg",tintMode:"none",name:"Devil",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_star",stickerURI:"./emoticons/imgly_sticker_emoticons_star.svg",tintMode:"none",name:"Star",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_baby_chicken",stickerURI:"./emoticons/imgly_sticker_emoticons_baby_chicken.svg",tintMode:"none",name:"Baby Chicken",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_rabbit",stickerURI:"./emoticons/imgly_sticker_emoticons_rabbit.svg",tintMode:"none",name:"Rabbit",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_pig",stickerURI:"./emoticons/imgly_sticker_emoticons_pig.svg",tintMode:"none",name:"Pig",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_chicken",stickerURI:"./emoticons/imgly_sticker_emoticons_chicken.svg",tintMode:"none",name:"Chicken",resizeMode:"keepAspect"}]},{identifier:"imgly_sticker_shapes",name:"Shapes",thumbnailURI:"./categories/shapes.png",items:[{identifier:"imgly_sticker_shapes_badge_01",stickerURI:"./shapes/imgly_sticker_shapes_badge_01.svg",tintMode:"solid",name:"Shape Badge 01",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_04",stickerURI:"./shapes/imgly_sticker_shapes_badge_04.svg",tintMode:"solid",name:"Shape Badge 04",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_12",stickerURI:"./shapes/imgly_sticker_shapes_badge_12.svg",tintMode:"solid",name:"Shape Badge 12",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_06",stickerURI:"./shapes/imgly_sticker_shapes_badge_06.svg",tintMode:"solid",name:"Shape Badge 06",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_13",stickerURI:"./shapes/imgly_sticker_shapes_badge_13.svg",tintMode:"solid",name:"Shape Badge 13",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_36",stickerURI:"./shapes/imgly_sticker_shapes_badge_36.svg",tintMode:"solid",name:"Shape Badge 36",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_08",stickerURI:"./shapes/imgly_sticker_shapes_badge_08.svg",tintMode:"solid",name:"Shape Badge 08",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_11",stickerURI:"./shapes/imgly_sticker_shapes_badge_11.svg",tintMode:"solid",name:"Shape Badge 11",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_35",stickerURI:"./shapes/imgly_sticker_shapes_badge_35.svg",tintMode:"solid",name:"Shape Badge 35",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_28",stickerURI:"./shapes/imgly_sticker_shapes_badge_28.svg",tintMode:"solid",name:"Shape Badge 28",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_32",stickerURI:"./shapes/imgly_sticker_shapes_badge_32.svg",tintMode:"solid",name:"Shape Badge 32",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_15",stickerURI:"./shapes/imgly_sticker_shapes_badge_15.svg",tintMode:"solid",name:"Shape Badge 15",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_20",stickerURI:"./shapes/imgly_sticker_shapes_badge_20.svg",tintMode:"solid",name:"Shape Badge 20",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_18",stickerURI:"./shapes/imgly_sticker_shapes_badge_18.svg",tintMode:"solid",name:"Shape Badge 18",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_19",stickerURI:"./shapes/imgly_sticker_shapes_badge_19.svg",tintMode:"solid",name:"Shape Badge 19",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_arrow_02",stickerURI:"./shapes/imgly_sticker_shapes_arrow_02.svg",tintMode:"solid",name:"Shape Arrow 02",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_arrow_03",stickerURI:"./shapes/imgly_sticker_shapes_arrow_03.svg",tintMode:"solid",name:"Shape Arrow 03",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_01",stickerURI:"./shapes/imgly_sticker_shapes_spray_01.svg",tintMode:"solid",name:"Shape Spray 01",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_04",stickerURI:"./shapes/imgly_sticker_shapes_spray_04.svg",tintMode:"solid",name:"Shape Spray 04",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_03",stickerURI:"./shapes/imgly_sticker_shapes_spray_03.svg",tintMode:"solid",name:"Shape Spray 03",resizeMode:"keepAspect"}]}];var Sn=Cy;const Ey=[{thumbnailURI:"./items/dark/imgly_text_design_icon_thislayoutisgreat.png",identifier:"imgly_text_design_blocks",name:"Blocks"},{thumbnailURI:"./items/dark/imgly_text_design_icon_fatandfast.png",identifier:"imgly_text_design_rotated",name:"Rotated"},{thumbnailURI:"./items/dark/imgly_text_design_icon_summerfeeling.png",identifier:"imgly_text_design_blocks_light",name:"Blocks Light"},{thumbnailURI:"./items/dark/imgly_text_design_icon_typewithstyle.png",identifier:"imgly_text_design_equal_width",name:"Equal Width"},{thumbnailURI:"./items/dark/imgly_text_design_icon_inthebox.png",identifier:"imgly_text_design_masked",name:"Masked"},{thumbnailURI:"./items/dark/imgly_text_design_icon_bluefriday.png",identifier:"imgly_text_design_celebrate",name:"Celebrate"},{thumbnailURI:"./items/dark/imgly_text_design_icon_decorative.png",identifier:"imgly_text_design_sunshine",name:"Sunshine"},{thumbnailURI:"./items/dark/imgly_text_design_icon_specialdeals.png",identifier:"imgly_text_design_masked_badge",name:"Masked Badge"},{thumbnailURI:"./items/dark/imgly_text_design_icon_doublelines.png",identifier:"imgly_text_design_blocks_condensed",name:"Blocks Condensed"},{thumbnailURI:"./items/dark/imgly_text_design_icon_celebrate.png",identifier:"imgly_text_design_celebrate_simple",name:"Celebrate Simple"},{thumbnailURI:"./items/dark/imgly_text_design_icon_beerandburger.png",identifier:"imgly_text_design_equal_width_fat",name:"Equal Width Fat"},{thumbnailURI:"./items/dark/imgly_text_design_icon_watercolor.png",identifier:"imgly_text_design_watercolor",name:"Watercolor"},{thumbnailURI:"./items/dark/imgly_text_design_icon_particle.png",identifier:"imgly_text_design_particles",name:"Particles"},{thumbnailURI:"./items/dark/imgly_text_design_icon_yeah.png",identifier:"imgly_text_design_masked_speech_bubble",name:"Masked Speech Bubble"},{thumbnailURI:"./items/dark/imgly_text_design_icon_thisisadream.png",identifier:"imgly_text_design_masked_speech_bubble_comic",name:"Masked Speech Bubble Comic"},{thumbnailURI:"./items/dark/imgly_text_design_icon_fatface.png",identifier:"imgly_text_design_multiline",name:"Multiline"}];var sp=Ey;const Ry=[{thumbnailURI:"./items/light/imgly_text_design_icon_thislayoutisgreat.png",identifier:"imgly_text_design_blocks",name:"Blocks"},{thumbnailURI:"./items/light/imgly_text_design_icon_fatandfast.png",identifier:"imgly_text_design_rotated",name:"Rotated"},{thumbnailURI:"./items/light/imgly_text_design_icon_summerfeeling.png",identifier:"imgly_text_design_blocks_light",name:"Blocks Light"},{thumbnailURI:"./items/light/imgly_text_design_icon_typewithstyle.png",identifier:"imgly_text_design_equal_width",name:"Equal Width"},{thumbnailURI:"./items/light/imgly_text_design_icon_inthebox.png",identifier:"imgly_text_design_masked",name:"Masked"},{thumbnailURI:"./items/light/imgly_text_design_icon_bluefriday.png",identifier:"imgly_text_design_celebrate",name:"Celebrate"},{thumbnailURI:"./items/light/imgly_text_design_icon_decorative.png",identifier:"imgly_text_design_sunshine",name:"Sunshine"},{thumbnailURI:"./items/light/imgly_text_design_icon_specialdeals.png",identifier:"imgly_text_design_masked_badge",name:"Masked Badge"},{thumbnailURI:"./items/light/imgly_text_design_icon_doublelines.png",identifier:"imgly_text_design_blocks_condensed",name:"Blocks Condensed"},{thumbnailURI:"./items/light/imgly_text_design_icon_celebrate.png",identifier:"imgly_text_design_celebrate_simple",name:"Celebrate Simple"},{thumbnailURI:"./items/light/imgly_text_design_icon_beerandburger.png",identifier:"imgly_text_design_equal_width_fat",name:"Equal Width Fat"},{thumbnailURI:"./items/light/imgly_text_design_icon_watercolor.png",identifier:"imgly_text_design_watercolor",name:"Watercolor"},{thumbnailURI:"./items/light/imgly_text_design_icon_particle.png",identifier:"imgly_text_design_particles",name:"Particles"},{thumbnailURI:"./items/light/imgly_text_design_icon_yeah.png",identifier:"imgly_text_design_masked_speech_bubble",name:"Masked Speech Bubble"},{thumbnailURI:"./items/light/imgly_text_design_icon_thisisadream.png",identifier:"imgly_text_design_masked_speech_bubble_comic",name:"Masked Speech Bubble Comic"},{thumbnailURI:"./items/light/imgly_text_design_icon_fatface.png",identifier:"imgly_text_design_multiline",name:"Multiline"}];var np=Ry;const ky=[{identifier:"imgly_transforms_common",name:"Common",items:[{identifier:"imgly_transform_common_custom",name:"Custom",thumbnailURI:"",ratio:"*"},{identifier:"imgly_transform_common_square",name:"Square",thumbnailURI:"",ratio:1},{identifier:"imgly_transform_common_4",name:"4:3",thumbnailURI:"",ratio:4/3},{identifier:"imgly_transform_common_16",name:"16:9",thumbnailURI:"",ratio:16/9},{identifier:"imgly_transform_common_3",name:"3:4",thumbnailURI:"",ratio:3/4},{identifier:"imgly_transform_common_9",name:"9:16",thumbnailURI:"",ratio:9/16}]},{identifier:"imgly_transforms_facebook",name:"Facebook",items:[{identifier:"imgly_transform_facebook_profile",name:"Profile",thumbnailURI:"",dimensions:{x:300,y:300},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_facebook_title",name:"Title",thumbnailURI:"",dimensions:{x:1200,y:627},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_facebook_post",name:"Post",thumbnailURI:"",dimensions:{x:940,y:788},forceDimensions:!0,lockDimensions:!0}]},{identifier:"imgly_transforms_instagram",name:"Instagram",items:[{identifier:"imgly_transform_instagram_landscape",name:"Landscape",thumbnailURI:"",dimensions:{x:1080,y:566},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_instagram_portrait",name:"Portrait",thumbnailURI:"",dimensions:{x:1080,y:1350},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_instagram_square",name:"Square",thumbnailURI:"",dimensions:{x:1080,y:1080},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_instagram_story",name:"Story",thumbnailURI:"",dimensions:{x:1080,y:1920},forceDimensions:!0,lockDimensions:!0}]},{identifier:"imgly_transforms_twitter",name:"Twitter",items:[{identifier:"imgly_transform_twitter_post",name:"Post",thumbnailURI:"",dimensions:{x:1024,y:512},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_twitter_profile",name:"Profile",thumbnailURI:"",dimensions:{x:400,y:400},forceDimensions:!0,lockDimensions:!0},{identifier:"imgly_transform_twitter_title",name:"Title",thumbnailURI:"",dimensions:{x:1500,y:500},forceDimensions:!0,lockDimensions:!0}]}];var Cn=ky;function ap(){if(typeof navigator=="undefined")return!1;const e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}function En(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0,i=e==="x"?t:t&3|8;return i.toString(16)})}const Y3=window.performance.now.bind(window.performance);class Rn{constructor(e){this.text=e;this.lastOffsetWidth=-1;const t="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.element=document.createElement("div"),this.element.setAttribute("aria-hidden","true"),this.element.appendChild(document.createTextNode(e)),this.collapsible=document.createElement("span"),this.expandable=document.createElement("span"),this.collapsibleInner=document.createElement("span"),this.expandableInner=document.createElement("span"),this.collapsible.style.cssText=t,this.expandable.style.cssText=t,this.expandableInner.style.cssText=t,this.collapsibleInner.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.collapsible.appendChild(this.collapsibleInner),this.expandable.appendChild(this.expandableInner),this.element.appendChild(this.collapsible),this.element.appendChild(this.expandable)}getElement(){return this.element}setFont(e){this.element.style.cssText=`max-width:none;
      min-width:20px;
      min-height:20px;
      display:inline-block;
      overflow:hidden;
      position:absolute;
      width:auto;
      margin:0;
      padding:0;
      top:-999px;
      white-space:nowrap;
      font-synthesis:none;
      font:${e};`}getWidth(){return this.element.offsetWidth}setWidth(e){this.element.style.width=`${e}px`}onResize(e){const t=()=>{this.onScroll(e)};this.collapsible.addEventListener("scroll",t),this.expandable.addEventListener("scroll",t),this.reset()}reset(){const e=this.getWidth(),t=e+100;return this.expandableInner.style.width=`${t}px`,this.expandable.scrollLeft=t,this.collapsible.scrollLeft=this.collapsible.scrollWidth+100,this.lastOffsetWidth!==e?(this.lastOffsetWidth=e,!0):!1}onScroll(e){this.reset()&&this.element.parentNode!==null&&e(this.lastOffsetWidth)}}class be{static getUserAgent(){return window.navigator.userAgent}static getNavigatorVendor(){return window.navigator.vendor}static hasWebKitFallbackBug(){if(be.HAS_WEBKIT_FALLBACK_BUG===null){const e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(be.getUserAgent());be.HAS_WEBKIT_FALLBACK_BUG=!!e&&(parseInt(e[1],10)<536||parseInt(e[1],10)===536&&parseInt(e[2],10)<=11)}return be.HAS_WEBKIT_FALLBACK_BUG}static hasSafari10Bug(){if(be.HAS_SAFARI_10_BUG===null)if(be.supportsNativeFontLoading()&&/Apple/.test(be.getNavigatorVendor())){const e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(be.getUserAgent());be.HAS_SAFARI_10_BUG=!!e&&parseInt(e[1],10)<603}else be.HAS_SAFARI_10_BUG=!1;return be.HAS_SAFARI_10_BUG}static supportsNativeFontLoading(){return be.SUPPORTS_NATIVE_FONT_LOADING===null&&(be.SUPPORTS_NATIVE_FONT_LOADING=!!document.fonts),be.SUPPORTS_NATIVE_FONT_LOADING}static supportsStretch(){if(be.SUPPORTS_STRETCH===null){const e=document.createElement("div");try{e.style.font="condensend 100px sans-serif"}catch(t){be.SUPPORTS_STRETCH=!1}be.SUPPORTS_STRETCH=e.style.font!==""}return be.SUPPORTS_STRETCH}constructor(e){this.font=T({fontFamily:"normal",fontStyle:"normal",fontWeight:"normal",fontStretch:"normal"},e)}load(e,t){const i="BESbswy";let r=null;const o=t||be.DEFAULT_TIMEOUT,s=this.getTime();return new Promise((n,a)=>{if(be.supportsNativeFontLoading()&&!be.hasSafari10Bug()){const l=new Promise((c,p)=>{const d=()=>{const m=this.getTime();m-s>=o?p(new Error(""+o+"ms timeout exceeded")):document.fonts.load(this.getStyle(`"${this.font.fontFamily}"`),i).then(x=>{x.length>=1?c():setTimeout(d,25)},a)};d()}),h=new Promise((c,p)=>{r=setTimeout(()=>{p(new Error(`${o} ms timeout exceeded`))},o)});Promise.race([h,l]).then(()=>{clearTimeout(r),n(this)},a)}else{const l=new Rn(i),h=new Rn(i),c=new Rn(i);let p=-1,d=-1,m=-1,x=-1,b=-1,g=-1;const y=document.createElement("div"),_=()=>{y.parentNode!==null&&y.parentNode.removeChild(y)},f=()=>{if((p!==-1&&d!==-1||p!==-1&&m!==-1||d!==-1&&m!==-1)&&(p===d||p===m||d===m)){if(be.hasWebKitFallbackBug()&&(p===x&&d===x&&m===x||p===b&&d===b&&m===b||p===g&&d===g&&m===g))return;_(),clearTimeout(r),n(this)}};y.dir="ltr",l.setFont(this.getStyle("sans-serif")),h.setFont(this.getStyle("serif")),c.setFont(this.getStyle("monospace")),y.appendChild(l.getElement()),y.appendChild(h.getElement()),y.appendChild(c.getElement()),document.body.appendChild(y),x=l.getWidth(),b=h.getWidth(),g=c.getWidth();const D=()=>{const v=this.getTime();if(v-s>=o)_(),a(new Error(`${o} ms timeout exceeded`));else{const w=document.hidden;(w===!0||w===void 0)&&(p=l.getWidth(),d=h.getWidth(),m=c.getWidth(),f()),r=setTimeout(D,50)}};D(),l.onResize(v=>{p=v,f()}),l.setFont(this.getStyle(`"${this.font.fontFamily}",sans-serif`)),h.onResize(v=>{d=v,f()}),h.setFont(this.getStyle(`"${this.font.fontFamily}",serif`)),c.onResize(v=>{m=v,f()}),c.setFont(this.getStyle(`"${this.font.fontFamily}",monospace`))}})}getStyle(e){return[this.font.fontStyle,this.font.fontWeight,be.supportsStretch()?this.font.fontStretch:"","100px",e].join(" ")}getTime(){return new Date().getTime()}}be.HAS_WEBKIT_FALLBACK_BUG=null,be.HAS_SAFARI_10_BUG=null,be.SUPPORTS_STRETCH=null,be.SUPPORTS_NATIVE_FONT_LOADING=null,be.DEFAULT_TIMEOUT=3e3;class j{static fromSize(e){return new j(e.width,e.height)}static distance(e,t){const i=t.x-e.x,r=t.y-e.y;return Math.sqrt(i*i+r*r)}static dot(e,t){return e.x*t.x+e.y*t.y}static lerp(e,t,i){const r=Math.min(Math.max(i,0),1);return new j(e.x*r+t.x*(1-r),e.y*r+t.y*(1-r))}static lerpUnclamped(e,t,i){return new j(e.x*i+t.x*(1-i),e.y*i+t.y*(1-i))}static proportionalFit(e,t){const i=e.x/e.y,r=t.x/t.y;return i>r?t.multiply(e.y/t.y):t.multiply(e.x/t.x)}get magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}get normalized(){const e=this.magnitude;return new j(this.x/e,this.y/e)}get floored(){return new j(Math.floor(this.x),Math.floor(this.y))}get rounded(){return new j(Math.round(this.x),Math.round(this.y))}get min(){return Math.min(this.x,this.y)}get max(){return Math.max(this.x,this.y)}get abs(){return new j(Math.abs(this.x),Math.abs(this.y))}get swapped(){return new j(this.y,this.x)}constructor(e,t){typeof e=="number"?(this.x=e,this.y=t):(this.x=e.x,this.y=e.y)}clone(){return new j(this.x,this.y)}add(e,t){return typeof e=="number"?new j(this.x+e,this.y+t):new j(this.x+e.x,this.y+e.y)}subtract(e,t){return typeof e=="number"?new j(this.x-e,this.y-t):new j(this.x-e.x,this.y-e.y)}multiply(e,t){return typeof e=="number"?new j(this.x*e,this.y*(t===void 0?e:t)):new j(this.x*e.x,this.y*e.y)}divide(e,t){return typeof e=="number"?new j(this.x/e,this.y/(t===void 0?e:t)):new j(this.x/e.x,this.y/e.y)}equals(e){return this.x===e.x&&this.y===e.y}clamp(e,t){const i=Math.max(e.x,Math.min(t.x,this.x)),r=Math.max(e.y,Math.min(t.y,this.y));return new j(i,r)}}j.ZERO=new j(0,0),j.ONE=new j(1,1),j.UP=new j(0,1),j.DOWN=new j(0,-1),j.RIGHT=new j(1,0),j.LEFT=new j(-1,0);var ai;(function(e){e.BEGAN_IMAGE_DOWNSCALING="beganImageDownscaling",e.IMAGE_DOWNSCALED="imageDownscaled"})(ai||(ai={}));class kn extends Ao{constructor(e,t){super();this.image=e,this.options=t}needsResize(){const e=this.resizedDimensions();return e.x<this.image.width||e.y<this.image.height}resizedDimensions(){const{options:e}=this,t={width:this.image.width,height:this.image.height};let i=j.fromSize(t),r=j.fromSize(t);const{maxMegaPixels:o}=e;if(o){const a=(ap()?o.mobile:o.desktop)*1e6,l=t.width/t.height,h=t.height/t.width,c=new j(Math.floor(Math.sqrt(a*l)),Math.floor(Math.sqrt(a*h)));c.x<=t.width&&c.y<=t.height&&(i=c)}const s=e.maxDimensions;s&&((s.height<t.height||s.width<t.width)&&(r=new j(s.width,s.height)));const n=new j(Math.min(i.x,r.x),Math.min(i.y,r.y));return j.proportionalFit(n,j.fromSize(t)).floored}downscaleIfNecessary(){const e=this.resizedDimensions(),t=e.x<this.image.width||e.y<this.image.height;if(!t)return this.image;this.emit(ai.BEGAN_IMAGE_DOWNSCALING,this.image);const i=document.createElement("canvas");i.width=e.x,i.height=e.y;const r=i.getContext("2d"),{image:o}=this;return r.drawImage(o,0,0,o.width,o.height,0,0,e.x,e.y),this.emit(ai.IMAGE_DOWNSCALED,{width:e.x,height:e.y}),i}downscaleImageIfNecessary(){const e=this.image,t=this.resizedDimensions(),i=t.x<this.image.width||t.y<this.image.height;if(!i)return e;this.emit(ai.BEGAN_IMAGE_DOWNSCALING,e);const r=new Image;return r.width=t.x,r.height=t.y,r.src=e.src,this.emit(ai.IMAGE_DOWNSCALED,{width:t.x,height:t.y}),r}}var On;(function(e){e[e.EditorContainer=0]="EditorContainer",e[e.ToolControlBar=1]="ToolControlBar",e[e.ToolControlBarControls=2]="ToolControlBarControls",e[e.CanvasContainer=3]="CanvasContainer",e[e.Canvas=4]="Canvas",e[e.MainBarButtonClose=5]="MainBarButtonClose",e[e.Tooltip=6]="Tooltip",e[e.Cursor=7]="Cursor",e[e.CursorContainer=8]="CursorContainer",e[e.NummericInput=9]="NummericInput",e[e.BrushSize=10]="BrushSize",e[e.BrushHardness=11]="BrushHardness",e[e.BrushColor=12]="BrushColor",e[e.Dialog=13]="Dialog",e[e.DialogBody=14]="DialogBody",e[e.CardContainer=15]="CardContainer",e[e.CategoryItemsContainer=16]="CategoryItemsContainer",e[e.ToolbarItem=17]="ToolbarItem"})(On||(On={}));const Fy={};for(const e in On){const t=On[e];typeof t=="string"&&(Fy[t]=t)}var lp;const aU=Boolean((lp=window.Cypress)==null?void 0:lp.env("pesdk"));function Ay(e,t){let i=0;for(let r=e.length-1;r>=0;r--){const o=e[r];o==="."?e.splice(r,1):o===".."?(e.splice(r,1),i++):i&&(e.splice(r,1),i--)}if(t)for(;i--;i)e.unshift("..");return e}function Iy(e){return e.charAt(0)==="/"}function Py(e){const t=Iy(e),i=e.substr(-1)==="/";return e=Ay(e.split("/").filter(Boolean),!t).join("/"),!e&&!t&&(e="."),e&&i&&(e+="/"),(t?"/":"")+e}const es=(...e)=>Py(e.join("/"));const By={italic:"i"};class _l{constructor(e){this.assetManager=e;this.injectedFonts={};this.loadedFonts={};this.getGoogleFamiliesString=e=>{const t=e.reduce((i,r)=>{const{fontFamily:o,fontStyle:s,fontWeight:n=400}=r;return i[o]=(i[o]||[]).concat(`${n}${By[s]||""}`),i},{});return Object.keys(t).map(i=>{const r=t[i].length?`:${t[i].join(",")}`:"",o=i.replace(" ","+")+r;return o}).join("|")}}static createFontFacesCSS(e,t){return e.map(i=>{const r=t(i.fontURI);return`@font-face {
        font-family: "${i.fontFamily}";
        src: url('${r}') format('${i.format||"woff"}');
        font-weight: ${i.fontWeight||"normal"};
        font-style: ${i.fontStyle||"normal"};
      }`})}getFontWithId(e){const t=this.assetManager.getFontAsset(e);if(!t)throw new Error("The requested font does not exist as an asset.");return t}isFontLoaded(e){return this.loadedFonts[e]!==void 0}injectAllFonts(){const e=this.assetManager.getFontAssets();this.injectFonts(e)}loadAllFonts(){return Ae(this,null,function*(){const e=this.assetManager.getFontAssets();return this.loadFonts(e)})}loadFontsWithIdentifiers(e){return Ae(this,null,function*(){const t=e.map(i=>this.getFontWithId(i));return this.loadFonts(t)})}loadFonts(e){return Ae(this,null,function*(){this.injectFonts(e);const t=new Array;return e.forEach(i=>{t.push(this.loadFont(i,!1))}),new Promise((i,r)=>{Promise.all(t).then(()=>i()).catch(o=>r(o))})})}loadFont(e,t=!0){return Ae(this,null,function*(){return new Promise((i,r)=>{this.isFontLoaded(e.identifier)&&i(),t&&this.injectFonts([e]);const o=new be(e);o.load().then(()=>{this.loadedFonts[e.identifier]=e,i()}).catch(()=>{r(e.identifier)})})})}loadFontWithIdentifier(e,t=!0){return Ae(this,null,function*(){const i=this.assetManager.getFontAsset(e);if(!i)throw new Error(`The requested font asset with identifier ${e} does not exist!`);return this.loadFont(i,t)})}injectFonts(e,t=this.assetManager.getPathForCategory("font")){const i=e.filter(Hl),r=e.filter(Vl);i.length>0&&this.addGoogleFontLinks(i),r.length>0&&this.addWebFontCSS(r,t)}addGoogleFontLinks(e){const t=e.filter(s=>!this.injectedFonts[s.identifier]);if(t.length===0)return;const i=this.getGoogleFamiliesString(t),r=document.createElement("link");r.rel="stylesheet",r.href=`https://fonts.googleapis.com/css?family=${i}`;const o=document.getElementsByTagName("head")[0];o.appendChild(r),e.forEach(s=>{this.injectedFonts[s.identifier]=s})}addWebFontCSS(e,t){const i=e.filter(n=>!this.injectedFonts[n.identifier]);if(i.length===0)return;const r=_l.createFontFacesCSS(i,t),o=`
      /* Injected by PhotoEditorSDK */
      ${r.join(`
`)}
    `,s=document.createElement("style");s.innerHTML=o,document.head.appendChild(s),e.forEach(n=>{this.injectedFonts[n.identifier]=n})}}class hp{constructor(e,t=!1){this.basePath="assets/";this.areCustomAssetsAllowed=!1;this.getAssets=e=>{switch(e){case"overlay":return this.overlayAssets;case"filter":return this.filterCategories;case"font":return this.fontAssets;case"focus":return this.focusAssets;case"adjustment":return this.adjustmentCategories;case"sticker":return this.stickerCategories;case"textdesign":return this.textDesignAssets;case"frame":return this.frameAssets;case"transform":return this.transformCategories}return[]};this.getPath=(e,...t)=>{const i=es(e,...t);if(t&&t.length!==0&&gl(es(...t)))return es(...t);if((!t||t.length===0)&&gl(e))return e;if(this.basePath.match(/(ftp|http|https):\/\//)){const{length:r}=this.basePath;return this.basePath[r-1]!=="/"&&(this.basePath=`${this.basePath}/`),this.basePath+i}return es(this.basePath,i)};this.getPathForCategory=e=>(...t)=>this.getPath(e,...t);this.addCustomStickerAsset=(e,t,i)=>{e.forEach(r=>{const{thumbnailURI:o,name:s,stickerURI:n,identifier:a,tintMode:l,resizeMode:h}=r,c=this.stickerCategories.find(d=>d.identifier===t),p={identifier:a,name:s,thumbnailURI:o,stickerURI:n,tintMode:l,resizeMode:h};if(c)c.items.push(p);else{const d={identifier:t,name:i,thumbnailURI:o,items:[p]};this.stickerCategories=[d,...this.stickerCategories]}}),this.stickerAssets=this.stickerCategories.reduce(this.allOptions,[])};this.getItemPath=(e,t,i)=>{const r=e.find(o=>o.identifier===t);return r&&(r[i]||r.path)||""};this.isNonExistingFont=e=>!wn.find(t=>t.identifier===e.identifier)&&!Di[e.identifier];this.replaceDeprecatedFont=e=>Di[e.identifier]?wn.find(t=>t.identifier===Jo(e.identifier,!0)):e;e&&e.basePath&&(this.basePath=e.basePath),this.areCustomAssetsAllowed=t;const i=vn.reduce(this.allOptions,[]);e&&e.filter?this.filterCategories=this.configuredCategory(vn,e.filter,i):this.filterCategories=vn,this.lutFilterAssets=this.filterCategories.reduce(this.allOptions,[]).filter(h=>Wl(h)),this.duoToneFilterAssets=this.filterCategories.reduce(this.allOptions,[]).filter(h=>Kl(h));const r=xn.reduce(this.allOptions,[]);e&&e.adjustment?this.adjustmentCategories=this.configuredCategory(xn,e.adjustment,r):this.adjustmentCategories=xn,this.fontAssets=wn.reduce(this.allOptions,[]);let o=rp.map(h=>this.getFontAsset(h));if(e&&e.text&&e.text.fonts&&e.text.fonts.length>0){const h=e.text.fonts.filter(this.isNonExistingFont),c=e.text.fonts.filter(p=>!this.isNonExistingFont(p)).map(p=>this.replaceDeprecatedFont(p)).map(p=>this.getFontAsset(p.identifier));o=e.text.fonts?[...c,...h]:o,this.fontAssets=e.text.fonts?[...this.fontAssets,...h]:this.fontAssets}this.textToolFontAssets=o;const s=e&&e.focus&&e.focus.items&&e.focus.items.length?e.focus.items.map(h=>fl.find(c=>c.identifier===h.identifier)):fl;this.focusAssets=s,e&&e.overlay&&e.overlay.items?this.overlayAssets=this.configuredItem(e.overlay.items,Dn,Dn):this.overlayAssets=Dn,e&&e.frame&&e.frame.items?this.frameAssets=this.configuredItem(e.frame.items,Tn,Tn):this.frameAssets=Tn;const n=Sn.reduce(this.allOptions,[]);e&&e.sticker?this.stickerCategories=this.configuredCategory(Sn,e.sticker,n):this.stickerCategories=Sn,this.stickerAssets=this.stickerCategories.reduce(this.allOptions,[]);let a=sp;e&&e.theme==="light"&&(a=np),this.textDesignAssets=e&&e.textdesign&&e.textdesign.items&&e.textdesign.items.length?e.textdesign.items.map(h=>a.find(c=>c.identifier===h.identifier)):a,this.textDesignToolFontAssets=op.map(h=>this.getFontAsset(h));const l=Cn.reduce(this.allOptions,[]);e&&e.transform?this.transformCategories=this.configuredCategory(Cn,e.transform,l):this.transformCategories=Cn,this.transformAssets=this.transformCategories.reduce(this.allOptions,[]),this.fontManager=new _l(this)}getFontManager(){return this.fontManager}getAssetSource(e,t){switch(e){case"filter":const i=this.getLUTFilterAsset(t);if(i)return this.getPath(e,this.getItemPath(this.lutFilterAssets,t,"lutURI"));break;case"overlay":return this.getPath(e,this.getItemPath(this.overlayAssets,t,"overlayURI"));case"font":return this.getPath(e,this.getItemPath(this.fontAssets,t,"fontURI"));case"sticker":const r=this.stickerAssets.find(o=>o.identifier===t);if(r){if(r.stickerURI.substr(0,10)==="data:image")return r.stickerURI;if(t.includes("imgly_sticker")&&r.stickerURI.includes(".svg")&&bn()){const o=this.getPath(e,this.getItemPath(this.stickerAssets,t,"stickerURI")),s=o.split("/");return s.splice(s.length-1,0,"base"),s[s.length-1]=s[s.length-1].replace(".svg",".png"),s.join("/")}return this.getPath(e,this.getItemPath(this.stickerAssets,t,"stickerURI"))}throw new Error("Cannot resolve this type of sticker asset yet");case"textdesign":return this.getPath(e,"engine",t);case"frame":return this.getPath(e,t)}throw new Error("Cannot resolve this type of asset yet")}getDuotoneFilterAsset(e){return this.duoToneFilterAssets.filter(t=>t.identifier===e)[0]}getLUTFilterAsset(e){return this.lutFilterAssets.filter(t=>t.identifier===e)[0]}getOverlayAsset(e){return this.overlayAssets.filter(t=>t.identifier===e)[0]}getStickerAsset(e){return this.stickerAssets.filter(t=>t.identifier===e)[0]}getFontAsset(e){return this.fontAssets.filter(t=>t.identifier===e)[0]}getTextDesignAssets(e){return this.textDesignAssets.filter(t=>t.identifier===e)[0]}getFrameAsset(e){return this.frameAssets.filter(t=>t.identifier===e)[0]}getFontAssets(){return this.fontAssets}getFontAssetsForText(){return this.textToolFontAssets}getFontAssetsForTextDesign(){return this.textDesignToolFontAssets}getFrameAssets(){return this.frameAssets}allOptions(e,t){return Object.prototype.hasOwnProperty.call(t,"items")?[...e,...t.items]:[...e,t]}configuredCategory(e,t,i){return t.categories&&t.categories.length?t.categories.reduce((r,o)=>{const s=e.find(n=>n.identifier===o.identifier);return s?r.push(T(T(T({},s),o),{items:this.configuredItem(o.items,i,s.items).filter(Boolean)})):this.areCustomAssetsAllowed&&r.push(T(T({},o),{items:this.configuredItem(o.items,i,o.items).filter(Boolean)})),r},[]):e}configuredItem(e,t,i){return e&&e.length?e.reduce((r,o)=>{const s=t.find(n=>n.identifier===o.identifier);return s?r.push(T(T({},s),o)):this.areCustomAssetsAllowed&&r.push(o),r},[]).filter(Boolean):i}}class Me{static contains(e,t){return t.x>=e.minX&&t.x<=e.maxX&&t.y>=e.minY&&t.y<=e.maxY}constructor(e,t,i,r){if(typeof e=="number")if(typeof t=="number"&&i!==void 0&&r!==void 0)this.origin={x:e,y:t},this.size={width:i||0,height:r||0};else throw new Error("Invalid arguments passed to Rect. Expected (number, number, number, number)");else{if(this.origin=e,typeof t=="number")throw new Error("Invalid arguments passed to Rect. Expected (Float2, Size)");this.size=t}}get minX(){return this.origin.x}get minY(){return this.origin.y}get midX(){return this.origin.x+.5*this.size.width}get midY(){return this.origin.y+.5*this.size.height}get maxX(){return this.origin.x+this.size.width}get maxY(){return this.origin.y+this.size.height}get width(){return this.size.width}get height(){return this.size.height}}Me.ZERO=new Me({x:0,y:0},{width:0,height:0});class X{constructor(e,t,i,r,o,s){this.a=e;this.b=t;this.c=i;this.d=r;this.tx=o;this.ty=s}static fromScale(e,t){return new X(e,0,0,t,0,0)}static fromRotation(e){const t=Math.cos(e),i=Math.sin(e);return new X(t,-i,i,t,0,0)}static fromRotationDeg(e){const t=Math.PI*e/180;return this.fromRotation(t)}static fromTranslation(e,t){return new X(1,0,0,1,e,t)}static fromTRS(e,t,i,r,o){const s=Math.cos(i),n=Math.sin(i);return new X(r*s,-o*n,r*n,o*s,e,t)}static multiply(e,t){const i=e.a*t.a+e.b*t.c,r=e.a*t.b+e.b*t.d,o=e.c*t.a+e.d*t.c,s=e.c*t.b+e.d*t.d,n=e.a*t.tx+e.b*t.ty+e.tx,a=e.c*t.tx+e.d*t.ty+e.ty;return new X(i,r,o,s,n,a)}static transformPoint(e,t){return{x:e.a*t.x+e.b*t.y+e.tx,y:e.c*t.x+e.d*t.y+e.ty}}static getInverted(e){const t=e.a*e.d-e.b*e.c;if(t===0)return e;const i=1/t,r=i*e.d,o=-i*e.b,s=-i*e.c,n=i*e.a,a=i*(e.b*e.ty-e.d*e.tx),l=i*(e.c*e.tx-e.a*e.ty);return new X(r,o,s,n,a,l)}}X.IDENTITY=X.fromScale(1,1);class Ue{static get IDENTITY(){return new Ue({x:0,y:0})}constructor(e,t={x:1,y:1},i=0){this.position=e,this.scale=t,this.rotation=i}}const K={};Fe(K,{absoluteToRelativePoint:()=>Ky,absoluteToRelativeSize:()=>Gy,getBaseLocalToWorldMatrix:()=>Fn,getLocalToParentMatrix:()=>up,getLocalToWorldMatrix:()=>So,getPointInWorldSpace:()=>xl,getRotationBetweenCoordinateSpaces:()=>Wy,getScalarInWorldSpace:()=>Ny,getSizeInOutputSpace:()=>zy,getSizeInWorldSpace:()=>cp,pointFromSpaceToSpace:()=>ts,rectTransformToAffineTransform:()=>yl,relativeToAbsolutePoint:()=>jy,relativeToAbsoluteSize:()=>Uy,scalarFromSpaceToSpace:()=>bl,sizeFromSpaceToSpace:()=>Ly});function dp(e){return e.x!==void 0}function yl(e){return X.fromTRS(e.position.x,e.position.y,e.rotation,e.scale.x,e.scale.y)}function My(e){return e.getBaseLocalToParentMatrix?e.getBaseLocalToParentMatrix():yl(e.getTransform())}function Fn(e){const t=e.getParent(),i=My(e);if(t===void 0)return i;const r=Fn(t);return X.multiply(r,i)}function up(e){return e.getLocalToParentMatrix?e.getLocalToParentMatrix():yl(e.getTransform())}function So(e){const t=e.getParent(),i=up(e);if(t===void 0)return i;const r=So(t);return X.multiply(r,i)}function ts(e,t,i,r=!1){const o=t.type==="output"&&r?Fn(t):So(t),s=i.type==="output"&&r?Fn(i):So(i),n=X.getInverted(s);return X.transformPoint(n,X.transformPoint(o,e))}function bl(e,t,i){const r=new j(e,0),o=new j(ts(r,t,i)),s=new j(ts(j.ZERO,t,i));return j.distance(s,o)}function Ly(e,t,i){const r=dp(e)?e.x:e.width,o=dp(e)?e.y:e.height,s=bl(r,t,i),n=bl(o,t,i);return{width:s,height:n}}function xl(e,t){const i=So(t);return X.transformPoint(i,e)}function Ny(e,t){const i=new j(e,0),r=new j(xl(i,t)),o=new j(xl(j.ZERO,t));return j.distance(r,o)}function cp(e){const t=So(e),i=e.getBounds(),r={x:i.width,y:0},o={x:0,y:i.height},s=new j(X.transformPoint(t,j.ZERO)),n=new j(X.transformPoint(t,r)),a=new j(X.transformPoint(t,o)),l=j.distance(s,n),h=j.distance(s,a);return{width:l,height:h}}function zy(e,t){const i=cp(e),r=t.getTransform().scale,o={x:1/r.x,y:1/r.y},s={width:i.width*o.x,height:i.height*o.y};return s}function Uy(e,t){const i=t.getBounds();return{width:e.width*i.width,height:e.height*i.height}}function Gy(e,t){const i=t.getBounds();return{width:e.width/i.width,height:e.height/i.height}}function jy(e,t,i=!0){const r=t.getBounds();return{x:e.x*r.width+(i?0:r.minX),y:e.y*r.height+(i?0:r.minY)}}function Ky(e,t,i=!0){const r=t.getBounds();return{x:(e.x-(i?0:r.minX))/r.width,y:(e.y-(i?0:r.minY))/r.height}}function Wy(e,t){const i={x:1,y:0},r=ts(i,e,t,!0),o=ts(j.ZERO,e,t,!0);return Math.atan2(r.y-o.y,r.x-o.x)}function pp(e){return typeof e!="string"&&!Array.isArray(e)&&e.a===void 0}function mp(e){return typeof e!="string"&&Array.isArray(e)&&e.length===3}function gp(e){return typeof e!="string"&&!Array.isArray(e)&&e.a!==void 0}function fp(e){return typeof e!="string"&&Array.isArray(e)&&e.length===4}function _p(e){return typeof e=="string"}var is;(function(e){e.BEGAN_IMAGE_DOWNSCALING="beganImageDownscaling",e.IMAGE_DOWNSCALED="imageDownscaled"})(is||(is={}));class yp{constructor(e,t){this.engine=t;this.transform=Ue.IDENTITY;this.canvasPivot={x:0,y:0};this.previewQuality=1;this.canvas=e}get quality(){return this.previewQuality}setQuality(e){this.previewQuality=Math.min(Math.max(e,.01),1)}getTransform(){return this.transform}setTransform(e){this.transform=e}getPosition(){return this.transform.position}setPosition(e,t){let i;typeof e=="number"?i={x:e,y:t===void 0?e:t}:i=e;const{scale:r}=this.transform,{rotation:o}=this.transform;this.setTransform(new Ue(i,r,o))}getScale(){return this.transform.scale}setScale(e,t){let i;typeof e!="number"?i=e:i={x:e,y:t===void 0?e:t};const{position:r}=this.transform,{rotation:o}=this.transform;this.setTransform(new Ue(r,i,o))}getRotation(){return this.transform.rotation}setRotation(e){const{position:t}=this.transform,{scale:i}=this.transform;this.setTransform(new Ue(t,i,e))}getCanvasPivot(){return this.canvasPivot}setCanvasPivot(e,t){typeof e=="number"?this.canvasPivot={x:e,y:typeof t===void 0?e:t}:this.canvasPivot=e}getCanvasBounds(){const e=this.canvasPivot,{width:t,height:i}=this.canvas;return new Me(-e.x*t,-e.y*i,t,i)}}function An(e){return e.getTransform!==void 0}function bp(e){return e.getContainer!==void 0}class xp extends Ao{constructor(e){super();this.config=e}getOutputDimensions(){const e=this.getOutputContainer();return e?e.getResolution():{width:0,height:0}}getSmallerOutputSide(){const e=this.getOutputContainer();if(!e)return 0;const t=e.getResolution();return Math.min(t.width,t.height)}convertPointFromPreviewIntoOutputSpace(e,t){const i=X.getInverted(K.rectTransformToAffineTransform(t));return X.transformPoint(i,e)}convertPointFromPreviewIntoWorldSpace(e,t,i){const r=X.getInverted(K.rectTransformToAffineTransform(t)),o=i?this.getOutputContainer().getBaseLocalToParentMatrix():this.getOutputContainer().getLocalToParentMatrix(),s=X.multiply(o,r);return X.transformPoint(s,e)}convertPointFromPreviewIntoFlippedPreviewSpace(e){const t=this.getOutputContainer().getFlipTransformMatrix();return X.transformPoint(t,e)}convertPointFromWorldIntoPreviewSpace(e,t){const i=K.rectTransformToAffineTransform(t),r=X.getInverted(this.getOutputContainer().getLocalToParentMatrix()),o=X.multiply(i,r);return X.transformPoint(o,e)}convertPointFromOutputIntoPreviewSpace(e,t){const i=K.rectTransformToAffineTransform(t);return X.transformPoint(i,e)}getContainersAtPreviewPoint(e,t){const i=new Array,r=this.convertPointFromPreviewIntoWorldSpace(e,t),o=this.getRootContainers();for(const s of o)this.accumulateContainersAtWorldPointInHierarchy(r,s,i);return i}isPreviewPointInContainer(e,t,i){const r=this.convertPointFromPreviewIntoWorldSpace(e,i);return this.isWorldPointInContainer(r,t)}isWorldPointInContainer(e,t){const i=K.getLocalToWorldMatrix(t),r=X.getInverted(i),o=X.transformPoint(r,e);return Me.contains(t.getBounds(),o)}accumulateContainersAtWorldPointInHierarchy(e,t,i){this.isWorldPointInContainer(e,t)&&i.push(t);const r=t.getChildren();for(const o of r)An(o)&&this.accumulateContainersAtWorldPointInHierarchy(e,o,i)}}class We{constructor(e){this.engine=e;this.id=En()}getID(){return this.id}getContainer(){return this.engine.getRootContainers()[0]}getIndexInParent(){const{rootOperations:e}=this.engine;for(let t=0;t<e.length;t+=1)if(e[t].getID()===this.id)return t;return-1}setIndexInParent(e){this.engine.moveIndex(this,e)}isValid(){return this.getIndexInParent()!==-1}}class vp extends We{constructor(e,t,i){super(t);this.operation=i;this.type="adjustments";this.setProperties(e)}getProperties(){const e=this.operation.getOptions(),t=e.gamma-1;return{brightness:e.brightness||0,saturation:e.saturation||0,contrast:e.contrast||0,gamma:(t<0?2*t:t)||0,clarity:e.clarity||0,exposure:e.exposure||0,shadows:e.shadows*.5||0,highlights:e.highlights||0,whites:e.whites||0,blacks:e.blacks||0,temperature:e.temperature||0,sharpness:e.sharpness||0}}setProperties(e){e.gamma!==void 0&&(e.gamma=1+(e.gamma<0?.5*e.gamma:e.gamma)),e.shadows&&(e.shadows=e.shadows*2),this.operation.set(e)}getOperation(){return this.operation}getTypeIdentifier(){return"adjustments"}}const ct=e=>{if(gp(e))return new U.Color(e.r,e.g,e.b,e.a);if(fp(e))return new U.Color(e[0],e[1],e[2],e[3]);if(pp(e))return new U.Color(e.r,e.g,e.b,1);if(mp(e))return new U.Color(e[0],e[1],e[2],1);if(_p(e)){const[t,i,r]=e.match(/[0-9A-fa-f]{1,2}/g);return new U.Color(parseInt(t,16)/255,parseInt(i,16)/255,parseInt(r,16)/255,1)}throw new Error("Invalid color type")};class _e{get x(){return this._x}get y(){return this._y}constructor(e=0,t=0){this._x=e,this._y=t}set(e,t){return this._x=e,this._y=t,this}clone(){return new _e(this._x,this._y)}copy(e){return this._x=e.x,this._y=e.y,this}clamped(e=this,t=this){let i=typeof e=="number"?{x:e,y:e}:e,r=typeof t=="number"?{x:t,y:t}:t;return this._x=Math.max(i.x,this._x),this._y=Math.max(i.y,this._y),this._x=Math.min(r.x,this._x),this._y=Math.min(r.y,this._y),this}divide(e,t){return typeof e=="number"||e===null?(this._x/=e,this._y/=typeof t=="undefined"?e:t):(this._x/=e.x,this._y/=e.y),this}subtract(e,t){return typeof e=="number"||e===null?(this._x-=e,this._y-=typeof t=="undefined"?e:t):(this._x-=e.x,this._y-=e.y),this}multiply(e,t){return typeof e=="number"||e===null?(this._x*=e,this._y*=typeof t=="undefined"?e:t):(this._x*=e.x,this._y*=e.y),this}add(e,t){return typeof e=="number"||e===null?(this._x+=e,this._y+=typeof t=="undefined"?e:t):(this._x+=e.x,this._y+=e.y),this}dot(e,t){return typeof e=="number"||e===null?this._x*e+this._y*(typeof t=="undefined"?e:t):this._x*e.x+this._y*e.y}equals(e,t){return typeof e=="number"||e===null?e===this._x&&t===this._y:e.x===this._x&&e.y===this._y}flip(){let e=this._x;return this._x=this._y,this._y=e,this}round(){return this._x=Math.round(this._x),this._y=Math.round(this._y),this}ceil(){return this._x=Math.ceil(this._x),this._y=Math.ceil(this._y),this}floor(){return this._x=this._x|0,this._y=this._y|0,this}abs(){return this._x=Math.abs(this._x),this._y=Math.abs(this._y),this}len(){return Math.sqrt(this._x*this._x+this._y*this._y)}min(){return Math.min(this._x,this._y)}max(){return Math.max(this._x,this._y)}toObject(){return{x:this._x,y:this._y}}toString(){return`Vector2({ x: ${this._x}, y: ${this._y} })`}roundDecimal(e){return this._x=parseFloat(this._x.toFixed(e)),this._y=parseFloat(this._y.toFixed(e)),this}asArray(e=!1){return e?[this._y,this._x]:[this._x,this._y]}static fromObject(e){return new _e(e.x,e.y)}static fromSize(e){return new _e(e.width,e.height)}static get NULL(){return new _e(0,0)}}class Rt{constructor(e){this.engine=e;this.id=En(),this.transform=Ue.IDENTITY,this.bounds=Me.ZERO}getID(){return this.id}getParent(){const e=this.engine.getRootContainers();return e.length===0||this.id===e[0].id?void 0:e[0]}getIndexInParent(){const{rootOperations:e}=this.engine;for(let t=0;t<e.length;t+=1)if(e[t].getID()===this.id)return t;return-1}setIndexInParent(e){this.engine.moveIndex(this,e)}getChildren(){const e=this.engine.getRootContainers();return e.length>0&&(this.id===e[0].id||this.id===this.engine.getOutputContainer().id)?this.engine.rootOperations:[]}getBounds(){return this.bounds}setPivotOnSelfAndSprite(e,t,i){typeof t=="number"?(this.setPivotInternal(t,i),e.setPivot(new _e(t,i))):(this.setPivotInternal(t),e.setPivot(_e.fromObject(t)))}setPivot(e,t){this.setPivotInternal(e,t)}getPivot(){const e=this.getBounds();return{x:-e.minX/e.width,y:-e.minY/e.height}}getTransform(){return this.transform}setTransform(e){this.transform=e}updateTransform(){this.setTransform(this.transform)}getPosition(){return this.transform.position}setPosition(e,t){let i;typeof e=="number"?i={x:e,y:t===void 0?e:t}:i=e;const{scale:r}=this.transform,{rotation:o}=this.transform;this.setTransform(new Ue(i,r,o))}getScale(){return this.transform.scale}setScale(e,t){let i;typeof e!="number"?i=e:i={x:e,y:t===void 0?e:t};const{position:r,rotation:o}=this.transform;this.setTransform(new Ue(r,i,o))}getRotation(){return this.transform.rotation}setRotation(e){const{position:t,scale:i}=this.transform;this.setTransform(new Ue(t,i,e))}getSizeInWorldSpace(){return K.getSizeInWorldSpace(this)}getSizeInOutputSpace(){return K.getSizeInOutputSpace(this,this.engine.getOutputContainer())}setSizeInWorldSpace(e){const t=this.getBounds();this.setScale(e.width/t.width,e.height/t.height)}setSizeInOutputSpace(e){const t=this.engine.getOutputContainer().getScale();this.setSizeInWorldSpace({width:e.width/t.x,height:e.height/t.y})}isValid(){return this.getIndexInParent()!==-1}setPivotInternal(e,t){const i=this.getBounds();typeof e=="number"?this.setBoundsFromSize(i.width,i.height,{x:e,y:t}):this.setBoundsFromSize(i.width,i.height,e)}setBoundsFromSize(e,t,i=this.getPivot()){this.bounds=new Me(-i.x*e,-i.y*t,e,t)}}class wp extends Rt{constructor(e,t){super(t);this.type="drawing";this.drawing=e,this.operation=t.createSpriteOperation(),this.sprite=this.operation.createBrush({}),this.operation.addSprite(this.sprite),this.radialBrush=this.sprite._createRadialBrush();const i=t.getRootContainers()[0],r=i.getBounds();this.bounds=new Me(0,0,r.width,r.height),this.setTransform(Ue.IDENTITY),this.operation.setDirty(!0),this.setData(e)}beginStroke(e){if(this.currentStroke)throw new Error("A brush stroke has already been started but not finished.");if(e.id!=="imgly_brush_radial")throw new Error("This adapter does not support any brush faces other than the radial img.ly brush.");this.currentBrush=e,this.currentStroke={brush:e,path:{controlPoints:[]}},this.radialBrush.setColor(ct(e.color)),this.radialBrush.setHardness(e.hardness),this.radialBrush.setSize(e.size),this.currentPath=this.sprite.createPath(this.radialBrush.clone())}addPointToCurrentStroke(e,t=!0){if(!this.currentStroke||!this.currentBrush||!this.currentPath)throw new Error('A brush stroke has to first be started with a call to "beginStroke(brush:Brush)"');if(this.currentStroke.path.controlPoints.length){const a=this.currentStroke.path.controlPoints,l=a[a.length-1],h=this.currentBrush.size/10,c=Math.sqrt(e.x-l.x**2+(e.y-l.y**2));if(c<h)return}const i=this.engine.getOutputContainer(),r=this.engine.getRootContainers()[0],o=K.pointFromSpaceToSpace(e,r,i,!0),s=K.absoluteToRelativePoint(o,i,!1),n=i.getBounds();this.currentPath.addControlPoint(_e.fromObject(s)),this.currentStroke.path.controlPoints.push(e),t&&this.sprite.render(_e.fromObject({x:n.width,y:n.height}))}endStroke(){if(!this.currentStroke||!this.currentPath||!this.currentBrush)return;this.currentStroke.path.controlPoints.length&&this.drawing.strokes.push(this.currentStroke),this.currentStroke=void 0,this.currentBrush=void 0,this.currentPath.setClosed(!0);const e=this.engine.getOutputContainer().getBounds();this.sprite.render(_e.fromObject({x:e.width,y:e.height})),this.currentPath=void 0}setData(e){this.drawing=T(T({},this.drawing),e),this.drawing.strokes&&(this.drawing.strokes=[]),this.sprite.clearPersistCanvas(),this.sprite.clearCanvas(),this.sprite.setPaths([]),this.drawStrokes(e.strokes)}getData(){return this.drawing}updateData(){this.setData(this.getData())}getOperation(){return this.operation}drawStrokes(e){e.forEach(t=>{this.beginStroke(t.brush),t.path.controlPoints.forEach(i=>{this.addPointToCurrentStroke(i,!0)}),this.endStroke()})}}class Tp extends We{constructor(e,t,i,r){super(r);this.filterOperation=t;this.type="duotone-filter";t.set({intensity:i.colorIntensity}),t.set({filter:e}),r.pesdk.setAllOperationsToDirty()}getProperties(){const e=this.filterOperation.getOptions();return{colorIntensity:e.intensity}}setProperties(e){const t=this.filterOperation.getOptions();let i=t.intensity;e.colorIntensity!==void 0&&(i=Math.min(Math.max(e.colorIntensity,0),1)),this.filterOperation.set({intensity:i})}getOperation(){return this.filterOperation}getTypeIdentifier(){return"filter"}}class Dp{constructor(e,t){this.engine=t;this.loaded=!1;this.loading=!1;this.asset=T({},e)}load(){return Ae(this,null,function*(){if(this.loaded)return Promise.resolve();if(this.loading)return Promise.reject(new Error("Called Frame#load while it's already loading"));this.loading=!0;const{imageGroups:e}=this.asset,t=[];return["top","left","right","bottom"].forEach(i=>{if(!e[i])return;const r=e[i];["start","mid","end"].forEach(o=>{if(!(o in r))return;t.push(this.loadPart(i,o))})}),Promise.all(t).then(()=>{this.loaded=!0,this.loading=!1}).catch(()=>{this.loaded=!1,this.loading=!1})})}getFrame(){return T(T({},this.asset),{defaultName:this.asset.name,thumbnail:this.asset.thumbnailURI})}getIdentifier(){return this.asset.identifier}getDefaultName(){return this.asset.name}getThumbnail(){return this.asset.thumbnailURI}getTintable(){return this.asset.tintable||!1}getLayoutMode(){return this.asset.layoutMode}getImageGroups(){return this.asset.imageGroups}loadPart(e,t){return Ae(this,null,function*(){return new Promise((i,r)=>{const{imageGroups:o}=this.asset,s=o[e][t];let n=s;typeof s!="string"&&"image"in s&&(n=s.image);const a=new Image;a.addEventListener("load",()=>{typeof s!="string"?this.asset.imageGroups[e][t].image=a:this.asset.imageGroups[e][t]=a,i(a)}),a.addEventListener("error",()=>{r(new Error(`Failed to load image at ${a.src}`))}),a.crossOrigin=this.engine.configuration.crossOrigin||"anonymus",a.src=this.engine.assetProvider.getAssetSource("frame",n)})})}}class Sp extends We{constructor(e,t,i){super(i);this.frameOperation=e;this.type="frame";this.setProperties(t),i.pesdk.setAllOperationsToDirty()}setProperties(e){if(this.props=T(T({},this.props),e),typeof e.opacity=="number"&&this.frameOperation.set({alpha:e.opacity}),e.tintColor&&this.frameOperation.set({tintColor:ct(e.tintColor)}),e.width){const t=this.engine.getOutputContainer().getBounds(),i=Math.min(t.width,t.height),r=e.width/i;this.frameOperation.set({scale:r})}this.frameOperation.setDirty(!0)}getProperties(){return this.props}getOperation(){return this.frameOperation}getTypeIdentifier(){return"frame"}}class Cp extends We{constructor(e,t,i){super(t);this.blurOperation=i;this.type="gaussian-blur";this.setProperties(e)}getProperties(){const e=this.engine.getOutputContainer(),t=e.getBounds(),i=Math.min(t.size.width,t.size.height),r=K.scalarFromSpaceToSpace(this.blurOperation.getOptions().blurRadius*i,e,this.getContainer());return{blurRadius:r}}setProperties(e){if(e.blurRadius!==void 0){const t=this.engine.pesdk.getOutputDimensions(),i=Math.min(t.x,t.y),r=this.getContainer(),o=this.engine.getOutputContainer(),s=K.scalarFromSpaceToSpace(e.blurRadius,r,o),n=s/i;this.blurOperation.set({blurRadius:n})}}getOperation(){return this.blurOperation}getTypeIdentifier(){return"blur"}}class vl extends Rt{constructor(e,t){super(t);this.data=e;this.type="image";const i=t.configuration.downscaleOptions;if(!i)this.downscaleOptions={maxDimensions:{width:t.maxTextureDimension,height:t.maxTextureDimension}};else{const{maxDimensions:o}=i;this.downscaleOptions={maxMegaPixels:i.maxMegaPixels,maxDimensions:{width:Math.min(t.maxTextureDimension,o?o.width:Number.MAX_VALUE),height:Math.min(t.maxTextureDimension,o?o.height:Number.MAX_VALUE)}}}this.setData(e);const{image:r}=this.data;this.bounds=new Me(j.ZERO,{width:r.width,height:r.height})}setData(e){if(this.data=T(T({},this.data),e),e.image){let{image:t}=e,i;if(t instanceof HTMLImageElement&&(i=this.engine.pesdk.parseExif(t),i)){const o=i.getTags();if(o&&o.Orientation){const s=o.Orientation!==1&&o.Orientation!==2,n=[2,4,5,7].indexOf(o.Orientation)!==-1;if(s||n){if(bn()||ip()||!CSS.supports("image-orientation","from-image")){const a=this.engine.pesdk.createOperation("exif-orientation",{},!1);a.setTags(o),t=a.applyTo(t)}i.setOrientation(1),o.Orientation=1}}}const r=new kn(t,this.downscaleOptions);r.on(ai.IMAGE_DOWNSCALED,({width:o,height:s})=>{this.engine.emit(is.IMAGE_DOWNSCALED,{width:o,height:s})}),r.on(ai.BEGAN_IMAGE_DOWNSCALING,()=>{this.engine.emit(is.BEGAN_IMAGE_DOWNSCALING)}),t=r.downscaleIfNecessary(),this.data.image=t,this.engine.pesdk.setImage(t,i),this.setBoundsFromSize(t.width,t.height)}}getData(){return this.data}setPivot(e,t){throw new Error("This container does not support modifying the pivot")}getOperation(){throw new Error("This container has no associated operation")}}class Ep extends We{constructor(e,t,i){super(t);this.props=e;this.blurOperation=i;this.type="linear-blur";this.setProperties(e)}getProperties(){return this.props}setProperties(e){this.props=T(T({},this.props),e);const t=this.blurOperation.getOptions(),i=this.engine.getOutputContainer(),r=i.getBounds(),o=this.getContainer(),s=i.getBaseLocalToParentMatrix(),n=K.getBaseLocalToWorldMatrix(o),a=X.multiply(X.getInverted(s),n),l=Math.min(r.size.width,r.size.height);if(e.blurRadius!==void 0){const h=K.scalarFromSpaceToSpace(e.blurRadius,o,i);t.blurRadius=h/l}if(e.start!==void 0){const h=X.transformPoint(a,e.start),c=K.absoluteToRelativePoint(h,i,!1);t.controlPoint1=c}if(e.end!==void 0){const h=X.transformPoint(a,e.end),c=K.absoluteToRelativePoint(h,i,!1);t.controlPoint2=c}this.blurOperation.set(t)}updateProperties(){const e=this.getProperties();this.setProperties(e)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"linear-focus"}}class Rp extends We{constructor(e,t,i,r){super(r);this.filter=e;this.filterOperation=t;this.props=i;this.type="lut-filter";t.set({intensity:i.intensity}),t.set({filter:e}),r.pesdk.setAllOperationsToDirty()}getProperties(){const e=this.filterOperation.getOptions();return{intensity:e.intensity,lutImage:this.props.lutImage,horizontalTileCount:this.props.horizontalTileCount,verticalTileCount:this.props.verticalTileCount}}setProperties(e){const t=this.filterOperation.getOptions(),i=typeof e.intensity=="number"?e.intensity:t.intensity;this.filterOperation.set({intensity:i})}getOperation(){return this.filterOperation}getTypeIdentifier(){return"filter"}}class kp extends We{constructor(e,t,i){super(t);this.props=e;this.blurOperation=i;this.type="mirrored-blur";this.setProperties(e)}getProperties(){return this.props}setProperties(e){this.props=T(T({},this.props),e);const t=this.blurOperation.getOptions(),i=this.engine.getOutputContainer(),r=i.getBounds(),o=this.getContainer(),s=i.getBaseLocalToParentMatrix(),n=K.getBaseLocalToWorldMatrix(o),a=X.multiply(X.getInverted(s),n),l=Math.min(r.size.width,r.size.height);if(e.blurRadius!==void 0){const h=K.scalarFromSpaceToSpace(e.blurRadius,o,i);t.blurRadius=h/l}if(e.gradientSize!==void 0){const h=K.scalarFromSpaceToSpace(e.gradientSize,o,i),c=h/l;t.gradientSize=c}if(e.clearAreaWidth!==void 0){const h=K.scalarFromSpaceToSpace(e.clearAreaWidth,o,i),c=h/l;t.size=c*.5}if(e.mirrorAxisOrigin!==void 0){const h=X.transformPoint(a,e.mirrorAxisOrigin),c=K.absoluteToRelativePoint(h,i,!1);t.start=c}if(e.mirrorAxisDirection!==void 0){const h=X.transformPoint(a,e.mirrorAxisDirection),c=K.absoluteToRelativePoint(h,i,!1);t.end=c}this.blurOperation.set(t)}updateProperties(){const e=this.getProperties();this.setProperties(e)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"mirrored-focus"}}class wl extends Rt{constructor(e,t,i,r){super(r);this.settings=e;this.operation=t;this.flipOperation=i;this.type="output";this.flipTransform=X.IDENTITY;this.blockTransformUpdate=!1;this.transformUpdateWhileBlock=!1;this.bounds=new Me({x:0,y:0},this.settings.resolution),this.setData(e)}pauseChildrenUpdates(){this.transformUpdateWhileBlock=!1,this.blockTransformUpdate=!0}resumeChildrenUpdates(){this.blockTransformUpdate=!1,this.transformUpdateWhileBlock&&this.updateChildrenContainers()}setData(e){if(this.settings=T(T({},this.settings),e),e.resolution&&(this.setBoundsFromSize(e.resolution.width,e.resolution.height),this.setTransform(this.transform),this.operation.set({outputResolution:new _e(e.resolution.width,e.resolution.height)})),e.flipHorizontally!==void 0){const t=e.flipHorizontally;this.updateFlipTransform(),this.flipOperation.set({flipHorizontally:t})}if(e.flipVertically!==void 0){const t=e.flipVertically;this.updateFlipTransform(),this.flipOperation.set({flipVertically:t})}this.operation.setDirty(!0),this.flipOperation.setDirty(!0)}getData(){return this.settings}setResolution(e){this.setData({resolution:e})}getResolution(){return this.getData().resolution}setTransform(e){if(this.transform.rotation!==e.rotation||this.transform.position!==e.position||this.transform.scale!==e.scale){this.transform=e;const t=this.flipTransform;this.flipTransform=X.IDENTITY;const i=this.engine.getRootContainers()[0],r=K.pointFromSpaceToSpace({x:0,y:0},i,this),o=-e.rotation,s=_e.fromObject(r).clone().subtract(_e.fromObject(this.getBounds().origin));this.operation.set({pivot:new _e(0,0),position:s,scale:new _e(1/e.scale.x,1/e.scale.y),rotation:o}),this.flipTransform=t,this.operation.setDirty(!0),this.updateChildrenContainers()}}rotate90(e=!1){const t=e?-Math.PI*.5:Math.PI*.5,i=this.getResolution(),r=this.getPivot(),o=this.getBounds(),s={x:o.midX,y:o.midY},n=K.getPointInWorldSpace(s,this);this.setPivot(.5,.5),this.setPosition(n),this.setRotation(this.getRotation()-t);const a={width:i.height,height:i.width};this.setResolution(a);const l={x:-a.width*(.5-r.x),y:-a.height*(.5-r.y)},h=K.getPointInWorldSpace(l,this);this.setPivot(r),this.setPosition(h),this.updateChildrenContainers()}setPivot(e,t){super.setPivotInternal(e,t),this.setTransform(this.transform)}getTransform(){return this.transform}getBaseLocalToParentMatrix(){return K.rectTransformToAffineTransform(this.getTransform())}getLocalToParentMatrix(){const e=K.rectTransformToAffineTransform(this.getTransform());return X.multiply(e,this.flipTransform)}getFlipTransformMatrix(){return this.flipTransform}isValid(){return!0}getOperation(){return this.operation}updateFlipTransform(){const{flipHorizontally:e,flipVertically:t}=this.settings;if(!e&&!t)this.flipTransform=X.IDENTITY;else{const i=this.getPivot(),r=this.getBounds(),o=e?-1:1,s=e?-2*(i.x-.5)*r.width:0,n=t?-1:1,a=t?-2*(i.y-.5)*r.height:0;this.flipTransform=new X(o,0,0,n,s,a)}}updateChildrenContainers(){if(this.blockTransformUpdate){this.transformUpdateWhileBlock=!0;return}this.engine.rootOperations.forEach(e=>{An(e)?(e.updateTransform(),"updateData"in e&&e.updateData()):"updateProperties"in e&&e.updateProperties()})}}class Tl extends We{constructor(e,t,i){super(i);this.overlayOperation=e;this.type="overlay";const r=t.blendMode||i.mapBlendMode(e.getBlendMode());e.set({blendMode:i.reverseMapBlendMode(r)}),e.set({image:t.image}),i.pesdk.setAllOperationsToDirty()}getProperties(){const e=this.overlayOperation.getOptions();return{image:e.image,blendMode:this.engine.mapBlendMode(e.blendMode),opacity:e.alpha}}setProperties(e){const t=this.overlayOperation.getOptions();typeof e.opacity=="number"&&(t.alpha=e.opacity),e.blendMode!==void 0&&(t.blendMode=this.engine.reverseMapBlendMode(e.blendMode)),this.overlayOperation.set(t),this.overlayOperation.setDirty(!0)}getOperation(){return this.overlayOperation}getTypeIdentifier(){return"overlay"}setFlipHorizontally(e){this.overlayOperation.setFlipHorizontally(e)}setFlipVertically(e){this.overlayOperation.setFlipVertically(e)}getFlipHorizontally(){return this.overlayOperation.getFlipHorizontally()}getFlipVertically(){return this.overlayOperation.getFlipVertically()}}class Op extends We{constructor(e,t,i){super(t);this.props=e;this.blurOperation=i;this.type="radial-blur";this.setProperties(e)}getProperties(){return this.props}setProperties(e){this.props=T(T({},this.props),e);const t=this.blurOperation.getOptions(),i=this.engine.getOutputContainer(),r=i.getBounds(),o=this.getContainer(),s=i.getBaseLocalToParentMatrix(),n=K.getBaseLocalToWorldMatrix(o),a=X.multiply(X.getInverted(s),n),l=Math.min(r.size.width,r.size.height);if(e.blurRadius!==void 0){const h=K.scalarFromSpaceToSpace(e.blurRadius,o,i);t.blurRadius=h/l}if(e.center!==void 0){const h=X.transformPoint(a,e.center),c=K.absoluteToRelativePoint(h,i,!1);t.position=c}if(e.radius!==void 0){const h=K.scalarFromSpaceToSpace(e.radius,o,i),c=h/l;t.radius=c}if(e.gradientSize!==void 0){const h=K.scalarFromSpaceToSpace(e.gradientSize,o,i),c=h/l;t.gradientRadius=c}this.blurOperation.set(t)}updateProperties(){const e=this.getProperties();this.setProperties(e)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"radial-focus"}}class Dl extends Rt{constructor(e,t){super(t);this.data=e;this.type="sticker";let i=e.image;const r=this.engine.pesdk.parseExif(e.image);if(r){const s=r.getTags();if(s&&s.Orientation){const n=s.Orientation!==1&&s.Orientation!==2,a=[2,4,5,7].indexOf(s.Orientation)!==-1;if(n||a){const l=this.engine.pesdk.createOperation("exif-orientation",{},!1);l.setTags(s),i=l.applyTo(e.image),r.setOrientation(1),s.Orientation=1}}}const o=new kn(i,{maxMegaPixels:{desktop:10,mobile:5}});i=o.downscaleImageIfNecessary(),this.operation=t.createSpriteOperation(),this.sprite=this.operation.createSticker({identifier:"",image:i,position:new _e(0,0),dimensions:new _e(1,1),rotation:0,smoothDownscaling:!1}),this.operation.addSprite(this.sprite),this.bounds=new Me({x:0,y:0},{width:i.width,height:i.height}),this.setTransform(Ue.IDENTITY),this.sprite.setPivot(new _e(0,0)),this.operation.setDirty(!0),this.setData(e)}setData(e){this.data=T(T({},this.data),e),e.id&&(this.id=e.id),e.opacity&&this.sprite.setAlpha(e.opacity),e.tintColor&&this.sprite.setTintColor(ct(e.tintColor)),e.tintMode&&this.sprite.setTintMode(e.tintMode),this.operation.setDirty(!0)}getData(){return this.data}updateData(){this.setData(this.getData())}setTransform(e){super.setTransform(e);const t=this.engine.getOutputContainer(),i=this.getParent(),r={width:this.bounds.width*e.scale.x,height:this.bounds.height*e.scale.y},o=K.sizeFromSpaceToSpace(r,i,t);this.sprite.setDimensions(_e.fromSize(o));const s=K.pointFromSpaceToSpace(e.position,i,t,!0),n=K.absoluteToRelativePoint(s,t,!1);this.sprite.setPosition(new _e(n.x,n.y));const a=K.getRotationBetweenCoordinateSpaces(i,t),l=e.rotation+a;this.sprite.setRotation(l),this.operation.setDirty(!0)}setPivot(e,t){this.setPivotOnSelfAndSprite(this.sprite,e,t)}getOperation(){return this.operation}setFlipHorizontally(e){this.sprite.setFlipHorizontally(e)}setFlipVertically(e){this.sprite.setFlipVertically(e)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}}const Fp=e=>2*Math.PI-e;function Vy(e,t){if(t){const i=1/t.unitsPerEm*e,r=t.ascender*i,o=t.descender*i;return r+Math.abs(o)}return e*1.1}class Ap{constructor(e){this.context=e;this.sourceLines=[];this.maxWidth=100}static buildWords(e){const t=[];let i="";const r=e.length;for(let o=0;o<r;o+=1){const s=e[o];i+=s,(s===" "||s==="-"||o===r-1)&&(t.push(i),i="")}return t}getLines(){let e=[],t=[];const i=this.sourceLines.length;for(let r=0;r<i;r+=1){const o=this.sourceLines[r],s=Ap.buildWords(o),n=s.length;for(let a=0;a<n;a+=1){const l=s[a],h=t.concat(l).join("").replace(/\s+$/i,""),c=this.getWidth(h);if(c>this.maxWidth){t.length>0&&(e.push(t.join("")),t=[l]);const p=l.replace(/\s+$/i,"");if(this.getWidth(p)>this.maxWidth){const d=this.splitWord(l);e=e.concat(d.lines),d.rest&&(t=[d.rest])}}else t.push(l)}e.push(t.join("")),t=[]}return e}splitWord(e){const t={lines:[],rest:null},i=e.length;let r=[];for(let o=0;o<i;o+=1){const s=e[o];this.getWidth(r.concat(s).join(""))>this.maxWidth?(r.length>0&&t.lines.push(r.join("")),r=[s]):r.push(s),o===i-1&&r.length>0&&(t.rest=r.join(""))}return t}getWidth(e){return this.context.measureText(e).width}setText(e){this.sourceLines=e.split(`
`)}setMaxWidth(e){this.maxWidth=e}}function In(e,t,i,r,o,s,n){e.font=`${i.fontStyle||"normal"} ${i.fontWeight||"normal"} ${r}px "${i.fontFamily}"`;const a=new Ap(e);a.setText(t),a.setMaxWidth(s);const l=a.getLines().map(d=>d.replace(/\s+$/i,"")),h=Vy(r,n),c=h*o,p=h/5;return{width:s+p*2,height:l.length*c+p*2}}class Wi extends Rt{constructor(e,t){super(t);this.text=e;this.type="text";if(!Wi.measureContext){const a=document.createElement("canvas");Wi.measureContext=a.getContext("2d")}this.operation=t.createSpriteOperation();const i=this.engine.getOutputContainer(),r=this.getParent(),o=i.getBounds();this.sprite=this.operation.createText({text:e.text,position:new _e(0,0),rotation:0,fontSize:K.scalarFromSpaceToSpace(e.fontSize/o.height,r,i),lineHeight:e.lineHeight,fontIdentifier:e.fontIdentifier,alignment:e.alignment,color:ct(e.textColor),backgroundColor:ct(e.backgroundColor),maxWidth:K.scalarFromSpaceToSpace(e.width/o.width,r,i)});const s=t.assetProvider.getFontManager().getFontWithId(e.fontIdentifier);this.sprite.setFontFamily(s.fontFamily),this.sprite.setFontWeight(s.fontWeight||"normal"),this.sprite.setFontStyle(s.fontStyle||"normal"),this.sprite.setFontIdentifier(s.identifier),this.sprite.setTextMetrics(s.textMetrics),this.sprite.setPivot(new _e(0,0)),this.operation.addSprite(this.sprite);const n=In(Wi.measureContext,e.text,s,e.fontSize,e.lineHeight,e.width,s.textMetrics);this.bounds=new Me(0,0,n.width,n.height),this.setTransform(Ue.IDENTITY),this.operation.setDirty(!0)}setData(e){this.text=T(T({},this.text),e);const t=this.engine.assetProvider.getFontManager().getFontWithId(e.fontIdentifier||this.text.fontIdentifier);if(e.fontIdentifier&&(this.sprite.setFontFamily(t.fontFamily),this.sprite.setFontWeight(t.fontWeight||"normal"),this.sprite.setFontStyle(t.fontStyle||"normal"),this.sprite.setFontIdentifier(t.identifier),this.sprite.setTextMetrics(t.textMetrics)),e.id&&(this.id=e.id),e.text&&this.sprite.setText(e.text),e.fontSize){const r=this.engine.getOutputContainer(),o=this.getParent(),s=K.scalarFromSpaceToSpace(e.fontSize,o,r),n=r.getBounds();this.sprite.setFontSize(s/n.height)}if(e.alignment&&this.sprite.setAlignment(e.alignment),e.lineHeight&&this.sprite.setLineHeight(e.lineHeight),e.textColor&&this.sprite.setColor(ct(e.textColor)),e.backgroundColor&&this.sprite.setBackgroundColor(ct(e.backgroundColor)),e.width){const r=this.engine.getOutputContainer(),o=this.getParent(),s=K.scalarFromSpaceToSpace(e.width,o,r),n=r.getBounds();this.sprite.setMaxWidth(s/n.width)}const i=In(Wi.measureContext,this.text.text,t,this.text.fontSize,this.text.lineHeight,this.text.width,t.textMetrics);this.setBoundsFromSize(i.width,i.height),this.operation.setDirty(!0)}getData(){return this.text}updateData(){this.setData(this.getData())}setTransform(e){super.setTransform(e);const t=this.engine.getOutputContainer(),i=this.getParent(),r=K.pointFromSpaceToSpace(e.position,i,t,!0),o=K.absoluteToRelativePoint(r,t,!1);this.sprite.setPosition(new _e(o.x,o.y));const s=K.getRotationBetweenCoordinateSpaces(i,t);this.sprite.setRotation(e.rotation+s),this.operation.setDirty(!0)}setPivot(e,t){this.setPivotOnSelfAndSprite(this.sprite,e,t)}getOperation(){return this.operation}setFlipHorizontally(e){this.sprite.setRotation(this.getFlippedRotation({flipHorizontally:e})),this.sprite.setFlipHorizontally(e)}setFlipVertically(e){this.sprite.setRotation(this.getFlippedRotation({flipVertically:e})),this.sprite.setFlipVertically(e)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}getFlippedRotation({flipVertically:e,flipHorizontally:t}){const i=e||this.getFlipVertically(),r=t||this.getFlipHorizontally();let o=this.getRotation();return(i||r)&&(o=Fp(o)),o}}const Sl=1e3;class rs extends Rt{constructor(e,t,i){super(i);this.textDesign=e;this.layout=t;this.type="text-design";this.currentLayoutSize=void 0;this.layoutID=t.identifier,this.operation=i.createSpriteOperation();const r=this.engine.getOutputContainer(),o=this.getParent(),s=r.getBounds(),n=Math.min(s.width,s.height);t.seed(e.seed),this.bounds=this.calculateBounds(this.textDesign,this.layout);const a=e.width;this.sprite=this.operation.createTextDesign({text:e.text,layout:t,inverted:e.inverted,color:ct(e.color),width:K.scalarFromSpaceToSpace(e.width/n,o,r),padding:e.padding/a,seed:e.seed}),this.updatePivot(),this.operation.addSprite(this.sprite),this.setTransform(Ue.IDENTITY),this.operation.setDirty(!0)}static stringify(e){return JSON.stringify(e,rs.serializer())}static serializer(){const e=[],t=[],i=(r,o)=>e[0]===o?"[Circular ~]":`[Circular ~.${t.slice(0,e.indexOf(o)).join(".")}]`;return function(o,s){const n=this;if(e.length>0){const a=e.indexOf(n);~a?(e.splice(a+1),t.splice(a,Infinity,o)):(e.push(n),t.push(o)),~e.indexOf(s)&&(s=i.call(n,o,s))}else e.push(s);return s}}calculateBounds(e,t,i=!0){const r=e.inverted&&i?Math.max(0,2*e.padding):0,o=e.width/Sl;if(this.currentLayoutSize===void 0){t.seed(e.seed);const s=t.generateLayoutData(e.text,Sl);this.currentLayoutData=s,this.currentLayoutSize=s.getSize()}return new Me(0,0,this.currentLayoutSize.width*o+r,this.currentLayoutSize.height*o+r)}findNextUniqueSeed(e,t,i){let r=i;const o=this.currentLayoutData?rs.stringify(this.currentLayoutData.getRows()):"";let s;for(let n=0;n<20&&(t.seed(r),s=t.generateLayoutData(e.text,Sl),o===rs.stringify(s.getRows()));n+=1)r+=1;return t.seed(r),this.currentLayoutData=s,r}setData(e){if(this.textDesign=T(T({},this.textDesign),e),e.id&&(this.id=e.id),e.padding!==void 0){const t=this.textDesign.width;this.sprite.setPadding(e.padding/t)}else e.width&&(this.textDesign.padding=this.sprite.getPadding()*this.textDesign.width);if(e.seed!==void 0&&(e.seed<0&&(e.seed=this.findNextUniqueSeed(this.textDesign,this.layout,Date.now()),this.textDesign.seed=e.seed),this.currentLayoutSize=void 0,this.layout.seed(e.seed),this.sprite.setSeed(e.seed),this.sprite.setLayout(this.layout)),e.color&&this.sprite.setColor(ct(e.color)),e.inverted!==void 0&&this.sprite.setInverted(e.inverted),e.text&&(this.currentLayoutSize=void 0,this.sprite.setText(e.text)),e.width){const t=this.engine.getOutputContainer(),i=this.getParent(),r=t.getBounds(),o=Math.min(r.width,r.height),s=K.scalarFromSpaceToSpace(e.width/o,i,t);this.sprite.setWidth(s)}if(e.padding!==void 0||e.seed!==void 0||e.inverted!==void 0||e.text||e.width){const t=this.calculateBounds(this.textDesign,this.layout);this.setBoundsFromSize(t.width,t.height),this.updatePivot()}this.operation.setDirty(!0)}getData(){return this.textDesign}updateData(){this.setData(this.getData())}setTransform(e){super.setTransform(e);const t=this.engine.getOutputContainer(),i=this.getParent();if(e.scale.x!==1||e.scale.y!==1)throw new Error("This engine doesn't support scaling TextDesign containers! You can change the bounds using the width property of the TextDesign data.");const r=K.pointFromSpaceToSpace(e.position,i,t,!0),o=K.absoluteToRelativePoint(r,t,!1);this.sprite.setPosition(new _e(o.x,o.y));const s=K.getRotationBetweenCoordinateSpaces(i,t);this.sprite.setRotation(e.rotation+s),this.operation.setDirty(!0)}setPivot(e,t){typeof e=="number"?super.setPivot(e,t):super.setPivot(e),this.updatePivot()}getOperation(){return this.operation}getLayoutID(){return this.layoutID}setFlipHorizontally(e){this.sprite.setFlipHorizontally(e)}setFlipVertically(e){this.sprite.setFlipVertically(e)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}updatePivot(){const e=this.textDesign.inverted?Math.max(0,this.textDesign.padding):0,t=new j(this.bounds.width-2*e,this.bounds.height-2*e),i=this.getPivot(),r=new j(i.x*this.bounds.width,i.y*this.bounds.height),o=new j(e,e),s=r.subtract(o),n=s.divide(t);this.sprite.setPivot(new _e(n.x,n.y))}}const{BLEND_MODES:Ge}=U.Operations.OverlayOperation,Pn="imgly_font_open_sans_bold";class Hy extends xp{constructor(e){super(e);this.previews=Array();this.rootOperationStack=[];this.deferredRenderQueue=[];this.operationStackOffset=1;this.enforceOperationOrder=()=>{this.refreshFlipIndex(),this.refreshFrameIndex()};if(this.assetProvider=e.assetProvider||new hp,this.wrapper=new Si({license:e.license,crossOrigin:e.crossOrigin,assets:{resolver:(t,i)=>this.resolveAssetForSDK(t,i)},editor:{preferredRenderer:e.preferredRenderer,pixelRatio:1}}),this.editor=this.wrapper.getEditor(),this.sdk=this.editor.getSDK(),this.sdk.setRenderMode("adapter"),this.tempCanvas=document.createElement("canvas"),this.sdk.setCanvas(this.tempCanvas),e.preferredRenderer==="webgl"){const t=document.createElement("canvas"),i=t.getContext("webgl")||t.getContext("experimental-webgl");this.maxTextureDimension=i.getParameter(i.MAX_TEXTURE_SIZE)}else this.maxTextureDimension=Infinity}get configuration(){return this.config}get pesdk(){return this.sdk}get rootOperations(){return this.rootOperationStack}dispose(){this.pesdk.dispose(),this.wrapper.dispose()}render(e){return new Promise(t=>{const i=()=>new Promise(r=>{const{canvas:o}=e,s=e.getTransform(),n=this.outputContainer.getPivot(),a=e.getCanvasBounds(),l=e.quality,{tempCanvas:h}=this;this.sdk.setTextureQuality(l);const c=this.sdk.getOutputDimensions();return h.width=c.x,h.height=c.y,this.sdk.getRenderer().resizeTo(new _e(h.width,h.height)),this.sdk.render(!0).then(()=>{const p=o.getContext("2d");p.clearRect(0,0,o.width,o.height),p.save(),p.translate(-a.minX,-a.minY),p.translate(s.position.x,s.position.y),p.rotate(s.rotation),p.scale(s.scale.x,s.scale.y),p.translate(-n.x*h.width,-n.y*h.height),p.scale(1/e.quality,1/e.quality),p.drawImage(h,0,0),p.restore(),t(),this.deferredRenderQueue.shift(),this.deferredRenderQueue.length?(this.sdk.setAllOperationsToDirty(),Promise.resolve(this.deferredRenderQueue[0]().then(r))):r()})});this.deferredRenderQueue.push(i),this.deferredRenderQueue.length===1&&i()})}createPreview(e){const t=new yp(e,this);return this.previews.push(t),t}export(){return Ae(this,arguments,function*(e=qt.IMAGE,t=Ei.PNG,i=1){return new Promise(r=>{const o=()=>new Promise(s=>this.sdk.export(this.mapToRenderType(e),this.mapToImageFormat(t),i).then(n=>{r(n),this.deferredRenderQueue.shift(),this.deferredRenderQueue.length?Promise.resolve(this.deferredRenderQueue[0]().then(s)):s()}));this.deferredRenderQueue.push(o),this.deferredRenderQueue.length===1&&o()})})}getRootContainers(){return[this.rootContainer]}getOutputContainer(){return this.outputContainer}findContainerByID(e){return e===this.rootContainer.getID()?this.rootContainer:this.rootOperationStack.find(t=>t.getID()===e)}findEffectByID(e){return this.rootOperationStack.find(t=>t.getID()===e)}addImage(e,t,i){if(this.rootContainer)throw new Error("A background image already exists - did you mean to use addSticker?");const r=new vl(e,this);if(this.rootContainer=r,!this.outputContainer){const{width:o,height:s}=r.getBounds(),n={resolution:{width:o,height:s},flipHorizontally:!1,flipVertically:!1},a=this.sdk.createOperation("output",{},!1),l=this.sdk.createOperation("flip",{},!1);this.insertIntoOperationsStack(a,this.operationStackOffset-1),this.insertIntoOperationsStack(l,this.operationStackOffset),this.outputContainer=new wl(n,a,l,this)}return r}addSticker(e,t,i){if(!t)throw new Error("This engine does not support adding stickers as root elements.");this.ensureContainerIsRoot(t);const r=new Dl(e,this);return this.addToStackAtIndex(r,i),r}addStickerFromAssets(e,t,i){if(!t)throw new Error("This engine does not support adding stickers as root elements.");return this.ensureContainerIsRoot(t),new Promise((r,o)=>{const s=new Image;s.onload=()=>{const n={image:s,opacity:1},a=new Dl(n,this);this.addToStackAtIndex(a,i),r(a)},s.onerror=n=>{o(n)},s.crossOrigin=this.config.crossOrigin||null,s.src=this.assetProvider.getAssetSource("sticker",e)})}addText(e,t,i){if(!t)throw new Error("This engine does not support adding text as root elements.");const r=this.assetProvider.getFontManager();if(!r.isFontLoaded(e.fontIdentifier||Pn))throw new Error("Adding text synchronously only works if the required font is already loded! Consider using the asynchronous addTextWithFontLoading function instead!");this.ensureContainerIsRoot(t);const o=T({text:"",fontIdentifier:Pn,fontSize:20,lineHeight:1,alignment:"center",textColor:[1,1,1],backgroundColor:[0,0,0,0],width:100},e),s=new Wi(o,this);return this.addToStackAtIndex(s,i),s}addTextWithFontLoading(e,t,i){if(!t)throw new Error("This engine does not support adding text as root elements.");const r=this.assetProvider.getFontManager(),o=e.fontIdentifier||Pn;return new Promise((s,n)=>{r.loadFontWithIdentifier(o).then(()=>{this.ensureContainerIsRoot(t);const a=T({text:"",fontIdentifier:Pn,fontSize:20,lineHeight:1,alignment:"center",textColor:[1,1,1],backgroundColor:[0,0,0,0],width:100},e),l=new Wi(a,this);this.addToStackAtIndex(l,i),s(l)}).catch(n)})}addTextDesignAsync(e="imgly_text_design_blocks",t,i,r){return Ae(this,null,function*(){if(!i)throw new Error("This engine does not support adding TextDesign as a root element.");const o=T({seed:Date.now(),padding:0,text:"",color:[0,0,0],inverted:!1,width:100},t),s=this.wrapper.getTextDesignLayoutByID(e);if(!s)throw new Error(`The layout could not be loaded for the given id: ${e}`);const n=s.getImagePaths().map(d=>{const m=d.split("/").pop()||"";return{path:d,fullPath:this.assetProvider.getAssetSource("textdesign",m)}}),a=this.wrapper.getTextDesignAssetManager(),l=this.wrapper.getTextDesignFontManager(),h=l.getVariationsByIdentifier();a.setFonts(h),yield a.loadImages(n),s.onImagesLoaded();const c=Object.keys(h),p=this.assetProvider.getFontManager();return p.loadFontsWithIdentifiers(c).then(()=>{this.ensureContainerIsRoot(i);const d=new rs(o,s,this);return this.addToStackAtIndex(d,r),Promise.resolve(d)})})}addDrawing(e,t,i){if(!t)throw new Error("This engine does not support DrawingContainers as root elements.");this.ensureContainerIsRoot(t);const r=new wp(e,this);return this.addToStackAtIndex(r,i),r}addGaussianBlur(e,t,i){this.ensureContainerIsRoot(t);const r=new Cp(e,this,this.sdk.createOperation("blur",{},!1));return this.addToStackAtIndex(r,i),r}addRadialBlur(e,t,i){this.ensureContainerIsRoot(t);const r=new Op(e,this,this.sdk.createOperation("radial-focus",{},!1));return this.addToStackAtIndex(r,i),r}addMirroredBlur(e,t,i){this.ensureContainerIsRoot(t);const r=new kp(e,this,this.sdk.createOperation("mirrored-focus",{},!1));return this.addToStackAtIndex(r,i),r}addLinearBlur(e,t,i){this.ensureContainerIsRoot(t);const r=new Ep(e,this,this.sdk.createOperation("linear-focus",{},!1));return this.addToStackAtIndex(r,i),r}addDuoToneFilter(e,t,i){throw new Error("Not supported! Use addDuoToneFilterFromAssets instead")}addDuoToneFilterFromAssets(e,t,i){this.ensureContainerIsRoot(t);const r=this.sdk.getOperationsStack(),o=r.getByIdentifier("filter");if(o&&o.getIdentifier()!==e)throw new Error("This engine doesn't support multiple types of filter operations at once!");const s=o||this.sdk.createOperation("filter",{},!1);return new Promise((n,a)=>{try{const l=this.assetProvider.getDuotoneFilterAsset(e),h={colorIntensity:l.defaultIntensity||0},c=new U.Operations.FilterOperation.Filters.DuoToneFilter({intensity:h.colorIntensity,lightColor:U.Color.fromHex(l.lightColor),darkColor:U.Color.fromHex(l.darkColor)}),p=new Tp(c,s,h,this);this.addToStackAtIndex(p,i),n(p)}catch(l){l&&a(l)}})}addLUTFilter(e,t,i){throw new Error("Not supported! Use addLUTFilterFromAssets instead")}addLUTFilterFromAssets(e,t,i){this.ensureContainerIsRoot(t);const r=this.sdk.getOperationsStack(),o=r.getByIdentifier("filter");if(o&&o.getIdentifier()!==e)throw new Error("This engine doesn't support multiple types filter operations at once!");const s=o||this.sdk.createOperation("filter",{},!1);return new Promise((n,a)=>{const l=new Image;l.addEventListener("load",()=>{const h=this.assetProvider.getLUTFilterAsset(e),c={horizontalTileCount:h.horizontalTileCount||5,verticalTileCount:h.verticalTileCount||5,intensity:h.defaultIntensity||1},p=new U.Operations.FilterOperation.Filters.ThreeDLUTFilter(T(T({},c),{image:l})),d=T(T({},c),{lutImage:new Image}),m=new Rp(p,s,d,this);this.addToStackAtIndex(m,i),n(m)}),l.addEventListener("error",h=>{a(h)}),l.crossOrigin=this.config.crossOrigin||null,l.src=this.assetProvider.getAssetSource("filter",e)})}addAdjustments(e,t,i){this.ensureContainerIsRoot(t);const r=new vp(e,this,this.sdk.createOperation("adjustments",{},!1));return this.addToStackAtIndex(r,i),r}addOverlay(e,t,i){this.ensureContainerIsRoot(t);const r=new Tl(this.sdk.createOperation("overlay",{},!1),e,this);return this.addToStackAtIndex(r,i),r}addOverlayFromAssets(e,t,i){return this.ensureContainerIsRoot(t),new Promise((r,o)=>{const s=this.sdk.getOperationsStack(),n=s.getByIdentifier("overlay");n&&n.getIdentifier()!==e&&s.remove(n);const a=n||this.sdk.createOperation("overlay",{},!1),l=new Image;l.onload=()=>{const h={image:l,opacity:1,blendMode:oe.NORMAL},c=new Tl(a,h,this);this.addToStackAtIndex(c,i),r(c)},l.onerror=h=>{o(h)},l.crossOrigin=this.config.crossOrigin||null,l.src=this.assetProvider.getAssetSource("overlay",e)})}addFrame(e,t,i){throw new Error("Not supported!")}addFrameFromAssets(e,t,i){return Ae(this,null,function*(){this.ensureContainerIsRoot(t);const r=this.assetProvider.getFrameAsset(e);if(!r)throw new Error(`The requested asset does not exist! ${e}`);const o=new Dp(r,this);yield o.load();const s=this.getOutputContainer().getBounds(),n=Math.min(s.width,s.height),a=this.sdk.createOperation("frame",{},!1);a.setFrame(o.getFrame());const l={opacity:1,tintColor:[1,1,1],tintable:!1,width:Math.max(1,.1*n),imageGroups:o.getFrame().imageGroups},h=new Sp(a,l,this);return this.addToStackAtIndex(h,i),Promise.resolve(h)})}removeEffect(e){if(!e.isValid())return;const t=e,i=t.getOperation();this.sdk.removeOperation(i),this.sdk.setAllOperationsToDirty(),this.rootOperationStack.splice(e.getIndexInParent(),1)}removeContainer(e){if(!e.isValid()||e.type==="output")return;const t=e,i=t.getOperation();this.sdk.removeOperation(i),this.sdk.setAllOperationsToDirty(),this.rootOperationStack.splice(e.getIndexInParent(),1)}refreshOutputIndex(){const e=this.sdk.getOperationsStack().getIndexByIdentifier("output");this.moveInOperationsStack(e,this.operationStackOffset-1)}refreshFlipIndex(){const e=this.sdk.getOperationsStack().getIndexByIdentifier("flip"),t=this.sdk.getOperationsStack().getStack().length-1;e!==t&&this.moveInOperationsStack(e,t)}refreshFrameIndex(){const e=this.sdk.getOperationsStack().getIndexByIdentifier("frame"),t=this.sdk.getOperationsStack().getStack().length-1;e!==-1&&e!==t&&this.moveInOperationsStack(e,t)}mapToRenderType(e){switch(e){case qt.IMAGE:return U.RenderType.IMAGE;case qt.DATA_URL:return U.RenderType.DATAURL;case qt.BLOB:return U.RenderType.BLOB;case qt.MSBLOB:return U.RenderType.MSBLOB;default:return U.RenderType.IMAGE}}mapToImageFormat(e){switch(e){case Ei.PNG:return U.ImageFormat.PNG;case Ei.JPEG:return U.ImageFormat.JPEG;default:return null}}mapBlendMode(e){switch(e){case Ge.NORMAL:return oe.NORMAL;case Ge.OVERLAY:return oe.OVERLAY;case Ge.HARD_LIGHT:return oe.HARD_LIGHT;case Ge.SOFT_LIGHT:return oe.SOFT_LIGHT;case Ge.MULTIPLY:return oe.MULTIPLY;case Ge.DARKEN:return oe.DARKEN;case Ge.LIGHTEN:return oe.LIGHTEN;case Ge.SCREEN:return oe.SCREEN;case Ge.COLOR_BURN:return oe.COLOR_BURN;default:return oe.NORMAL}}reverseMapBlendMode(e){switch(e){case oe.NORMAL:return Ge.NORMAL;case oe.OVERLAY:return Ge.OVERLAY;case oe.HARD_LIGHT:return Ge.HARD_LIGHT;case oe.SOFT_LIGHT:return Ge.SOFT_LIGHT;case oe.MULTIPLY:return Ge.MULTIPLY;case oe.DARKEN:return Ge.DARKEN;case oe.LIGHTEN:return Ge.LIGHTEN;case oe.SCREEN:return Ge.SCREEN;case oe.COLOR_BURN:return Ge.COLOR_BURN;default:return Ge.NORMAL}}createSpriteOperation(){return this.sdk.createOperation("sprite",{},!1)}moveIndex(e,t){const i=this.getSiblingIndex(e);if(i===-1)throw new Error("The item to be moved is not part of any stack.");this.moveInStack(this.rootOperationStack,i,t);const r=this.operationStackOffset;this.moveInOperationsStack(i+r,t+r),this.enforceOperationOrder()}ensureContainerIsRoot(e){const t=e.getID();if(t!==this.rootContainer.getID())throw new Error("This engine doesn't support adding this effect/container to anything other than the root image container")}addToStackAtIndex(e,t){if(t&&t<0)throw new Error(`The given index may not be negative: ${t}`);t===void 0?this.rootOperationStack.push(e):this.rootOperationStack.splice(t,0,e);const i=this.rootOperationStack.length-1;let r=t!==void 0?t:i;r+=this.operationStackOffset,bp(e)?this.insertIntoOperationsStack(e.getOperation(),r):this.insertIntoOperationsStack(e.getOperation(),r),this.sdk.setAllOperationsToDirty()}insertIntoOperationsStack(e,t){const i=this.sdk.getOperationsStack().getStack(),r=i.length,o=Math.max(Math.min(t,r),0);for(let s=r-1;s>=o;s-=1){const n=i[s];i[s+1]=n}i[o]=e,this.sdk.setAllOperationsToDirty(),this.enforceOperationOrder()}moveInStack(e,t,i){const r=e.length,o=Math.max(Math.min(t,r-1),0),s=Math.max(Math.min(i,r-1),0);if(o===s)return;const n=e[o];if(o<s)for(let a=o+1;a<=s;a+=1)e[a-1]=e[a];else for(let a=o-1;a>=s;a-=1)e[a+1]=e[a];e[s]=n}moveInOperationsStack(e,t){const i=this.sdk.getOperationsStack().getStack(),r=i.length,o=Math.min(Math.max(0,e),r-1),s=Math.min(Math.max(0,t),r-1);if(o===s)return;const n=i[o];if(o<s)for(let a=o+1;a<=s;a+=1)i[a-1]=i[a];else for(let a=o-1;a>=s;a-=1)i[a+1]=i[a];i[s]=n,this.sdk.getOperationsStack().setAllToDirty()}getSiblingIndex(e){return e.getIndexInParent()}resolveAssetForSDK(e,t){t=t;switch(e){case"filter":return this.assetProvider.getAssetSource("filter",t.identifier);case"overlay":return this.assetProvider.getAssetSource("overlay",t.identifier);case"font":return this.assetProvider.getAssetSource("font",t.identifier)}return""}}export{Fo as a,Ur as b,Je as c,qt as d,Ei as e,Ao as f,Yl as g,Xe as h,B as i,Ri as j,oe as k,ql as l,Fp as m,is as n,tp as o,gl as p,v3 as q,os as r,Jo as s,ip as t,Ip as u,Gl as v,Vl as w,pp as x,Ue as y,ap as z,bn as A,j as B,jl as C,Ul as D,Kl as E,En as F,Hl as G,mp as H,T as I,Wl as J,gp as K,fp as L,tx as M,De as N,Fy as O,Fe as P,U as Q,aU as R,Ne as S,$b as T,hp as U,In as V,Ae as W,Ut as X,Hy as Y,K as Z};
/*
 * Based on https://github.com/exif-js/exif-js by Jacob Seidelin
 * Licensed under MIT
 * @license
 */
/*
 * Extracted from MinifyJpeg (Copyright (c) 2014 Hiroaki Matoba, MIT License):
 * https://github.com/hMatoba/MinifyJpeg
 * @license
 */
/*
 * http://paulirish.com/2011/requestanimationframe-for-smart-animating/
 * http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
 * requestAnimationFrame polyfill by Erik Mller. fixes from Paul Irish and Tino Zijdel
 * MIT license
 * @license
 */
/*!
 *  Secure Hash Algorithm (SHA256)
 *  http://www.webtoolkit.info/
 *
 *  Original code by Angel Marin, Paul Johnston.
 */
/*!
 * Copyright (c) 2003-2005  Tom Wu
 * All Rights Reserved.
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY
 * WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
 *
 * IN NO EVENT SHALL TOM WU BE LIABLE FOR ANY SPECIAL, INCIDENTAL,
 * INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND, OR ANY DAMAGES WHATSOEVER
 * RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER OR NOT ADVISED OF
 * THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF LIABILITY, ARISING OUT
 * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * In addition, the following condition applies:
 *
 * All redistributions must retain an intact copy of this copyright notice
 * and disclaimer.
 */
/*!
 * Native Promise Only
 * v0.8.0-a (c) Kyle Simpson
 * MIT License: http://getify.mit-license.org
 */
/*!
StackBlur - a fast almost Gaussian Blur For Canvas

Version:  0.5
Author:   Mario Klingemann
Contact:  mario@quasimondo.com
Website:  http://www.quasimondo.com/StackBlurForCanvas
Twitter:  @quasimondo

In case you find this class useful - especially in commercial projects -
I am not totally unhappy for a small donation to my PayPal account
mario@quasimondo.de

Or support me on flattr:
https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript

Copyright (c) 2010 Mario Klingemann

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
@license
*/
/*! https://mths.be/punycode v1.3.2 by @mathias */
