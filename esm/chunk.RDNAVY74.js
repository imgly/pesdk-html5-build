import{A as or,B as D,C as se,E as Gl,F as Do,H as Rf,I as p,K as Af,L as Ff,M as Gf,N as uo,O as Gy,P as lp,Q as Jy,R as by,S as m,U as qf,V as oc,W as I,X as Re,Y as ss,Z as hc,a as fe,b as Gn,c as f,d as Ni,e as Mt,f as Nf,g as Er,h as Xe,i as g,j as K,k as zt,m as Kn,n as dc,o as ky,p as bo,q as Oy,r as Sy,t as su,u as vy,x as Mf,y as Qt,z as Uy}from"./chunk.A5US3YH5.js";var ca=Object.getOwnPropertySymbols,xu=Object.getOwnPropertyDescriptor,Cu=Object.prototype.propertyIsEnumerable,Ge=(e,t)=>{var i={};for(var r in e)vy.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(e!=null&&ca)for(var r of ca(e))t.indexOf(r)<0&&Cu.call(e,r)&&(i[r]=e[r]);return i},s=(e,t,i,r)=>{for(var o=r>1?void 0:r?xu(t,i):t,n=e.length-1,a;n>=0;n--)(a=e[n])&&(o=(r?a(t,i,o):a(o))||o);return r&&o&&Sy(t,i,o),o};var b=uo((_u,hn)=>{lp(_u,{$mobx:()=>dl,IDerivationState:()=>G,ObservableMap:()=>hr,ObservableSet:()=>pr,Reaction:()=>yr,_allowStateChanges:()=>ih,_allowStateChangesInsideComputed:()=>rh,_endAction:()=>Ma,_getAdministration:()=>St,_getGlobalState:()=>lh,_interceptReads:()=>Ih,_isComputingDerivation:()=>Yu,_resetGlobalState:()=>ch,_startAction:()=>Ra,action:()=>Xt,autorun:()=>An,comparer:()=>fi,computed:()=>Ea,configure:()=>Ch,createAtom:()=>ba,decorate:()=>_h,entries:()=>Lh,extendObservable:()=>_n,extendShallowObservable:()=>Eh,flow:()=>Oh,get:()=>Hh,getAtom:()=>qe,getDebugName:()=>co,getDependencyTree:()=>Ha,getObserverTree:()=>kh,has:()=>Qa,intercept:()=>Rh,isAction:()=>Sh,isArrayLike:()=>Mu,isBoxedObservable:()=>Fn,isComputed:()=>Mh,isComputedProp:()=>zh,isObservable:()=>Ai,isObservableArray:()=>ke,isObservableMap:()=>ye,isObservableObject:()=>Ae,isObservableProp:()=>Ph,isObservableSet:()=>Fe,keys:()=>Pi,observable:()=>ve,observe:()=>Uh,onBecomeObserved:()=>ga,onBecomeUnobserved:()=>Dn,onReactionError:()=>hh,reaction:()=>xh,remove:()=>Nh,runInAction:()=>vh,set:()=>Za,spy:()=>Ua,toJS:()=>Vh,trace:()=>ja,transaction:()=>wt,untracked:()=>Tn,values:()=>Bh,when:()=>Xh});var pn=function(e,t){return pn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var o in r)r.hasOwnProperty(o)&&(i[o]=r[o])},pn(e,t)};function da(e,t){pn(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}var Ee=function(){return Ee=Object.assign||function(t){for(var i,r=1,o=arguments.length;r<o;r++){i=arguments[r];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},Ee.apply(this,arguments)};function ua(e,t){var i=typeof Symbol=="function"&&e[Symbol.iterator];if(!i)return e;var r=i.call(e),o,n=[],a;try{for(;(t===void 0||t-- >0)&&!(o=r.next()).done;)n.push(o.value)}catch(l){a={error:l}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(a)throw a.error}}return n}function fn(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ua(arguments[t]));return e}var Eu="An invariant failed, however the error is obfuscated because this is an production build.",Jr=[];Object.freeze(Jr);var mn={};Object.freeze(mn);var ku={};function Ii(){return typeof window!="undefined"?window:typeof global!="undefined"?global:ku}function Ie(){return++x.mobxGuid}function B(e){throw it(!1,e),"X"}function it(e,t){if(!e)throw new Error("[mobx] "+(t||Eu))}var ha=[];function rt(e,t){return!1;if(t)return rt("'"+e+"', use '"+t+"' instead.");if(ha.indexOf(e)!==-1)return!1}function gn(e){var t=!1;return function(){return t?void 0:(t=!0,e.apply(this,arguments))}}var Zr=function(){};function Tu(e){var t=[];return e.forEach(function(i){t.indexOf(i)===-1&&t.push(i)}),t}function bn(e){return e!==null&&typeof e=="object"}function hi(e){if(e===null||typeof e!="object")return!1;var t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}function Ou(e){return Fi(e)||ye(e)?e:Array.isArray(e)?new Map(e):hi(e)?new Map(Object.entries(e)):B("Cannot convert to map from '"+e+"'")}function Iu(e,t){for(var i=0;i<t.length;i++)pi(e,t[i],e[t[i]])}function pi(e,t,i){Object.defineProperty(e,t,{enumerable:!1,writable:!0,configurable:!0,value:i})}function ar(e,t,i){Object.defineProperty(e,t,{enumerable:!1,writable:!1,configurable:!0,value:i})}function Fu(e,t){var i=Object.getOwnPropertyDescriptor(e,t);return!i||i.configurable!==!1&&i.writable!==!1}function Au(e,t){}function Ut(e,t){var i="isMobX"+e;return t.prototype[i]=!0,function(r){return bn(r)&&r[i]===!0}}function Ru(e,t){return typeof e=="number"&&typeof t=="number"&&isNaN(e)&&isNaN(t)}function Mu(e){return Array.isArray(e)||ke(e)}function Fi(e){return Ii().Map!==void 0&&e instanceof Ii().Map}function lr(e){return e instanceof Set}function Ot(e){for(var t=[];;){var i=e.next();if(i.done)break;t.push(i.value)}return t}function pa(){return typeof Symbol=="function"&&Symbol.toPrimitive||"@@toPrimitive"}function fa(e){return e===null?null:typeof e=="object"?""+e:e}function yn(){return typeof Symbol=="function"&&Symbol.iterator||"@@iterator"}function vn(e,t){ar(e,yn(),t)}function cr(e){return e[yn()]=zu,e}function Sn(){return typeof Symbol=="function"&&Symbol.toStringTag||"@@toStringTag"}function zu(){return this}var Qr=function(){function e(t){t===void 0&&(t="Atom@"+Ie()),this.name=t,this.isPendingUnobservation=!1,this.isBeingObserved=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.lastAccessedBy=0,this.lowestObserverState=G.NOT_TRACKING}return e.prototype.onBecomeUnobserved=function(){},e.prototype.onBecomeObserved=function(){},e.prototype.reportObserved=function(){return ma(this)},e.prototype.reportChanged=function(){ot(),Pu(this),nt()},e.prototype.toString=function(){return this.name},e}(),wn=Ut("Atom",Qr);function ba(e,t,i){t===void 0&&(t=Zr),i===void 0&&(i=Zr);var r=new Qr(e);return ga(r,t),Dn(r,i),r}function ya(e,t){return e===t}function Bu(e,t){return xn(e,t)}function Lu(e,t){return xn(e,t,1)}function Nu(e,t){return Ru(e,t)||ya(e,t)}var fi={identity:ya,structural:Bu,default:Nu,shallow:Lu},Hu={},ju={};function Wu(e,t){var i=t?Hu:ju;return i[e]||(i[e]={configurable:!0,enumerable:t,get:function(){return mi(this),this[e]},set:function(r){mi(this),this[e]=r}})}function mi(e){if(e.__mobxDidRunLazyInitializers===!0)return;var t=e.__mobxDecorators;if(t){pi(e,"__mobxDidRunLazyInitializers",!0);for(var i in t){var r=t[i];r.propertyCreator(e,r.prop,r.descriptor,r.decoratorTarget,r.decoratorArguments)}}}function Sa(e,t){return function(){var r,o=function(a,l,c,d){if(d===!0)return t(a,l,c,a,r),null;if(!Object.prototype.hasOwnProperty.call(a,"__mobxDecorators")){var u=a.__mobxDecorators;pi(a,"__mobxDecorators",Ee({},u))}return a.__mobxDecorators[l]={prop:l,propertyCreator:t,descriptor:c,decoratorTarget:a,decoratorArguments:r},Wu(l,e)};return va(arguments)?(r=Jr,o.apply(null,arguments)):(r=Array.prototype.slice.call(arguments),o)}}function va(e){return(e.length===2||e.length===3)&&typeof e[1]=="string"||e.length===4&&e[3]===!0}function dr(e,t,i){return Ai(e)?e:Array.isArray(e)?ve.array(e,{name:i}):hi(e)?ve.object(e,void 0,{name:i}):Fi(e)?ve.map(e,{name:i}):lr(e)?ve.set(e,{name:i}):e}function Uu(e,t,i){return e==null||(Ae(e)||ke(e)||ye(e)||Fe(e))?e:Array.isArray(e)?ve.array(e,{name:i,deep:!1}):hi(e)?ve.object(e,void 0,{name:i,deep:!1}):Fi(e)?ve.map(e,{name:i,deep:!1}):lr(e)?ve.set(e,{name:i,deep:!1}):B(!1)}function ur(e){return e}function $u(e,t,i){return xn(e,t)?t:e}function eo(e){var t=Sa(!0,function(r,o,n,a,l){var c=n?n.initializer?n.initializer.call(r):n.value:void 0;wa(r,o,c,e)}),i=typeof process!="undefined"&&process.env&&!1?function(){return arguments.length<2?B("Incorrect decorator invocation. @observable decorator doesn't expect any arguments"):t.apply(null,arguments)}:t;return i.enhancer=e,i}var Da={deep:!0,name:void 0,defaultDecorator:void 0},xa={deep:!1,name:void 0,defaultDecorator:void 0};Object.freeze(Da);Object.freeze(xa);function Ri(e){return e==null?Da:typeof e=="string"?{name:e,deep:!0}:e}function to(e){return e.defaultDecorator?e.defaultDecorator.enhancer:e.deep===!1?ur:dr}var Cn=eo(dr),Vu=eo(Uu),Ca=eo(ur),Gu=eo($u);function qu(e,t,i){if(typeof arguments[1]=="string")return Cn.apply(null,arguments);if(Ai(e))return e;var r=hi(e)?ve.object(e,t,i):Array.isArray(e)?ve.array(e,t):Fi(e)?ve.map(e,t):lr(e)?ve.set(e,t):e;if(r!==e)return r;B(!1)}var _a={box:function(e,t){arguments.length>2&&It("box");var i=Ri(t);return new $t(e,to(i),i.name,!0,i.equals)},shallowBox:function(e,t){return arguments.length>2&&It("shallowBox"),rt("observable.shallowBox","observable.box(value, { deep: false })"),ve.box(e,{name:t,deep:!1})},array:function(e,t){arguments.length>2&&It("array");var i=Ri(t);return new Ft(e,to(i),i.name)},shallowArray:function(e,t){return arguments.length>2&&It("shallowArray"),rt("observable.shallowArray","observable.array(values, { deep: false })"),ve.array(e,{name:t,deep:!1})},map:function(e,t){arguments.length>2&&It("map");var i=Ri(t);return new hr(e,to(i),i.name)},shallowMap:function(e,t){return arguments.length>2&&It("shallowMap"),rt("observable.shallowMap","observable.map(values, { deep: false })"),ve.map(e,{name:t,deep:!1})},set:function(e,t){arguments.length>2&&It("set");var i=Ri(t);return new pr(e,to(i),i.name)},object:function(e,t,i){typeof arguments[1]=="string"&&It("object");var r=Ri(i);return _n({},e,t,r)},shallowObject:function(e,t){return typeof arguments[1]=="string"&&It("shallowObject"),rt("observable.shallowObject","observable.object(values, {}, { deep: false })"),ve.object(e,{},{name:t,deep:!1})},ref:Ca,shallow:Vu,deep:Cn,struct:Gu},ve=qu;Object.keys(_a).forEach(function(e){return ve[e]=_a[e]});function It(e){B("Expected one or two arguments to observable."+e+". Did you accidentally try to use observable."+e+" as decorator?")}var io=Sa(!1,function(e,t,i,r,o){var n=i.get,a=i.set,l=o[0]||{};Xu(e,t,Ee({get:n,set:a},l))}),Ku=io({equals:fi.structural}),Ea=function(t,i,r){if(typeof i=="string")return io.apply(null,arguments);if(t!==null&&typeof t=="object"&&arguments.length===1)return io.apply(null,arguments);var o=typeof i=="object"?i:{};return o.get=t,o.set=typeof i=="function"?i:o.set,o.name=o.name||t.name||"",new Vt(o)};Ea.struct=Ku;var G;(function(e){e[e.NOT_TRACKING=-1]="NOT_TRACKING",e[e.UP_TO_DATE=0]="UP_TO_DATE",e[e.POSSIBLY_STALE=1]="POSSIBLY_STALE",e[e.STALE=2]="STALE"})(G||(G={}));var st;(function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"})(st||(st={}));var ro=function(){function e(t){this.cause=t}return e}();function fr(e){return e instanceof ro}function En(e){switch(e.dependenciesState){case G.UP_TO_DATE:return!1;case G.NOT_TRACKING:case G.STALE:return!0;case G.POSSIBLY_STALE:{for(var t=Mi(),i=e.observing,r=i.length,o=0;o<r;o++){var n=i[o];if(zi(n)){if(x.disableErrorBoundaries)n.get();else try{n.get()}catch(a){return Gt(t),!0}if(e.dependenciesState===G.STALE)return Gt(t),!0}}return ka(e),Gt(t),!1}}}function Yu(){return x.trackingDerivation!==null}function oo(e){var t=e.observers.length>0;x.computationDepth>0&&t&&B(!1),!x.allowStateChanges&&(t||x.enforceActions==="strict")&&B(!1)}function Ju(e){}function Ia(e,t,i){var r=Ta(!0);ka(e),e.newObserving=new Array(e.observing.length+100),e.unboundDepsCount=0,e.runId=++x.runId;var o=x.trackingDerivation;x.trackingDerivation=e;var n;if(x.disableErrorBoundaries===!0)n=t.call(i);else try{n=t.call(i)}catch(a){n=new ro(a)}return x.trackingDerivation=o,Qu(e),e.observing.length===0&&Zu(e),Oa(r),n}function Zu(e){return}function Qu(e){for(var t=e.observing,i=e.observing=e.newObserving,r=G.UP_TO_DATE,o=0,n=e.unboundDepsCount,a=0;a<n;a++){var l=i[a];l.diffValue===0&&(l.diffValue=1,o!==a&&(i[o]=l),o++),l.dependenciesState>r&&(r=l.dependenciesState)}for(i.length=o,e.newObserving=null,n=t.length;n--;){var l=t[n];l.diffValue===0&&Fa(l,e),l.diffValue=0}for(;o--;){var l=i[o];l.diffValue===1&&(l.diffValue=0,eh(l,e))}r!==G.UP_TO_DATE&&(e.dependenciesState=r,e.onBecomeStale())}function kn(e){var t=e.observing;e.observing=[];for(var i=t.length;i--;)Fa(t[i],e);e.dependenciesState=G.NOT_TRACKING}function Tn(e){var t=Mi(),i=e();return Gt(t),i}function Mi(){var e=x.trackingDerivation;return x.trackingDerivation=null,e}function Gt(e){x.trackingDerivation=e}function Ta(e){var t=x.allowStateReads;return x.allowStateReads=e,t}function Oa(e){x.allowStateReads=e}function ka(e){if(e.dependenciesState===G.UP_TO_DATE)return;e.dependenciesState=G.UP_TO_DATE;for(var t=e.observing,i=t.length;i--;)t[i].lowestObserverState=G.UP_TO_DATE}var no=0,th=1;function qt(e,t){var i=function(){return Aa(e,t,this,arguments)};return i.isMobxAction=!0,i}function Aa(e,t,i,r){var o=Ra(e,i,r);try{return t.apply(i,r)}catch(n){throw o.error=n,n}finally{Ma(o)}}function Ra(e,t,i){var r=De()&&!!e,o=0;if(r){o=Date.now();var n=i&&i.length||0,a=new Array(n);if(n>0)for(var l=0;l<n;l++)a[l]=i[l];Ne({type:"action",name:e,object:t,arguments:a})}var c=Mi();ot();var d=On(!0),u=Ta(!0),h={prevDerivation:c,prevAllowStateChanges:d,prevAllowStateReads:u,notifySpy:r,startTime:o,actionId:th++,parentActionId:no};return no=h.actionId,h}function Ma(e){no!==e.actionId&&B("invalid action stack. did you forget to finish an action?"),no=e.parentActionId,e.error!==void 0&&(x.suppressReactionErrors=!0),In(e.prevAllowStateChanges),Oa(e.prevAllowStateReads),nt(),Gt(e.prevDerivation),e.notifySpy&&He({time:Date.now()-e.startTime}),x.suppressReactionErrors=!1}function ih(e,t){var i=On(e),r;try{r=t()}finally{In(i)}return r}function On(e){var t=x.allowStateChanges;return x.allowStateChanges=e,t}function In(e){x.allowStateChanges=e}function rh(e){var t=x.computationDepth;x.computationDepth=0;var i;try{i=e()}finally{x.computationDepth=t}return i}var $t=function(e){da(t,e);function t(i,r,o,n,a){o===void 0&&(o="ObservableValue@"+Ie()),n===void 0&&(n=!0),a===void 0&&(a=fi.default);var l=e.call(this,o)||this;return l.enhancer=r,l.name=o,l.equals=a,l.hasUnreportedChange=!1,l.value=r(i,void 0,o),n&&De()&&gi({type:"create",name:l.name,newValue:""+l.value}),l}return t.prototype.dehanceValue=function(i){return this.dehancer!==void 0?this.dehancer(i):i},t.prototype.set=function(i){var r=this.value;if(i=this.prepareNewValue(i),i!==x.UNCHANGED){var o=De();o&&Ne({type:"update",name:this.name,newValue:i,oldValue:r}),this.setNewValue(i),o&&He()}},t.prototype.prepareNewValue=function(i){if(oo(this),yt(this)){var r=vt(this,{object:this,type:"update",newValue:i});if(!r)return x.UNCHANGED;i=r.newValue}return i=this.enhancer(i,this.value,this.name),this.equals(this.value,i)?x.UNCHANGED:i},t.prototype.setNewValue=function(i){var r=this.value;this.value=i,this.reportChanged(),at(this)&&lt(this,{type:"update",object:this,newValue:i,oldValue:r})},t.prototype.get=function(){return this.reportObserved(),this.dehanceValue(this.value)},t.prototype.intercept=function(i){return mr(this,i)},t.prototype.observe=function(i,r){return r&&i({object:this,type:"update",newValue:this.value,oldValue:void 0}),gr(this,i)},t.prototype.toJSON=function(){return this.get()},t.prototype.toString=function(){return this.name+"["+this.value+"]"},t.prototype.valueOf=function(){return fa(this.get())},t}(Qr);$t.prototype[pa()]=$t.prototype.valueOf;var Fn=Ut("ObservableValue",$t),Vt=function(){function e(t){this.dependenciesState=G.NOT_TRACKING,this.observing=[],this.newObserving=null,this.isBeingObserved=!1,this.isPendingUnobservation=!1,this.observers=[],this.observersIndexes={},this.diffValue=0,this.runId=0,this.lastAccessedBy=0,this.lowestObserverState=G.UP_TO_DATE,this.unboundDepsCount=0,this.__mapid="#"+Ie(),this.value=new ro(null),this.isComputing=!1,this.isRunningSetter=!1,this.isTracing=st.NONE,this.derivation=t.get,this.name=t.name||"ComputedValue@"+Ie(),t.set&&(this.setter=qt(this.name+"-setter",t.set)),this.equals=t.equals||(t.compareStructural||t.struct?fi.structural:fi.default),this.scope=t.context,this.requiresReaction=!!t.requiresReaction,this.keepAlive=!!t.keepAlive}return e.prototype.onBecomeStale=function(){nh(this)},e.prototype.onBecomeUnobserved=function(){},e.prototype.onBecomeObserved=function(){},e.prototype.get=function(){this.isComputing&&B("Cycle detected in computation "+this.name+": "+this.derivation),x.inBatch===0&&this.observers.length===0&&!this.keepAlive?En(this)&&(this.warnAboutUntrackedRead(),ot(),this.value=this.computeValue(!1),nt()):(ma(this),En(this)&&(this.trackAndCompute()&&oh(this)));var t=this.value;if(fr(t))throw t.cause;return t},e.prototype.peek=function(){var t=this.computeValue(!1);if(fr(t))throw t.cause;return t},e.prototype.set=function(t){if(this.setter){it(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?"),this.isRunningSetter=!0;try{this.setter.call(this.scope,t)}finally{this.isRunningSetter=!1}}else it(!1,!1)},e.prototype.trackAndCompute=function(){De()&&gi({object:this.scope,type:"compute",name:this.name});var t=this.value,i=this.dependenciesState===G.NOT_TRACKING,r=this.computeValue(!0),o=i||fr(t)||fr(r)||!this.equals(t,r);return o&&(this.value=r),o},e.prototype.computeValue=function(t){this.isComputing=!0,x.computationDepth++;var i;if(t)i=Ia(this,this.derivation,this.scope);else if(x.disableErrorBoundaries===!0)i=this.derivation.call(this.scope);else try{i=this.derivation.call(this.scope)}catch(r){i=new ro(r)}return x.computationDepth--,this.isComputing=!1,i},e.prototype.suspend=function(){this.keepAlive||(kn(this),this.value=void 0)},e.prototype.observe=function(t,i){var r=this,o=!0,n=void 0;return An(function(){var a=r.get();if(!o||i){var l=Mi();t({type:"update",object:r,newValue:a,oldValue:n}),Gt(l)}o=!1,n=a})},e.prototype.warnAboutUntrackedRead=function(){return},e.prototype.toJSON=function(){return this.get()},e.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"},e.prototype.valueOf=function(){return fa(this.get())},e}();Vt.prototype[pa()]=Vt.prototype.valueOf;var zi=Ut("ComputedValue",Vt),sh=["mobxGuid","spyListeners","enforceActions","computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","allowStateReads","disableErrorBoundaries","runId","UNCHANGED"],br=function(){function e(){this.version=5,this.UNCHANGED={},this.trackingDerivation=null,this.computationDepth=0,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!0,this.allowStateReads=!0,this.enforceActions=!1,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.computedConfigurable=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1}return e}(),so=!0,za=!1,x=function(){var e=Ii();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(so=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==new br().version&&(so=!1),so?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new br):(setTimeout(function(){za||B("There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`")},1),new br)}();function ah(){(x.pendingReactions.length||x.inBatch||x.isRunningReactions)&&B("isolateGlobalState should be called before MobX is running any reactions"),za=!0,so&&(--Ii().__mobxInstanceCount===0&&(Ii().__mobxGlobals=void 0),x=new br)}function lh(){return x}function ch(){var e=new br;for(var t in e)sh.indexOf(t)===-1&&(x[t]=e[t]);x.allowStateChanges=!x.enforceActions}function dh(e){return e.observers&&e.observers.length>0}function uh(e){return e.observers}function eh(e,t){var i=e.observers.length;i&&(e.observersIndexes[t.__mapid]=i),e.observers[i]=t,e.lowestObserverState>t.dependenciesState&&(e.lowestObserverState=t.dependenciesState)}function Fa(e,t){if(e.observers.length===1)e.observers.length=0,Pa(e);else{var i=e.observers,r=e.observersIndexes,o=i.pop();if(o!==t){var n=r[t.__mapid]||0;n?r[o.__mapid]=n:delete r[o.__mapid],i[n]=o}delete r[t.__mapid]}}function Pa(e){e.isPendingUnobservation===!1&&(e.isPendingUnobservation=!0,x.pendingUnobservations.push(e))}function ot(){x.inBatch++}function nt(){if(--x.inBatch===0){Ba();for(var e=x.pendingUnobservations,t=0;t<e.length;t++){var i=e[t];i.isPendingUnobservation=!1,i.observers.length===0&&(i.isBeingObserved&&(i.isBeingObserved=!1,i.onBecomeUnobserved()),i instanceof Vt&&i.suspend())}x.pendingUnobservations=[]}}function ma(e){Ju(e);var t=x.trackingDerivation;return t!==null?(t.runId!==e.lastAccessedBy&&(e.lastAccessedBy=t.runId,t.newObserving[t.unboundDepsCount++]=e,e.isBeingObserved||(e.isBeingObserved=!0,e.onBecomeObserved())),!0):(e.observers.length===0&&x.inBatch>0&&Pa(e),!1)}function Pu(e){if(e.lowestObserverState===G.STALE)return;e.lowestObserverState=G.STALE;for(var t=e.observers,i=t.length;i--;){var r=t[i];r.dependenciesState===G.UP_TO_DATE&&(r.isTracing!==st.NONE&&La(r,e),r.onBecomeStale()),r.dependenciesState=G.STALE}}function oh(e){if(e.lowestObserverState===G.STALE)return;e.lowestObserverState=G.STALE;for(var t=e.observers,i=t.length;i--;){var r=t[i];r.dependenciesState===G.POSSIBLY_STALE?r.dependenciesState=G.STALE:r.dependenciesState===G.UP_TO_DATE&&(e.lowestObserverState=G.UP_TO_DATE)}}function nh(e){if(e.lowestObserverState!==G.UP_TO_DATE)return;e.lowestObserverState=G.POSSIBLY_STALE;for(var t=e.observers,i=t.length;i--;){var r=t[i];r.dependenciesState===G.UP_TO_DATE&&(r.dependenciesState=G.POSSIBLY_STALE,r.isTracing!==st.NONE&&La(r,e),r.onBecomeStale())}}function La(e,t){if(console.log("[mobx.trace] '"+e.name+"' is invalidated due to a change in: '"+t.name+"'"),e.isTracing===st.BREAK){var i=[];Na(Ha(e),i,1),new Function(`debugger;
/*
Tracing '`+e.name+`'

You are entering this break point because derivation '`+e.name+"' is being traced and '"+t.name+`' is now forcing it to update.
Just follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update
The stackframe you are looking for is at least ~6-8 stack-frames up.

`+(e instanceof Vt?e.derivation.toString().replace(/[*]\//g,"/"):"")+`

The dependencies for this derivation are:

`+i.join(`
`)+`
*/
    `)()}}function Na(e,t,i){if(t.length>=1e3){t.push("(and many more)");return}t.push(""+new Array(i).join("	")+e.name),e.dependencies&&e.dependencies.forEach(function(r){return Na(r,t,i+1)})}var yr=function(){function e(t,i,r,o){t===void 0&&(t="Reaction@"+Ie()),o===void 0&&(o=!1),this.name=t,this.onInvalidate=i,this.errorHandler=r,this.requiresObservable=o,this.observing=[],this.newObserving=[],this.dependenciesState=G.NOT_TRACKING,this.diffValue=0,this.runId=0,this.unboundDepsCount=0,this.__mapid="#"+Ie(),this.isDisposed=!1,this._isScheduled=!1,this._isTrackPending=!1,this._isRunning=!1,this.isTracing=st.NONE}return e.prototype.onBecomeStale=function(){this.schedule()},e.prototype.schedule=function(){this._isScheduled||(this._isScheduled=!0,x.pendingReactions.push(this),Ba())},e.prototype.isScheduled=function(){return this._isScheduled},e.prototype.runReaction=function(){if(!this.isDisposed){if(ot(),this._isScheduled=!1,En(this)){this._isTrackPending=!0;try{this.onInvalidate(),this._isTrackPending&&De()&&gi({name:this.name,type:"scheduled-reaction"})}catch(t){this.reportExceptionInDerivation(t)}}nt()}},e.prototype.track=function(t){ot();var i=De(),r;i&&(r=Date.now(),Ne({name:this.name,type:"reaction"})),this._isRunning=!0;var o=Ia(this,t,void 0);this._isRunning=!1,this._isTrackPending=!1,this.isDisposed&&kn(this),fr(o)&&this.reportExceptionInDerivation(o.cause),i&&He({time:Date.now()-r}),nt()},e.prototype.reportExceptionInDerivation=function(t){var i=this;if(this.errorHandler){this.errorHandler(t,this);return}if(x.disableErrorBoundaries)throw t;var r="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this+"'";x.suppressReactionErrors?console.warn("[mobx] (error in reaction '"+this.name+"' suppressed, fix error of causing action below)"):console.error(r,t),De()&&gi({type:"error",name:this.name,message:r,error:""+t}),x.globalReactionErrorHandlers.forEach(function(o){return o(t,i)})},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._isRunning||(ot(),kn(this),nt()))},e.prototype.getDisposer=function(){var t=this.dispose.bind(this);return t.$mobx=this,t},e.prototype.toString=function(){return"Reaction["+this.name+"]"},e.prototype.trace=function(t){t===void 0&&(t=!1),ja(this,t)},e}();function hh(e){return x.globalReactionErrorHandlers.push(e),function(){var t=x.globalReactionErrorHandlers.indexOf(e);t>=0&&x.globalReactionErrorHandlers.splice(t,1)}}var Wa=100,Rn=function(e){return e()};function Ba(){if(x.inBatch>0||x.isRunningReactions)return;Rn(ph)}function ph(){x.isRunningReactions=!0;for(var e=x.pendingReactions,t=0;e.length>0;){++t===Wa&&(console.error("Reaction doesn't converge to a stable state after "+Wa+" iterations."+(" Probably there is a cycle in the reactive function: "+e[0])),e.splice(0));for(var i=e.splice(0),r=0,o=i.length;r<o;r++)i[r].runReaction()}x.isRunningReactions=!1}var ao=Ut("Reaction",yr);function fh(e){var t=Rn;Rn=function(i){return e(function(){return t(i)})}}function De(){return!!x.spyListeners.length}function gi(e){if(!x.spyListeners.length)return;for(var t=x.spyListeners,i=0,r=t.length;i<r;i++)t[i](e)}function Ne(e){var t=Ee({},e,{spyReportStart:!0});gi(t)}var mh={spyReportEnd:!0};function He(e){gi(e?Ee({},e,{spyReportEnd:!0}):mh)}function Ua(e){return x.spyListeners.push(e),gn(function(){x.spyListeners=x.spyListeners.filter(function(t){return t!==e})})}function gh(){B(!1)}function $a(e){return function(t,i,r){if(r){if(r.value)return{value:qt(e,r.value),enumerable:!1,configurable:!0,writable:!0};var o=r.initializer;return{enumerable:!1,configurable:!0,writable:!0,initializer:function(){return qt(e,o.call(this))}}}return bh(e).apply(this,arguments)}}function bh(e){return function(t,i,r){Object.defineProperty(t,i,{configurable:!0,enumerable:!1,get:function(){return},set:function(o){pi(this,i,Xt(e,o))}})}}function yh(e,t,i,r){return r===!0?(Mn(e,t,i.value),null):i?{configurable:!0,enumerable:!1,get:function(){return Mn(this,t,i.value||i.initializer.call(this)),this[t]},set:gh}:{enumerable:!1,configurable:!0,set:function(o){Mn(this,t,o)},get:function(){return}}}var Xt=function(t,i,r,o){if(arguments.length===1&&typeof t=="function")return qt(t.name||"<unnamed action>",t);if(arguments.length===2&&typeof i=="function")return qt(t,i);if(arguments.length===1&&typeof t=="string")return $a(t);if(o===!0)t[i]=qt(t.name||i,r.value);else return $a(i).apply(null,arguments)};Xt.bound=yh;function vh(e,t){var i=typeof e=="string"?e:e.name||"<unnamed action>",r=typeof e=="function"?e:t;return Aa(i,r,this,void 0)}function Sh(e){return typeof e=="function"&&e.isMobxAction===!0}function Mn(e,t,i){pi(e,t,qt(t,i.bind(e)))}function An(e,t){t===void 0&&(t=mn);var i=t&&t.name||e.name||"Autorun@"+Ie(),r=!t.scheduler&&!t.delay,o;if(r)o=new yr(i,function(){this.track(l)},t.onError,t.requiresObservable);else{var n=Va(t),a=!1;o=new yr(i,function(){a||(a=!0,n(function(){a=!1,o.isDisposed||o.track(l)}))},t.onError,t.requiresObservable)}function l(){e(o)}return o.schedule(),o.getDisposer()}var wh=function(e){return e()};function Va(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:wh}function xh(e,t,i){i===void 0&&(i=mn),typeof i=="boolean"&&(i={fireImmediately:i},rt("Using fireImmediately as argument is deprecated. Use '{ fireImmediately: true }' instead"));var r=i.name||"Reaction@"+Ie(),o=Xt(r,i.onError?Dh(i.onError,t):t),n=!i.scheduler&&!i.delay,a=Va(i),l=!0,c=!1,d,u=i.compareStructural?fi.structural:i.equals||fi.default,h=new yr(r,function(){l||n?y():c||(c=!0,a(y))},i.onError,i.requiresObservable);function y(){if(c=!1,h.isDisposed)return;var k=!1;h.track(function(){var w=e(h);k=l||!u(d,w),d=w}),l&&i.fireImmediately&&o(d,h),!l&&k===!0&&o(d,h),l&&(l=!1)}return h.schedule(),h.getDisposer()}function Dh(e,t){return function(){try{return t.apply(this,arguments)}catch(i){e.call(this,i)}}}function ga(e,t,i){return Ga("onBecomeObserved",e,t,i)}function Dn(e,t,i){return Ga("onBecomeUnobserved",e,t,i)}function Ga(e,t,i,r){var o=typeof r=="function"?qe(t,i):qe(t),n=typeof r=="function"?r:i,a=o[e];return typeof a!="function"?B(!1):(o[e]=function(){a.call(this),n.call(this)},function(){o[e]=a})}function Ch(e){var t=e.enforceActions,i=e.computedRequiresReaction,r=e.computedConfigurable,o=e.disableErrorBoundaries,n=e.arrayBuffer,a=e.reactionScheduler,l=e.reactionRequiresObservable,c=e.observableRequiresReaction;if(e.isolateGlobalState===!0&&ah(),t!==void 0){(typeof t=="boolean"||t==="strict")&&rt(`Deprecated value for 'enforceActions', use 'false' => '"never"', 'true' => '"observed"', '"strict"' => "'always'" instead`);var d=void 0;switch(t){case!0:case"observed":d=!0;break;case!1:case"never":d=!1;break;case"strict":case"always":d="strict";break;default:B("Invalid value for 'enforceActions': '"+t+"', expected 'never', 'always' or 'observed'")}x.enforceActions=d,x.allowStateChanges=!(d===!0||d==="strict")}i!==void 0&&(x.computedRequiresReaction=!!i),l!==void 0&&(x.reactionRequiresObservable=!!l),c!==void 0&&(x.observableRequiresReaction=!!c,x.allowStateReads=!x.observableRequiresReaction),r!==void 0&&(x.computedConfigurable=!!r),o!==void 0&&(o===!0&&console.warn("WARNING: Debug feature only. MobX will NOT recover from errors if this is on."),x.disableErrorBoundaries=!!o),typeof n=="number"&&zn(n),a&&fh(a)}function _h(e,t){var i=typeof e=="function"?e.prototype:e,r=function(n){var a=t[n];Array.isArray(a)||(a=[a]);var l=Object.getOwnPropertyDescriptor(i,n),c=a.reduce(function(d,u){return u(i,n,d)},l);c&&Object.defineProperty(i,n,c)};for(var o in t)r(o);return e}function Eh(e,t,i){return rt("'extendShallowObservable' is deprecated, use 'extendObservable(target, props, { deep: false })' instead"),_n(e,t,i,xa)}function _n(e,t,i,r){if(!1&&i)for(var o in i);r=Ri(r);var n=r.defaultDecorator||(r.deep===!1?Ca:Cn);mi(e),Pn(e,r.name,n.enhancer),ot();try{for(var o in t){var a=Object.getOwnPropertyDescriptor(t,o),l=i&&o in i?i[o]:a.get?io:n,c=l(e,o,a,!0);c&&Object.defineProperty(e,o,c)}}finally{nt()}return e}function Ha(e,t){return qa(qe(e,t))}function qa(e){var t={name:e.name};return e.observing&&e.observing.length>0&&(t.dependencies=Tu(e.observing).map(qa)),t}function kh(e,t){return Xa(qe(e,t))}function Xa(e){var t={name:e.name};return dh(e)&&(t.observers=uh(e).map(Xa)),t}var Th=0;function Oh(e){arguments.length!==1&&B("Flow expects one 1 argument and cannot be used as decorator");var t=e.name||"<unnamed flow>";return function(){var i=this,r=arguments,o=++Th,n=Xt(t+" - runid: "+o+" - init",e).apply(i,r),a,l=void 0,c=new Promise(function(d,u){var h=0;a=u;function y(T){l=void 0;var F;try{F=Xt(t+" - runid: "+o+" - yield "+h++,n.next).call(n,T)}catch($){return u($)}w(F)}function k(T){l=void 0;var F;try{F=Xt(t+" - runid: "+o+" - yield "+h++,n.throw).call(n,T)}catch($){return u($)}w(F)}function w(T){if(T&&typeof T.then=="function"){T.then(w,u);return}return T.done?d(T.value):(l=Promise.resolve(T.value),l.then(y,k))}y(void 0)});return c.cancel=Xt(t+" - runid: "+o+" - cancel",function(){try{l&&Ka(l);var d=n.return(),u=Promise.resolve(d.value);u.then(Zr,Zr),Ka(u),a(new Error("FLOW_CANCELLED"))}catch(h){a(h)}}),c}}function Ka(e){typeof e.cancel=="function"&&e.cancel()}function Ih(e,t,i){var r;if(ye(e)||ke(e)||Fn(e))r=St(e);else if(Ae(e)){if(typeof t!="string")return B(!1);r=St(e,t)}else return B(!1);return r.dehancer!==void 0?B(!1):(r.dehancer=typeof t=="function"?t:i,function(){r.dehancer=void 0})}function Rh(e,t,i){return typeof i=="function"?Ah(e,t,i):Fh(e,t)}function Fh(e,t){return St(e).intercept(t)}function Ah(e,t,i){return St(e,t).intercept(i)}function Ya(e,t){if(e==null)return!1;if(t!==void 0){if(Ae(e)===!1)return!1;if(!e.$mobx.values[t])return!1;var i=qe(e,t);return zi(i)}return zi(e)}function Mh(e){return arguments.length>1?B(!1):Ya(e)}function zh(e,t){return typeof t!="string"?B(!1):Ya(e,t)}function Ja(e,t){if(e==null)return!1;if(t!==void 0){if(Ae(e)){var i=e.$mobx;return i.values&&!!i.values[t]}return!1}return Ae(e)||!!e.$mobx||wn(e)||ao(e)||zi(e)}function Ai(e){return arguments.length!==1&&B(!1),Ja(e)}function Ph(e,t){return typeof t!="string"?B(!1):Ja(e,t)}function Pi(e){return Ae(e)?e.$mobx.getKeys():ye(e)?e._keys.slice():Fe(e)?Ot(e.keys()):ke(e)?e.map(function(t,i){return i}):B(!1)}function Bh(e){return Ae(e)?Pi(e).map(function(t){return e[t]}):ye(e)?Pi(e).map(function(t){return e.get(t)}):Fe(e)?Ot(e.values()):ke(e)?e.slice():B(!1)}function Lh(e){return Ae(e)?Pi(e).map(function(t){return[t,e[t]]}):ye(e)?Pi(e).map(function(t){return[t,e.get(t)]}):Fe(e)?Ot(e.entries()):ke(e)?e.map(function(t,i){return[i,t]}):B(!1)}function Za(e,t,i){if(arguments.length===2&&!Fe(e)){ot();var r=t;try{for(var o in r)Za(e,o,r[o])}finally{nt()}return}if(Ae(e)){var n=e.$mobx,a=n.values[t];a?n.write(e,t,i):wa(e,t,i,n.defaultEnhancer)}else if(ye(e))e.set(t,i);else if(Fe(e))e.add(t);else if(ke(e))typeof t!="number"&&(t=parseInt(t,10)),it(t>=0,"Not a valid index: '"+t+"'"),ot(),t>=e.length&&(e.length=t+1),e[t]=i,nt();else return B(!1)}function Nh(e,t){if(Ae(e))e.$mobx.remove(t);else if(ye(e))e.delete(t);else if(Fe(e))e.delete(t);else if(ke(e))typeof t!="number"&&(t=parseInt(t,10)),it(t>=0,"Not a valid index: '"+t+"'"),e.splice(t,1);else return B(!1)}function Qa(e,t){if(Ae(e)){var i=St(e);return i.getKeys(),!!i.values[t]}else return ye(e)||Fe(e)?e.has(t):ke(e)?t>=0&&t<e.length:B(!1)}function Hh(e,t){return Qa(e,t)?Ae(e)?e[t]:ye(e)?e.get(t):ke(e)?e[t]:B(!1):void 0}function Uh(e,t,i,r){return typeof i=="function"?Wh(e,t,i,r):jh(e,t,i)}function jh(e,t,i){return St(e).observe(t,i)}function Wh(e,t,i,r){return St(e,t).observe(i,r)}var $h={detectCycles:!0,exportMapsAsObjects:!0,recurseEverything:!1};function Bi(e,t,i,r){return r.detectCycles&&e.set(t,i),i}function Kt(e,t,i){if(!t.recurseEverything&&!Ai(e))return e;if(typeof e!="object")return e;if(e===null)return null;if(e instanceof Date)return e;if(Fn(e))return Kt(e.get(),t,i);Ai(e)&&Pi(e);var r=t.detectCycles===!0;if(r&&e!==null&&i.has(e))return i.get(e);if(ke(e)||Array.isArray(e)){var o=Bi(i,e,[],t),n=e.map(function(w){return Kt(w,t,i)});o.length=n.length;for(var a=0,l=n.length;a<l;a++)o[a]=n[a];return o}if(Fe(e)||Object.getPrototypeOf(e)===Set.prototype)if(t.exportMapsAsObjects===!1){var c=Bi(i,e,new Set,t);return e.forEach(function(w){c.add(Kt(w,t,i))}),c}else{var d=Bi(i,e,[],t);return e.forEach(function(w){d.push(Kt(w,t,i))}),d}if(ye(e)||Object.getPrototypeOf(e)===Map.prototype)if(t.exportMapsAsObjects===!1){var u=Bi(i,e,new Map,t);return e.forEach(function(w,T){u.set(T,Kt(w,t,i))}),u}else{var h=Bi(i,e,{},t);return e.forEach(function(w,T){h[T]=Kt(w,t,i)}),h}var y=Bi(i,e,{},t);for(var k in e)y[k]=Kt(e[k],t,i);return y}function Vh(e,t){typeof t=="boolean"&&(t={detectCycles:t}),t||(t=$h),t.detectCycles=t.detectCycles===void 0?t.recurseEverything===!0:t.detectCycles===!0;var i;return t.detectCycles&&(i=new Map),Kt(e,t,i)}function ja(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=!1;typeof e[e.length-1]=="boolean"&&(i=e.pop());var r=Gh(e);if(!r)return B(!1);r.isTracing===st.NONE&&console.log("[mobx.trace] '"+r.name+"' tracing enabled"),r.isTracing=i?st.BREAK:st.LOG}function Gh(e){switch(e.length){case 0:return x.trackingDerivation;case 1:return qe(e[0]);case 2:return qe(e[0],e[1])}}function wt(e,t){t===void 0&&(t=void 0),ot();try{return e.apply(t)}finally{nt()}}function Xh(e,t,i){return arguments.length===1||t&&typeof t=="object"?qh(e,t):el(e,t,i||{})}function el(e,t,i){var r;typeof i.timeout=="number"&&(r=setTimeout(function(){if(!n.$mobx.isDisposed){n();var a=new Error("WHEN_TIMEOUT");if(i.onError)i.onError(a);else throw a}},i.timeout)),i.name=i.name||"When@"+Ie();var o=qt(i.name+"-effect",t),n=An(function(a){e()&&(a.dispose(),r&&clearTimeout(r),o())},i);return n}function qh(e,t){var i,r=new Promise(function(o,n){var a=el(e,o,Ee({},t,{onError:n}));i=function(){a(),n("WHEN_CANCELLED")}});return r.cancel=i,r}function yt(e){return e.interceptors!==void 0&&e.interceptors.length>0}function mr(e,t){var i=e.interceptors||(e.interceptors=[]);return i.push(t),gn(function(){var r=i.indexOf(t);r!==-1&&i.splice(r,1)})}function vt(e,t){var i=Mi();try{var r=e.interceptors;if(r)for(var o=0,n=r.length;o<n&&!(t=r[o](t),it(!t||t.type,"Intercept handlers should return nothing or a change object"),!t);o++);return t}finally{Gt(i)}}function at(e){return e.changeListeners!==void 0&&e.changeListeners.length>0}function gr(e,t){var i=e.changeListeners||(e.changeListeners=[]);return i.push(t),gn(function(){var r=i.indexOf(t);r!==-1&&i.splice(r,1)})}function lt(e,t){var i=Mi(),r=e.changeListeners;if(!r)return;r=r.slice();for(var o=0,n=r.length;o<n;o++)r[o](t);Gt(i)}var Kh=1e4,Yh=function(){var e=!1,t={};return Object.defineProperty(t,"0",{set:function(){e=!0}}),Object.create(t)["0"]=1,e===!1}(),Bn=0,Ln=function(){function e(){}return e}();function Jh(e,t){typeof Object.setPrototypeOf!="undefined"?Object.setPrototypeOf(e.prototype,t):typeof e.prototype.__proto__!="undefined"?e.prototype.__proto__=t:e.prototype=t}Jh(Ln,Array.prototype);Object.isFrozen(Array)&&["constructor","push","shift","concat","pop","unshift","replace","find","findIndex","splice","reverse","sort"].forEach(function(e){Object.defineProperty(Ln.prototype,e,{configurable:!0,writable:!0,value:Array.prototype[e]})});var tl=function(){function e(t,i,r,o){this.array=r,this.owned=o,this.values=[],this.lastKnownLength=0,this.atom=new Qr(t||"ObservableArray@"+Ie()),this.enhancer=function(n,a){return i(n,a,t+"[..]")}}return e.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},e.prototype.dehanceValues=function(t){return this.dehancer!==void 0&&t.length>0?t.map(this.dehancer):t},e.prototype.intercept=function(t){return mr(this,t)},e.prototype.observe=function(t,i){return i===void 0&&(i=!1),i&&t({object:this.array,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0}),gr(this,t)},e.prototype.getArrayLength=function(){return this.atom.reportObserved(),this.values.length},e.prototype.setArrayLength=function(t){if(typeof t!="number"||t<0)throw new Error("[mobx.array] Out of range: "+t);var i=this.values.length;if(t===i)return;if(t>i){for(var r=new Array(t-i),o=0;o<t-i;o++)r[o]=void 0;this.spliceWithArray(i,0,r)}else this.spliceWithArray(t,i-t)},e.prototype.updateArrayLength=function(t,i){if(t!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed. Did you use peek() to change it?");this.lastKnownLength+=i,i>0&&t+i+1>Bn&&zn(t+i+1)},e.prototype.spliceWithArray=function(t,i,r){var o=this;oo(this.atom);var n=this.values.length;if(t===void 0?t=0:t>n?t=n:t<0&&(t=Math.max(0,n+t)),arguments.length===1?i=n-t:i==null?i=0:i=Math.max(0,Math.min(i,n-t)),r===void 0&&(r=Jr),yt(this)){var a=vt(this,{object:this.array,type:"splice",index:t,removedCount:i,added:r});if(!a)return Jr;i=a.removedCount,r=a.added}r=r.length===0?r:r.map(function(d){return o.enhancer(d,void 0)});var l=r.length-i;this.updateArrayLength(n,l);var c=this.spliceItemsIntoValues(t,i,r);return(i!==0||r.length!==0)&&this.notifyArraySplice(t,r,c),this.dehanceValues(c)},e.prototype.spliceItemsIntoValues=function(t,i,r){var o;if(r.length<Kh)return(o=this.values).splice.apply(o,fn([t,i],r));var n=this.values.slice(t,t+i);return this.values=this.values.slice(0,t).concat(r,this.values.slice(t+i)),n},e.prototype.notifyArrayChildUpdate=function(t,i,r){var o=!this.owned&&De(),n=at(this),a=n||o?{object:this.array,type:"update",index:t,newValue:i,oldValue:r}:null;o&&Ne(Ee({},a,{name:this.atom.name})),this.atom.reportChanged(),n&&lt(this,a),o&&He()},e.prototype.notifyArraySplice=function(t,i,r){var o=!this.owned&&De(),n=at(this),a=n||o?{object:this.array,type:"splice",index:t,removed:r,added:i,removedCount:r.length,addedCount:i.length}:null;o&&Ne(Ee({},a,{name:this.atom.name})),this.atom.reportChanged(),n&&lt(this,a),o&&He()},e}(),Ft=function(e){da(t,e);function t(i,r,o,n){o===void 0&&(o="ObservableArray@"+Ie()),n===void 0&&(n=!1);var a=e.call(this)||this,l=new tl(o,r,a,n);if(ar(a,"$mobx",l),i&&i.length){var c=On(!0);a.spliceWithArray(0,0,i),In(c)}return Yh&&Object.defineProperty(l.array,"0",Zh),a}return t.prototype.intercept=function(i){return this.$mobx.intercept(i)},t.prototype.observe=function(i,r){return r===void 0&&(r=!1),this.$mobx.observe(i,r)},t.prototype.clear=function(){return this.splice(0)},t.prototype.concat=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];return this.$mobx.atom.reportObserved(),Array.prototype.concat.apply(this.peek(),i.map(function(o){return ke(o)?o.peek():o}))},t.prototype.replace=function(i){return this.$mobx.spliceWithArray(0,this.$mobx.values.length,i)},t.prototype.toJS=function(){return this.slice()},t.prototype.toJSON=function(){return this.toJS()},t.prototype.peek=function(){return this.$mobx.atom.reportObserved(),this.$mobx.dehanceValues(this.$mobx.values)},t.prototype.find=function(i,r,o){o===void 0&&(o=0),arguments.length===3&&rt("The array.find fromIndex argument to find will not be supported anymore in the next major");var n=this.findIndex.apply(this,arguments);return n===-1?void 0:this.get(n)},t.prototype.findIndex=function(i,r,o){o===void 0&&(o=0),arguments.length===3&&rt("The array.findIndex fromIndex argument to find will not be supported anymore in the next major");for(var n=this.peek(),a=n.length,l=o;l<a;l++)if(i.call(r,n[l],l,this))return l;return-1},t.prototype.splice=function(i,r){for(var o=[],n=2;n<arguments.length;n++)o[n-2]=arguments[n];switch(arguments.length){case 0:return[];case 1:return this.$mobx.spliceWithArray(i);case 2:return this.$mobx.spliceWithArray(i,r)}return this.$mobx.spliceWithArray(i,r,o)},t.prototype.spliceWithArray=function(i,r,o){return this.$mobx.spliceWithArray(i,r,o)},t.prototype.push=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];var o=this.$mobx;return o.spliceWithArray(o.values.length,0,i),o.values.length},t.prototype.pop=function(){return this.splice(Math.max(this.$mobx.values.length-1,0),1)[0]},t.prototype.shift=function(){return this.splice(0,1)[0]},t.prototype.unshift=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];var o=this.$mobx;return o.spliceWithArray(0,0,i),o.values.length},t.prototype.reverse=function(){var i=this.slice();return i.reverse.apply(i,arguments)},t.prototype.sort=function(i){var r=this.slice();return r.sort.apply(r,arguments)},t.prototype.remove=function(i){var r=this.$mobx.dehanceValues(this.$mobx.values).indexOf(i);return r>-1?(this.splice(r,1),!0):!1},t.prototype.move=function(i,r){rt("observableArray.move is deprecated, use .slice() & .replace() instead");function o(l){if(l<0)throw new Error("[mobx.array] Index out of bounds: "+l+" is negative");var c=this.$mobx.values.length;if(l>=c)throw new Error("[mobx.array] Index out of bounds: "+l+" is not smaller than "+c)}if(o.call(this,i),o.call(this,r),i===r)return;var n=this.$mobx.values,a;i<r?a=fn(n.slice(0,i),n.slice(i+1,r+1),[n[i]],n.slice(r+1)):a=fn(n.slice(0,r),[n[i]],n.slice(r,i),n.slice(i+1)),this.replace(a)},t.prototype.get=function(i){var r=this.$mobx;if(r){if(i<r.values.length)return r.atom.reportObserved(),r.dehanceValue(r.values[i]);console.warn("[mobx.array] Attempt to read an array index ("+i+") that is out of bounds ("+r.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}return},t.prototype.set=function(i,r){var o=this.$mobx,n=o.values;if(i<n.length){oo(o.atom);var a=n[i];if(yt(o)){var l=vt(o,{type:"update",object:this,index:i,newValue:r});if(!l)return;r=l.newValue}r=o.enhancer(r,a);var c=r!==a;c&&(n[i]=r,o.notifyArrayChildUpdate(i,r,a))}else if(i===n.length)o.spliceWithArray(i,0,[r]);else throw new Error("[mobx.array] Index out of bounds, "+i+" is larger than "+n.length)},t}(Ln);vn(Ft.prototype,function(){this.$mobx.atom.reportObserved();var e=this,t=0;return cr({next:function(){return t<e.length?{value:e[t++],done:!1}:{done:!0,value:void 0}}})});Object.defineProperty(Ft.prototype,"length",{enumerable:!1,configurable:!0,get:function(){return this.$mobx.getArrayLength()},set:function(e){this.$mobx.setArrayLength(e)}});pi(Ft.prototype,Sn(),"Array");["every","filter","forEach","indexOf","join","lastIndexOf","map","reduce","reduceRight","slice","some","toString","toLocaleString"].forEach(function(e){var t=Array.prototype[e];it(typeof t=="function","Base function not defined on Array prototype: '"+e+"'"),pi(Ft.prototype,e,function(){return t.apply(this.peek(),arguments)})});Iu(Ft.prototype,["constructor","intercept","observe","clear","concat","get","replace","toJS","toJSON","peek","find","findIndex","splice","spliceWithArray","push","pop","set","shift","unshift","reverse","sort","remove","move","toString","toLocaleString"]);var Zh=il(0);function il(e){return{enumerable:!1,configurable:!1,get:function(){return this.get(e)},set:function(t){this.set(e,t)}}}function Qh(e){Object.defineProperty(Ft.prototype,""+e,il(e))}function zn(e){for(var t=Bn;t<e;t++)Qh(t);Bn=e}zn(1e3);var ep=Ut("ObservableArrayAdministration",tl);function ke(e){return bn(e)&&ep(e.$mobx)}var tp={},hr=function(){function e(t,i,r){if(i===void 0&&(i=dr),r===void 0&&(r="ObservableMap@"+Ie()),this.enhancer=i,this.name=r,this.$mobx=tp,this._keys=new Ft(void 0,ur,this.name+".keys()",!0),typeof Map!="function")throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js");this._data=new Map,this._hasMap=new Map,this.merge(t)}return e.prototype._has=function(t){return this._data.has(t)},e.prototype.has=function(t){var i=this;if(!x.trackingDerivation)return this._has(t);var r=this._hasMap.get(t);if(!r){var o=r=new $t(this._has(t),ur,this.name+"."+lo(t)+"?",!1);this._hasMap.set(t,o),Dn(o,function(){return i._hasMap.delete(t)})}return r.get()},e.prototype.set=function(t,i){var r=this._has(t);if(yt(this)){var o=vt(this,{type:r?"update":"add",object:this,newValue:i,name:t});if(!o)return this;i=o.newValue}return r?this._updateValue(t,i):this._addValue(t,i),this},e.prototype.delete=function(t){var i=this;if(yt(this)){var r=vt(this,{type:"delete",object:this,name:t});if(!r)return!1}if(this._has(t)){var o=De(),n=at(this),r=n||o?{type:"delete",object:this,oldValue:this._data.get(t).value,name:t}:null;return o&&Ne(Ee({},r,{name:this.name,key:t})),wt(function(){i._keys.remove(t),i._updateHasMapEntry(t,!1);var l=i._data.get(t);l.setNewValue(void 0),i._data.delete(t)}),n&&lt(this,r),o&&He(),!0}return!1},e.prototype._updateHasMapEntry=function(t,i){var r=this._hasMap.get(t);r&&r.setNewValue(i)},e.prototype._updateValue=function(t,i){var r=this._data.get(t);if(i=r.prepareNewValue(i),i!==x.UNCHANGED){var o=De(),n=at(this),a=n||o?{type:"update",object:this,oldValue:r.value,name:t,newValue:i}:null;o&&Ne(Ee({},a,{name:this.name,key:t})),r.setNewValue(i),n&&lt(this,a),o&&He()}},e.prototype._addValue=function(t,i){var r=this;wt(function(){var l=new $t(i,r.enhancer,r.name+"."+lo(t),!1);r._data.set(t,l),i=l.value,r._updateHasMapEntry(t,!0),r._keys.push(t)});var o=De(),n=at(this),a=n||o?{type:"add",object:this,name:t,newValue:i}:null;o&&Ne(Ee({},a,{name:this.name,key:t})),n&&lt(this,a),o&&He()},e.prototype.get=function(t){return this.has(t)?this.dehanceValue(this._data.get(t).get()):this.dehanceValue(void 0)},e.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},e.prototype.keys=function(){return this._keys[yn()]()},e.prototype.values=function(){var t=this,i=0;return cr({next:function(){return i<t._keys.length?{value:t.get(t._keys[i++]),done:!1}:{value:void 0,done:!0}}})},e.prototype.entries=function(){var t=this,i=0;return cr({next:function(){if(i<t._keys.length){var r=t._keys[i++];return{value:[r,t.get(r)],done:!1}}return{done:!0}}})},e.prototype.forEach=function(t,i){var r=this;this._keys.forEach(function(o){return t.call(i,r.get(o),o,r)})},e.prototype.merge=function(t){var i=this;return ye(t)&&(t=t.toJS()),wt(function(){hi(t)?Object.keys(t).forEach(function(r){return i.set(r,t[r])}):Array.isArray(t)?t.forEach(function(r){var o=ua(r,2),n=o[0],a=o[1];return i.set(n,a)}):Fi(t)?t.constructor!==Map?B("Cannot initialize from classes that inherit from Map: "+t.constructor.name):t.forEach(function(r,o){return i.set(o,r)}):t!=null&&B("Cannot initialize map from "+t)}),this},e.prototype.clear=function(){var t=this;wt(function(){Tn(function(){t._keys.slice().forEach(function(i){return t.delete(i)})})})},e.prototype.replace=function(t){var i=this;return wt(function(){for(var r=Ou(t),o=i._keys,n=Array.from(r.keys()),a=!1,l=0;l<o.length;l++){var c=o[l];o.length===n.length&&c!==n[l]&&(a=!0),r.has(c)||(a=!0,i.delete(c))}r.forEach(function(d,u){i._data.has(u)||(a=!0),i.set(u,d)}),a&&i._keys.replace(n)}),this},Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),e.prototype.toPOJO=function(){var t=this,i={};return this._keys.forEach(function(r){return i[typeof r=="symbol"?r:lo(r)]=t.get(r)}),i},e.prototype.toJS=function(){var t=this,i=new Map;return this._keys.forEach(function(r){return i.set(r,t.get(r))}),i},e.prototype.toJSON=function(){return this.toPOJO()},e.prototype.toString=function(){var t=this;return this.name+"[{ "+this._keys.map(function(i){return lo(i)+": "+(""+t.get(i))}).join(", ")+" }]"},e.prototype.observe=function(t,i){return gr(this,t)},e.prototype.intercept=function(t){return mr(this,t)},e}();function lo(e){return e&&e.toString?e.toString():new String(e).toString()}vn(hr.prototype,function(){return this.entries()});ar(hr.prototype,Sn(),"Map");var ye=Ut("ObservableMap",hr),ip={},pr=function(){function e(t,i,r){if(i===void 0&&(i=dr),r===void 0&&(r="ObservableSet@"+Ie()),this.name=r,this.$mobx=ip,this._data=new Set,this._atom=ba(this.name),typeof Set!="function")throw new Error("mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js");this.enhancer=function(o,n){return i(o,n,r)},t&&this.replace(t)}return e.prototype.dehanceValue=function(t){return this.dehancer!==void 0?this.dehancer(t):t},e.prototype.clear=function(){var t=this;wt(function(){Tn(function(){t._data.forEach(function(i){t.delete(i)})})})},e.prototype.forEach=function(t,i){var r=this;this._data.forEach(function(o){t.call(i,o,o,r)})},Object.defineProperty(e.prototype,"size",{get:function(){return this._atom.reportObserved(),this._data.size},enumerable:!0,configurable:!0}),e.prototype.add=function(t){var i=this;if(oo(this._atom),yt(this)){var r=vt(this,{type:"add",object:this,newValue:t});if(!r)return this}if(!this.has(t)){wt(function(){i._data.add(i.enhancer(t,void 0)),i._atom.reportChanged()});var o=De(),n=at(this),r=n||o?{type:"add",object:this,newValue:t}:null;o&&!1&&Ne(r),n&&lt(this,r),o&&!1&&He()}return this},e.prototype.delete=function(t){var i=this;if(yt(this)){var r=vt(this,{type:"delete",object:this,oldValue:t});if(!r)return!1}if(this.has(t)){var o=De(),n=at(this),r=n||o?{type:"delete",object:this,oldValue:t}:null;return o&&!1&&Ne(Ee({},r,{name:this.name})),wt(function(){i._atom.reportChanged(),i._data.delete(t)}),n&&lt(this,r),o&&!1&&He(),!0}return!1},e.prototype.has=function(t){return this._atom.reportObserved(),this._data.has(this.dehanceValue(t))},e.prototype.entries=function(){var t=0,i=Ot(this.keys()),r=Ot(this.values());return cr({next:function(){var o=t;return t+=1,o<r.length?{value:[i[o],r[o]],done:!1}:{done:!0}}})},e.prototype.keys=function(){return this.values()},e.prototype.values=function(){this._atom.reportObserved();var t=this,i=0,r;return this._data.values!==void 0?r=Ot(this._data.values()):(r=[],this._data.forEach(function(o){return r.push(o)})),cr({next:function(){return i<r.length?{value:t.dehanceValue(r[i++]),done:!1}:{done:!0}}})},e.prototype.replace=function(t){var i=this;return Fe(t)&&(t=t.toJS()),wt(function(){Array.isArray(t)?(i.clear(),t.forEach(function(r){return i.add(r)})):lr(t)?(i.clear(),t.forEach(function(r){return i.add(r)})):t!=null&&B("Cannot initialize set from "+t)}),this},e.prototype.observe=function(t,i){return gr(this,t)},e.prototype.intercept=function(t){return mr(this,t)},e.prototype.toJS=function(){return new Set(this)},e.prototype.toString=function(){return this.name+"[ "+Ot(this.keys()).join(", ")+" ]"},e}();vn(pr.prototype,function(){return this.values()});ar(pr.prototype,Sn(),"Set");var Fe=Ut("ObservableSet",pr),rl=function(){function e(t,i,r){this.target=t,this.name=i,this.defaultEnhancer=r,this.values={}}return e.prototype.read=function(t,i){return this.target!==t&&(this.illegalAccess(t,i),!this.values[i])?void 0:this.values[i].get()},e.prototype.write=function(t,i,r){var o=this.target;o!==t&&this.illegalAccess(t,i);var n=this.values[i];if(n instanceof Vt){n.set(r);return}if(yt(this)){var a=vt(this,{type:"update",object:o,name:i,newValue:r});if(!a)return;r=a.newValue}if(r=n.prepareNewValue(r),r!==x.UNCHANGED){var l=at(this),c=De(),a=l||c?{type:"update",object:o,oldValue:n.value,name:i,newValue:r}:null;c&&Ne(Ee({},a,{name:this.name,key:i})),n.setNewValue(r),l&&lt(this,a),c&&He()}},e.prototype.remove=function(t){if(!this.values[t])return;var i=this.target;if(yt(this)){var r=vt(this,{object:i,name:t,type:"remove"});if(!r)return}try{ot();var o=at(this),n=De(),a=this.values[t].get();this.keys&&this.keys.remove(t),delete this.values[t],delete this.target[t];var r=o||n?{type:"remove",object:i,oldValue:a,name:t}:null;n&&Ne(Ee({},r,{name:this.name,key:t})),o&&lt(this,r),n&&He()}finally{nt()}},e.prototype.illegalAccess=function(t,i){console.warn("Property '"+i+"' of '"+t+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")},e.prototype.observe=function(t,i){return gr(this,t)},e.prototype.intercept=function(t){return mr(this,t)},e.prototype.getKeys=function(){var t=this;return this.keys===void 0&&(this.keys=new Ft(Object.keys(this.values).filter(function(i){return t.values[i]instanceof $t}),ur,"keys("+this.name+")",!0)),this.keys.slice()},e}();function Pn(e,t,i){t===void 0&&(t=""),i===void 0&&(i=dr);var r=e.$mobx;return r||(hi(e)||(t=(e.constructor.name||"ObservableObject")+"@"+Ie()),t||(t="ObservableObject@"+Ie()),r=new rl(e,t,i),ar(e,"$mobx",r),r)}function wa(e,t,i,r){var o=Pn(e);if(Au(e,t),yt(o)){var n=vt(o,{object:e,name:t,type:"add",newValue:i});if(!n)return;i=n.newValue}var a=o.values[t]=new $t(i,r,o.name+"."+t,!1);i=a.value,Object.defineProperty(e,t,rp(t)),o.keys&&o.keys.push(t),op(o,e,t,i)}function Xu(e,t,i){var r=Pn(e);i.name=r.name+"."+t,i.context=e,r.values[t]=new Vt(i),Object.defineProperty(e,t,np(t))}var ol=Object.create(null),nl=Object.create(null);function rp(e){return ol[e]||(ol[e]={configurable:!0,enumerable:!0,get:function(){return this.$mobx.read(this,e)},set:function(t){this.$mobx.write(this,e,t)}})}function sl(e){var t=e.$mobx;return t||(mi(e),e.$mobx)}function np(e){return nl[e]||(nl[e]={configurable:x.computedConfigurable,enumerable:!1,get:function(){return sl(this).read(this,e)},set:function(t){sl(this).write(this,e,t)}})}function op(e,t,i,r){var o=at(e),n=De(),a=o||n?{type:"add",object:t,name:i,newValue:r}:null;n&&Ne(Ee({},a,{name:e.name,key:i})),o&&lt(e,a),n&&He()}var sp=Ut("ObservableObjectAdministration",rl);function Ae(e){return bn(e)?(mi(e),sp(e.$mobx)):!1}function qe(e,t){if(typeof e=="object"&&e!==null){if(ke(e))return t!==void 0&&B(!1),e.$mobx.atom;if(Fe(e))return e.$mobx;if(ye(e)){var i=e;if(t===void 0)return qe(i._keys);var r=i._data.get(t)||i._hasMap.get(t);return r||B(!1),r}if(mi(e),t&&!e.$mobx&&e[t],Ae(e)){if(!t)return B(!1);var r=e.$mobx.values[t];return r||B(!1),r}if(wn(e)||zi(e)||ao(e))return e}else if(typeof e=="function"&&ao(e.$mobx))return e.$mobx;return B(!1)}function St(e,t){if(e||B("Expecting some object"),t!==void 0)return St(qe(e,t));if(wn(e)||zi(e)||ao(e))return e;if(ye(e)||Fe(e))return e;if(mi(e),e.$mobx)return e.$mobx;B(!1)}function co(e,t){var i;return t!==void 0?i=qe(e,t):Ae(e)||ye(e)||Fe(e)?i=St(e):i=qe(e),i.name}var al=Object.prototype.toString;function xn(e,t,i){return i===void 0&&(i=-1),Nn(e,t,i)}function Nn(e,t,i,r,o){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var n=typeof e;if(n!=="function"&&n!=="object"&&typeof t!="object")return!1;e=ll(e),t=ll(t);var a=al.call(e);if(a!==al.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e===""+t;case"[object Number]":return+e!==+e?+t!==+t:+e===0?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t;case"[object Symbol]":return typeof Symbol!="undefined"&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t)}var l=a==="[object Array]";if(!l){if(typeof e!="object"||typeof t!="object")return!1;var c=e.constructor,d=t.constructor;if(c!==d&&!(typeof c=="function"&&c instanceof c&&typeof d=="function"&&d instanceof d)&&"constructor"in e&&"constructor"in t)return!1}if(i===0)return!1;i<0&&(i=-1),r=r||[],o=o||[];for(var u=r.length;u--;)if(r[u]===e)return o[u]===t;if(r.push(e),o.push(t),l){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!Nn(e[u],t[u],i-1,r,o))return!1}else{var h=Object.keys(e),y=void 0;if(u=h.length,Object.keys(t).length!==u)return!1;for(;u--;)if(y=h[u],!(ap(t,y)&&Nn(e[y],t[y],i-1,r,o)))return!1}return r.pop(),o.pop(),!0}function ll(e){return ke(e)?e.peek():Fi(e)||ye(e)||(lr(e)||Fe(e))?Ot(e.entries()):e}function ap(e,t){return Object.prototype.hasOwnProperty.call(e,t)}try{}catch(e){var cl=Ii();typeof process=="undefined"&&(cl.process={}),cl.process.env={}}(function(){function e(){}if(e.name!=="testCodeMinification"&&!1&&process.env.IGNORE_MOBX_MINIFY_WARNING!=="true"){var t=["process","env","NODE_ENV"].join(".");console.warn("[mobx] you are running a minified build, but '"+t+"' was not set to 'production' in your bundler. This results in an unnecessarily large and slow bundle")}})();var dl="$mobx";typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:Ua,extras:{getDebugName:co},$mobx:dl});if(!1)var wy});var At=uo((Dy,ul)=>{var cp="Expected a function",hl=0/0,dp="[object Symbol]",up=/^\s+|\s+$/g,hp=/^[-+]0x[0-9a-f]+$/i,pp=/^0b[01]+$/i,fp=/^0o[0-7]+$/i,mp=parseInt,gp=typeof global=="object"&&global&&global.Object===Object&&global,bp=typeof self=="object"&&self&&self.Object===Object&&self,yp=gp||bp||Function("return this")(),vp=Object.prototype,Sp=vp.toString,wp=Math.max,Dp=Math.min,Hn=function(){return yp.Date.now()};function xp(e,t,i){var r,o,n,a,l,c,d=0,u=!1,h=!1,y=!0;if(typeof e!="function")throw new TypeError(cp);t=pl(t)||0,jn(i)&&(u=!!i.leading,h="maxWait"in i,n=h?wp(pl(i.maxWait)||0,t):n,y="trailing"in i?!!i.trailing:y);function k(M){var Z=r,pe=o;return r=o=void 0,d=M,a=e.apply(pe,Z),a}function w(M){return d=M,l=setTimeout($,t),u?k(M):a}function T(M){var Z=M-c,pe=M-d,Tt=t-Z;return h?Dp(Tt,n-pe):Tt}function F(M){var Z=M-c,pe=M-d;return c===void 0||Z>=t||Z<0||h&&pe>=n}function $(){var M=Hn();if(F(M))return E(M);l=setTimeout($,T(M))}function E(M){return l=void 0,y&&r?k(M):(r=o=void 0,a)}function ce(){l!==void 0&&clearTimeout(l),d=0,r=c=o=l=void 0}function bt(){return l===void 0?a:E(Hn())}function _e(){var M=Hn(),Z=F(M);if(r=arguments,o=this,c=M,Z){if(l===void 0)return w(c);if(h)return l=setTimeout($,t),k(c)}return l===void 0&&(l=setTimeout($,t)),a}return _e.cancel=ce,_e.flush=bt,_e}function jn(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Cp(e){return!!e&&typeof e=="object"}function _p(e){return typeof e=="symbol"||Cp(e)&&Sp.call(e)==dp}function pl(e){if(typeof e=="number")return e;if(_p(e))return hl;if(jn(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=jn(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(up,"");var i=pp.test(e);return i||fp.test(e)?mp(e.slice(2),i?2:8):hp.test(e)?hl:+e}ul.exports=xp});var Rt=uo((xy,fl)=>{var ml="Expected a function",gl=0/0,Ep="[object Symbol]",kp=/^\s+|\s+$/g,Tp=/^[-+]0x[0-9a-f]+$/i,Op=/^0b[01]+$/i,Ip=/^0o[0-7]+$/i,Fp=parseInt,Ap=typeof global=="object"&&global&&global.Object===Object&&global,Rp=typeof self=="object"&&self&&self.Object===Object&&self,Mp=Ap||Rp||Function("return this")(),zp=Object.prototype,Pp=zp.toString,Bp=Math.max,Lp=Math.min,Wn=function(){return Mp.Date.now()};function Np(e,t,i){var r,o,n,a,l,c,d=0,u=!1,h=!1,y=!0;if(typeof e!="function")throw new TypeError(ml);t=bl(t)||0,ho(i)&&(u=!!i.leading,h="maxWait"in i,n=h?Bp(bl(i.maxWait)||0,t):n,y="trailing"in i?!!i.trailing:y);function k(M){var Z=r,pe=o;return r=o=void 0,d=M,a=e.apply(pe,Z),a}function w(M){return d=M,l=setTimeout($,t),u?k(M):a}function T(M){var Z=M-c,pe=M-d,Tt=t-Z;return h?Lp(Tt,n-pe):Tt}function F(M){var Z=M-c,pe=M-d;return c===void 0||Z>=t||Z<0||h&&pe>=n}function $(){var M=Wn();if(F(M))return E(M);l=setTimeout($,T(M))}function E(M){return l=void 0,y&&r?k(M):(r=o=void 0,a)}function ce(){l!==void 0&&clearTimeout(l),d=0,r=c=o=l=void 0}function bt(){return l===void 0?a:E(Wn())}function _e(){var M=Wn(),Z=F(M);if(r=arguments,o=this,c=M,Z){if(l===void 0)return w(c);if(h)return l=setTimeout($,t),k(c)}return l===void 0&&(l=setTimeout($,t)),a}return _e.cancel=ce,_e.flush=bt,_e}function Hp(e,t,i){var r=!0,o=!0;if(typeof e!="function")throw new TypeError(ml);return ho(i)&&(r="leading"in i?!!i.leading:r,o="trailing"in i?!!i.trailing:o),Np(e,t,{leading:r,maxWait:t,trailing:o})}function ho(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function jp(e){return!!e&&typeof e=="object"}function Wp(e){return typeof e=="symbol"||jp(e)&&Pp.call(e)==Ep}function bl(e){if(typeof e=="number")return e;if(Wp(e))return gl;if(ho(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ho(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(kp,"");var i=Op.test(e);return i||Ip.test(e)?Fp(e.slice(2),i?2:8):Tp.test(e)?gl:+e}fl.exports=Hp});var vr=uo((Cy,yl)=>{var Up=!!(typeof window!="undefined"&&window.document&&window.document.createElement);yl.exports=Up});var wr=uo((_y,vl)=>{var $p="Expected a function",Sl="__lodash_hash_undefined__",Vp="[object Function]",Gp="[object GeneratorFunction]",qp=/[\\^$.*+?()[\]{}|]/g,Xp=/^\[object .+?Constructor\]$/,Kp=typeof global=="object"&&global&&global.Object===Object&&global,Yp=typeof self=="object"&&self&&self.Object===Object&&self,wl=Kp||Yp||Function("return this")();function Jp(e,t){return e==null?void 0:e[t]}function Zp(e){var t=!1;if(e!=null&&typeof e.toString!="function")try{t=!!(e+"")}catch(i){}return t}var Qp=Array.prototype,ef=Function.prototype,Dl=Object.prototype,Un=wl["__core-js_shared__"],xl=function(){var e=/[^.]+$/.exec(Un&&Un.keys&&Un.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Cl=ef.toString,$n=Dl.hasOwnProperty,tf=Dl.toString,rf=RegExp("^"+Cl.call($n).replace(qp,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),of=Qp.splice,nf=_l(wl,"Map"),Sr=_l(Object,"create");function bi(e){var t=-1,i=e?e.length:0;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function sf(){this.__data__=Sr?Sr(null):{}}function af(e){return this.has(e)&&delete this.__data__[e]}function lf(e){var t=this.__data__;if(Sr){var i=t[e];return i===Sl?void 0:i}return $n.call(t,e)?t[e]:void 0}function cf(e){var t=this.__data__;return Sr?t[e]!==void 0:$n.call(t,e)}function df(e,t){var i=this.__data__;return i[e]=Sr&&t===void 0?Sl:t,this}bi.prototype.clear=sf;bi.prototype.delete=af;bi.prototype.get=lf;bi.prototype.has=cf;bi.prototype.set=df;function Li(e){var t=-1,i=e?e.length:0;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function uf(){this.__data__=[]}function hf(e){var t=this.__data__,i=po(t,e);if(i<0)return!1;var r=t.length-1;return i==r?t.pop():of.call(t,i,1),!0}function pf(e){var t=this.__data__,i=po(t,e);return i<0?void 0:t[i][1]}function ff(e){return po(this.__data__,e)>-1}function mf(e,t){var i=this.__data__,r=po(i,e);return r<0?i.push([e,t]):i[r][1]=t,this}Li.prototype.clear=uf;Li.prototype.delete=hf;Li.prototype.get=pf;Li.prototype.has=ff;Li.prototype.set=mf;function yi(e){var t=-1,i=e?e.length:0;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function gf(){this.__data__={hash:new bi,map:new(nf||Li),string:new bi}}function bf(e){return fo(this,e).delete(e)}function yf(e){return fo(this,e).get(e)}function vf(e){return fo(this,e).has(e)}function Sf(e,t){return fo(this,e).set(e,t),this}yi.prototype.clear=gf;yi.prototype.delete=bf;yi.prototype.get=yf;yi.prototype.has=vf;yi.prototype.set=Sf;function po(e,t){for(var i=e.length;i--;)if(wf(e[i][0],t))return i;return-1}function _f(e){if(!El(e)||Df(e))return!1;var t=Cf(e)||Zp(e)?rf:Xp;return t.test(xf(e))}function fo(e,t){var i=e.__data__;return Ef(t)?i[typeof t=="string"?"string":"hash"]:i.map}function _l(e,t){var i=Jp(e,t);return _f(i)?i:void 0}function Ef(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Df(e){return!!xl&&xl in e}function xf(e){if(e!=null){try{return Cl.call(e)}catch(t){}try{return e+""}catch(t){}}return""}function Vn(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new TypeError($p);var i=function(){var r=arguments,o=t?t.apply(this,r):r[0],n=i.cache;if(n.has(o))return n.get(o);var a=e.apply(this,r);return i.cache=n.set(o,a),a};return i.cache=new(Vn.Cache||yi),i}Vn.Cache=yi;function wf(e,t){return e===t||e!==e&&t!==t}function Cf(e){var t=El(e)?tf.call(e):"";return t==Vp||t==Gp}function El(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}vl.exports=Vn});const kl=(e=ky())=>!!e.match(/iP(hone|od|ad)|AppleWebKit/),Tl=()=>{const e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");return t&&t instanceof WebGLRenderingContext};const Ol=e=>e.replace(Oy,"");const Il=e=>e instanceof HTMLImageElement;class kf{constructor(){this.enabled=!0;this.threshold=20;this.snapToHorizontalCenter=!0;this.snapToVerticalCenter=!0;this.snapToLeft=.1;this.snapToRight=.1;this.snapToTop=.1;this.snapToBottom=.1}}class Tf{constructor(){this.enabled=!0;this.threshold=20;this.angles=[0,45,90,135,180,225,270,315]}}class Fl{constructor(){this.position=new kf;this.rotation=new Tf}}class Al{constructor(){this.categories=[];this.flattenCategories=!1}}class Rl{constructor(){this.categories=[];this.flattenCategories=!1;this.categoryHeaderType=Gn.CARD;this.enablePreviewThumbnails=!1}}class Ml{constructor(){this.items=[]}}class zl{constructor(){this.items=[]}}class Pl{constructor(){this.enableWebcam=!1;this.enableUpload=!1;this.flattenCategories=!1;this.categoryHeaderType=Gn.CARD}}class Bl{constructor(){this.items=[]}}class Ll{constructor(){this.categories=[];this.canvasActions=[fe.BRING_TO_FRONT,fe.FLIP,fe.DUPLICATE,fe.DELETE];this.flattenCategories=!1;this.categoryHeaderType=Gn.CARD;this.enableCustomUpload=!0;this.customStickerTintMode="none"}}class Nl{constructor(){this.fonts=[];this.canvasActions=[fe.EDIT,fe.BRING_TO_FRONT,fe.DUPLICATE,fe.DELETE];this.disableAutoScaling=!1}}class Hl{constructor(){this.defaultSize=.05;this.defaultHardness=.5}}class jl{constructor(){this.items=[];this.canvasActions=[fe.EDIT,fe.BRING_TO_FRONT,fe.INVERT,fe.DUPLICATE,fe.DELETE]}}class Wl{constructor(){this.categories=[];this.enableRotation=!0;this.enableFlip=!0;this.flattenCategories=!1;this.categoryHeaderType=Gn.TEXT}}const qn={};lp(qn,{isMobile:()=>Uy});const Of=e=>e.key==="Escape",Ul=e=>t=>{Of(t)&&e(t)};const Yt=Gy;const Xn=(e,t,[i,r],o=0)=>{const n=e[t];if(n){if(n<i)return console.error(`${t} must be greater than or equal to ${i}`),i;if(n>r)return console.error(`${t} must be less than or equal to ${r}`),r}return n||o},ct=(e,t,i=[1,1,1,1])=>{const r=e[t];let o=!0;return r&&r.forEach(n=>{n<0&&(console.error(`${n} in ${t} must be greater than or equal to 0`),o=!1),n>1&&(console.error(`${n} in ${t} must be less than or equal to 1`),o=!1)}),o&&r||i};function Dt(e){return typeof e=="number"}const If=e=>-e,Dr=({rotation:e,flipHorizontally:t,flipVertically:i})=>{let r=e;return t&&(r=Kn(r)),i&&(r=If(r)),r};class $l{constructor(e){this.isEmpty=!1;this.isValid=!1;this.isWhiteLabel=()=>this.isValid&&this.licenseChecker.isWhiteLabel();this.areCustomAssetsAllowed=()=>this.isEmpty||this.isValid&&this.licenseChecker.areCustomAssetsAllowed();e&&e.length!==0?(this.licenseChecker=new Jy.LicenseChecker(e),this.isValid=this.licenseChecker.validate()):e===""&&(this.isEmpty=!0)}isToolAllowed(e){return this.licenseChecker&&this.isValid?this.licenseChecker.isToolAllowed(e):!0}}const Yn=e=>{let t=Number(e).toString(16);return t.length<2&&(t=`0${t}`),t},Vl=(e,t,i)=>{const r=Yn(e*255),o=Yn(t*255),n=Yn(i*255);return`#${r}${o}${n}`},xr=e=>{if(Ff(e)){const[t,i,r,o]=e;return`rgba(${t*255}, ${i*255}, ${r*255}, ${o})`}if(Af(e)){const{r:t,g:i,b:r,a:o}=e;return`rgba(${t*255}, ${i*255}, ${r*255}, ${o})`}if(Rf(e)){const[t,i,r]=e;return Vl(t,i,r)}if(Mf(e)){const{r:t,g:i,b:r}=e;return Vl(t,i,r)}return e},dt=e=>e.map(t=>({identifier:t.name,color:t.color,colorString:xr(t.color)})),Be={black:[0/255,0/255,0/255,1],white:[255/255,255/255,255/255,1],gray:[191/255,191/255,191/255,1],blue:[102/255,134/255,255/255,1],skyBlue:[102/255,204/255,255/255,1],red:[231/255,80/255,80/255,1],orange:[242/255,136/255,85/255,1],yellow:[255/255,247/255,99/255,1]},Jn={transparent:[0/255,0/255,0/255,0],black:[0/255,0/255,0/255,1],white:[255/255,255/255,255/255,1],blue:[102/255,134/255,255/255,1],skyBlue:[102/255,204/255,255/255,1],red:[231/255,80/255,80/255,1],orange:[242/255,136/255,85/255,1],yellow:[255/255,247/255,99/255,1]};const mo=[f.LIBRARY,[f.TRANSFORM,f.FILTER,f.ADJUSTMENT],[f.FOCUS,f.FRAME,f.OVERLAY],[f.TEXT,f.TEXT_DESIGN,f.STICKER,f.BRUSH]];const Zn={license:"",order:"default",language:"en",theme:"dark",layout:"advanced",mainCanvasActions:[fe.UNDO,fe.REDO,fe.EXPORT,fe.CLOSE],displayResizeWarning:!1,displayCloseWarning:!0,displayCanvasRendererWarning:!0,displayToolControlBarTitle:!0,engine:{crossOrigin:"anonymous",downscaleOptions:{maxMegaPixels:{desktop:10,mobile:5}},preferredRenderer:Tl()?"webgl":"canvas"},enableZoom:!0,forceCrop:!1,assetBaseUrl:"assets/",defaultTool:f.FILTER,tools:mo,snapping:new Fl,filter:new Rl,focus:new Ml,adjustment:new Al,library:new Pl,overlay:new Bl,sticker:new Ll,text:new Nl,textdesign:new jl,frame:new zl,brush:new Hl,transform:new Wl,export:{image:{exportType:Ni.IMAGE,format:Mt.PNG,quality:.9,enableDownload:!0},filename:"photoeditorsdk-export"},custom:{}};const go={[Xe.BRIGHTNESS]:0,[Xe.SATURATION]:0,[Xe.CONTRAST]:0,[Xe.GAMMA]:0,[Xe.CLARITY]:0,[Xe.EXPOSURE]:0,[Xe.SHADOWS]:0,[Xe.HIGHLIGHTS]:0,[Xe.WHITES]:0,[Xe.BLACKS]:0,[Xe.TEMPERATURE]:0,[Xe.SHARPNESS]:0};const Hi=m(b());class Cr{constructor(){this.snapshots=[];this.observeIndex=Hi.observable.box(-1)}addSnapshot(e){this.index===this.snapshots.length-1?this.snapshots=this.snapshots.concat(JSON.stringify(e)):this.snapshots=[...this.snapshots.slice(0,this.index+1),JSON.stringify(e)],this.observeIndex.set(this.snapshots.length-1)}getCurrentState(){return this.snapshots[this.index]}reset(){this.snapshots=[],this.observeIndex.set(-1)}undo(){return this.canUndo?(this.observeIndex.set(this.index-1),JSON.parse(this.getCurrentState())):null}redo(){return this.canRedo?(this.observeIndex.set(this.index+1),JSON.parse(this.getCurrentState())):null}discardSnapshotsfromIndex(e){e>0&&e<this.snapshots.length-1&&(this.snapshots=this.snapshots.slice(0,e),this.observeIndex.set(this.snapshots.length-1))}get index(){return this.observeIndex.get()}get canUndo(){return this.index>0}get canRedo(){return this.snapshots.length-1>this.index}}s([Hi.computed],Cr.prototype,"index",1),s([Hi.computed],Cr.prototype,"canUndo",1),s([Hi.computed],Cr.prototype,"canRedo",1);const ut=m(b());var R;(function(e){e.ADD="add",e.EDIT="edit",e.DELETE="delete"})(R||(R={}));class ji{constructor(e){this.localTransformStartIndex=null;this.awaitHistoryChange=!1;this.isDirtySinceSave=!1;this.undo=()=>I(this,null,function*(){if(!this.awaitHistoryChange){this.awaitHistoryChange=!0;const e=this.appHistoryManager.undo();yield this.applyState(e),this.awaitHistoryChange=!1,this.canUndo||(this.isDirtySinceSave=!1)}});this.redo=()=>I(this,null,function*(){if(!this.awaitHistoryChange){this.awaitHistoryChange=!0;const e=this.appHistoryManager.redo();yield this.applyState(e),this.awaitHistoryChange=!1}});this.editor=e,this.appHistoryManager=new Cr}get canUndo(){return this.appHistoryManager.canUndo}get canRedo(){return this.appHistoryManager.canRedo}getHistoryState(){const e=ut.toJS(this.editor.adjustmentsToolStore.state),t=ut.toJS(this.editor.filterToolStore.state),i=this.editor.focusToolStore.getFocusStateForHistory(),r=ut.toJS(this.editor.overlayToolStore.state),o=ut.toJS(this.editor.frameToolStore.state),n=this.editor.brushToolStore.strokes||{strokes:[]},a=this.editor.spriteStore.getSpriteHistoryState(),l=this.editor.transformToolStore.serializableState;return{[f.ADJUSTMENT]:e,[f.FILTER]:t,[f.FOCUS]:i,[f.OVERLAY]:r,[f.FRAME]:o,[f.BRUSH]:n,sprite:a,[f.TRANSFORM]:l}}addInitialSnapshot(){const e=this.getHistoryState();this.appHistoryManager.addSnapshot({state:e,type:R.ADD,description:"Initial State"})}addSnapshot(e=this.getHistoryState(),t,i){e&&((e.sprite||e.transform)&&(e=p(p({},this.getHistoryState()),e)),this.appHistoryManager.addSnapshot({state:e,type:t,description:i}),this.editor.configStore.events.onHistoryChange(),this.isDirtySinceSave||(this.isDirtySinceSave=!0))}saveTransformLocalSnapshotIndex(){this.localTransformStartIndex===null&&(this.localTransformStartIndex=this.appHistoryManager.snapshots.length)}removeTransformLocalSnapshots(){this.localTransformStartIndex!==null&&(this.appHistoryManager.discardSnapshotsfromIndex(this.localTransformStartIndex-1),this.localTransformStartIndex=null)}applyState(t){return I(this,arguments,function*({state:e}){try{if(e){const i=Object.keys(e);for(const r of i)switch(r){case f.FILTER:yield this.editor.filterToolStore.updateStateFromHistory(e[r]);break;case f.ADJUSTMENT:yield this.editor.adjustmentsToolStore.updateStateFromHistory(e[r]);break;case f.OVERLAY:yield this.editor.overlayToolStore.updateStateFromHistory(e[r]);break;case f.FRAME:yield this.editor.frameToolStore.updateStateFromHistory(e[r]);break;case f.FOCUS:yield this.editor.focusToolStore.updateStateFromHistory(e[r],this.editor.canvasStore.sizeVector);break;case f.BRUSH:yield this.editor.brushToolStore.updateStateFromHistory(e[r]);break;case"sprite":yield this.editor.spriteStore.updateStateFromHistory(e[r]);break;case"localTransform":yield this.editor.transformToolStore.updateLocalStateFromHistory(e.localTransform);break;case f.TRANSFORM:this.editor.outputContainer.pauseChildrenUpdates(),this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.updateStateFromSerialization(e[r],!1),this.editor.transformToolStore.onLeave(),this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.onLeave(),this.editor.outputContainer.resumeChildrenUpdates(),yield this.editor.wait();break}yield this.editor.renderPromise()}}catch(i){console.error(i),this.editor.modalStore.showActionModal({type:se.ERROR,identifier:"unexpectedError",error:i,handleConfirm:()=>{window.location.reload()}})}})}isDirty(){return this.appHistoryManager.snapshots.length>1}reset(){this.appHistoryManager.reset(),this.isDirtySinceSave=!1}}s([ut.action],ji.prototype,"undo",2),s([ut.action],ji.prototype,"redo",2),s([ut.computed],ji.prototype,"canUndo",1),s([ut.computed],ji.prototype,"canRedo",1);class de{constructor(e,t){this.assets=[];this.entityMapper=e=>"items"in e?this.categoryMapper(e):this.itemMapper(e);this.categoryMapper=e=>e?p(p({},e),{thumbnailURI:this.getCategoryURI(e),name:this.config.locale[e.identifier]||e.name,items:e.items.map(this.itemMapper)}):null;this.itemMapper=e=>p(p({},e),{thumbnailURI:this.getItemURI(e),name:this.config.locale[e.identifier]||("name"in e?e.name:"")});this.getCategoryURI=e=>e.thumbnailURI&&(bo(e.thumbnailURI)||e.thumbnailURI.substr(0,10)==="data:image")?e.thumbnailURI:this.config.getAssetPath(e[this.config.categoryKey]||"");this.getItemURI=e=>"thumbnailURI"in e&&(bo(e.thumbnailURI)||e.thumbnailURI.substr(0,10)==="data:image")?e.thumbnailURI:this.config.getAssetPath(e[this.config.itemKey]||"");this.config=t,this.assets=e.map(this.entityMapper).filter(Boolean)}static isCategory(e){return Object.prototype.hasOwnProperty.call(e,"items")}get categories(){return this.assets.reduce((e,t)=>de.isCategory(t)?[...e,t]:void 0,[]).filter(Boolean)}get items(){return this.assets.reduce((e,t)=>de.isCategory(t)?[...e,...t.items]:[...e,t],[]).filter(Boolean)}}class Jt{constructor(e,t){this.from=e,this.to=t}contains(e){return this.from<=e&&e<=this.to}clamp(e){return Math.min(Math.max(this.from,e),this.to)}}const vi=m(b()),zf=new Jt(-1,1);class _r{constructor(e){this.editAdjustments=({type:e,value:t})=>{const i=zf.clamp(t);this.state[e]=i};this.reset=()=>{vi.runInAction(()=>{this.indexInContainer===-1&&(Object.keys(go).forEach(e=>{this.state[e]=go[e]}),this.orderHelper.removeIndex(f.ADJUSTMENT))})};this.setAdjustmentEffect=e=>{const t=this.orderHelper.addIndex(f.ADJUSTMENT);return this.effect?this.effect.setProperties(e):this.effect=this.engineMediator.engine.addAdjustments(e,this.engineMediator.image.container,t),this.effect.getProperties()};this.removeAdjustmentEffect=()=>{this.effect&&(this.engineMediator.engine.removeEffect(this.effect),this.indexInContainer===-1&&(this.effect=void 0))};this.engineMediator=e,this.state=go}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}get orderHelper(){return this.engineMediator.orderHelper}}s([vi.observable],_r.prototype,"state",2),s([vi.action],_r.prototype,"editAdjustments",2),s([vi.action],_r.prototype,"reset",2);const W=m(b());class q{constructor(e){this.dirty=W.observable.box(!1);this.editAdjustments=({type:e,value:t})=>{this.pureSetAdjustment({type:e,value:t}),this.editor.render()};this.toolSnapshot=()=>{this.dirty.set(!0),this.addSnapshot(R.EDIT,f.ADJUSTMENT)};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.toggleOptionSelection=e=>{this.selectedOption=e};this.pureSetAdjustment=({type:e,value:t})=>{const i=this.adjustmentsStore.setAdjustmentEffect({[e]:t});this.adjustmentsStore.editAdjustments({type:e,value:i[e]})};this.pureReset=()=>{this.dirty.set(!1),this.adjustmentsStore.removeAdjustmentEffect(),this.adjustmentsStore.reset(),this.selectedOption=""};this.reset=()=>{this.pureReset(),this.addSnapshot(R.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.updateStateFromHistory=e=>{W.runInAction(()=>{Object.keys(e).forEach(t=>{this.pureSetAdjustment({type:t,value:e[t]})})})};this.updateStateFromSerialization=e=>{this.updateStateFromHistory(e)};this.editor=e,this.adjustmentsStore=new _r(this.editor.engineMediator),this.selectedOption="";const t=this.editor.assetProvider.getAssets("adjustment");this.entityManager=new de(t,p(p({},this.config),{categoryKey:"",itemKey:"thumbnailURI",locale:p(p({},this.locale.items),this.locale.categories),getAssetPath:this.editor.getAssetPath("adjustment")}))}get selectedAdjustmentType(){return this.selectedOption}get isDirty(){return this.dirty.get()}get state(){return this.adjustmentsStore.state}get selectedOptionLabel(){const e=this.items.find(t=>t?t.identifier===this.selectedOption:!1);return e?e.name:""}get brightness(){return this.state.brightness}get saturation(){return this.state.saturation}get contrast(){return this.state.contrast}get gamma(){return this.state.gamma}get clarity(){return this.state.clarity}get exposure(){return this.state.exposure}get shadows(){return this.state.shadows}get highlights(){return this.state.highlights}get whites(){return this.state.whites}get blacks(){return this.state.blacks}get temperature(){return this.state.temperature}get sharpness(){return this.state.sharpness}get categories(){return this.entityManager.categories}get items(){return this.entityManager.items}get config(){return this.editor.configStore.config[f.ADJUSTMENT]}get locale(){return this.editor.configStore.locale[f.ADJUSTMENT]}}s([W.observable],q.prototype,"selectedOption",2),s([W.observable],q.prototype,"dirty",2),s([W.action],q.prototype,"editAdjustments",2),s([W.action],q.prototype,"toggleOptionSelection",2),s([W.action],q.prototype,"pureSetAdjustment",2),s([W.action],q.prototype,"pureReset",2),s([W.action],q.prototype,"reset",2),s([W.action],q.prototype,"updateStateFromHistory",2),s([W.action],q.prototype,"updateStateFromSerialization",2),s([W.computed],q.prototype,"selectedAdjustmentType",1),s([W.computed],q.prototype,"isDirty",1),s([W.computed],q.prototype,"state",1),s([W.computed],q.prototype,"selectedOptionLabel",1),s([W.computed],q.prototype,"brightness",1),s([W.computed],q.prototype,"saturation",1),s([W.computed],q.prototype,"contrast",1),s([W.computed],q.prototype,"gamma",1),s([W.computed],q.prototype,"clarity",1),s([W.computed],q.prototype,"exposure",1),s([W.computed],q.prototype,"shadows",1),s([W.computed],q.prototype,"highlights",1),s([W.computed],q.prototype,"whites",1),s([W.computed],q.prototype,"blacks",1),s([W.computed],q.prototype,"temperature",1),s([W.computed],q.prototype,"sharpness",1),s([W.computed],q.prototype,"categories",1),s([W.computed],q.prototype,"items",1),s([W.computed],q.prototype,"config",1),s([W.computed],q.prototype,"locale",1);const yo={identifier:"identity",intensity:1,isDuotone:!1};const Si=m(b()),Pf=new Jt(0,1);class wi{constructor(e){this.changeIdentifier=e=>{this.state.identifier=e};this.changeIfDuotone=e=>{this.state.isDuotone=e};this.changeIntensity=e=>{const t=Pf.clamp(e);this.state.intensity=t};this.reset=()=>{this.indexInContainer===-1&&(this.state.identifier=yo.identifier,this.state.intensity=yo.intensity,this.removeIndex())};this.setFilterEffect=({identifier:e,intensity:t,isDuotone:i})=>{const r=this.state;this.changeIdentifier(e),this.changeIntensity(t),this.changeIfDuotone(i),this.removeFilterEffect();const o=this.engineMediator.orderHelper.addIndex(f.FILTER);return i?new Promise((n,a)=>{this.engineMediator.engine.addDuoToneFilterFromAssets(e,this.engineMediator.image.container,o).then(l=>{this.effect=l,this.effect.setProperties({colorIntensity:t}),n()}).catch(l=>{this.fallbackOnError(r),a(l)})}):new Promise((n,a)=>{this.engineMediator.engine.addLUTFilterFromAssets(e,this.engineMediator.image.container,o).then(l=>{this.effect=l,this.effect.setProperties({intensity:t}),n()}).catch(l=>{this.fallbackOnError(r),a(l)})})};this.removeFilterEffect=()=>{this.effect&&(this.engineMediator.engine.removeEffect(this.effect),this.indexInContainer===-1&&(this.effect=void 0))};this.setEffectProperties=({intensity:e})=>this.effect?(this.state.isDuotone?this.effect.setProperties({colorIntensity:e}):this.effect.setProperties({intensity:e}),this.effect.getProperties()):null;this.removeIndex=()=>{this.engineMediator.orderHelper.removeIndex(f.FILTER)};this.fallbackOnError=e=>{this.changeIdentifier(e.identifier),this.changeIntensity(e.intensity),e.identifier==="identity"&&this.removeIndex()};this.engineMediator=e,this.state=yo}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}}s([Si.observable],wi.prototype,"state",2),s([Si.action],wi.prototype,"changeIdentifier",2),s([Si.action],wi.prototype,"changeIfDuotone",2),s([Si.action],wi.prototype,"changeIntensity",2),s([Si.action],wi.prototype,"reset",2);const oe=m(b()),Qn="identity";class ae{constructor(e){this.selectFilter=(e,t=1)=>I(this,null,function*(){e!==this.identifier&&(yield this.filterStore.setFilterEffect({identifier:e,intensity:t,isDuotone:this.isOptionDuoTone(e)}),this.editor.render(),this.addSnapshot(R.ADD,f.FILTER))});this.changeIntensity=e=>{const t=this.isOptionDuoTone(this.identifier),i=this.filterStore.setEffectProperties({intensity:e});if(i){const r=t?i.colorIntensity:i.intensity;this.filterStore.changeIntensity(r),this.editor.render()}};this.setImageAndGetPreviews=()=>I(this,null,function*(){const{image:e}=this.editor.activeStore.state;yield this.editor.previewThumbnails.addImageToContainer(e),yield this.getAllFilterPreview()});this.getAllFilterPreview=()=>I(this,null,function*(){const e=this.entityManager.items.map(o=>({identifier:o.identifier,isDuotone:this.isOptionDuoTone(o.identifier)})),t=yield this.editor.previewThumbnails.getAllFilterPreviewThumbnails(e);yield this.editor.wait();const{config:i}=this,r=this.editor.configStore.assetProvider.getAssets("filter").map(o=>p(p({},o),{items:o.items.map(n=>p(p({},n),{thumbnailURI:t[n.identifier]}))}));this.entityManager=new de(r,p(p({},i),{categoryKey:"thumbnailURI",itemKey:"thumbnailURI",locale:this.locale.items,getAssetPath:this.editor.getAssetPath("filter")}))});this.toolSnapshot=()=>{this.addSnapshot(R.EDIT,this.locale.controls.sliderIntensity)};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.pureReset=()=>{this.selectedCategory=Qn,this.filterStore.removeFilterEffect(),this.filterStore.reset()};this.reset=()=>{this.pureReset(),this.addSnapshot(R.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.toggleCategorySelection=e=>{this.selectedCategory=this.selectedCategory===e?Qn:e};this.updateStateFromSerialization=({identifier:e,intensity:t})=>{const i=this.doesFilterAssetExist(e);if(i){const r=Gl(i);return this.filterStore.setFilterEffect({identifier:e,intensity:t,isDuotone:r})}return new Promise((r,o)=>{o(new Error(`Filter Asset ${e} doesn't exist`))})};this.updateStateFromHistory=e=>I(this,null,function*(){return e.identifier==="identity"?(this.pureReset(),new Promise(t=>{t()})):this.filterStore.setFilterEffect(e)});this.doesFilterAssetExist=e=>this.entityManager.items.find(t=>e===t.identifier);this.isOptionDuoTone=e=>{const t=this.doesFilterAssetExist(e);return t?Gl(t):!1};this.editor=e,this.selectedCategory=Qn,this.filterStore=new wi(this.editor.engineMediator);const{config:t}=this,i=this.editor.configStore.assetProvider.getAssets("filter");this.entityManager=new de(i,p(p({},t),{categoryKey:"thumbnailURI",itemKey:"thumbnailURI",locale:this.locale.items,getAssetPath:this.editor.getAssetPath("filter")}))}get state(){return this.filterStore.state}get identifier(){return this.state.identifier}get intensity(){return this.state.intensity}get isDuotone(){return this.state.isDuotone}get selectedCategoryIdentifier(){return this.selectedCategory}get isOptionSelected(){return this.identifier!=="identity"}get config(){return this.editor.configStore.config[f.FILTER]}get locale(){return this.editor.configStore.locale[f.FILTER]}get categories(){return this.entityManager.categories}get items(){return this.entityManager.items}}s([oe.observable],ae.prototype,"selectedCategory",2),s([oe.observable],ae.prototype,"entityManager",2),s([oe.action],ae.prototype,"selectFilter",2),s([oe.action],ae.prototype,"changeIntensity",2),s([oe.action],ae.prototype,"pureReset",2),s([oe.action],ae.prototype,"reset",2),s([oe.action],ae.prototype,"toggleCategorySelection",2),s([oe.action],ae.prototype,"updateStateFromSerialization",2),s([oe.action],ae.prototype,"updateStateFromHistory",2),s([oe.computed],ae.prototype,"state",1),s([oe.computed],ae.prototype,"identifier",1),s([oe.computed],ae.prototype,"intensity",1),s([oe.computed],ae.prototype,"isDuotone",1),s([oe.computed],ae.prototype,"selectedCategoryIdentifier",1),s([oe.computed],ae.prototype,"isOptionSelected",1),s([oe.computed],ae.prototype,"config",1),s([oe.computed],ae.prototype,"locale",1),s([oe.computed],ae.prototype,"categories",1),s([oe.computed],ae.prototype,"items",1);function es(e){const t=e&&typeof e=="object";return t&&Object.prototype.toString.call(e)!=="[object RegExp]"&&Object.prototype.toString.call(e)!=="[object Date]"}function Bf(e){return Array.isArray(e)?[]:{}}function is(e,t){const i=t&&t.clone===!0;return i&&es(e)?ts(Bf(e),e,t):e}function Lf(e,t,i){const r={};return es(e)&&Object.keys(e).forEach(o=>{r[o]=is(e[o],i)}),Object.keys(t).forEach(o=>{const n=es(t[o])&&e[o];r[o]=n?ts(e[o],t[o],i):is(t[o],i)}),r}function ts(e,t,i){const r=Array.isArray(t);return r?Array.isArray(e)?t:is(t,i):Lf(e,t,i)}function Zt(e,t=null){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce((i,r)=>ts(i,r,t))}class ql extends Nf{onExport(e){this.emit(Er.EXPORT,e)}onClose(){this.emit(Er.CLOSE)}onHistoryChange(){this.emit(Er.HISTORY_CHANGE)}onEditorReady(){this.emit(Er.EDITOR_READY)}onErrorImageLoading(e){this.emit(Er.ERROR_IMAGE_LOADING,e)}}const rs={common:{error:"Fehler",warning:"Warnung",color:{colorPicker:{hex:"Hex",r:"R",g:"G",b:"B",sliderHue:"Farbe",sliderOpacity:"Farbe Transparenz"}}},mainCanvasActions:{buttonExport:"Bild Exportieren",buttonUndo:"Rckgngig machen",buttonRedo:"Wiederholen",buttonClose:"Schlieen"},infoModals:{exporting:{heading:"Exportieren...",body:"Einen Moment bitte..."},saving:{heading:"Speichere...",body:"Einen Moment bitte..."},loading:{heading:"Lade...",body:"Einen Moment bitte..."},resizing:{heading:"Bild wird bearbeitet...",body:"Einen Moment bitte..."},loadingFonts:{heading:"Lade Schriftarten...",body:"Einen Moment bitte..."},stickerLoading:{heading:"Lade Sticker...",body:"Einen Moment bitte..."}},errorModals:{imageLoading:{headingDelimiter:":",body:"Laden des Bildes fehlgeschlagen. Dies kann verschiedene Grnde haben, beispielsweise kann die Datei defekt sein oder der Dateityp wird nicht untersttzt",buttonYes:"Neu Laden"},rendering:{headingDelimiter:":",body:"Beim Rendern des Bildes ist ein Fehler aufgetreten",buttonYes:"Neu Laden"},fontLoading:{headingDelimiter:":",heading:"Laden von Schriftarten ist fehlgeschlagen",body:"Die folgenden Schriftarten konnten nicht geladen werden: ${error}",buttonNo:"Schlieen"},webcamUnavailable:{headingDelimiter:":",body:"Webcam-Bild kann nicht dargestellt werden. (Fehler: ${error})",buttonYes:"Schlieen"},stickerLoading:{headingDelimiter:":",body:"Laden des Stickers fehlgeschlagen.",buttonNo:"Schlieen"},unexpectedError:{headingDelimiter:":",body:"Ein unerwarteter Fehler ist aufgetreten, ${error}",buttonYes:"Neu Laden"}},warningModals:{imageResized:{headingDelimiter:":",heading:"Bild verkleinert",body:"Ihr Bild bersteigt die maximale Grsse von ${megapixels} megapixels und wurde auf ${width}x${height} Pixel verkleinert",buttonYes:"Weiter"},discardChanges:{headingDelimiter:":",body:"Sind Sie sicher, dass Sie die nderungen verwerfen wollen?",buttonYes:"nderungen verwerfen",buttonNo:"nderungen beibehalten"},unsavedChanges:{headingDelimiter:":",body:"Sind Sie sicher, dass Sie die nderungen verwerfen wollen?",buttonYes:"Beenden ohne zu speichern",buttonNo:"Schlieen"},unsupportedSerializationVersion:{headingDelimiter:":",body:"Ihre Daten wurden von einem veralteten Format geladen und knnten anders aussehen",buttonYes:"nderungen anwenden",buttonNo:"Abbrechen"},unsupportedWebGLRenderer:{body:"Es wurde ein Problem im Browser festgestellt, welches zu langen Ladezeiten fhren kann. Bitte probieren sie einen anderen Browser.",buttonYes:"Weiter"}},library:{title:"Bibliothek",controls:{buttonUpload:"Bild Hochladen",buttonWebcamOpen:"Webcam ffnen",buttonWebcamClose:"Webcam Schlieen",placeholderSearch:"Bibliothek durchsuchen",noResults:"Keine Ergebnisse"}},filter:{title:"Filter",controls:{buttonReset:"Zurcksetzen",sliderIntensity:"Filter Intensitt"},categories:{[Re.DuoTone]:"DuoTone",[Re.BW]:"B & W",[Re.Vintage]:"Vintage",[Re.Smooth]:"Smooth",[Re.Cold]:"Cold",[Re.Warm]:"Warm",[Re.Legacy]:"Legacy"},items:{[g.Inferno]:"Inferno",[g.Chestnut]:"Chestnut",[g.Fixie]:"Fixie",[g.Fridge]:"Fridge",[g.Sunny70s]:"Sunny 70s",[g.FlatBlack]:"Flat Black",[g.Mellow]:"Mellow",[g.HardStuff]:"Hard Stuff",[g.Oldtimer]:"Oldtimer",[g.AD1920]:"1920 A.D.",[g.Ancient]:"Ancient",[g.Kalmen]:"Kalmen",[g.Joran]:"Joran",[g.Polaroid]:"Polaroid",[g.Zephyr]:"Zephyr",[g.Levante]:"Levante",[g.Greyed]:"Greyed",[g.Classic]:"Classic",[g.Colorful]:"Colorful",[g.Snappy]:"Snappy",[g.Candy]:"Candy",[g.Creamy]:"Creamy",[g.LowFire]:"Low Fire",[g.Colla]:"Colla",[g.Sunrise]:"Sunrise",[g.Moss]:"Moss",[g.Food]:"Food",[g.Glam]:"Glam",[g.Gobblin]:"Gobblin",[g.HighCarb]:"High Carb",[g.Hicon]:"Hicon",[g.K1]:"K1",[g.K6]:"K6",[g.Pebble]:"Pebble",[g.Keen]:"Keen",[g.Lemon]:"Lemon",[g.Litho]:"Litho",[g.Lomo]:"Lomo",[g.Lomo100]:"Lomo 100",[g.Lucid]:"Lucid",[g.Neat]:"Neat",[g.Pumpkin]:"Pumpkin",[g.Solanus]:"Solanus",[g.Pale]:"Pale",[g.Pitched]:"Pitched",[g.Weathered]:"Weathered",[g.GreenGap]:"Green Gap",[g.PolaSX]:"Pola SX",[g.Pro400]:"Pro 400",[g.Quozi]:"Quozi",[g.Sepia]:"Sepia",[g.Settled]:"Settled",[g.Seventies]:"Seventies",[g.Soft]:"Soft",[g.Steel]:"Steel",[g.Summer]:"Summer",[g.Golden]:"Golden",[g.Tender]:"Tender",[g.Twilight]:"Twilight",[g.Softy]:"Softy",[g.Dusty]:"Dusty",[g.Desert]:"Desert",[g.Peach]:"Peach",[g.Clash]:"Clash",[g.Plum]:"Plum",[g.Breezy]:"Breezy",[g.DeepBlue]:"Deep Blue",[g.Frog]:"Frog",[g.Sunset]:"Sunset"}},adjustment:{title:"Korrekturen",controls:{buttonReset:"Zurcksetzen"},categories:{basics:"Grundlagen",refinements:"Feinheiten"},items:{brightness:"Helligkeit",saturation:"Sttigung",contrast:"Kontrast",gamma:"Gamma",sharpness:"Schrfe",clarity:"Klarheit",exposure:"Belichtung",shadows:"Schatten",highlights:"Lichter",whites:"Wei",blacks:"Schwarz",temperature:"Temperatur"}},focus:{title:"Weichzeichnen",controls:{buttonReset:"Zurcksetzen",sliderIntensity:"Focus Intensitt"},items:{radial:"Kreisfrmig",mirrored:"Gespiegelt",linear:"Linear",gaussian:"Gausch"},history:{focusPosition:"Focus Position",focusSize:"Focus Gre"}},overlay:{title:"Overlays",controls:{buttonReset:"Zurcksetzen",sliderOpacity:"Overlay Transparenz",carouselBlendMode:"Overlay Mischmodus",blendModeNormal:"Normal",blendModeOverlay:"berblenden",blendModeHardLight:"Hartes Licht",blendModeSoftLight:"Weiches Licht",blendModeMultiply:"Multiplizieren",blendModeDarken:"Abdunkeln",blendModeLighten:"Aufhellen",blendModeScreen:"Screen",blendModeColorBurn:"Color Burn",tabOpacity:"Transparenz",tabBlendMode:"Mischmodus"},items:{imgly_overlay_bokeh:"Bokeh",imgly_overlay_chop:"Chop",imgly_overlay_clouds:"Clouds",imgly_overlay_golden:"Golden",imgly_overlay_grain:"Grain",imgly_overlay_hearts:"Hearts",imgly_overlay_lightleak1:"Light Leak 1",imgly_overlay_lightleak2:"Light Leak 2",imgly_overlay_metal:"Metal",imgly_overlay_mosaic:"Mosaic",imgly_overlay_painting:"Painting",imgly_overlay_paper:"Paper",imgly_overlay_rain:"Rain",imgly_overlay_vintage:"Vintage",imgly_overlay_wall1:"Wall",imgly_overlay_wall2:"Wall 2",imgly_overlay_wood:"Wood"}},sticker:{title:"Sticker",controls:{buttonUpload:"Sticker Hochladen",sliderOpacity:"Sticker Transparenz",selectColor:"Stickerfarbe",tabColor:"Farbe",tabOpacity:"Transparenz"},categories:{imgly_sticker_emoticons:"Emoticons",imgly_sticker_shapes:"Shapes",imgly_sticker_custom:"Custom"},items:{imgly_sticker_emoticons_alien:"Alien",imgly_sticker_emoticons_angel:"Angel",imgly_sticker_emoticons_angry:"Angry",imgly_sticker_emoticons_anxious:"Anxious",imgly_sticker_emoticons_asleep:"Asleep",imgly_sticker_emoticons_attention:"Attention",imgly_sticker_emoticons_baby_chicken:"Baby Chicken",imgly_sticker_emoticons_batman:"Batman",imgly_sticker_emoticons_beer:"Beer",imgly_sticker_emoticons_black:"Black",imgly_sticker_emoticons_blue:"Blue",imgly_sticker_emoticons_blush:"Blush",imgly_sticker_emoticons_boxer:"Boxer",imgly_sticker_emoticons_business:"Business",imgly_sticker_emoticons_chicken:"Chicken",imgly_sticker_emoticons_cool:"Cool",imgly_sticker_emoticons_cry:"Cry",imgly_sticker_emoticons_deceased:"Deceased",imgly_sticker_emoticons_devil:"Devil",imgly_sticker_emoticons_duckface:"Duckface",imgly_sticker_emoticons_furious:"Furious",imgly_sticker_emoticons_grin:"Grin",imgly_sticker_emoticons_guitar:"Guitar",imgly_sticker_emoticons_harry_potter:"Harry Potter",imgly_sticker_emoticons_hippie:"Hippie",imgly_sticker_emoticons_hitman:"Hitman",imgly_sticker_emoticons_humourous:"Humourous",imgly_sticker_emoticons_idea:"Idea",imgly_sticker_emoticons_impatient:"Impatient",imgly_sticker_emoticons_kiss:"Kiss",imgly_sticker_emoticons_kisses:"Kisses",imgly_sticker_emoticons_laugh:"Laugh",imgly_sticker_emoticons_loud_cry:"Loud Cry",imgly_sticker_emoticons_loving:"Loving",imgly_sticker_emoticons_masked:"Masked",imgly_sticker_emoticons_music:"Music",imgly_sticker_emoticons_nerd:"Nerd",imgly_sticker_emoticons_ninja:"Ninja",imgly_sticker_emoticons_not_speaking_to_you:"Not speaking to you",imgly_sticker_emoticons_pig:"Pig",imgly_sticker_emoticons_pumpkin:"Pumpkin",imgly_sticker_emoticons_question:"Question",imgly_sticker_emoticons_rabbit:"Rabbit",imgly_sticker_emoticons_sad:"Sad",imgly_sticker_emoticons_sick:"Sick",imgly_sticker_emoticons_skateboard:"Skateboard",imgly_sticker_emoticons_skull:"Skull",imgly_sticker_emoticons_sleepy:"Sleepy",imgly_sticker_emoticons_smile:"Smile",imgly_sticker_emoticons_smoking:"Smoking",imgly_sticker_emoticons_sobbing:"Sobbing",imgly_sticker_emoticons_star:"Star",imgly_sticker_emoticons_steaming_furious:"Steaming Furious",imgly_sticker_emoticons_sunbathing:"Sunbathing",imgly_sticker_emoticons_tired:"Tired",imgly_sticker_emoticons_tongue_out_wink:"Tongue out wink",imgly_sticker_emoticons_wave:"Wave",imgly_sticker_emoticons_wide_grin:"Wide Grin",imgly_sticker_emoticons_wink:"Wink",imgly_sticker_emoticons_wrestler:"Wrestler",imgly_sticker_shapes_arrow_02:"Arrow 1",imgly_sticker_shapes_arrow_03:"Arrow 2",imgly_sticker_shapes_badge_01:"Badge 1",imgly_sticker_shapes_badge_11:"Badge 5",imgly_sticker_shapes_badge_12:"Badge 6",imgly_sticker_shapes_badge_13:"Badge 7",imgly_sticker_shapes_badge_15:"Badge 8",imgly_sticker_shapes_badge_18:"Badge 9",imgly_sticker_shapes_badge_19:"Badge 10",imgly_sticker_shapes_badge_20:"Badge 11",imgly_sticker_shapes_badge_28:"Badge 12",imgly_sticker_shapes_badge_32:"Badge 13",imgly_sticker_shapes_badge_35:"Badge 14",imgly_sticker_shapes_badge_36:"Badge 15",imgly_sticker_shapes_badge_04:"Badge 2",imgly_sticker_shapes_badge_06:"Badge 3",imgly_sticker_shapes_badge_08:"Badge 4",imgly_sticker_shapes_spray_01:"Spray 1",imgly_sticker_shapes_spray_03:"Spray 2",imgly_sticker_shapes_spray_04:"Spray 3"},canvasActions:{buttonDelete:"Lschen",buttonBringToFront:"In den Vordergrund",buttonDuplicate:"Duplizieren",buttonFlipHorizontal:"Horizontal spiegeln",buttonFlipVertical:"Vertikal spiegeln"},history:{add:"Sticker",resize:"Sticker resize",position:"Sticker position",color:"Sticker color",delete:"Sticker delete",order:"Sticker order",opacity:"Sticker opacity",flip:"Sticker flip"}},text:{title:"Text",controls:{buttonNew:"Neuer Text",dropdownFontFamily:"Schriftart",textFontSize:"Schriftgre",selectAlignment:"Ausrichtung",selectFontColor:"Schriftfarbe",selectBackgroundColor:"Hintergrundfarbe",sliderLineSpacing:"Zeilenabstand",tabColor:"Farbe",tabBgColor:"Hintergrund",tabAlignment:"Ausrichtung",tabLineHeight:"Zeilenhhe",tabFontSize:"Schriftgre"},canvasControls:{placeholderText:"Etwas aufschreiben",buttonSave:"Fertig",buttonClose:"Abbrechen",inputText:"Texteingabe"},canvasActions:{buttonEdit:"Bearbeiten",buttonDelete:"Lschen",buttonBringToFront:"In den Vordergrund",buttonDuplicate:"Duplizieren"},history:{add:"Text",edit:"Text edit",resize:"Text resize",position:"Text position",alignment:"Text alignment",textColor:"Text color",backgroundColor:"Text background color",fontFamily:"Font family",fontStyle:"Font style",lineSpacing:"Line spacing",width:"Text width",delete:"Text delete",order:"Text order"}},textdesign:{title:"Text Design",controls:{buttonNew:"Neues Text Design",buttonShuffle:"Shuffle Layout",selectColor:"Textfarbe",tabColor:"Farbe",tabShuffle:"Shuffle"},canvasControls:{placeholderText:"Etwas aufschreiben mit Style",buttonSave:"Done",buttonClose:"Schlieen",inputText:"Texteingabe"},canvasActions:{buttonEdit:"Bearbeiten",buttonInvert:"Invertieren",buttonDelete:"Lschen",buttonBringToFront:"In den Vordergrund",buttonDuplicate:"Duplizieren"},history:{add:"Text design",edit:"Text design edit",resize:"Text design resize",position:"Text design position",color:"Text design color",shuffle:"Text design shuffle",invert:"Text design invert",padding:"Text design padding",order:"Text design order",delete:"Text design delete"}},frame:{title:"Rahmen",controls:{buttonReset:"Zurcksetzen",sliderOpacity:"Rahmen Transparenz",sliderSize:"Rahmen Dicke",selectColor:"Rahmen Farbe",tabColor:"Farbe",tabOpacity:"Transparenz",tabSize:"Dicke"},items:{imgly_frame_dia:"Dia",imgly_frame_art_decor:"Art Decor",imgly_frame_black_passepartout:"Black",imgly_frame_lowpoly_shadow:"Low Poly",imgly_frame_wood_passepartout:"Wood"}},brush:{title:"Malen",controls:{buttonReset:"Zurcksetzen",sliderSize:"Dicke",sliderHardness:"Hrte",selectColor:"Farbe",tabSize:"Dicke",tabHardness:"Hrte",tabColor:"Farbe"},history:{brushStroke:"Brush Stroke"}},transform:{title:"Zuschneiden",controls:{buttonReset:"Zurcksetzen",checkboxKeepResolution:"Fixiere Auflsung",inputCropSize:"Bildgre",inputHeight:"h",inputWidth:"b",tabFlipAndRotate:"Spiegeln & Drehen",tabResolution:"Auflsung",tabCropSize:"Bildgre"},categories:{imgly_transforms_common:"Standard",imgly_transforms_facebook:"Facebook",imgly_transforms_twitter:"Twitter",imgly_transforms_instagram:"Instagram"},items:{imgly_transform_common_custom:"Frei",imgly_transform_common_square:"Quadratisch",imgly_transform_common_4:"4:3",imgly_transform_common_16:"16:9",imgly_transform_common_3:"3:4",imgly_transform_common_9:"9:16",imgly_transform_facebook_profile:"Profile",imgly_transform_facebook_title:"Titel",imgly_transform_facebook_post:"Post",imgly_transform_instagram_story:"Story",imgly_transform_instagram_landscape:"Landscape",imgly_transform_instagram_portrait:"Portrait",imgly_transform_instagram_square:"Square",imgly_transform_twitter_profile:"Profile",imgly_transform_twitter_title:"Title",imgly_transform_twitter_post:"Post"},transformActions:{buttonFlipHorizontal:"Horizontal spiegeln",buttonFlipVertical:"Vertikal spiegeln",buttonRotateClockwise:"Drehe im Uhrzeigersinn",buttonRotateAntiClockwise:"Drehe gegen Uhrzeigersinn"}}};const Di={common:{error:"Error",warning:"Warning",color:{colorPicker:{hex:"Hex",r:"R",g:"G",b:"B",sliderHue:"Color",sliderOpacity:"Color Opacity"}}},mainCanvasActions:{buttonExport:"Export Image",buttonUndo:"Undo",buttonRedo:"Redo",buttonClose:"Close"},infoModals:{exporting:{heading:"Exporting...",body:"Just a few seconds..."},saving:{heading:"Saving...",body:"Just a few seconds..."},loading:{heading:"Loading...",body:"Just a few seconds..."},resizing:{heading:"Resizing...",body:"Just a few seconds..."},loadingFonts:{heading:"Loading Fonts...",body:"Just a few seconds..."},stickerLoading:{heading:"Loading Sticker...",body:"Just a few seconds..."}},errorModals:{imageLoading:{headingDelimiter:":",body:"Failed to load image. This can have multiple reasons, e.g. the file is corrupted or the file type is not supported",buttonYes:"Reload"},rendering:{headingDelimiter:":",body:"An error has occurred while rendering the image",buttonYes:"Reload"},fontLoading:{headingDelimiter:":",heading:"Failed to load font",body:"The following fonts could not be loaded: ${error}",buttonNo:"Close"},webcamUnavailable:{headingDelimiter:":",body:"Unable to display webcam image (Error: ${error})",buttonYes:"Close"},stickerLoading:{headingDelimiter:":",body:"Unable to load the sticker",buttonNo:"Close"},unexpectedError:{headingDelimiter:":",body:"An unexpected error has occured ${error}",buttonYes:"Reload"}},warningModals:{imageResized:{headingDelimiter:":",heading:"Image resized",body:"Your image exceeds the maximum size of ${megapixels} megapixels and has been resized to ${width}x${height} pixels",buttonYes:"Continue"},unsupportedSerializationVersion:{headingDelimiter:":",body:"Your data was restored from a legacy data format and might look different",buttonYes:"Apply changes",buttonNo:"Cancel"},discardChanges:{headingDelimiter:":",body:"You have unsaved changes. Are you sure you want to discard the changes?",buttonYes:"Discard changes",buttonNo:"Keep Changes"},unsavedChanges:{headingDelimiter:":",body:"You have unsaved changes. Are you sure you want to exit?",buttonYes:"Exit without saving",buttonNo:"Cancel"},unsupportedWebGLRenderer:{body:"A problem has been detected in the browser that could cause long loading times. Please try a different browser.",buttonYes:"Continue"}},library:{title:"Library",controls:{buttonUpload:"Upload Image",buttonWebcamOpen:"Open Webcam",buttonWebcamClose:"Close Webcam",placeholderSearch:"Search Library",noResults:"No Results"}},filter:{title:"Filters",controls:{buttonReset:"Remove Filter",sliderIntensity:"Filter Intensity"},categories:{[Re.DuoTone]:"DuoTone",[Re.BW]:"B & W",[Re.Vintage]:"Vintage",[Re.Smooth]:"Smooth",[Re.Cold]:"Cold",[Re.Warm]:"Warm",[Re.Legacy]:"Legacy"},items:{[g.Inferno]:"Inferno",[g.Chestnut]:"Chestnut",[g.Fixie]:"Fixie",[g.Fridge]:"Fridge",[g.Sunny70s]:"Sunny 70s",[g.FlatBlack]:"Flat Black",[g.Mellow]:"Mellow",[g.HardStuff]:"Hard Stuff",[g.Oldtimer]:"Oldtimer",[g.AD1920]:"1920 A.D.",[g.Ancient]:"Ancient",[g.Kalmen]:"Kalmen",[g.Joran]:"Joran",[g.Polaroid]:"Polaroid",[g.Zephyr]:"Zephyr",[g.Levante]:"Levante",[g.Greyed]:"Greyed",[g.Classic]:"Classic",[g.Colorful]:"Colorful",[g.Snappy]:"Snappy",[g.Candy]:"Candy",[g.Creamy]:"Creamy",[g.LowFire]:"Low Fire",[g.Colla]:"Colla",[g.Sunrise]:"Sunrise",[g.Moss]:"Moss",[g.Food]:"Food",[g.Glam]:"Glam",[g.Gobblin]:"Gobblin",[g.HighCarb]:"High Carb",[g.Hicon]:"Hicon",[g.K1]:"K1",[g.K6]:"K6",[g.Pebble]:"Pebble",[g.Keen]:"Keen",[g.Lemon]:"Lemon",[g.Litho]:"Litho",[g.Lomo]:"Lomo",[g.Lomo100]:"Lomo 100",[g.Lucid]:"Lucid",[g.Neat]:"Neat",[g.Pumpkin]:"Pumpkin",[g.Solanus]:"Solanus",[g.Pale]:"Pale",[g.Pitched]:"Pitched",[g.Weathered]:"Weathered",[g.GreenGap]:"Green Gap",[g.PolaSX]:"Pola SX",[g.Pro400]:"Pro 400",[g.Quozi]:"Quozi",[g.Sepia]:"Sepia",[g.Settled]:"Settled",[g.Seventies]:"Seventies",[g.Soft]:"Soft",[g.Steel]:"Steel",[g.Summer]:"Summer",[g.Golden]:"Golden",[g.Tender]:"Tender",[g.Twilight]:"Twilight",[g.Softy]:"Softy",[g.Dusty]:"Dusty",[g.Desert]:"Desert",[g.Peach]:"Peach",[g.Clash]:"Clash",[g.Plum]:"Plum",[g.Breezy]:"Breezy",[g.DeepBlue]:"Deep Blue",[g.Frog]:"Frog",[g.Sunset]:"Sunset"}},adjustment:{title:"Adjust",controls:{buttonReset:"Reset Adjustment"},categories:{basics:"Basic",refinements:"Refinements"},items:{brightness:"Brightness",saturation:"Saturation",contrast:"Contrast",gamma:"Gamma",sharpness:"Sharpness",clarity:"Clarity",exposure:"Exposure",shadows:"Shadows",highlights:"Highlights",whites:"Whites",blacks:"Blacks",temperature:"Temperature"}},focus:{title:"Focus",controls:{buttonReset:"Remove Focus",sliderIntensity:"Focus Intensity"},items:{radial:"Radial",mirrored:"Mirrored",linear:"Linear",gaussian:"Gaussian"},history:{focusPosition:"Focus Position",focusSize:"Focus Size"}},overlay:{title:"Overlays",controls:{buttonReset:"Remove Overlay",sliderOpacity:"Overlay Opacity",carouselBlendMode:"Overlay Blend mode",blendModeNormal:"Normal",blendModeOverlay:"Overlay",blendModeHardLight:"Hard Light",blendModeSoftLight:"Soft Light",blendModeMultiply:"Multiply",blendModeDarken:"Darken",blendModeLighten:"Lighten",blendModeScreen:"Screen",blendModeColorBurn:"Color Burn",tabOpacity:"Opacity",tabBlendMode:"Blend Mode"},items:{imgly_overlay_bokeh:"Bokeh",imgly_overlay_chop:"Chop",imgly_overlay_clouds:"Clouds",imgly_overlay_golden:"Golden",imgly_overlay_grain:"Grain",imgly_overlay_hearts:"Hearts",imgly_overlay_lightleak1:"Light Leak 1",imgly_overlay_lightleak2:"Light Leak 2",imgly_overlay_metal:"Metal",imgly_overlay_mosaic:"Mosaic",imgly_overlay_painting:"Painting",imgly_overlay_paper:"Paper",imgly_overlay_rain:"Rain",imgly_overlay_vintage:"Vintage",imgly_overlay_wall1:"Wall",imgly_overlay_wall2:"Wall 2",imgly_overlay_wood:"Wood"}},sticker:{title:"Stickers",controls:{buttonUpload:"Upload Sticker",sliderOpacity:"Sticker Opacity",selectColor:"Sticker Color",tabColor:"Color",tabOpacity:"Opacity"},categories:{imgly_sticker_emoticons:"Emoticons",imgly_sticker_shapes:"Shapes",imgly_sticker_custom:"Custom"},items:{imgly_sticker_emoticons_alien:"Alien",imgly_sticker_emoticons_angel:"Angel",imgly_sticker_emoticons_angry:"Angry",imgly_sticker_emoticons_anxious:"Anxious",imgly_sticker_emoticons_asleep:"Asleep",imgly_sticker_emoticons_attention:"Attention",imgly_sticker_emoticons_baby_chicken:"Baby Chicken",imgly_sticker_emoticons_batman:"Batman",imgly_sticker_emoticons_beer:"Beer",imgly_sticker_emoticons_black:"Black",imgly_sticker_emoticons_blue:"Blue",imgly_sticker_emoticons_blush:"Blush",imgly_sticker_emoticons_boxer:"Boxer",imgly_sticker_emoticons_business:"Business",imgly_sticker_emoticons_chicken:"Chicken",imgly_sticker_emoticons_cool:"Cool",imgly_sticker_emoticons_cry:"Cry",imgly_sticker_emoticons_deceased:"Deceased",imgly_sticker_emoticons_devil:"Devil",imgly_sticker_emoticons_duckface:"Duckface",imgly_sticker_emoticons_furious:"Furious",imgly_sticker_emoticons_grin:"Grin",imgly_sticker_emoticons_guitar:"Guitar",imgly_sticker_emoticons_harry_potter:"Harry Potter",imgly_sticker_emoticons_hippie:"Hippie",imgly_sticker_emoticons_hitman:"Hitman",imgly_sticker_emoticons_humourous:"Humourous",imgly_sticker_emoticons_idea:"Idea",imgly_sticker_emoticons_impatient:"Impatient",imgly_sticker_emoticons_kiss:"Kiss",imgly_sticker_emoticons_kisses:"Kisses",imgly_sticker_emoticons_laugh:"Laugh",imgly_sticker_emoticons_loud_cry:"Loud Cry",imgly_sticker_emoticons_loving:"Loving",imgly_sticker_emoticons_masked:"Masked",imgly_sticker_emoticons_music:"Music",imgly_sticker_emoticons_nerd:"Nerd",imgly_sticker_emoticons_ninja:"Ninja",imgly_sticker_emoticons_not_speaking_to_you:"Not speaking to you",imgly_sticker_emoticons_pig:"Pig",imgly_sticker_emoticons_pumpkin:"Pumpkin",imgly_sticker_emoticons_question:"Question",imgly_sticker_emoticons_rabbit:"Rabbit",imgly_sticker_emoticons_sad:"Sad",imgly_sticker_emoticons_sick:"Sick",imgly_sticker_emoticons_skateboard:"Skateboard",imgly_sticker_emoticons_skull:"Skull",imgly_sticker_emoticons_sleepy:"Sleepy",imgly_sticker_emoticons_smile:"Smile",imgly_sticker_emoticons_smoking:"Smoking",imgly_sticker_emoticons_sobbing:"Sobbing",imgly_sticker_emoticons_star:"Star",imgly_sticker_emoticons_steaming_furious:"Steaming Furious",imgly_sticker_emoticons_sunbathing:"Sunbathing",imgly_sticker_emoticons_tired:"Tired",imgly_sticker_emoticons_tongue_out_wink:"Tongue out wink",imgly_sticker_emoticons_wave:"Wave",imgly_sticker_emoticons_wide_grin:"Wide Grin",imgly_sticker_emoticons_wink:"Wink",imgly_sticker_emoticons_wrestler:"Wrestler",imgly_sticker_shapes_arrow_02:"Arrow 1",imgly_sticker_shapes_arrow_03:"Arrow 2",imgly_sticker_shapes_badge_01:"Badge 1",imgly_sticker_shapes_badge_11:"Badge 5",imgly_sticker_shapes_badge_12:"Badge 6",imgly_sticker_shapes_badge_13:"Badge 7",imgly_sticker_shapes_badge_15:"Badge 8",imgly_sticker_shapes_badge_18:"Badge 9",imgly_sticker_shapes_badge_19:"Badge 10",imgly_sticker_shapes_badge_20:"Badge 11",imgly_sticker_shapes_badge_28:"Badge 12",imgly_sticker_shapes_badge_32:"Badge 13",imgly_sticker_shapes_badge_35:"Badge 14",imgly_sticker_shapes_badge_36:"Badge 15",imgly_sticker_shapes_badge_04:"Badge 2",imgly_sticker_shapes_badge_06:"Badge 3",imgly_sticker_shapes_badge_08:"Badge 4",imgly_sticker_shapes_spray_01:"Spray 1",imgly_sticker_shapes_spray_03:"Spray 2",imgly_sticker_shapes_spray_04:"Spray 3"},canvasActions:{buttonDelete:"Delete",buttonBringToFront:"Move to front",buttonDuplicate:"Duplicate",buttonFlipHorizontal:"Flip",buttonFlipVertical:"Flip"},history:{add:"Sticker",resize:"Sticker resize",position:"Sticker position",color:"Sticker color",delete:"Sticker delete",order:"Sticker order",opacity:"Sticker opacity",flip:"Sticker flip"}},text:{title:"Text",controls:{buttonNew:"New Text",dropdownFontFamily:"Font Family",textFontSize:"Font Size",selectAlignment:"Alignment",selectFontColor:"Font Color",selectBackgroundColor:"Background Color",sliderLineSpacing:"Line Spacing",tabColor:"Color",tabBgColor:"Bg Color",tabAlignment:"Alignment",tabLineHeight:"Line Height",tabFontSize:"Font Size"},canvasControls:{placeholderText:"Write Something",buttonSave:"Done",buttonClose:"Cancel",inputText:"Text Input"},canvasActions:{buttonEdit:"Edit",buttonDelete:"Delete",buttonBringToFront:"Move to front",buttonDuplicate:"Duplicate"},history:{add:"Text",edit:"Text edit",resize:"Text resize",position:"Text position",alignment:"Text alignment",textColor:"Text color",backgroundColor:"Text background color",fontFamily:"Font family",fontStyle:"Font style",lineSpacing:"Line spacing",width:"Text width",delete:"Text delete",order:"Text order"}},textdesign:{title:"Text Design",controls:{buttonNew:"New Text Design",buttonShuffle:"Shuffle Layout",selectColor:"Text Color",tabColor:"Color",tabShuffle:"Shuffle"},canvasControls:{placeholderText:"Write Something With Style",buttonSave:"Done",buttonClose:"Schlieen",inputText:"Text Input"},canvasActions:{buttonEdit:"Edit",buttonInvert:"Invert",buttonDelete:"Delete",buttonBringToFront:"Move to front",buttonDuplicate:"Duplicate"},history:{add:"Text design",edit:"Text design edit",resize:"Text design resize",position:"Text design position",color:"Text design color",shuffle:"Text design shuffle",invert:"Text design invert",padding:"Text design padding",order:"Text design order",delete:"Text design delete"}},frame:{title:"Frames",controls:{buttonReset:"Remove Frame",sliderOpacity:"Frame Opacity",sliderSize:"Frame Size",selectColor:"Frame Color",tabColor:"Color",tabOpacity:"Opacity",tabSize:"Size"},items:{imgly_frame_dia:"Dia",imgly_frame_art_decor:"Art Decor",imgly_frame_black_passepartout:"Black",imgly_frame_lowpoly_shadow:"Low Poly",imgly_frame_wood_passepartout:"Wood"}},brush:{title:"Brush",controls:{buttonReset:"Remove Brush",sliderSize:"Brush Size",sliderHardness:"Brush Hardness",selectColor:"Brush Color",tabSize:"Size",tabHardness:"Hardness",tabColor:"Color"},history:{brushStroke:"Brush Stroke"}},transform:{title:"Transform",controls:{buttonReset:"Reset to default",checkboxKeepResolution:"Keep Resolution",inputCropSize:"Crop Size",inputHeight:"h",inputWidth:"w",tabFlipAndRotate:"Flip & Rotate",tabResolution:"Resolution",tabCropSize:"Crop Size"},categories:{imgly_transforms_common:"Common",imgly_transforms_facebook:"Facebook",imgly_transforms_twitter:"Twitter",imgly_transforms_instagram:"Instagram"},items:{imgly_transform_common_custom:"Custom",imgly_transform_common_square:"Square",imgly_transform_common_4:"4:3",imgly_transform_common_16:"16:9",imgly_transform_common_3:"3:4",imgly_transform_common_9:"9:16",imgly_transform_facebook_profile:"Profile",imgly_transform_facebook_title:"Title",imgly_transform_facebook_post:"Post",imgly_transform_instagram_story:"Story",imgly_transform_instagram_landscape:"Landscape",imgly_transform_instagram_portrait:"Portrait",imgly_transform_instagram_square:"Square",imgly_transform_twitter_profile:"Profile",imgly_transform_twitter_title:"Title",imgly_transform_twitter_post:"Post"},transformActions:{buttonFlipHorizontal:"Flip Horizontal",buttonFlipVertical:"Flip Vertical",buttonRotateClockwise:"Rotate Clockwise",buttonRotateAntiClockwise:"Rotate Counterclockwise"}}};const Xl=e=>e==="de"?rs:Di,Kl=(e,t)=>t&&t[e]?Zt([Xl(e),t[e]]):Xl(e)||Di;class vo{static addScrollStyles(e="rgba(255, 255, 255, 0.2)"){const t=vo.styles(e),i=`
    /* Injected by PhotoEditorSDK */
    ${t}
  `,r=document.createElement("style");r.innerHTML=i,document.head.appendChild(r)}}vo.styles=e=>`
    [data-photoeditorsdk-simplebar] {
      position: relative;
      flex-direction: column;
      flex-wrap: wrap;
      justify-content: flex-start;
      align-content: flex-start;
      align-items: flex-start;
    }

    .photoeditorsdk-simplebar-wrapper {
      overflow: hidden;
      width: inherit;
      height: inherit;
      max-width: inherit;
      max-height: inherit;
    }

    .photoeditorsdk-simplebar-mask {
      direction: inherit;
      position: absolute;
      padding: 0;
      margin: 0;
      left: 0;
      top: 0;
      bottom: 0;
      right: 0;
      width: auto !important;
      height: auto !important;
      z-index: 0;
    }

    .photoeditorsdk-simplebar-offset {
      direction: inherit !important;
      box-sizing: inherit !important;
      resize: none !important;
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      right: 0;
      padding: 0;
      margin: 0;
      -webkit-overflow-scrolling: touch;
    }

    .photoeditorsdk-simplebar-content-wrapper {
      direction: inherit;
      box-sizing: border-box !important;
      position: relative;
      display: block;
      height: 100%; /* Required for horizontal native scrollbar to not appear if parent is taller than natural height */
      width: auto;
      visibility: visible;
      overflow: auto; /* Scroll on this element otherwise element can't have a padding applied properly */
      max-width: 100%; /* Not required for horizontal scroll to trigger */
      max-height: 100%; /* Needed for vertical scroll to trigger */
    }

    .photoeditorsdk-simplebar-content:before,
    .photoeditorsdk-simplebar-content:after {
      content: ' ';
      display: table;
    }

    .photoeditorsdk-simplebar-placeholder {
      max-height: 100%;
      max-width: 100%;
      width: 100%;
      pointer-events: none;
    }

    .photoeditorsdk-simplebar-height-auto-observer-wrapper {
      box-sizing: inherit !important;
      height: 100%;
      width: 100%;
      max-width: 1px;
      position: relative;
      float: left;
      max-height: 1px;
      overflow: hidden;
      z-index: -1;
      padding: 0;
      margin: 0;
      pointer-events: none;
      flex-grow: inherit;
      flex-shrink: 0;
      flex-basis: 0;
    }

    .photoeditorsdk-simplebar-height-auto-observer {
      box-sizing: inherit;
      display: block;
      opacity: 0;
      position: absolute;
      top: 0;
      left: 0;
      height: 1000%;
      width: 1000%;
      min-height: 1px;
      min-width: 1px;
      overflow: hidden;
      pointer-events: none;
      z-index: -1;
    }

    .photoeditorsdk-simplebar-track {
      z-index: 1;
      position: absolute;
      right: 0;
      bottom: 0;
      pointer-events: none;
      overflow: hidden;
    }

    [data-photoeditorsdk-simplebar].photoeditorsdk-simplebar-dragging .photoeditorsdk-simplebar-track {
      pointer-events: all;
    }

    .photoeditorsdk-simplebar-scrollbar {
      position: absolute;
      right: 2px;
      width: 7px;
      min-height: 10px;
    }

    .photoeditorsdk-simplebar-scrollbar:before {
      position: absolute;
      content: '';
      background: ${e};
      border-radius: 7px;
      left: 0;
      right: 0;
      opacity: 0;
      transition: opacity 0.2s linear;
    }

    .photoeditorsdk-simplebar-track .photoeditorsdk-simplebar-scrollbar.photoeditorsdk-simplebar-visible:before {
      /* When hovered, remove all transitions from drag handle */
      opacity: 0.5;
      transition: opacity 0s linear;
    }

    .photoeditorsdk-simplebar-track.photoeditorsdk-simplebar-vertical {
      top: 0;
      width: 11px;
    }

    .photoeditorsdk-simplebar-track.photoeditorsdk-simplebar-vertical .photoeditorsdk-simplebar-scrollbar:before {
      top: 2px;
      bottom: 2px;
    }

    .photoeditorsdk-simplebar-track.photoeditorsdk-simplebar-vertical .photoeditorsdk-simplebar-scrollbar {
      right: 0px;
      width: 4px;
    }

    .photoeditorsdk-simplebar-track.photoeditorsdk-simplebar-horizontal {
      left: 0;
      height: 11px;
    }

    .photoeditorsdk-simplebar-track.photoeditorsdk-simplebar-horizontal .photoeditorsdk-simplebar-scrollbar:before {
      height: 100%;
      left: 2px;
      right: 2px;
    }

    .photoeditorsdk-simplebar-track.photoeditorsdk-simplebar-horizontal .photoeditorsdk-simplebar-scrollbar {
      right: auto;
      left: 0;
      min-height: 0;
      min-width: 10px;
      width: auto;
      top: 7px;
      height: 4px;
    }

    /* Rtl support */
    [data-photoeditorsdk-simplebar-direction='rtl'] .photoeditorsdk-simplebar-track.photoeditorsdk-simplebar-vertical {
      right: auto;
      left: 0;
    }

    .photoeditorsdk-hs-dummy-scrollbar-size {
      direction: rtl;
      position: fixed;
      opacity: 0;
      visibility: hidden;
      height: 500px;
      width: 500px;
      overflow-y: hidden;
      overflow-x: scroll;
    }
  `;const Hf={headline1:{size:16,letterSpacing:1.5,case:"uppercase"},headline2:{size:14,letterSpacing:.8,case:"uppercase"},body:{size:13,letterSpacing:0,case:"none"},label:{size:13,letterSpacing:0,case:"capitalize"},basicUICardLabel:{size:12,letterSpacing:0,case:"capitalize"},button1:{size:12,letterSpacing:1.2,case:"uppercase"},button2:{size:14,letterSpacing:0,case:"capitalize"},basicUITabLabel:{size:14,letterSpacing:.8,case:"uppercase"}},jf={toast:2,controlsBar:5,buttonGroup:5,toolControlBar:6,toolbar:7,label:10,disable:11,canvas:{knob:4,bar:5,controls:5,snappingGuide:1,crop:{grid:2,dragImage:3,backdrop:4},webcam:{backdrop:7}},input:{list:6},button:{float:5},dialog:{base:100,backdrop:1,container:2},colorItem:{overlay:2,background:1,tiledBackground:0}},So=()=>{const e=8,t=230,i=3*e,r=t-2*i,o=(r-2*e)/3,n=(r-e)/2;return{advancedUIToolbar:{width:55,itemHeight:48,seperatorHeight:20,marginBottom:0},advancedUIToolControlBar:{width:t,padding:`${2*e}px ${i}px`,marginBottom:0},advancedCard:{small:{height:o,width:o},medium:{height:n,width:n},large:{height:86,width:r}},advancedSpacer:8,basicCanvasOffset:35+76-88,basicUIToolbar:{openHeight:88,closeHeight:35},basicToolControlBar:{itemsBarHeight:72,controlsBarHeight:80,maxHeight:72+35+4,maxWidth:300},basicCard:{medium:{height:56,width:90},large:{height:60,width:110}},basicSpacer:8,mainCanvasActionBar:{height:50},crop:{minSize:50},canvas:{marginTop:0,transform:{minSliderWidth:435,minValueWidth:235,minFlipWidth:160}},canvasControls:{sprite:{controlOffset:16,rotateHandle:{height:16},minSize:30,controlPadding:16},knob:{size:16,touchable:{desktop:24}},corner:{size:14,touchable:{desktop:24,mobile:48},borderWidth:4},width:{size:14}},buttons:{float:{size:56}},colorItem:{size:20},color:{colorPicker:{width:214,height:370,saturationSlider:{height:150},thumb:{size:14},arrow:{width:36}}},fontSystem:Hf,zIndex:jf}};const Wf=({primary:e="#365afc",background:t="#0B0B0B",foreground:i="#FFFFFF"}={primary:"#365afc",background:"#0B0B0B",foreground:"#FFFFFF"})=>{const r="rgba(255, 255, 255, 0.90)",o="rgba(255, 255, 255, 0.60)",n="rgba(255, 255, 255, 0.38)",a="#424242",l="#333333",c="#242424",d="#171717",u="#0B0B0B",h="rgba(255, 255, 255, 0.08)",y="rgba(0, 0, 0, 0.3)",k="rgba(89, 121, 252, 0.20)",w="0.3";return{shape:{radiusSmall:2,radiusMedium:4,radiusLarge:4},typography:{fontFamily:"Fira Sans",provider:"google"},background:t,foreground:i,primary:e,warning:"#ffba5c",error:"#c2393a",success:"#39c26c",focusOutlineColor:"rgba(255, 255, 255, 0.12)",scrollbar:{handleColor:"rgba(255, 255, 255, 0.2)"},button:{outlinedBorderColor:l,activeForeground:e,containedPrimaryBackground:e,containedPrimaryForeground:r,outlinedPrimaryBackground:c,outlinedPrimaryForeground:r,outlinedSecondaryBackground:"transparent",outlinedSecondaryForeground:o,textPrimaryForeground:e,textSecondaryForeground:o,outlinedInactiveOverlayColor:y,textInactiveOpacity:"0.5",hoverOverlayColor:h},checkbox:{background:l,foreground:i,activeForeground:i,activeBackground:e,inactiveOpacity:w,hoverOpacity:"0.8"},modal:{background:c,bodyForeground:r,headerForeground:o,backdrop:"rgba(0, 0, 0, 0.6)"},card:{background:l,foreground:r,activeBorderColor:e,activeOverlayColor:k,labelBackground:"linear-gradient(transparent, rgba(0, 0, 0, 0.6))",labelForeground:r,inactiveOverlayColor:y,hoverOverlayColor:h},tabTitle:{foreground:o,background:"transparent",activeBackground:"transparent",activeBorderColor:e,activeForeground:r},dropdown:{background:"transparent",foreground:r,hoverBorderColor:o,borderColor:l,caretColor:n,listBackground:l,listBorderColor:l,listItemHoverBackground:a,listForeground:o,listShadow:`0 12px 17px 2px rgba(0,0,0,0.14),
        0 5px 22px 4px rgba(0,0,0,0.12),
        0 7px 8px -4px rgba(0,0,0,0.20)`,inactiveOpacity:w},textInput:{foreground:r,hoverBorderColor:"rgba(255, 255, 255, 0.40)",background:"transparent",borderColor:l,inactiveOpacity:w},slider:{trackColor:"rgba(255, 255, 255, 0.4)",activeTrackColor:e,thumbBackground:d,thumbBorderColor:e,inactiveOpacity:w,hoverOpacity:"0.7"},selectColor:{activeBorderColor:e,inactiveOpacity:w},toolbar:{foreground:r,background:c,activeBackground:"transparent",activeForeground:e,borderColor:"transparent"},tooltip:{background:a,foreground:r},toolControlBar:{background:"rgba(23, 23, 23, 0.9)",borderColor:"transparent",shadow:"none",separatorColor:l,titleForeground:o,inputLabelForeground:o,inputLabelInactiveOpacity:w},mainCanvasActionBar:{background:"linear-gradient(0deg, transparent 0%,  rgba(0, 0, 0, 0.6) 98%)",foreground:r,borderColor:"none"},canvasActionBar:{background:a,foreground:r,separatorColor:n},canvas:{background:u,controlsOutline:"rgba(255, 255, 255, 0.5)",controlsColor:"#ffffff",cropBackdrop:"rgba(0, 0, 0, 0.5)"},colorPicker:{listBackground:l,listShadow:`0 12px 17px 2px rgba(0,0,0,0.14),
        0 5px 22px 4px rgba(0,0,0,0.12),
        0 7px 8px -4px rgba(0,0,0,0.20)`,controlsColor:"#ffffff",inputBorderColor:a},colorItem:{borderRadius:"2px",margin:"1px"},webcam:{backdrop:"rgba(0, 0, 0, 0.3)",floatButton:i,background:u},snapping:{positionGuideColor:"#f0f",rotationGuideColor:"#0ff"},transform:{crops:{main:"#424242",highlight:"#565656",shadow:"#333333"}}}};var wo=Wf;const Uf=({primary:e="#1e47fb",background:t="#FBFBFB",foreground:i="#000000"}={primary:"#1e47fb",background:"#FBFBFB",foreground:"#000000"})=>{const r="rgba(0, 0, 0, 0.90)",o="rgba(0, 0, 0, 0.60)",n="rgba(0, 0, 0, 0.38)",a="#CCCCCC",l="#D4D4D4",c="#E6E6E6",d="#EEEEEE",u="#FBFBFB",h="rgba(125, 125, 125, 0.12)",y="rgba(30, 71, 251, 0.2)",k="rgba(0, 0, 0, 0.3)",w="0.3";return{shape:{radiusSmall:2,radiusMedium:4,radiusLarge:4},typography:{fontFamily:"Fira Sans",provider:"google"},background:t,foreground:i,primary:e,warning:"#ffb045",error:"#c01a1b",success:"#17c658",focusOutlineColor:"rgba(125, 125, 125, 0.12)",scrollbar:{handleColor:"rgba(0, 0, 0, 0.2)"},button:{outlinedBorderColor:l,activeForeground:e,containedPrimaryBackground:e,containedPrimaryForeground:"rgba(255, 255, 255, 0.9)",outlinedPrimaryBackground:c,outlinedPrimaryForeground:r,outlinedSecondaryBackground:"transparent",outlinedSecondaryForeground:o,textPrimaryForeground:e,textSecondaryForeground:o,outlinedInactiveOverlayColor:k,textInactiveOpacity:"0.5",hoverOverlayColor:h},checkbox:{background:l,foreground:i,activeForeground:i,activeBackground:e,inactiveOpacity:w,hoverOpacity:"0.8"},modal:{background:c,bodyForeground:r,headerForeground:o,backdrop:"rgba(0, 0, 0, 0.6)"},card:{background:l,foreground:r,activeBorderColor:e,activeOverlayColor:y,labelBackground:"linear-gradient(transparent, rgba(0, 0, 0, 0.6))",labelForeground:"rgba(255, 255, 255, 0.87)",inactiveOverlayColor:k,hoverOverlayColor:h},tabTitle:{foreground:o,background:"transparent",activeBackground:"transparent",activeBorderColor:e,activeForeground:r},dropdown:{background:"transparent",foreground:r,hoverBorderColor:o,borderColor:l,listBackground:l,caretColor:n,listForeground:o,listBorderColor:l,listItemHoverBackground:a,listShadow:`0 8px 10px 1px rgba(0,0,0,0.14),
        0 3px 14px 2px rgba(0,0,0,0.12),
        0 5px 5px -3px rgba(0,0,0,0.20)`,inactiveOpacity:w},textInput:{foreground:r,hoverBorderColor:r,background:"transparent",borderColor:l,inactiveOpacity:w},slider:{trackColor:a,activeTrackColor:e,thumbBackground:d,thumbBorderColor:e,inactiveOpacity:w,hoverOpacity:"0.7"},selectColor:{activeBorderColor:e,inactiveOpacity:w},toolbar:{foreground:r,background:l,activeBackground:"transparent",activeForeground:e,borderColor:"transparent"},tooltip:{background:a,foreground:r},toolControlBar:{background:"rgba(238, 238, 238, 0.9)",borderColor:d,shadow:"none",separatorColor:l,titleForeground:o,inputLabelForeground:o,inputLabelInactiveOpacity:w},mainCanvasActionBar:{background:"transparent",foreground:r,borderColor:"none"},canvasActionBar:{background:a,foreground:r,separatorColor:n},canvas:{background:u,controlsOutline:"rgba(255, 255, 255, 0.6)",controlsColor:"#ffffff",cropBackdrop:"rgba(255, 255, 255, 0.3)"},colorPicker:{listBackground:l,listShadow:`0 8px 10px 1px rgba(0,0,0,0.14),
        0 3px 14px 2px rgba(0,0,0,0.12),
        0 5px 5px -3px rgba(0,0,0,0.20)`,controlsColor:"#ffffff",inputBorderColor:a},colorItem:{borderRadius:"2px",margin:"1px"},webcam:{backdrop:"rgba(0, 0, 0, 0.3)",floatButton:i,background:u},snapping:{positionGuideColor:"#f0f",rotationGuideColor:"#0ff"},transform:{crops:{main:"#B8B8B8",highlight:"#E6E6E6",shadow:"#D4D4D4"}}}};var os=Uf;const kr=wo(),ns=So(),BS=p(p({},kr),{measurements:ns});const $f=e=>e==="light"?os:wo,Yl=(e,t)=>{const i=$f(e);if(t&&t[e]){const{primary:r,background:o,foreground:n}=t[e],a={primary:r,background:o,foreground:n},l=Object.keys(a).reduce((c,d)=>a[d]?p(p({},c),{[d]:a[d]}):c,{});return Zt([i(l),t[e]])}return i()||kr};const Vf=["canvas","advancedUIToolbar","advancedUIToolControlBar","basicUIToolbar","mainCanvasActionBar","colorItem","fontSystem"],Jl=e=>{const t=So();if(e){const i={};return Object.keys(e).forEach(r=>{Vf.indexOf(r)!==-1&&(i[r]=e[r])}),Zt([t,i])}return t};const Te=m(b()),Xf={config:Zn,locale:Di,theme:kr,measurements:ns};class Ke{constructor(){this.checkDefaultToolAvailability=(e,t)=>t.indexOf(e)!==-1;this.state=Te.observable(Xf),this.events=new ql,this.licenseChecker=null}saveConfig(e){e.mainCanvasActions&&e.mainCanvasActions.length!==4&&(e.mainCanvasActions.length=4);const t=Zt([Zn,e]),i=t;this.licenseChecker=new $l(i.license),this.licenseChecker.areCustomAssetsAllowed()||(i.sticker.enableCustomUpload=!1);const r=Kl(i.language,i.custom.languages),o=Yl(i.theme,i.custom.themes),n=Jl(i.custom.measurements),{provider:a}=i.library,l=[];i.adjustment.categories=i.adjustment.categories.reduce((h,y)=>(h.push(p(p({},y),{items:y.items.filter(k=>Gf[k.identifier]?!0:(l.push(k.identifier),!1))})),h),[]),l.length!==0&&console.error(`The following identifier are incorrect for the adjustment tool: ${l.join(", ")}`),delete i.language,delete i.custom.languages,delete i.custom.themes,delete i.library.provider;let c=i.tools.reduce((h,y)=>typeof y=="object"?[...h,...y]:[...h,y],[]);c.length||(console.error("Empty list input for tools"),c=mo.reduce((h,y)=>typeof y=="object"?[...h,...y]:[...h,y],[])),c=c.filter(h=>this.licenseChecker.isToolAllowed(h));const d=this.checkDefaultToolAvailability(i.defaultTool,c);d||(this.licenseChecker.isToolAllowed(i.defaultTool)&&console.warn(`Configured default tool ${i.defaultTool} is not a part of configured list of tools: [${c.join(" ")}]`),[i.defaultTool]=c),i.tools=c,this.state.config=i,this.state.locale=r,this.state.theme=o,this.state.measurements=n,vo.addScrollStyles(this.state.theme.scrollbar.handleColor);const u=this.buildCustomAssetsConfig();return this.assetProvider=new qf(u,this.licenseChecker.areCustomAssetsAllowed()),this.loadThemeFont(),a}get config(){return this.state.config}get locale(){return this.state.locale}get theme(){return this.state.theme}get measurements(){return this.state.measurements}get tools(){return this.config.tools.reduce((e,t)=>typeof t=="string"?[...e,t]:[...e,"",...t],[])}get defaultTool(){return this.config.defaultTool}get isOrderDefault(){return this.config.order==="default"}get isLayoutAdvanced(){return this.config.layout==="advanced"}get displayCloseButton(){return this.config.mainCanvasActions.indexOf(fe.CLOSE)!==-1}loadThemeFont(){const{typography:e}=this.theme;e.skipLoading||this.assetProvider.getFontManager().injectFonts([e])}buildCustomAssetsConfig(){const e=this.tools,t=Te.toJS(this.state.config),i=this.state.config.assetBaseUrl,{theme:r}=this.state,o=e.indexOf(f.FILTER)!==-1?t[f.FILTER]:void 0,n=e.indexOf(f.FOCUS)!==-1?t[f.FOCUS]:void 0,a=e.indexOf(f.ADJUSTMENT)!==-1?t[f.ADJUSTMENT]:void 0,l=e.indexOf(f.STICKER)!==-1?t[f.STICKER]:void 0,c=e.indexOf(f.FRAME)!==-1?t[f.FRAME]:void 0,d=e.indexOf(f.OVERLAY)!==-1?t[f.OVERLAY]:void 0,u=e.indexOf(f.TRANSFORM)!==-1?t[f.TRANSFORM]:void 0,h=e.indexOf(f.TEXT)!==-1?t[f.TEXT]:void 0,y=e.indexOf(f.TEXT_DESIGN)!==-1?t[f.TEXT_DESIGN]:void 0;return{basePath:i,theme:r,filter:o,focus:n,sticker:l,frame:c,overlay:d,transform:u,text:h,adjustment:a,textdesign:y}}}s([Te.action],Ke.prototype,"saveConfig",1),s([Te.computed],Ke.prototype,"config",1),s([Te.computed],Ke.prototype,"locale",1),s([Te.computed],Ke.prototype,"theme",1),s([Te.computed],Ke.prototype,"measurements",1),s([Te.computed],Ke.prototype,"tools",1),s([Te.computed],Ke.prototype,"defaultTool",1),s([Te.computed],Ke.prototype,"isOrderDefault",1),s([Te.computed],Ke.prototype,"isLayoutAdvanced",1),s([Te.computed],Ke.prototype,"displayCloseButton",1);class Zl{constructor(e){this.editor=e}setBackgroundImage(e){this.container?this.container.setData({image:e,originalImage:e}):this.container=this.engine.addImage({image:e,originalImage:e,blendMode:zt.NORMAL,opacity:1})}getchildren(){return this.container.getChildren()}addImageToContainer(){return new Promise((e,t)=>{const{image:i}=this.editor.activeStore;if(Il(i))this.setBackgroundImage(i),e();else{const r=this.editor.libraryStore.getRawUrl(i);this.getImageElement(r).then(o=>{this.setBackgroundImage(o),e()}).catch(o=>{t({identifier:"imageLoading",message:o.message})})}})}getImageElement(e){return new Promise((t,i)=>{const r=new Image;r.addEventListener("load",()=>{t(r)}),r.addEventListener("error",o=>{i(o)}),r.crossOrigin=this.editor.configStore.config.engine.crossOrigin,r.src=e})}getImgageContainerId(){return this.container?this.container.getID():""}get engine(){return this.editor.engine}}class Ql{constructor(e){this.applyNewImageTransform=()=>{const{size:e,width:t,height:i}=this.editor.engineMediator.image.container.getBounds(),r=this.container;r.setTransform(Qt.IDENTITY),r.setResolution(e),r.setPivot(.5,.5),r.setPosition({x:t/2,y:i/2})};this.editor=e}get engine(){return this.editor.engine}get container(){return this.engine.getOutputContainer()}}class as{static isImageElement(e){return e instanceof HTMLImageElement}constructor({license:e,assetProvider:t,crossOrigin:i}){this.crossOrigin=i,this.engine=new ss({license:e,crossOrigin:i,assetProvider:t,downscaleOptions:{maxDimensions:{width:100,height:100}}})}getAllFilterPreviewThumbnails(e){return new Promise((t,i)=>{const r={};e.reduce((o,n)=>I(this,null,function*(){const a=yield o;return a.identifier&&(r[a.identifier]=a.imageData),this.getFilterPreviewThumbnail(n)}),Promise.resolve({identifier:"",imageData:""})).then(o=>{r[o.identifier]=o.imageData,t(r)}).catch(o=>{i(o)})})}getFilterPreviewThumbnail({identifier:e,isDuotone:t}){return e!==""?(this.effect&&(this.engine.removeEffect(this.effect),this.effect.getIndexInParent()||(this.effect=void 0)),t?new Promise((i,r)=>{this.engine.addDuoToneFilterFromAssets(e,this.container).then(o=>{o.setProperties({colorIntensity:.5}),this.effect=o,this.engine.export(Ni.DATA_URL,Mt.PNG,.2).then(n=>{i({identifier:e,imageData:n})}).catch(n=>{r(n)})}).catch(o=>{r(o)})}):new Promise((i,r)=>{this.engine.addLUTFilterFromAssets(e,this.container).then(o=>{o.setProperties({intensity:1}),this.effect=o,this.engine.export(Ni.DATA_URL,Mt.PNG,.2).then(n=>{i({identifier:e,imageData:n})}).catch(n=>{r(n)})}).catch(o=>{r(o)})})):new Promise(i=>i({identifier:"",imageData:""}))}addImageToContainer(e){return new Promise((t,i)=>{let r;as.isImageElement(e)?(r=e,this.setBackgroundImage(r),t()):this.getImageElement(e).then(o=>{r=o,this.setBackgroundImage(r),t()}).catch(o=>{i({identifier:"imageLoading",message:o.message})})})}getImageElement(e){return new Promise((t,i)=>{const r=new Image;r.addEventListener("load",()=>{t(r)}),r.addEventListener("error",o=>{i(o)}),r.crossOrigin=this.crossOrigin,r.src=e})}setBackgroundImage(e){this.container?this.container.setData({image:e}):this.container=this.engine.addImage({image:e,blendMode:zt.NORMAL,opacity:1});const{size:t}=this.container.getBounds(),i=this.engine.getOutputContainer();i.setResolution(t)}}const Kf=(e,t)=>new Promise((i,r)=>{const o=new XMLHttpRequest;o.onload=()=>{const n=new FileReader;n.onloadend=()=>{typeof n.result=="string"&&n.result.substr(0,10)==="data:image"?i(n.result):r(new Error(`The image could not be loaded from ${e}`))},n.onerror=a=>{r(a)},n.readAsDataURL(o.response)},o.open("GET",e),o.responseType="blob",o.withCredentials=t==="use-credentials",o.send()}),ec=(e,t)=>new Promise((i,r)=>{const o=new Image;o.onload=()=>{i(o)},o.onerror=()=>{r(new Error(`Failed to load image with src:${e}`))},o.crossOrigin=t,o.src=e}),Yf=(e,t)=>new Promise((i,r)=>{Kf(e,t).then(o=>{const n=new Image;n.addEventListener("load",()=>{i(n)}),n.src=o}).catch(()=>{ec(e,t).then(o=>i(o)).catch(o=>{r(o)})})}),ls=r=>I(void 0,[r],function*({url:e,image:t,crossOrigin:i="anonymous"}){try{return t&&t.src&&t.src.substr(0,5)==="data:"||t&&t.src&&t.src.includes(".svg")?t:typeof e=="string"&&e.substr(0,5)==="data:"||typeof e=="string"&&e.includes(".svg")?ec(e,i):Yf(e||t.src,i)}catch(o){throw new Error(o)}});const Ye=m(b()),Jf={tool:null,isWebcam:!1,image:""};class xt{constructor(e){this.setImage=e=>I(this,null,function*(){const{crossOrigin:t}=this.editor.configStore.config.engine;typeof e=="string"&&(this.state.image=yield ls({url:bo(e)?e:this.editor.assetProvider.getPath(e),crossOrigin:t})),e instanceof HTMLImageElement&&(this.state.image=yield ls({image:e,crossOrigin:t})),this.isWebcam&&(this.state.isWebcam=!1)});this.newImage=e=>{this.editor.init(e)};this.editor=e,this.state=Ye.observable(Jf)}selectTool(e,t=!1){const{licenseChecker:i}=this.editor.configStore;if(e=this.state.tool===e&&t?null:e,i&&i.isToolAllowed(e)){this.editor.onToolChange(this.state.tool,e),this.state.tool=e;switch(e){case f.TEXT:this.editor.spriteStore.textToolStore.addOrselect();break;case f.TEXT_DESIGN:this.editor.spriteStore.textDesignToolStore.addOrselect();break;case f.BRUSH:{this.editor.brushToolStore.initSize();break}case f.TRANSFORM:this.editor.transformToolStore.applyDefaultCrop();break}}}selectWebcam(e){this.state.isWebcam=e}get webcamLabel(){return this.editor.libraryStore.locale.controls.buttonWebcamClose}get tool(){return this.state.tool}get isWebcam(){return this.state.isWebcam}get image(){return this.state.image}}s([Ye.action],xt.prototype,"selectTool",1),s([Ye.action],xt.prototype,"selectWebcam",1),s([Ye.action],xt.prototype,"setImage",2),s([Ye.action],xt.prototype,"newImage",2),s([Ye.computed],xt.prototype,"webcamLabel",1),s([Ye.computed],xt.prototype,"tool",1),s([Ye.computed],xt.prototype,"isWebcam",1),s([Ye.computed],xt.prototype,"image",1);const Le=m(b()),cs={height:150,width:150};class je{constructor(e){this.canvasClickDisabled=Le.observable.box(!1);this.editor=e,this.state=Le.observable(je.initialState)}setCanvasElement(e){this.canvas=e,this.editor.engineMediator.preview.createPreview(e),this.updateCanvasDimensions(),this.editor.init(this.editor.configStore.config.image)}updateCanvasDimensions(){const e=le.devicePixelRatio;this.canvas.width=this.canvasSize.width*e,this.canvas.height=this.canvasSize.height*e,this.canvas.style.width=`${this.canvasSize.width}px`,this.canvas.style.height=`${this.canvasSize.height}px`}saveDimensions({height:e,width:t,render:i}){const r=this.editor.configStore.isLayoutAdvanced?0:this.editor.configStore.measurements.basicCanvasOffset;e-r>cs.height&&t>cs.width&&(this.state.canvasSize.height=e-r,this.state.canvasSize.width=t,i&&this.editor.resize())}disableCanvasClick(){this.canvasClickDisabled.set(!0)}enableCanvasClick(){this.canvasClickDisabled.set(!1)}get isCanvasClickable(){return!this.canvasClickDisabled.get()}get canvasSize(){return this.state.canvasSize}get sizeVector(){return D.fromSize(this.state.canvasSize)}get sizeVectorMagnitude(){return this.sizeVector.magnitude}getContainersAtPreviewPoint(e){const t=this.editor.engine.getContainersAtPreviewPoint(e,this.editor.engineMediator.preview.previewTransformWithoutDpr).map(i=>i.getID()).filter(i=>i!==this.editor.engineMediator.image.getImgageContainerId());this.editor.spriteStore.onCanvasClick(t)}}je.initialState={canvasSize:cs},s([Le.action],je.prototype,"setCanvasElement",1),s([Le.action],je.prototype,"updateCanvasDimensions",1),s([Le.action],je.prototype,"saveDimensions",1),s([Le.action],je.prototype,"disableCanvasClick",1),s([Le.action],je.prototype,"enableCanvasClick",1),s([Le.computed],je.prototype,"isCanvasClickable",1),s([Le.computed],je.prototype,"canvasSize",1),s([Le.computed],je.prototype,"sizeVector",1),s([Le.computed],je.prototype,"sizeVectorMagnitude",1);const We=m(b()),Zf={type:null,identifier:null,isVisible:!1,error:""};class ht{constructor(e){this.showActionModal=({type:e,identifier:t,error:i,handleConfirm:r,handleDismiss:o})=>{this.resetHandlers(),this.state.isVisible=!0,this.state.identifier=t,this.state.type=e,this.state.error=i||"",this.handleConfirm=r,this.handleDismiss=o};this.hideModal=()=>{this.state.isVisible=!1,this.state.type=null,this.state.error="",this.state.identifier=null,this.resetHandlers()};this.resetHandlers=()=>{this.handleConfirm=null,this.handleDismiss=null};this.configStore=e.configStore,this.state=We.observable(Zf)}showInfoModal(e){this.resetHandlers(),this.state.isVisible=!0,this.state.type=se.INFO,this.state.identifier=e,this.state.error=""}showTextEditModal(){this.resetHandlers(),this.state.isVisible=!0,this.state.type=se.TEXT_EDIT,this.state.identifier="inputText",this.state.error=""}get modalProps(){const{isVisible:e}=this.state,t=this.getModalLocale();if(t){const{bodyLabel:i,headerLabel:r,buttonYes:o,buttonNo:n}=t;return{headerLabel:r,bodyLabel:i,confirmLabel:o,dismissLabel:n,isVisible:e,handleClose:this.hideModal,handleConfirm:this.handleConfirm,handleDismiss:this.handleDismiss}}return{isVisible:!1}}get isVisible(){return this.state.isVisible}get type(){return this.state.type}get identifier(){return this.state.identifier}get positionOffset(){const{isLayoutAdvanced:e,measurements:{basicCanvasOffset:t,advancedUIToolControlBar:i,advancedUIToolbar:r},isOrderDefault:o}=this.configStore,n=(i.width+r.width)*(o?1:-1),a=t;return e?{x:n/2,y:0}:{x:0,y:-a}}getModalLocale(){const{identifier:e,error:t,type:i}=this.state,{locale:r}=this.configStore;if(!i||!e||i===se.TEXT_EDIT)return null;if(i&&e&&r[`${i}Modals`]&&r[`${i}Modals`][e]){const o=r[`${i}Modals`][e];let{body:n}=o;n&&typeof t=="object"?Object.keys(t).forEach(l=>{n=n.replace(`\${${l}}`,t[l])}):n&&(n=n.replace("${error}",t));let a=o.heading;if(i===se.ERROR||i===se.WARNING){const l={error:r.common.error,warning:r.common.warning},c=i==="error"?l.error:l.warning;a=`${c}${o.headingDelimiter} ${o.header||""}`}return{bodyLabel:n,headerLabel:a,buttonYes:o.buttonYes,buttonNo:o.buttonNo}}return null}}s([We.action],ht.prototype,"showActionModal",2),s([We.action],ht.prototype,"showInfoModal",1),s([We.action],ht.prototype,"showTextEditModal",1),s([We.action],ht.prototype,"hideModal",2),s([We.computed],ht.prototype,"modalProps",1),s([We.computed],ht.prototype,"isVisible",1),s([We.computed],ht.prototype,"type",1),s([We.computed],ht.prototype,"identifier",1),s([We.computed],ht.prototype,"positionOffset",1);const ne=m(b());class me{constructor(e){this.defaultScale=1;this.SCALE_LEVELS=[8.33,12.5,16.66,25,33.33,50,66.66,100,125,150,200,300,400,500,600].map(e=>e/100);this.state={position:{x:0,y:0},scaleIndex:-1};this.offset={x:0,y:0};this.in=()=>{this.canZoomIn&&(this.state.scaleIndex+=1,this.scaleRender())};this.out=()=>{if(this.canZoomOut){this.state.scaleIndex-=1;const{canDragX:e,canDragY:t,maxOffsetX:i,maxOffsetY:r}=this.checkOffset({x:0,y:0});t||(this.offset.y=r),e||(this.offset.x=i),this.savePosition(),this.scaleRender()}};this.setOffset=e=>{const{canDragX:t,canDragY:i}=this.checkOffset(e);t&&(this.offset.x=e.x),i&&(this.offset.y=e.y),this.scaleRender()};this.editor=e}setInitialTransform(e=0){const{transform:t}=this.editor.engineMediator.preview;ne.runInAction(()=>{this.setDefaultScale(Math.abs(e||t.scale.x)),this.setPosition(t.position)})}resetScale(){this.state.scaleIndex=-1}resetPosition(){const{width:e,height:t}=this.editor.canvasStore.canvas;this.setPosition({x:e/2,y:t/2})}resetOffset(){this.offset={x:0,y:0}}setPosition(e){this.state.position.x=e.x,this.state.position.y=e.y}savePosition(){this.setPosition(this.getPositionWithOffset()),this.offset={x:0,y:0}}setDefaultScale(e){if(this.defaultScale!==1){const i=this.SCALE_LEVELS.findIndex(r=>r===this.defaultScale);i!==-1&&(this.SCALE_LEVELS=[...this.SCALE_LEVELS.slice(0,i),...this.SCALE_LEVELS.slice(i+1)])}const t=this.SCALE_LEVELS.findIndex((i,r)=>r===0?e<i:r===this.SCALE_LEVELS.length-1?i<e:this.SCALE_LEVELS[r-1]<e&&e<i);if(t!==-1)this.SCALE_LEVELS=[...this.SCALE_LEVELS.slice(0,t),e,...this.SCALE_LEVELS.slice(t)],t===this.state.scaleIndex&&this.resetScale(),this.state.scaleIndex=t,this.defaultScale=e;else{const i=this.SCALE_LEVELS.findIndex(r=>r===e);i===this.state.scaleIndex&&this.resetScale(),i!==-1&&(this.state.scaleIndex=i,this.defaultScale=e)}}setScaleToDefault(){this.state.scaleIndex=this.defaultIndex}checkOffset(e){const t=window.devicePixelRatio||1,{scaledSize:i}=this,{previewSize:r}=this,o=this.editor.engineMediator.preview.initialTransform.position,n=this.getPositionWithOffset(e),a=(i.width-r.width)*t/2,l=(i.height-r.height)*t/2,c=o.x-n.x,d=o.y-n.y,u=Math.abs(c),h=Math.abs(d),y=c>0,k=d>0,w=u-a,T=h-l;return{canDragX:w<0,canDragY:T<0,maxOffsetX:y?-w:w,maxOffsetY:k?-T:T}}calculateScale(e=0,t=this.previewSize,i=this.defaultScale){const{width:r,height:o}=t,n=new D({x:r,y:o}),a=new D(Math.abs(n.x*Math.cos(e))+Math.abs(n.y*Math.sin(e)),Math.abs(n.x*Math.sin(e))+Math.abs(n.y*Math.cos(e))),l=n.subtract(a).divide(2).multiply(i).abs;return l.y>l.x?l.y*2/n.y+i:l.x*2/n.x+i}get defaultIndex(){return this.SCALE_LEVELS.findIndex(e=>e===this.defaultScale)}getPositionWithOffset(e=this.offset){const{position:t}=this;return{x:t.x-e.x,y:t.y-e.y}}scaleRender(e=!1){const t=this.editor.scale.getPositionWithOffset(),i=e?this.defaultScale:this.scale,r={x:i,y:i};this.editor.engineMediator.preview.container.setScale(r),this.editor.engineMediator.preview.container.setPosition(t),this.editor.engineMediator.preview.savePreviewTransform({scale:r,position:t,rotation:0}),e||this.editor.render()}get scale(){const e=this.state.scaleIndex;return e!==-1?this.SCALE_LEVELS[e]:this.defaultScale}get zoomLevel(){const e=window.devicePixelRatio||1;return(this.scale/e*100).toFixed(1)}get canDrag(){return this.defaultScale<this.scale}get canZoomOut(){return this.state.scaleIndex>this.defaultIndex}get canZoomIn(){return this.SCALE_LEVELS.length-1>this.state.scaleIndex}get position(){return this.state.position}get scaledSize(){const e=this.state.scaleIndex,t=e!==-1?this.SCALE_LEVELS[e]:this.defaultScale,{previewSize:i}=this;return{width:i.width*t/this.defaultScale,height:i.height*t/this.defaultScale}}get previewSize(){return this.editor.getPreviewSize()}}s([ne.observable],me.prototype,"state",2),s([ne.action],me.prototype,"in",2),s([ne.action],me.prototype,"out",2),s([ne.action],me.prototype,"setInitialTransform",1),s([ne.action],me.prototype,"resetScale",1),s([ne.action],me.prototype,"resetPosition",1),s([ne.action],me.prototype,"setPosition",1),s([ne.action],me.prototype,"savePosition",1),s([ne.action],me.prototype,"setDefaultScale",1),s([ne.action],me.prototype,"setScaleToDefault",1),s([ne.computed],me.prototype,"scale",1),s([ne.computed],me.prototype,"zoomLevel",1),s([ne.computed],me.prototype,"canDrag",1),s([ne.computed],me.prototype,"canZoomOut",1),s([ne.computed],me.prototype,"canZoomIn",1),s([ne.computed],me.prototype,"position",1),s([ne.computed],me.prototype,"scaledSize",1);const Wi=m(b()),tc=/^data:image\/(.+?);base64,/,Qf=e=>tc.test(e),em=e=>e.match(/^data:([^;]+)/)[1],tm=e=>e.replace(tc,"");class ds{constructor(e){this.applySerialization=(e,t,i,r)=>I(this,null,function*(){this.editor.resetToolStates();const o=this.editor.activeStore.tool===f.TRANSFORM;o||this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.reset(),o||this.editor.transformToolStore.onLeave();const n=new t(this.editor),a="Unexpected error occured",l=t.deserializeImage(e);if(l.image&&l.image.data){const d=l.image.data;yield this.editor.setImage(d),this.editor.scale.defaultScale=1,this.editor.scale.resetOffset(),this.editor.transformToolStore.reset(),this.editor.activeStore.setImage(d),yield this.editor.engineMediator.image.addImageToContainer(),this.editor.engineMediator.output.applyNewImageTransform(),this.editor.engineMediator.preview.updateTransform(),this.editor.scale.setInitialTransform(),this.editor.transformToolStore.setCropDefaults(),this.editor.historyStore.addInitialSnapshot(),this.editor.transformToolStore.saveTransforms()}const c=n.deserializeTransformation(e);if(c){yield this.applyStateOnUI(c);const d=n.deserialize(e);d?(yield this.applyStateOnUI(d),yield this.editor.render(),this.editor.modalStore.identifier==="loading"&&this.editor.modalStore.hideModal(),i()):r(a)}else r(a)});this.editor=e}serialize({image:e}={image:!1}){const t=this.editor.activeStore.tool===f.TRANSFORM;return this.editor.modalStore.showInfoModal("saving"),new Promise((i,r)=>{import("./serialization/index.js").then(n=>I(this,[n],function*({Serializer:o}){try{t&&this.editor.transformToolStore.onLeave(),yield this.editor.wait(),this.editor.transformToolStore.applyDefaultCrop(!1);const{originalImage:a}=this.editor.imageContainer.getData(),l=this.editor.engineMediator.output.container.getResolution(),c={width:a.width,height:a.height},d=new o(this.editor.transformToolStore.defaultCropMaskPosition,this.editor.transformToolStore.maxCropMaskSize,l,c,this.editor.engine.getRootContainers()[0],this.editor.engine.getOutputContainer()),u={[f.ADJUSTMENT]:Wi.toJS(this.editor.adjustmentsToolStore.state),[f.FILTER]:Wi.toJS(this.editor.filterToolStore.state),[f.FOCUS]:Wi.toJS(this.editor.focusToolStore.serializableState),[f.OVERLAY]:Wi.toJS(this.editor.overlayToolStore.state),[f.FRAME]:Wi.toJS(this.editor.frameToolStore.state),[f.BRUSH]:this.editor.brushToolStore.strokes||{strokes:[]}},{sprite:h,customStickers:y}=this.editor.spriteStore.serializableState;h.spriteIdList=h.spriteIdList.sort((T,F)=>{const $=h.common[T].order,E=h.common[F].order;return $-E}),u.sprite=h,u.customStickers=y,u.transform=this.editor.transformToolStore.serializableState;let k,w;if(e){const T=ds.getDataURL(a);w=em(T),k=tm(T)}this.editor.modalStore.hideModal(),i(d.serialise(u,k,w)),t&&this.editor.transformToolStore.onEnter()}catch(a){this.editor.modalStore.hideModal(),r(a)}}))})}deserialize(e){return this.editor.modalStore.showInfoModal("loading"),new Promise((t,i)=>{try{import("./serialization/index.js").then(({Deserializer:r})=>{r.checkIsSerialisationValid(e)?this.applySerialization(e,r,t,i):(this.editor.modalStore.hideModal(),this.editor.modalStore.showActionModal({type:se.WARNING,identifier:"unsupportedSerializationVersion",handleConfirm:()=>this.applySerialization(e,r,t,i)}))})}catch(r){this.editor.modalStore.identifier==="loading"&&this.editor.modalStore.hideModal(),i(r)}})}static getDataURL(e){if(e instanceof HTMLCanvasElement)return e.toDataURL(Mt.PNG);const{src:t}=e;if(Qf(t))return t;const i=document.createElement("canvas");i.width=e.width,i.height=e.height;const r=i.getContext("2d");return r.drawImage(e,0,0),i.toDataURL(Mt.PNG)}applyStateOnUI(e){return I(this,null,function*(){const t=this.editor.activeStore.tool===f.TRANSFORM;try{e.transform&&(t||this.editor.transformToolStore.onEnter(),this.editor.transformToolStore.updateStateFromSerialization(e.transform,!0),yield this.editor.wait(),t||(this.editor.transformToolStore.onLeave(),this.editor.transformToolStore.onEnter(),yield this.editor.wait(),this.editor.transformToolStore.onLeave())),e.filter&&(yield this.editor.filterToolStore.updateStateFromSerialization(e.filter)),e.adjustment&&this.editor.adjustmentsToolStore.updateStateFromSerialization(e.adjustment),e.focus&&(yield this.editor.focusToolStore.updateStateFromSerialization(e.focus)),e.overlay&&(yield this.editor.overlayToolStore.updateStateFromSerialization(e.overlay)),e.sprite&&(e.sprite.spriteIdList=e.sprite.spriteIdList.sort((i,r)=>{const o=e.sprite.common[i].order,n=e.sprite.common[r].order;return o-n}),yield this.editor.spriteStore.updateStateFromSerialization(e.sprite,e.customStickers)),e.brush&&this.editor.brushToolStore.updateStateFromHistory(e.brush),e.frame&&(yield this.editor.frameToolStore.updateStateFromSerialization(e.frame)),this.editor.outputContainer.updateChildrenContainers()}catch(i){console.error(i),this.editor.modalStore.showActionModal({type:se.ERROR,identifier:"unexpectedError",error:i,handleConfirm:()=>{window.location.reload()}})}})}}const Ct={identifier:"identity",opacity:1,width:0,color:Be.white};const ei=m(b()),im=new Jt(0,1);class ti{constructor(e){this.changeIdentifier=e=>{this.state.identifier=e};this.changeOpacity=e=>{const t=im.clamp(e);this.state.opacity=t};this.changeWidth=e=>{this.state.width=e};this.changeColor=e=>{this.state.color=e};this.reset=()=>{this.indexInContainer===-1&&(this.state.identifier=Ct.identifier,this.state.opacity=Ct.opacity,this.state.width=Ct.width,this.state.color=Ct.color,this.removeIndex())};this.removeFrameEffect=()=>{this.effect&&(this.engine.removeEffect(this.effect),this.effect=void 0)};this.setEffectProperties=e=>this.effect?(this.removeIndex(),this.effect.setProperties(e),this.effect.getProperties()):null;this.setFrameEffect=({identifier:e,width:t,opacity:i,color:r})=>{const o=p({},this.state);this.changeIdentifier(e),this.changeWidth(t),this.changeOpacity(i),this.changeColor(r),this.removeFrameEffect();const n=this.engineMediator.orderHelper.addSprite(e);return new Promise((a,l)=>{this.engine.addFrameFromAssets(e,this.engineMediator.image.container,n).then(c=>{this.effect=c,this.effect.setProperties({tintColor:r,opacity:i,width:t}),a()}).catch(c=>{this.changeIdentifier(o.identifier),this.changeOpacity(o.opacity),this.changeWidth(o.width),this.changeColor(o.color),o.identifier==="identity"&&this.removeIndex(),l(c)})})};this.removeIndex=()=>{this.engineMediator.orderHelper.removeSprite(this.state.identifier)};this.engineMediator=e,this.state=Ct}get engine(){return this.engineMediator.engine}get imageContainer(){return this.engineMediator.image.container}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}}s([ei.observable],ti.prototype,"state",2),s([ei.action],ti.prototype,"changeIdentifier",2),s([ei.action],ti.prototype,"changeOpacity",2),s([ei.action],ti.prototype,"changeWidth",2),s([ei.action],ti.prototype,"changeColor",2),s([ei.action],ti.prototype,"reset",2);const Q=m(b());class re{constructor(e){this.colorList=le.defaultColors;this.selectFrame=e=>I(this,null,function*(){if(e!==this.identifier){const t=.1*this.editor.shortestOutputSide;yield this.frameStore.setFrameEffect({identifier:e,width:t,opacity:1,color:Ct.color}),this.editor.render(),this.addSnapshot(R.ADD,f.FRAME)}});this.changeOpacity=e=>{const t=this.frameStore.setEffectProperties({opacity:e});t&&(this.frameStore.changeOpacity(t.opacity),this.editor.render())};this.changeWidth=e=>{const t=this.frameStore.setEffectProperties({width:e});t&&(this.frameStore.changeWidth(t.width),this.editor.render())};this.changeColor=e=>{const t=this.frameStore.setEffectProperties({tintColor:e});t&&(this.frameStore.changeColor(t.tintColor),this.editor.render())};this.colorSnapshot=()=>{this.addSnapshot(R.EDIT,this.locale.controls.selectColor)};this.toolSnapshot=e=>{this.addSnapshot(R.EDIT,e)};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.pureReset=()=>{this.frameStore.removeFrameEffect(),this.frameStore.reset()};this.reset=()=>{this.pureReset(),this.addSnapshot(R.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.updateStateFromHistory=e=>e.identifier==="identity"?(this.pureReset(),new Promise(t=>{t()})):this.frameStore.setFrameEffect(e);this.updateStateFromSerialization=e=>I(this,null,function*(){const t=this.entityManager.items.find(i=>i.identifier===e.identifier);return t?this.frameStore.setFrameEffect(e):new Promise((i,r)=>{r(new Error("Frame Asset doesn't exist"))})});this.editor=e,this.frameStore=new ti(this.editor.engineMediator);const t=this.editor.assetProvider.getAssets("frame"),{config:i}=this;this.entityManager=new de(t,p(p({},i),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:this.locale.items,getAssetPath:this.editor.getAssetPath("frame")})),Ct.color=Q.toJS(ct(this.config,"defaultColor",Ct.color)),this.config.colors&&this.config.colors.length>0&&(this.colorList=dt(Q.toJS(this.config.colors)))}get state(){return this.frameStore.state}get identifier(){return this.state.identifier}get color(){return this.state.color}get size(){return this.state.width}get tintable(){const e=this.entityManager.items.find(t=>t.identifier===this.identifier);return e&&e.tintable||!1}get opacity(){return this.state.opacity}get minSize(){return this.editor.shortestOutputSide*.05}get maxSize(){return this.editor.shortestOutputSide*.3}get config(){return this.editor.configStore.config[f.FRAME]}get locale(){return this.editor.configStore.locale[f.FRAME]}get localeColor(){return this.editor.configStore.locale.common.color}get items(){return this.entityManager.items}get isOptionSelected(){return this.identifier!=="identity"}}s([Q.action],re.prototype,"selectFrame",2),s([Q.action],re.prototype,"changeOpacity",2),s([Q.action],re.prototype,"changeWidth",2),s([Q.action],re.prototype,"changeColor",2),s([Q.action],re.prototype,"pureReset",2),s([Q.action],re.prototype,"reset",2),s([Q.action],re.prototype,"updateStateFromHistory",2),s([Q.action],re.prototype,"updateStateFromSerialization",2),s([Q.computed],re.prototype,"state",1),s([Q.computed],re.prototype,"identifier",1),s([Q.computed],re.prototype,"color",1),s([Q.computed],re.prototype,"size",1),s([Q.computed],re.prototype,"tintable",1),s([Q.computed],re.prototype,"opacity",1),s([Q.computed],re.prototype,"minSize",1),s([Q.computed],re.prototype,"maxSize",1),s([Q.computed],re.prototype,"config",1),s([Q.computed],re.prototype,"locale",1),s([Q.computed],re.prototype,"localeColor",1),s([Q.computed],re.prototype,"items",1),s([Q.computed],re.prototype,"isOptionSelected",1);const Oe=m(b()),rm={categories:[],query:""};class Je{constructor(e){this.initProvider=e=>{e&&(this.libraryProvider=new e)};this.fetchImages=(e="")=>I(this,null,function*(){if(this.libraryProvider){let t=null;try{const i=yield this.libraryProvider.getCategories(),r=yield this.libraryProvider.searchImages(e);t=i.map((o,n)=>{const a=r.filter(l=>l.category===o.name);return{identifier:o.name,name:o.name,thumbnailURI:o.coverImageUrl,items:a.map(l=>({name:l.title||`image${n}`,identifier:`${o.name}-${l.title}-${n}`,thumbnailURI:l.thumbUrl,rawUrl:l.rawUrl,authorName:l.authorName,authorAvatar:l.authorAvatar}))}}).filter(o=>o.items.length)}catch(i){console.log(i)}Oe.runInAction(()=>{this.state.query=e,this.state.categories=t})}});this.toggleCategorySelection=e=>{this.selectedCategory=this.selectedCategory!==e?e:""};this.getRawUrl=e=>{const t=this.items.findIndex(i=>i.identifier===e);return t!==-1?this.items[t].rawUrl:e};this.configStore=e.configStore,this.state=Oe.observable(rm),this.selectedCategory=""}get selectedCategoryIdentifier(){return this.selectedCategory}get categories(){return this.state.categories}get items(){return this.state.categories.map(e=>e.items).reduce((e,t)=>[...e,...t],[])}get query(){return this.state.query}get config(){return this.configStore.config[f.LIBRARY]}get locale(){return this.configStore.locale[f.LIBRARY]}}s([Oe.observable],Je.prototype,"selectedCategory",2),s([Oe.action],Je.prototype,"initProvider",2),s([Oe.action],Je.prototype,"fetchImages",2),s([Oe.action],Je.prototype,"toggleCategorySelection",2),s([Oe.computed],Je.prototype,"selectedCategoryIdentifier",1),s([Oe.computed],Je.prototype,"categories",1),s([Oe.computed],Je.prototype,"items",1),s([Oe.computed],Je.prototype,"query",1),s([Oe.computed],Je.prototype,"config",1),s([Oe.computed],Je.prototype,"locale",1);const Tr={identifier:"identity",opacity:1,blendMode:zt.LIGHTEN};const ii=m(b()),om=new Jt(0,1);class ri{constructor(e,t){this.changeIdentifier=e=>{this.state.identifier=e};this.changeOpacity=e=>{const t=om.clamp(e);this.state.opacity=t};this.changeBlendMode=e=>{this.state.blendMode=e};this.reset=()=>{this.indexInContainer===-1&&(this.state.identifier=Tr.identifier,this.state.opacity=Tr.opacity,this.state.blendMode=Tr.blendMode,this.removeIndex())};this.correctOverlayFlip=()=>{const{flipHorizontally:e,flipVertically:t}=this.editor.outputContainer.getData();this.effect&&(this.effect.setFlipHorizontally(e),this.effect.setFlipVertically(t))};this.removeOverlayEffect=()=>{this.effect&&(this.removeIndex(),this.engineMediator.engine.removeEffect(this.effect),this.effect=void 0)};this.setEffectProperties=e=>this.effect?(this.effect.setProperties(e),this.effect.getProperties()):null;this.setOverlayEffect=({identifier:e,blendMode:t,opacity:i})=>{const r=p({},this.state);this.changeIdentifier(e),this.changeOpacity(i),this.changeBlendMode(t),this.removeOverlayEffect();const o=this.engineMediator.orderHelper.addIndex(f.OVERLAY);return new Promise((n,a)=>{this.engineMediator.engine.addOverlayFromAssets(e,this.engineMediator.image.container,o).then(l=>{this.effect=l,this.effect.setProperties({blendMode:t,opacity:i}),this.correctOverlayFlip(),n()}).catch(l=>{this.changeIdentifier(r.identifier),this.changeOpacity(r.opacity),this.changeBlendMode(r.blendMode),r.identifier==="identity"&&this.removeIndex(),a(l)})})};this.removeIndex=()=>{this.engineMediator.orderHelper.removeIndex(f.OVERLAY)};this.engineMediator=e,this.editor=t,this.state=Tr}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}}s([ii.observable],ri.prototype,"state",2),s([ii.action],ri.prototype,"changeIdentifier",2),s([ii.action],ri.prototype,"changeOpacity",2),s([ii.action],ri.prototype,"changeBlendMode",2),s([ii.action],ri.prototype,"reset",2),s([ii.action],ri.prototype,"correctOverlayFlip",2);const ge=m(b());class be{constructor(e){this.selectOverlay=e=>I(this,null,function*(){if(e!==this.identifier){const t=this.defaultBlendModeForIdentifier(e);yield this.overlayStore.setOverlayEffect({identifier:e,opacity:1,blendMode:t}),this.addSnapshot(R.ADD,f.OVERLAY),this.editor.render()}});this.changeOpacity=e=>{const t=this.overlayStore.setEffectProperties({opacity:e});t&&(this.overlayStore.changeOpacity(t.opacity),this.editor.render())};this.toolSnapshot=()=>{this.addSnapshot(R.EDIT,this.locale.controls.sliderOpacity)};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.changeBlendMode=e=>{const t=this.overlayStore.setEffectProperties({blendMode:e});t&&(this.overlayStore.changeBlendMode(t.blendMode),this.addSnapshot(R.EDIT,this.locale.controls.carouselBlendMode),this.editor.render())};this.pureReset=()=>{this.overlayStore.removeOverlayEffect(),this.overlayStore.reset()};this.reset=()=>{this.pureReset(),this.addSnapshot(R.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.updateStateFromSerialization=e=>I(this,null,function*(){const t=this.entityManager.items.find(i=>i.identifier===e.identifier);return t?this.overlayStore.setOverlayEffect(e):new Promise((i,r)=>{r(new Error(`Overlay Asset ${e.identifier} doesn't exist`))})});this.updateStateFromHistory=e=>I(this,null,function*(){return e.identifier==="identity"?(this.pureReset(),new Promise(t=>{t()})):this.overlayStore.setOverlayEffect(e)});this.correctOverlayFlip=()=>{this.overlayStore.correctOverlayFlip()};this.defaultBlendModeForIdentifier=e=>{const t=this.entityManager.items.findIndex(i=>i.identifier===e);return t!==-1?this.entityManager.items[t].defaultBlendMode:zt.LIGHTEN};this.editor=e,this.overlayStore=new ri(this.editor.engineMediator,e);const t=this.editor.assetProvider.getAssets("overlay"),{config:i}=this;this.entityManager=new de(t,p(p({},i),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:this.locale.items,getAssetPath:this.editor.getAssetPath("overlay")}))}get state(){return this.overlayStore.state}get identifier(){return this.overlayStore.state.identifier}get opacity(){return this.overlayStore.state.opacity}get blendMode(){return this.overlayStore.state.blendMode}get isOptionSelected(){return this.identifier!=="identity"}get config(){return this.editor.configStore.config[f.OVERLAY]}get locale(){return this.editor.configStore.locale[f.OVERLAY]}get items(){return this.entityManager.items}get allBlendModes(){const e=this.locale.controls;return Object.keys(zt).map(t=>{const i=zt[t],r=`blendMode${i.charAt(0).toUpperCase()}${i.slice(1)}`;return{identifier:i,value:e[r]}})}}s([ge.action],be.prototype,"selectOverlay",2),s([ge.action],be.prototype,"changeOpacity",2),s([ge.action],be.prototype,"changeBlendMode",2),s([ge.action],be.prototype,"pureReset",2),s([ge.action],be.prototype,"reset",2),s([ge.action],be.prototype,"updateStateFromSerialization",2),s([ge.action],be.prototype,"updateStateFromHistory",2),s([ge.action],be.prototype,"correctOverlayFlip",2),s([ge.computed],be.prototype,"state",1),s([ge.computed],be.prototype,"identifier",1),s([ge.computed],be.prototype,"opacity",1),s([ge.computed],be.prototype,"blendMode",1),s([ge.computed],be.prototype,"isOptionSelected",1),s([ge.computed],be.prototype,"config",1),s([ge.computed],be.prototype,"locale",1),s([ge.computed],be.prototype,"items",1),s([ge.computed],be.prototype,"allBlendModes",1);const nm=e=>{const t=atob(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),o=new Uint8Array(r);for(let n=0;n<t.length;n+=1)o[n]=t.charCodeAt(n);return new Blob([r],{type:i})};var us=nm;const Or={size:0,color:Be.white,hardness:0,maximumSize:.125,minimumSize:0,maximumHardness:1,minimumHardness:0};const X=m(b());class te{constructor(e){this.colorList=le.defaultColors;this.dirty=X.observable.box(!1);this.id="";this.containerId=()=>this.id;this.initSize=()=>{const{minimumSize:e,maximumSize:t}=this.state,{size:i}=this;i===0&&this.changeSize(Xn(this.config,"defaultSize",[e,t]))};this.changeColor=e=>{this.state.color=e};this.changeSize=e=>{this.state.size=e};this.changeRelativeSize=e=>{const{maximumSize:t,minimumSize:i}=this.state;this.state.size=(t-i)*e/100+i};this.changeHardness=e=>{this.state.hardness=e};this.reset=()=>{this.pureReset(),this.addSnapshot(R.DELETE,this.locale.controls.buttonReset),this.editor.render()};this.editor=e,this.state=p(p({},Or),{hardness:Xn(this.config,"defaultHardness",[Or.minimumHardness,Or.maximumHardness]),color:X.toJS(ct(this.config,"defaultColor",Or.color))}),this.config.colors&&this.config.colors.length>0&&(this.colorList=dt(X.toJS(this.config.colors)))}addSnapshot(e,t){this.editor.addSnapshot(void 0,e,t)}clickableCanvas(e){this.editor.clickableCanvas(e)}beginStroke(e=[]){if(!this.drawingContainer){const t=this.editor.orderHelper.addSprite(f.BRUSH);this.drawingContainer=this.editor.engine.addDrawing({strokes:e},this.editor.imageContainer,t)}this.id=this.drawingContainer.getID(),this.drawingContainer.beginStroke({id:"imgly_brush_radial",color:X.toJS(this.state.color),size:this.state.size,hardness:this.state.hardness})}strokePosition(e){if(this.drawingContainer){const t=this.editor.previewToWorld(e,!1);this.drawingContainer.addPointToCurrentStroke(t),this.editor.render()}}endStroke(){this.drawingContainer&&(this.drawingContainer.endStroke(),this.editor.render(),this.strokes=this.drawingContainer.getData(),this.addSnapshot(R.EDIT,this.locale.history.brushStroke),this.dirty.set(!0))}updateStateFromHistory(e){if(e=e||{strokes:[]},this.drawingContainer){if(this.strokes&&this.strokes.strokes.length===e.strokes.length)return;this.strokes=e,this.drawingContainer.setData(this.strokes),e.strokes.length!==0&&this.dirty.set(!0)}else{const t=this.editor.orderHelper.addSprite(f.BRUSH);this.drawingContainer=this.editor.engine.addDrawing({strokes:e.strokes},this.editor.imageContainer,t),this.strokes=this.drawingContainer.getData()}this.id=this.drawingContainer.getID()}pureReset(){this.dirty.set(!1),this.strokes={strokes:[]},this.drawingContainer&&(this.editor.engine.removeContainer(this.drawingContainer),this.drawingContainer=void 0)}get config(){return this.editor.configStore.config[f.BRUSH]}get locale(){return this.editor.configStore.locale[f.BRUSH]}get localeColor(){return this.editor.configStore.locale.common.color}get color(){return this.state.color}get size(){return this.state.size}get relativeSize(){const{size:e,maximumSize:t,minimumSize:i}=this.state;return(e-i)*100/(t-i)}get sizeOnScreenSpace(){const e=this.editor.engineMediator.engine.getSmallerOutputSide();return this.editor.worldToPreview(this.state.size*e)}get hardness(){return this.state.hardness}get isDirty(){return this.dirty.get()}}s([X.observable],te.prototype,"state",2),s([X.observable],te.prototype,"dirty",2),s([X.action],te.prototype,"initSize",2),s([X.action],te.prototype,"changeColor",2),s([X.action],te.prototype,"changeSize",2),s([X.action],te.prototype,"changeRelativeSize",2),s([X.action],te.prototype,"changeHardness",2),s([X.action],te.prototype,"clickableCanvas",1),s([X.action],te.prototype,"beginStroke",1),s([X.action],te.prototype,"strokePosition",1),s([X.action],te.prototype,"endStroke",1),s([X.action],te.prototype,"updateStateFromHistory",1),s([X.action],te.prototype,"reset",2),s([X.computed],te.prototype,"config",1),s([X.computed],te.prototype,"locale",1),s([X.computed],te.prototype,"localeColor",1),s([X.computed],te.prototype,"color",1),s([X.computed],te.prototype,"size",1),s([X.computed],te.prototype,"relativeSize",1),s([X.computed],te.prototype,"sizeOnScreenSpace",1),s([X.computed],te.prototype,"hardness",1),s([X.computed],te.prototype,"isDirty",1);const pt=m(b());var ft;(function(e){e.LEADING="leading",e.CENTER="center",e.TRAILING="trailing"})(ft||(ft={}));const sm={horizontalGuides:[],verticalGuides:[],rotationGuides:[]};class Pt{constructor(e){this.previewTopLeftPosition={x:0,y:0};this.getGuideValue=(e,t)=>{const{height:i,width:r}=this.editor.getPreviewSize(),{snapToLeft:o,snapToRight:n,snapToTop:a,snapToBottom:l}=this.configStore.config.snapping.position,c=Math.min(i,r);let d=0;return t==="bottom"?d=Math.round(i-c*l):t==="top"?d=Math.round(c*a):t==="right"?d=Math.round(r-c*n):t==="left"?d=Math.round(c*o):e==="vertical"&&t==="center"?d=Math.round(r/2):e==="horizontal"&&t==="center"&&(d=Math.round(i/2)),d};this.getVerticalGuidesFromConfig=()=>{const{snapToVerticalCenter:e,snapToLeft:t,snapToRight:i}=this.configStore.config.snapping.position,r=[];return e&&r.push({value:this.getGuideValue("vertical","center"),edge:ft.CENTER,isVisible:!1,direction:"vertical"}),t&&r.push({value:this.getGuideValue("vertical","left"),edge:ft.LEADING,isVisible:!1,direction:"vertical"}),i&&r.push({value:this.getGuideValue("vertical","right"),edge:ft.TRAILING,isVisible:!1,direction:"vertical"}),r};this.getHorizontalGuidesFromConfig=()=>{const{snapToHorizontalCenter:e,snapToTop:t,snapToBottom:i}=this.configStore.config.snapping.position,r=[];return e&&r.push({value:this.getGuideValue("horizontal","center"),edge:ft.CENTER,isVisible:!1,direction:"horizontal"}),t&&r.push({value:this.getGuideValue("horizontal","top"),edge:ft.LEADING,isVisible:!1,direction:"horizontal"}),i&&r.push({value:this.getGuideValue("horizontal","bottom"),edge:ft.TRAILING,isVisible:!1,direction:"horizontal"}),r};this.getRotationGuidesFromConfig=()=>{const{angles:e}=this.configStore.config.snapping.rotation,t=[];e.forEach(r=>{t.push(r),t.push(r+360),t.push(r-360)});const i=t.filter((r,o)=>t.indexOf(r)===o);return i.map(r=>({value:r*Math.PI/180,edge:ft.CENTER,isVisible:!1,position:{x:0,y:0}}))};this.getSpriteDimensions=({leftTop:e,leftBottom:t,rightTop:i,rightBottom:r})=>{const o=Math.min(e.y,i.y,t.y,r.y),n=Math.max(e.y,i.y,t.y,r.y),a=Math.min(e.x,i.x,t.x,r.x),l=Math.max(e.x,i.x,t.x,r.x);return{height:Math.round(n-o),width:Math.round(l-a)}};this.mapRange=({value:e,fromMin:t,fromLength:i,toMin:r,toLength:o})=>(e-t)*o/i+r;this.updateGuides=()=>{this.state.horizontalGuides=this.getHorizontalGuidesFromConfig(),this.state.verticalGuides=this.getVerticalGuidesFromConfig()};this.mapToSnapSystem=(e,t,i,r)=>{if(t.length===0)return e;if(t[0]>e)return e-i;for(let o=0;o<t.length-1;o+=1){const n=t[o],a=t[o+1];let l=n+i,c=a-i,d=0;r&&(d=o*i*2,l+=d,c+=d+i*2);const u=1e-5;if(n<=e&&e<=a)return e<=n+u?n+d:e>=a-u?a+d+(r?i*2:0):this.mapRange({value:e,fromMin:n,fromLength:a-n,toMin:l,toLength:c-l})}return r?e+(t.length-1)*i*2+i:e};this.mapFromSnapSystem=(e,t,i,r)=>{if(t.length===0)return e;if(t[0]>e)return e>=t[0]-i?t[0]:e+i;let o=e;for(let a=0;a<t.length-1;a+=1){const l=t[a],c=t[a+1],d=l+i;let u=c-i,h=c;if(r&&(u+=i*2,h+=i*2,o=e-a*i*2),l<=o&&o<=h)return d<=o&&o<=u?this.mapRange({value:o,fromMin:d,fromLength:u-d,toMin:l,toLength:c-l}):o<d?l:c}o-=i*3;const n=t[t.length-1];return o<=n?n:o};this.centerSnapValue=(e,t)=>{const i=t*.5,{value:r,edge:o}=e;let n=r;return o===ft.LEADING?n+=i:o===ft.TRAILING&&(n-=i),n};this.mapSnappingGuidesToCenter=(e,t)=>{const i=[];return e.forEach(r=>{i.push(this.centerSnapValue(r,t))}),i};this.calcSnapThresholdInRadians=(e,t)=>e===0?0:t/e;this.calculatePreviewTopLeftPosition=()=>{const e=this.editor.engineMediator.preview.container.getPosition(),t=this.editor.getPreviewSize(),i=le.devicePixelRatio;this.previewTopLeftPosition={x:e.x/i-t.width/2,y:e.y/i-t.height/2}};this.snapToRotation=(e,t,i)=>{const{rotationGuides:r}=this.state,{enabled:o,threshold:n}=this.configStore.config.snapping.rotation,{x:a,y:l}=this.previewTopLeftPosition,{width:c}=this.editor.getPreviewSize();let d=(e+Math.PI*2)%(Math.PI*2);if(o){const u=new D(t).magnitude,h=r.map(w=>w.value).sort((w,T)=>w-T),y=this.calcSnapThresholdInRadians(u,n);if(!this.rotationOffset){const w=this.mapToSnapSystem(e,h,y,!1);this.rotationOffset=w-d}d=this.mapFromSnapSystem(d+this.rotationOffset,h,y,!1);const k={x:i.position.x-a-c,y:i.position.y-l};return r.forEach(w=>{w.isVisible=w.value===d,w.position=k}),d}return e};this.snapToPosition=(e,t)=>{const{horizontalGuides:i,verticalGuides:r}=this.state,{enabled:o,threshold:n}=this.configStore.config.snapping.position,a=new D(this.previewTopLeftPosition),{height:l,width:c}=this.getSpriteDimensions(t),{x:d,y:u}=new D(e).subtract(a);if(o){const h=this.mapSnappingGuidesToCenter(i,l).sort((T,F)=>T-F),y=this.mapSnappingGuidesToCenter(r,c).sort((T,F)=>T-F);if(!this.positionOffset){const T=this.mapToSnapSystem(d,y,n,!0),F=this.mapToSnapSystem(u,h,n,!0);this.positionOffset=new D(T,F).subtract(new D(d,u))}let k=this.mapFromSnapSystem(d+this.positionOffset.x,y,n,!0),w=this.mapFromSnapSystem(u+this.positionOffset.y,h,n,!0);return k=Math.round(k),w=Math.round(w),i.forEach(T=>{const F=Math.round(this.centerSnapValue(T,l));T.isVisible=F===w}),r.forEach(T=>{const F=Math.round(this.centerSnapValue(T,c));T.isVisible=F===k}),new D(k,w).add(a)}return{x:d,y:u}};this.editor=e,this.configStore=e.configStore,this.state=pt.observable(sm),this.rotationOffset=null,this.positionOffset=null,this.state.horizontalGuides=this.getHorizontalGuidesFromConfig(),this.state.verticalGuides=this.getVerticalGuidesFromConfig(),this.state.rotationGuides=this.getRotationGuidesFromConfig()}hidePositionGuides(){this.positionOffset=null,this.state.verticalGuides=this.state.verticalGuides.map(e=>p(p({},e),{isVisible:!1})),this.state.horizontalGuides=this.state.horizontalGuides.map(e=>p(p({},e),{isVisible:!1}))}hideRotationGuides(){this.rotationOffset=null,this.state.rotationGuides=this.state.rotationGuides.map(e=>p(p({},e),{isVisible:!1}))}get positionGuides(){const{verticalGuides:e,horizontalGuides:t}=this.state;return[...e,...t]}get rotationGuides(){return this.state.rotationGuides}}s([pt.observable],Pt.prototype,"state",2),s([pt.action],Pt.prototype,"snapToRotation",2),s([pt.action],Pt.prototype,"snapToPosition",2),s([pt.action],Pt.prototype,"hidePositionGuides",1),s([pt.action],Pt.prototype,"hideRotationGuides",1),s([pt.computed],Pt.prototype,"positionGuides",1),s([pt.computed],Pt.prototype,"rotationGuides",1);function hs(e,t=!1){return new Promise((i,r)=>{const o=new Image;o.addEventListener("load",()=>{let n=null;if(t){const a=document.createElement("canvas"),l=a.getContext("2d"),c=150,d=c*o.height/o.width;a.width=c,a.height=d,l.drawImage(o,0,0,c,d),n=a.toDataURL()}i({image:e,smallImage:n})}),o.addEventListener("error",()=>{r()}),o.src=e})}function ic(e,t=!1){return new Promise((i,r)=>{const o=new FileReader;o.onload=n=>I(this,null,function*(){hs(n.target.result,t).then(a=>{i(p(p({},a),{name:e.name||"",type:e.type,id:Do()}))}).catch(a=>{r(a)})}),o.readAsDataURL(e)})}const am="white",Ue={identifier:"identity",opacity:1,tintColor:Be[am],tintMode:"none",resizeMode:"keepAspect"},ps={};const z=m(b()),rc="identity",fs="imgly_sticker_custom";class U{constructor(e){this.state=z.observable.map(ps);this.customStickerIds=[];this.colorList=le.defaultColors;this.selectLast=()=>{this.editor.spriteStore.selectHighestOrderSprite(Array.from(this.state.keys()))};this.doesStickerAssetExist=e=>this.entityManager.items.findIndex(t=>t.identifier===e)!==-1;this.add=e=>{const t=this.entityManager.items.find(o=>o.identifier===e),i=t?t.tintMode:Ue.tintMode,r=t?t.resizeMode:Ue.resizeMode;this.editor.spriteStore.addSticker({state:{identifier:e,tintMode:i,tintColor:Ue.tintColor,opacity:Ue.opacity,resizeMode:r}})};this.duplicate=()=>{if(this.id){const e=this.editor.spriteStore.getDuplicateContainerTransform(this.id),t=this.editor.spriteStore.getDuplicateContainerFlip(this.id),{flipHorizontally:i,flipVertically:r}=this.editor.outputContainer.getData();this.editor.spriteStore.addSticker({state:{identifier:this.identifier,tintColor:z.toJS(this.tintColor),tintMode:this.tintMode,resizeMode:this.resizeMode,opacity:this.opacity,flipHorizontally:i!==t.flipHorizontally,flipVertically:r!==t.flipVertically},transform:e})}};this.bringToFront=()=>{this.id&&this.editor.spriteStore.bringToFront(this.id)};this.flipHorizontally=()=>{this.id&&this.editor.spriteStore.flipHorizontally(this.id)};this.delete=()=>{if(this.id){const e=this.id;this.editor.spriteStore.removeSprite(e),this.state.delete(e),this.selectLast()}};this.updateStateFromHistory=(e,t)=>{this.setState(e,t),this.editor.spriteStore.setContainerProperties(e,t)};this.setState=(e,t)=>{const i=this.state.get(e);i?("opacity"in t&&(i.opacity=t.opacity),t.tintColor&&(i.tintColor=t.tintColor),t.tintMode&&(i.tintMode=t.tintMode),t.resizeMode&&(i.resizeMode=t.resizeMode),this.state.set(e,i)):this.state.set(e,{identifier:t.identifier,opacity:t.opacity,tintMode:t.tintMode,resizeMode:t.resizeMode,tintColor:t.tintColor?t.tintColor:Ue.tintColor})};this.changeOpacity=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{opacity:e});const i=this.editor.spriteStore.getContainerProperties(this.id);t.opacity=i.opacity,this.state.set(this.id,t)}}};this.changeTintColor=e=>{if(this.id){const t=this.state.get(this.id);if(t){const{tintMode:i}=this.entityManager.items.find(o=>o.identifier===this.identifier);this.editor.spriteStore.setContainerProperties(this.id,{tintColor:e,tintMode:i});const r=this.editor.spriteStore.getContainerProperties(this.id);t.tintColor=r.tintColor,t.tintMode=r.tintMode||Ue.tintMode,this.state.set(this.id,t)}}};this.tintColorSnapshot=()=>{this.addSnapshot(R.EDIT,this.locale.history.color)};this.addFiles=e=>I(this,null,function*(){if(this.editor.modalStore.showInfoModal("loading"),e.length){let t=0;const i=[];for(t=0;t<e.length;t+=1)i.push(ic(e[t],!0));try{const r=yield Promise.all(i);this.addCustomStickerAsset(r)}catch(r){this.editor.modalStore.hideModal(),this.editor.modalStore.showInfoModal("stickerLoading")}}});this.addCustomStickerAsset=e=>I(this,null,function*(){const t=e.map(n=>({stickerURI:n.image,thumbnailURI:n.smallImage,name:n.name,tintMode:this.customStickerTintMode,resizeMode:"keepAspect",identifier:n.id,type:n.type}));this.customStickerIds=this.customStickerIds.concat(t.map(n=>({identifier:n.identifier,type:n.type})));const i=this.locale.categories[fs];this.editor.assetProvider.addCustomStickerAsset(t,fs,i);const r=this.editor.assetProvider.getAssets("sticker"),{config:o}=this;this.entityManager=new de(r,p(p({},o),{categoryKey:"thumbnailURI",itemKey:"stickerURI",locale:this.locale.items,getAssetPath:this.editor.getAssetPath("sticker")})),this.selectedCategory=fs,this.editor.modalStore.hideModal()});this.toolSnapshot=()=>{this.addSnapshot(R.EDIT,this.locale.history.opacity)};this.addSnapshot=(e,t)=>{this.currentSticker&&this.editor.spriteStore.addSnapshot(e,t)};this.toggleCategorySelection=e=>{this.selectedCategory=this.selectedCategory===e?rc:e};this.pureReset=()=>{this.state=z.observable.map(ps)};this.editor=e,this.selectedCategory=rc;const{config:t}=this,i=this.editor.assetProvider.getAssets("sticker");this.entityManager=new de(i,p(p({},t),{categoryKey:"thumbnailURI",itemKey:"stickerURI",locale:p(p({},this.locale.items),this.locale.categories),getAssetPath:this.editor.getAssetPath("sticker")})),Ue.tintColor=z.toJS(ct(this.config,"defaultTintColor",Ue.tintColor)),this.config.colors&&this.config.colors.length>0&&(this.colorList=dt(z.toJS(this.config.colors)))}get isStickerSelected(){return this.editor.spriteStore.isSpriteSticker}get isCustomStickerEnabled(){return this.config.enableCustomUpload}get customStickerTintMode(){return this.config.customStickerTintMode}get currentSticker(){if(this.isStickerSelected){const e=this.state.get(this.id);if(e)return e}return}get identifier(){if(this.isStickerSelected){const e=this.state.get(this.id);if(e)return e.identifier}return"none"}get id(){return this.isStickerSelected?this.editor.spriteStore.id:void 0}get opacity(){return this.currentSticker?this.currentSticker.opacity:Ue.opacity}get tintMode(){return this.currentSticker?this.currentSticker.tintMode:Ue.tintMode}get resizeMode(){return this.currentSticker?this.currentSticker.resizeMode:Ue.resizeMode}get tintable(){return this.currentSticker?this.currentSticker.tintMode==="solid"||this.currentSticker.tintMode==="colorized":!1}get tintColor(){return this.currentSticker?this.currentSticker.tintColor:Ue.tintColor}get config(){return this.editor.configStore.config[f.STICKER]}get locale(){return this.editor.configStore.locale[f.STICKER]}get localeColor(){return this.editor.configStore.locale.common.color}get selectedCategoryIdentifier(){return this.selectedCategory}get items(){return this.entityManager.items}get categories(){return this.entityManager.categories}}s([z.observable],U.prototype,"selectedCategory",2),s([z.observable],U.prototype,"entityManager",2),s([z.action],U.prototype,"selectLast",2),s([z.action],U.prototype,"add",2),s([z.action],U.prototype,"duplicate",2),s([z.action],U.prototype,"bringToFront",2),s([z.action],U.prototype,"flipHorizontally",2),s([z.action],U.prototype,"delete",2),s([z.action],U.prototype,"updateStateFromHistory",2),s([z.action],U.prototype,"setState",2),s([z.action],U.prototype,"changeOpacity",2),s([z.action],U.prototype,"changeTintColor",2),s([z.action],U.prototype,"addFiles",2),s([z.action],U.prototype,"addCustomStickerAsset",2),s([z.action],U.prototype,"toggleCategorySelection",2),s([z.action],U.prototype,"pureReset",2),s([z.computed],U.prototype,"isStickerSelected",1),s([z.computed],U.prototype,"isCustomStickerEnabled",1),s([z.computed],U.prototype,"customStickerTintMode",1),s([z.computed],U.prototype,"currentSticker",1),s([z.computed],U.prototype,"identifier",1),s([z.computed],U.prototype,"id",1),s([z.computed],U.prototype,"opacity",1),s([z.computed],U.prototype,"tintMode",1),s([z.computed],U.prototype,"resizeMode",1),s([z.computed],U.prototype,"tintable",1),s([z.computed],U.prototype,"tintColor",1),s([z.computed],U.prototype,"config",1),s([z.computed],U.prototype,"locale",1),s([z.computed],U.prototype,"localeColor",1),s([z.computed],U.prototype,"selectedCategoryIdentifier",1),s([z.computed],U.prototype,"items",1),s([z.computed],U.prototype,"categories",1);const lm="imgly_font_open_sans_bold",Y={text:"Write Something",identifier:lm,fontSize:73.3,defaultFontSize:73.3,fontFamily:"Open Sans",fontStyle:"",fontWeight:"bold",lineHeight:1,alignment:"center",textColor:Be.white,backgroundColor:Be.transparent||[0,0,0,0],width:0},ms={};const O=m(b()),nc={100:"Extra Light",200:"Light",300:"Book",400:"Regular",500:"Medium",600:"SemiBold",700:"Bold",800:"Black",900:"Extra Black",bold:"Bold",normal:"Regular",lighter:"Lighter"};class A{constructor(e){this.state=O.observable.map(ms);this.colorList=le.defaultColors;this.backgroundColorList=le.defaultBackgroundColors;this.loadingObservable=O.observable.box(!1);this.loadfonts=e=>{if(this.fontsLoaded)e();else{const t=this.editor.assetProvider.getFontManager(),i=this.editor.assetProvider.getFontAssetsForText().map(r=>r.identifier);t.loadFontsWithIdentifiers(i).then(()=>{this.loadingObservable.set(!0),e()}).catch(r=>{console.error(r),this.editor.modalStore.showActionModal({type:se.ERROR,identifier:"fontLoading",error:r})})}};this.doesTextAssetExist=e=>this.editor.assetProvider.getFontAssets().findIndex(t=>t.identifier===e)!==-1;this.validFontWithConfig=e=>this.fonts.find(t=>t.identifier===e)||this.fonts[0];this.addOrselect=()=>{this.state.size?this.selectLast():this.add()};this.selectLast=()=>{this.editor.spriteStore.selectHighestOrderSprite(Array.from(this.state.keys()))};this.add=()=>{const e=()=>{this.editor.spriteStore.addText({state:{identifier:Y.identifier,text:Y.text,textColor:Y.textColor,backgroundColor:Y.backgroundColor,lineHeight:Y.lineHeight,alignment:Y.alignment,fontSize:0}})};this.loadfonts(e)};this.duplicate=()=>{if(this.id){const e=this.editor.spriteStore.getDuplicateContainerTransform(this.id);this.editor.spriteStore.addText({state:{identifier:this.identifier,text:this.text,textColor:O.toJS(this.textColor),lineHeight:this.lineHeight,alignment:this.alignment,fontSize:this.fontSize,backgroundColor:O.toJS(this.backgroundColor),width:this.width},transform:e})}};this.bringToFront=()=>{this.id&&this.editor.spriteStore.bringToFront(this.id)};this.delete=()=>{if(this.id){const e=this.id;this.editor.spriteStore.removeSprite(e),this.state.delete(e),this.selectLast()}};this.setEditMode=e=>{this.editor.spriteStore.setEditMode(e)};this.changeFont=e=>{const t=this.fonts.find(i=>i.identifier===e);this.changeIdentifier(t,this.id),this.id&&this.addSnapshot(R.EDIT,this.locale.history.fontFamily)};this.changeIdentifier=(e,t)=>{O.runInAction(()=>{if(e&&t){const i=this.state.get(t);if(i){this.editor.spriteStore.setContainerProperties(t,{fontIdentifier:e.identifier},!0);const r=this.editor.spriteStore.getContainerProperties(t);i.identifier=r.fontIdentifier,i.fontFamily=e.fontFamily,i.fontStyle=e.fontStyle,i.fontWeight=e.fontWeight,i.fontSize=r.fontSize,i.width=r.width,i.defaultFontSize=i.fontSize,this.state.set(t,i)}}})};this.changeFontSize=(e,t=!1)=>{if(this.id){const i=this.state.get(this.id);i&&(i.fontSize=e,t&&(i.defaultFontSize=e),this.state.set(this.id,i))}};this.updateDefaultFontSize=()=>{if(this.id){const e=this.state.get(this.id);e&&(e.defaultFontSize=e.fontSize,this.state.set(this.id,e))}};this.changeSize=(e,t)=>{const i=this.state.get(e);i&&(i.width=t.width,i.fontSize=t.fontSize,i.defaultFontSize=t.fontSize,this.state.set(e,i))};this.changeWidth=e=>{if(this.id){const t=this.state.get(this.id);t&&(t.width=e,this.state.set(this.id,t))}};this.changeText=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{text:e},!0);let i=this.editor.spriteStore.getContainerProperties(this.id);const r=this.editor.outputContainer.getSizeInOutputSpace(),o=this.editor.spriteStore.getSize(this.id);this.config.disableAutoScaling||o.height>r.height&&this.editor.spriteStore.setContainerProperties(this.id,{fontSize:this.calculateFitFontSize(this.id,r.height)},!0),i=this.editor.spriteStore.getContainerProperties(this.id),t.text=i.text,t.fontSize=i.fontSize,t.defaultFontSize=i.fontSize,this.state.set(this.id,t),this.addSnapshot(R.EDIT,this.locale.history.edit)}}};this.calculateFitFontSize=(e,t)=>{if(!A.measureContext){const y=document.createElement("canvas");A.measureContext=y.getContext("2d")}const i=this.editor.spriteStore.getContainerProperties(e),r=this.editor.engine.assetProvider.getFontManager().getFontWithId(i.fontIdentifier),o=this.config.minFontSizeForAutoScaling,n=oc(A.measureContext,i.text,r,i.fontSize,i.lineHeight,i.width,r.textMetrics),a=Math.min(Math.floor(i.fontSize*(t/n.height)),1),l=Math.round(i.fontSize);let c=0,d=l-a,u=Math.floor((l-a)*2),h=d;for(;c<=u;){d=c+Math.floor((u-c)/2);const y=oc(A.measureContext,i.text,r,d,i.lineHeight,i.width,r.textMetrics);if(t<y.height)u=d-1,h=d-1;else if(t>y.height){if(c=d+1,a+d>=l)return l}else{h=d;break}}return o&&h<o?o:h};this.changeLineHeight=e=>{if(this.id){const t=this.state.get(this.id);if(t&&e){this.editor.spriteStore.setContainerProperties(this.id,{lineHeight:e},!0);const i=this.editor.spriteStore.getContainerProperties(this.id);t.lineHeight=i.lineHeight,this.state.set(this.id,t)}}};this.changeColor=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{textColor:e});const i=this.editor.spriteStore.getContainerProperties(this.id);t.textColor=i.textColor,this.state.set(this.id,t)}}};this.changeBackgroundColor=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{backgroundColor:e});const i=this.editor.spriteStore.getContainerProperties(this.id);t.backgroundColor=i.backgroundColor,this.state.set(this.id,t)}}};this.colorSnapshot=()=>{this.addSnapshot(R.EDIT,this.locale.history.textColor)};this.backgroundColorSnapshot=()=>{this.addSnapshot(R.EDIT,this.locale.history.backgroundColor)};this.changeAlignment=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{alignment:e});const i=this.editor.spriteStore.getContainerProperties(this.id);t.alignment=i.alignment,this.state.set(this.id,t),this.addSnapshot(R.EDIT,this.locale.history.alignment)}}};this.toolSnapshot=()=>{this.addSnapshot(R.EDIT,this.locale.history.lineSpacing)};this.addSnapshot=(e,t)=>{this.currentText&&this.editor.spriteStore.addSnapshot(e,t)};this.updateStateFromHistory=(e,t)=>{this.setState(e,t),this.editor.spriteStore.setContainerProperties(e,t)};this.setState=(e,t)=>{const i=this.state.get(e);if(i)t.alignment&&(i.alignment=t.alignment),t.text&&(i.text=t.text),t.lineHeight&&(i.lineHeight=t.lineHeight),t.textColor&&(i.textColor=t.textColor),t.backgroundColor&&(i.backgroundColor=t.backgroundColor),t.fontIdentifier&&(i.identifier=t.fontIdentifier),t.fontSize&&(i.fontSize=t.fontSize,i.defaultFontSize=t.fontSize),t.width&&(i.width=t.width);else{const r=this.validFontWithConfig(t.fontIdentifier);r&&this.state.set(e,{text:t.text,identifier:r.identifier,alignment:t.alignment,textColor:t.textColor?t.textColor:Y.textColor,backgroundColor:t.backgroundColor?t.backgroundColor:Y.backgroundColor,fontFamily:r.fontFamily,fontStyle:r.fontStyle,fontSize:t.fontSize,fontWeight:r.fontWeight,lineHeight:t.lineHeight,width:t.width,defaultFontSize:t.fontSize})}};this.setFontSize=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{fontSize:e},!0);const i=this.editor.spriteStore.getContainerProperties(this.id);t.fontSize=i.fontSize,t.defaultFontSize=i.fontSize,this.state.set(this.id,t)}}};this.pureReset=()=>{this.state=O.observable.map(ms)};this.editor=e,this.fonts.find(t=>t.identifier===Y.identifier)||(Y.identifier=this.fonts[0].identifier),Y.textColor=O.toJS(ct(this.config,"defaultColor",Y.textColor)),Y.backgroundColor=O.toJS(ct(this.config,"defaultBackgroundColor",Y.backgroundColor)),Y.text=this.locale.canvasControls.placeholderText,this.config.colors&&this.config.colors.length>0&&(this.colorList=dt(O.toJS(this.config.colors))),this.config.backgroundColors&&this.config.backgroundColors.length>0&&(this.backgroundColorList=dt(O.toJS(this.config.backgroundColors)))}static defaultText(){return Y.text}static getDisplayFontStyle(e){const t=e.fontWeight&&nc[e.fontWeight].toLowerCase()!=="regular"?nc[e.fontWeight]:"",i=e.fontStyle&&e.fontStyle.toLowerCase()!=="normal"?e.fontStyle:"";return`${e.fontFamily.toLowerCase().includes(t.toLowerCase())?"":t} ${i}`.trim()}get isEditMode(){return this.editor.spriteStore.isEditMode}get isTextSelected(){return this.editor.spriteStore.isSpriteText}get fontsLoaded(){return this.loadingObservable.get()}get currentText(){if(this.isTextSelected){const e=this.state.get(this.id);if(e)return e}return}get text(){return this.currentText?this.currentText.text:Y.text}get fontSize(){return this.currentText?this.currentText.fontSize:Y.fontSize}get defaultFontSize(){return this.currentText?this.currentText.defaultFontSize:Y.defaultFontSize}get width(){return this.currentText?this.currentText.width:Y.width}get fontFamily(){return this.currentText?this.currentText.fontFamily:Y.fontFamily}get fontStyle(){return this.currentText?this.currentText.fontStyle:Y.fontStyle}get fontWeight(){return this.currentText?this.currentText.fontWeight:Y.fontWeight}get lineHeight(){return this.currentText?this.currentText.lineHeight:Y.lineHeight}get identifier(){return this.currentText?this.currentText.identifier:Y.identifier}get id(){return this.isTextSelected?this.editor.spriteStore.id:void 0}get alignment(){return this.currentText?this.currentText.alignment:Y.alignment}get textColor(){return this.currentText?this.currentText.textColor:Y.textColor}get backgroundColor(){return this.currentText?this.currentText.backgroundColor:Y.backgroundColor}get config(){return this.editor.configStore.config[f.TEXT]}get locale(){return this.editor.configStore.locale[f.TEXT]}get localeColor(){return this.editor.configStore.locale.common.color}get rawOptions(){return this.editor.assetProvider.getFontAssetsForText()}get fonts(){return this.rawOptions.reduce((e,t)=>this.rawOptions.find(i=>i.identifier===t.identifier)?[...e,{identifier:t.identifier,fontFamily:t.fontFamily,fontStyle:t.fontStyle||"",fontWeight:t.fontWeight||""}]:e,[])}get fontFamilies(){return[...new Set(this.fonts)]}}s([O.action],A.prototype,"addOrselect",2),s([O.action],A.prototype,"selectLast",2),s([O.action],A.prototype,"add",2),s([O.action],A.prototype,"duplicate",2),s([O.action],A.prototype,"bringToFront",2),s([O.action],A.prototype,"delete",2),s([O.action],A.prototype,"setEditMode",2),s([O.action],A.prototype,"changeFont",2),s([O.action],A.prototype,"changeIdentifier",2),s([O.action],A.prototype,"changeFontSize",2),s([O.action],A.prototype,"updateDefaultFontSize",2),s([O.action],A.prototype,"changeSize",2),s([O.action],A.prototype,"changeWidth",2),s([O.action],A.prototype,"changeText",2),s([O.action],A.prototype,"changeLineHeight",2),s([O.action],A.prototype,"changeColor",2),s([O.action],A.prototype,"changeBackgroundColor",2),s([O.action],A.prototype,"changeAlignment",2),s([O.action],A.prototype,"updateStateFromHistory",2),s([O.action],A.prototype,"setState",2),s([O.action],A.prototype,"setFontSize",2),s([O.action],A.prototype,"pureReset",2),s([O.computed],A.prototype,"isEditMode",1),s([O.computed],A.prototype,"isTextSelected",1),s([O.computed],A.prototype,"fontsLoaded",1),s([O.computed],A.prototype,"currentText",1),s([O.computed],A.prototype,"text",1),s([O.computed],A.prototype,"fontSize",1),s([O.computed],A.prototype,"defaultFontSize",1),s([O.computed],A.prototype,"width",1),s([O.computed],A.prototype,"fontFamily",1),s([O.computed],A.prototype,"fontStyle",1),s([O.computed],A.prototype,"fontWeight",1),s([O.computed],A.prototype,"lineHeight",1),s([O.computed],A.prototype,"identifier",1),s([O.computed],A.prototype,"id",1),s([O.computed],A.prototype,"alignment",1),s([O.computed],A.prototype,"textColor",1),s([O.computed],A.prototype,"backgroundColor",1),s([O.computed],A.prototype,"config",1),s([O.computed],A.prototype,"locale",1),s([O.computed],A.prototype,"localeColor",1),s([O.computed],A.prototype,"rawOptions",1),s([O.computed],A.prototype,"fonts",1),s([O.computed],A.prototype,"fontFamilies",1);const cm="imgly_text_design_blocks",ue={identifier:cm,color:Be.white,isInverted:!1,text:"Write Something With Style",seed:0,padding:0,width:0},gs={imgly_text_design_blocks:835,imgly_text_design_rotated:6,imgly_text_design_blocks_light:3,imgly_text_design_equal_width:727,imgly_text_design_masked:259,imgly_text_design_celebrate:579,imgly_text_design_sunshine:77,imgly_text_design_masked_badge:683,imgly_text_design_blocks_condensed:673,imgly_text_design_celebrate_simple:425,imgly_text_design_equal_width_fat:961,imgly_text_design_watercolor:671,imgly_text_design_particles:683,imgly_text_design_masked_speech_bubble:317,imgly_text_design_masked_speech_bubble_comic:229,imgly_text_design_multiline:831},bs={};const P=m(b());class V{constructor(e){this.state=P.observable.map(bs);this.colorList=le.defaultColors;this.fontsLoaded=!1;this.loadfonts=e=>{if(this.fontsLoaded)e();else{const t=this.editor.assetProvider.getFontManager(),i=this.editor.assetProvider.getFontAssetsForTextDesign().map(r=>r.identifier);t.loadFontsWithIdentifiers(i).then(()=>{this.fontsLoaded=!0,e()}).catch(r=>{console.error(r),this.editor.modalStore.showActionModal({type:se.ERROR,identifier:"fontLoading",error:i[0]})})}};this.doesTextDesignAssetExist=e=>this.entityManager.items.findIndex(t=>t.identifier===e)!==-1;this.addOrselect=()=>{this.state.size?this.selectLast():this.add()};this.selectLast=()=>{this.editor.spriteStore.selectHighestOrderSprite(Array.from(this.state.keys()))};this.add=()=>{const e=()=>{this.editor.spriteStore.addTextDesign({state:{identifier:ue.identifier,text:ue.text,color:ue.color,isInverted:ue.isInverted,seed:gs[ue.identifier]||ue.seed,padding:0}})};this.loadfonts(e)};this.updateStateFromHistory=(e,t)=>{const i=this.state.get(e);t.identifier===i.identifier?(this.setState(e,t),this.editor.spriteStore.setContainerProperties(e,t)):this.changeIdentifier(t.identifier,!1,t.seed,e)};this.setState=(e,t)=>{const i=this.state.get(e);i?(t.inverted&&(i.isInverted=t.inverted),t.seed&&(i.seed=t.seed),t.color&&(i.color=t.color),t.padding&&(i.padding=t.padding),t.width&&(i.width=t.width)):this.state.set(e,{width:t.width,text:t.text,isInverted:t.inverted,identifier:t.identifier,seed:t.seed,color:t.color?t.color:ue.color,padding:t.padding})};this.changeText=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{text:e},!0);const i=this.editor.spriteStore.getContainerProperties(this.id);t.text=i.text,this.state.set(this.id,t),this.addSnapshot(R.EDIT,this.locale.history.edit)}}};this.setEditMode=e=>{this.editor.spriteStore.setEditMode(e)};this.duplicate=()=>{if(this.id){const e=this.editor.spriteStore.getDuplicateContainerTransform(this.id);this.editor.spriteStore.addTextDesign({state:{identifier:this.identifier,text:this.text,color:P.toJS(this.color),isInverted:this.isInverted,seed:this.seed,padding:this.padding,width:this.width},transform:e})}};this.bringToFront=()=>{this.id&&this.editor.spriteStore.bringToFront(this.id)};this.addSnapshot=(e,t)=>{this.currentTextDesign&&this.editor.spriteStore.addSnapshot(e,t)};this.delete=(e=this.id)=>{e&&(this.editor.spriteStore.removeSprite(e),this.state.delete(e),this.selectLast())};this.changeSeed=()=>{if(this.id){const e=this.state.get(this.id);if(e){this.editor.spriteStore.setContainerProperties(this.id,{seed:-1},!0);const t=this.editor.spriteStore.getContainerProperties(this.id);e.seed=t.seed,this.state.set(this.id,e),this.addSnapshot(R.EDIT,this.locale.history.shuffle)}}};this.changeIdentifier=(e,t=!0,i=null,r=this.id)=>{if(r&&e!==this.identifier){const o=this.state.get(r),n=this.editor.spriteStore.getContainerTransform(r);this.editor.spriteStore.addTextDesign({spriteId:r,state:{identifier:e,text:o.text,color:P.toJS(o.color),isInverted:o.isInverted,seed:i||gs[e]||o.seed,padding:o.padding,width:o.width},transform:n},t,!0)}};this.changeColor=e=>{if(this.id){const t=this.state.get(this.id);if(t){this.editor.spriteStore.setContainerProperties(this.id,{color:e});const i=this.editor.spriteStore.getContainerProperties(this.id);t.color=i.color,this.state.set(this.id,t)}}};this.colorSnapshot=()=>{this.addSnapshot(R.EDIT,this.locale.history.color)};this.invertBackground=()=>{if(this.id){const e=this.state.get(this.id);if(e){this.editor.spriteStore.setContainerProperties(this.id,{inverted:!e.isInverted},!0);const t=this.editor.spriteStore.getContainerProperties(this.id);e.isInverted=t.inverted,this.state.set(this.id,e),this.addSnapshot(R.EDIT,this.locale.history.invert)}}};this.changeWidth=e=>{if(this.id){const t=this.state.get(this.id);t&&(t.width=e,this.state.set(this.id,t))}};this.changePadding=e=>{if(this.id){const t=this.state.get(this.id);t&&(t.padding=e,this.state.set(this.id,t))}};this.pureReset=()=>{this.state=P.observable.map(bs)};this.editor=e;const t=this.editor.assetProvider.getAssets("textdesign");this.entityManager=new de(t,p(p({},this.config),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:{},getAssetPath:this.editor.getAssetPath("textdesign")})),this.entityManager.items.find(i=>i.identifier===ue.identifier)||(ue.identifier=this.entityManager.items[0].identifier),ue.text=this.locale.canvasControls.placeholderText,ue.color=P.toJS(ct(this.config,"defaultColor",ue.color)),this.config.colors&&this.config.colors.length>0&&(this.colorList=dt(P.toJS(this.config.colors)))}static defaultText(){return ue.text}get isTextDesignSelected(){return this.editor.spriteStore.isSpriteTextDesign}get isEditMode(){return this.editor.spriteStore.isEditMode}get currentTextDesign(){if(this.isTextDesignSelected&&this.id){const e=this.state.get(this.id);if(e)return e}return}get id(){return this.isTextDesignSelected?this.editor.spriteStore.id:void 0}get text(){return this.currentTextDesign?this.currentTextDesign.text:ue.text}get seed(){return this.currentTextDesign?this.currentTextDesign.seed:ue.seed}get padding(){return this.currentTextDesign?this.currentTextDesign.padding:ue.padding}get width(){return this.currentTextDesign?this.currentTextDesign.width:ue.width}get identifier(){return this.currentTextDesign?this.currentTextDesign.identifier:null}get isInverted(){return this.currentTextDesign?this.currentTextDesign.isInverted:ue.isInverted}get color(){return this.currentTextDesign?this.currentTextDesign.color:ue.color}get config(){return this.editor.configStore.config[f.TEXT_DESIGN]}get locale(){return this.editor.configStore.locale[f.TEXT_DESIGN]}get localeColor(){return this.editor.configStore.locale.common.color}get items(){return this.entityManager.items}}s([P.action],V.prototype,"addOrselect",2),s([P.action],V.prototype,"selectLast",2),s([P.action],V.prototype,"add",2),s([P.action],V.prototype,"updateStateFromHistory",2),s([P.action],V.prototype,"setState",2),s([P.action],V.prototype,"changeText",2),s([P.action],V.prototype,"setEditMode",2),s([P.action],V.prototype,"duplicate",2),s([P.action],V.prototype,"bringToFront",2),s([P.action],V.prototype,"delete",2),s([P.action],V.prototype,"changeSeed",2),s([P.action],V.prototype,"changeIdentifier",2),s([P.action],V.prototype,"changeColor",2),s([P.action],V.prototype,"invertBackground",2),s([P.action],V.prototype,"changeWidth",2),s([P.action],V.prototype,"changePadding",2),s([P.action],V.prototype,"pureReset",2),s([P.computed],V.prototype,"isTextDesignSelected",1),s([P.computed],V.prototype,"isEditMode",1),s([P.computed],V.prototype,"currentTextDesign",1),s([P.computed],V.prototype,"id",1),s([P.computed],V.prototype,"text",1),s([P.computed],V.prototype,"seed",1),s([P.computed],V.prototype,"padding",1),s([P.computed],V.prototype,"width",1),s([P.computed],V.prototype,"identifier",1),s([P.computed],V.prototype,"isInverted",1),s([P.computed],V.prototype,"color",1),s([P.computed],V.prototype,"config",1),s([P.computed],V.prototype,"locale",1),s([P.computed],V.prototype,"localeColor",1),s([P.computed],V.prototype,"items",1);const C=m(b()),dm=e=>({height:e.y,width:e.x}),um={},xo="none",hm={position:{x:0,y:0},rotation:0};class _{constructor(e){this.state=C.observable.map(um);this.selectedId=C.observable.box(xo);this.editMode=C.observable.box(!1);this.dragMode=C.observable.box(!1);this.minLength=0;this.addSticker=(e,t=!0)=>I(this,null,function*(){yield this.addStickerAsync(e,t)});this.addStickerAsync=(o,...n)=>I(this,[o,...n],function*({spriteId:e,state:t,transform:i},r=!0){return new Promise((a,l)=>{i=this.getInitialTransform(i);const{identifier:c}=t,d=this.editor.orderHelper.addSprite(c);this.editor.engine.addStickerFromAssets(c,this.editor.engineMediator.image.container,d).then(u=>I(this,null,function*(){e&&u.setData({id:e});const h=u.getID();this.container[h]=u,this.editor.orderHelper.renameSprite(c,h);const y=this.getSize(h);y.width*=u.getScale().x,y.height*=u.getScale().y,u.setPivot(.5,.5);let k;if(i.scale)k=i.scale;else if(i.size)k={x:i.size.width/y.width,y:i.size.height/y.height};else{const $=this.editor.shortestOutputSide*.4,E=_.magnitude($)/_.sizeMagnitude(u.getSizeInWorldSpace());k={x:E,y:E}}const{flipHorizontally:w,flipVertically:T}=this.editor.outputContainer.getData();u.setFlipHorizontally(w),u.setFlipVertically(T),u.setTransform({position:i.position,scale:k,rotation:i.rotation}),t.flipHorizontally!==void 0&&u.setFlipHorizontally(t.flipHorizontally!==w),t.flipVertically!==void 0&&u.setFlipVertically(t.flipVertically!==T),this.setContainerProperties(h,p({},t));const F=u.getData();this.setInitialSpriteState(h,f.STICKER),this.stickerToolStore.setState(h,p(p({},F),{identifier:c})),yield this.editor.renderPromise(),r&&(this.selectedId.set(h),this.addSnapshot(R.ADD,this.stickerLocale.add)),a()})).catch(u=>{console.error(u),l()})})});this.addText=(e,t=!0)=>I(this,null,function*(){yield this.addTextAsync(e,t)});this.addTextAsync=({spriteId:e,state:t,transform:i},r=!0)=>new Promise((o,n)=>{i=this.getInitialTransform(i);const a=this.editor.orderHelper.addSprite(t.identifier),l=this.editor.shortestOutputSide,c={fontIdentifier:t.identifier,text:t.text,width:t.width||l*.6,fontSize:t.fontSize||l*.1,lineHeight:t.lineHeight,alignment:t.alignment,textColor:t.textColor,backgroundColor:t.backgroundColor};this.editor.engine.addTextWithFontLoading(c,this.editor.engineMediator.image.container,a).then(d=>I(this,null,function*(){e&&d.setData({id:e});const u=d.getID();this.container[u]=d,this.editor.orderHelper.renameSprite(t.identifier,this.id);const{flipHorizontally:h,flipVertically:y}=this.editor.outputContainer.getData();d.setFlipHorizontally(h),d.setFlipVertically(y),d.setPivot(.5,.5),d.setPosition(i.position),d.setRotation(i.rotation),this.setInitialSpriteState(u,f.TEXT);const k=d.getData();this.textToolStore.setState(u,p({},k)),yield this.editor.renderPromise(),r&&(this.selectedId.set(u),this.addSnapshot(R.ADD,this.textLocale.add)),o()})).catch(d=>{console.error(d),n()})});this.addTextDesign=(e,t=!0,i=!1)=>I(this,null,function*(){yield this.addTextDesignAsync(e,t,i)});this.addTextDesignAsync=({spriteId:e,state:t,transform:i},r=!0,o=!1)=>new Promise((n,a)=>{i=this.getInitialTransform(i);const l=this.editor.orderHelper.addSprite(t.identifier),c=this.editor.shortestOutputSide,d={width:t.width||c*.6,text:t.text,color:t.color,inverted:t.isInverted,seed:t.seed,padding:t.padding};this.editor.engine.addTextDesignAsync(t.identifier,d,this.editor.engineMediator.image.container,l).then(u=>I(this,null,function*(){e&&(o&&(this.pureRemoveSprite(e),this.textDesignToolStore.state.delete(e)),u.setData({id:e}));const h=u.getID();this.container[h]=u,this.editor.orderHelper.renameSprite(t.identifier,this.id);const{flipHorizontally:y,flipVertically:k}=this.editor.outputContainer.getData();u.setFlipHorizontally(y),u.setFlipVertically(k),u.setPivot(.5,.5),u.setPosition(i.position),u.setRotation(i.rotation),this.setInitialSpriteState(h,f.TEXT_DESIGN);const w=u.getData();this.textDesignToolStore.setState(h,p(p({},w),{identifier:t.identifier})),yield this.editor.renderPromise(),r&&(this.selectedId.set(h),this.addSnapshot(R.ADD,this.textDesignLocale.add)),n()})).catch(u=>{console.error(u),a()})});this.spriteLocalTransform=()=>({position:this.editor.previewToOutput(this.position),size:this.size,rotation:this.rotation});this.clickableCanvas=e=>{this.editor.clickableCanvas(e)};this.setContainerProperties=(e,t,i=!1)=>{this.container[e].setData(t),i&&this.updatePositionAndSize(),this.editor.render()};this.setContainerPosition=(e,t)=>{this.container[e].setPosition(t)};this.pureRemoveSprite=e=>{this.editor.engine.removeContainer(this.container[e]);const t=this.container[e].getIndexInParent();return t===-1?(delete this.container[e],this.state.delete(e),this.editor.orderHelper.removeSprite(e),!0):!1};this.deleteSprite=(e=this.id)=>{const t=this.state.get(e);t.tool===f.STICKER?this.stickerToolStore.delete():t.tool===f.TEXT?this.textToolStore.delete():t.tool===f.TEXT_DESIGN&&this.textDesignToolStore.delete()};this.removeSprite=e=>{const t=this.pureRemoveSprite(e);t&&(this.selectLast(),this.spriteSnapshot("delete"),this.editor.render())};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.spriteSnapshot=e=>{this.addSnapshot(R.EDIT,this.historyLocale[e])};this.updateStateFromHistory=e=>I(this,null,function*(){const t=Object.keys(this.container),i=e.spriteIdList;if(i.length!==t.length){const r=t.filter(n=>i.indexOf(n)===-1),o=i.filter(n=>t.indexOf(n)===-1);r.forEach(n=>{this.pureRemoveSprite(n)});for(let n=0;n<o.length;n+=1){const a=o[n],l=e.common?e.common[a]:void 0,c=e.text?e.text[a]:void 0,d=e.sticker?e.sticker[a]:void 0,u=e.textdesign?e.textdesign[a]:void 0;if(l){const h={spriteId:a,transform:{size:l.size?dm(D.fromSize(l.size)):void 0,position:new D(l.position),rotation:l.rotation}};c?yield this.addNewText(h,c):u?yield this.addNewTextDesign(h,u):d&&(yield this.addNewSticker(h,p(p({},d),{flipHorizontally:l.flipHorizontally,flipVertically:l.flipVertically})))}}}else this.updateSpriteStateFromHistory(e)});this.addNewText=(e,t)=>I(this,null,function*(){if(this.textToolStore.doesTextAssetExist(t.identifier))yield this.addTextAsync(p(p({},e),{state:t}),!1);else throw new Error(`Text identifier ${t.identifier} doesn't exist`)});this.addNewTextDesign=(e,t)=>I(this,null,function*(){if(this.textDesignToolStore.doesTextDesignAssetExist(t.identifier))yield this.addTextDesignAsync(p(p({},e),{state:t}),!1);else throw new Error(`TextDesign identifier ${t.identifier} doesn't exist`)});this.addNewSticker=(e,t)=>I(this,null,function*(){if(this.stickerToolStore.doesStickerAssetExist(t.identifier))yield this.addStickerAsync(p(p({},e),{state:t}),!1);else throw new Error(`Sticker identifier ${t.identifier} doesn't exist`)});this.updateSpriteStateFromHistory=e=>I(this,null,function*(){Object.keys(this.container).forEach(t=>{const i=e.common?e.common[t]:void 0,r=e.sticker?e.sticker[t]:void 0,o=e.text?e.text[t]:void 0,n=e.textdesign?e.textdesign[t]:void 0,a=this.state.get(t);if(a&&i){this.state.set(t,a);const l=this.container[t];l.setPosition(new D(i.position)),l.setRotation(i.rotation),a.rotation=l.getRotation(),i.flipHorizontally!==void 0&&l.setFlipHorizontally(i.flipHorizontally),i.flipVertically!==void 0&&l.setFlipVertically(i.flipVertically),r?(l.setSizeInWorldSpace(i.size),this.stickerToolStore.updateStateFromHistory(t,r)):o?this.textToolStore.updateStateFromHistory(t,p(p({},o),{fontIdentifier:o.identifier})):n&&this.textDesignToolStore.updateStateFromHistory(t,p(p({},n),{inverted:n.isInverted})),this.updatePositionAndSize(t)}})});this.getSpriteHistoryState=()=>{const e=C.toJS(this.state),t=C.toJS(this.textToolStore.state),i=C.toJS(this.textDesignToolStore.state),r={common:e,[f.STICKER]:C.toJS(this.stickerToolStore.state),[f.TEXT]:t,[f.TEXT_DESIGN]:i,spriteIdList:Object.keys(this.container)};return Object.keys(r.common).forEach(o=>{r.common[o].size=this.container[o].getSizeInWorldSpace(),r.common[o].position=this.container[o].getPosition(),r.common[o].order=this.container[o].getIndexInParent()}),r};this.updateStateFromSerialization=(e,t)=>I(this,null,function*(){if(t&&t.length)try{const i=t.map(o=>hs(o.raster.data,!0)),r=yield Promise.all(i);yield this.stickerToolStore.addCustomStickerAsset(t.map((o,n)=>({image:r[n].image,smallImage:r[n].smallImage,name:o.name,type:o.raster.type,id:o.identifier})))}catch(i){this.editor.modalStore.hideModal(),this.editor.modalStore.showInfoModal("stickerLoading")}for(let i=0;i<e.spriteIdList.length;i+=1){const r=e.spriteIdList[i],o=e.common?e.common[r]:void 0,n=e.sticker?e.sticker[r]:void 0,a=e.text?e.text[r]:void 0,l=e.textdesign?e.textdesign[r]:void 0;if(o){let{size:c}=o;c&&(c={width:this.editor.worldToPreview(o.size.width),height:this.editor.worldToPreview(o.size.height)});const{flipHorizontally:d,flipVertically:u}=this.editor.outputContainer.getData(),h=this.editor.outputContainer.getRotation(),y=u!==d?o.rotation-h:o.rotation+h,k=u!==d?-y:y,w={spriteId:r,transform:{size:c,position:o.position,rotation:k}};if(a){const T=this.textToolStore.validFontWithConfig(a.identifier);a.identifier=T==null?void 0:T.identifier,yield this.addNewText(w,a)}else l?yield this.addNewTextDesign(w,l):n&&(yield this.addNewSticker(w,p(p({},n),{flipHorizontally:o.flipHorizontally,flipVertically:o.flipVertically})))}}});this.updateCanvasControls=()=>{Object.keys(this.container).forEach(e=>{this.updatePositionAndSize(e,!0);const t=this.state.get(e);if(t){if(t.tool===f.TEXT){const i=this.getContainerProperties(e);this.textToolStore.changeSize(e,i)}else if(t.tool===f.TEXT_DESIGN){const i=this.getContainerProperties(e);this.textToolStore.changeWidth(i.width)}}})};this.setEditMode=e=>{this.currentSprite&&([f.TEXT,f.TEXT_DESIGN].indexOf(this.tool)!==-1&&(e?this.editor.modalStore.showTextEditModal():this.editor.modalStore.hideModal(),this.editMode.set(e)))};this.setDragMode=e=>{this.dragMode.set(e)};this.setPosition=e=>{const t=this.currentSprite,i=this.container[this.id];if(t&&i){i.setPosition(this.editor.previewToWorld(e));const{position:r}=this.getSizePositionFromContainer();t.position.x=r.x,t.position.y=r.y,this.state.set(this.id,t),this.editor.render()}};this.setSize=e=>{const t=this.currentSprite;t&&(t.size.width=e.width,t.size.height=e.height,this.state.set(this.id,t))};this.setRotation=e=>{const t=this.currentSprite;if(t){const{flipHorizontally:i,flipVertically:r}=this.editor.outputContainer.getData(),o=this.editor.outputContainer.getRotation(),n=Dr({rotation:e+o,flipHorizontally:i,flipVertically:r});this.container[this.id].setRotation(n),t.rotation=this.container[this.id].getRotation(),this.state.set(this.id,t),this.editor.render()}};this.onCanvasClick=e=>{this.isEditMode||this.selectHighestOrderSprite(e)};this.select=e=>{const t=this.state.get(e);if(t){const i=this.editor.activeStore.tool;i!==t.tool&&this.editor.activeStore.selectTool(t.tool),this.selectedId.set(e)}};this.selectLast=()=>{const e=this.editor.orderHelper.getLastSpriteId();e&&this.select(e)};this.selectNext=()=>{if(this.currentSprite){const e=this.container[this.id],t=e.getIndexInParent();if(t){const i=Object.keys(this.container).find(r=>this.container[r].getIndexInParent()===t-1);i&&this.select(i)}}};this.deselect=()=>{this.selectedId.set(xo)};this.bringToFront=e=>{const t=this.editor.orderHelper.bringToFront(e);this.container[e].setIndexInParent(t),this.spriteSnapshot("order"),this.editor.render()};this.flipHorizontally=e=>{const t=this.state.get(e),i=this.container[e];i.setFlipHorizontally(!i.getFlipHorizontally()),t.flipHorizontally=i.getFlipHorizontally(),this.spriteSnapshot("flip"),this.state.set(e,t),this.editor.render()};this.pureReset=()=>{this.selectedId.set(xo),Array.from(this.state.keys()).forEach(e=>{this.pureRemoveSprite(e)}),this.stickerToolStore.pureReset(),this.textToolStore.pureReset(),this.textDesignToolStore.pureReset()};this.selectHighestOrderSprite=e=>{const t=this.editor.brushToolStore.containerId();if(e=e.filter(o=>o!==t),e.length<1){this.deselect();return}let i="",r=0;e.forEach(o=>{const n=this.container[o],a=n&&n.getIndexInParent()||0;a>=r&&(r=a,i=o)}),this.select(i)};this.onCornerDrag=({x:e,y:t})=>{if(this.currentSprite){const i=new D(this.currentSprite.position),r=new D(e,t),o=r.subtract(i).magnitude,n=this.getSize(),a=o*2/_.sizeMagnitude(n);if(o>this.minLength)if(this.isSpriteSticker)if(this.stickerToolStore.resizeMode!=="unrestricted")this.setStickerSize({width:n.width*a,height:n.height*a});else{const l=this.rotationWRTOutputRotation,c=r.subtract(i),d=Math.cos(l),u=Math.sin(l),h=Math.max(Math.abs(c.x*d*2+c.y*u*2),this.minLength),y=Math.max(Math.abs(c.x*-u*2+c.y*d*2),this.minLength);this.setStickerSize({width:h,height:y})}else this.isSpriteText?this.setTextSize(n.width*a):this.isSpriteTextDesign&&this.setTextDesignScale(a);this.editor.render()}};this.onWidthDrag=({x:e,y:t})=>{const i=new D(this.currentSprite.position),r=new D(e,t),o=r.subtract(i).magnitude,n=this.editor.previewToWorld(2*o);if(n>this.minLength&&(this.setContainerProperties(this.id,{width:n},!0),this.isSpriteText)){const a=this.getContainerProperties(this.id);this.textToolStore.changeWidth(a.width)}};this.onPaddingDrag=({x:e,y:t})=>{if(this.isSpriteTextDesign){let i=this.getContainerProperties(this.id);const r=new D(this.currentSprite.position),o=new D(e,t),n=o.subtract(r).magnitude,a=Math.max(this.editor.previewToWorld(n)-i.width/2,0);this.setContainerProperties(this.id,{padding:a},!0),this.isSpriteTextDesign&&(i=this.getContainerProperties(this.id),this.textDesignToolStore.changePadding(i.padding))}};this.correctTextFlip=()=>{const{flipHorizontally:e,flipVertically:t}=this.editor.outputContainer.getData();Object.values(this.container).forEach(i=>{(i.type==="text"||i.type==="text-design")&&(i.setFlipHorizontally(e),i.setFlipVertically(t))})};this.reverseTextHorizontally=()=>{Object.values(this.container).forEach(e=>{(e.type==="text"||e.type==="text-design")&&e.setFlipHorizontally(!e.getFlipHorizontally())})};this.reverseTextVertically=()=>{Object.values(this.container).forEach(e=>{(e.type==="text"||e.type==="text-design")&&e.setFlipVertically(!e.getFlipVertically())})};this.getOutputProperties=()=>this.editor.outputContainer.getData();this.getContainerProperties=e=>this.container[e].getData();this.getContainerTransform=e=>this.container[e].getTransform();this.getDuplicateContainerTransform=e=>{const t=this.container[e].getTransform(),i=this.editor.shortestOutputSide*.1,r=new D(t.position).add(new D(i,i));return p(p({},t),{position:r})};this.getDuplicateContainerFlip=e=>{const t=this.container[e].getFlipHorizontally(),i=this.container[e].getFlipVertically();return{flipHorizontally:t,flipVertically:i}};this.updatePositionAndSize=(e=this.id,t=!1)=>{const{position:i,size:r}=this.getSizePositionFromContainer(e),o=this.state.get(e);if(o){if(o.position.x=i.x,o.position.y=i.y,o.size.width=r.width,o.size.height=r.height,t){const n=this.container[e].getRotation();this.container[e].setRotation(n),o.rotation=this.container[e].getRotation()}this.state.set(e,o)}};this.getInitialTransform=e=>{const t=this.editor.outputToWorld(hm.position);if(!e){const i=this.editor.outputContainer.getRotation();return{rotation:i,position:t}}return p({position:t},e)};this.setInitialSpriteState=(e,t)=>{const i=this.container[e],{position:r,size:o}=this.getSizePositionFromContainer(e),n=i.getRotation(),a=t!==f.STICKER?!1:i.getFlipHorizontally(),l=t!==f.STICKER?!1:i.getFlipVertically();this.state.set(e,{tool:t,position:r,rotation:n,size:o,flipHorizontally:a,flipVertically:l})};this.setStickerSize=e=>{const t=this.container[this.id];t.setSizeInWorldSpace(this.editor.previewSizeToWorld(e));const i=this.currentSprite;i&&(i.size=this.editor.worldSizeToPreview(t.getSizeInWorldSpace()),this.state.set(this.id,i))};this.setTextSize=e=>{let t=this.getContainerProperties(this.id);const i={width:this.editor.previewToWorld(e)},r=i.width/t.width,o={fontSize:Math.round(t.fontSize*r)},n=this.isSpriteText?p(p({},i),o):i;i.width>this.minLength&&o.fontSize&&(this.setContainerProperties(this.id,n,!0),t=this.getContainerProperties(this.id),this.textToolStore.changeFontSize(t.fontSize,!0),this.textToolStore.changeWidth(t.width))};this.setTextDesignScale=e=>{let t=this.getContainerProperties(this.id);const i=t.width*e;if(i>this.minLength){this.setContainerProperties(this.id,{width:i},!0);const{width:r}=this.getContainerProperties(this.id);this.textDesignToolStore.changeWidth(r),t=this.getContainerProperties(this.id),this.textDesignToolStore.changePadding(t.padding)}};this.getSizePositionFromContainer=(e=this.id)=>{const t=this.container[e];if(t){const i=this.editor.worldToPreview(t.getPosition()),r=this.editor.worldSizeToPreview(t.getSizeInWorldSpace());return{position:i,size:r}}return{position:{x:0,y:0},size:{height:1,width:1}}};this.getSize=(e=this.id)=>{const t=this.container[e];return t?this.editor.worldSizeToPreview(t.getSizeInWorldSpace()):{width:0,height:0}};this.editor=e,this.container={},this.stickerToolStore=new U(e),this.textToolStore=new A(e),this.textDesignToolStore=new V(e),this.rect=new J(this.editor,this),this.minLength=this.editor.configStore.measurements.canvasControls.sprite.minSize/Math.sqrt(2)}static magnitude(e,t){return new D(e,t||e).magnitude}static sizeMagnitude(e){return Math.sqrt(e.width*e.width+e.height*e.height)}get serializableState(){const e=this.editor.spriteStore.getSpriteHistoryState();Object.keys(e.common).forEach(r=>{const{flipHorizontally:o,flipVertically:n}=this.editor.outputContainer.getData(),a=this.editor.outputContainer.getRotation(),l=n!==o?-e.common[r].rotation:e.common[r].rotation;e.common[r].rotation=n!==o?l+a:l-a});const t=this.editor.spriteStore.stickerToolStore.customStickerIds,i=t.map(({identifier:r,type:o})=>{const n=this.editor.spriteStore.stickerToolStore.items.find(a=>r===a.identifier);if(n){const a=this.editor.assetProvider.getStickerAsset(n.identifier);return{identifier:r,raster:{type:o,name:n.name,data:a.stickerURI}}}return}).filter(Boolean);return{sprite:e,customStickers:i}}get currentSprite(){return this.isSpriteSelected?this.state.get(this.id):void 0}get padding(){return this.textDesignToolStore.padding}get isEditMode(){return this.editMode.get()}get isDragMode(){return this.dragMode.get()}get id(){return this.selectedId.get()}get isSpriteSelected(){return this.id!==xo}get position(){return this.currentSprite?this.currentSprite.position:void 0}get tool(){return this.currentSprite?this.currentSprite.tool:void 0}get size(){return this.currentSprite?this.currentSprite.size:void 0}get rotation(){return this.currentSprite?this.currentSprite.rotation:void 0}get rotationWRTOutputRotation(){if(this.currentSprite){const{flipHorizontally:e,flipVertically:t}=this.editor.outputContainer.getData(),i=this.editor.outputContainer.getRotation();return Dr({rotation:this.currentSprite.rotation-i,flipHorizontally:e,flipVertically:t})}return}get flipHorizontal(){return this.currentSprite?this.currentSprite.flipHorizontally:void 0}get isSpriteSticker(){return this.tool===f.STICKER}get isSpriteText(){return this.tool===f.TEXT}get isSpriteTextDesign(){return this.tool===f.TEXT_DESIGN}get spritePosition(){if(this.currentSprite){const{x:e,y:t}=this.currentSprite.position,{height:i,width:r}=this.currentSprite.size;return{x:Math.round(e-r/2),y:Math.round(t-i/2)}}return}get currentRect(){return this.currentSprite?this.rect:void 0}get leftTopPosition(){return this.currentSprite?this.rect.leftTop:void 0}get leftBottomPosition(){return this.currentSprite?this.rect.leftBottom:void 0}get leftMidPosition(){return this.currentSprite?this.rect.leftMid:void 0}get leftMidPadPosition(){if(this.currentSprite){const{leftMid:e}=this.rect;return{x:e.x-this.editor.worldToPreview(this.padding),y:e.y}}return}get rightTopPosition(){return this.currentSprite?this.rect.rightTop:void 0}get rightBottomPosition(){return this.currentSprite?this.rect.rightBottom:void 0}get rightMidPosition(){return this.currentSprite?this.rect.rightMid:void 0}get rightMidPadPosition(){if(this.currentSprite){const{rightMid:e}=this.rect;return{x:e.x+this.editor.worldToPreview(this.padding),y:e.y}}return}get leftBottomHandlePosition(){return this.currentSprite?this.rect.leftBottomHandle:void 0}get rightBottomHandlePosition(){return this.currentSprite?this.rect.rightBottomHandle:void 0}get historyLocale(){return this.isSpriteSticker?this.stickerLocale:this.isSpriteText?this.textDesignLocale:this.textLocale}get stickerLocale(){return this.editor.configStore.locale[f.STICKER].history}get textLocale(){return this.editor.configStore.locale[f.TEXT].history}get textDesignLocale(){return this.editor.configStore.locale[f.TEXT_DESIGN].history}}s([C.action],_.prototype,"addSticker",2),s([C.action],_.prototype,"addStickerAsync",2),s([C.action],_.prototype,"addText",2),s([C.action],_.prototype,"addTextAsync",2),s([C.action],_.prototype,"addTextDesign",2),s([C.action],_.prototype,"addTextDesignAsync",2),s([C.action],_.prototype,"clickableCanvas",2),s([C.action],_.prototype,"setContainerProperties",2),s([C.action],_.prototype,"setContainerPosition",2),s([C.action],_.prototype,"pureRemoveSprite",2),s([C.action],_.prototype,"deleteSprite",2),s([C.action],_.prototype,"removeSprite",2),s([C.action],_.prototype,"addSnapshot",2),s([C.action],_.prototype,"updateStateFromHistory",2),s([C.action],_.prototype,"addNewText",2),s([C.action],_.prototype,"addNewTextDesign",2),s([C.action],_.prototype,"addNewSticker",2),s([C.action],_.prototype,"updateSpriteStateFromHistory",2),s([C.action],_.prototype,"updateStateFromSerialization",2),s([C.action],_.prototype,"updateCanvasControls",2),s([C.action],_.prototype,"setEditMode",2),s([C.action],_.prototype,"setDragMode",2),s([C.action],_.prototype,"setPosition",2),s([C.action],_.prototype,"setSize",2),s([C.action],_.prototype,"setRotation",2),s([C.action],_.prototype,"onCanvasClick",2),s([C.action],_.prototype,"select",2),s([C.action],_.prototype,"selectLast",2),s([C.action],_.prototype,"selectNext",2),s([C.action],_.prototype,"deselect",2),s([C.action],_.prototype,"bringToFront",2),s([C.action],_.prototype,"flipHorizontally",2),s([C.action],_.prototype,"pureReset",2),s([C.action],_.prototype,"onCornerDrag",2),s([C.action],_.prototype,"onWidthDrag",2),s([C.action],_.prototype,"onPaddingDrag",2),s([C.action],_.prototype,"correctTextFlip",2),s([C.action],_.prototype,"reverseTextHorizontally",2),s([C.action],_.prototype,"reverseTextVertically",2),s([C.computed],_.prototype,"currentSprite",1),s([C.computed],_.prototype,"padding",1),s([C.computed],_.prototype,"isEditMode",1),s([C.computed],_.prototype,"isDragMode",1),s([C.computed],_.prototype,"id",1),s([C.computed],_.prototype,"isSpriteSelected",1),s([C.computed],_.prototype,"position",1),s([C.computed],_.prototype,"tool",1),s([C.computed],_.prototype,"size",1),s([C.computed],_.prototype,"rotation",1),s([C.computed],_.prototype,"rotationWRTOutputRotation",1),s([C.computed],_.prototype,"flipHorizontal",1),s([C.computed],_.prototype,"isSpriteSticker",1),s([C.computed],_.prototype,"isSpriteText",1),s([C.computed],_.prototype,"isSpriteTextDesign",1),s([C.computed],_.prototype,"spritePosition",1),s([C.computed],_.prototype,"currentRect",1),s([C.computed],_.prototype,"leftTopPosition",1),s([C.computed],_.prototype,"leftBottomPosition",1),s([C.computed],_.prototype,"leftMidPosition",1),s([C.computed],_.prototype,"leftMidPadPosition",1),s([C.computed],_.prototype,"rightTopPosition",1),s([C.computed],_.prototype,"rightBottomPosition",1),s([C.computed],_.prototype,"rightMidPosition",1),s([C.computed],_.prototype,"rightMidPadPosition",1),s([C.computed],_.prototype,"leftBottomHandlePosition",1),s([C.computed],_.prototype,"rightBottomHandlePosition",1),s([C.computed],_.prototype,"historyLocale",1),s([C.computed],_.prototype,"stickerLocale",1),s([C.computed],_.prototype,"textLocale",1),s([C.computed],_.prototype,"textDesignLocale",1);const sc=m(b()),mt={position:{x:0,y:0},size:{height:0,width:0},lockResolution:!1,forceDimensions:!1,ratio:"*"},ac={identifier:"identity",outputRotation:0,rotationInDegrees:0,flipHorizontally:!1,flipVertically:!1,cropState:sc.observable.map({})};const N=m(b());class H{constructor(e,t){this.minCropSize=0;this.state=ac,this.configStore=e.configStore,this.minCropSize=this.configStore.measurements.crop.minSize,this.defaults=t}changeIdentifier(e){this.state.identifier=e;const t=this.state.cropState.get(e);t||this.state.cropState.set(e,p({},mt))}changeRatio(e){const t=this.state.cropState.get(this.identifier);t&&this.state.cropState.set(this.identifier,p(p({},t),{ratio:e}))}changeSize(e){const t=this.state.cropState.get(this.identifier);t&&(e.width&&e.width>0&&(t.size.width=Math.round(e.width)),e.height&&e.height>0&&(t.size.height=Math.round(e.height)),this.state.cropState.set(this.identifier,t))}changeHeight(e){const t=this.state.cropState.get(this.identifier);t&&(e&&(t.size.height=Math.round(e),this.state.cropState.set(this.identifier,t)))}changeWidth(e){const t=this.state.cropState.get(this.identifier);t&&(e&&(t.size.width=Math.round(e),this.state.cropState.set(this.identifier,t)))}changePositionX(e,t){const i=this.state.cropState.get(this.identifier);return i&&e<=t-this.minCropSize&&e>=0?(i.position.x=Math.round(e),this.state.cropState.set(this.identifier,i),!0):!1}changePositionY(e,t){const i=this.state.cropState.get(this.identifier);return i&&e<=t-this.minCropSize&&e>=0?(i.position.y=Math.round(e),this.state.cropState.set(this.identifier,i),!0):!1}changePosition(e,t){const i=this.state.cropState.get(this.identifier);return i&&(e.x<=t.width-this.minCropSize&&e.x>=0&&e.y<=t.height-this.minCropSize&&e.y>=0)?(i.position.x=Math.round(e.x),i.position.y=Math.round(e.y),this.state.cropState.set(this.identifier,i),!0):!1}changeLockResolution(e){const t=this.state.cropState.get(this.identifier);t&&(t.lockResolution=e!==void 0?e:!t.lockResolution,this.state.cropState.set(this.identifier,t))}changeForceDimensions(e){const t=this.state.cropState.get(this.identifier);t&&(t.forceDimensions=e,this.state.cropState.set(this.identifier,t))}setRotation(e){this.state.rotationInDegrees=e}resetRotation(){this.state.rotationInDegrees=0}resetOutputRotation(){this.state.outputRotation=0}resetFlip(){this.state.flipHorizontally=!1,this.state.flipVertically=!1}updateFlip({flipHorizontally:e,flipVertically:t}){this.state.flipHorizontally=e,this.state.flipVertically=t}setOutputRotation(e){this.state.outputRotation=e}flipHorizontally(){this.state.flipHorizontally=!this.state.flipHorizontally}flipVertically(){this.state.flipVertically=!this.state.flipVertically}get flipCenter(){const{width:e,height:t}=this.defaults.maxCropMaskSize;return new D(e/2,t/2)}get isFlippedHorizontal(){return this.state.flipHorizontally}get isFlippedVertical(){return this.state.flipVertically}get identifier(){return this.state.identifier}get height(){return this.selectedCrop?this.selectedCrop.size.height:mt.size.height}get width(){return this.selectedCrop?this.selectedCrop.size.width:mt.size.width}get position(){return this.selectedCrop?this.selectedCrop.position:mt.position}get ratio(){return this.selectedCrop?this.selectedCrop.ratio:mt.ratio}get size(){return this.selectedCrop?this.selectedCrop.size:mt.size}get x(){return this.selectedCrop?this.selectedCrop.position.x:mt.position.x}get y(){return this.selectedCrop?this.selectedCrop.position.y:mt.position.y}get lockResolution(){return this.selectedCrop?this.selectedCrop.lockResolution:mt.lockResolution}get forceDimensions(){return this.selectedCrop?this.selectedCrop.forceDimensions:mt.forceDimensions}get selectedCrop(){return this.state.cropState.get(this.identifier)}get rotationInDegrees(){return this.state.rotationInDegrees}get outputRotation(){return this.state.outputRotation}}s([N.observable],H.prototype,"state",2),s([N.action],H.prototype,"changeIdentifier",1),s([N.action],H.prototype,"changeRatio",1),s([N.action],H.prototype,"changeSize",1),s([N.action],H.prototype,"changeHeight",1),s([N.action],H.prototype,"changeWidth",1),s([N.action],H.prototype,"changePositionX",1),s([N.action],H.prototype,"changePositionY",1),s([N.action],H.prototype,"changePosition",1),s([N.action],H.prototype,"changeLockResolution",1),s([N.action],H.prototype,"changeForceDimensions",1),s([N.action],H.prototype,"setRotation",1),s([N.action],H.prototype,"resetRotation",1),s([N.action],H.prototype,"resetOutputRotation",1),s([N.action],H.prototype,"resetFlip",1),s([N.action],H.prototype,"updateFlip",1),s([N.action],H.prototype,"setOutputRotation",1),s([N.action],H.prototype,"flipHorizontally",1),s([N.action],H.prototype,"flipVertically",1),s([N.computed],H.prototype,"flipCenter",1),s([N.computed],H.prototype,"isFlippedHorizontal",1),s([N.computed],H.prototype,"isFlippedVertical",1),s([N.computed],H.prototype,"identifier",1),s([N.computed],H.prototype,"height",1),s([N.computed],H.prototype,"width",1),s([N.computed],H.prototype,"position",1),s([N.computed],H.prototype,"ratio",1),s([N.computed],H.prototype,"size",1),s([N.computed],H.prototype,"x",1),s([N.computed],H.prototype,"y",1),s([N.computed],H.prototype,"lockResolution",1),s([N.computed],H.prototype,"forceDimensions",1),s([N.computed],H.prototype,"selectedCrop",1),s([N.computed],H.prototype,"rotationInDegrees",1),s([N.computed],H.prototype,"outputRotation",1);const Ir=m(b());class lc{constructor(e){this.transforms={output:JSON.stringify(Qt.IDENTITY),preview:JSON.stringify(Qt.IDENTITY)};this.editor=e,this.overlayOpacity=0,this.frameOpacity=0}static rotateOutput(e,t){e%=360;switch(e){case 90:case-270:return t.swapped.multiply(-1,1);case 180:case-180:return t.multiply(-1);case 270:case-90:return t.swapped.multiply(1,-1);default:return t}}onLeave(){const{flipHorizontally:e,flipVertically:t,rotation:i,outputRotation:r}=this.transformToolStore.rotateFlipState;this.editor.overlayToolStore.identifier!=="identity"&&this.editor.overlayToolStore.changeOpacity(this.overlayOpacity),this.editor.frameToolStore.identifier!=="identity"&&this.editor.frameToolStore.changeOpacity(this.frameOpacity);const o=this.editor.previewToWorld(new D(this.transformToolStore.leftTopRespectFlip).add(new D(this.transformToolStore.rightBottomRespectFlip)).divide(2).add(new D(this.transformToolStore.unRotatedDefaults.cropMaskPosition)),!0),n=this.engineMediator.preview.container,{outputContainer:a}=this.editor;a.setResolution(Ir.toJS(this.transformToolStore.localOutputImageSize)),a.setData({flipVertically:t,flipHorizontally:e});const l=n.getScale();this.editor.overlayToolStore.correctOverlayFlip(),this.saveTransforms();let c=1;if(this.transformToolStore.lockResolution){const{cropMaskSize:k,defaultImageSize:w}=this.transformToolStore,T=this.transformToolStore.maxCropMaskSize,F={height:k.height*w.height/T.height,width:k.width*w.width/T.width};c=F.width/this.transformToolStore.localOutputImageSize.width}const d=Math.abs(l.x),u=c/(d/this.transformToolStore.defaultScale),h={x:u,y:u},y=-(i-r);a.setTransform({scale:h,position:o,rotation:y}),this.editor.engineMediator.preview.updateTransform(0,!1),this.editor.scale.setInitialTransform(),this.editor.spriteStore.updateCanvasControls(),this.editor.focusToolStore.updateCanvasControls()}onEnter(){this.editor.overlayToolStore.identifier!=="identity"&&(this.overlayOpacity=this.editor.overlayToolStore.opacity,this.editor.overlayToolStore.changeOpacity(0)),this.editor.frameToolStore.identifier!=="identity"&&(this.frameOpacity=this.editor.frameToolStore.opacity,this.editor.frameToolStore.changeOpacity(0)),this.editor.scale.setScaleToDefault();const e=this.engineMediator.preview.container,{outputContainer:t}=this.editor,i=JSON.parse(this.transforms.preview);t.setResolution(Ir.toJS(this.transformToolStore.defaultImageSize)),e.setTransform(i),t.setTransform(JSON.parse(this.transforms.output));const r=i.scale;t.setData({flipVertically:!1,flipHorizontally:!1}),this.transformToolStore.transformStore.updateFlip({flipVertically:r.y<0,flipHorizontally:r.x<0}),this.engineMediator.preview.savePreviewTransform(i);const{scale:o}=this.engineMediator.preview.calculateTransform();this.editor.scale.setInitialTransform(o.x)}rotateOutputContainer(e=!1){this.editor.outputContainer.rotate90(e),this.transformToolStore.transformStore.setOutputRotation(this.editor.outputContainer.getRotation());const{rotation:t}=this.transformToolStore.rotateFlipState;this.engineMediator.preview.updateTransform(t),Ir.runInAction(()=>{this.editor.scale.setInitialTransform();const i=this.getScaleWithFlip(t);this.engineMediator.preview.container.setScale(i),this.transformToolStore.setCropDefaults(!0),this.transformToolStore.updateCropMask()}),this.editor.render()}applyPreviewTransform(){const{rotation:e,flipHorizontally:t,flipVertically:i}=this.transformToolStore.rotateFlipState,r=this.editor.scale.getPositionWithOffset(),o=this.getScaleWithFlip();let n=e;t&&(n=Kn(n)),i&&(n=Kn(n));const a={position:r,rotation:n,scale:o};this.engineMediator.preview.savePreviewTransform(a),this.engineMediator.preview.container.setTransform(a)}getScaleWithFlip(e=this.transformToolStore.rotateFlipState.rotation){const{flipHorizontally:t,flipVertically:i}=this.transformToolStore.rotateFlipState,r=t?-1:1,o=i?-1:1,n=this.editor.scale.calculateScale(e);return{x:n*r,y:n*o}}saveTransforms(){const e=JSON.stringify(this.engineMediator.preview.container.getTransform()),t=JSON.stringify(this.editor.outputContainer.getTransform());this.transforms={preview:e,output:t}}saveTransformsBasedOnFlip(){const e=this.engineMediator.preview.container.getTransform(),{scale:t}=e,{flipVertically:i,flipHorizontally:r}=this.editor.outputContainer.getData(),o=JSON.stringify(this.editor.outputContainer.getTransform());this.transforms={preview:JSON.stringify(p(p({},e),{scale:{x:r?-t.x:t.x,y:i?-t.y:t.y}})),output:o}}get engineMediator(){return this.editor.engineMediator}get transformToolStore(){return this.editor.transformToolStore}}const v=m(b()),cc="identity";class S{constructor(e){this.unRotatedDefaults={cropMaskPosition:{x:0,y:0},scale:1};this.defaultAngle=0;this.dragMode=v.observable.box(!1);this.minCropSize=0;this.localSnapshotEnabled=!0;this.defaults={cropMaskPosition:{x:0,y:0},maxCropMaskSize:{width:0,height:0},imageSize:{width:0,height:0},scale:1};this.localOutputSize={width:0,height:0};this.checkIfTransformThumbnailExits=e=>{let t=this.editor.configStore.config.assetBaseUrl;const{length:i}=t;if(t[i-1]!=="/"&&(t+="/"),`${t}transform/`===e)return!1;const r=new Image;try{return r.src=e,!0}catch(o){return!1}};this.reset=()=>{this.transformStore.resetRotation(),this.transformStore.resetOutputRotation(),this.transformStore.resetFlip(),this.editor.spriteStore.correctTextFlip(),this.editor.overlayToolStore.correctOverlayFlip(),this.setDefaultAngle(0);const e=this.editor.outputContainer.getRotation();e!==0&&this.engineMediator.output.applyNewImageTransform(),this.engineMediator.output.container.setData({flipHorizontally:!1,flipVertically:!1}),this.engineMediator.preview.updateTransform(),this.editor.scale.setInitialTransform(),this.setCropDefaults(),this.applyInitialCrop(),this.editor.render()};this.changeLocalOutputSize=e=>{this.localOutputSize.height=Math.round(e.height),this.localOutputSize.width=Math.round(e.width)};this.changeDefaultScale=e=>{this.defaults.scale=e};this.changeLocalOutputHeight=e=>{this.localOutputSize.height=Math.round(e)};this.changeLocalOutputWidth=e=>{this.localOutputSize.width=Math.round(e)};this.changeLockResolution=()=>{this.transformStore.changeLockResolution(),this.addLocalSnapshot()};this.rotateClockwise=()=>{this.rotateOutputContainer(this.isFlippedVertical!==this.isFlippedHorizontal)};this.rotateAntiClockwise=()=>{this.rotateOutputContainer(this.isFlippedVertical===this.isFlippedHorizontal)};this.flipHorizontally=(e=!0)=>{this.transformStore.flipHorizontally(),this.editor.spriteStore.reverseTextHorizontally(),this.transformRender(e),e&&this.addLocalSnapshot()};this.flipVertically=(e=!0)=>{this.transformStore.flipVertically(),this.editor.spriteStore.reverseTextVertically(),this.transformRender(e),e&&this.addLocalSnapshot()};this.applyDefaultCrop=(e=!1)=>{if(this.identifier==="identity"){const{identifier:t}=this.getMatchingItem();this.changeIdentifier(t,e)}};this.updateCropMask=()=>{this.changeIdentifier(this.identifier,!0)};this.onLeftTop=({x:e,y:t})=>{const i=this.getRatio(),r=this.rightBottom,{minCropMaskSize:o,maxCropMaskSize:n}=this,a=Math.min(Math.max(0,e),r.x-o.width),l=Math.min(Math.max(0,t),r.y-o.height),c=r.x-a,d=r.y-l,u={width:Math.max(this.minCropSize,Math.min(c,n.width-a)),height:Math.max(this.minCropSize,Math.min(d,n.height-l))};if(i==="*")this.changePosition({x:a,y:l})&&this.changeCropAndOutputSize(u);else{const h=this.proportionalSize(i,u),y=new D(r).rounded.subtract({x:h.width,y:h.height});this.changePosition(y)&&this.changeCropAndOutputSize(h)}};this.onLeftBottom=({x:e,y:t})=>{const i=this.getRatio(),r=this.rightTop,{minCropMaskSize:o,maxCropMaskSize:n}=this,a=Math.min(Math.max(0,e),r.x-o.width),l=Math.max(0,t,r.y+o.height),c=r.x-a,d=l-r.y,u={width:Math.max(1,Math.min(c,n.width-a)),height:Math.max(1,Math.min(d,n.height-r.y))};if(i==="*"){const h=this.changeCropAndOutputSize(u);h&&this.changePositionX(a)}else{const h=this.proportionalSize(i,u);this.changePositionX(Math.round(r.x)-h.width)&&this.changeCropAndOutputSize(h)}};this.onRightTop=({x:e,y:t})=>{const i=this.getRatio(),r=this.leftBottom,{minCropMaskSize:o,maxCropMaskSize:n}=this,a=Math.max(0,e,r.x+o.width),l=Math.min(Math.max(0,t),r.y-o.height),c=a-r.x,d=r.y-l,u={width:Math.max(1,Math.min(c,n.width-r.x)),height:Math.max(1,Math.min(d,n.height-l))};if(i==="*")this.changePositionY(l)&&this.changeCropAndOutputSize(u);else{const h=this.proportionalSize(i,u);this.changePositionY(Math.round(r.y)-h.height)&&this.changeCropAndOutputSize(h)}};this.onRightBottom=({x:e,y:t})=>{const i=this.getRatio(),r=this.leftTop,{minCropMaskSize:o,maxCropMaskSize:n}=this,a=Math.max(0,e,r.x+o.width),l=Math.max(0,t,r.y+o.height),c=a-r.x,d=l-r.y,u={width:Math.max(1,Math.min(c,n.width-r.x)),height:Math.max(1,Math.min(d,n.height-r.y))};if(i==="*")this.changeCropAndOutputSize(u);else{const h=this.proportionalSize(i,u);this.changeCropAndOutputSize(h)}};this.onPixelWidth=e=>{const t=JSON.stringify(v.toJS(this.localOutputSize)),i=this.entityManager.items.find(o=>o.identifier===this.identifier),r=this.defaults.imageSize;if(i&&i.ratio){let o=e,n=this.localOutputSize.height,{ratio:a}=i;if(a==="*"&&this.lockResolution&&(a=this.localOutputSize.width/this.localOutputSize.height),a==="*"&&!this.lockResolution)o=Math.max(Math.min(e,r.width),this.minCropSize),this.changeLocalOutputWidth(o);else{const l=S.placeCropMask(a,r);o=Math.max(Math.min(o,l.width),this.minCropSize),n=o/a,this.changeLocalOutputSize({height:n,width:o})}return this.lockResolution||this.updatePreviewSizeWRTImageSize(),this.checkAndAddSnapshot(JSON.parse(t)),Math.round(o)}return e};this.onPixelHeight=e=>{const t=JSON.stringify(v.toJS(this.localOutputSize)),i=this.entityManager.items.find(o=>o.identifier===this.identifier),r=this.defaults.imageSize;if(i&&i.ratio){let o=e,n=this.localOutputSize.width,{ratio:a}=i;if(a==="*"&&this.lockResolution&&(a=this.localOutputSize.width/this.localOutputSize.height),a==="*"&&!this.lockResolution)o=Math.max(Math.min(e,r.height),this.minCropSize),this.changeLocalOutputHeight(o);else{const l=S.placeCropMask(a,r);o=Math.max(Math.min(o,l.height),this.minCropSize),n=o*a,this.changeLocalOutputSize({height:o,width:n})}return this.lockResolution||this.updatePreviewSizeWRTImageSize(),this.checkAndAddSnapshot(JSON.parse(t)),Math.round(o)}return e};this.closestRatioReducer=e=>(t,i)=>i===null||Math.abs(e-t.ratio)<Math.abs(e-i.ratio)?-1:1;this.closestDimensionsReducer=e=>(t,i)=>{if(i===null)return-1;const r=Math.abs(t.dimensions.x/t.dimensions.y),o=Math.abs(i.dimensions.x/i.dimensions.y);return r===o?t.dimensions.x*t.dimensions.y>i.dimensions.x*i.dimensions.y?-1:1:Math.abs(e-r)<Math.abs(e-o)?-1:1};this.getMatchingItem=()=>{const e=this.entityManager.items.findIndex(l=>l.identifier==="imgly_transform_common_custom");if(e!==-1)return this.entityManager.items[e];const t=this.entityManager.items.findIndex(l=>l.ratio==="*");if(t!==-1)return this.entityManager.items[t];const i=v.toJS(this.editor.outputContainer.getResolution()),r=Math.abs(i.width/i.height),[o]=this.entityManager.items.filter(l=>l.ratio&&typeof l.ratio=="number").sort(this.closestRatioReducer(r)),[n]=this.entityManager.items.filter(l=>l.dimensions&&!l.ratio).sort(this.closestDimensionsReducer(r));if(!o||!n||!o.ratio&&!n.dimensions)return this.entityManager.items[0];if(!n||!n.dimensions)return o;if(!o||!o.ratio)return n;const a=Math.abs(n.dimensions.x/n.dimensions.y);return a===o.ratio||Math.abs(r-o.ratio)<Math.abs(r-a)?o:n};this.getTransform=e=>{let t=this.entityManager.items.find(i=>i.identifier===e);return t||(t=this.getMatchingItem()),t};this.editor=e,this.selectedCategory=cc,this.transformStore=new H(e,this.defaults),this.transformations=new lc(e);const n=this.config,{enableRotation:t,enableFlip:i}=n,r=Ge(n,["enableRotation","enableFlip"]),o=this.editor.assetProvider.getAssets("transform");this.entityManager=new de(o,p(p({},r),{categoryKey:"",itemKey:"thumbnailURI",locale:p(p({},this.locale.items),this.locale.categories),getAssetPath:this.editor.getAssetPath("transform")})),this.rect=new J(this.editor,this.transformStore,"topLeft",!1,!1),this.rectForUi=new J(this.editor,this.transformStore,"topLeft",!1,!0),this.minCropSize=this.editor.configStore.measurements.crop.minSize}static inRadians(e){return e*Math.PI/180}static placeCropMask(e,t){if(t.height*e>t.width){const r=t.width/e;return{height:r,width:t.width,yChanged:!0}}const i=t.height*e;return{height:t.height,width:i,yChanged:!1}}changeIdentifier(e,t=!1){this.transformStore.changeIdentifier(e);const i=this.getCropMask(e,this.defaults.imageSize);i&&(this.transformStore.changeRatio(i.ratio),this.changeLocalOutputSize(i),this.updatePreviewSizeWRTImageSize(),i.yChanged!==void 0&&this.updateInitialCropMaskPosition(i.yChanged),i.dimensions&&this.changeLocalOutputSize({width:i.dimensions.x,height:i.dimensions.y}),t&&this.addLocalSnapshot())}setDragMode(e){this.dragMode.set(e)}getCropMask(e,t){const i=this.getTransform(e);if(i){const{ratio:r,forceDimensions:o,lockDimensions:n,dimensions:a=null}=i;if(o&&this.transformStore.changeForceDimensions(o),n&&this.transformStore.changeLockResolution(n),r)switch(r){case"*":return this.changePosition({x:0,y:0}),p(p({},t),{yChanged:void 0,ratio:"*",dimensions:a});default:return p(p({},S.placeCropMask(i.ratio,t)),{ratio:i.ratio,dimensions:a})}else{const{x:l,y:c}=i.dimensions;return p(p({},S.placeCropMask(l/c,t)),{ratio:null,dimensions:a})}}return null}setCropDefaults(e=!1){const t=this.editor.outputContainer.getResolution();this.setDefaultImageSize(t);const i=this.editor.getPreviewSize(),{position:r}=this.editor.engineMediator.preview.previewTransformWithoutDpr;this.setMaxCropSize(i),this.setDefaultCropPosition({x:r.x-i.width/2,y:r.y-i.height/2}),this.changeDefaultScale(this.editor.scale.defaultScale),e||(this.unRotatedDefaults.cropMaskPosition=this.defaultCropMaskPosition,this.unRotatedDefaults.scale=this.defaultScale)}setDefaultImageSize(e){this.defaults.imageSize=p({},v.toJS(e)),this.lockResolution||(this.localOutputSize=p({},v.toJS(e)))}setMaxCropSize(e){this.defaults.maxCropMaskSize.height=e.height,this.defaults.maxCropMaskSize.width=e.width}setDefaultCropPosition(e){this.defaults.cropMaskPosition.x=e.x,this.defaults.cropMaskPosition.y=e.y}resetCrop(){this.state.cropState=v.observable.map({}),this.state.identifier="identity"}toggleCategorySelection(e){this.selectedCategory=this.selectedCategory===e?cc:e}pureReset(){this.transformStore.resetRotation(),this.transformStore.resetOutputRotation(),this.transformStore.resetFlip(),this.editor.spriteStore.correctTextFlip(),this.editor.overlayToolStore.correctOverlayFlip(),this.resetCrop()}changePosition(e){return this.transformStore.changePosition(e,this.defaults.maxCropMaskSize)}changePositionX(e){return this.transformStore.changePositionX(e,this.defaults.maxCropMaskSize.width)}changePositionY(e){return this.transformStore.changePositionY(e,this.defaults.maxCropMaskSize.height)}changeCropAndOutputHeight(e){return e&&e>=this.minCropSize?(this.transformStore.changeHeight(e),this.lockResolution||this.changeLocalOutputHeight(e*this.defaults.imageSize.height/this.defaults.maxCropMaskSize.height),!0):!1}changeCropAndOutputWidth(e){return e&&e>=this.minCropSize?(this.transformStore.changeWidth(e),this.lockResolution||this.changeLocalOutputWidth(e*this.defaults.imageSize.width/this.defaults.maxCropMaskSize.width),!0):!1}changeCropAndOutputSize(e){const t=this.changeCropAndOutputHeight(e.height),i=this.changeCropAndOutputWidth(e.width);return{widthChanged:t,heightChanged:i}}transformRender(e=!0){this.transformations.applyPreviewTransform(),e&&this.editor.render()}addLocalSnapshot(e=`Local ${this.locale.title}`){if(this.localSnapshotEnabled){const t=this.state,{cropState:i}=t,r=Ge(t,["cropState"]);this.editor.addLocalTransformSnapshot(p(p(p({},r),this.cropState),{localOutputSize:v.toJS(this.localOutputSize),outputSize:this.engineMediator.output.container.getResolution(),defaults:v.toJS(this.defaults),previewTransform:this.engineMediator.preview.container.getTransform(),outputTransform:this.engineMediator.output.container.getTransform()}),e)}}updateLocalStateFromHistory(e){const{tool:t}=this.editor.activeStore;t===f.TRANSFORM&&(this.transformStore.changeLockResolution(e.lockResolution),this.transformStore.changeForceDimensions(e.forceDimensions),this.transformStore.changeIdentifier(e.identifier),this.transformStore.setRotation(e.rotationInDegrees),this.setDefaultAngle(e.rotationInDegrees),this.transformStore.setOutputRotation(e.outputRotation),this.transformStore.updateFlip(e),this.engineMediator.output.container.setRotation(e.outputRotation),this.setDefaultImageSize(e.defaults.imageSize),this.localOutputSize=e.defaults.imageSize,this.changeLocalOutputSize(e.localOutputSize),this.transformStore.changeSize(e.size),this.changePosition(e.position),this.setMaxCropSize(e.defaults.maxCropMaskSize),this.setDefaultCropPosition(e.defaults.cropMaskPosition),this.changeDefaultScale(e.defaults.scale),this.engineMediator.output.container.setResolution(e.outputSize),this.engineMediator.preview.container.setTransform(e.previewTransform),this.engineMediator.output.container.setTransform(e.outputTransform))}updateStateFromHistory(e){const{tool:t}=this.editor.activeStore;t!==f.TRANSFORM&&(this.engineMediator.output.container.setTransform(e.outputTransform),this.engineMediator.preview.container.setTransform(e.previewTransform),this.engineMediator.output.container.setResolution(e.outputSize),this.changeLocalOutputSize(e.outputSize))}get serializableState(){const{flipHorizontally:e,flipVertically:t}=this.rotateFlipState,i=this.editor.engineMediator.output.container.getRotation()*180/Math.PI%360,{identifier:r,rotationInDegrees:o}=this,n=o*Math.PI/180;let a=i+o;a=Math.round(a/90)*90,a=a<0?a+360:a,a=(360-a)%360;const{start:l,end:c}=this.convertUIToOperationOptions(n,a);return{flipHorizontally:e,flipVertically:t,rotation:n,start:l,end:c,identifier:r,outputRotation:a}}getStartEndForOperation(e){const{leftTop:t,rightBottom:i,maxCropMaskSize:r}=this,o=t.y,n=t.x,a=i.x,l=i.y;switch(e){case 270:return{leftTop:{x:r.height-l,y:n},rightBottom:{x:r.height-o,y:a}};case 180:return{leftTop:{x:r.width-a,y:r.height-l},rightBottom:{x:r.width-n,y:r.height-o}};case 90:return{leftTop:{x:o,y:r.width-a},rightBottom:{x:l,y:r.width-n}};default:return{leftTop:{x:n,y:o},rightBottom:{x:a,y:l}}}}getStartEndForUI(e,t,i){const{maxCropMaskSize:r}=this,o=t.y,n=t.x,a=i.x,l=i.y;switch(e){case 90:return{leftTop:{x:o,y:r.height-a},rightBottom:{x:l,y:r.height-n}};case 180:return{leftTop:{x:r.width-a,y:r.height-l},rightBottom:{x:r.width-n,y:r.height-o}};case 270:return{leftTop:{x:r.width-l,y:n},rightBottom:{x:r.width-o,y:a}};default:return{leftTop:{x:n,y:o},rightBottom:{x:a,y:l}}}}convertOperationOptionsToUI({start:e,end:t,rotation:i,outputRotation:r}){const o=r===90||r===270,n=o?D.fromSize(this.defaultImageSize).swapped:D.fromSize(this.defaultImageSize),a=Math.cos(i),l=Math.sin(i),c=this.calculateScale(i),d=new D(Math.min(e.x,t.x),Math.min(e.y,t.y)),u=new D(Math.max(e.x,t.x),Math.max(e.y,t.y)),h=u.subtract(d).divide(2),y=d.add(h).multiply(n),k=y.subtract(n.multiply(.5)),w=new D(k.x*a-k.y*l,k.x*l+k.y*a).multiply(c),T=n.multiply(.5).add(w),F=T.divide(n),$=F.subtract(h.multiply(c)),E=F.add(h.multiply(c)),ce=o?D.fromSize(this.maxCropMaskSize).swapped:D.fromSize(this.maxCropMaskSize),bt=$.multiply(ce),_e=E.multiply(ce),{leftTop:M,rightBottom:Z}=this.getStartEndForUI(r,bt,_e);return{start:new D(M),end:new D(Z)}}convertUIToOperationOptions(e,t){const i=t===90||t===270,r=i?D.fromSize(this.defaultImageSize).swapped:D.fromSize(this.defaultImageSize),o=i?D.fromSize(this.maxCropMaskSize).swapped:D.fromSize(this.maxCropMaskSize),n=Math.cos(-e),a=Math.sin(-e),l=this.calculateScale(e,i),{leftTop:c,rightBottom:d}=this.getStartEndForOperation(t),u=new D(c).divide(o),h=new D(d).divide(o),y=h.subtract(u).divide(2),k=u.add(y).multiply(r),w=k.subtract(r.multiply(.5)),T=new D(w.x*n-w.y*a,w.x*a+w.y*n).divide(l),F=r.multiply(.5).add(T),$=F.divide(r),E=$.subtract(y.divide(l)),ce=$.add(y.divide(l));return{start:E,end:ce}}calculateScale(e,t=!1){const i=t?D.fromSize(this.defaultImageSize).swapped:D.fromSize(this.defaultImageSize),r=new D(Math.abs(i.x*Math.cos(e))+Math.abs(i.y*Math.sin(e)),Math.abs(i.x*Math.sin(e))+Math.abs(i.y*Math.cos(e))),o=i.subtract(r.clone()).divide(2).abs;return o.y>o.x?o.y*2/i.y+1:o.x*2/i.x+1}updateStateFromSerialization(e,t){this.localSnapshotEnabled=t,this.transformStore.resetRotation(),this.transformStore.resetOutputRotation(),this.transformStore.resetFlip(),this.setDefaultAngle(0),this.editor.outputContainer.getRotation()!==0&&this.engineMediator.output.applyNewImageTransform(),this.engineMediator.output.container.setData({flipHorizontally:!1,flipVertically:!1}),this.engineMediator.preview.updateTransform(),this.editor.scale.setInitialTransform(),this.setCropDefaults(),this.applyInitialCrop();const i=Math.round(e.rotation*180/Math.PI);this.transformStore.setRotation(i>180?i-360:i),this.applyOutputRotationFromSerialization(e),e.identifier&&this.transformStore.changeIdentifier(e.identifier);let r=e.outputRotation<0?e.outputRotation+360:e.outputRotation;if(r=(360-r)%360,e.start&&e.end){(e.end.x===0||e.end.y===0)&&(e.end.x=1,e.end.y=1);const{start:o,end:n}=this.convertOperationOptionsToUI({start:new D(e.start),end:new D(e.end),rotation:e.rotation,outputRotation:r});this.changePositionX(o.x),this.changePositionY(o.y);const a=n.x-o.x,l=n.y-o.y;this.transformStore.changeSize({width:a,height:l});const{maxCropMaskSize:c,imageSize:d}=this.defaults,u={height:l*d.height/c.height,width:a*d.width/c.width};this.changeLocalOutputSize(u)}this.editor.outputContainer.setData({flipHorizontally:e.flipHorizontally,flipVertically:e.flipVertically}),e.flipHorizontally&&this.flipHorizontally(!1),e.flipVertically&&this.flipVertically(!1),this.editor.overlayToolStore.correctOverlayFlip(),this.localSnapshotEnabled=!0}applyOutputRotationFromSerialization(e){if(e.outputRotation!==void 0)switch(e.outputRotation){case 90:this.transformations.rotateOutputContainer();break;case 180:this.transformations.rotateOutputContainer(),this.transformations.rotateOutputContainer();break;case 270:this.transformations.rotateOutputContainer(!0);break;default:break}this.transformations.rotateOutputContainer(!0),this.transformations.rotateOutputContainer()}setDefaultAngle(e){this.defaultAngle=e}updateCanvasControls(e){const t=v.toJS(this.cropMaskPosition),i=v.toJS(this.cropMaskSize),r=v.toJS(this.defaults.maxCropMaskSize);this.changeCropAndOutputSize({height:r.height*i.height/e.height,width:r.width*i.width/e.width}),this.changePosition({y:r.height*t.y/e.height,x:r.width*t.x/e.width})}onLeave(){this.transformations.onLeave()}onEnter(){this.transformations.onEnter()}saveTransforms(){this.transformations.saveTransforms()}saveTransformsBasedOnFlip(){this.transformations.saveTransformsBasedOnFlip()}setRotation(e){this.transformStore.setRotation(e),this.transformRender()}rotateOutputContainer(e=!1){return I(this,null,function*(){this.setDragMode(!0),this.transformations.rotateOutputContainer(e),yield this.editor.wait(),this.setDragMode(!1)})}applyInitialCrop(){const{identifier:e}=this.getMatchingItem();this.changeIdentifier(e,!1)}clickableCanvas(e){this.editor.clickableCanvas(e)}proportionalSize(e,t,i=this.defaults.maxCropMaskSize,r=this.minCropSize){const o={width:t.height*e,height:t.height};return(o.width>i.width||o.width<r||o.height<r)&&(o.width=t.width,o.height=t.width/e),o.width=Math.round(o.width),o.height=Math.round(o.height),o}checkAndAddSnapshot(e){const t=v.toJS(this.localOutputSize);(e.width!==t.width||e.height!==t.height)&&this.addLocalSnapshot()}updateInitialCropMaskPosition(e){const{cropMaskSize:t}=this,i=this.defaults.maxCropMaskSize;e?this.changePosition({x:0,y:Math.abs(i.height-t.height)/2}):this.changePosition({x:Math.abs(i.width-t.width)/2,y:0})}updatePreviewSizeWRTImageSize(){const e=v.toJS(this.localOutputSize),t=v.toJS(this.defaults.imageSize),i=v.toJS(this.defaults.maxCropMaskSize),r={height:i.height*e.height/t.height,width:i.width*e.width/t.width};this.transformStore.changeSize(r)}getScaleWithFlip(e=this.rotateFlipState.rotation){return this.transformations.getScaleWithFlip(e)}get cropState(){return this.transformStore.selectedCrop}get identifier(){return this.transformStore.identifier}get ratio(){return this.transformStore.ratio}get height(){return this.transformStore.height}get width(){return this.transformStore.width}get localOutputImageSize(){return this.localOutputSize}get localOutputHeight(){return this.localOutputSize.height}get localOutputWidth(){return this.localOutputSize.width}get lockResolution(){return this.transformStore.lockResolution}get forceDimensions(){return this.transformStore.forceDimensions}get rotationInDegrees(){return this.transformStore.rotationInDegrees}get outputRotation(){return this.transformStore.outputRotation}get isDragMode(){return this.dragMode.get()}get rotateFlipState(){const{flipHorizontally:e,flipVertically:t,rotationInDegrees:i,outputRotation:r}=this.transformStore.state;return{flipHorizontally:e,flipVertically:t,rotation:S.inRadians(i),outputRotation:r}}get selectedCategoryIdentifier(){return this.selectedCategory}get categories(){return this.entityManager.categories}get items(){return this.entityManager.items}get config(){return this.editor.configStore.config[f.TRANSFORM]}get locale(){return this.editor.configStore.locale[f.TRANSFORM]}get isOptionSelected(){return this.identifier!=="identity"}get leftTop(){return this.rect.leftTop}get leftBottom(){return this.rect.leftBottom}get rightTop(){return this.rect.rightTop}get rightBottom(){return this.rect.rightBottom}get isFlippedHorizontal(){return this.transformStore.isFlippedHorizontal}get isFlippedVertical(){return this.transformStore.isFlippedVertical}get leftTopRespectFlip(){return this.rectForUi.leftTop}get leftBottomRespectFlip(){return this.rectForUi.leftBottom}get rightTopRespectFlip(){return this.rectForUi.rightTop}get rightBottomRespectFlip(){return this.rectForUi.rightBottom}get cropMaskPosition(){return this.transformStore.position}get cropMaskSize(){return this.transformStore.size}get state(){return this.transformStore.state}get defaultImageSize(){return this.defaults.imageSize}get maxCropMaskSize(){return this.defaults.maxCropMaskSize}get minCropMaskSize(){const e=this.getRatio();return e==="*"||e===1?{width:this.minCropSize,height:this.minCropSize}:e>1?{width:this.minCropSize*e,height:this.minCropSize}:{width:this.minCropSize,height:this.minCropSize*e}}get defaultCropMaskPosition(){return this.defaults.cropMaskPosition}get defaultScale(){return this.defaults.scale}get engineMediator(){return this.editor.engineMediator}getRatio(){const e=this.getTransform(this.identifier);if(e){if(Object.prototype.hasOwnProperty.call(e,"ratio"))return this.lockResolution?this.localOutputWidth/this.localOutputHeight:e.ratio;const{x:t,y:i}=e.dimensions;return t/i}return"*"}}s([v.observable],S.prototype,"selectedCategory",2),s([v.observable],S.prototype,"defaults",2),s([v.observable],S.prototype,"localOutputSize",2),s([v.action],S.prototype,"changeIdentifier",1),s([v.action],S.prototype,"setDragMode",1),s([v.action],S.prototype,"setCropDefaults",1),s([v.action],S.prototype,"setDefaultImageSize",1),s([v.action],S.prototype,"setMaxCropSize",1),s([v.action],S.prototype,"setDefaultCropPosition",1),s([v.action],S.prototype,"resetCrop",1),s([v.action],S.prototype,"toggleCategorySelection",1),s([v.action],S.prototype,"pureReset",1),s([v.action],S.prototype,"reset",2),s([v.action],S.prototype,"changePosition",1),s([v.action],S.prototype,"changePositionX",1),s([v.action],S.prototype,"changePositionY",1),s([v.action],S.prototype,"changeCropAndOutputHeight",1),s([v.action],S.prototype,"changeCropAndOutputWidth",1),s([v.action],S.prototype,"changeCropAndOutputSize",1),s([v.action],S.prototype,"onLeave",1),s([v.action],S.prototype,"onEnter",1),s([v.action],S.prototype,"changeLocalOutputSize",2),s([v.action],S.prototype,"changeDefaultScale",2),s([v.action],S.prototype,"changeLocalOutputHeight",2),s([v.action],S.prototype,"changeLocalOutputWidth",2),s([v.action],S.prototype,"changeLockResolution",2),s([v.action],S.prototype,"setRotation",1),s([v.action],S.prototype,"rotateClockwise",2),s([v.action],S.prototype,"rotateAntiClockwise",2),s([v.action],S.prototype,"rotateOutputContainer",1),s([v.action],S.prototype,"flipHorizontally",2),s([v.action],S.prototype,"flipVertically",2),s([v.action],S.prototype,"applyDefaultCrop",2),s([v.action],S.prototype,"applyInitialCrop",1),s([v.action],S.prototype,"updateCropMask",2),s([v.action],S.prototype,"clickableCanvas",1),s([v.action],S.prototype,"onLeftTop",2),s([v.action],S.prototype,"onLeftBottom",2),s([v.action],S.prototype,"onRightTop",2),s([v.action],S.prototype,"onRightBottom",2),s([v.action],S.prototype,"proportionalSize",1),s([v.action],S.prototype,"onPixelWidth",2),s([v.action],S.prototype,"onPixelHeight",2),s([v.action],S.prototype,"updateInitialCropMaskPosition",1),s([v.action],S.prototype,"updatePreviewSizeWRTImageSize",1),s([v.computed],S.prototype,"cropState",1),s([v.computed],S.prototype,"identifier",1),s([v.computed],S.prototype,"ratio",1),s([v.computed],S.prototype,"height",1),s([v.computed],S.prototype,"width",1),s([v.computed],S.prototype,"localOutputImageSize",1),s([v.computed],S.prototype,"localOutputHeight",1),s([v.computed],S.prototype,"localOutputWidth",1),s([v.computed],S.prototype,"lockResolution",1),s([v.computed],S.prototype,"forceDimensions",1),s([v.computed],S.prototype,"rotationInDegrees",1),s([v.computed],S.prototype,"outputRotation",1),s([v.computed],S.prototype,"isDragMode",1),s([v.computed],S.prototype,"rotateFlipState",1),s([v.computed],S.prototype,"selectedCategoryIdentifier",1),s([v.computed],S.prototype,"categories",1),s([v.computed],S.prototype,"items",1),s([v.computed],S.prototype,"config",1),s([v.computed],S.prototype,"locale",1),s([v.computed],S.prototype,"isOptionSelected",1),s([v.computed],S.prototype,"leftTop",1),s([v.computed],S.prototype,"leftBottom",1),s([v.computed],S.prototype,"rightTop",1),s([v.computed],S.prototype,"rightBottom",1),s([v.computed],S.prototype,"isFlippedHorizontal",1),s([v.computed],S.prototype,"isFlippedVertical",1),s([v.computed],S.prototype,"leftTopRespectFlip",1),s([v.computed],S.prototype,"leftBottomRespectFlip",1),s([v.computed],S.prototype,"rightTopRespectFlip",1),s([v.computed],S.prototype,"rightBottomRespectFlip",1),s([v.computed],S.prototype,"cropMaskPosition",1),s([v.computed],S.prototype,"cropMaskSize",1),s([v.computed],S.prototype,"state",1),s([v.computed],S.prototype,"defaultImageSize",1),s([v.computed],S.prototype,"maxCropMaskSize",1),s([v.computed],S.prototype,"minCropMaskSize",1),s([v.computed],S.prototype,"defaultCropMaskPosition",1),s([v.computed],S.prototype,"defaultScale",1);const Ui=m(b());class le{constructor(e){this.checkImageResize=()=>{this.engine.on(dc.BEGAN_IMAGE_DOWNSCALING,()=>{this.modalStore.showInfoModal("resizing")}),this.engine.on(dc.IMAGE_DOWNSCALED,({width:e,height:t})=>{const{maxMegaPixels:i}=this.configStore.config.engine.downscaleOptions,r=qn.isMobile()?i.mobile:i.desktop;this.modalStore.hideModal(),this.modalStore.showActionModal({type:se.WARNING,identifier:"imageResized",handleConfirm:()=>{this.modalStore.hideModal()},error:{megapixels:`${r}`,width:`${e}`,height:`${t}`}})})};this.init=e=>{const t=this.historyStore.isDirty();t?this.modalStore.showActionModal({type:se.WARNING,identifier:"discardChanges",handleConfirm:()=>{this.setImage(e),this.resetToolStates()},handleDismiss:()=>{this.setImage(e,!0)}}):this.setImage(e,!0).then(()=>{const{engine:i,displayCanvasRendererWarning:r}=this.configStore.config;i.preferredRenderer==="canvas"&&r&&this.modalStore.showActionModal({type:se.WARNING,identifier:"unsupportedWebGLRenderer",handleConfirm:()=>{this.modalStore.hideModal()}})}),this.historyStore.reset(),this.libraryStore.fetchImages()};this.setImage=(e,t=!1)=>I(this,null,function*(){try{this.modalStore.showInfoModal(this.configStore.config.displayResizeWarning?"resizing":"loading"),this.scale.defaultScale=1,this.scale.resetOffset(),yield this.activeStore.setImage(e),yield this.engineMediator.image.addImageToContainer(),this.engineMediator.output.applyNewImageTransform(),this.engineMediator.preview.updateTransform(),this.scale.setInitialTransform(),this.transformToolStore.setCropDefaults(),this.historyStore.addInitialSnapshot();const{flipHorizontally:i,flipVertically:r}=this.transformToolStore.rotateFlipState;this.outputContainer.setData({flipVertically:r,flipHorizontally:i}),t?(this.focusToolStore.updateCanvasControls(),this.spriteStore.updateCanvasControls(),this.transformToolStore.resetCrop(),this.transformToolStore.applyDefaultCrop(),this.transformToolStore.saveTransformsBasedOnFlip(),this.transformToolStore.onEnter(),this.transformToolStore.setRotation(this.transformToolStore.rotationInDegrees),this.transformToolStore.onLeave(),this.transformToolStore.onEnter(),this.transformToolStore.onLeave()):this.transformToolStore.saveTransforms(),this.snappingStore.calculatePreviewTopLeftPosition(),yield this.renderPromise(),this.configStore.config.filter.enablePreviewThumbnails&&this.configStore.config.engine.preferredRenderer==="webgl"&&this.filterToolStore.setImageAndGetPreviews();const o=this.activeStore.tool;o||this.onReady(),this.modalStore.identifier==="imageResized"||this.modalStore.hideModal()}catch(i){this.configStore.events.onErrorImageLoading(i),this.modalStore.hideModal(),this.modalStore.showActionModal({type:se.ERROR,identifier:i.identifier?i.identifier:"rendering",error:i,handleConfirm:()=>{window.location.reload()}})}});this.onToolChange=(e,t=null,i=!0)=>{if(e===t)return;if(this.engineMediator.preview.container){if([e,t].indexOf(f.TRANSFORM)!==-1){const{canvasSize:r}=this.canvasStore,o=this.configStore.measurements.basicToolControlBar.controlsBarHeight;if(e===f.TRANSFORM){this.transformToolStore.onLeave(),this.historyStore.removeTransformLocalSnapshots();const n=this.engineMediator.preview.container.getScale().x,a=this.engineMediator.output.container.getResolution(),{defaultImageSize:l}=this.transformToolStore,c=n!==1||l.width!==a.width||l.height!==a.height;c&&this.addSnapshot(void 0,R.EDIT,this.configStore.locale.transform.title),this.snappingStore.calculatePreviewTopLeftPosition(),this.configStore.isLayoutAdvanced||(this.canvasStore.state.canvasSize.height=r.height+o,this.resize(!0))}else t===f.TRANSFORM&&(this.configStore.isLayoutAdvanced||(this.canvasStore.state.canvasSize.height=r.height-o,this.resize(),this.render()),this.transformToolStore.onEnter(),this.transformToolStore.addLocalSnapshot(),this.historyStore.saveTransformLocalSnapshotIndex())}else this.scale.resetOffset(),this.scale.resetPosition(),this.scale.setScaleToDefault(),this.scale.scaleRender(!0);i&&this.render()}};this.resize=(e=!1)=>{try{this.transformToolStore.applyDefaultCrop(),this.canvasStore.updateCanvasDimensions();const t=Ui.toJS(this.transformToolStore.maxCropMaskSize),i=this.activeStore.tool===f.TRANSFORM;(!i||e)&&this.transformToolStore.onEnter();const r=this.engineMediator.preview.container.getRotation(),o=this.engineMediator.preview.updateTransform(r);if(o){this.scale.setInitialTransform(),this.transformToolStore.setCropDefaults(),this.transformToolStore.updateCanvasControls(t),this.focusToolStore.updateCanvasControls(),this.spriteStore.updateCanvasControls();const n=this.transformToolStore.getScaleWithFlip(r);this.engineMediator.preview.container.setScale(n),(!i||e)&&(this.transformToolStore.onLeave(),this.transformToolStore.onEnter(),this.transformToolStore.onLeave()),this.snappingStore.calculatePreviewTopLeftPosition(),this.render()}}catch(t){this.modalStore.showActionModal({type:se.ERROR,identifier:"rendering",handleConfirm:()=>{window.location.reload()}})}};this.export=(i={})=>{var{preventExportEvent:e}=i,t=Ge(i,["preventExportEvent"]);return new Promise((r,o)=>{this.modalStore.showInfoModal("exporting");const n=this.activeStore.tool===f.TRANSFORM;n&&this.transformToolStore.onLeave();const{config:a}=this.configStore,l=p(p({},a.export.image),t),{exportType:c,format:d,quality:u,enableDownload:h}=l;this.engineMediator.engine.export(c,d,u).then(y=>{h&&this.triggerFileDownload(a.export.filename,d,c,y),e||this.configStore.events.onExport(y),r(y),n&&this.transformToolStore.onEnter(),this.modalStore.hideModal(),this.historyStore.isDirtySinceSave=!1}).catch(y=>{o(y),n&&this.transformToolStore.onEnter(),this.modalStore.hideModal()})})};this.serialize=({image:e}={image:!0})=>this.serializationMediator.serialize({image:e});this.deserialize=e=>this.serializationMediator.deserialize(e);this.close=()=>{this.historyStore.isDirtySinceSave&&this.configStore.config.displayCloseWarning?this.modalStore.showActionModal({type:se.WARNING,identifier:"unsavedChanges",handleConfirm:()=>{this.configStore.events.onClose()}}):this.configStore.events.onClose()};this.hasChanges=()=>this.historyStore.isDirty();this.wait=(e=0)=>new Promise(t=>setTimeout(t,e));this.clickableCanvas=e=>I(this,null,function*(){e?(yield new Promise(t=>setTimeout(t,0)),this.canvasStore.enableCanvasClick()):this.canvasStore.disableCanvasClick()});this.onReady=()=>I(this,null,function*(){const{layout:e,forceCrop:t}=this.configStore.config;if(e==="advanced"&&this.activeStore.selectTool(this.configStore.defaultTool),t){const i=this.transformToolStore.localOutputImageSize,r=i.width/i.height,o=this.transformToolStore.entityManager.items.map(n=>n.ratio?n.ratio:n.dimensions.x/n.dimensions.y);o.indexOf("*")!==-1?console.error('ForceCrop will not work if "*" is one of the ratios'):o.indexOf(parseFloat(r.toFixed(2)))===-1&&this.activeStore.selectTool(f.TRANSFORM)}this.configStore.events.onEditorReady()});this.addSnapshot=(e,t,i)=>{this.historyStore.addSnapshot(e,t,i)};this.addLocalTransformSnapshot=(e,t,i=R.EDIT)=>{this.historyStore.addSnapshot({localTransform:e},i,t)};this.resetToolStates=()=>{this.filterToolStore.pureReset(),this.focusToolStore.pureReset(),this.adjustmentsToolStore.pureReset(),this.overlayToolStore.pureReset(),this.frameToolStore.pureReset(),this.brushToolStore.pureReset(),this.spriteStore.pureReset(),this.transformToolStore.pureReset(),this.historyStore.reset(),this.render()};this.getAssetPath=e=>this.assetProvider.getPathForCategory(e);this.render=()=>I(this,null,function*(){yield this.renderPromise()});this.applyFlipToPreview=e=>this.engineMediator.previewSpaceToFlippedPreviewSpace(e);this.getPreviewSize=()=>{const{width:e,height:t}=this.engine.getOutputDimensions();return e&&t?{width:Math.round(this.worldToPreview(this.outputToWorld(e))),height:Math.round(this.worldToPreview(this.outputToWorld(t)))}:{height:t,width:e}};this.triggerFileDownload=(e,t,i,r)=>{const o=t===Mt.JPEG&&i!==Ni.MSBLOB?".jpeg":".png",n=e+o,a=this.blobFromExportData(r);this.triggerBlobDownload(n,a)};this.triggerBlobDownload=(e,t)=>{if(navigator.msSaveBlob)navigator.msSaveBlob(t,e);else{const i=document.createElement("a"),r=URL.createObjectURL(t);i.href=r,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i),kl()||URL.revokeObjectURL(r)}};this.blobFromExportData=e=>typeof e=="string"?us(e):e instanceof HTMLImageElement?us(e.src):e;this.configStore=new Ke;const t=this.configStore.saveConfig(e);if(this.engineMediator=new uc(this),this.serializationMediator=new ds(this),this.spriteStore=new _(this),this.scale=new me(this),this.filterToolStore=new ae(this),this.adjustmentsToolStore=new q(this),this.focusToolStore=new j(this),this.overlayToolStore=new be(this),this.frameToolStore=new re(this),this.brushToolStore=new te(this),this.transformToolStore=new S(this),this.libraryStore=new Je(this),this.modalStore=new ht(this),this.snappingStore=new Pt(this),this.activeStore=new xt(this),this.canvasStore=new je(this),this.historyStore=new ji(this),this.modalStore.showInfoModal("loading"),this.libraryStore.initProvider(t),this.configStore.config.displayResizeWarning&&this.checkImageResize(),this.configStore.config.filter.enablePreviewThumbnails&&this.configStore.config.engine.preferredRenderer==="webgl"){const i=this.configStore.config.engine;this.previewThumbnails=new as(p(p({},i),{license:this.configStore.config.license,assetProvider:this.configStore.assetProvider}))}}static get defaultColors(){return Object.keys(Be).map(e=>{const t=Be[e];return{identifier:e,color:t,colorString:xr(t)}})}static get defaultBackgroundColors(){return Object.keys(Jn).map(e=>{const t=Jn[e];return{identifier:e,color:t,colorString:xr(t)}})}static get devicePixelRatio(){return window.devicePixelRatio||1}get shortestOutputSide(){const e=this.outputContainer.getBounds();return Math.min(e.width,e.height)}get assetProvider(){return this.configStore.assetProvider}get engine(){return this.engineMediator.engine}get imageContainer(){return this.engineMediator.image.container}get orderHelper(){return this.engineMediator.orderHelper}renderPromise(){return this.engineMediator.render(this.engineMediator.preview.container)}previewToWorld(e,t){return Dt(e)?this.engineMediator.previewSpaceToWorldSpace(e,t):this.engineMediator.previewSpaceToWorldSpace(e,t)}worldToPreview(e){return Dt(e)?this.engineMediator.worldSpaceToPreviewSpace(e):this.engineMediator.worldSpaceToPreviewSpace(e)}worldSizeToPreview(e){return{width:this.engineMediator.worldSpaceToPreviewSpace(e.width),height:this.engineMediator.worldSpaceToPreviewSpace(e.height)}}previewSizeToWorld(e,t){return{width:this.engineMediator.previewSpaceToWorldSpace(e.width,t),height:this.engineMediator.previewSpaceToWorldSpace(e.height,t)}}outputToWorld(e){return Dt(e)?this.engineMediator.outputSpaceToWorldSpace(e):this.engineMediator.outputSpaceToWorldSpace(e)}previewToOutput(e){return Dt(e)?this.engineMediator.previewSpaceToOutputSpace(e):this.engineMediator.previewSpaceToOutputSpace(e)}get outputContainer(){return this.engineMediator.output.container}}s([Ui.action],le.prototype,"resize",2),s([Ui.action],le.prototype,"export",2),s([Ui.action],le.prototype,"clickableCanvas",2);function ys(e,t){const i=e.width/e.height,r=t.width/t.height;return i>r?e.height/t.height:e.width/t.width}const Ze=m(b()),pm={transform:Qt.IDENTITY};class oi{constructor(e){this.initialTransform=Qt.IDENTITY;this.editor=e,this.state=Ze.observable(pm)}createPreview(e){this.container=this.editor.engine.createPreview(e)}updateTransform(e=0,t=!0){const i=this.calculateTransform(e);return i.scale.x?(t?this.saveInitialTransform(i):this.savePreviewTransform(i),this.container.setTransform(this.state.transform),!0):!1}saveInitialTransform(e){this.initialTransform=e,this.savePreviewTransform(e)}savePreviewTransform(e){Ze.runInAction(()=>{this.state.transform.position=e.position,this.state.transform.scale=e.scale,this.state.transform.rotation=e.rotation;const t=le.devicePixelRatio;this.previewTransformWithoutDpr={position:new D(e.position).divide(t),scale:new D(e.scale).divide(t),rotation:e.rotation}})}get transform(){return this.state.transform}get position(){return this.state.transform.position}get scale(){return this.state.transform.scale}get rotation(){return this.state.transform.rotation}calculateTransform(e=0){const t=le.devicePixelRatio,{width:i,height:r}=this.editor.canvasStore.canvasSize,o=this.editor.engine.getOutputDimensions();let n=ys({width:i,height:r},o),a=.95;window.innerWidth<600&&(a=.98),n*=a;const l=r-o.height*n,c=this.editor.configStore.measurements.mainCanvasActionBar.height*2;l<c&&(n=ys({width:i,height:r-c},o),n*=a),n*=t;const d={x:i*t/2,y:r*t/2},u={x:n,y:n};return new Qt(d,u,e)}}s([Ze.action],oi.prototype,"updateTransform",1),s([Ze.action],oi.prototype,"savePreviewTransform",1),s([Ze.computed],oi.prototype,"transform",1),s([Ze.computed],oi.prototype,"position",1),s([Ze.computed],oi.prototype,"scale",1),s([Ze.computed],oi.prototype,"rotation",1);class Bt{constructor(){this.imageContainerOrder=[];this.spriteContainerOrder=[]}static checkTool(e){if([f.STICKER,f.TEXT,f.TEXT_DESIGN,f.BRUSH,f.FRAME].indexOf(e)!==-1)throw new Error("addIndex is used for non sprites, for sprites use addSprite")}static remove(e,t){const i=t.findIndex(r=>r===e);i!==-1&&t.splice(i,1);return}static indexForOrder(e,t,i){const r=e[i],o=t.findIndex(a=>a===i);if(o!==-1)return{index:o,order:t};const{length:n}=t;if(n){let a;for(a=0;a<n;a+=1){const l=t[a],c=e[l];if(r<c)return t=[...t.slice(0,a),i,...t.slice(a)],{index:a,order:t}}}return t.push(i),{index:t.length-1,order:t}}addIndex(e){Bt.checkTool(e);const{index:t,order:i}=Bt.indexForOrder(Bt.IMAGE_CONTAINER_INDEX,this.imageContainerOrder,e);return this.imageContainerOrder=i,t}removeIndex(e){Bt.checkTool(e),Bt.remove(e,this.imageContainerOrder)}addSprite(e){return this.spriteContainerOrder.push(e),this.imageContainerOrder.length+this.spriteContainerOrder.length-1}removeSprite(e){Bt.remove(e,this.spriteContainerOrder)}renameSprite(e,t){const i=this.spriteContainerOrder.findIndex(r=>r===e);i!==-1&&(this.spriteContainerOrder[i]=t)}bringToFront(e){const t=this.spriteContainerOrder.findIndex(i=>i===e);return t!==-1&&(this.spriteContainerOrder.splice(t,1),this.spriteContainerOrder.push(e)),this.getLastSpriteIndex()}getLastSpriteId(){const{length:e}=this.spriteContainerOrder;return this.spriteContainerOrder[e-1]}getSpriteIndex(e){const t=this.spriteContainerOrder.findIndex(i=>i===e);return t+this.imageContainerOrder.length-1}getLastSpriteIndex(){return this.imageContainerOrder.length+this.spriteContainerOrder.length-1}}Bt.IMAGE_CONTAINER_INDEX={[f.ART_FILTER]:0,[f.FILTER]:1,[f.ADJUSTMENT]:2,[f.FOCUS]:3,[f.OVERLAY]:4};class uc{constructor(e){this.orderHelper=new Bt;const t=e.configStore.config.engine;this.engine=new ss(p(p({},t),{license:e.configStore.config.license,assetProvider:e.configStore.assetProvider})),this.image=new Zl(e),this.output=new Ql(e),this.preview=new oi(e),this.editor=e}render(e){return this.engine.render(e)}previewSpaceToWorldSpace(e,t){const i=this.preview.previewTransformWithoutDpr;if(Dt(e)){const r=this.editor.engine.convertPointFromPreviewIntoWorldSpace(D.ZERO,i,t),o=this.editor.engine.convertPointFromPreviewIntoWorldSpace({x:e,y:0},i,t);return D.distance(new D(r),new D(o))}return this.editor.engine.convertPointFromPreviewIntoWorldSpace(e,i,t)}worldSpaceToPreviewSpace(e){const t=this.preview.previewTransformWithoutDpr;if(Dt(e)){const i=this.editor.engine.convertPointFromWorldIntoPreviewSpace(D.ZERO,t),r=this.editor.engine.convertPointFromWorldIntoPreviewSpace({x:e,y:0},t);return D.distance(new D(i),new D(r))}return this.editor.engine.convertPointFromWorldIntoPreviewSpace(e,t)}outputSpaceToWorldSpace(e){return Dt(e)?hc.getScalarInWorldSpace(e,this.editor.engine.getOutputContainer()):hc.getPointInWorldSpace(e,this.editor.engine.getOutputContainer())}previewSpaceToOutputSpace(e){const t=this.preview.previewTransformWithoutDpr;if(Dt(e)){const i=this.editor.engine.convertPointFromPreviewIntoOutputSpace(D.ZERO,t),r=this.editor.engine.convertPointFromPreviewIntoOutputSpace({x:e,y:0},t);return D.distance(new D(i),new D(r))}return this.editor.engine.convertPointFromPreviewIntoOutputSpace(e,t)}previewSpaceToFlippedPreviewSpace(e){return this.editor.engine.convertPointFromPreviewIntoFlippedPreviewSpace(e)}}const Me=m(b()),pc=[[0,0],[0,1],[1,0],[1,1]],fm=[[0,1,2,3],[2,3,0,1],[1,0,3,2],[3,2,1,0]];class J{constructor(e,t,i="center",r=!0,o=!1){this.considerRotation=!0;this.considerFlip=!0;this.store=t,this.m=i==="center"?J.movePivotTo([.5,.5]):pc,this.considerRotation=r,this.considerFlip=o,this.configStore=e.configStore}static getFlippedEdgeIndex(e,t,i){return fm[(t?1:0)+(i?2:0)][e]}static movePivotTo(e){return pc.map(t=>[t[0]-e[0],t[1]-e[1]])}get position(){return this.store.position}get size(){return this.store.size}get rotation(){return this.considerRotation?this.store.rotationWRTOutputRotation:0}get flipHorizontally(){return this.considerFlip?this.store.isFlippedHorizontal:!1}get flipVertically(){return this.considerFlip?this.store.isFlippedVertical:!1}get flipCenter(){return this.considerFlip?this.store.flipCenter:null}handleOrigin(e,t,i){const r=J.getFlippedEdgeIndex(e,t,i),o=this.m[r][0]*this.size.width,n=this.m[r][1]*this.size.height;return{width:o,height:n}}get leftTop(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(0,t,i);return J.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get leftBottom(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(1,t,i);return J.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get rightTop(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(2,t,i);return J.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get rightBottom(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(3,t,i);return J.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get leftBottomHandle(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(1,t,i);return r.height+=this.configStore.measurements.canvasControls.sprite.rotateHandle.height,J.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get rightBottomHandle(){const{position:e,flipHorizontally:t,flipVertically:i}=this,r=this.handleOrigin(3,t,i);return r.height+=this.configStore.measurements.canvasControls.sprite.rotateHandle.height,J.coordinatesWithRotation(r,this.rotation,this.flipHorizontally,this.flipVertically,this.flipCenter,e)}get leftMid(){const e=new D(this.leftTop),t=new D(this.leftBottom);return e.add(t).divide(2)}get rightMid(){const e=new D(this.rightTop),t=new D(this.rightBottom);return e.add(t).divide(2)}}J.coordinatesWithRotation=({width:e,height:t},i,r,o,n,a)=>{let l=e*Math.cos(i)-t*Math.sin(i)+a.x,c=e*Math.sin(i)+t*Math.cos(i)+a.y;return r&&(l=n.x*2-l),o&&(c=n.y*2-c),new D({x:l,y:c}).rounded},s([Me.computed],J.prototype,"position",1),s([Me.computed],J.prototype,"size",1),s([Me.computed],J.prototype,"rotation",1),s([Me.computed],J.prototype,"flipHorizontally",1),s([Me.computed],J.prototype,"flipVertically",1),s([Me.computed],J.prototype,"flipCenter",1),s([Me.computed],J.prototype,"leftTop",1),s([Me.computed],J.prototype,"leftBottom",1),s([Me.computed],J.prototype,"rightTop",1),s([Me.computed],J.prototype,"rightBottom",1),s([Me.computed],J.prototype,"leftBottomHandle",1),s([Me.computed],J.prototype,"rightBottomHandle",1),s([Me.computed],J.prototype,"leftMid",1),s([Me.computed],J.prototype,"rightMid",1);const $i=(e,t=0,i=3)=>{const r=Math.tan(t),o=Math.sqrt(r**2+1);return{x:e.x+i/o,y:e.y+i*r/o}};const Co={blurRadius:40,gradientSize:.2},mm=p({start:{x:0,y:0},end:{x:0,y:0}},Co),gm=p({center:{x:0,y:0},radius:0},Co),bm=p({origin:{x:0,y:0},rotation:0,size:0},Co),ym=Co,xi={identifier:"identity",linear:mm,radial:gm,mirrored:bm,gaussian:ym};const xe=m(b());class ze{constructor(e){this.selectFocus=(e,t)=>{xe.runInAction(()=>{this.state.identifier=e,t&&(this.state[e].blurRadius=t)})};this.changeBlurRadius=(e,t)=>{e!=="identity"&&(this.state[e].blurRadius=t)};this.reset=()=>{this.indexInContainer===-1&&(this.state.identifier=xi.identifier,this.state.identifier!=="identity"&&(this.state[this.state.identifier].blurRadius=xi[this.state.identifier].blurRadius))};this.setLinear=({start:e,end:t})=>{this.state.linear.start.x=e.x,this.state.linear.start.y=e.y,this.state.linear.end.x=t.x,this.state.linear.end.y=t.y};this.setLinearStart=e=>{this.state.linear.start.x=e.x,this.state.linear.start.y=e.y};this.setLinearEnd=e=>{this.state.linear.end.x=e.x,this.state.linear.end.y=e.y};this.setRadialCenter=e=>{this.state.radial.center.x=e.x,this.state.radial.center.y=e.y};this.setRadialRadius=e=>{this.state.radial.radius=e};this.setMirroredOrigin=e=>{this.state.mirrored.origin.x=e.x,this.state.mirrored.origin.y=e.y};this.setMirroredRotation=e=>{this.state.mirrored.rotation=e};this.setMirroredSize=e=>{this.state.mirrored.size=e};this.getEffectProperties=()=>this.effect?this.effect.getProperties():null;this.setLinearFocus=e=>{this.effect=this.engineMediator.engine.addLinearBlur(e,this.imageContainer,this.order),this.updateLinearState(this.effect.getProperties())};this.setGaussianFocus=e=>{this.effect=this.engineMediator.engine.addGaussianBlur(e,this.imageContainer,this.order),this.updateGaussianState(this.effect.getProperties())};this.setRadialFocus=e=>{this.effect=this.engineMediator.engine.addRadialBlur(e,this.imageContainer,this.order),this.updateRadialState(this.effect.getProperties())};this.setMirroredFocus=e=>{this.effect=this.engineMediator.engine.addMirroredBlur(e,this.imageContainer,this.order),this.updateMirroredState(this.effect.getProperties())};this.updateFromEngineState=e=>{const t=this.getEffectProperties();if(t&&e!=="identity")switch(e){case K.LINEAR:this.updateLinearState(t);break;case K.RADIAL:this.updateRadialState(t);break;case K.MIRRORED:this.updateMirroredState(t);break;default:break}};this.updateGaussianState=e=>{this.changeBlurRadius(K.GAUSSIAN,e.blurRadius)};this.updateMirroredState=e=>{const t=this.editor.worldToPreview(e.mirrorAxisOrigin),i=new D(this.editor.worldToPreview(e.mirrorAxisDirection)),r=i.subtract(t),o=Math.atan2(r.y,r.x);this.setMirroredOrigin(this.editor.worldToPreview(e.mirrorAxisOrigin)),this.setMirroredRotation(o),this.setMirroredSize(this.editor.worldToPreview(e.clearAreaWidth)),this.changeBlurRadius(K.MIRRORED,e.blurRadius)};this.updateRadialState=e=>{this.setRadialCenter(this.editor.worldToPreview(e.center)),this.setRadialRadius(this.editor.worldToPreview(e.radius)),this.changeBlurRadius(K.RADIAL,e.blurRadius)};this.updateLinearState=e=>{this.setLinearStart(this.editor.worldToPreview(e.start)),this.setLinearEnd(this.editor.worldToPreview(e.end)),this.changeBlurRadius(K.LINEAR,e.blurRadius)};this.setEffectProperties=e=>this.effect?(this.effect.setProperties(e),this.effect.getProperties()):null;this.removeFocus=()=>{this.effect&&(this.engineMediator.engine.removeEffect(this.effect),this.engineMediator.orderHelper.removeIndex(f.FOCUS))};this.editor=e,this.engineMediator=this.editor.engineMediator,this.state=xi}get indexInContainer(){return this.effect?this.effect.getIndexInParent():-1}get order(){return this.engineMediator.orderHelper.addIndex(f.FOCUS)}get imageContainer(){return this.engineMediator.image.container}}s([xe.observable],ze.prototype,"state",2),s([xe.action],ze.prototype,"selectFocus",2),s([xe.action],ze.prototype,"changeBlurRadius",2),s([xe.action],ze.prototype,"reset",2),s([xe.action],ze.prototype,"setLinear",2),s([xe.action],ze.prototype,"setLinearStart",2),s([xe.action],ze.prototype,"setLinearEnd",2),s([xe.action],ze.prototype,"setRadialCenter",2),s([xe.action],ze.prototype,"setRadialRadius",2),s([xe.action],ze.prototype,"setMirroredOrigin",2),s([xe.action],ze.prototype,"setMirroredRotation",2),s([xe.action],ze.prototype,"setMirroredSize",2),s([xe.action],ze.prototype,"updateFromEngineState",2);const L=m(b());class j{constructor(e){this.selectFocus=e=>{if(e!==this.identifier){this.focusStore.removeFocus();const t=this.maxIntensity*.2,{width:i}=this.editor.engine.getOutputContainer().getBounds(),r=this.editor.shortestOutputSide*.2;switch(e){case K.LINEAR:const o=this.editor.outputToWorld({x:-i/2,y:0}),n=this.editor.outputToWorld({x:i/2,y:0});this.setLinearFocus({start:o,end:n,blurRadius:t});break;case K.RADIAL:const a=this.editor.outputToWorld({x:0,y:0});this.setRadialFocus({center:a,radius:r,blurRadius:t});break;case K.MIRRORED:const l=this.editor.outputToWorld({x:0,y:0}),c=r,d=this.editor.outputToWorld($i({x:0,y:0},0));this.setMirroredFocus({mirrorAxisOrigin:l,clearAreaWidth:c,blurRadius:t,mirrorAxisDirection:d});break;case K.GAUSSIAN:this.setGaussianFocus({blurRadius:t});break;default:break}this.focusStore.selectFocus(e,t),this.editor.render(),this.addSnapshot(R.ADD,f.FOCUS)}};this.changeIntensity=e=>{const t=this.focusStore.setEffectProperties({blurRadius:e});t&&(this.focusStore.changeBlurRadius(this.identifier,t.blurRadius),this.editor.render())};this.toolSnapshot=e=>{this.addSnapshot(R.EDIT,e)};this.addSnapshot=(e,t)=>{this.editor.addSnapshot(void 0,e,t)};this.clickableCanvas=e=>{this.editor.clickableCanvas(e)};this.pureReset=()=>{this.focusStore.removeFocus(),this.focusStore.reset()};this.reset=()=>{this.pureReset(),this.editor.render(),this.addSnapshot(R.DELETE,this.locale.controls.buttonReset)};this.setStart=e=>{const t=this.focusStore.setEffectProperties({start:this.editor.previewToWorld(e)});t&&(this.focusStore.setLinearStart(this.editor.worldToPreview(t.start)),this.editor.render())};this.setEnd=e=>{const t=this.focusStore.setEffectProperties({end:this.editor.previewToWorld(e)});t&&(this.focusStore.setLinearEnd(this.editor.worldToPreview(t.end)),this.editor.render())};this.setCenter=e=>{const t=this.focusStore.setEffectProperties({center:this.editor.previewToWorld(e)});t&&(this.focusStore.setRadialCenter(this.editor.worldToPreview(t.center)),this.editor.render())};this.setRadius=e=>{const t=this.focusStore.setEffectProperties({radius:this.editor.previewToWorld(e)});t&&(this.focusStore.setRadialRadius(this.editor.worldToPreview(t.radius)),this.editor.render())};this.setOrigin=e=>{const t=this.focusStore.setEffectProperties({mirrorAxisOrigin:this.editor.previewToWorld(e),mirrorAxisDirection:this.editor.previewToWorld($i(e,this.rotation))});t&&(this.focusStore.setMirroredOrigin(this.editor.worldToPreview(t.mirrorAxisOrigin)),this.editor.render())};this.setSize=e=>{const t=this.focusStore.setEffectProperties({clearAreaWidth:this.editor.previewToWorld(e)});t&&(this.focusStore.setMirroredSize(this.editor.worldToPreview(t.clearAreaWidth)),this.editor.render())};this.setRotation=e=>{this.focusStore.setEffectProperties({mirrorAxisDirection:this.editor.previewToWorld($i(this.origin,e))}),this.focusStore.setMirroredRotation(e),this.editor.render()};this.updateStateFromHistory=(e,t)=>{this.focusStore.removeFocus();const{magnitude:i}=t;L.runInAction(()=>{switch(e.identifier){case K.LINEAR:this.focusStore.selectFocus(K.LINEAR),this.setLinearFocus({start:this.editor.previewToWorld(new D(e.linear.start).multiply(t)),end:this.editor.previewToWorld(new D(e.linear.end).multiply(t)),blurRadius:e.linear.blurRadius});break;case K.GAUSSIAN:this.focusStore.selectFocus(K.GAUSSIAN),this.setGaussianFocus({blurRadius:e.gaussian.blurRadius});break;case K.RADIAL:this.focusStore.selectFocus(K.RADIAL),this.setRadialFocus({center:this.editor.previewToWorld(new D(e.radial.center).multiply(t)),radius:this.editor.previewToWorld(e.radial.radius*i),blurRadius:e.radial.blurRadius});break;case K.MIRRORED:this.focusStore.selectFocus(K.MIRRORED),this.setMirroredFocus({mirrorAxisOrigin:this.editor.previewToWorld(new D(e.mirrored.origin).multiply(t)),clearAreaWidth:this.editor.previewToWorld(e.mirrored.size*i),blurRadius:e.mirrored.blurRadius,mirrorAxisDirection:this.editor.previewToWorld($i(e.mirrored.origin,e.mirrored.rotation))});break;case"identity":this.pureReset();break;default:break}})};this.updateStateFromSerialization=e=>I(this,null,function*(){if(j.doesFocusIdentifierExist(e.identifier))this.focusStore.removeFocus(),L.runInAction(()=>{this.focusStore.selectFocus(e.identifier);switch(e.identifier){case K.LINEAR:this.setLinearFocus(e.linear);break;case K.GAUSSIAN:this.setGaussianFocus(e.gaussian);break;case K.RADIAL:this.setRadialFocus(e.radial);break;case K.MIRRORED:this.setMirroredFocus({mirrorAxisOrigin:e.mirrored.origin,clearAreaWidth:e.mirrored.size,blurRadius:e.mirrored.blurRadius,mirrorAxisDirection:$i(e.mirrored.origin,e.mirrored.rotation)});break;default:break}});else throw new Error(`Focus identifier ${e.identifier} doesn't exist`)});this.updateCanvasControls=()=>{this.focusStore.updateFromEngineState(this.identifier)};this.getFocusStateForHistory=()=>{const e=this.editor.canvasStore.sizeVector,{linear:t}=this.focusStore.state,{radial:i}=this.focusStore.state,{mirrored:r}=this.focusStore.state,o=e,{magnitude:n}=o;return p(p({},this.focusStore.state),{linear:p(p({},t),{start:new D(t.start).divide(o),end:new D(t.end).divide(o)}),radial:p(p({},i),{center:new D(i.center).divide(o),radius:i.radius/n}),mirrored:p(p({},r),{origin:new D(r.origin).divide(o),size:r.size/n}),gaussian:p({},this.focusStore.state.gaussian)})};this.editor=e,this.focusStore=new ze(this.editor);const t=this.editor.assetProvider.getAssets("focus");this.entityManager=new de(t,p(p({},this.config),{categoryKey:"",itemKey:"thumbnailURI",flattenCategories:!0,locale:this.locale.items,getAssetPath:this.editor.getAssetPath("focus")}))}static get minIntensity(){return 0}static doesFocusIdentifierExist(e){return Object.keys(K).map(t=>K[t]).findIndex(t=>t===e)!==-1}get state(){return this.focusStore.state}get serializableState(){switch(this.identifier){case K.LINEAR:return{identifier:this.identifier,linear:this.focusStore.getEffectProperties()};case K.RADIAL:return{identifier:this.identifier,radial:this.focusStore.getEffectProperties()};case K.MIRRORED:const e=this.focusStore.getEffectProperties();return{identifier:this.identifier,mirrored:{blurRadius:e.blurRadius,origin:e.mirrorAxisOrigin,rotation:L.toJS(this.state.mirrored.rotation),size:e.clearAreaWidth}};case K.GAUSSIAN:return{identifier:this.identifier,gaussian:this.focusStore.getEffectProperties()};default:return xi}}get start(){return this.focusStore.state.linear.start}get startOnPreview(){const e=this.editor.applyFlipToPreview(this.focusStore.state.linear.start);return{x:Math.abs(e.x),y:Math.abs(e.y)}}get end(){return this.focusStore.state.linear.end}get endOnPreview(){const e=this.editor.applyFlipToPreview(this.focusStore.state.linear.end);return{x:Math.abs(e.x),y:Math.abs(e.y)}}get center(){return this.focusStore.state.radial.center}get radius(){return this.focusStore.state.radial.radius}get origin(){return this.focusStore.state.mirrored.origin}get rotation(){return this.focusStore.state.mirrored.rotation}get rotationOnPreview(){const{flipHorizontally:e,flipVertically:t}=this.editor.outputContainer.getData();return Dr({rotation:this.focusStore.state.mirrored.rotation,flipHorizontally:e,flipVertically:t})}get size(){return this.focusStore.state.mirrored.size}get mirroredAreaWidth(){const{width:e,height:t}=this.editor.canvasStore.canvasSize;return Math.sqrt(e**2+t**2)*2}get identifier(){return this.state.identifier}get intensity(){return this.identifier==="identity"?xi.gaussian.blurRadius:this.state[this.identifier].blurRadius}get maxIntensity(){return this.editor.shortestOutputSide/10}get isOptionSelected(){return this.identifier!=="identity"}get config(){return this.editor.configStore.config[f.FOCUS]}get locale(){return this.editor.configStore.locale[f.FOCUS]}get items(){return this.entityManager.items}setGaussianFocus({blurRadius:e}){this.focusStore.setGaussianFocus({blurRadius:e})}setLinearFocus({start:e,end:t,blurRadius:i}){this.focusStore.setLinearFocus({start:e,end:t,blurRadius:i})}setRadialFocus({center:e,radius:t,blurRadius:i}){this.focusStore.setRadialFocus({center:e,radius:t,blurRadius:i})}setMirroredFocus({mirrorAxisOrigin:e,clearAreaWidth:t,blurRadius:i,mirrorAxisDirection:r}){this.focusStore.setMirroredFocus({mirrorAxisOrigin:e,clearAreaWidth:t,blurRadius:i,mirrorAxisDirection:r})}}s([L.action],j.prototype,"selectFocus",2),s([L.action],j.prototype,"changeIntensity",2),s([L.action],j.prototype,"clickableCanvas",2),s([L.action],j.prototype,"pureReset",2),s([L.action],j.prototype,"reset",2),s([L.action],j.prototype,"setStart",2),s([L.action],j.prototype,"setEnd",2),s([L.action],j.prototype,"setCenter",2),s([L.action],j.prototype,"setRadius",2),s([L.action],j.prototype,"setOrigin",2),s([L.action],j.prototype,"setSize",2),s([L.action],j.prototype,"setRotation",2),s([L.action],j.prototype,"updateStateFromHistory",2),s([L.action],j.prototype,"updateStateFromSerialization",2),s([L.action],j.prototype,"updateCanvasControls",2),s([L.computed],j.prototype,"state",1),s([L.computed],j.prototype,"start",1),s([L.computed],j.prototype,"startOnPreview",1),s([L.computed],j.prototype,"end",1),s([L.computed],j.prototype,"endOnPreview",1),s([L.computed],j.prototype,"center",1),s([L.computed],j.prototype,"radius",1),s([L.computed],j.prototype,"origin",1),s([L.computed],j.prototype,"rotation",1),s([L.computed],j.prototype,"rotationOnPreview",1),s([L.computed],j.prototype,"size",1),s([L.computed],j.prototype,"mirroredAreaWidth",1),s([L.computed],j.prototype,"identifier",1),s([L.computed],j.prototype,"intensity",1),s([L.computed],j.prototype,"maxIntensity",1),s([L.computed],j.prototype,"isOptionSelected",1),s([L.computed],j.prototype,"config",1),s([L.computed],j.prototype,"locale",1),s([L.computed],j.prototype,"items",1);import{keyframes as vm}from"styled-components";const _o=vm`
from {
  opacity: 1;
  transform: scale(0);
}
to {
  opacity: 0;
  transform: scale(10);
}
`;import{keyframes as Sm}from"styled-components";const fc=Sm`
  0% {
    opacity: 0;
    transform: scale(0.9);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
`;import{keyframes as wm}from"styled-components";const Eo=wm`
  0% {
    opacity: 0;
    transform: scale(0.9) translateY(-20px);
  }
  100% {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
`;var Qe=[];var mc=function(){return Qe.some(function(e){return e.activeTargets.length>0})};var gc=function(){return Qe.some(function(e){return e.skippedTargets.length>0})};var bc="ResizeObserver loop completed with undelivered notifications.",yc=function(){var e;typeof ErrorEvent=="function"?e=new ErrorEvent("error",{message:bc}):(e=document.createEvent("Event"),e.initEvent("error",!1,!1),e.message=bc),window.dispatchEvent(e)};var Ci;(function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"})(Ci||(Ci={}));var vs=function(){function e(t,i,r,o){return this.x=t,this.y=i,this.width=r,this.height=o,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,Object.freeze(this)}return e.prototype.toJSON=function(){var t=this,i=t.x,r=t.y,o=t.top,n=t.right,a=t.bottom,l=t.left,c=t.width,d=t.height;return{x:i,y:r,top:o,right:n,bottom:a,left:l,width:c,height:d}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}();var Fr=function(e){return e instanceof SVGElement&&"getBBox"in e},ko=function(e){if(Fr(e)){var t=e.getBBox(),i=t.width,r=t.height;return!i&&!r}var o=e,n=o.offsetWidth,a=o.offsetHeight;return!(n||a||e.getClientRects().length)},Vi=function(e){var t,i,r=(i=(t=e)===null||t===void 0?void 0:t.ownerDocument)===null||i===void 0?void 0:i.defaultView;return!!(r&&e instanceof r.Element)},vc=function(e){switch(e.tagName){case"INPUT":if(e.type!=="image")break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1};var _i=typeof window!="undefined"?window:{};var Gi=new Map,Sc=/auto|scroll/,Dm=/^tb|vertical/,xm=/msie|trident/i.test(_i.navigator&&_i.navigator.userAgent),_t=function(e){return parseFloat(e||"0")},qi=function(e,t,i){return e===void 0&&(e=0),t===void 0&&(t=0),i===void 0&&(i=!1),Object.freeze({inlineSize:(i?t:e)||0,blockSize:(i?e:t)||0})},wc=Object.freeze({devicePixelContentBoxSize:qi(),borderBoxSize:qi(),contentBoxSize:qi(),contentRect:new vs(0,0,0,0)}),Ss=function(e){if(Gi.has(e))return Gi.get(e);if(ko(e))return Gi.set(e,wc),wc;var t=getComputedStyle(e),i=Fr(e)&&e.ownerSVGElement&&e.getBBox(),r=!xm&&t.boxSizing==="border-box",o=Dm.test(t.writingMode||""),n=!i&&Sc.test(t.overflowY||""),a=!i&&Sc.test(t.overflowX||""),l=i?0:_t(t.paddingTop),c=i?0:_t(t.paddingRight),d=i?0:_t(t.paddingBottom),u=i?0:_t(t.paddingLeft),h=i?0:_t(t.borderTopWidth),y=i?0:_t(t.borderRightWidth),k=i?0:_t(t.borderBottomWidth),w=i?0:_t(t.borderLeftWidth),T=u+c,F=l+d,$=w+y,E=h+k,ce=a?e.offsetHeight-E-e.clientHeight:0,bt=n?e.offsetWidth-$-e.clientWidth:0,_e=r?T+$:0,M=r?F+E:0,Z=i?i.width:_t(t.width)-_e-bt,pe=i?i.height:_t(t.height)-M-ce,Tt=Z+T+bt+$,un=pe+F+ce+E,Yr=Object.freeze({devicePixelContentBoxSize:qi(Math.round(Z*devicePixelRatio),Math.round(pe*devicePixelRatio),o),borderBoxSize:qi(Tt,un,o),contentBoxSize:qi(Z,pe,o),contentRect:new vs(u,l,Z,pe)});return Gi.set(e,Yr),Yr},To=function(e,t){var i=Ss(e),r=i.borderBoxSize,o=i.contentBoxSize,n=i.devicePixelContentBoxSize;switch(t){case Ci.DEVICE_PIXEL_CONTENT_BOX:return n;case Ci.BORDER_BOX:return r;default:return o}};var ws=function(){function e(t){var i=Ss(t);this.target=t,this.contentRect=i.contentRect,this.borderBoxSize=[i.borderBoxSize],this.contentBoxSize=[i.contentBoxSize],this.devicePixelContentBoxSize=[i.devicePixelContentBoxSize]}return e}();var Oo=function(e){if(ko(e))return Infinity;for(var t=0,i=e.parentNode;i;)t+=1,i=i.parentNode;return t};var Dc=function(){var e=Infinity,t=[];Qe.forEach(function(a){if(a.activeTargets.length===0)return;var l=[];a.activeTargets.forEach(function(d){var u=new ws(d.target),h=Oo(d.target);l.push(u),d.lastReportedSize=To(d.target,d.observedBox),h<e&&(e=h)}),t.push(function(){a.callback.call(a.observer,l,a.observer)}),a.activeTargets.splice(0,a.activeTargets.length)});for(var i=0,r=t;i<r.length;i++){var o=r[i];o()}return e};var Ds=function(e){Gi.clear(),Qe.forEach(function(i){i.activeTargets.splice(0,i.activeTargets.length),i.skippedTargets.splice(0,i.skippedTargets.length),i.observationTargets.forEach(function(o){o.isActive()&&(Oo(o.target)>e?i.activeTargets.push(o):i.skippedTargets.push(o))})})};var xc=function(){var e=0;for(Ds(e);mc();)e=Dc(),Ds(e);return gc()&&yc(),e>0};var xs,Cc=[],Cm=function(){return Cc.splice(0).forEach(function(e){return e()})},_c=function(e){if(!xs){var t=0,i=document.createTextNode(""),r={characterData:!0};new MutationObserver(function(){return Cm()}).observe(i,r),xs=function(){i.textContent=""+(t?t--:t++)}}Cc.push(e),xs()};var Ec=function(e){_c(function(){requestAnimationFrame(e)})};var Io=0,_m=function(){return!!Io},Em=60/5,km={attributes:!0,characterData:!0,childList:!0,subtree:!0},kc=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],Cs=!1,Tm=function(){function e(){var t=this;this.stopped=!0,this.listener=function(){return t.schedule()}}return e.prototype.run=function(t){var i=this;if(Cs)return;Cs=!0,Ec(function(){var r=!1;try{r=xc()}finally{if(Cs=!1,!_m())return;r?i.run(60):t?i.run(t-1):i.start()}})},e.prototype.schedule=function(){this.stop(),this.run(Em)},e.prototype.observe=function(){var t=this,i=function(){return t.observer&&t.observer.observe(document.body,km)};document.body?i():_i.addEventListener("DOMContentLoaded",i)},e.prototype.start=function(){var t=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),kc.forEach(function(i){return _i.addEventListener(i,t.listener,!0)}))},e.prototype.stop=function(){var t=this;this.stopped||(this.observer&&this.observer.disconnect(),kc.forEach(function(i){return _i.removeEventListener(i,t.listener,!0)}),this.stopped=!0)},e}(),Fo=new Tm,Ao=function(e){!Io&&e>0&&Fo.start(),Io+=e,!Io&&Fo.stop()};var Om=function(e){return!Fr(e)&&!vc(e)&&getComputedStyle(e).display==="inline"},Tc=function(){function e(t,i){this.target=t,this.observedBox=i||Ci.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var t=To(this.target,this.observedBox);return Om(this.target)&&(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}();var Oc=function(){function e(t,i){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=t,this.callback=i}return e}();var ni=new Map,Ic=function(e,t){for(var i=0;i<e.length;i+=1)if(e[i].target===t)return i;return-1},Ar=function(){function e(){}return e.connect=function(t,i){var r=new Oc(t,i);Qe.push(r),ni.set(t,r)},e.observe=function(t,i,r){if(ni.has(t)){var o=ni.get(t);Ic(o.observationTargets,i)<0&&(o.observationTargets.push(new Tc(i,r&&r.box)),Ao(1),Fo.schedule())}},e.unobserve=function(t,i){if(ni.has(t)){var r=ni.get(t),o=Ic(r.observationTargets,i);o>=0&&(r.observationTargets.splice(o,1),Ao(-1))}},e.disconnect=function(t){if(ni.has(t)){var i=ni.get(t);Qe.splice(Qe.indexOf(i),1),ni.delete(t),Ao(-i.observationTargets.length)}},e}();var Rr=function(){function e(t){if(arguments.length===0)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if(typeof t!="function")throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");Ar.connect(this,t)}return e.prototype.observe=function(t,i){if(arguments.length===0)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Vi(t))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");Ar.observe(this,t,i)},e.prototype.unobserve=function(t){if(arguments.length===0)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!Vi(t))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");Ar.unobserve(this,t)},e.prototype.disconnect=function(){Ar.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}();import Im from"react";const Fc=Im.createContext({});const Ac=m(At());import Ei from"react";import Fm from"styled-components";const Am=Fm.div`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  margin: 0;
  background: ${e=>e.theme.background};
  color: ${e=>e.theme.foreground};
  display: flex;
  flex-direction: row;
  overflow-y: hidden;
  overflow-x: hidden;
  -webkit-touch-callout: none;
  user-select: none;
  * {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-family: '${e=>e.theme.typography.fontFamily}', sans-serif;
    /* css reset for a global box-sizing: border-box */
    box-sizing: content-box;
    /* todo: fix the issue with these settings */
    font-size: inherit;
    color: inherit;
    line-height: normal;
  }
`;class Rm extends Ei.Component{constructor(e){super(e);this.node=Ei.createRef();this.saveEditorDimensions=e=>{this.setState({contextValue:{element:e,rect:e.getBoundingClientRect()}})};var t;if((t=Ei)==null?void 0:t.version){const i=Number.parseInt(Ei.version.split(".")[0],10),r=Number.parseInt(Ei.version.split(".")[1],10);(i<16||i===16&&r<8)&&console.warn("Please be aware that the next minor update of the PhotoEditorSDK will require React 16.8.6 or above.")}this.saveEditorDimensions=Ac.default(this.saveEditorDimensions,100),this.resizeObserver=new Rr(([i])=>{this.saveEditorDimensions(i.target)}),this.state={contextValue:{element:null,rect:null}}}componentDidMount(){var e;((e=this.node)==null?void 0:e.current)&&this.resizeObserver.observe(this.node.current)}componentWillUnmount(){var e;((e=this.node)==null?void 0:e.current)&&this.resizeObserver.unobserve(this.node.current)}render(){const{children:e}=this.props,{contextValue:t}=this.state;return Ei.createElement(Am,{ref:this.node},Ei.createElement(Fc.Provider,{value:t},e))}}var Rc=Rm;const ee=m(b());import Mc,{Component as Xi,createElement as Mm,PureComponent as zm,forwardRef as _s,Children as Pm}from"react";import{findDOMNode as zc,unstable_batchedUpdates as Pc}from"react-dom";function si(e){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?si=function(t){return typeof t}:si=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},si(e)}function Ro(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bc(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Mo(e,t,i){return t&&Bc(e.prototype,t),i&&Bc(e,i),e}function Mr(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ks(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Es(e,t)}function zr(e){return zr=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},zr(e)}function Es(e,t){return Es=Object.setPrototypeOf||function(r,o){return r.__proto__=o,r},Es(e,t)}function Bm(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ts(e,t){return t&&(typeof t=="object"||typeof t=="function")?t:Bm(e)}function Lm(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Lc(e,t){return t={exports:{}},e(t,t.exports),t.exports}var ie=Lc(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=typeof Symbol=="function"&&Symbol.for,r=i?Symbol.for("react.element"):60103,o=i?Symbol.for("react.portal"):60106,n=i?Symbol.for("react.fragment"):60107,a=i?Symbol.for("react.strict_mode"):60108,l=i?Symbol.for("react.profiler"):60114,c=i?Symbol.for("react.provider"):60109,d=i?Symbol.for("react.context"):60110,u=i?Symbol.for("react.async_mode"):60111,h=i?Symbol.for("react.concurrent_mode"):60111,y=i?Symbol.for("react.forward_ref"):60112,k=i?Symbol.for("react.suspense"):60113,w=i?Symbol.for("react.memo"):60115,T=i?Symbol.for("react.lazy"):60116;function F(E){if(typeof E=="object"&&E!==null){var ce=E.$$typeof;switch(ce){case r:switch(E=E.type,E){case u:case h:case n:case l:case a:return E;default:switch(E=E&&E.$$typeof,E){case d:case y:case c:return E;default:return ce}}case o:return ce}}}function $(E){return F(E)===h}t.typeOf=F,t.AsyncMode=u,t.ConcurrentMode=h,t.ContextConsumer=d,t.ContextProvider=c,t.Element=r,t.ForwardRef=y,t.Fragment=n,t.Profiler=l,t.Portal=o,t.StrictMode=a,t.isValidElementType=function(E){return typeof E=="string"||typeof E=="function"||E===n||E===h||E===l||E===a||E===k||typeof E=="object"&&E!==null&&(E.$$typeof===T||E.$$typeof===w||E.$$typeof===c||E.$$typeof===d||E.$$typeof===y)},t.isAsyncMode=function(E){return $(E)||F(E)===u},t.isConcurrentMode=$,t.isContextConsumer=function(E){return F(E)===d},t.isContextProvider=function(E){return F(E)===c},t.isElement=function(E){return typeof E=="object"&&E!==null&&E.$$typeof===r},t.isForwardRef=function(E){return F(E)===y},t.isFragment=function(E){return F(E)===n},t.isProfiler=function(E){return F(E)===l},t.isPortal=function(E){return F(E)===o},t.isStrictMode=function(E){return F(E)===a}});Lm(ie);var oT=ie.typeOf,nT=ie.AsyncMode,sT=ie.ConcurrentMode,aT=ie.ContextConsumer,lT=ie.ContextProvider,cT=ie.Element,dT=ie.ForwardRef,uT=ie.Fragment,hT=ie.Profiler,pT=ie.Portal,fT=ie.StrictMode,mT=ie.isValidElementType,gT=ie.isAsyncMode,bT=ie.isConcurrentMode,yT=ie.isContextConsumer,vT=ie.isContextProvider,ST=ie.isElement,wT=ie.isForwardRef,DT=ie.isFragment,xT=ie.isProfiler,CT=ie.isPortal,_T=ie.isStrictMode,Nm=Lc(function(e){e.exports=ie}),Nc={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Hm={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},jm={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Os={};Os[Nm.ForwardRef]=jm;var Wm=Object.defineProperty,Um=Object.getOwnPropertyNames,Hc=Object.getOwnPropertySymbols,$m=Object.getOwnPropertyDescriptor,Vm=Object.getPrototypeOf,jc=Object.prototype;function Wc(e,t,i){if(typeof t!="string"){if(jc){var r=Vm(t);r&&r!==jc&&Wc(e,r,i)}var o=Um(t);Hc&&(o=o.concat(Hc(t)));for(var n=Os[e.$$typeof]||Nc,a=Os[t.$$typeof]||Nc,l=0;l<o.length;++l){var c=o[l];if(!Hm[c]&&!(i&&i[c])&&!(a&&a[c])&&!(n&&n[c])){var d=$m(t,c);try{Wm(e,c,d)}catch(u){}}}return e}return e}var Uc=Wc,$c=function(){function e(){Ro(this,e),this.listeners=[]}return Mo(e,[{key:"on",value:function(i){var r=this;return this.listeners.push(i),function(){var o=r.listeners.indexOf(i);o!==-1&&r.listeners.splice(o,1)}}},{key:"emit",value:function(i){this.listeners.forEach(function(r){return r(i)})}}]),e}();function Vc(e){function t(r,o,n,a,l,c){for(var d=arguments.length,u=new Array(d>6?d-6:0),h=6;h<d;h++)u[h-6]=arguments[h];return ee.untracked(function(){if(a=a||"<<anonymous>>",c=c||n,o[n]==null){if(r){var y=o[n]===null?"null":"undefined";return new Error("The "+l+" `"+c+"` is marked as required in `"+a+"`, but its value is `"+y+"`.")}return null}else return e.apply(void 0,[o,n,a,l,c].concat(u))})}var i=t.bind(null,!1);return i.isRequired=t.bind(null,!0),i}function Gm(e,t){return e==="symbol"||t["@@toStringTag"]==="Symbol"?!0:typeof Symbol=="function"&&t instanceof Symbol}function Gc(e){var t=si(e);return Array.isArray(e)?"array":e instanceof RegExp?"object":Gm(t,e)?"symbol":t}function qm(e){var t=Gc(e);if(t==="object"){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function Ki(e,t){return Vc(function(i,r,o,n,a){return ee.untracked(function(){if(e&&Gc(i[r])===t.toLowerCase())return null;var l;switch(t){case"Array":l=ee.isObservableArray;break;case"Object":l=ee.isObservableObject;break;case"Map":l=ee.isObservableMap;break;default:throw new Error("Unexpected mobxType: ".concat(t))}var c=i[r];if(!l(c)){var d=qm(c),u=e?" or javascript `"+t.toLowerCase()+"`":"";return new Error("Invalid prop `"+a+"` of type `"+d+"` supplied to `"+o+"`, expected `mobx.Observable"+t+"`"+u+".")}return null})})}function qc(e,t){return Vc(function(i,r,o,n,a){for(var l=arguments.length,c=new Array(l>5?l-5:0),d=5;d<l;d++)c[d-5]=arguments[d];return ee.untracked(function(){if(typeof t!="function")return new Error("Property `"+a+"` of component `"+o+"` has invalid PropType notation.");var u=Ki(e,"Array")(i,r,o);if(u instanceof Error)return u;for(var h=i[r],y=0;y<h.length;y++)if(u=t.apply(void 0,[h,y,o,n,a+"["+y+"]"].concat(c)),u instanceof Error)return u;return null})})}var ET=Ki(!1,"Array"),kT=qc.bind(null,!1),TT=Ki(!1,"Map"),OT=Ki(!1,"Object"),IT=Ki(!0,"Array"),FT=qc.bind(null,!0),Is=Ki(!0,"Object");function Xm(e){return!(e.prototype&&e.prototype.render)}var Xc=0;function Km(e){if(typeof Symbol=="function")return Symbol(e);var t="__$mobx-react ".concat(e," (").concat(Xc,")");return Xc++,t}var Fs={};function ai(e){return Fs[e]||(Fs[e]=Km(e)),Fs[e]}var Kc=ai("patchMixins"),Yc=ai("patchedDefinition");function Ym(e,t){var i=e[Kc]=e[Kc]||{},r=i[t]=i[t]||{};return r.locks=r.locks||0,r.methods=r.methods||[],r}function Jc(e,t){for(var i=this,r=arguments.length,o=new Array(r>2?r-2:0),n=2;n<r;n++)o[n-2]=arguments[n];t.locks++;try{var a;return e!=null&&(a=e.apply(this,o)),a}finally{t.locks--,t.locks===0&&t.methods.forEach(function(l){l.apply(i,o)})}}function Zc(e,t){var i=function(){for(var o=arguments.length,n=new Array(o),a=0;a<o;a++)n[a]=arguments[a];Jc.call.apply(Jc,[this,e,t].concat(n))};return i}function Jm(e,t){for(var i=Ym(e,t),r=arguments.length,o=new Array(r>2?r-2:0),n=2;n<r;n++)o[n-2]=arguments[n];for(var a=0;a<o.length;a++){var l=o[a];i.methods.indexOf(l)<0&&i.methods.push(l)}var c=Object.getOwnPropertyDescriptor(e,t);if(c&&c[Yc])return;var d=e[t],u=Qc(e,t,c?c.enumerable:void 0,i,d);Object.defineProperty(e,t,u)}function Qc(e,t,i,r,o){var n,a=Zc(o,r);return n={},Mr(n,Yc,!0),Mr(n,"get",function(){return a}),Mr(n,"set",function(c){if(this===e)a=Zc(c,r);else{var d=Qc(this,t,i,r,c);Object.defineProperty(this,t,d)}}),Mr(n,"configurable",!0),Mr(n,"enumerable",i),n}var ed={mobxStores:Is};Object.seal(ed);var Zm={contextTypes:{get:function(){return ed},set:function(t){console.warn("Mobx Injector: you are trying to attach `contextTypes` on an component decorated with `inject` (or `observer`) HOC. Please specify the contextTypes on the wrapped component instead. It is accessible through the `wrappedComponent`")},configurable:!0,enumerable:!1},isMobxInjector:{value:!0,writable:!0,configurable:!0,enumerable:!0}};function td(e,t,i){var r="inject-"+(t.displayName||t.name||t.constructor&&t.constructor.name||"Unknown");i&&(r+="-with-"+i);var o=function(n){ks(a,n);function a(){var l,c;Ro(this,a);for(var d=arguments.length,u=new Array(d),h=0;h<d;h++)u[h]=arguments[h];return c=Ts(this,(l=zr(a)).call.apply(l,[this].concat(u))),c.storeRef=function(y){c.wrappedInstance=y},c}return Mo(a,[{key:"render",value:function(){var c={};for(var d in this.props)this.props.hasOwnProperty(d)&&(c[d]=this.props[d]);var u=e(this.context.mobxStores||{},c,this.context)||{};for(var h in u)c[h]=u[h];return Xm(t)||(c.ref=this.storeRef),Mm(t,c)}}]),a}(Xi);return o.displayName=r,Uc(o,t),o.wrappedComponent=t,Object.defineProperties(o,Zm),o}function Qm(e){return function(t,i){return e.forEach(function(r){if(r in i)return;if(!(r in t))throw new Error("MobX injector: Store '"+r+"' is not available! Make sure it is provided by some Provider");i[r]=t[r]}),i}}function zo(){var e;if(typeof arguments[0]=="function")return e=arguments[0],function(r){var o=td(e,r);return o.isMobxInjector=!1,o=ki(o),o.isMobxInjector=!0,o};for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return e=Qm(t),function(r){return td(e,r,t.join("-"))}}var As=ee.$mobx||"$mobx",id=ai("isUnmounted"),Ti=!1,Rs=!1,rd=!1,Yi=typeof WeakMap!="undefined"?new WeakMap:void 0,Ms=new $c,Po=ai("skipRender"),Bo=ai("isForcingUpdate"),od=typeof _s=="function"&&_s(function(e,t){}).$$typeof;function Lt(e,t,i){Object.hasOwnProperty.call(e,t)?e[t]=i:Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!0,value:i})}function nd(e){if(zc)try{return zc(e)}catch(t){return null}return null}function sd(e){var t=nd(e);t&&Yi&&Yi.set(t,e),Ms.emit({event:"render",renderTime:e.__$mobRenderEnd-e.__$mobRenderStart,totalTime:Date.now()-e.__$mobRenderStart,component:e,node:t})}function eg(){if(typeof WeakMap=="undefined")throw new Error("[mobx-react] tracking components is not supported in this browser.");Ti||(Ti=!0)}var tg=new $c;function ig(e,t){Jm(e,t,zs[t])}function ld(e,t){if(ad(e,t))return!0;if(si(e)!=="object"||e===null||si(t)!=="object"||t===null)return!1;var i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(var o=0;o<i.length;o++)if(!hasOwnProperty.call(t,i[o])||!ad(e[i[o]],t[i[o]]))return!1;return!0}function ad(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function rg(e){var t=this;if(Rs===!0)return e.call(this);function i(){var c=this;a=!1;var d=void 0,u=void 0;if(l.track(function(){Ti&&(c.__$mobRenderStart=Date.now());try{u=ee._allowStateChanges(!1,n)}catch(h){d=h}Ti&&(c.__$mobRenderEnd=Date.now())}),d)throw tg.emit(d),d;return u}var r=this.displayName||this.name||this.constructor&&(this.constructor.displayName||this.constructor.name)||"<component>",o=this._reactInternalInstance&&this._reactInternalInstance._rootNodeID||this._reactInternalInstance&&this._reactInternalInstance._debugID||this._reactInternalFiber&&this._reactInternalFiber._debugID;Lt(this,Po,!1),Lt(this,Bo,!1);var n=e.bind(this),a=!1,l=new ee.Reaction("".concat(r,"#").concat(o,".render()"),function(){if(!a&&(a=!0,typeof t.componentWillReact=="function"&&t.componentWillReact(),t[id]!==!0)){var c=!0;try{Lt(t,Bo,!0),t[Po]||Xi.prototype.forceUpdate.call(t),c=!1}finally{Lt(t,Bo,!1),c&&l.dispose()}}});return l.reactComponent=this,i[As]=l,this.render=i,i.call(this)}var zs={componentWillUnmount:function(){if(Rs===!0)return;if(this.render[As]&&this.render[As].dispose(),this[id]=!0,Ti){var t=nd(this);t&&Yi&&Yi.delete(t),Ms.emit({event:"destroy",component:this,node:t})}},componentDidMount:function(){Ti&&sd(this)},componentDidUpdate:function(){Ti&&sd(this)},shouldComponentUpdate:function(t,i){return Rs&&console.warn("[mobx-react] It seems that a re-rendering of a React component is triggered while in static (server-side) mode. Please make sure components are rendered only once server-side."),this.state!==i?!0:!ld(this.props,t)}};function cd(e,t){var i=ai("reactProp_".concat(t,"_valueHolder")),r=ai("reactProp_".concat(t,"_atomHolder"));function o(){return this[r]||Lt(this,r,ee.createAtom("reactive "+t)),this[r]}Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){return o.call(this).reportObserved(),this[i]},set:function(a){!this[Bo]&&!ld(this[i],a)?(Lt(this,i,a),Lt(this,Po,!0),o.call(this).reportChanged(),Lt(this,Po,!1)):Lt(this,i,a)}})}function ki(e,t){if(typeof e=="string")throw new Error("Store names should be provided as array");if(Array.isArray(e))return rd||(rd=!0,console.warn('Mobx observer: Using observer to inject stores is deprecated since 4.0. Use `@inject("store1", "store2") @observer ComponentClass` or `inject("store1", "store2")(observer(componentClass))` instead of `@observer(["store1", "store2"]) ComponentClass`')),t?zo.apply(null,e)(ki(t)):function(d){return ki(e,d)};var i=e;if(i.isMobxInjector===!0&&console.warn("Mobx observer: You are trying to use 'observer' on a component that already has 'inject'. Please apply 'observer' before applying 'inject'"),i.__proto__===zm&&console.warn("Mobx observer: You are using 'observer' on React.PureComponent. These two achieve two opposite goals and should not be used together"),od&&i.$$typeof===od){var r=i.render;if(typeof r!="function")throw new Error("render property of ForwardRef was not a function");return _s(function(){var u=arguments;return Mc.createElement(Ps,null,function(){return r.apply(void 0,u)})})}if(typeof i=="function"&&(!i.prototype||!i.prototype.render)&&!i.isReactClass&&!Xi.isPrototypeOf(i)){var o,n,a=ki((n=o=function(d){ks(u,d);function u(){return Ro(this,u),Ts(this,zr(u).apply(this,arguments))}return Mo(u,[{key:"render",value:function(){return i.call(this,this.props,this.context)}}]),u}(Xi),o.displayName=i.displayName||i.name,o.contextTypes=i.contextTypes,o.propTypes=i.propTypes,o.defaultProps=i.defaultProps,n));return Uc(a,i),a}if(!i)throw new Error("Please pass a valid component to 'observer'");var l=i.prototype||i;og(l),i.isMobXReactObserver=!0,cd(l,"props"),cd(l,"state");var c=l.render;return l.render=function(){return rg.call(this,c)},i}function og(e){["componentDidMount","componentWillUnmount","componentDidUpdate"].forEach(function(t){ig(e,t)}),e.shouldComponentUpdate?e.shouldComponentUpdate!==zs.shouldComponentUpdate&&console.warn("Use `shouldComponentUpdate` in an `observer` based component breaks the behavior of `observer` and might lead to unexpected results. Manually implementing `sCU` should not be needed when using mobx-react."):e.shouldComponentUpdate=zs.shouldComponentUpdate}var Ps=ki(function(e){var t=e.children,i=e.inject,r=e.render,o=t||r;if(typeof o=="undefined")return null;if(!i)return o();console.warn("<Observer inject=.../> is no longer supported. Please use inject on the enclosing component instead");var n=zo(i)(o);return Mc.createElement(n,null)});Ps.displayName="Observer";var dd=function(t,i,r,o,n){var a=i==="children"?"render":"children";return typeof t[i]=="function"&&typeof t[a]=="function"?new Error("Invalid prop,do not use children and render in the same time in`"+r):typeof t[i]=="function"||typeof t[a]=="function"?void 0:new Error("Invalid prop `"+n+"` of type `"+si(t[i])+"` supplied to `"+r+"`, expected `function`.")};Ps.propTypes={render:dd,children:dd};function ud(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function hd(e){function t(i){var r=this.constructor.getDerivedStateFromProps(e,i);return r!=null?r:null}this.setState(t.bind(this))}function pd(e,t){try{var i=this.props,r=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(i,r)}finally{this.props=i,this.state=r}}ud.__suppressDeprecationWarning=!0;hd.__suppressDeprecationWarning=!0;pd.__suppressDeprecationWarning=!0;function ng(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function")return e;var i=null,r=null,o=null;if(typeof t.componentWillMount=="function"?i="componentWillMount":typeof t.UNSAFE_componentWillMount=="function"&&(i="UNSAFE_componentWillMount"),typeof t.componentWillReceiveProps=="function"?r="componentWillReceiveProps":typeof t.UNSAFE_componentWillReceiveProps=="function"&&(r="UNSAFE_componentWillReceiveProps"),typeof t.componentWillUpdate=="function"?o="componentWillUpdate":typeof t.UNSAFE_componentWillUpdate=="function"&&(o="UNSAFE_componentWillUpdate"),i!==null||r!==null||o!==null){var n=e.displayName||e.name,a=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+n+" uses "+a+" but also contains the following legacy lifecycles:"+(i!==null?`
  `+i:"")+(r!==null?`
  `+r:"")+(o!==null?`
  `+o:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(t.componentWillMount=ud,t.componentWillReceiveProps=hd),typeof t.getSnapshotBeforeUpdate=="function"){if(typeof t.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=pd;var l=t.componentDidUpdate;t.componentDidUpdate=function(d,u,h){var y=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:h;l.call(this,d,u,y)}}return e}var sg={children:!0,key:!0,ref:!0},Ls=function(e){ks(t,e);function t(i,r){var o;return Ro(this,t),o=Ts(this,zr(t).call(this,i,r)),o.state={},Bs(i,o.state),o}return Mo(t,[{key:"render",value:function(){return Pm.only(this.props.children)}},{key:"getChildContext",value:function(){var r={};return Bs(this.context.mobxStores,r),Bs(this.props,r),{mobxStores:r}}}],[{key:"getDerivedStateFromProps",value:function(r,o){if(!r)return null;if(!o)return r;if(Object.keys(r).filter(Lo).length!==Object.keys(o).filter(Lo).length&&console.warn("MobX Provider: The set of provided stores has changed. Please avoid changing stores as the change might not propagate to all children"),!r.suppressChangedStoreWarning)for(var n in r)Lo(n)&&o[n]!==r[n]&&console.warn("MobX Provider: Provided store '"+n+"' has changed. Please avoid replacing stores as the change might not propagate to all children");return r}}]),t}(Xi);Ls.contextTypes={mobxStores:Is};Ls.childContextTypes={mobxStores:Is.isRequired};function Bs(e,t){if(!e)return;for(var i in e)Lo(i)&&(t[i]=e[i])}function Lo(e){return!sg[e]&&e!=="suppressChangedStoreWarning"}ng(Ls);var AT=ai("disposeOnUnmount");if(!Xi)throw new Error("mobx-react requires React to be available");if(!ee.spy)throw new Error("mobx-react requires mobx to be available");typeof Pc=="function"&&ee.configure({reactionScheduler:Pc});if((typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="undefined"?"undefined":si(__MOBX_DEVTOOLS_GLOBAL_HOOK__))==="object"){var ag={spy:ee.spy,extras:{getDebugName:ee.getDebugName}},lg={renderReporter:Ms,componentByNodeRegistry:Yi,componentByNodeRegistery:Yi,trackComponents:eg};__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobxReact(lg,ag)}import cg,{css as dg}from"styled-components";const Pr=dg`
  position: absolute;
  top: 0;
  left: 0;
  height: ${e=>e.theme.measurements.colorItem.size}px;
  width: ${e=>e.theme.measurements.colorItem.size}px;
  border-radius: ${e=>e.theme.colorItem.borderRadius||`${e.theme.shape.radiusSmall}px`};
  pointer-events: none;
`,ug=cg.div.attrs(e=>({style:{background:e.color}}))`
  ${Pr}
  z-index: ${e=>e.theme.measurements.zIndex.colorItem.background};
`;var No=ug;import Ji from"react";import fd,{css as hg}from"styled-components";const pg=fd.div`
  ${Pr}
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: ${e=>e.theme.measurements.zIndex.colorItem.overlay};

  box-sizing: border-box;
  border: 2px solid transparent;
  border-radius: ${e=>e.theme.colorItem.borderRadius||`${e.theme.shape.radiusSmall}px`};
  transition: border-color 300ms ease-in-out;
  ${e=>e.isActive&&hg`
      border-color: ${e.theme.selectColor.activeBorderColor};
    `}
`,Ns=fd.span`
  display: inline-block;
  height: 2px;
  width: 2px;
  border-radius: 50%;
  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.6);
  background: rgba(255, 255, 255, 0.87);
  margin: 1px;
  pointer-events: none;
`,fg=({isActive:e,className:t,style:i})=>Ji.createElement(pg,{isActive:e,className:t,style:i},e&&Ji.createElement(Ji.Fragment,null,Ji.createElement(Ns,null),Ji.createElement(Ns,null),Ji.createElement(Ns,null)));var Ho=fg;import{css as mg}from"styled-components";const Se=mg`
  &:focus {
    outline: none;
    box-shadow: 0 0 2px ${e=>e.theme.focusOutlineColor};
  }
  &:-moz-focusring {
    outline: none;
    box-shadow: 0 0 2px ${e=>e.theme.focusOutlineColor};
  }
`;import{css as md}from"styled-components";const Zi=md`
  position: absolute !important;
  height: 1px;
  width: 1px;
  overflow: hidden;
  clip: rect(1px 1px 1px 1px); /* IE6, IE7 */
  clip: rect(1px, 1px, 1px, 1px);
`,gd=md`
  -webkit-overflow-scrolling: touch;
  &::-webkit-scrollbar {
    display: none;
    /* Safari */
    -webkit-appearance: none; /* stylelint-disable-line */
    width: 0;
    height: 0;
  }
  -ms-overflow-style: none; /* IE 11 */
  scrollbar-width: none; /* Firefox 64 */
`;import gg from"styled-components";const bg=gg.button.attrs({type:"button"})`
  &&& {
    box-sizing: border-box;
  }
  position: relative;
  background: transparent;
  border: none;
  height: ${e=>e.theme.measurements.colorItem.size}px;
  width: ${e=>e.theme.measurements.colorItem.size}px;
  margin: ${e=>e.theme.colorItem.margin};
  padding: 0;
  cursor: pointer;
  border-radius: ${e=>e.theme.colorItem.borderRadius||`${e.theme.shape.radiusSmall}px`};

  &:hover {
    opacity: 0.7;
  }

  ${Se}

  &:disabled {
    opacity: ${e=>e.theme.selectColor.inactiveOpacity};
    cursor: default;
  }
`;var jo=bg;import yg from"styled-components";const vg=yg.div.attrs(e=>{const t=e.url?{backgroundImage:`url(${e.url})`}:{};return{style:t}})`
  ${Pr}
  z-index: ${e=>e.theme.measurements.zIndex.colorItem.tiledBackground};
`;var Wo=vg;import Uo from"react";const Sg=({isActive:e,onClick:t,color:i,label:r,isDisabled:o,tiledBackgroundUrl:n,className:a,style:l,children:c})=>Uo.createElement(jo,{disabled:o,onClick:t,"aria-label":r,className:a,style:l},Uo.createElement(Wo,{url:n}),Uo.createElement(No,{color:i}),Uo.createElement(Ho,{isActive:e}),c);var bd=zo("config")(ki(Sg));import wg from"styled-components";const Dg=wg.div`
  display: block;
  opacity: 1;
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: ${e=>e.theme.measurements.zIndex.dialog.backdrop};
  text-align: left;
  background: ${e=>e.theme.modal.backdrop};
  height: 100%;
  width: 100%;
`;var $o=Dg;import xg from"react";import Cg,{css as _g}from"styled-components";const Eg=Cg.div`
  display: none;
  visibility: hidden;
  opacity: 0;
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: ${e=>e.theme.measurements.zIndex.dialog.base};
  transition: opacity 100s ease-in-out;

  ${e=>e.isVisible&&_g`
      opacity: 1;
      display: block;
      visibility: visible;
    `};
`,Vo=({isVisible:e,className:t,children:i})=>xg.createElement(Eg,{isVisible:e,className:t},i);import kg from"styled-components";const Tg=kg.div.attrs(()=>({role:"dialog","aria-hidden":!1}))`
  display: flex;
  flex: 0 0 auto;
  flex-direction: column;
  transition: top 0.25s ease;
  position: absolute;
  top: calc(50% + ${e=>e.top}px);
  left: calc(50% + ${e=>e.left}px);
  width: ${e=>e.width};
  height: ${e=>e.height};
  transform: translate(-50%, -50%);
  border-radius: ${e=>e.theme.shape.radiusLarge}px;
  background: ${e=>e.theme.modal.background};
  color: ${e=>e.theme.modal.bodyForeground};
  z-index: ${e=>e.theme.measurements.zIndex.dialog.container};

  @media all and (min-width: 0) and (max-width: 640px) {
    text-align: center;
    width: auto;
    min-width: 200px;
    height: auto;
    top: 50%;
    left: 50%;
  }
`;var Go=Tg;import Hs from"react";const Og=({isVisible:e=!1,width:t="350px",height:i="fit-content",position:r,header:o,body:n,footer:a,className:l,children:c})=>Hs.createElement(Vo,{isVisible:e},Hs.createElement($o,null),Hs.createElement(Go,{height:i,width:t,left:r.x,top:r.y,className:l,"data-test":Yt.Dialog},o,n,c,a));var yd=Og;import Ig from"styled-components";const Fg=Ig.div`
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-sizing: border-box;
  font-size: ${e=>e.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.body.case};
  color: ${e=>e.theme.modal.bodyForeground};

  padding: 0px 20px 11px;
  &:first-child {
    padding-top: 11px;
  }

  @media all and (min-width: 0) and (max-width: 640px) {
    align-items: center;
  }
`;var Nt=Fg;import Ag from"styled-components";const Rg=Ag.div`
  display: flex;
  border-top: 2px solid
    ${e=>e.type==="error"?e.theme.error:e.theme.warning};

  min-height: 40px;
  justify-content: flex-end;
  @media all and (min-width: 0) and (max-width: 640px) {
    height: auto;
    flex-direction: column;
    justify-content: space-around;
  }
`;var Qi=Rg;import Mg from"styled-components";const zg=Mg.h3`
  font-size: ${e=>e.theme.measurements.fontSystem.headline2.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.headline2.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.headline2.case};
  color: ${e=>e.theme.modal.headerForeground};

  padding: 11px 20px 0px;
`;var er=zg;import Pg,{css as vd,keyframes as Bg}from"styled-components";const Sd=Bg`
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
`,Lg=vd`
  animation: ${Sd} 2s infinite ease 1.5s;
`,Ng=vd`
  animation: ${Sd} 2s infinite ease;
`,Hg=Pg.div`
  color: ${e=>e.theme.primary};
  margin: 12px 0;
  position: relative;
  width: 40px;
  height: 40px;
  box-shadow: inset 0 0 0 2px;
  transform: translateZ(0);
  border-radius: 50%;
  &:before,
  &:after {
    border-radius: 50%;
    position: absolute;
    content: '';
  }
  &:before {
    width: 25px;
    height: 45px;
    background: ${e=>e.theme.modal.background};
    border-radius: 45px 0 0 45px;
    top: -2.5px;
    left: -2.5px;
    transform-origin: 25px 25px;
    ${Lg};
  }
  &:after {
    width: 25px;
    height: 45px;
    background: ${e=>e.theme.modal.background};
    border-radius: 0 45px 45px 0;
    top: -2.5px;
    left: 25px;
    transform-origin: 0px 25px;
    ${Ng};
  }
`;var qo=Hg;const js=["Moz","Webkit","O","ms"];function jg(e){let t="",i=!0,r;for(r=0;r<e.length;r+=1)i?(t+=e[r].toUpperCase(),i=!1):e[r]==="-"?i=!0:t+=e[r];return t}function Ws(e,t){return t?`${t}${jg(e)}`:e}function Wg(e="transform"){if(typeof window=="undefined"||typeof window.document=="undefined")return"";const{style:t}=window.document.documentElement;if(e in t)return"";let i;for(i=0;i<js.length;i+=1)if(Ws(e,js[i])in t)return js[i];return""}var wd=Wg();function Xo(e,t){for(let i=0,{length:r}=e;i<r;i+=1)if(t.apply(t,[e[i],i,e]))return e[i];return null}function Us(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Function]"}function tr(e){return typeof e=="number"&&!Number.isNaN(e)}function we(e){return parseInt(e,10)}let Ko="";function Ug(e,t){return Ko||(Ko=Xo(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],i=>Us(e[i]))),Us(e[Ko])?e[Ko](t):!1}function $s(e,t,i){let r=e;do{if(Ug(r,t))return!0;if(r===i)return!1;r=r.parentNode}while(r);return!1}function Yo(e,t,i){if(!e)return;e.attachEvent?e.attachEvent(`on${t}`,i):e.addEventListener?e.addEventListener(t,i,!0):e[`on${t}`]=i}function li(e,t,i){if(!e)return;e.detachEvent?e.detachEvent(`on${t}`,i):e.removeEventListener?e.removeEventListener(t,i,!0):e[`on${t}`]=null}function Dd(e){let t=e.clientHeight;const i=e.ownerDocument.defaultView.getComputedStyle(e);return t+=we(i.borderTopWidth),t+=we(i.borderBottomWidth),t}function xd(e){let t=e.clientWidth;const i=e.ownerDocument.defaultView.getComputedStyle(e);return t+=we(i.borderLeftWidth),t+=we(i.borderRightWidth),t}function Cd(e){let t=e.clientHeight;const i=e.ownerDocument.defaultView.getComputedStyle(e);return t-=we(i.paddingTop),t-=we(i.paddingBottom),t}function _d(e){let t=e.clientWidth;const i=e.ownerDocument.defaultView.getComputedStyle(e);return t-=we(i.paddingLeft),t-=we(i.paddingRight),t}function Ed(e,t){const i=t===t.ownerDocument.body,r=i?{left:0,top:0}:t.getBoundingClientRect(),o=e.clientX+t.scrollLeft-r.left,n=e.clientY+t.scrollTop-r.top;return{x:o,y:n}}function kd({x:e,y:t,rotation:i}){const r=`translate(${e}px,${t}px) rotate(${i}rad)`;return{[Ws("transform",wd)]:r}}function Td(e,t){let i=null;return e.targetTouches&&(i=Xo(e.targetTouches,r=>t===r.identifier)),e.changedTouches&&!i&&(i=Xo(e.changedTouches,r=>t===r.identifier)),i}function Od(e){return e.targetTouches&&e.targetTouches[0]?e.targetTouches[0].identifier:e.changedTouches&&e.changedTouches[0]?e.changedTouches[0].identifier:null}import $g from"react-dom";function Vs(e){const t=$g.findDOMNode(e);if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}function Id(e,t,i){if(!e.props.bounds)return[t,i];let{bounds:r}=e.props;r=typeof r=="string"?r:p({},r);const o=Vs(e);if(typeof r=="string"){const{ownerDocument:n}=o,a=n.defaultView,l=r==="parent"?o.parentNode:n.querySelector(r);if(!(l instanceof HTMLElement))throw new Error(`Bounds selector "${r}" could not find an element.`);if(o instanceof HTMLElement){const c=a.getComputedStyle(o),d=a.getComputedStyle(l);r={left:-o.offsetLeft+we(d.paddingLeft)+we(c.marginLeft),top:-o.offsetTop+we(d.paddingTop)+we(c.marginTop),right:_d(l)-xd(o)-o.offsetLeft+we(d.paddingRight)-we(c.marginRight),bottom:Cd(l)-Dd(o)-o.offsetTop+we(d.paddingBottom)-we(c.marginBottom)}}}return r=r,tr(r.right)&&(t=Math.min(t,r.right)),tr(r.bottom)&&(i=Math.min(i,r.bottom)),tr(r.left)&&(t=Math.max(t,r.left)),tr(r.top)&&(i=Math.max(i,r.top)),[t,i]}function Jo(e,t,i){const{state:r}=e,o=!tr(r.lastX),n=Vs(e);return o?{node:n,deltaX:0,deltaY:0,lastX:t,lastY:i,x:t,y:i}:{node:n,deltaX:t-r.lastX,deltaY:i-r.lastY,lastX:r.lastX,lastY:r.lastY,x:t,y:i}}function Zo(e,t){return{node:t.node,x:e.state.x+t.deltaX,y:e.state.y+t.deltaY,deltaX:t.deltaX,deltaY:t.deltaY,lastX:e.state.x,lastY:e.state.y}}function Fd(e){return e.props.axis==="both"||e.props.axis==="x"}function Ad(e){return e.props.axis==="both"||e.props.axis==="y"}function Qo(e,t){const i=Vs(t);let{offsetParent:r}=t.props;return!r&&i instanceof HTMLElement&&(r=i.offsetParent||i.ownerDocument.body),Ed(e,r)}import Gs from"react";import qs from"react-dom";const Et={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let $e=Et.mouse;const Xs={cancel:null,disabled:!1,offsetParent:null,handle:null,transform:null,onStart:()=>{},onDrag:()=>{},onStop:()=>{},onMouseDown:()=>{}};class ir extends Gs.Component{constructor(){super(...arguments);this.state={dragging:!1,lastX:NaN,lastY:NaN,touchIdentifier:void 0};this.getTouchFromEvent=e=>{const t=Od(e);return this.setState({touchIdentifier:t}),Td(e,t)};this.preventDefault=e=>{e.stopPropagation&&e.stopPropagation()};this.handleDragStart=e=>{const t=qs.findDOMNode(this);if(!t||!t.ownerDocument||!t.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:i}=t;if(this.props.disabled||!(e.target instanceof Node)||this.props.handle&&!$s(e.target,this.props.handle,t)||this.props.cancel&&$s(e.target,this.props.cancel,t))return!1;const r=Qo(e,this);if(r==null)return!1;const{x:o,y:n}=r,a=Jo(this,o,n),l=this.props.onStart(e,a);if(l===!1)return!1;this.setState({dragging:!0,lastX:o,lastY:n}),$e.move==="touchmove"?Yo(i,$e.move,this.onTouchDrag):Yo(i,$e.move,this.onMouseDrag),Yo(i,$e.stop,this.handleDragStop)};this.handleDrag=e=>{const t=Qo(e,this);if(t==null)return;const{x:i,y:r}=t,o=Jo(this,i,r),n=this.props.onDrag(e,o);if(n===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch(a){const l=document.createEvent("MouseEvents");l.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(l)}return}this.setState({lastX:i,lastY:r})};this.handleDragStop=e=>{if(!this.state.dragging)return;const t=Qo(e,this);if(t==null)return;const{x:i,y:r}=t,o=Jo(this,i,r),n=qs.findDOMNode(this);this.setState({dragging:!1,lastX:NaN,lastY:NaN}),this.props.onStop(e,o),n&&($e.move==="touchmove"?li(n.ownerDocument,$e.move,this.onTouchDrag):li(n.ownerDocument,$e.move,this.onMouseDrag),li(n.ownerDocument,$e.stop,this.handleDragStop))};this.onMouseDown=e=>(this.preventDefault(e),$e=Et.mouse,this.props.onMouseDown(e),e.button&&typeof e.button=="number"&&e.button!==0?!1:this.handleDragStart(e));this.onMouseDrag=e=>(this.preventDefault(e),this.handleDrag(e));this.onMouseUp=e=>(this.preventDefault(e),$e=Et.mouse,this.handleDragStop(e));this.onTouchStart=e=>{this.preventDefault(e),$e=Et.touch;const t=this.getTouchFromEvent(e);return this.handleDragStart(t)};this.onTouchDrag=e=>{this.preventDefault(e),$e=Et.touch;const t=this.getTouchFromEvent(e);return this.handleDrag(t)};this.onTouchEnd=e=>{this.preventDefault(e),$e=Et.touch;const t=this.getTouchFromEvent(e);return this.handleDragStop(t)}}componentWillUnmount(){const e=qs.findDOMNode(this);if(e){const{ownerDocument:t}=e;li(t,Et.mouse.move,this.onMouseDrag),li(t,Et.touch.move,this.onTouchDrag),li(t,Et.mouse.stop,this.handleDragStop),li(t,Et.touch.stop,this.handleDragStop)}}render(){return Gs.cloneElement(Gs.Children.only(this.props.children),{style:p({touchAction:"none"},this.props.children.props.style),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}}ir.defaultProps=Xs,ir.displayName="DraggableCore";import en from"react";const Vg=p(p({},Xs),{axis:"both",bounds:!1,defaultClassName:"draggable",defaultClassNameDragging:"draggable-dragging",defaultClassNameDragged:"draggable-dragged",defaultPosition:{x:0,y:0},position:null,rotation:0,updateOnPosition:!1});class Ks extends en.Component{constructor(e){super(e);this.onDragStart=(e,t)=>{const i=this.props.onStart(e,Zo(this,t));if(i===!1)return!1;this.setState({dragging:!0,dragged:!0})};this.onDrag=(e,t)=>{const{position:i,defaultPosition:r,onDrag:o,bounds:n}=this.props;if(!this.state.dragging)return!1;const a=Zo(this,t),l=Boolean(i),c={x:l?a.x:r.x,y:l?a.y:r.y,slackX:0,slackY:0};if(n){const{x:u,y:h}=c;c.x+=this.state.slackX,c.y+=this.state.slackY;const[y,k]=Id(this,c.x,c.y);c.x=y,c.y=k,c.slackX=this.state.slackX+(u-c.x),c.slackY=this.state.slackY+(h-c.y),a.x=c.x,a.y=c.y,a.deltaX=c.x-this.state.x,a.deltaY=c.y-this.state.y}const d=o(e,a);if(d===!1)return!1;this.setState(c)};this.onDragStop=(e,t)=>{if(!this.state.dragging)return!1;const i=this.props.onStop(e,Zo(this,t));if(i===!1)return!1;const r={dragging:!1,slackX:0,slackY:0,x:0,y:0},o=Boolean(this.props.position);if(o){const{x:n,y:a}=this.props.position;r.x=n,r.y=a}this.setState(r)};this.state={dragging:!1,dragged:!1,x:e.position?e.position.x:e.defaultPosition.x,y:e.position?e.position.y:e.defaultPosition.y,slackX:0,slackY:0}}componentDidUpdate(e){const t=Boolean(this.props.position);t&&(this.props.updateOnPosition?(e.position&&e.position.x!==this.props.position.x||e.position.y!==this.props.position.y)&&this.setState({x:this.props.position.x,y:this.props.position.y}):(e.position&&this.props.position.x!==this.state.x||this.props.position.y!==this.state.y)&&this.setState({x:this.props.position.x,y:this.props.position.y}))}componentWillUnmount(){this.setState({dragging:!1})}render(){const ce=this.props,{position:e,defaultPosition:t,rotation:i,defaultClassName:r,defaultClassNameDragging:o,defaultClassNameDragged:n}=ce,a=Ge(ce,["position","defaultPosition","rotation","defaultClassName","defaultClassNameDragging","defaultClassNameDragged"]),{x:l,y:c,dragging:d,dragged:u}=this.state;let h={};const y=Boolean(e),k=!y||d,w=e||t,T={x:Fd(this)&&k?l:w.x,y:Ad(this)&&k?c:w.y,rotation:i};h=kd(T);const F=en.Children.only(this.props.children),$=[F.props.className||"",r,d?o:"",u?n:""].join(" ").trim(),E=en.cloneElement(F,{className:$,style:p(p({},F.props.style),h)});return en.createElement(ir,p(p({},a),{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),E)}}Ks.defaultProps=Vg,Ks.displayName="Draggable";var Rd=Ks;import Br from"styled-components";const tn=Br.span`
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
`,Ys=Br(tn)``,Ve=Br(tn)``,rr=Br(tn)``,rn={display:"none",left:0,top:0},on=Br(tn)`
  display: ${({display:e})=>e};
  left: ${({left:e})=>e}px;
  top: ${({top:e})=>e}px;
  pointer-events: none;
  border-radius: 50%;
  background-color: rgba(255, 255, 255, 0.12);
  animation: ${_o} 1.2s;
  width: 100px;
  height: 100px;
  margin-top: -50px;
  margin-left: -50px;
  opacity: 0;
`;import Lr from"react";import Gg,{css as qg}from"styled-components";const Ht=qg`
  color: ${e=>e.theme.button.activeForeground};
`,Xg=Gg.button`
  &&& {
    box-sizing: border-box;
  }
  text-align: center;
  position: relative;
  padding: 4px 8px;
  min-height: 32px;
  border-radius: ${e=>e.theme.shape.radiusMedium}px;
  font-size: ${e=>e.theme.measurements.fontSystem.button1.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.button1.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.button1.case};
  font-family: ${e=>e.theme.typography.fontFamily}, sans-serif;
  cursor: pointer;
  border: none;
  background-color: transparent;
  overflow: hidden;
  ${Se}

  /* Active */

  &:active {
    ${Ht}
  }

  ${({isActive:e})=>e&&Ht}

  /* Disabled */

  &:disabled {
    cursor: default;
    pointer-events: none;

    ${Ve} {
      background-color: ${e=>e.theme.button.outlinedInactiveOverlayColor};
    }
  }

  /* Hover */

  &:hover {
    ${rr} {
      background-color: ${e=>e.theme.button.hoverOverlayColor};
    }
  }
`;class et extends Lr.Component{constructor(){super(...arguments);this.state=rn;this.timeout=null;this.onClick=e=>{const t=e.currentTarget.getBoundingClientRect(),i=e.pageX-t.left,r=e.pageY-t.top;this.state.display==="block"?this.setState({display:"none"},()=>{this.setRippleState(i,r)}):this.setRippleState(i,r),this.props.onClick(e)};this.setRippleState=(e,t)=>{this.setState({left:e,top:t,display:"block"}),this.timeout=setTimeout(()=>{this.setState({display:"none"})},1200)}}componentWillUnmount(){clearTimeout(this.timeout)}render(){const u=this.props,{isActive:e,isDisabled:t,label:i,ariaLabel:r,children:o,className:n}=u,a=Ge(u,["isActive","isDisabled","label","ariaLabel","children","className"]),{left:l,top:c,display:d}=this.state;return Lr.createElement(Xg,p(p({"data-test":r,className:n,isActive:e,disabled:t,"aria-label":r},a),{onClick:this.onClick}),i,o,Lr.createElement(on,{display:d,left:l,top:c}),Lr.createElement(Ve,null),Lr.createElement(rr,null))}}et.defaultProps={type:"button",isDisabled:!1,isActive:!1};import Kg from"react";import Md,{css as Yg}from"styled-components";const Jg=Md.label`
  ${Zi}
`,Zg=Md.label`
  display: block;
  font-size: ${e=>e.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.body.case};
  color: ${e=>e.theme.toolControlBar.inputLabelForeground};
  margin: 0;
  padding-bottom: 8px;

  ${({isDisabled:e})=>e&&Yg`
      opacity: ${t=>t.theme.toolControlBar.inputLabelInactiveOpacity};
      cursor: default;
      pointer-events: none;
    `}
`,Ce=({label:e,htmlFor:t,show:i,style:r,isDisabled:o,className:n})=>{const a=i?Zg:Jg,l=t||(e?e.replace(" ","-"):void 0);return Kg.createElement(a,{style:r,isDisabled:o,htmlFor:l,className:n},e)};Ce.defaultProps={show:!0};const zd=m(Rt());import gt from"react";import ci,{css as Pd}from"styled-components";const Qg=ci.div`
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
`,eb=ci(Ce)`
  align-self: flex-start;
`,Bd=ci(et)`
  color: ${e=>e.theme.button.textSecondaryForeground};
  padding: 1px 7px 2px;
`,tb=ci.div`
  display: flex;
  justify-content: space-between;
  width: ${e=>e.theme.measurements.advancedUIToolControlBar.width-48}px;
`,ib=ci.article`
  /* 0.6 of width here refers to the width of the container without padding */
  width: ${e=>.6*e.theme.measurements.advancedUIToolControlBar.width}px;
  font-size: ${e=>e.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.body.case};
  text-align: center;
  margin-top: 7px;
  display: inline-block;
  color: ${e=>e.theme.toolControlBar.inputLabelForeground};
`,rb=ci.div`
  width: ${e=>.6*e.theme.measurements.advancedUIToolControlBar.width}px;
  transform: translateZ(0);
  overflow: hidden;
  transition: all 500ms ease-out;
`,ob=ci.span`
  width: ${e=>Math.round(e.length*.6*e.theme.measurements.advancedUIToolControlBar.width)}px;
  margin-left: -${e=>e.activeIndex*.6*e.theme.measurements.advancedUIToolControlBar.width}px;
  position: relative;
  display: inline-block;
  transform: translateZ(0);
  transition: all 600ms cubic-bezier(0.77, 0, 0.175, 1);
  font-family: '${e=>e.theme.typography.fontFamily}', sans-serif;
`,Ld=ci.div`
  border: solid ${e=>e.theme.card.foreground};
  border-width: 0 2px 2px 0;
  padding: 3px;
  height: 0;
  width: 0;

  ${({direction:e})=>e==="left"?Pd`
          margin-left: 2px;
          transform: rotate(135deg);
        `:Pd`
          margin-right: 2px;
          transform: rotate(-45deg);
        `}
`;class Nd extends gt.PureComponent{constructor(e){super(e);this.updateIndex=(e,t=!1)=>{let i=e+(t?-1:1);const r=this.props.list.length-1;i>r&&(i=0),i<0&&(i=r),this.props.onSelect(this.props.list[i].identifier)};this.getActiveIndex=e=>{const{list:t}=this.props,i=t.findIndex(r=>r.identifier===e);return i!==-1?i:0};this.throttledUpdateIndex=zd.default(this.updateIndex,600)}render(){const{list:e,label:t,showLabel:i=!0}=this.props,r=this.getActiveIndex(this.props.defaultIdentifier),o=e.length<=1;return gt.createElement(Qg,null,gt.createElement(eb,{show:i,label:t}),gt.createElement(tb,{id:`photoeditorsdk-${t.replace(" ","-")}`},gt.createElement(Bd,{ariaLabel:"Select Previous",isDisabled:o,onClick:()=>this.throttledUpdateIndex(r,!0)},gt.createElement(Ld,{direction:"left"})),gt.createElement(rb,null,gt.createElement(ob,{activeIndex:r,length:e.length},e.map(n=>gt.createElement(ib,{key:n.identifier},n.value)))),gt.createElement(Bd,{ariaLabel:"Select Next",isDisabled:o,onClick:()=>this.throttledUpdateIndex(r)},gt.createElement(Ld,{direction:"right"}))))}}Nd.defaultProps={showLabel:!0};var Hd=Nd;import nb from"styled-components";const sb=nb.div`
  display: flex;
  position: relative;
  margin-bottom: 12px;
  max-width: ${e=>e.theme.measurements.basicToolControlBar.maxWidth}px;
`;var nn=sb;import ab,{css as jd}from"styled-components";const lb=ab.div.attrs({tabIndex:0})`
  position: relative;
  height: 16px;
  width: 16px;
  cursor: pointer;
  background-color: ${e=>e.theme.checkbox.background};
  border-radius: ${e=>e.theme.shape.radiusSmall}px;
  transition-timing-function: ease-in;
  transition-duration: 0.3s;
  &::after {
    content: '';
    position: absolute;
    display: inline-block;
    left: 5px;
    width: 5px;
    height: 10px;
    border-style: solid;
    border-width: 0 2px 2px 0;
    border-color: transparent;
    transform: rotate(45deg) scale(0.8);
  }

  &:first-child {
    margin-right: 8px;
  }

  &:last-child {
    margin-left: 8px;
  }

  ${Se}

  &:hover {
    opacity: ${e=>e.theme.checkbox.hoverOpacity};
  }
  ${e=>e.isChecked&&jd`
      background-color: ${e.theme.checkbox.activeBackground};
      &::after {
        color: ${e.theme.checkbox.activeForeground};
        border-color: ${e.theme.checkbox.foreground};
      }
      &:hover {
        background-color: ${e.theme.checkbox.activeBackground};
        opacity: 0.8;
      }
    `}
  ${e=>e.isDisabled&&jd`
      opacity: 0.5;
      cursor: default;
      pointer-events: none;
    `}
`;var Nr=lb;import cb from"styled-components";const db=cb.input.attrs({type:"checkbox",tabIndex:0})`
  position: absolute;
  opacity: 0;
  cursor: pointer;
  height: 0;
  width: 0;
  margin: 0;
  padding: 0;
  ${Se}
`;var sn=db;import Hr from"react";const Wd=({label:e,value:t,checkMarkPosition:i,onClick:r,isDisabled:o,className:n,style:a})=>{const l=`photoeditorsdk-${e.replace(" ","-")}`;return Hr.createElement(nn,{className:n,style:a},i==="left"&&Hr.createElement(Nr,{onClick:r,isDisabled:o,isChecked:t}),Hr.createElement(Ce,{isDisabled:o,label:e,htmlFor:l}),Hr.createElement(sn,{id:l,disabled:o,checked:t,onChange:r}),i==="right"&&Hr.createElement(Nr,{onClick:r,isDisabled:o,isChecked:t}))};var Ud=Wd;Wd.defaultProps={value:!1,checkMarkPosition:"left"};import{css as ub}from"styled-components";const di=ub`
  font-size: ${e=>e.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.body.case};
  width: 100%;
  min-height: 26px;
  color: ${e=>e.theme.textInput.foreground};
  padding-bottom: 7px;
  border: none;
  appearance: none;
  border-bottom: 1px solid ${e=>e.theme.textInput.borderColor};
  background: ${e=>e.theme.textInput.background};
  font-family: '${e=>e.theme.typography.fontFamily}', sans-serif;
  transition: border-color 0.4s ease-in-out;

  &:focus {
    outline: none;
    border-color: ${e=>e.theme.textInput.hoverBorderColor};
  }

  &:-moz-focusring {
    outline: none;
    border-color: ${e=>e.theme.textInput.hoverBorderColor};
  }

  &:disabled {
    opacity: ${e=>e.theme.textInput.inactiveOpacity};
    pointer-events: none;
  }

  &:hover {
    border-color: ${e=>e.theme.textInput.hoverBorderColor};
  }

  &::-ms-clear,
  &::-ms-reveal {
    display: none;
  }

  &::-webkit-search-decoration,
  &::-webkit-search-cancel-button,
  &::-webkit-search-results-button,
  &::-webkit-search-results-decoration {
    -webkit-appearance: none;
  }

  &::-webkit-inner-spin-button,
  &::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
`;import hb from"styled-components";const jr=hb.ul.attrs(({scrollable:e})=>({"data-photoeditorsdk-simplebar":e?"init":null,"data-photoeditorsdk-simplebar-auto-hide":e?"false":null}))`
  list-style: none;
  background: ${e=>e.theme.dropdown.listBackground};
  color: ${e=>e.theme.dropdown.listForeground};
  border: 1px solid ${e=>e.theme.dropdown.listBorderColor};
  box-shadow: ${e=>e.theme.dropdown.listShadow};
  visibility: hidden;
  opacity: 0;
  min-width: 5rem;
  position: absolute;
  transition: all 0.5s ease;
  left: -1px;
  display: none;
  padding: unset;
  width: 100%;
  z-index: ${e=>e.theme.measurements.zIndex.input.list};
  max-height: 160px;
  overflow-x: hidden;
  margin: 5px 0;
  border-radius: 0 0 ${e=>e.theme.shape.radiusMedium}px
    ${e=>e.theme.shape.radiusMedium}px;
  &[data-photoeditorsdk-simplebar] {
    position: absolute;
  }
`;jr.defaultProps={scrollable:!0};import pb,{css as Js}from"styled-components";const $d=Js`
  outline: none;
`,Vd=Js`
  opacity: ${e=>e.theme.dropdown.inactiveOpacity};
  pointer-events: none;
`,Gd=pb.div`
  display: block;
  position: relative;
  width: 100%;
  white-space: nowrap;
  transition-duration: 0.5s;

  &:focus a {
    ${$d}
  }

  ${({isOpen:e})=>e&&Js`
      a {
        ${$d}
      }
      ${jr} {
        visibility: visible;
        opacity: 1;
        display: block;
      }
    `}

  &:disabled {
    ${Vd}
  }

  ${({isDisabled:e})=>e&&Vd}
`;import fb,{css as mb}from"styled-components";const qd=fb.li`
  padding: 10px 16px;
  text-overflow: ellipsis;
  font-size: ${e=>e.theme.measurements.fontSystem.button2.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.button2.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.button2.case};
  white-space: nowrap;
  color: ${e=>e.theme.dropdown.foreground};

  &:hover {
    cursor: pointer;
    background: ${e=>e.theme.dropdown.listItemHoverBackground};
  }

  ${({isActive:e})=>e&&mb`
      border-left: 2px solid ${t=>t.theme.primary};
    `}

  ${Se}
`;import gb from"styled-components";const Xd=gb.div`
  font-size: ${e=>e.theme.measurements.fontSystem.body.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.body.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.body.case};
  color: ${e=>e.theme.dropdown.foreground};
  background-color: ${e=>e.theme.dropdown.background};
  border: none;
  border-bottom: 1px solid ${e=>e.theme.dropdown.borderColor};
  padding: 5px 0;
  cursor: ${e=>e.showList?"pointer":"default"};
  transition: border-color 0.4s ease-in-out;

  &:hover {
    border-color: ${e=>e.theme.dropdown.hoverBorderColor};
  }

  ${Se}
`;import jt from"react";import Kd from"styled-components";const bb=Kd.div`
  position: absolute;
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid ${e=>e.theme.dropdown.caretColor};
  transform: rotate(${e=>e.rotation||0}deg);
  display: inline-block;
  transition-duration: 0.3s;
  transition-timing-function: ease-in;
  right: 0;
  top: 13px;
`,yb=Kd.div``;class Yd extends jt.PureComponent{constructor(e){super(e);this.state={isOpen:!1};this.handleOutsideClick=e=>{if(this.node&&this.node.contains(e.target))return;this.setState({isOpen:!1})};this.onSelect=e=>{const{onSelect:t}=this.props;t(e),this.setState({isOpen:!1})};this.onClick=()=>{this.setState(e=>({isOpen:!e.isOpen}))};this.listItem=e=>{const{itemStyle:t,selectedItem:i}=this.props,{isOpen:r}=this.state,{value:o,label:n}=e;let a={};return typeof t=="function"?a=t(e):t!==null&&typeof t=="object"&&(a=t),jt.createElement(qd,{"aria-hidden":!r,tabIndex:0,style:a,onClick:()=>this.onSelect(o),key:o,isActive:i===o},n)};this.onKeyDown=e=>{(e.code==="Space"||e.code==="Enter")&&this.onClick()};this.nodeRef=t=>{this.node=t}}componentDidMount(){document.addEventListener("mousedown",this.handleOutsideClick,!1)}componentWillUnmount(){document.removeEventListener("mousedown",this.handleOutsideClick,!1)}render(){const{selectedItem:e,list:t,label:i,style:r,isDisabled:o}=this.props,{isOpen:n}=this.state,a=t.length>1,l=o?{}:{tabIndex:0};return jt.createElement(yb,null,jt.createElement(Ce,{isDisabled:o,style:{paddingLeft:"0px"},label:i}),jt.createElement("div",{ref:this.nodeRef},jt.createElement(Gd,{id:i.replace(" ","-"),isOpen:n,isDisabled:o},jt.createElement(Xd,p(p({"aria-hidden":o},l),{showList:a,style:r,onClick:a?this.onClick:void 0,onKeyDown:this.onKeyDown}),e,a&&jt.createElement(bb,{rotation:n?180:0})),jt.createElement(jr,{scrollable:t.length>4},a&&t.map(this.listItem)))))}}import vb from"styled-components";const Sb=vb.input.attrs({type:"file",id:"fileUpload",accept:"image/png, image/jpeg"})`
  display: none;
`;var Jd=Sb;import wb from"react";const Db=({children:e})=>{const t=i=>{i.preventDefault()};return wb.createElement("form",{onSubmit:t},e)};var Zd=Db;import Zs from"react";import Qd from"styled-components";const xb=Qd.input`
  ${di}
  /* override user agent style */
  padding: 0;
  &:disabled {
    opacity: ${e=>e.theme.textInput.inactiveOpacity};
    cursor: default;
    pointer-events: none;
  }
`,Cb=Qd.div`
  position: relative;
  &:first-child {
    margin-right: 15px;
  }
`;class eu extends Zs.Component{constructor(){super(...arguments);this.onChange=e=>{const{onChange:t}=this.props;t&&t(e.target.value)}}render(){const{id:e,testId:t,value:i,type:r,min:o,max:n,onBlur:a,onFocus:l,onKeyUp:c,onKeyDown:d,onMouseUp:u,onTouchEnd:h,isDisabled:y,className:k,children:w}=this.props;return Zs.createElement(Cb,{className:k},Zs.createElement(xb,{id:e,"data-test":t,"aria-hidden":y,disabled:y,value:i,type:r,min:o,max:n,onChange:this.onChange,onBlur:a,onFocus:l,onKeyUp:c,onKeyDown:d,onMouseUp:u,onTouchEnd:h}),w)}}eu.defaultProps={type:"text"};var an=eu;import Wr from"react";import _b,{css as tu}from"styled-components";const Eb=_b.div`
  ${or()?tu``:tu`
        display: flex;
        flex: 0 1 auto;
        flex-direction: column;
      `}
`;class Ur extends Wr.Component{constructor(e){super(e);this.node=null;this.handleOutsideClick=e=>{if(this.node&&this.node.current&&this.node.current.contains(e.target))return;this.onSubmit()};this.onSubmit=()=>{const{onSubmit:e}=this.props,{value:t,isActive:i}=this.state;if(e){const r=parseFloat(Ur.cleanValue(t));!Number.isNaN(r)&&i&&e(`${r}`)}this.setState({isActive:!1})};this.onBlur=()=>{this.onSubmit()};this.onFocus=()=>{this.setState({isActive:!0})};this.onKeyDown=e=>{const{value:t}=this.state;if(e.key==="Enter")this.onSubmit();else if(e.key==="ArrowUp"){const i=parseFloat(Ur.cleanValue(t));typeof i=="number"&&this.setState({value:(i+1).toString(),isActive:!0})}else if(e.key==="ArrowDown"){const i=parseFloat(Ur.cleanValue(t));typeof i=="number"&&this.setState({value:(i-1).toString(),isActive:!0})}};this.onChange=e=>{this.setState({value:e.replace(/[^\d.,-]/g,""),isActive:!0})};this.state={value:this.props.value||"",isActive:!1},this.node=Wr.createRef(),document.addEventListener("mousedown",this.handleOutsideClick,!1),document.addEventListener("touchstart",this.handleOutsideClick,!1)}static getDerivedStateFromProps({value:e},{value:t,isActive:i}){return e!==t&&!i?{value:e}:null}static cleanValue(e){return e?e.replace(",",".").replace(/[a-zA-Z]/g,"").trim():""}componentWillUnmount(){document.removeEventListener("mousedown",this.handleOutsideClick,!1),document.removeEventListener("touchstart",this.handleOutsideClick,!1)}render(){const{id:e,label:t,isDisabled:i,ariaHidden:r,onMouseUp:o,onTouchEnd:n,className:a}=this.props,{value:l}=this.state;return Wr.createElement(Eb,{ref:this.node,"data-test":Yt.NummericInput,className:a},Wr.createElement(Ce,{htmlFor:e,label:t,show:!!t,isDisabled:i}),Wr.createElement(an,{id:e,value:l,isDisabled:i,"aria-hidden":r,onChange:this.onChange,onKeyDown:this.onKeyDown,onBlur:this.onBlur,onFocus:this.onFocus,onMouseUp:o,onTouchEnd:n}))}}Ur.defaultProps={showLabel:!0};var ln=Ur;import Qs from"react";import kb from"styled-components";const Tb=kb.input.attrs({type:"search"})`
  ${di}
`,Ob=e=>{const t=i=>{e.onChange(i.target.value)};return Qs.createElement("div",null,Qs.createElement(Ce,{show:!1,label:"photoeditorsdk-Search"}),Qs.createElement(Tb,{id:"photoeditorsdk-Search",onChange:t,placeholder:e.placeholder}))};var iu=Ob;import ea from"react";import ru,{css as Ib}from"styled-components";const Fb=ru.div``,ou=({label:e,children:t,inline:i,showLabel:r,isDisabled:o})=>ea.createElement(Fb,null,ea.createElement(Ce,{isDisabled:o,label:e,show:r}),ea.createElement(Ab,{id:`photoeditorsdk-${e.replace(" ","-")}`,inline:!!i},t)),Ab=ru.div`
  display: inline-flex;
  ${e=>!e.inline&&Ib`
        flex-wrap: wrap;
      `||""}
`;ou.defaultProps={showLabel:!0};var nu=ou;import ui from"react";import $r,{css as Vr}from"styled-components";const Rb=$r.div`
  display: flex;
  flex-direction: column;
  /* needed for IE11 to properly calculate the width */
  min-width: 1px;
`,Mb=$r(Ce)`
  padding-bottom: 2px;
`,ta=Vr`
  ${su()||or()?Vr`
        width: 16px;
        height: 16px;
      `:Vr`
        width: 20px;
        height: 20px;
      `}
  background: ${e=>e.theme.slider.thumbBackground};
  border: 2px solid ${e=>e.theme.slider.thumbBorderColor};
  border-radius: 50%;
  cursor: pointer;
`,zb=e=>{let t=(e.value-e.min)*100/(e.max-e.min);return e.adjust?e.value>0?(t=e.value*(e.max/2)*100,`${e.theme.slider.trackColor} 0%,
      ${e.theme.slider.trackColor} 50%,
      ${e.theme.slider.activeTrackColor} 50%,
      ${e.theme.slider.activeTrackColor} ${50+t}%,
      ${e.theme.slider.trackColor} ${50+t}%,
      ${e.theme.slider.trackColor} 100%
      `):e.value<0?(t=e.value*(e.min/2)*100,`${e.theme.slider.trackColor} 0%,
      ${e.theme.slider.trackColor} ${50-t}%,
      ${e.theme.slider.activeTrackColor} ${50-t}%,
      ${e.theme.slider.activeTrackColor} 50%,
      ${e.theme.slider.trackColor} 50%,
      ${e.theme.slider.trackColor} 100%
      `):`${e.theme.slider.trackColor} 0%,
    ${e.theme.slider.trackColor} 100%`:`${e.theme.slider.activeTrackColor} 0%,
    ${e.theme.slider.activeTrackColor} ${t}%,
    ${e.theme.slider.trackColor} ${t}%,
    ${e.theme.slider.trackColor} 100%`},Pb=$r.input`
  display: flex;
  flex: 1 0 auto;
  appearance: none;
  max-width: calc(100% - 50px);
  outline: none;
  border-radius: 0; /* iOS */

  ${Se}

  ${su()||or()?Vr`
        margin-top: 10px;
        height: 20px;
        /* remove once we have a better concept for focus in all browser */
        &:focus {
          box-shadow: none;
        }
      `:Vr`
        height: 2px;
        background: ${e=>`linear-gradient(to right, ${zb(e)})`};
      `}
  &::-moz-focus-outer {
    /** This is to remove the dotted focus lines in firefox */
    border: 0;
  }
  &:disabled {
    opacity: ${e=>e.theme.slider.inactiveOpacity};
    pointer-events: none;
  }
  &:hover {
    opacity: ${e=>e.theme.slider.hoverOpacity};
  }
  &::-webkit-slider-runnable-track {
    cursor: pointer;
    appearance: none;
  }
  &::-moz-range-track {
    appearance: none;
    cursor: pointer;
  }
  &::-ms-track {
    cursor: pointer;
    height: 2px;
    appearance: none;
    background: transparent;
    color: transparent;
    border-color: transparent;
    border-width: 6px 0;
  }
  &::-webkit-slider-thumb {
    appearance: none;
    ${ta}
  }
  &::-moz-range-thumb {
    appearance: none;
    ${ta}
  }
  &::-ms-thumb {
    appearance: none;
    ${ta}
  }
  &::-ms-fill-lower {
    background: ${e=>`${e.theme.slider.activeTrackColor}`};
  }
  &::-ms-fill-upper {
    background: ${e=>`${e.theme.slider.trackColor}`};
  }
  &::-ms-tooltip {
    display: none;
  }
  @media all and (min-width: 0) and (max-width: 599px) {
    width: 200px;
  }
`,Bb=$r.div`
  display: flex;
  align-items: center;
  height: 26px;
  margin-right: ${e=>e.centerSlider?-56:0}px;
`,Lb=$r(ln)`
  max-width: 50px;
  padding-left: 16px;
  > div > input {
    text-align: center;
  }
`;class au extends ui.Component{constructor(e){super(e);this.onSubmit=e=>{const{onChange:t,suffix:i,divider:r,min:o,max:n,value:a}=this.props,l=e.replace(i,""),c=l?parseFloat(l)/r:a,d=Math.max(o,Math.min(n,c));Number.isNaN(d)||(t(d),this.props.onMouseUp?this.props.onMouseUp():this.props.onTouchEnd&&this.props.onTouchEnd())};this.onSliderChange=e=>{const{onChange:t}=this.props,i=parseFloat(e.target.value);t(i)};this.randomId=Do()}render(){const{"data-test":e,identifier:t,value:i,snap:r,min:o,max:n,divider:a,suffix:l,decimal:c,showLabel:d,showInput:u,style:h,centerSlider:y,adjust:k,label:w,isDisabled:T,step:F,"aria-hidden":$,onMouseUp:E,onTouchEnd:ce,className:bt}=this.props,_e=`photoeditorsdk-slider-${this.randomId}`,M=`${_e}-list`,Z=`${_e}-input`,pe=typeof r=="number",Tt=pe&&ui.createElement("datalist",{id:M},ui.createElement("option",{value:r})),un=`${(i*a).toFixed(c)}${l}`,Yr=u&&ui.createElement(Lb,{id:Z,value:un,isDisabled:T,"aria-hidden":$,onSubmit:this.onSubmit});return ui.createElement(Rb,{className:bt,"data-test":e||t||_e},ui.createElement(Mb,{isDisabled:T,label:w,show:d}),ui.createElement(Bb,{centerSlider:u&&y},ui.createElement(Pb,{type:"range",role:"slider","aria-hidden":$,tabIndex:0,value:i,min:o,max:n,step:F,style:h,disabled:T,id:_e,list:pe?M:void 0,onChange:this.onSliderChange,adjust:k,name:w,onKeyUp:this.onSliderChange,onKeyDown:this.onSliderChange,onMouseUp:E,onTouchEnd:ce}),Tt,Yr))}}au.defaultProps={showLabel:!0,showInput:!0,adjust:!1,centerSlider:!1,min:-1,max:1,value:0,step:.01,decimal:0,divider:100,suffix:""};var lu=au;import Nb from"styled-components";const Gr=Nb(et)`
  color: ${e=>e.theme.button.textPrimaryForeground};

  /* Repeat active styles so they are not overwritten */
  ${({isActive:e})=>e&&Ht}

  ${Ve} {
    display: none;
  }

  &:disabled {
    opacity: ${e=>e.theme.button.textInactiveOpacity};
  }
`;import Hb from"styled-components";const qr=Hb(et)`
  color: ${e=>e.theme.button.textSecondaryForeground};

  /* Repeat active styles so they are not overwritten */
  ${({isActive:e})=>e&&Ht}

  ${Ve} {
    display: none;
  }

  &:disabled {
    opacity: ${e=>e.theme.button.textInactiveOpacity};
  }
`;import Wt from"react";class cu extends Wt.Component{constructor(){super(...arguments);this.onDismiss=()=>{const{handleClose:e,handleDismiss:t}=this.props;e&&e(),t&&t()};this.onConfirm=()=>{const{handleClose:e,handleConfirm:t}=this.props;e&&e(),t&&t()}}render(){const{headerLabel:e,bodyLabel:t,confirmLabel:i,dismissLabel:r,type:o,children:n}=this.props,a=Wt.Children.toArray(n)[0];if(!Wt.isValidElement(a))throw new Error("Child is not a valid react element");return Wt.cloneElement(a,{handleConfirm:this.onConfirm,handleDismiss:this.onDismiss,header:Wt.createElement(er,null,e),body:Wt.createElement(Nt,{"data-test":Yt.DialogBody},t),footer:Wt.createElement(Qi,{type:o},r&&Wt.createElement(qr,{label:r,ariaLabel:r,onClick:this.onDismiss}),i&&Wt.createElement(Gr,{label:i,ariaLabel:i,onClick:this.onConfirm}))})}}import kt from"react";import cn from"styled-components";const jb=cn.div`
  display: flex;
`,Wb=cn(er)`
  padding: 0;
`,Ub=cn.div`
  display: flex;
  flex-direction: column;
  margin-left: 8px;
  @media all and (min-width: 640px) {
    margin-left: 30px;
  }
`,$b=cn(Nt)`
  padding: 0;
  margin: 0;
`;class du extends kt.PureComponent{render(){const{headerLabel:e,bodyLabel:t,children:i}=this.props,r=kt.Children.toArray(i)[0];if(!kt.isValidElement(r))throw new Error("Child is not a valid react element");return kt.cloneElement(r,{height:"90px",body:kt.createElement(Nt,{"data-test":Yt.DialogBody},kt.createElement(jb,null,kt.createElement(qo,null),kt.createElement(Ub,null,kt.createElement(Wb,null,e),kt.createElement($b,null,t))))})}}import tt from"react";import Xr from"styled-components";const Vb=Xr.form`
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
`,Gb=Xr.textarea`
  display: flex;
  caret-color: ${e=>e.theme.primary};
  ${di}
  min-height: 100%;
  padding: 0px;
  outline-offset: -8px;
  color: ${e=>e.theme.modal.bodyForeground};
  resize: none;
  font-family: '${e=>e.theme.typography.fontFamily}', sans-serif;

  &:selection,
  &:-moz-selection {
    background-color: ${e=>e.theme.primary};
    color: ${e=>e.theme.foreground};
  }
`,qb=Xr.label`
  padding: 11px 20px 8px;
  font-size: ${e=>e.theme.measurements.fontSystem.label.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.label.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.label.case};
  color: ${e=>e.theme.modal.headerForeground};
`,Xb=Xr(Nt)`
  height: 100%;
`,Kb=Xr(Qi)`
  border-top: none;
`;class uu extends tt.Component{constructor(){super(...arguments);this.state={value:""};this.input=tt.createRef();this.handleKeydown=e=>{Ul(this.handleDismiss)(e)};this.handleDismiss=()=>{const{handleDismiss:e}=this.props;e&&e(!1)};this.handleConfirm=()=>{const{handleConfirm:e}=this.props,{value:t}=this.input.current;t&&(e&&e(t),this.handleDismiss())};this.onChange=e=>{const t=Ol(e.target.value);this.input.current.value=t,this.setState({value:t})};this.onSubmit=e=>{e.preventDefault()}}componentDidMount(){const{text:e,defaultText:t}=this.props;this.input.current.focus(),this.input.current.value=e||t||"",this.setState({value:this.input.current.value}),document.addEventListener("keydown",this.handleKeydown,!1),e===t&&this.input.current.select()}componentDidUpdate(e){const{isVisible:t}=this.props;e.isVisible!==t&&(t&&this.input.current.focus())}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeydown,!1)}render(){const{headerLabel:e,dismissLabel:t,confirmLabel:i,maxLength:r,type:o,children:n}=this.props,{value:a}=this.state,l=tt.Children.toArray(n)[0];if(!tt.isValidElement(l))throw new Error("Child is not a valid react element");return tt.cloneElement(l,{handleConfirm:this.handleConfirm,handleDismiss:this.handleDismiss,isConfirmDisabled:!a,height:"150px",header:tt.createElement(qb,{htmlFor:"photoeditorsdk-TextInput"},e),body:tt.createElement(Xb,null,tt.createElement(Vb,{onSubmit:this.onSubmit},tt.createElement(Gb,{ref:this.input,id:"photoeditorsdk-TextInput",placeholder:"Write Something",autoFocus:!0,onChange:this.onChange,maxLength:r}))),footer:tt.createElement(Kb,{type:o},tt.createElement(qr,{label:t,ariaLabel:t,onClick:this.handleDismiss}),tt.createElement(Gr,{label:i,ariaLabel:i,isDisabled:!a,onClick:this.handleConfirm}))})}}uu.defaultProps={defaultText:"Write Something"};var hu=uu;import Yb from"styled-components";const pu=Yb.div`
  padding-bottom: ${e=>(e.count||1)*8}px;
`;var fu=pu;pu.defaultProps={count:1};import nr from"react";class mu extends nr.Component{getChildren(){const e=[],t=[];return nr.Children.forEach(this.props.children,i=>{switch(i.type.componentName){case"case":this.props.type===i.props.value&&e.push(i);break;case"default":t.push(i);break}}),e.length>0?e:t}render(){const e=this.getChildren();return e.length===0?null:nr.createElement(nr.Fragment,null,e)}}class ia extends nr.Component{render(){return this.props.children}}ia.componentName="case";class ra extends nr.Component{render(){return this.props.children}}ra.componentName="default";import Jb,{keyframes as Zb,css as Qb}from"styled-components";const ey=Zb`
  from { transform: translate(-50%, 0%); }
  to { transform: translate(-50%, 50%); }
`,ty=Jb.div`
  position: absolute;
  top: ${e=>e.position.y}px;
  left: ${e=>e.position.x}px;
  transform: translate(-50%, 50%);
  background: black;
  color: white;
  border-radius: ${e=>e.theme.shape.radiusMedium}px;
  padding: 10px 16px;
  text-align: center;
  z-index: ${e=>e.theme.measurements.zIndex.toast};
  visibility: hidden;

  ${({show:e})=>e&&Qb`
      visibility: visible;
      animation: ${ey} 0.5s, fadeout 0.5s 2.5s;
    `}
`;var gu=ty;import oa from"react";import na,{css as bu}from"styled-components";const iy=na(et)`
  ${({fullWidth:e})=>e&&bu`
      width: 100%;
    `}
`,ry=na.div`
  &:focus {
    outline: none;
  }

  > img {
    height: 18px;
    width: 18px;
  }

  > svg {
    height: 18px;
    width: 18px;
  }
  display: none;

  @media all and (min-width: 0) and (max-width: 599px) {
    display: flex;
  }
`,oy=na.div`
  display: flex;
  justify-content: center;
  align-items: center;
  &:focus {
    outline: none;
  }

  ${({hasIcon:e})=>e&&bu`
      @media all and (min-width: 0) and (max-width: 599px) {
        display: none;
      }
    `}
`,Oi=n=>{var{label:e,children:t,icon:i,fullWidth:r}=n,o=Ge(n,["label","children","icon","fullWidth"]);const a=oa.createElement(oy,{hasIcon:!!i},e,t);return oa.createElement(iy,p({fullWidth:r},o),i&&oa.createElement(ry,null,i),(t||e)&&a)};import ny from"styled-components";const sy=ny(Oi)`
  background: ${e=>e.theme.button.outlinedPrimaryBackground};
  color: ${e=>e.theme.button.outlinedPrimaryForeground};
  border: 1px solid ${e=>e.theme.button.outlinedBorderColor};
  min-width: 32px;
`;import ay from"styled-components";const ly=ay(Oi)`
  background: ${e=>e.theme.button.outlinedSecondaryBackground};
  color: ${e=>e.theme.button.outlinedSecondaryForeground};
  border: 1px solid ${e=>e.theme.button.outlinedBorderColor};
`;import yA from"react";import yu from"styled-components";const xA=yu(et)`
  color: ${e=>e.theme.foreground};
  /* Repeat active styles so they are not overwritten */
  ${({isActive:e})=>e&&Ht}

  ${Ve} {
    display: none;
  }

  &:disabled {
    opacity: ${e=>e.theme.button.textInactiveOpacity};
  }
`,CA=yu.div`
  display: flex;
  &:focus {
    outline: none;
  }
`;import cy from"styled-components";const dy=cy(Oi)`
  background: ${e=>e.theme.button.containedPrimaryBackground};
  color: ${e=>e.theme.button.containedPrimaryForeground};
  border: 1px solid ${e=>e.theme.button.containedPrimaryBackground};

  &:active {
    color: ${e=>e.theme.button.containedPrimaryForeground};
  }
`;import sr from"react";import uy,{css as vu}from"styled-components";const hy=()=>vu`
    animation: ${Eo} 0.2s linear;
  `,py=vu`
  border: 1px solid ${e=>e.theme.card.activeBorderColor};
  ${Ys} {
    background-color: ${e=>e.theme.card.activeOverlayColor};
  }
`,fy=uy.button.attrs(e=>{const t={};return e.image&&(t.backgroundImage=`url(${e.image})`),{style:t}})`
  &&& {
    box-sizing: border-box;
  }

  padding: 0;
  cursor: pointer;
  /* Safari will change the height of the toolbar and position the category cards at the bottom for some reason */
  vertical-align: top;
  border: none;
  box-sizing: border-box;
  background-size: cover;
  background-position: center center;
  background-repeat: no-repeat;
  background-color: ${e=>e.theme.card.background};
  color: ${e=>e.theme.card.foreground};
  border-radius: ${e=>e.theme.shape.radiusMedium}px;
  ${hy};
  animation-fill-mode: both;
  overflow: hidden;

  ${Se}

  /* Active */

  /* No :active styles on purpose. */

  ${({isActive:e})=>e&&py}

  /* Disabled */

  &:disabled {
    cursor: default;
    pointer-events: none;

    ${Ve} {
      background-color: ${e=>e.theme.card.inactiveOverlayColor};
    }
  }

  /* Hover */

  &:hover {
    ${rr} {
      background-color: ${e=>e.theme.card.hoverOverlayColor};
    }
  }
`;class Su extends sr.Component{constructor(){super(...arguments);this.state=rn;this.timeout=null;this.onKeyDown=e=>{(e.key==="Space"||e.key==="Enter")&&(this.props.onClick&&this.props.onClick())};this.onClick=e=>{const t=e.currentTarget.getBoundingClientRect(),i=e.pageX-t.left,r=e.pageY-t.top;this.state.display==="block"?this.setState({display:"none"},()=>{this.setRippleState(i,r)}):this.setRippleState(i,r),this.props.onClick(e)};this.setRippleState=(e,t)=>{this.setState({left:e,top:t,display:"block"}),this.timeout=setTimeout(()=>{this.setState({display:"none"})},1200)}}componentWillUnmount(){clearTimeout(this.timeout)}render(){const{children:e,label:t,isActive:i,isDisabled:r,image:o,style:n,className:a}=this.props,{left:l,top:c,display:d}=this.state;return sr.createElement(fy,{isActive:i,"data-test":t,"aria-label":t,disabled:r,image:o,onClick:this.onClick,onKeyDown:this.onKeyDown,style:n,className:a},e,sr.createElement(on,{display:d,left:l,top:c}),sr.createElement(Ys,null),sr.createElement(Ve,null),sr.createElement(rr,null))}}Su.defaultProps={isActive:!1};import BA from"react";import Kr,{css as dn}from"styled-components";const HA=Kr.div`
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0 4px;
  font-size: ${e=>e.theme.measurements.fontSystem.label.size}px;
  letter-spacing: ${e=>e.theme.measurements.fontSystem.label.letterSpacing}px;
  text-transform: ${e=>e.theme.measurements.fontSystem.label.case};
`,jA=Kr.div`
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  position: absolute;
  bottom: 0px;
  border-radius: ${e=>e.theme.shape.radiusMedium}px;
  left: 0;
  ${e=>e.withBackground?dn`
          color: ${e.theme.card.labelForeground};
          height: 40px;
          background: ${e.theme.card.labelBackground};
        `:dn`
          color: ${e.theme.card.foreground};
          height: 32px;
        `}
  width: 100%;
  cursor: pointer;
`,WA=Kr.div`
  width: 0;
  height: 0;
  border-left: 5px solid transparent;
  border-right: 5px solid transparent;
  border-top: 5px solid ${e=>e.theme.card.labelForeground};
  ${e=>e.withBackground?dn`
          border-top-color: ${e.theme.card.labelForeground};
        `:dn`
          border-top-color: ${e.theme.card.foreground};
        `}
  transform: rotate(${e=>e.rotation||0}deg);
  display: inline-block;
  transition-duration: 0.3s;
  transition-timing-function: ease-in;
`,UA=Kr.span`
  display: flex;
  align-items: center;
  justify-content: center;
  padding-left: 10px;
`,$A=Kr.div`
  ${Zi}
`;import my from"styled-components";const gy=my.div.attrs(e=>({style:{backgroundImage:`url(${e.url})`}}))`
  position: absolute;
  top: 4px;
  left: 4px;
  height: 28px;
  width: 28px;
  border-radius: 50%;
`;const sa=m(vr()),aa=m(At()),wu=m(wr()),la=m(Rt());const Du=()=>{if(typeof document=="undefined")return 0;if(or())return window.innerWidth-document.documentElement.clientWidth;const{body:e}=document,t=document.createElement("div"),i=t.style;i.position="fixed",i.left="0",i.visibility="hidden",i.overflowY="scroll",e.appendChild(t);const r=t.getBoundingClientRect().right;return e.removeChild(t),r},Pe="photoeditorsdk-simplebar";class he{constructor(e,t){this.minScrollbarWidth=20;this.initDOM=()=>{if(Array.prototype.filter.call(this.el.children,e=>e.classList.contains(this.classNames.wrapper)).length)this.wrapperEl=this.el.querySelector(`.${this.classNames.wrapper}`),this.contentWrapperEl=this.el.querySelector(`.${this.classNames.contentWrapper}`),this.offsetEl=this.el.querySelector(`.${this.classNames.offset}`),this.maskEl=this.el.querySelector(`.${this.classNames.mask}`),this.contentEl=this.el.querySelector(`.${this.classNames.contentEl}`),this.placeholderEl=this.el.querySelector(`.${this.classNames.placeholder}`),this.heightAutoObserverWrapperEl=this.el.querySelector(`.${this.classNames.heightAutoObserverWrapperEl}`),this.heightAutoObserverEl=this.el.querySelector(`.${this.classNames.heightAutoObserverEl}`),this.axis.x.track.el=this.el.querySelector(`.${this.classNames.track}.${this.classNames.horizontal}`),this.axis.y.track.el=this.el.querySelector(`.${this.classNames.track}.${this.classNames.vertical}`);else{for(this.wrapperEl=document.createElement("div"),this.contentWrapperEl=document.createElement("div"),this.offsetEl=document.createElement("div"),this.maskEl=document.createElement("div"),this.contentEl=document.createElement("div"),this.placeholderEl=document.createElement("div"),this.heightAutoObserverWrapperEl=document.createElement("div"),this.heightAutoObserverEl=document.createElement("div"),this.wrapperEl.classList.add(this.classNames.wrapper),this.contentWrapperEl.classList.add(this.classNames.contentWrapper),this.offsetEl.classList.add(this.classNames.offset),this.maskEl.classList.add(this.classNames.mask),this.contentEl.classList.add(this.classNames.contentEl),this.placeholderEl.classList.add(this.classNames.placeholder),this.heightAutoObserverWrapperEl.classList.add(this.classNames.heightAutoObserverWrapperEl),this.heightAutoObserverEl.classList.add(this.classNames.heightAutoObserverEl);this.el.firstChild;)this.contentEl.appendChild(this.el.firstChild);this.contentWrapperEl.appendChild(this.contentEl),this.offsetEl.appendChild(this.contentWrapperEl),this.maskEl.appendChild(this.offsetEl),this.heightAutoObserverWrapperEl.appendChild(this.heightAutoObserverEl),this.wrapperEl.appendChild(this.heightAutoObserverWrapperEl),this.wrapperEl.appendChild(this.maskEl),this.wrapperEl.appendChild(this.placeholderEl),this.el.appendChild(this.wrapperEl)}if(!this.axis.x.track.el||!this.axis.y.track.el){const e=document.createElement("div"),t=document.createElement("div");e.classList.add(this.classNames.track),t.classList.add(this.classNames.scrollbar),e.appendChild(t),this.axis.x.track.el=e.cloneNode(!0),this.axis.x.track.el.classList.add(this.classNames.horizontal),this.axis.y.track.el=e.cloneNode(!0),this.axis.y.track.el.classList.add(this.classNames.vertical),this.el.appendChild(this.axis.x.track.el),this.el.appendChild(this.axis.y.track.el)}this.axis.x.scrollbar.el=this.axis.x.track.el.querySelector(`.${this.classNames.scrollbar}`),this.axis.y.scrollbar.el=this.axis.y.track.el.querySelector(`.${this.classNames.scrollbar}`),this.options.autoHide||(this.axis.x.scrollbar.el.classList.add(this.classNames.visible),this.axis.y.scrollbar.el.classList.add(this.classNames.visible)),this.el.setAttribute("data-photoeditorsdk-simplebar","init")};this.initListeners=()=>{this.options.autoHide&&this.el.addEventListener("mouseenter",this.onMouseEnter),["mousedown","click","dblclick","touchstart","touchend","touchmove"].forEach(e=>{this.el.addEventListener(e,this.onPointerEvent,{capture:!0,passive:!0})}),this.el.addEventListener("mousemove",this.onMouseMove),this.el.addEventListener("mouseleave",this.onMouseLeave),this.contentWrapperEl.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.onWindowResize),this.resizeObserver=new Rr(this.recalculate),by?(Vi(this.el)&&this.resizeObserver.observe(this.el),Vi(this.contentEl)&&this.resizeObserver.observe(this.contentEl)):(this.resizeObserver.observe(this.el),this.resizeObserver.observe(this.contentEl))};this.recalculate=()=>{const e=this.heightAutoObserverEl.offsetHeight<=1,t=this.heightAutoObserverEl.offsetWidth<=1;this.elStyles=window.getComputedStyle(this.el),this.isRtl=this.elStyles.direction==="rtl",this.contentEl.style.padding=`${this.elStyles.paddingTop} ${this.elStyles.paddingRight} ${this.elStyles.paddingBottom} ${this.elStyles.paddingLeft}`,this.wrapperEl.style.margin=`-${this.elStyles.paddingTop} -${this.elStyles.paddingRight} -${this.elStyles.paddingBottom} -${this.elStyles.paddingLeft}`,this.contentWrapperEl.style.height=e?"auto":"100%",this.placeholderEl.style.width=t?`${this.contentEl.offsetWidth}px`:"auto",this.placeholderEl.style.height=`${this.contentEl.scrollHeight}px`,this.axis.x.isOverflowing=this.contentWrapperEl.scrollWidth>this.contentWrapperEl.offsetWidth,this.axis.y.isOverflowing=this.contentWrapperEl.scrollHeight>this.contentWrapperEl.offsetHeight,this.axis.x.isOverflowing=this.elStyles.overflowX==="hidden"?!1:this.axis.x.isOverflowing,this.axis.y.isOverflowing=this.elStyles.overflowY==="hidden"?!1:this.axis.y.isOverflowing,this.axis.x.forceVisible=this.options.forceVisible==="x"||this.options.forceVisible===!0,this.axis.y.forceVisible=this.options.forceVisible==="y"||this.options.forceVisible===!0,this.hideNativeScrollbar(),this.axis.x.track.rect=this.axis.x.track.el.getBoundingClientRect(),this.axis.y.track.rect=this.axis.y.track.el.getBoundingClientRect(),this.axis.x.scrollbar.size=this.getScrollbarSize("x"),this.axis.y.scrollbar.size=this.getScrollbarSize("y"),this.axis.x.scrollbar.el.style.width=`${this.axis.x.scrollbar.size}px`,this.axis.y.scrollbar.el.style.height=`${this.axis.y.scrollbar.size}px`,this.positionScrollbar("x"),this.positionScrollbar("y"),this.toggleTrackVisibility("x"),this.toggleTrackVisibility("y")};this.getScrollbarSize=(e="y")=>{const t=this.scrollbarWidth?this.contentWrapperEl[this.axis[e].scrollSizeAttr]:this.contentWrapperEl[this.axis[e].scrollSizeAttr]-this.minScrollbarWidth,i=this.axis[e].track.rect[this.axis[e].sizeAttr];let r;if(!this.axis[e].isOverflowing)return null;const o=i/t;return r=Math.max(~~(o*i),this.options.scrollbarMinSize),this.options.scrollbarMaxSize&&(r=Math.min(r,this.options.scrollbarMaxSize)),r};this.positionScrollbar=(e="y")=>{const t=this.contentWrapperEl[this.axis[e].scrollSizeAttr],i=this.axis[e].track.rect[this.axis[e].sizeAttr],r=parseInt(this.elStyles[this.axis[e].sizeAttr],10),{scrollbar:o}=this.axis[e];let n=this.contentWrapperEl[this.axis[e].scrollOffsetAttr];n=e==="x"&&this.isRtl&&he.getRtlHelpers().isRtlScrollingInverted?-n:n;const a=n/(t-r);let l=~~((i-o.size)*a);l=e==="x"&&this.isRtl&&he.getRtlHelpers().isRtlScrollbarInverted?l+(i-o.size):l,o.el.style.transform=e==="x"?`translate3d(${l}px, 0, 0)`:`translate3d(0, ${l}px, 0)`};this.toggleTrackVisibility=(e="y")=>{const t=this.axis[e].track.el,i=this.axis[e].scrollbar.el;this.axis[e].isOverflowing||this.axis[e].forceVisible?(t.style.visibility="visible",this.contentWrapperEl.style[this.axis[e].overflowAttr]="scroll"):(t.style.visibility="hidden",this.contentWrapperEl.style[this.axis[e].overflowAttr]="hidden"),i.style.display=this.axis[e].isOverflowing?"block":"none"};this.onScroll=()=>{this.scrollXTicking||(window.requestAnimationFrame(this.scrollX),this.scrollXTicking=!0),this.scrollYTicking||(window.requestAnimationFrame(this.scrollY),this.scrollYTicking=!0)};this.scrollX=()=>{this.axis.x.isOverflowing&&(this.showScrollbar("x"),this.positionScrollbar("x")),this.scrollXTicking=!1};this.scrollY=()=>{this.axis.y.isOverflowing&&(this.showScrollbar("y"),this.positionScrollbar("y")),this.scrollYTicking=!1};this.onMouseEnter=()=>{this.showScrollbar("x"),this.showScrollbar("y")};this.onMouseMove=e=>{this.mouseX=e.clientX,this.mouseY=e.clientY,(this.axis.x.isOverflowing||this.axis.x.forceVisible)&&this.onMouseMoveForAxis("x"),(this.axis.y.isOverflowing||this.axis.y.forceVisible)&&this.onMouseMoveForAxis("y")};this.onMouseMoveForAxis=(e="y")=>{this.axis[e].track.rect=this.axis[e].track.el.getBoundingClientRect(),this.axis[e].scrollbar.rect=this.axis[e].scrollbar.el.getBoundingClientRect();const t=this.isWithinBounds(this.axis[e].scrollbar.rect);t?this.axis[e].scrollbar.el.classList.add(this.classNames.hover):this.axis[e].scrollbar.el.classList.remove(this.classNames.hover),this.isWithinBounds(this.axis[e].track.rect)?(this.showScrollbar(e),this.axis[e].track.el.classList.add(this.classNames.hover)):this.axis[e].track.el.classList.remove(this.classNames.hover)};this.onMouseLeave=()=>{this.onMouseMove.cancel(),(this.axis.x.isOverflowing||this.axis.x.forceVisible)&&this.onMouseLeaveForAxis("x"),(this.axis.y.isOverflowing||this.axis.y.forceVisible)&&this.onMouseLeaveForAxis("y"),this.mouseX=-1,this.mouseY=-1};this.onWindowResize=()=>{this.scrollbarWidth=Du(),this.hideNativeScrollbar()};this.hideScrollbars=()=>{this.axis.x.track.rect=this.axis.x.track.el.getBoundingClientRect(),this.axis.y.track.rect=this.axis.y.track.el.getBoundingClientRect(),this.isWithinBounds(this.axis.y.track.rect)||(this.axis.y.scrollbar.el.classList.remove(this.classNames.visible),this.axis.y.isVisible=!1),this.isWithinBounds(this.axis.x.track.rect)||(this.axis.x.scrollbar.el.classList.remove(this.classNames.visible),this.axis.x.isVisible=!1)};this.onPointerEvent=e=>{let t,i;this.axis.x.scrollbar.rect=this.axis.x.scrollbar.el.getBoundingClientRect(),this.axis.y.scrollbar.rect=this.axis.y.scrollbar.el.getBoundingClientRect(),(this.axis.x.isOverflowing||this.axis.x.forceVisible)&&(i=this.isWithinBounds(this.axis.x.scrollbar.rect)),(this.axis.y.isOverflowing||this.axis.y.forceVisible)&&(t=this.isWithinBounds(this.axis.y.scrollbar.rect)),(t||i)&&(e.preventDefault(),e.stopPropagation(),e.type==="mousedown"&&(t&&this.onDragStart(e,"y"),i&&this.onDragStart(e,"x")))};this.drag=e=>{const{track:t,scrollbar:i}=this.axis[this.draggedAxis],r=t.rect[this.axis[this.draggedAxis].sizeAttr];e.preventDefault(),e.stopPropagation();const o=this.draggedAxis==="y"?e.pageY:e.pageX,n=o-t.rect[this.axis[this.draggedAxis].offsetAttr]-this.axis[this.draggedAxis].dragOffset,a=n/t.rect[this.axis[this.draggedAxis].sizeAttr];let l=a*this.contentWrapperEl[this.axis[this.draggedAxis].scrollSizeAttr];this.draggedAxis==="x"&&(l=this.isRtl&&he.getRtlHelpers().isRtlScrollbarInverted?l-(r+i.size):l,l=this.isRtl&&he.getRtlHelpers().isRtlScrollingInverted?-l:l),this.contentWrapperEl[this.axis[this.draggedAxis].scrollOffsetAttr]=l};this.onEndDrag=e=>{e.preventDefault(),e.stopPropagation(),this.el.classList.remove(this.classNames.dragging),document.removeEventListener("mousemove",this.drag,!0),document.removeEventListener("mouseup",this.onEndDrag,!0),this.removePreventClickId=window.setTimeout(()=>{document.removeEventListener("click",this.preventClick,!0),document.removeEventListener("dblclick",this.preventClick,!0),this.removePreventClickId=null})};this.preventClick=e=>{e.preventDefault(),e.stopPropagation()};if(this.el=e,this.options=p(p({},he.defaultOptions),t),this.classNames=p(p({},he.defaultOptions.classNames),this.options.classNames),this.axis={x:{scrollOffsetAttr:"scrollLeft",sizeAttr:"width",scrollSizeAttr:"scrollWidth",offsetAttr:"left",overflowAttr:"overflowX",dragOffset:0,isOverflowing:!0,isVisible:!1,forceVisible:!1,track:{},scrollbar:{}},y:{scrollOffsetAttr:"scrollTop",sizeAttr:"height",scrollSizeAttr:"scrollHeight",offsetAttr:"top",overflowAttr:"overflowY",dragOffset:0,isOverflowing:!0,isVisible:!1,forceVisible:!1,track:{},scrollbar:{}}},this.removePreventClickId=null,this.el.SimpleBar)return;this.recalculate=la.default(this.recalculate,64),this.onMouseMove=la.default(this.onMouseMove,64),this.hideScrollbars=aa.default(this.hideScrollbars,this.options.timeout),this.onWindowResize=aa.default(this.onWindowResize,64,{leading:!0}),he.getRtlHelpers=wu.default(he.getRtlHelpers),this.init()}static getRtlHelpers(){const e=document.createElement("div");e.innerHTML='<div class="photoeditorsdk-hs-dummy-scrollbar-size"><div style="height: 200% width: 200% margin: 10px 0"></div></div>';const t=e.firstElementChild;document.body.appendChild(t);const i=t.firstElementChild;t.scrollLeft=0;const r=he.getOffset(t),o=he.getOffset(i);t.scrollLeft=999;const n=he.getOffset(i);return{isRtlScrollingInverted:r.left!==o.left&&o.left-n.left!==0,isRtlScrollbarInverted:r.left!==o.left}}static initHtmlApi(){this.initDOMLoadedElements=this.initDOMLoadedElements.bind(this),typeof MutationObserver!="undefined"&&(this.globalObserver=new MutationObserver(e=>{e.forEach(t=>{Array.prototype.forEach.call(t.addedNodes,i=>{i.nodeType===1&&(i.hasAttribute("data-photoeditorsdk-simplebar")&&!i.SimpleBar?new he(i,he.getElOptions(i)):Array.prototype.forEach.call(i.querySelectorAll("[data-photoeditorsdk-simplebar]"),r=>{r.SimpleBar||new he(r,he.getElOptions(r))}))}),Array.prototype.forEach.call(t.removedNodes,i=>{i.nodeType===1&&(i.hasAttribute("data-photoeditorsdk-simplebar")&&i.SimpleBar?i.SimpleBar.unMount():Array.prototype.forEach.call(i.querySelectorAll("[data-photoeditorsdk-simplebar]"),r=>{r.SimpleBar&&r.SimpleBar.unMount()}))})})}),this.globalObserver.observe(document,{childList:!0,subtree:!0})),document.readyState==="complete"||document.readyState!=="loading"&&!document.documentElement.scroll?window.setTimeout(this.initDOMLoadedElements):(document.addEventListener("DOMContentLoaded",this.initDOMLoadedElements),window.addEventListener("load",this.initDOMLoadedElements))}static getElOptions(e){const t=Array.prototype.reduce.call(e.attributes,(i,r)=>{const o=r.name.match(/data-photoeditorsdk-simplebar-(.+)/);if(o){const n=o[1].replace(/\W+(.)/g,(a,l)=>l.toUpperCase());switch(r.value){case"true":i[n]=!0;break;case"false":i[n]=!1;break;case void 0:i[n]=!0;break;default:i[n]=r.value}}return i},{});return t}static removeObserver(){this.globalObserver.disconnect()}static initDOMLoadedElements(){document.removeEventListener("DOMContentLoaded",this.initDOMLoadedElements),window.removeEventListener("load",this.initDOMLoadedElements),Array.prototype.forEach.call(document.querySelectorAll("[data-photoeditorsdk-simplebar]"),e=>{e.SimpleBar||new he(e,he.getElOptions(e))})}static getOffset(e){const t=e.getBoundingClientRect();return{top:t.top+(window.pageYOffset||document.documentElement.scrollTop),left:t.left+(window.pageXOffset||document.documentElement.scrollLeft)}}init(){this.el.SimpleBar=this,sa.default&&(this.initDOM(),this.scrollbarWidth=Du(),this.recalculate(),this.initListeners())}hideNativeScrollbar(){if(this.offsetEl.style[this.isRtl?"left":"right"]=this.axis.y.isOverflowing||this.axis.y.forceVisible?`-${this.scrollbarWidth||this.minScrollbarWidth}px`:0,this.offsetEl.style.bottom=this.axis.x.isOverflowing||this.axis.x.forceVisible?`-${this.scrollbarWidth||this.minScrollbarWidth}px`:0,!this.scrollbarWidth){const e=this.isRtl?"paddingLeft":"paddingRight";this.contentWrapperEl.style[e]=this.axis.y.isOverflowing||this.axis.y.forceVisible?`${this.minScrollbarWidth}px`:0,this.contentWrapperEl.style.paddingBottom=this.axis.x.isOverflowing||this.axis.x.forceVisible?`${this.minScrollbarWidth}px`:0}}onMouseLeaveForAxis(e="y"){this.axis[e].track.el.classList.remove(this.classNames.hover),this.axis[e].scrollbar.el.classList.remove(this.classNames.hover)}showScrollbar(e="y"){const t=this.axis[e].scrollbar.el;this.axis[e].isVisible||(t.classList.add(this.classNames.visible),this.axis[e].isVisible=!0),this.options.autoHide&&this.hideScrollbars()}onDragStart(e,t="y"){const i=this.axis[t].scrollbar.el,r=t==="y"?e.pageY:e.pageX;this.axis[t].dragOffset=r-i.getBoundingClientRect()[this.axis[t].offsetAttr],this.draggedAxis=t,this.el.classList.add(this.classNames.dragging),document.addEventListener("mousemove",this.drag,!0),document.addEventListener("mouseup",this.onEndDrag,!0),this.removePreventClickId===null?(document.addEventListener("click",this.preventClick,!0),document.addEventListener("dblclick",this.preventClick,!0)):(window.clearTimeout(this.removePreventClickId),this.removePreventClickId=null)}getContentElement(){return this.contentEl}getScrollElement(){return this.contentWrapperEl}removeListeners(){this.options.autoHide&&this.el.removeEventListener("mouseenter",this.onMouseEnter),["mousedown","click","dblclick","touchstart","touchend","touchmove"].forEach(e=>{this.el.removeEventListener(e,this.onPointerEvent,{capture:!0,passive:!0})}),this.el.removeEventListener("mousemove",this.onMouseMove),this.el.removeEventListener("mouseleave",this.onMouseLeave),this.contentWrapperEl.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.onWindowResize),this.mutationObserver&&this.mutationObserver.disconnect(),this.resizeObserver.disconnect(),this.recalculate.cancel(),this.onMouseMove.cancel(),this.hideScrollbars.cancel(),this.onWindowResize.cancel()}unMount(){this.removeListeners(),this.el.SimpleBar=null}isChildNode(e){return e===null?!1:e===this.el?!0:this.isChildNode(e.parentNode)}isWithinBounds(e){return this.mouseX>=e.left&&this.mouseX<=e.left+e.width&&this.mouseY>=e.top&&this.mouseY<=e.top+e.height}}he.defaultOptions={autoHide:!0,forceVisible:!1,classNames:{contentEl:`${Pe}-content`,contentWrapper:`${Pe}-content-wrapper`,offset:`${Pe}-offset`,mask:`${Pe}-mask`,wrapper:`${Pe}-wrapper`,placeholder:`${Pe}-placeholder`,scrollbar:`${Pe}-scrollbar`,track:`${Pe}-track`,heightAutoObserverWrapperEl:`${Pe}-height-auto-observer-wrapper`,heightAutoObserverEl:`${Pe}-height-auto-observer`,visible:`${Pe}-visible`,horizontal:`${Pe}-horizontal`,vertical:`${Pe}-vertical`,hover:`${Pe}-hover`,dragging:`${Pe}-dragging`},scrollbarMinSize:25,scrollbarMaxSize:0,timeout:1e3};sa.default&&he.initHtmlApi();const ZR={Focused:Se,HiddenScrollbar:gd,VisuallyHidden:Zi},QR={ripple:_o,scale:fc,slide:Eo},eM={Container:Rc,ColorItem:bd,ColorItemBase:jo,ColorItemBackground:No,ColorItemTiledBackground:Wo,ColorItemActiveOverlay:Ho,Dialog:yd,DialogBase:Vo,DialogContainer:Go,DialogBackdrop:$o,DialogHeader:er,DialogBody:Nt,DialogFooter:Qi,DialogSpinner:qo,TextEditModal:hu,ActionModal:cu,InfoModal:du,Spacer:fu,Draggable:Rd,DraggableCore:ir,Toast:gu,Input:{Label:Ce,File:Jd,Search:iu,Slider:lu,CarouselSlider:Hd,Selection:nu,Checkbox:Ud,CheckboxBase:nn,CheckboxInput:sn,CheckboxCheckMark:Nr,Dropdown:Yd,Text:an,NumericInput:ln,Form:Zd},Switch:{Index:mu,Case:ia,Default:ra}},tM={CommonInputStyles:di};export{yA as a,BA as b,Ml as c,Fc as d,Al as e,Hl as f,Rr as g,Fl as h,Pl as i,Bl as j,dy as k,sy as l,ly as m,gy as n,Rl as o,Wl as p,Ve as q,zl as r,jl as s,Gr as t,qr as u,BS as v,Nl as w,HA as x,Ge as y,xA as z,Ll as A,R as B,Oi as C,jA as D,CA as E,WA as F,J as G,UA as H,$A as I,he as J,Zn as K,Yt as L,et as M,V as N,s as O,Su as P,Zt as Q,A as R,xr as S,j as T,le as U,ZR as V,QR as W,eM as X,At as Y,zo as Z,ki as _,Ls as $,b as aa};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/**
 * Adapted from https://github.com/Grsmto/simplebar
 * MIT License (MIT) Copyright (c) 2015 Jonathan Nicol
 * @license
 */
/** @license mobx-react v5.4.4
 * index.module.js
 *
 * Copyright (c) 2015 Michel Weststrate.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
