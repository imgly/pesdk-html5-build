var RC=Object.create;var io=Object.defineProperty;var Hh=Object.getOwnPropertyDescriptor;var EC=Object.getOwnPropertyNames;var SC=Object.getPrototypeOf;var FC=Object.prototype.hasOwnProperty;var OC=(s,e,t)=>e in s?io(s,e,{enumerable:true,configurable:true,writable:true,value:t}):s[e]=t;var qh=s=>io(s,"__esModule",{value:true});var _=(s,e)=>()=>(s&&(e=s(s=0)),e);var we=(s,e)=>()=>(e||s((e={exports:{}}).exports,e),e.exports);var Me=(s,e)=>{qh(s);for(var t in e)io(s,t,{get:e[t],enumerable:true})};var AC=(s,e,t)=>{if(e&&typeof e==="object"||typeof e==="function"){for(let i of EC(e))if(!FC.call(s,i)&&i!=="default")io(s,i,{get:()=>e[i],enumerable:!(t=Hh(e,i))||t.enumerable})}return s};var Ur=s=>{return AC(qh(io(s!=null?RC(SC(s)):{},"default",s&&s.__esModule&&"default"in s?{get:()=>s.default,enumerable:true}:{value:s,enumerable:true})),s)};var wS=(s,e,t,i)=>{var r=i>1?void 0:i?Hh(e,t):e;for(var o=s.length-1,n;o>=0;o--)if(n=s[o])r=(i?n(e,t,r):n(r))||r;if(i&&r)io(e,t,r);return r};var I=(s,e,t)=>{OC(s,typeof e!=="symbol"?e+"":e,t);return t};var ke;var ei=_(()=>{ke=s=>{if(s){s.width=1;s.height=1;const e=s.getContext("2d");if(e){e.clearRect(0,0,1,1)}}}});var Bi,fo;var lm=_(()=>{Bi={imgly_font_bernier_regular:"imgly_font_sancreek",imgly_font_cheque_regular:"imgly_font_kumar_one_outline",imgly_font_gagalin_regular:"imgly_font_permanent_marker",imgly_font_hagin_caps_thin:"imgly_font_nixie_one",imgly_font_intro_inline:"imgly_font_bungee_inline",imgly_font_nexa_script:"imgly_font_molle",imgly_font_panton_blackitalic_caps:"imgly_font_roboto_black_italic",imgly_font_panton_lightitalic_caps:"imgly_font_roboto_light_italic",imgly_font_perfograma:"imgly_font_codystar",imgly_font_panton_black_caps:"imgly_font_roboto_black",imgly_font_panton_light_caps:"imgly_font_roboto_light",imgly_font_summer_font_light:"imgly_font_sue_ellen_francisco"};fo=(s,e=false)=>{if(Bi[s]){if(e){console.warn(`Font ${s} was deprecated. Please use ${Bi[s]} instead.`)}return Bi[s]}return s}});var Qf=we(($I,Zf)=>{var _k=typeof Element!=="undefined";var yk=typeof Map==="function";var bk=typeof Set==="function";var xk=typeof ArrayBuffer==="function"&&!!ArrayBuffer.isView;function Za(s,e){if(s===e)return true;if(s&&e&&typeof s=="object"&&typeof e=="object"){if(s.constructor!==e.constructor)return false;var t,i,r;if(Array.isArray(s)){t=s.length;if(t!=e.length)return false;for(i=t;i--!==0;)if(!Za(s[i],e[i]))return false;return true}var o;if(yk&&s instanceof Map&&e instanceof Map){if(s.size!==e.size)return false;o=s.entries();while(!(i=o.next()).done)if(!e.has(i.value[0]))return false;o=s.entries();while(!(i=o.next()).done)if(!Za(i.value[1],e.get(i.value[0])))return false;return true}if(bk&&s instanceof Set&&e instanceof Set){if(s.size!==e.size)return false;o=s.entries();while(!(i=o.next()).done)if(!e.has(i.value[0]))return false;return true}if(xk&&ArrayBuffer.isView(s)&&ArrayBuffer.isView(e)){t=s.length;if(t!=e.length)return false;for(i=t;i--!==0;)if(s[i]!==e[i])return false;return true}if(s.constructor===RegExp)return s.source===e.source&&s.flags===e.flags;if(s.valueOf!==Object.prototype.valueOf)return s.valueOf()===e.valueOf();if(s.toString!==Object.prototype.toString)return s.toString()===e.toString();r=Object.keys(s);t=r.length;if(t!==Object.keys(e).length)return false;for(i=t;i--!==0;)if(!Object.prototype.hasOwnProperty.call(e,r[i]))return false;if(_k&&s instanceof Element)return false;for(i=t;i--!==0;){if((r[i]==="_owner"||r[i]==="__v"||r[i]==="__o")&&s.$$typeof){continue}if(!Za(s[r[i]],e[r[i]]))return false}return true}return s!==s&&e!==e}Zf.exports=function s(e,t){try{return Za(e,t)}catch(i){if((i.message||"").match(/stack|recursion/i)){console.warn("react-fast-compare cannot handle circular refs");return false}throw i}}});var ag=we((YP,ng)=>{"use strict";ng.exports=(s,e=1,t)=>{t={indent:" ",includeEmptyLines:false,...t};if(typeof s!=="string"){throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof s}\``)}if(typeof e!=="number"){throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``)}if(typeof t.indent!=="string"){throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof t.indent}\``)}if(e===0){return s}const i=t.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return s.replace(i,t.indent.repeat(e))}});var lg=we(()=>{});var dg=we((ZP,mg)=>{"use strict";var ug=lg();var cg=/\s+at.*(?:\(|\s)(.*)\)?/;var Pk=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/;var Bk=typeof ug.homedir==="undefined"?"":ug.homedir();mg.exports=(s,e)=>{e=Object.assign({pretty:false},e);return s.replace(/\\/g,"/").split("\n").filter(t=>{const i=t.match(cg);if(i===null||!i[1]){return true}const r=i[1];if(r.includes(".app/Contents/Resources/electron.asar")||r.includes(".app/Contents/Resources/default_app.asar")){return false}return!Pk.test(r)}).filter(t=>t.trim()!=="").map(t=>{if(e.pretty){return t.replace(cg,(i,r)=>i.replace(r,r.replace(Bk,"~")))}return t}).join("\n")}});var fg=we((QP,hg)=>{"use strict";var Mk=ag();var Lk=dg();var zk=s=>s.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,"");var pg=class extends Error{constructor(e){if(!Array.isArray(e)){throw new TypeError(`Expected input to be an Array, got ${typeof e}`)}e=[...e].map(i=>{if(i instanceof Error){return i}if(i!==null&&typeof i==="object"){return Object.assign(new Error(i.message),i)}return new Error(i)});let t=e.map(i=>{return typeof i.stack==="string"?zk(Lk(i.stack)):String(i)}).join("\n");t="\n"+Mk(t,4);super(t);this.name="AggregateError";Object.defineProperty(this,"_errors",{value:e})}*[Symbol.iterator](){for(const e of this._errors){yield e}}};hg.exports=pg});var nl=we((eB,gg)=>{"use strict";var Uk=fg();gg.exports=async(s,e,{concurrency:t=Infinity,stopOnError:i=true}={})=>{return new Promise((r,o)=>{if(typeof e!=="function"){throw new TypeError("Mapper function is required")}if(!((Number.isSafeInteger(t)||t===Infinity)&&t>=1)){throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${t}\` (${typeof t})`)}const n=[];const a=[];const l=s[Symbol.iterator]();let u=false;let c=false;let h=0;let m=0;const d=()=>{if(u){return}const f=l.next();const b=m;m++;if(f.done){c=true;if(h===0){if(!i&&a.length!==0){o(new Uk(a))}else{r(n)}}return}h++;(async()=>{try{const y=await f.value;n[b]=await e(y,b);h--;d()}catch(y){if(i){u=true;o(y)}else{a.push(y);h--;d()}}})()};for(let f=0;f<t;f++){d();if(c){break}}})}});var bt={};Me(bt,{FragmentPrecision:()=>zt,ImageFormat:()=>Zr,OptionType:()=>p,RenderType:()=>St,RendererType:()=>H,UniformType:()=>O});var St,Zr,p,O,H,zt;var Ft=_(()=>{St={IMAGE:"image",DATAURL:"data-url",BUFFER:"buffer",BLOB:"blob",MSBLOB:"ms-blob"};Zr={PNG:"image/png",JPEG:"image/jpeg",RAW:"raw"};(function(d){d["NUMBER"]="number";d["VECTOR2"]="vector2";d["COLOR_MATRIX"]="color-matrix";d["COLOR"]="color";d["ARRAY"]="array";d["OBJECT"]="object";d["STRING"]="string";d["BOOLEAN"]="boolean";d["CONFIGURABLE"]="configurable";d["IMAGE"]="image";d["FUNCTION"]="function";d["TEXTURE"]="texture";d["ALL"]="*"})(p||(p={}));(function(b){b["SAMPLER2D"]="sampler2d";b["INT"]="i";b["INT1"]="1i";b["INT2"]="2i";b["INT3"]="3i";b["INT4"]="4i";b["FLOAT"]="f";b["FLOAT1"]="1f";b["FLOAT2"]="2f";b["FLOAT_VECTOR2"]="2fv";b["FLOAT3"]="3f";b["FLOAT4"]="4f";b["MAT3"]="mat3";b["MAT3FV"]="mat3fv";b["MAT4"]="mat4"})(O||(O={}));(function(t){t["WEBGL"]="webgl";t["CANVAS"]="canvas"})(H||(H={}));(function(i){i["High"]="highp";i["Medium"]="mediump";i["Low"]="lowp"})(zt||(zt={}))});var Bn,Sg;var Fg=_(()=>{Bn=()=>document.createElement("canvas");Sg=(s,e)=>{const t=e||Bn();t.width=s.width;t.height=s.height;const i=t.getContext("2d");if(!i){throw new Error("Cannot render context")}i.clearRect(0,0,t.width,t.height);i.drawImage(s,0,0,s.width,s.height);return t}});var _o;var wm=_(()=>{_o=class{constructor(e,t,i){this.width=e;this.height=t;this.data=i}}});var Og={};Me(Og,{glGet:()=>ml,webUtils:()=>tT});var ml,Zk,Qk,eT,tT;var Ag=_(()=>{Fg();ei();wm();ml=s=>{const e={preserveDrawingBuffer:true};return s.getContext("webgl",e)||s.getContext("experimental-webgl",e)};Zk=()=>{const s=Bn();const e=ml(s);const t=e.getParameter(e.MAX_TEXTURE_SIZE);const i=e.getExtension("WEBGL_lose_context");if(i){i.loseContext()}ke(s);return t};Qk=(s,e)=>{if(e instanceof _o){s.texImage2D(s.TEXTURE_2D,0,s.RGBA,e.width,e.height,0,s.RGBA,s.UNSIGNED_BYTE,e.data)}else{const t=Sg(e);s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,t);ke(t)}};eT=s=>Boolean(s.tagName&&s.tagName.toUpperCase()==="IMG");tT={isSupported:()=>Boolean(ml(Bn())),isCanvas:s=>s.constructor.name==="Canvas"||Boolean(s.tagName&&s.tagName.toUpperCase()==="CANVAS"),isImage:eT,Image:typeof window!=="undefined"?window.Image:void 0,glMaxTexture:Zk,glGet:ml,createCanvas:Bn,glResize(s,e){return s},glTexImage:Qk}});var Ig,Je,yo,Cm,Pg;var di=_(()=>{Ft();if(true){Ig=(Ag(),Og).webUtils}if(false){Ig=null.serverUtils}Je=Ig;yo=s=>s._type===H.WEBGL;Cm=s=>Boolean(s&&"tagName"in s&&s.tagName&&s.tagName.toUpperCase()==="CANVAS");Pg=s=>Boolean("tagName"in s&&s.tagName.toUpperCase()==="IMG")});var dl,Bg;var Mg=_(()=>{dl=class{static head(e){return e[0]}static tail(e){return e.slice(1)}static last(e){return e[e.length-1]}static init(e){return e.slice(0,e.length-1)}static remove(e,t){return e.filter((i,r,o)=>!t(i,r,o))}static findIndex(e,t){for(let i=0;i<e.length;i++){if(t(e[i])){return i}}return-1}static find(e,t){for(let i=0;i<e.length;i++){if(t(e[i])){return e[i]}}return void 0}static flatten(e){return e.reduce(function(t,i){return t.concat(Array.isArray(i)?dl.flatten(i):i)},[])}static range(e,t){const i=[];if(t>e){for(let r=e;r<t;r++){i.push(r)}}return i}static repeat(e,t){const i=[];for(let r=0;r<t;r++){i[r]=e}return i}static zip(e,t){const i=Math.min(e.length,t.length);const r=[];for(let o=0;o<i;o++){r[o]=[e[o],t[o]]}return r}};Bg=dl});var hr,iT,Ut;var bo=_(()=>{hr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";iT={encode(s){let e="";let t;let i;let r;let o;let n;let a;let l;let u=0;do{t=s[u++];i=s[u++];r=s[u++];o=t>>2;n=(t&3)<<4|i>>4;a=(i&15)<<2|r>>6;l=r&63;if(isNaN(i)){a=l=64}else if(isNaN(r)){l=64}e=e+hr.charAt(o)+hr.charAt(n)+hr.charAt(a)+hr.charAt(l);t=i=r="";o=n=a=l=""}while(u<s.length);return e},decode(s){let e;let t;let i;let r;let o;let n;let a;let l=0;const u=[];const c=/[^A-Za-z0-9+/=]/g;if(c.exec(s)){throw new Error("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\nExpect errors in decoding.")}s=s.replace(/[^A-Za-z0-9+/=]/g,"");do{r=hr.indexOf(s.charAt(l++));o=hr.indexOf(s.charAt(l++));n=hr.indexOf(s.charAt(l++));a=hr.indexOf(s.charAt(l++));e=r<<2|o>>4;t=(o&15)<<4|n>>2;i=(n&3)<<6|a;u.push(e);if(n!==64){u.push(t)}if(a!==64){u.push(i)}e=t=i="";r=o=n=a=""}while(l<s.length);return u}};Ut=iT});var Qr,Dm,R;var pi=_(()=>{di();Mg();bo();Qr=class{static mapRange(e,t,i){return(e-t.getMin())*i.getLength()/t.getLength()+i.getMin()}static isPlainObject(e){if(typeof e!=="object"||!e){return false}if(typeof Object.getPrototypeOf==="function"){const t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}return Object.prototype.toString.call(e)==="[object Object]"}static isMobile(){if(typeof navigator==="undefined")return false;const e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}static isBrowser(){return typeof window!=="undefined"}static values(e){const t=[];for(const i in e){t.push(e[i])}return t}static generateUUID(){let e=new Date().getTime();if(true){if(typeof window.performance!=="undefined"&&typeof window.performance.now==="function"){e+=window.performance.now()}}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const i=(e+Math.random()*16)%16|0;e=Math.floor(e/16);return(t==="x"?i:i&3|8).toString(16)})}static resizeVectorToFit(e,t){const i=Math.min(t.x/e.x,t.y/e.y);const r=e.clone().multiply(i);return r}static resizeVectorToFill(e,t){const i=e.x/e.y;const r=t.x/t.y;if(i>r){return t.clone().set(t.y*i,t.y)}return t.clone().set(t.x,t.x/i)}static isExtendable(e){return typeof e!=="undefined"&&e!==null&&(typeof e==="object"||typeof e==="function")}static defaults(e,...t){const i={};for(const r in e){i[r]=e[r]}for(let r=0;r<t.length;r++){const o=t[r];for(const n in o){if(typeof i[n]==="undefined"){i[n]=o[n]}}}return i}static deepMerge(e,...t){const i=(r,o)=>{if(o===void 0){return i(null,r)}if(Array.isArray(o)){return[...o]}if(!Qr.isPlainObject(o)){return o}if(!Qr.isPlainObject(r)){return{...o}}const n={...r};Object.keys(o).forEach(a=>{const l=o[a];if(l===void 0){return}n[a]=i(r[a],l)});return n};return t.reduce(i,e)}static deepDefaults(e,...t){const i=[...t].reverse();return Qr.deepMerge(...i,e)}static deepClone(e){const t={};for(const i in e){if(Qr.isExtendable(e[i])){t[i]=Qr.deepClone(e[i])}else{t[i]=e[i]}}return t}static extend(e,...t){const i={};for(const r in e){i[r]=e[r]}for(let r=0;r<t.length;r++){const o=t[r];for(const n in o){i[n]=o[n]}}return i}static clone(e){return this.extend({},e)}static getUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;const i=e==="x"?t:t&3|8;return i.toString(16)})}static createCanvas(){return Je.createCanvas()}static isPowerOfTwo(e){return(e.x&e.x-1)===0&&(e.y&e.y-1)===0}static nextLowestPOT(e){for(let t=1;t<32;t<<=1){e|=e>>t}return e-(e>>1)}static nextHighestPOT(e){e--;for(let t=1;t<32;t<<=1){e|=e>>t}return e+1}static moveArrayItem(e,t,i){if(i>=e.length){let r=i-e.length;while(r--+1){e.push(void 0)}}e.splice(i,0,e.splice(t,1)[0])}static ensureCanvasDimensions(e,t){if(e.width!==t.x||e.height!==t.y){e.width=t.x;e.height=t.y;return true}return false}static byteArrayToString(e){return e.map(t=>String.fromCharCode(t)).join("")}static clamp(e,t,i){return Math.max(t,Math.min(e,i))}static wildCardMatch(e,t){return new RegExp(`^${t.split("*").join(".*")}$`).test(e)}static flipObject(e){const t={};for(const i in e){t[e[i]]=i}return t}static ISODateString(e){function t(i){return i<10?`0${i}`:i}return`${e.getUTCFullYear()}-${t(e.getUTCMonth()+1)}-${t(e.getUTCDate())}T${t(e.getUTCHours())}:${t(e.getUTCMinutes())}:${t(e.getUTCSeconds())}Z`}static getCrossOriginValue(e){if(!e){return"anonymous"}if(e==="none"){return void 0}return e}static invariant(e,t){if(!e){const i=new Error(t);throw i}}static executePromises(e){const t=e.length;let i=0;const r=[];const o=[];return new Promise((n,a)=>{const l=()=>{i++;if(i>=t){if(o.length<=0){n(r)}else{a(o)}}};const u=h=>{r.push(h);l()};const c=h=>{o.push(h);l()};e.forEach(h=>{h.then(u).catch(c)})})}};Dm=Qr;I(Dm,"Array",Bg);R=Dm});var rT,Lg,sT,oT,zg,km,P;var ti=_(()=>{pi();rT=[{name:"trace",type:"trace",background:"#EEEEEE",color:"#AAAAAA"},{name:"info",type:"log",background:"#BDE5F8",color:"#00529B"},{name:"warn",type:"warn",background:"#FEEFB3",color:"#9F6000"},{name:"error",type:"error",background:"#FFBABA",color:"#D8000C"},{name:"log",type:"log",background:"#EEEEEE",color:"#1f4f6b"}];Lg=()=>console&&console.group&&console.groupCollapsed&&console.groupEnd;sT=()=>typeof navigator!=="undefined"&&navigator.userAgent.match(/Gecko|WebKit/i)&&!navigator.userAgent.match(/Trident/);oT=(s,e)=>{if(true){return["background: #2D7BFF; line-height: 20px; padding: 4px 0","background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0",`background: ${s}; color: ${e}; line-height: 20px; padding: 4px 0; font-weight: bold`,"background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0"]}if(false){const t=null;return[t.bgHex("#2D7BFF"),t.bgHex("#2B2B2B").white,t.bgHex("#2D7BFF"),t.bgHex(s).hex(e).bold,t.bgHex("#2B2B2B").white,t.bgHex("#2D7BFF")]}};zg=class{constructor(e="warn",t=rT){this._levels=[...t];this._maxLevel=this.getLevelIndexByName(e);this._consoleFuncs={trace:(...i)=>{if(Lg()){console.groupCollapsed(...i);console.trace();console.groupEnd()}else{console.trace(...i)}}};this._levels.forEach(({name:i})=>{this[i]=(r,...o)=>{this._log(i,r,...o)}})}getLevelIndexByName(e){return R.Array.findIndex(this._levels,t=>t.name===e)}getLevelObjectByName(e){return R.Array.find(this._levels,t=>t.name===e)}canLog(e){const t=this.getLevelIndexByName(e);if(t<0){return false}return t>=this._maxLevel}setLevel(e){const t=this.getLevelIndexByName(e);if(t<0){return}this._maxLevel=t}_log(e,t,...i){const r=this.getLevelObjectByName(e);if(!r||!this.canLog(e)){return}const{name:o,type:n,background:a,color:l}=r;const u=i.filter(d=>d!==void 0).map(d=>{if(d.toObject){return JSON.parse(JSON.stringify(d.toObject()))}return d});const c=this._consoleFuncs[n]||console[n]?(...d)=>console[n](...d):(...d)=>console.log(...d);const h=u.length;const m=oT(a,l);if(true){if(!sT()){const d=u.length;if(d<=0){c(`PhotoEditorSDK | ${t} `);return}if(d===1&&typeof u[0]==="string"){c(`PhotoEditorSDK | ${t} | ${u[0]}`);return}c(`PhotoEditorSDK | ${t} | `,...u);return}if(h<=0){c(`%c  %c PhotoEditorSDK %c  %c ${t} %c %c  `,...m);return}if(h===1&&typeof u[0]==="string"){c(`%c  %c PhotoEditorSDK %c  %c ${t} %c  ${u[0]}  %c  `,...m);return}if(Lg()){console.groupCollapsed(`%c  %c PhotoEditorSDK %c  %c ${t} %c`,...R.Array.init(m));c(...u);console.groupEnd()}else{c(`%c  %c PhotoEditorSDK %c  %c ${t} %c`,...R.Array.init(m),...u)}}if(false){const d=`${m[0](" ")} ${m[1]("PhotoEditorSDK")} ${m[2](" ")} ${m[3](t)}`;const f=`${m[5](" ")} `;if(h<=0){c(`${d} ${f}`);return}if(h===1&&typeof u[0]==="string"){c(`${d} ${m[4](u[0])} ${f}`);return}if(Lg()){console.groupCollapsed(`${d} ${f}`);c(...u);console.groupEnd()}else{c(`${d} ${f}`,...u)}}}image(e="",t){if(true){let i=new window.Image;const r=()=>{const{width:o}=i;const{height:n}=i;if(e){console.log(e)}console.log(`%c+`,`
        font-size: 1px;
        padding: 0px ${Math.floor(o/2)}px;
        line-height: ${n}px;
        background: url(${i.src});
        color: transparent;
        background-repeat: no-repeat;
        background-size: ${o}px ${n}px;`)};i.onload=r;if(t instanceof window.HTMLCanvasElement){i.src=t.toDataURL()}else if(t instanceof window.Image){i=t;r()}else if(typeof t==="string"){i.src=t}else{this.log(e,t)}return i}}texture(e="",t){if(true){if(!t){this.log(e,"texture: null or undefined");return}const i=t.getBaseTexture();const r=i.getRenderers();const o=R.Array.find(r,l=>l&&l.constructor.type==="webgl");const{width:n,height:a}=i.getFrame();if(o){const l=o.getContext();const u=i.getGLTextureForRenderer(o);this.logGlTexture(l,u,n,a,e)}else{km.image(e,i.getSource())}}}logGlTexture(e,t,i=150,r=150,o){if(true){e.bindTexture(e.TEXTURE_2D,t);const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0);const a=new Uint8Array(i*r*4);e.readPixels(0,0,i,r,e.RGBA,e.UNSIGNED_BYTE,a);e.deleteFramebuffer(n);const l=document.createElement("canvas");l.width=i;l.height=r;const u=l.getContext("2d");const c=u.createImageData(i,r);c.data.set(a);u.putImageData(c,0,0);return km.image(o,l)}}};km=new zg("warn");P=km});var ut;var xo=_(()=>{ut={load(s,e={cors:true,value:"anonymous"}){const t=()=>{if(true){return Promise.resolve([s,s])}if(false){if(s.substr(0,5)==="data:"){return Promise.resolve([s,s])}if(!s.match(/^(https?|ftp|file):\/\//)){return readFileAsync(s)}return loadRemoteFile(s)}};return t().then(([i,r])=>{return this._createAndLoadImage(i,r,e)})},loadImage(s,e={cors:true,value:"anonymous"}){if(true){return this._loadWithoutExif(s,e)}return this.load(s,e)},_loadWithoutExif(s,e={cors:true,value:"anonymous"}){return new Promise((t,i)=>{const r=new window.Image;r.addEventListener("load",()=>{t(r)});r.addEventListener("error",()=>{i(new Error(`Failed to load image at ${s}`))});if(e.cors){r.crossOrigin=e.value}r.src=s})},_createAndLoadImage(s,e,t={cors:true,value:"anonymous"}){return new Promise((i,r)=>{if(true){const o=this._loadWithoutExif(e,t).then(a=>i(a));const n=new Promise((a,l)=>{this._loadAsDataURL(e,t).then(u=>{const c=new window.Image;c.addEventListener("load",()=>{a(c)});c.src=u;c.rawSource=u}).catch(u=>{o.then(c=>a(c))})});if(this._stringEndsWith(e,".svg")){return o.then(a=>i(a))}return n.then(a=>i(a))}if(false){const o=null;const n=new o.Image;n.src=e;n.rawSource=e;n.filePath=s;i(n)}})},_stringEndsWith(s,e,t=s.length){if(t===void 0||t>s.length){t=s.length}return s.substring(t-e.length,t)===e},_loadAsDataURL(s,e={cors:true,value:"anonymous"}){if(true){return new Promise((t,i)=>{const r=new XMLHttpRequest;r.onload=function(){const o=new FileReader;o.onloadend=function(){if(o.error){i(o.error)}t(o.result)};o.readAsDataURL(r.response)};r.open("GET",s);r.responseType="blob";r.withCredentials=e.cors&&e.value==="use-credentials";r.send()})}return Promise.reject(new Error(`Loading images as data urls is only supported in browser environments.`))},loadXHR(s,e){return new Promise((t,i)=>{let r;if(window.XDomainRequest){r=new window.XDomainRequest;if(e)r.overrideMimeType(e);r.onload=function(){t(r)};r.onerror=function(o){i(o)}}else if(window.XMLHttpRequest){r=new window.XMLHttpRequest;if(e)r.overrideMimeType(e);r.onreadystatechange=function(o){if(r.readyState===4){if(r.status===200){t(r)}else{i(new Error(`HTTP Status ${r.status}`))}}}}r.open("GET",s,true);r.send()})}}});var Ng=we((nL,Ug)=>{"use strict";function nT(s,e){return Object.prototype.hasOwnProperty.call(s,e)}Ug.exports=function(s,e,t,i){e=e||"&";t=t||"=";var r={};if(typeof s!=="string"||s.length===0){return r}var o=/\+/g;s=s.split(e);var n=1e3;if(i&&typeof i.maxKeys==="number"){n=i.maxKeys}var a=s.length;if(n>0&&a>n){a=n}for(var l=0;l<a;++l){var u=s[l].replace(o,"%20"),c=u.indexOf(t),h,m,d,f;if(c>=0){h=u.substr(0,c);m=u.substr(c+1)}else{h=u;m=""}d=decodeURIComponent(h);f=decodeURIComponent(m);if(!nT(r,d)){r[d]=f}else if(Array.isArray(r[d])){r[d].push(f)}else{r[d]=[r[d],f]}}return r}});var Wg=we((aL,Gg)=>{"use strict";var Mn=function(s){switch(typeof s){case"string":return s;case"boolean":return s?"true":"false";case"number":return isFinite(s)?s:"";default:return""}};Gg.exports=function(s,e,t,i){e=e||"&";t=t||"=";if(s===null){s=void 0}if(typeof s==="object"){return Object.keys(s).map(function(r){var o=encodeURIComponent(Mn(r))+t;if(Array.isArray(s[r])){return s[r].map(function(n){return o+encodeURIComponent(Mn(n))}).join(e)}else{return o+encodeURIComponent(Mn(s[r]))}}).join(e)}if(!i)return"";return encodeURIComponent(Mn(i))+t+encodeURIComponent(Mn(s))}});var Vg=we(Ln=>{"use strict";Ln.decode=Ln.parse=Ng();Ln.encode=Ln.stringify=Wg()});function zn(s){typeof s=="string"&&(s=wo(s));var e=function(t,i,r){var o=t.auth,n=t.hostname,a=t.protocol||"",l=t.pathname||"",u=t.hash||"",c=t.query||"",h=false;o=o?encodeURIComponent(o).replace(/%3A/i,":")+"@":"",t.host?h=o+t.host:n&&(h=o+(~n.indexOf(":")?"["+n+"]":n),t.port&&(h+=":"+t.port)),c&&typeof c=="object"&&(c=i.encode(c));var m=t.search||c&&"?"+c||"";return a&&a.substr(-1)!==":"&&(a+=":"),t.slashes||(!a||r.test(a))&&h!==false?(h="//"+(h||""),l&&l[0]!=="/"&&(l="/"+l)):h||(h=""),u&&u[0]!=="#"&&(u="#"+u),m&&m[0]!=="?"&&(m="?"+m),{protocol:a,host:h,pathname:l=l.replace(/[?#]/g,encodeURIComponent),search:m=m.replace("#","%23"),hash:u}}(s,Tm.default,aT);return""+e.protocol+e.host+e.pathname+e.search+e.hash}function jg(s,e){var t=typeof s=="string"?wo(s):s;s=typeof s=="object"?zn(s):s;var i=wo(e),r="";t.protocol&&!t.slashes&&(r=t.protocol,s=s.replace(t.protocol,""),r+=e[0]==="/"||s[0]==="/"?"/":""),r&&i.protocol&&(r="",i.slashes||(r=i.protocol,e=e.replace(i.protocol,"")));var o=s.match(lT);o&&!i.protocol&&(s=s.substr((r=o[1]+(o[2]||"")).length),/^\/\/[^/]/.test(e)&&(r=r.slice(0,-1)));var n=new URL(s,Sm+"/"),a=new URL(e,n).toString().replace(Sm,""),l=i.protocol||t.protocol;return l+=t.slashes||i.slashes?"//":"",!r&&l?a=a.replace(Rm,l):r&&(a=a.replace(Rm,"")),uT.test(a)||~e.indexOf(".")||s.slice(-1)==="/"||e.slice(-1)==="/"||a.slice(-1)!=="/"||(a=a.slice(0,-1)),r&&(a=r+(a[0]==="/"?a.substr(1):a)),a}function vo(){}function wo(s,e,t){if(e===void 0&&(e=false),t===void 0&&(t=false),s&&typeof s=="object"&&s instanceof vo)return s;var i=(s=s.trim()).match(cT);s=i?i[1].replace(/\\/g,"/")+i[2]:s.replace(/\\/g,"/"),pT.test(s)&&s.slice(-1)!=="/"&&(s+="/");var r=!/(^javascript)/.test(s)&&s.match(mT),o=dT.test(s),n="";r&&(Fm.test(r[1])||(n=r[1].toLowerCase(),s=""+r[2]+r[3]),r[2]||(o=false,Fm.test(r[1])?(n=r[1],s=""+r[3]):s="//"+r[3]),r[2].length!==3&&r[2].length!==1||(n=r[1],s="/"+r[3]));var a,l=(i?i[1]:s).match(/^https?:\/\/[^/]+(:[0-9]+)(?=\/|$)/),u=l&&l[1],c=new vo,h="",m="";try{a=new URL(s)}catch(b){h=b,n||t||!/^\/\//.test(s)||/^\/\/.+[@.]/.test(s)||(m="/",s=s.substr(1));try{a=new URL(s,Sm)}catch(y){return c.protocol=n,c.href=n,c}}c.slashes=o&&!m,c.host=a.host===Em?"":a.host,c.hostname=a.hostname===Em?"":a.hostname.replace(/(\[|\])/g,""),c.protocol=h?n||null:a.protocol,c.search=a.search.replace(/\\/g,"%5C"),c.hash=a.hash.replace(/\\/g,"%5C");var d=s.split("#");!c.search&&~d[0].indexOf("?")&&(c.search="?"),c.hash||d[1]!==""||(c.hash="#"),c.query=e?Tm.default.decode(a.search.substr(1)):c.search.substr(1),c.pathname=m+(r?function(b){return b.replace(/['^|`]/g,function(y){return"%"+y.charCodeAt().toString(16).toUpperCase()}).replace(/((?:%[0-9A-F]{2})+)/g,function(y,g){try{return decodeURIComponent(g).split("").map(function(C){var v=C.charCodeAt();return v>256||/^[a-z0-9]$/i.test(C)?C:"%"+v.toString(16).toUpperCase()}).join("")}catch(C){return g}})}(a.pathname):a.pathname),c.protocol==="about:"&&c.pathname==="blank"&&(c.protocol="",c.pathname=""),h&&s[0]!=="/"&&(c.pathname=c.pathname.substr(1)),n&&!Fm.test(n)&&s.slice(-1)!=="/"&&c.pathname==="/"&&(c.pathname=""),c.path=c.pathname+c.search,c.auth=[a.username,a.password].map(decodeURIComponent).filter(Boolean).join(":"),c.port=a.port,u&&!c.host.endsWith(u)&&(c.host+=u,c.port=u.slice(1)),c.href=m?""+c.pathname+c.search+c.hash:zn(c);var f=/^(file)/.test(c.href)?["host","hostname"]:[];return Object.keys(c).forEach(function(b){~f.indexOf(b)||(c[b]=c[b]||null)}),c}var Tm,aT,Rm,Em,Sm,lT,uT,Fm,cT,mT,dT,pT;var Hg=_(()=>{Tm=Ur(Vg());aT=/https?|ftp|gopher|file/;Rm="http://";Em="w.w";Sm=Rm+Em;lT=/^([a-z0-9.+-]*:\/\/\/)([a-z0-9.+-]:\/*)?/i;uT=/https?|ftp|gopher|file/;vo.prototype.parse=wo,vo.prototype.format=zn,vo.prototype.resolve=jg,vo.prototype.resolveObject=jg;Fm=/^https?|ftp|gopher|file/;cT=/^(.*?)([#?].*)/;mT=/^([a-z0-9.+-]*:)(\/{0,3})(.*)/i;dT=/^([a-z0-9.+-]*:)?\/\/\/*/i;pT=/^([a-z0-9.+-]*:)(\/{0,2})\[(.*)\]$/i});var hT,Un,Nt;var Co=_(()=>{Hg();hT=5e3;Un=typeof window!=="undefined"?window:global;Nt=class{constructor(e){this._url=e;this._parsedUrl=wo(this._url,true)}_isJSONPRequest(){const{query:e}=this._parsedUrl;for(const t in e){const i=e[t];if(i==="?"){return true}}return false}load(){if(this._isJSONPRequest()){return this._loadJSONP()}return this._loadJSON()}_loadJSON(){return new Promise((e,t)=>{let i;if(Un.XDomainRequest){i=new Un.XDomainRequest;i.onload=function(){const r=JSON.parse(i.responseText);e(r)};i.onerror=function(r){t(r)};i.open("GET",this._url,true);i.send()}else if(Un.XMLHttpRequest){i=new XMLHttpRequest;i.onreadystatechange=function(r){if(i.readyState===4){if(i.status===200){const o=JSON.parse(i.responseText);e(o)}else{t(new Error(`HTTP Status ${i.status}`))}}};i.open("GET",this._url,true);i.send()}})}_loadJSONP(){let e=false;let t=false;const i=`pesdk${Math.round(Math.random()*99999999999999)}`;return new Promise((r,o)=>{const n=this._createJSONPNode(i);Un[i]=a=>{this._removeJSONPNode(n);if(!e){t=true;r(a)}};Un.setTimeout(()=>{if(!t){this._removeJSONPNode(n);e=true;o(new Error("Timeout of 5 seconds exceeded."))}},hT)})}_createJSONPNode(e){const t=this._buildJSONPUrl(e);const i=document.querySelector("head");const r=document.createElement("script");r.src=t;i.appendChild(r);return r}_removeJSONPNode(e){e.parentNode.removeChild(e)}_buildJSONPUrl(e){const{query:t}=this._parsedUrl;let i=null;for(const r in t){if(t[r]==="?"){i=r;break}}delete this._parsedUrl.search;t[i]=e;return zn(this._parsedUrl)}}});var Om={};Me(Om,{ImageLoader:()=>ut,JSONLoader:()=>Nt});var qg=_(()=>{xo();Co()});var ct,E;var es=_(()=>{ct=class{constructor(e,t,i,r=1){this.r=e;this.g=t;this.b=i;this.a=r}toRGBA(){const e=[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255),this.a.toFixed(2)];return`rgba(${e.join(",")})`}set(e,t,i,r=this.a){this.r=e;this.g=t;this.b=i;this.a=r;return this}toRGB(){return[Math.round(this.r*255),Math.round(this.g*255),Math.round(this.b*255)]}toHex(){const e=[this._componentToHex(Math.round(this.r*255)),this._componentToHex(Math.round(this.g*255)),this._componentToHex(Math.round(this.b*255))];return`#${e.join("")}`}toGLColor(){return[this.r,this.g,this.b,this.a]}toArray(){return this.toGLColor()}toRGBGLColor(){return[this.r,this.g,this.b]}toHSV(){const e=Math.max(this.r,this.g,this.b);const t=Math.min(this.r,this.g,this.b);let i;let r;const o=e;const n=e-t;r=e===0?0:n/e;if(e===t){i=0}else{switch(e){case this.r:i=(this.g-this.b)/n;if(this.g<this.b){i+=6}break;case this.g:i=(this.b-this.r)/n+2;break;case this.b:i=(this.r-this.g)/n+4;break}i/=6}return[i,r,o]}fromHSV(e,t,i){this.copy(ct.fromHSV(e,t,i));return this}static fromHSV(e,t,i,r=1){let[o,n,a]=[];const l=Math.floor(e*6);const u=e*6-l;const c=i*(1-t);const h=i*(1-u*t);const m=i*(1-(1-u)*t);switch(l%6){case 0:o=i;n=m;a=c;break;case 1:o=h;n=i;a=c;break;case 2:o=c;n=i;a=m;break;case 3:o=c;n=h;a=i;break;case 4:o=m;n=c;a=i;break;case 5:o=i;n=c;a=h;break}return new ct(o,n,a,r)}static fromArray(e){return new ct(e[0],e[1],e[2],e[3])}static fromHex(e){const[t,i,r]=e.match(/[0-9A-fa-f]{1,2}/g);return new ct(parseInt(t,16)/255,parseInt(i,16)/255,parseInt(r,16)/255,1)}clone(){return new ct(this.r,this.g,this.b,this.a)}cloneRGB(){return new ct(this.r,this.g,this.b,1)}add(e){this.r+=e.r;this.g+=e.g;this.b+=e.b;this.a+=e.a;return this}minus(e){this.r-=e.r;this.g-=e.g;this.b-=e.b;this.a-=e.a;return this}multiplyScalar(e){this.r*=e;this.g*=e;this.b*=e;this.a*=e;return this}divideScalar(e){this.r/=e;this.g/=e;this.b/=e;this.a/=e;return this}clamp(e,t){this.r=Math.min(Math.max(this.r,e),t);this.g=Math.min(Math.max(this.g,e),t);this.b=Math.min(Math.max(this.b,e),t);this.a=Math.min(Math.max(this.a,e),t);return this}mix(e,t){this.r=(1-t)*this.r+t*e.r;this.g=(1-t)*this.g+t*e.g;this.b=(1-t)*this.b+t*e.b;this.a=(1-t)*this.a+t*e.a;return this}copy(e){this.r=e.r;this.g=e.g;this.b=e.b;this.a=e.a;return this}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}_componentToHex(e){const t=e.toString(16);return t.length===1?`0${t}`:t}toString(){return`Color(${this.r}, ${this.g}, ${this.b}, ${this.a})`}static get TRANSPARENT(){return new ct(0,0,0,0)}static get WHITE(){return new ct(1,1,1,1)}static get BLACK(){return new ct(0,0,0,1)}static get RED(){return new ct(1,0,0,1)}static get BLUE(){return new ct(0,0,1,1)}static get GREEN(){return new ct(0,1,0,1)}};E=ct});var fT,Kg,mt;var Do=_(()=>{ti();fT=12;Kg=class{constructor(){this._maxListeners=fT;this._events={};this._pipeDestinations=[]}pipeEvents(e){this._pipeDestinations.push(e)}unpipeEvents(e){const t=this._pipeDestinations.indexOf(e);if(t===-1){return}this._pipeDestinations.splice(t,1)}on(e,t){if(typeof e==="undefined"){throw new Error(`Invalid event type: \`${e}\``)}if(typeof t!=="function"){throw new TypeError}const i=this._events[e]||(this._events[e]=[]);if(i.indexOf(t)!==-1){return this}i.push(t);if(this._maxListeners&&i.length>this._maxListeners){P.warn("EventEmitter",`Possible memory leak detected, added ${i.length} \`${e}\` listeners (current limit is ${this._maxListeners})`);if(typeof console!=="undefined"){console.trace()}}return this}once(e,t){if(typeof e==="undefined"){throw new Error(`Invalid event type: \`${e}\``)}const i=this;function r(){i.off(e,r);t.apply(null,arguments)}return this.on(e,r)}off(e,...t){if(typeof e==="undefined"){throw new Error(`Invalid event type: \`${e}\``)}if(t.length===0){this._events[e]=null;return this}const i=t[0];if(typeof i!=="function"){throw new TypeError}const r=this._events[e];if(!r||!r.length){return this}const o=r.indexOf(i);if(o===-1){return this}r.splice(o,1);return this}emit(e,...t){if(typeof e==="undefined"){throw new Error(`Invalid event type: \`${e}\``)}this._pipeDestinations.forEach(r=>{r.emit(e,...t)});const i=this._events[e];if(!i||!i.length){return false}i.slice(0).forEach(r=>r.apply(null,t));return true}setMaxListeners(e){if(parseInt(e,10)!==e){throw new TypeError}this._maxListeners=e}};mt=Kg});var ts;var Am=_(()=>{ti();ei();ts={checkFramebufferStatus(s,e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);const i={[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT]:"Incomplete attachment",[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT]:"Missing attachment",[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS]:"Incomplete dimensions",[e.FRAMEBUFFER_UNSUPPORTED]:"Framebuffer unsupported"};if(t!==e.FRAMEBUFFER_COMPLETE){P.warn(s,`Framebuffer incomplete: ${i[t]}`)}},determineGPUName(s){let e=null;let t=null;if(!s){t=document.createElement("canvas");s=t.getContext("experimental-webgl")||t.getContext("webgl")}const i=s&&s.getExtension("WEBGL_debug_renderer_info");if(i){e=s.getParameter(i.UNMASKED_RENDERER_WEBGL);t&&t.remove()}ke(t);return e},isGPUBlacklisted(s,e=null){return false}}});var pl;var Xg=_(()=>{pl=s=>typeof s==="number"});var gT,is,hl,L;var zi=_(()=>{Xg();gT=s=>s instanceof L;is=(s,e)=>{if(gT(s)){return{x:s.x,y:s.y}}return{x:s,y:pl(e)?e:s}};hl=(s,e)=>(t,i)=>{const{x:r,y:o}=is(t,i);s.x=e(s.x,r);s.y=e(s.y,o);return s};L=class{constructor(e=0,t=0){this.add=hl(this,(e,t)=>e+t);this.subtract=hl(this,(e,t)=>e-t);this.divide=hl(this,(e,t)=>e/t);this.multiply=hl(this,(e,t)=>e*t);this.x=e;this.y=t}set(e,t){const{x:i,y:r}=is(e,t);this.x=i;this.y=r;return this}clone(){return new L(this.x,this.y)}copy(e){this.x=e.x;this.y=e.y;return this}clamp(e,t){if(pl(e)){e=new L(e,e)}if(pl(t)){t=new L(t,t)}if(e){this.x=Math.max(e.x,this.x);this.y=Math.max(e.y,this.y)}if(t){this.x=Math.min(t.x,this.x);this.y=Math.min(t.y,this.y)}return this}dot(e,t){const{x:i,y:r}=is(e,t);return this.x*i+this.y*r}equals(e,t){const{x:i,y:r}=is(e,t);return i===this.x&&r===this.y}flip(){const e=this.x;this.x=this.y;this.y=e;return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this}floor(){this.x|=0;this.y|=0;return this}abs(){this.x=Math.abs(this.x);this.y=Math.abs(this.y);return this}len(){return Math.sqrt(this.x*this.x+this.y*this.y)}min(){return Math.min(this.x,this.y)}max(){return Math.max(this.x,this.y)}toObject(){return{x:this.x,y:this.y}}toString(){return`Vector2({ x: ${this.x}, y: ${this.y} })`}roundDecimal(e){this.x=parseFloat(this.x.toFixed(e));this.y=parseFloat(this.y.toFixed(e));return this}asArray(e=false){if(e){return[this.y,this.x]}return[this.x,this.y]}static fromObject(e){return new L(e.x,e.y)}static get NULL(){return new L(0,0)}}});var xt;var Im=_(()=>{zi();xt=class{constructor(){this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0;this.reset()}multiply(e){let t;let i;let r;let o;let n;let a;t=this.a*e.a+this.b*e.c;i=this.a*e.b+this.b*e.d;r=this.c*e.a+this.d*e.c;o=this.c*e.b+this.d*e.d;n=this.tx*e.a+this.ty*e.c+e.tx;a=this.tx*e.b+this.ty*e.d+e.ty;this.a=t;this.b=i;this.c=r;this.d=o;this.tx=n;this.ty=a;return this}applyToVector(e){const{x:t,y:i}=e;e=e.clone();e.x=this.a*t+this.c*i+this.tx;e.y=this.b*t+this.d*i+this.tx;return e}applyInverseToVector(e){const t=1/(this.a*this.d+this.c*-this.b);const{x:i,y:r}=e;e=e.clone();e.x=this.d*t*i+-this.c*t*r+(this.ty*this.c-this.tx*this.d)*t;e.y=this.a*t*r+-this.b*t*i+(-this.ty*this.a+this.tx*this.b)*t;return e}rectangleToCoordinates(e,t=new L(0,0)){const i=e.width*(1-t.x);const r=e.width*-t.x;const o=e.height*(1-t.y);const n=e.height*-t.y;const a=[];a.push(new L(this.a*r+this.c*n+this.tx,this.d*n+this.b*r+this.ty));a.push(new L(this.a*i+this.c*n+this.tx,this.d*n+this.b*i+this.ty));a.push(new L(this.a*i+this.c*o+this.tx,this.d*o+this.b*i+this.ty));a.push(new L(this.a*r+this.c*o+this.tx,this.d*o+this.b*r+this.ty));return a}reset(){this.a=1;this.b=0;this.c=0;this.d=1;this.tx=0;this.ty=0}toArray(){const e=[this.a,this.b,0,this.c,this.d,0,this.tx,this.ty,1];if(typeof Float32Array==="undefined"){return e}return new Float32Array(e)}toString(){return`Matrix({ a: ${this.a}, b: ${this.b}, c: ${this.c}, d: ${this.d}, tx: ${this.tx}, ty: ${this.ty} })`}static get IDENTITY(){return new xt}}});var be;var Pm=_(()=>{zi();be=class{constructor(e=0,t=0,i=0,r=0){this.x=0;this.y=0;this.width=0;this.height=0;this.x=e;this.y=t;this.width=i;this.height=r}set(e,t,i,r){this.x=e;this.y=t;this.width=i;this.height=r;return this}clone(){return new be(this.x,this.y,this.width,this.height)}copy(e){this.x=e.x;this.y=e.y;this.width=e.width;this.height=e.height;return this}equals(e,t,i,r){if(e instanceof be){return e.x===this.x&&e.y===this.y&&e.width===this.width&&e.height===this.height}return e===this.x&&t===this.y&&i===this.width&&r===this.height}translate(e,t){const{x:i,y:r}=is(e,t);this.x+=i;this.y+=r;return this}scale(e,t){const{x:i,y:r}=is(e,t);this.width*=i;this.height*=r;return this}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.width=Math.round(this.width);this.height=Math.round(this.height);return this}getPosition(){return new L(this.x,this.y)}getSize(){return new L(this.width,this.height)}insetBy(e,t){this.x+=e;this.y+=t;this.width-=2*e;this.height-=2*t;return this}intersects(e){const t=new L(this.x,this.y);const i=new L(this.x+this.width,this.y+this.height);const r=new L(e.x,e.y);const o=new L(e.x+e.width,e.y+e.height);if(r.x>i.x||t.x>o.x||o.y<t.y||i.y<r.y){return false}return true}toString(){return`Rectangle({ x: ${this.x}, y: ${this.y}, width: ${this.width}, height: ${this.height} })`}static FromDiagonalPoints(e,t){let i=false;if(t.x-e.x<0){i=true}const r=i?t:e;const o=i?e:t;const n=o.x-r.x;const a=o.y-r.y;return new be(r.x,r.y,n,a)}}});var ko,_T,fr;var Ue=_(()=>{ti();Ft();es();Do();Am();Im();Pm();zi();pi();ko=2e3;_T=5;fr=_T*4});var rs;var fl=_(()=>{Ue();rs=class{constructor(){this._position=new L(0,0);this._scale=new L(1,1);this._pivot=new L(0,0);this._rotation=0;this._lastRotation=null;this._alpha=1;this._visible=true;this._worldTransform=new xt;this._parent=null;this._shaders=[];this._boundsNeedUpdate=true;this._bounds=new be(0,0,1,1);this._localBoundsNeedUpdate=true;this._localBounds=new be(0,0,1,1);this._filterRectangle=new be(0,0,0,0)}renderWebGL(e){P.warn(this.constructor.name,"`renderWebGL` is abstract and not implemented in inherited class")}renderCanvas(e){P.warn(this.constructor.name,"`renderCanvas` is abstract and not implemented in inherited class")}updateTransform(){const e=this._parent?this._parent.getWorldTransform():xt.IDENTITY;const t=this._worldTransform;const i=Math.sin(this._rotation);const r=Math.cos(this._rotation);t.a=r*this._scale.x;t.b=i*this._scale.x;t.c=-i*this._scale.y;t.d=r*this._scale.y;t.tx=this._position.x;t.ty=this._position.y;if(this._pivot.x||this._pivot.y){t.tx-=this._pivot.x*t.a+this._pivot.y*t.c;t.ty-=this._pivot.x*t.b+this._pivot.y*t.d}t.multiply(e);this._boundsNeedUpdate=true;this._localBoundsNeedUpdate=true}addShader(e){this._shaders.push(e)}removeShader(e){const t=this._shaders.indexOf(e);if(t!==-1){this._shaders.splice(t,1);return true}return false}removeShaderAt(e){if(!this._shaders[e]){return false}this._shaders.splice(e,1);return true}getBounds(){return this._bounds.clone()}getPosition(){return this._position}setPosition(e,t){this._position.set(e,t);this._boundsNeedUpdate=true;this._localBoundsNeedUpdate=true}getScale(){return this._scale}setScale(e,t){this._scale.set(e,t);this._boundsNeedUpdate=true;this._localBoundsNeedUpdate=true}getPivot(){return this._pivot}setPivot(e,t){this._pivot.set(e,t);this._boundsNeedUpdate=true;this._localBoundsNeedUpdate=true}getRotation(){return this._rotation}setRotation(e){this._rotation=e;this._boundsNeedUpdate=true;this._localBoundsNeedUpdate=true}getAlpha(){return this._alpha}setAlpha(e){this._alpha=e}getWorldAlpha(){if(this._parent){return this._parent.getAlpha()*this._alpha}return this._alpha}getWorldTransform(){return this._worldTransform}getParent(){return this._parent}setParent(e){this._parent=e}getFilterRectangle(){return this._filterRectangle}setFilterRectangle(e){this._filterRectangle.copy(e)}isVisible(){return this._visible}setVisible(e){this._visible=e}}});var hi;var gl=_(()=>{Ue();fl();hi=class extends rs{constructor(){super();this._children=[];this._filters=[]}addFilter(e){this._filters.push(e)}removeFilter(e){const t=this._filters.indexOf(e);if(t!==-1){this._filters.splice(t,1);return true}return false}setFilters(e){this._filters=e}addChild(e){const t=e.getParent();if(t instanceof hi){t.removeChild(e)}e.setParent(this);this._children.push(e)}prependChild(e){const t=e.getParent();if(t instanceof hi){t.removeChild(e)}e.setParent(this);this._children.unshift(e)}hasChild(e){const t=this._children.indexOf(e);return t!==-1}removeChild(e){const t=this._children.indexOf(e);if(t!==-1){this._children.splice(t,1);e.setParent(null)}else{P.info(this.constructor.name,"Tried to remove a child that does not exist")}}clearChildren(){this._children=[]}renderWebGL(e){if(!this._visible){return}const t=e.getFilterManager();if(this._filters&&this._filters.length){t.pushFilters(this,this._filters)}e.getCurrentObjectRenderer().start();this._renderWebGL(e);this._children.forEach(i=>{i.renderWebGL(e)});e.getCurrentObjectRenderer().flush();if(this._filters&&this._filters.length){t.popFilters()}e.getCurrentObjectRenderer().start()}_renderWebGL(e){}renderCanvas(e){if(!this._visible){return}const t=e.getFilterManager();if(this._filters&&this._filters.length){t.pushFilters(this,this._filters)}this._renderCanvas(e);this._children.forEach(i=>{i.renderCanvas(e)});if(this._filters&&this._filters.length){t.popFilters()}}_renderCanvas(e){}updateTransform(){super.updateTransform();this._children.forEach(e=>{e.updateTransform()})}getLocalBounds(){if(this._localBoundsNeedUpdate){this._localBoundsNeedUpdate=false}return this._localBounds.clone()}getBounds(){if(this._boundsNeedUpdate){this._boundsNeedUpdate=false}return this._bounds.clone()}getChildren(){return this._children}getFilters(){return this._filters}dispose(){}}});function Yg(s,e,t,i,r,o){if(isNaN(o)||o<1){return}o|=0;var n=s.data;var a,l,u,c,h,m,d,f,b,y,g,C,v,x,B,w,D,j,W,J,te,Q,K,ye;var lt=o+o+1;var Ze=i-1;var ni=r-1;var ie=o+1;var Be=ie*(ie+1)/2;var Ce=new Jg;var ve;var ae=Ce;for(u=1;u<lt;u++){ae=ae.next=new Jg;if(u==ie)ve=ae}ae.next=Ce;var Oe=null;var rt=null;d=m=0;var tr=yT[o];var ir=bT[o];for(l=0;l<r;l++){w=D=j=W=f=b=y=g=0;C=ie*(J=n[m]);v=ie*(te=n[m+1]);x=ie*(Q=n[m+2]);B=ie*(K=n[m+3]);f+=Be*J;b+=Be*te;y+=Be*Q;g+=Be*K;ae=Ce;for(u=0;u<ie;u++){ae.r=J;ae.g=te;ae.b=Q;ae.a=K;ae=ae.next}for(u=1;u<ie;u++){c=m+((Ze<u?Ze:u)<<2);f+=(ae.r=J=n[c])*(ye=ie-u);b+=(ae.g=te=n[c+1])*ye;y+=(ae.b=Q=n[c+2])*ye;g+=(ae.a=K=n[c+3])*ye;w+=J;D+=te;j+=Q;W+=K;ae=ae.next}Oe=Ce;rt=ve;for(a=0;a<i;a++){n[m+3]=K=g*tr>>ir;if(K!==0){K=255/K;n[m]=(f*tr>>ir)*K;n[m+1]=(b*tr>>ir)*K;n[m+2]=(y*tr>>ir)*K}else{n[m]=n[m+1]=n[m+2]=0}f-=C;b-=v;y-=x;g-=B;C-=Oe.r;v-=Oe.g;x-=Oe.b;B-=Oe.a;c=d+((c=a+o+1)<Ze?c:Ze)<<2;w+=Oe.r=n[c];D+=Oe.g=n[c+1];j+=Oe.b=n[c+2];W+=Oe.a=n[c+3];f+=w;b+=D;y+=j;g+=W;Oe=Oe.next;C+=J=rt.r;v+=te=rt.g;x+=Q=rt.b;B+=K=rt.a;w-=J;D-=te;j-=Q;W-=K;rt=rt.next;m+=4}d+=i}for(a=0;a<i;a++){D=j=W=w=b=y=g=f=0;m=a<<2;C=ie*(J=n[m]);v=ie*(te=n[m+1]);x=ie*(Q=n[m+2]);B=ie*(K=n[m+3]);f+=Be*J;b+=Be*te;y+=Be*Q;g+=Be*K;ae=Ce;for(u=0;u<ie;u++){ae.r=J;ae.g=te;ae.b=Q;ae.a=K;ae=ae.next}h=i;for(u=1;u<=o;u++){m=h+a<<2;f+=(ae.r=J=n[m])*(ye=ie-u);b+=(ae.g=te=n[m+1])*ye;y+=(ae.b=Q=n[m+2])*ye;g+=(ae.a=K=n[m+3])*ye;w+=J;D+=te;j+=Q;W+=K;ae=ae.next;if(u<ni){h+=i}}m=a;Oe=Ce;rt=ve;for(l=0;l<r;l++){c=m<<2;n[c+3]=K=g*tr>>ir;if(K>0){K=255/K;n[c]=f*tr>>ir;n[c+1]=b*tr>>ir;n[c+2]=y*tr>>ir}else{n[c]=n[c+1]=n[c+2]=0}f-=C;b-=v;y-=x;g-=B;C-=Oe.r;v-=Oe.g;x-=Oe.b;B-=Oe.a;c=a+((c=l+ie)<ni?c:ni)*i<<2;f+=w+=Oe.r=n[c];b+=D+=Oe.g=n[c+1];y+=j+=Oe.b=n[c+2];g+=W+=Oe.a=n[c+3];Oe=Oe.next;C+=J=rt.r;v+=te=rt.g;x+=Q=rt.b;B+=K=rt.a;w-=J;D-=te;j-=Q;W-=K;rt=rt.next;m+=i}}}function Jg(){this.r=0;this.g=0;this.b=0;this.a=0;this.next=null}var yT,bT;var $g=_(()=>{"use strict";yT=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259];bT=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24]});var fi,Nn;var Bm=_(()=>{es();fi=class{constructor(e=1,t=0,i=0,r=0,o=0,n=0,a=1,l=0,u=0,c=0,h=0,m=0,d=1,f=0,b=0,y=0,g=0,C=0,v=1,x=0){this.set(e,t,i,r,o,n,a,l,u,c,h,m,d,f,b,y,g,C,v,x)}set(e,t,i,r,o,n,a,l,u,c,h,m,d,f,b,y,g,C,v,x){this.a=e;this.b=t;this.c=i;this.d=r;this.e=o;this.f=n;this.g=a;this.h=l;this.i=u;this.j=c;this.k=h;this.l=m;this.m=d;this.n=f;this.o=b;this.p=y;this.q=g;this.r=C;this.s=v;this.t=x}reset(){this.a=1;this.b=0;this.c=0;this.d=0;this.e=0;this.f=0;this.g=1;this.h=0;this.i=0;this.j=0;this.k=0;this.l=0;this.m=1;this.n=0;this.o=0;this.p=0;this.q=0;this.r=0;this.s=1;this.t=0}apply(e){const t=this.a*e.r+this.b*e.g+this.c*e.b+this.d*e.a+this.e;const i=this.f*e.r+this.g*e.g+this.h*e.b+this.i*e.a+this.j;const r=this.k*e.r+this.l*e.g+this.m*e.b+this.n*e.a+this.o;const o=this.p*e.r+this.q*e.g+this.r*e.b+this.s*e.a+this.t;return new E(t,i,r,o)}multiply(e){let t;let i;let r;let o;let n;let a;let l;let u;let c;let h;let m;let d;let f;let b;let y;let g;let C;let v;let x;let B;const w=e;const D=this;t=w.a*D.a+w.b*D.f+w.c*D.k+w.d*D.p;i=w.a*D.b+w.b*D.g+w.c*D.l+w.d*D.q;r=w.a*D.c+w.b*D.h+w.c*D.m+w.d*D.r;o=w.a*D.d+w.b*D.i+w.c*D.n+w.d*D.s;a=w.f*D.a+w.g*D.f+w.h*D.k+w.i*D.p;l=w.f*D.b+w.g*D.g+w.h*D.l+w.i*D.q;u=w.f*D.c+w.g*D.h+w.h*D.m+w.i*D.r;c=w.f*D.d+w.g*D.i+w.h*D.n+w.i*D.s;m=w.k*D.a+w.l*D.f+w.m*D.k+w.n*D.p;d=w.k*D.b+w.l*D.g+w.m*D.l+w.n*D.q;f=w.k*D.c+w.l*D.h+w.m*D.m+w.n*D.r;b=w.k*D.d+w.l*D.i+w.m*D.n+w.n*D.s;g=w.p*D.a+w.q*D.f+w.r*D.k+w.s*D.p;C=w.p*D.b+w.q*D.g+w.r*D.l+w.s*D.q;v=w.p*D.c+w.q*D.h+w.r*D.m+w.s*D.r;x=w.p*D.d+w.q*D.i+w.r*D.n+w.s*D.s;n=w.a*D.e+w.b*D.j+w.c*D.o+w.d*D.t+w.e;h=w.f*D.e+w.g*D.j+w.h*D.o+w.i*D.t+w.j;y=w.k*D.e+w.l*D.j+w.m*D.o+w.n*D.t+w.o;B=w.p*D.e+w.q*D.j+w.r*D.o+w.s*D.t+w.t;this.a=t;this.b=i;this.c=r;this.d=o;this.e=n;this.f=a;this.g=l;this.h=u;this.i=c;this.j=h;this.k=m;this.l=d;this.m=f;this.n=b;this.o=y;this.p=g;this.q=C;this.r=v;this.s=x;this.t=B;return this}clone(){const e=new fi;e.set(this.a,this.b,this.c,this.d,this.e,this.f,this.g,this.h,this.i,this.j,this.k,this.l,this.m,this.n,this.o,this.p,this.q,this.r,this.s,this.t);return e}equals(e){return this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f&&this.g===e.g&&this.h===e.h&&this.i===e.i&&this.j===e.j&&this.k===e.k&&this.l===e.l&&this.m===e.m&&this.n===e.n&&this.o===e.o&&this.p===e.p&&this.q===e.q&&this.r===e.r&&this.s===e.s&&this.t===e.t}getOffsets(){return[this.e,this.j,this.o,this.t]}toString(){return`ColorMatrix( ${this.a}, ${this.b}, ${this.c}, ${this.d}, ${this.e},
      ${this.f}, ${this.g}, ${this.h}, ${this.i}, ${this.j},
      ${this.k}, ${this.l}, ${this.m}, ${this.n}, ${this.o},
      ${this.p}, ${this.q}, ${this.r}, ${this.s}, ${this.t} )`}toArray(){return"abcdefghijklmnopqrst".split("").map(e=>this[e])}static get IDENTITY(){return new fi}static createBrightnessMatrix(e){const t=new fi;t.e=e;t.j=e;t.o=e;return t}static createContrastMatrix(e){const t=new fi;const i=(1-e)/2;t.a=t.g=t.m=e;t.e=t.j=t.o=i;return t}static createSaturationMatrix(e=1){const t=new fi;const i=1-e;const r=.213*i;const o=.715*i;const n=.072*i;t.a=r+e;t.b=o;t.c=n;t.f=r;t.g=o+e;t.h=n;t.k=r;t.l=o;t.m=n+e;return t}static createExposureMatrix(e=0){const t=Math.pow(2,e);return new fi(t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0)}static createLinearMatrix(e=1,t=0){const i=new fi;i.a=i.g=i.m=e;i.e=i.j=i.o=t;return i}};Nn=fi});var To,X;var Ro=_(()=>{Ft();di();es();Do();Bm();zi();pi();To=class extends mt{constructor(e={},t={}){super();this.availableOptions={...Object.getPrototypeOf(this).availableOptions,...t};this._onConfigurableUpdate=this._onConfigurableUpdate.bind(this);this._initOptions(e)}_buildConfigError(e){let t="";if(this.constructor.name){t=`${this.constructor.name}: `}t+=e;return new Error(t)}_onOptionsChange(){}validateSettings(){return new Promise((e,t)=>{for(const i in this.availableOptions){const r=this.availableOptions[i];if(r.required&&typeof this._options[i]==="undefined"){return t(this._buildConfigError(`Option \`${i}\` is required.`))}}e()})}_initOptions(e={}){this._options={};let t;let i;let r;const o=this;for(t in this.availableOptions){r=t.charAt(0).toUpperCase()+t.slice(1);i=this.availableOptions[t];if([p.STRING,p.NUMBER,p.BOOLEAN,p.OBJECT,p.VECTOR2,p.COLOR,p.CONFIGURABLE,p.COLOR_MATRIX,p.ARRAY,p.IMAGE,p.FUNCTION,p.ALL].indexOf(i.type)===-1){throw this._buildConfigError(`Unknown option type: \`${i.type}\``)}const n=function a(l){o[`set${r}`]=function(u,c,h){o.setOption(l,u,c,h)};o[`get${r}`]=function(){return o.getOption(l)}};n(t);if(i.type===p.CONFIGURABLE){this._options[t]=new To(void 0,i.structure||{});this._options[t].on("update",this._onConfigurableUpdate)}if(!(t in e)||typeof e[t]==="undefined"){if(typeof i.default!=="undefined"){let a=i.default;if(typeof i.default==="function"){a=i.default()}this[`set${r}`](a,false,true)}else if(i.type!==p.CONFIGURABLE){this._options[t]=void 0}}}for(t in e){if(typeof this.availableOptions[t]==="undefined"){throw new Error(`Invalid option: ${t}`)}if(typeof e[t]!=="undefined"){r=t.charAt(0).toUpperCase()+t.slice(1);this[`set${r}`](e[t],false,true)}}}set(e,t=true){Object.keys(e).forEach(i=>{this.setOption(i,e[i],false)});this._onOptionsChange();if(t){this.emit("update",this,e)}}getOption(e){return this._options[e]}hasOption(e){return!!this.availableOptions[e]}getOptionDefault(e){const t=this.availableOptions[e];if(!t){throw new Error(`Invalid option: ${e}`)}return t.default}resetOptions(){this.set(this.getDefaultOptions())}getDefaultOptions(){const e={};for(const t in this.availableOptions){const i=this.availableOptions[t].default;if(typeof i==="undefined")continue;e[t]=i}return e}getOptions(){return{...this._options}}equals(e){const t=e.getOptions();return this.optionsEqual(t)}optionsEqual(e){for(const t in e){const i=e[t];if(!this._optionEquals(t,i)){return false}}return true}_optionEquals(e,t){const i=this.availableOptions[e];if(typeof i==="undefined"){throw new Error(`Invalid option: ${e}`)}const r=this.availableOptions[e].type;const o=this._options[e];if(o===t)return true;if(typeof t==="undefined"||typeof o==="undefined")return false;switch(r){case p.OBJECT:if(typeof o.optionsEqual==="function"){return o.optionsEqual(t._options)}return o===t;case p.STRING:case p.NUMBER:case p.BOOLEAN:case p.FUNCTION:case"*":return o===t;case p.VECTOR2:return o.equals(t);case p.COLOR:case p.COLOR_MATRIX:return t.equals(o);case p.CONFIGURABLE:return o.optionsEqual(t);case p.ARRAY:return this._arrayOptionEquals(e,t);case p.IMAGE:return o.src===t.src}}_arrayOptionEquals(e,t){const i=this._options[e];if(t.length!==i.length){return false}let r=true;for(let o=0;o<i.length;o++){const n=i[o];const a=t[o];if(n instanceof To){if(typeof a==="undefined"||!n.optionsEqual(a)){r=false;break}}else if(a!==n){r=false;break}}return r}serializeOptions(e=Object.keys(this._options),t=false){const i={};e.forEach(r=>{if(typeof this.availableOptions[r]==="undefined"){return Log.warn(`Trying to serialize a key that does not exist: ${r}`)}if(this.availableOptions[r].serializable===false)return;i[r]=this.serializeOption(r,t)});return i}serializeOption(e,t=false){const i=this.availableOptions[e];const r=i.type;const o=this._options[e];if(!o)return o;if(i.serializable===false){throw new Error(`Option \`${e}\` is not serializable.`)}switch(r){case p.STRING:case p.NUMBER:case p.BOOLEAN:case p.OBJECT:case p.FUNCTION:case p.ALL:return o;case p.VECTOR2:return t?o.toObject():o.clone();case p.COLOR:case p.COLOR_MATRIX:return t?o.toArray():o.clone();case p.CONFIGURABLE:return o.serializeOptions(void 0,t);case p.ARRAY:return o.slice(0);case p.IMAGE:return t?o.src:o}}setOption(e,t,i=true,r=false){const o=this.availableOptions[e];if(!o){throw new Error(`Invalid option: ${e}`)}if(typeof o.setter!=="undefined"){t=o.setter.call(this,t,r)}if(typeof o.validation!=="undefined"){o.validation(t)}if(t===null||typeof t==="undefined"){if(o.required){throw this._buildConfigError(`Option \`${e}\` is required.`)}this._options[e]=t}else{switch(o.type){case p.STRING:{if(typeof t!==p.STRING){throw this._buildConfigError(`Option \`${e}\` has to be a string.`)}const{available:n}=o;if(typeof n!=="undefined"&&n.indexOf(t)===-1){throw this._buildConfigError(`Invalid value for \`${e}\` (valid values are: ${o.available.join(", ")})`)}this._options[e]=t;break}case p.NUMBER:if(typeof t!==p.NUMBER){throw this._buildConfigError(`Option \`${e}\` has to be a number.`)}this._options[e]=t;break;case p.BOOLEAN:if(typeof t!==p.BOOLEAN){throw this._buildConfigError(`Option \`${e}\` has to be a boolean.`)}this._options[e]=t;break;case p.VECTOR2:if(!(t instanceof L)&&!(typeof t==="object"&&"x"in t&&"y"in t)){throw this._buildConfigError(`Option \`${e}\` has to be an instance of Vector2 or an Object holding x and y values.`)}if(t instanceof L){this._options[e]=t.clone()}else{this._options[e]=L.fromObject(t)}break;case p.COLOR:if(!(t instanceof E)){throw this._buildConfigError(`Option \`${e}\` has to be an instance of Color.`)}this._options[e]=t;break;case p.COLOR_MATRIX:if(!(t instanceof Nn)){throw this._buildConfigError(`Option \`${e}\` has to be an instance of ColorMatrix.`)}this._options[e]=t.clone();break;case p.FUNCTION:if(typeof t!=="function"){throw this._buildConfigError(`Option \`${e}\` has to be a function.`)}this._options[e]=t;break;case p.OBJECT:case"*":this._options[e]=t;break;case p.IMAGE:{const{Image:n}=Je;if(typeof t==="string"){const a=new n;if(Pg(a)){a.crossOrigin=R.getCrossOriginValue(o.crossOrigin)}a.src=t;this._options[e]=a}else if(t instanceof n||typeof HTMLCanvasElement!=="undefined"&&t instanceof HTMLCanvasElement||typeof HTMLImageElement!=="undefined"&&t instanceof HTMLImageElement){this._options[e]=t}else{throw this._buildConfigError(`Option \`${e}\` has to be an Image, Canvas or String.`)}break}case p.CONFIGURABLE:if(t instanceof To){this._options[e]=t}else{this._options[e].set(t)}break;case p.ARRAY:if(!(t instanceof Array)){throw this._buildConfigError(`Option \`${e}\` has to be an Array.`)}this._options[e]=t.slice(0);break;default:throw this._buildConfigError(`Unknown option type: \`${o.type}\``)}}if(i){this._onOptionsChange();this.emit("update",this,{[e]:t})}}_onConfigurableUpdate(...e){this.emit("update",...e)}hasChanges(){const e=this.getDefaultOptions();return!this.optionsEqual(e)}};X=To});var Gn;var Mm=_(()=>{Ft();Ue();Ue();Gn=class{constructor(e,t,i,r={},o=[]){this._program=null;this._renderer=e;this._vertexSource=t;this._fragmentSource=i;this._uniforms=r;this._uniformLocations={};this._attributes=o;this._attributeLocations={};this._onContextChange=this._onContextChange.bind(this);this._renderer.on("context",this._onContextChange);this._init()}_init(){this._compile();const e=this._renderer.getContext();e.useProgram(this._program);this._cacheUniformLocations();this._cacheAttributeLocations()}_onContextChange(){this._init()}setupBuffers(e,t){const i=this._renderer.getContext();i.bindBuffer(i.ARRAY_BUFFER,e);i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t);i.vertexAttribPointer(this._attributeLocations.a_position,2,i.FLOAT,false,fr,0);i.vertexAttribPointer(this._attributeLocations.a_texCoord,2,i.FLOAT,false,fr,2*4);i.vertexAttribPointer(this._attributeLocations.a_color,4,i.UNSIGNED_BYTE,true,fr,4*4)}syncUniforms(){Object.keys(this._uniforms).forEach(e=>{this.syncUniform(e)})}syncUniform(e){const t=this._renderer.getContext();const i=this._uniforms[e];const r=this._uniformLocations[e];switch(i.type){case O.SAMPLER2D:t.uniform1i(r,i.value);break;case O.INT:case O.INT1:t.uniform1i(r,i.value);break;case O.INT2:t.uniform2i(r,i.value[0],i.value[1]);break;case O.INT3:t.uniform3i(r,i.value[0],i.value[1],i.value[2]);break;case O.INT4:t.uniform4i(r,i.value[0],i.value[1],i.value[2],i.value[3]);break;case O.FLOAT:case O.FLOAT1:t.uniform1f(r,i.value);break;case O.FLOAT2:t.uniform2f(r,i.value[0],i.value[1]);break;case O.FLOAT3:t.uniform3f(r,i.value[0],i.value[1],i.value[2]);break;case O.FLOAT4:t.uniform4f(r,i.value[0],i.value[1],i.value[2],i.value[3]);break;case O.FLOAT_VECTOR2:t.uniform2fv(r,i.value);break;case O.MAT3:case O.MAT3FV:t.uniformMatrix3fv(r,false,i.value);break;case O.MAT4:t.uniformMatrix4fv(r,false,i.value);break;default:P.warn(this.constructor.name,`Unknown uniform type: ${i.type}`)}}_cacheAttributeLocations(){const e=this._renderer.getContext();this._attributes.forEach(t=>{if(this._program){this._attributeLocations[t]=e.getAttribLocation(this._program,t)}})}_cacheUniformLocations(){const e=this._renderer.getContext();const t=Object.keys(this._uniforms);t.forEach(i=>{if(this._program){const r=e.getUniformLocation(this._program,i);if(r){this._uniformLocations[i]=r}}})}_addPrecisionToSource(e){const t=this._renderer.getMaxFloatPrecision();let i=zt.Medium;if(R.isMobile()&&t===zt.High){i=zt.High}return`precision ${i} float;
${e}`}_compile(){const e=this._renderer.getContext();const t=this._compileShader(e.VERTEX_SHADER,this._vertexSource);this._vertexShader=t;const i=this._addPrecisionToSource(this._fragmentSource);const r=this._compileShader(e.FRAGMENT_SHADER,i);this._fragmentShader=r;const o=e.createProgram();if(!o){return}e.attachShader(o,t);e.attachShader(o,r);e.linkProgram(o);const n=e.getProgramParameter(o,e.LINK_STATUS);if(!n){let a=e.getProgramInfoLog(o);if(e.isContextLost())a="WebGL context lost";e.deleteProgram(o);P.error(this.constructor.name,`WebGL program linking error: ${a}`)}else{this._program=o}}_compileShader(e,t){const i=this._renderer.getContext();const r=i.createShader(e);if(!r){throw new Error(`Cannot create shared: ${JSON.stringify(e)}`)}i.shaderSource(r,t);i.compileShader(r);const o=i.getShaderParameter(r,i.COMPILE_STATUS);if(!o){let n=i.getShaderInfoLog(r);if(i.isContextLost())n="WebGL context lost";i.deleteShader(r);P.error(this.constructor.name,`WebGL shader compilation error: ${n}`)}return r}setUniform(e,t,i=false){this._uniforms[e].value=t;if(i){this.syncUniform(e)}}setUniforms(e,t=false){Object.keys(e).forEach(i=>{this._uniforms[i].value=e[i];if(t){this.syncUniform(i)}})}getUniforms(){return this._uniforms}getAttributes(){return this._attributes}getAttributeLocations(){return this._attributeLocations}getProgram(){return this._program}dispose(){const e=this._renderer.getContext();e.deleteProgram(this._program);e.deleteShader(this._vertexShader);e.deleteShader(this._fragmentShader);this._renderer.off("context",this._onContextChange)}}});var Qg;var Zg=_(()=>{Qg="uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nvarying vec4 v_color;\n\nvoid main() {\n  gl_FragColor = texture2D(u_image, v_texCoord) * v_color;\n}\n"});var t_;var e_=_(()=>{t_="attribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec4 a_color;\nvarying vec2 v_texCoord;\nvarying vec4 v_color;\nuniform mat3 u_projMatrix;\n\nvoid main() {\n  gl_Position = vec4((u_projMatrix * vec3(a_position, 1)).xy, 0, 1);\n  v_texCoord = a_texCoord;\n  v_color = vec4(a_color.rgb * a_color.a, a_color.a);\n}\n"});var wT,Ui,Lm;var i_=_(()=>{Ft();Ue();Mm();Zg();e_();wT=new xt;Ui={vertexSource:t_,fragmentSource:Qg,uniforms:{u_image:{type:O.SAMPLER2D,value:0},u_projMatrix:{type:O.MAT3,value:wT.toArray()}},attributes:["a_position","a_texCoord","a_color"]};Lm=class extends Gn{constructor(e,t=Ui.vertexSource,i=Ui.fragmentSource){super(e,t,i,Ui.uniforms,Ui.attributes)}}});var zm=_(()=>{Mm();i_()});var ii;var Eo=_(()=>{ei();$g();Ft();Ro();Ue();zm();di();ii=class extends X{constructor(e={},t={}){super(e,t);this._initOptions(e)}_initOptions(e={}){this._shaders=[];this._availableUniforms=Ui.uniforms;this._attributes=Ui.attributes;this._vertexSource=Ui.vertexSource;this._fragmentSource=Ui.fragmentSource;this._initUniforms();super._initOptions(e)}_initUniforms(){this._uniforms={};for(const e in this._availableUniforms){const t=this._availableUniforms[e];this._uniforms[e]={type:t.type,value:t.default||null}}for(const e in this.availableOptions){const t=this.availableOptions[e];if(!t.uniformType){P.trace(this.constructor.name,`Option \`${e}\` is missing a \`uniformType\`!`)}else{this._uniforms[`u_${e}`]={type:t.uniformType,value:t.default||null}}}}setOption(e,t,i=true){super.setOption(e,t,i);let r=t;const o=this.availableOptions[e];if(!o.uniformType){return}const n=`u_${e}`;switch(o.type){case p.COLOR:if(o.uniformType===O.FLOAT4){r=t.toGLColor()}else if(o.uniformType===O.FLOAT3){r=t.toRGBGLColor()}break;case p.VECTOR2:r=[t.x,t.y];break;case p.COLOR_MATRIX:{r=[t.a,t.b,t.c,t.d,t.f,t.g,t.h,t.i,t.k,t.l,t.m,t.n,t.p,t.q,t.r,t.s];const a=[t.e,t.j,t.o,t.t];this._uniforms[`${n}_vec`]={value:a,type:O.FLOAT4}}}this.setUniform(n,r)}setUniform(e,t,i=false){this._uniforms[e].value=t}setUniforms(e,t=false){Object.entries(e).forEach(([i,r])=>{this._uniforms[i].value=r;if(t){this.syncUniform(i)}})}syncUniform(e){this._shaders.forEach(t=>{t.syncUniform(e)})}syncUniforms(){this._shaders.forEach(e=>{e.syncUniforms()})}getShaderForRenderer(e){const{id:t}=e;if(!this._shaders)this._shaders=[];let i=this._shaders[t];if(!i){i=new Gn(e,this._vertexSource,this._fragmentSource,this._uniforms,this._attributes);this._shaders[t]=i}return i}apply(e,t,i,r=false){if(yo(e)){this._applyWebGL(e,t,i,r)}else{this._applyCanvas(e,t,i,r)}}_applyWebGL(e,t,i,r=false){const o=e.getContext();const n=this.getShaderForRenderer(e);e.setRenderTarget(i);if(r){i.clear()}e.setShader(n);const a=e.getCurrentRenderTarget().getProjectionMatrix().toArray();n.setUniform("u_projMatrix",a);n.syncUniforms();o.activeTexture(o.TEXTURE0);o.bindTexture(o.TEXTURE_2D,t.getTexture());o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0)}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=i.getContext();P.warn(this.constructor.name,"`_applyCanvas` is not implemented. Just copying image data from `inputTarget` to `outputTarget`.");n.clearRect(0,0,o.width,o.height);n.drawImage(o,0,0)}dispose(){this._shaders.forEach(e=>e.dispose());this._shaders=[]}_blurImage(e,t,i){const r=10;const o=e.getCanvas();const n=Math.min(1,r/(i*Math.min(o.width,o.height)));const a=R.createCanvas();a.width=Math.round(o.width*n);a.height=Math.round(o.height*n);const l=a.getContext("2d");l.drawImage(o,0,0,o.width,o.height,0,0,a.width,a.height);const u=i*Math.min(a.width,a.height);const c=l.getImageData(0,0,a.width,a.height);Yg(c,0,0,a.width,a.height,u);l.putImageData(c,0,0);t.getContext().drawImage(a,0,0,a.width,a.height,0,0,o.width,o.height);ke(a)}}});var s_;var r_=_(()=>{s_="uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nvarying vec4 v_color;\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4(color.a > 0. ? color.rgb / color.a : vec3(0), color.a);\n}\n"});var So;var o_=_(()=>{Eo();r_();So=class extends ii{constructor(){super();this._fragmentSource=s_}}});var a_;var n_=_(()=>{a_="uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform vec4 u_color;\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4(mix(color.rgb, u_color.rgb, u_color.a), color.a) * color.a;\n}\n"});var kT,TT,Um,l_;var u_=_(()=>{Ue();Eo();n_();({OptionType:kT,UniformType:TT}=bt);Um=class extends ii{constructor(...e){super(...e);this._fragmentSource=a_}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const{color:l}=this._options;const u=n.getImageData(0,0,o.width,o.height);const c=a.getImageData(0,0,o.width,o.height);const h=o.width*o.height;const m=new E;const d=new E;for(let f=0;f<h*4;f+=4){m.set(u.data[f]/255,u.data[f+1]/255,u.data[f+2]/255,u.data[f+3]/255);d.set(c.data[f]/255,c.data[f+1]/255,c.data[f+2]/255,c.data[f+3]/255);const b=d.r+m.a*(m.r-d.r);c.data[f]=(b+m.a*(l.r-b))*255;const y=d.g+m.a*(m.g-d.g);c.data[f+1]=(y+m.a*(l.g-y))*255;const g=d.b+m.a*(m.b-d.b);c.data[f+2]=(g+m.a*(l.b-g))*255}a.putImageData(c,0,0)}};Um.prototype.availableOptions={color:{type:kT.COLOR,default:E.WHITE,uniformType:TT.FLOAT4}};l_=Um});var m_;var c_=_(()=>{m_="uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform vec4 u_color;\nuniform int u_mode;\nvec3 W = vec3(0.2125, 0.7154, 0.0721);\nconst float EPSILON = 0.0000001;\nvoid main() {\n    vec4 color = texture2D(u_image, v_texCoord); // Is premultiplied.\n    color.rgb /= max(color.a, EPSILON); // Revert premultiplied alpha.\n    vec4 newColor;\n    if (u_mode == 0) {\n        newColor = vec4(color.rgb, 1.0); // We use alpha 1.0 becaue color is not premultiplied.\n        newColor *= color.a; // Premultiply the result\n    } else if (u_mode == 1) {\n        newColor = vec4(u_color.rgb, 1.0); // Use alpha 1.0 because it is not premultiplied.\n        newColor *= color.a * u_color.a; // Changed alpha and premultiplied the result.\n    } else if (u_mode == 2) {\n        float luminance = dot(color.rgb, W); // Convert to color to gray value.\n        newColor = vec4(vec3(luminance) * u_color.rgb, 1.0); // Colorize and with alpha 1.0 because it is not premultiplied.\n        newColor *= color.a * u_color.a; // Changed alpha and premultiplied the result.\n    }\n    gl_FragColor = newColor;\n}"});var d_,p_,gr,h_;var f_=_(()=>{Ue();Eo();c_();({OptionType:d_,UniformType:p_}=bt);gr=class extends ii{constructor(...e){super(...e);this._fragmentSource=m_}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=n.getImageData(0,0,o.width,o.height);const{mode:u,color:c}=this._options;const{r:h,g:m,b:d,a:f}=c;const b=[.2125,.7154,.0721];switch(u){case gr.MODES.SOLID:for(let y=0;y<o.width*o.height;y++){const g=y*4;l.data[g]+=(h*255-l.data[g])*f;l.data[g+1]+=(m*255-l.data[g+1])*f;l.data[g+2]+=(d*255-l.data[g+2])*f}break;case gr.MODES.COLORIZED:for(let y=0;y<o.width*o.height;y++){const g=y*4;const C=l.data[g]/255*b[0]+l.data[g+1]/255*b[1]+l.data[g+2]/255*b[2];const v=new E(C*h,C*m,C*d);l.data[g]+=(v.r*255-l.data[g])*f;l.data[g+1]+=(v.g*255-l.data[g+1])*f;l.data[g+2]+=(v.b*255-l.data[g+2])*f}break}a.putImageData(l,0,0)}};gr.MODES={NONE:0,SOLID:1,COLORIZED:2};gr.prototype.availableOptions={color:{type:d_.COLOR,default:E.WHITE,uniformType:p_.FLOAT4},mode:{type:d_.NUMBER,default:gr.MODES.NONE,uniformType:p_.INT}};h_=gr});var __;var g_=_(()=>{__="uniform sampler2D u_image;\nvarying vec2 v_texCoord;\nuniform sampler2D u_overlayImage;\nuniform int u_blendMode;\nuniform float u_alpha;\n\nconst float EPSILON = 0.000001;\n\nvec4 overlay(vec4 a, vec4 b) {\n    vec3 result = mix(\n          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),\n          2.0 * a.rgb * b.rgb,\n          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)\n      );\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 hardLight(vec4 b, vec4 a) {\n    vec3 result = mix(\n          1.0 - 2.0 * (1.0 - a.rgb) * (1.0 - b.rgb),\n          2.0 * a.rgb * b.rgb,\n          vec3(a.r < 0.5, a.g < 0.5, a.b < 0.5)\n      );\n    return mix(b, vec4(result, b.a), u_alpha * a.a);\n}\n\nvec4 softLight(vec4 a, vec4 b) {\n    vec3 result = mix(\n          2.0 * a.rgb * (1.0 - b.rgb) + (2.0 * b.rgb - 1.0) * sqrt(a.rgb),\n          2.0 * a.rgb * b.rgb + a.rgb * a.rgb * (1.0 - 2.0 * b.rgb),\n          vec3(b.r < 0.5, b.g < 0.5, b.b < 0.5)\n      );\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 multiply(vec4 a, vec4 b) {\n    vec3 result = a.rgb * b.rgb;\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 darken(vec4 a, vec4 b) {\n    vec3 result = min(a.rgb, b.rgb);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 lighten(vec4 a, vec4 b) {\n    vec3 result = max(a.rgb, b.rgb);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 screen(vec4 a, vec4 b) {\n    vec3 result = 1.0 - (1.0 - a.rgb) * (1.0 - b.rgb);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 colorBurn(vec4 a, vec4 b) {\n    vec3 result = clamp(1.0 - (1.0 - a.rgb) / max(b.rgb, EPSILON), 0.0, 1.0);\n    return mix(a, vec4(result, a.a), u_alpha * b.a);\n}\n\nvec4 normal(vec4 a, vec4 b) {\n    return mix(a, vec4(b.rgb, a.a), u_alpha * b.a);\n}\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  vec4 overlayColor = texture2D(u_overlayImage, v_texCoord);\n\n  vec4 resultColor;\n  if (u_blendMode == 0) {\n    resultColor = normal(color, overlayColor);\n  } else if (u_blendMode == 1) {\n    resultColor = overlay(color, overlayColor);\n  } else if (u_blendMode == 2) {\n    resultColor = hardLight(color, overlayColor);\n  } else if (u_blendMode == 3) {\n    resultColor = softLight(color, overlayColor);\n  } else if (u_blendMode == 4) {\n    resultColor = multiply(color, overlayColor);\n  } else if (u_blendMode == 5) {\n    resultColor = darken(color, overlayColor);\n  } else if (u_blendMode == 6) {\n    resultColor = lighten(color, overlayColor);\n  } else if (u_blendMode == 7) {\n    resultColor = screen(color, overlayColor);\n  } else if (u_blendMode == 8) {\n    resultColor = colorBurn(color, overlayColor);\n  }\n  gl_FragColor = vec4(resultColor.rgb * resultColor.a, resultColor.a);\n}\n"});var _l,Nm,Gm,dt,y_;var b_=_(()=>{Ue();Eo();g_();({OptionType:_l,UniformType:Nm}=bt);Gm=1e-6;dt=class extends ii{constructor(...e){super(...e);this._fragmentSource=__;this._lastImage=null}_applyCanvas(e,t,i,r=false){const o=this._options.overlayTexture.getRenderTarget().getContext();const n=t.getCanvas();const a=t.getContext();const l=i.getContext();const u=a.getImageData(0,0,n.width,n.height);const c=o.getImageData(0,0,n.width,n.height);const{blendMode:h,alpha:m}=this._options;const d=new E;const f=new E;const b=new E;for(let y=0;y<n.width*n.height*4;y+=4){d.set(u.data[y]/255,u.data[y+1]/255,u.data[y+2]/255,u.data[y+3]/255);f.set(c.data[y]/255,c.data[y+1]/255,c.data[y+2]/255,c.data[y+3]/255);let g;let C;let v;let x;let B;let w;let D;let j;let W;switch(h){case dt.BLEND_MODES.NORMAL:b.set(d.r+f.a*m*(f.r-d.r),d.g+f.a*m*(f.g-d.g),d.b+f.a*m*(f.b-d.b),d.a);break;case dt.BLEND_MODES.OVERLAY:g=1-2*(1-d.r)*(1-f.r);C=2*d.r*f.r;v=g+(d.r<.5?1:0)*(C-g);x=1-2*(1-d.g)*(1-f.g);B=2*d.g*f.g;w=x+(d.g<.5?1:0)*(B-x);D=1-2*(1-d.b)*(1-f.b);j=2*d.b*f.b;W=D+(d.b<.5?1:0)*(j-D);b.set(d.r+f.a*m*(v-d.r),d.g+f.a*m*(w-d.g),d.b+f.a*m*(W-d.b),d.a);break;case dt.BLEND_MODES.HARD_LIGHT:g=1-2*(1-f.r)*(1-d.r);C=2*f.r*d.r;v=g+(f.r<.5?1:0)*(C-g);x=1-2*(1-f.g)*(1-d.g);B=2*f.g*d.g;w=x+(f.g<.5?1:0)*(B-x);D=1-2*(1-f.b)*(1-d.b);j=2*f.b*d.b;W=D+(f.b<.5?1:0)*(j-D);b.set(d.r+f.a*m*(v-d.r),d.g+f.a*m*(w-d.g),d.b+f.a*m*(W-d.b),d.a);break;case dt.BLEND_MODES.SOFT_LIGHT:g=2*d.r*(1-f.r)+(2*f.r-1)*Math.sqrt(d.r);C=2*d.r*f.r+d.r*d.r*(1-2*f.r);v=g+(f.r<.5?1:0)*(C-g);x=2*d.g*(1-f.g)+(2*f.g-1)*Math.sqrt(d.g);B=2*d.g*f.g+d.g*d.g*(1-2*f.g);w=x+(f.g<.5?1:0)*(B-x);D=2*d.b*(1-f.b)+(2*f.b-1)*Math.sqrt(d.b);j=2*d.b*f.b+d.b*d.b*(1-2*f.b);W=D+(f.b<.5?1:0)*(j-D);b.set(d.r+f.a*m*(v-d.r),d.g+f.a*m*(w-d.g),d.b+f.a*m*(W-d.b),d.a);break;case dt.BLEND_MODES.MULTIPLY:v=d.r*f.r;w=d.g*f.g;W=d.b*f.b;b.set(d.r+f.a*m*(v-d.r),d.g+f.a*m*(w-d.g),d.b+f.a*m*(W-d.b),d.a);break;case dt.BLEND_MODES.DARKEN:v=Math.min(d.r,f.r);w=Math.min(d.g,f.g);W=Math.min(d.b,f.b);b.set(d.r+f.a*m*(v-d.r),d.g+f.a*m*(w-d.g),d.b+f.a*m*(W-d.b),d.a);break;case dt.BLEND_MODES.LIGHTEN:v=Math.max(d.r,f.r);w=Math.max(d.g,f.g);W=Math.max(d.b,f.b);b.set(d.r+f.a*m*(v-d.r),d.g+f.a*m*(w-d.g),d.b+f.a*m*(W-d.b),d.a);break;case dt.BLEND_MODES.SCREEN:v=1-(1-d.r)*(1-f.r);w=1-(1-d.g)*(1-f.g);W=1-(1-d.b)*(1-f.b);b.set(d.r+f.a*m*(v-d.r),d.g+f.a*m*(w-d.g),d.b+f.a*m*(W-d.b),d.a);break;case dt.BLEND_MODES.COLOR_BURN:v=Math.max(0,Math.min(1,1-(1-d.r)/Math.max(f.r,Gm)));w=Math.max(0,Math.min(1,1-(1-d.g)/Math.max(f.g,Gm)));W=Math.max(0,Math.min(1,1-(1-d.b)/Math.max(f.b,Gm)));b.set(d.r+f.a*m*(v-d.r),d.g+f.a*m*(w-d.g),d.b+f.a*m*(W-d.b),d.a);break}u.data[y]=b.r*255;u.data[y+1]=b.g*255;u.data[y+2]=b.b*255;u.data[y+3]=b.a*255}l.putImageData(u,0,0)}};dt.BLEND_MODES={NORMAL:0,OVERLAY:1,HARD_LIGHT:2,SOFT_LIGHT:3,MULTIPLY:4,DARKEN:5,LIGHTEN:6,SCREEN:7,COLOR_BURN:8};dt.prototype.availableOptions={blendMode:{type:_l.NUMBER,default:dt.BLEND_MODES.NORMAL,uniformType:Nm.INT},overlayImage:{type:_l.NUMBER,required:true,uniformType:Nm.SAMPLER2D},overlayTexture:{type:_l.OBJECT,required:true},alpha:{type:_l.NUMBER,default:1,uniformType:Nm.FLOAT}};y_=dt});var Wm={};Me(Wm,{ColorOverlayFilter:()=>l_,OverlayFilter:()=>y_,TintFilter:()=>h_,UnpremultiplyFilter:()=>So});var Vm=_(()=>{o_();u_();f_();b_()});var Gt,_r,x_,Fo,ze;var Oo=_(()=>{Ue();di();(function(r){r[r["Nearest"]=0]="Nearest";r[r["Linear"]=1]="Linear";r[r["Bilinear"]=2]="Bilinear";r[r["Trilinear"]=3]="Trilinear"})(Gt||(Gt={}));(function(i){i[i["ClampToEdge"]=0]="ClampToEdge";i[i["Repeat"]=1]="Repeat";i[i["MirroredRepeat"]=2]="MirroredRepeat"})(_r||(_r={}));x_={[1]:"LINEAR",[0]:"NEAREST",[2]:"LINEAR_MIPMAP_NEAREST",[3]:"LINEAR_MIPMAP_LINEAR"};Fo=class extends mt{constructor(e){super();this._renderers=[];this._glTextures={};this._dirty=true;this._mipMapping=false;this._glUnit=0;this._magFilter=Fo.DefaultMagFilter;this._minFilter=Fo.DefaultMinFilter;this._repeatX=0;this._repeatY=0;this._pixelRatio=1;this._loaded=false;this._frame=new be(0,0,100,100);this._onSourceLoaded=this._onSourceLoaded.bind(this);this._source=e;this._loadSource()}resizeTo(e){if(this._frame.width===e.x&&this._frame.height===e.y){return}this._frame.width=e.x;this._frame.height=e.y;this._dirty=true}_loadSource(){const e=this._source;if(!e)return;if(Je.isCanvas(e)){return this._onSourceLoaded()}if(e.complete){return this._onSourceLoaded()}e.addEventListener&&e.addEventListener("load",this._onSourceLoaded)}_onSourceLoaded(){this._loaded=true;this.emit("loaded");this.update()}_updateGLFilters(){if(!this._source)return;const e=new L(this._source.width,this._source.height);if(R.isPowerOfTwo(e)){P.info(this.constructor.name,"Mip-mapping enabled");this._minFilter=Fo.TrilinearFilter;this._mipMapping=true}else{this._minFilter=Fo.LinearFilter;this._mipMapping=false}}update(){if(!this._source)return;if(this._frame.width!==this._source.width||this._frame.height!==this._source.height){this._frame=new be(0,0,this._source.width,this._source.height);this._dirty=true}this._updateGLFilters();this.emit("update")}getRenderers(){return[...this._renderers]}getGLFilter(e,t){switch(t){case"min":return e[x_[this._minFilter]];case"mag":return e[x_[this._magFilter]]}}isLoaded(){return this._loaded}setLoaded(e){this._loaded=e}getSource(){return this._source}setSource(e){this._source=e}getGLTextureForRenderer(e){return this._glTextures[e.id]}setGLTextureForRenderer(e,t){this._renderers[t.id]=t;this._glTextures[t.id]=e}getFrame(){return this._frame}setFrame(e){this._frame=e}getDimensions(){return new L(this._frame.width,this._frame.height)}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e}getGLUnit(){return this._glUnit}setGLUnit(e){this._glUnit=e}setMinFilter(e){this._minFilter=e}getMinFilter(){return this._minFilter}setMagFilter(e){this._magFilter=e}getMagFilter(){return this._magFilter}setRepeatX(e){this._repeatX=e}getRepeatX(){return this._repeatX}setRepeatY(e){this._repeatY=e}getRepeatY(){return this._repeatY}getGLRepeat(e,t){const i=t==="x"?this.getRepeatX():this.getRepeatY();switch(i){case 0:return e.CLAMP_TO_EDGE;case 1:return e.REPEAT;case 2:return e.MIRRORED_REPEAT;default:return 0}}isDirty(){return this._dirty}setDirty(e){this._dirty=e}disposeGLTextures(){this._renderers.forEach(e=>{if(yo(e)){this.disposeGLTexturesForRenderer(e)}})}disposeGLTexturesForRenderer(e){if(!this._glTextures[e.id])return;const t=e.getContext();t.deleteTexture(this._glTextures[e.id]);delete this._glTextures[e.id];if(!this._renderers[e.id]){delete this._renderers[e.id]}}isMipMappingEnabled(){return this._mipMapping}setMipMappingEnabled(e){this._mipMapping=e}dispose(){this.disposeGLTextures();this._source=void 0}};ze=Fo;ze.NearestFilter=0;ze.LinearFilter=1;ze.BilinearFilter=2;ze.TrilinearFilter=3;ze.DefaultMagFilter=0;ze.DefaultMinFilter=1;ze.Repeat=1;ze._id=0});var Ni;var Wn=_(()=>{Ue();Oo();di();Ni=class{constructor(e,t,i,r=Je.createCanvas(),o){this._width=e;this._height=t;this._pixelRatio=i;this._baseTexture=new ze;this._canvas=r;const n=o||this._canvas.getContext("2d");if(!n){throw new Error("Cannot get canvas context")}this._context=n;this._baseTexture.setSource(this._canvas);this._canvas.width=this._width*this._pixelRatio;this._canvas.height=this._height*this._pixelRatio;this._filterStack=[{renderTarget:this,filters:[]}]}clear(){const e=this._context;e.setTransform(1,0,0,1,0,0);e.clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}resizeTo(e){this._baseTexture.resizeTo(e);if(this._width!==e.x){this._width=e.x;this._canvas.width=this._width*this._pixelRatio}if(this._height!==e.y){this._height=e.y;this._canvas.height=this._height*this._pixelRatio}}getCanvas(){return this._canvas}getContext(){return this._context}getFilterStack(){return this._filterStack}getWidth(){return this._width}getHeight(){return this._height}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e}getDimensions(){return new L(this._width,this._height)}getBaseTexture(){return this._baseTexture}dispose(){delete this._canvas;delete this._context;this._baseTexture.dispose()}}});var ss;var yl=_(()=>{Ue();Wn();ss=class{constructor(e){this._renderer=e;this._filterStack=[{renderTarget:e.getCurrentRenderTarget(),filters:[]}];this._textures=[];this._textureFrame=new be(0,0,e.getWidth(),e.getHeight())}resizeTo(e){this._textureFrame.width=e.x;this._textureFrame.height=e.y;this._textures.forEach(t=>t.resizeTo(e))}pushFilters(e,t){this._currentFrame=e.getBounds();const i=this._getOrCreateRenderTarget();this._renderer.setRenderTarget(i);this._filterStack.push({renderTarget:i,filters:t});i.clear()}popFilters(){const e=this._filterStack.pop();if(!e)return void 0;const{filters:t,renderTarget:i}=e;const r=this._filterStack[this._filterStack.length-1];const o=i;const n=r.renderTarget;if(t.length===1){const a=t[0];a.apply(this._renderer,o,n);this._textures.push(o)}else{this._applyFilters(t,o,n)}return t}_applyFilters(e,t,i){let r=t;let o=this._getOrCreateRenderTarget(true);const n=e[e.length-1];e.forEach(a=>{const l=a===n;if(!l){a.apply(this._renderer,r,o);const u=r;r=o;o=u}else{a.apply(this._renderer,r,i)}});this._textures.push(r);this._textures.push(o)}_getOrCreateRenderTarget(e=false){let t=this._textures.pop();if(!t){t=new Ni(this._textureFrame.width,this._textureFrame.height,1)}if(e){t.clear()}return t}setFilterStack(e){this._filterStack=e}dispose(){}}});var jn=we((v_,Vn)=>{(function(){var s,e,t,i,r,o;if(typeof performance!=="undefined"&&performance!==null&&performance.now){Vn.exports=function(){return performance.now()}}else if(typeof process!=="undefined"&&process!==null&&process.hrtime){Vn.exports=function(){return(s()-r)/1e6};e=process.hrtime;s=function(){var n;n=e();return n[0]*1e9+n[1]};i=s();o=process.uptime()*1e9;r=i-o}else if(Date.now){Vn.exports=function(){return Date.now()-t};t=Date.now()}else{Vn.exports=function(){return new Date().getTime()-t};t=new Date().getTime()}}).call(v_)});var w_,C_,bl;var jm=_(()=>{Ue();w_=typeof window!=="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):jn();C_=class{constructor(e){this._context=e;this._tracking=false;const t=this;for(const i in e){const r=e[i];if(typeof r==="function"){this[i]=function(...o){const n=e[i];if(!t._tracking){return n.apply(e,o)}const a=w_();const l=n.apply(e,o);const u=w_()-a;const c={functionName:i,arguments:o,duration:u};t._trackedCalls.push(c);return l}}else{this._makePropertyWrapper(i)}}}_makePropertyWrapper(e){const t=["_context","_trackedCalls","_tracking"];if(t.indexOf(e)!==-1)return;const i=this._context;this.__defineGetter__(e,()=>{return i[e]});this.__defineSetter__(e,r=>{i[e]=r})}startFrame(){this._tracking=true;this._trackedCalls=[]}endFrame(){const e="Rendering";P.log(e,"Frame rendering results:");P.log(e,`Context calls: ${this._trackedCalls.length}`);const t={};this._trackedCalls.forEach(({functionName:r,duration:o})=>{t[r]=t[r]||{totalDuration:0,calls:0};t[r].totalDuration+=o;t[r].calls++});let i=[];for(const r in t){const o=t[r];o.averageDuration=o.totalDuration/o.calls;i.push({functionName:r,data:o})}i.sort((r,o)=>o.data.totalDuration-r.data.totalDuration);i=i.slice(0,3);i.forEach(r=>{P.log(e,`${r.functionName}: ${r.data.calls} calls, ${r.data.totalDuration.toFixed(2)}ms`)})}};bl=C_});var Hn;var Hm=_(()=>{Ue();Hn=class extends mt{constructor(e=800,t=600,i){super();this._maxTextureSize=null;this._options={debug:false,transparent:false,clearColor:E.TRANSPARENT,...i,pixelRatio:1};this.setMaxListeners(0);this._width=e;this._height=t;this._dimensions=new L(this._width,this._height);this._maxTextureSize=null;this._pixelRatio=this._options.pixelRatio;this._canvas=this._options.canvas;this._clearColor=this._options.transparent?E.TRANSPARENT:this._options.clearColor||E.BLACK}setCanvas(e){const t=this._canvas;this._canvas=e;if(t!==e){this._createContext();this._onBeforeContext();this._setupContext()}this.resizeTo(new L(this._width,this._height))}getCanvas(){return this._canvas}_onBeforeContext(){}resizeTo(e,t=true){this._width=e.x*this._pixelRatio;this._height=e.y*this._pixelRatio;if(t&&this._canvas){this._canvas.width=this._width;this._canvas.height=this._height;if("style"in this._canvas){this._canvas.style.width=`${this._width/this._pixelRatio}px`;this._canvas.style.height=`${this._height/this._pixelRatio}px`}}this._dimensions=e.clone()}_createContext(){P.warn(this.constructor.name,"`_createContext` is abstract and not implemented in inherited class")}_setupContext(){P.warn(this.constructor.name,"`_setupContext` is abstract and not implemented in inherited class")}render(e){P.warn(this.constructor.name,"`render` is abstract and not implemented in inherited class")}getMaxDimensions(){return null}getContext(){return this._context}getWidth(){return this._dimensions.x}getHeight(){return this._dimensions.y}getDimensions(){return this._dimensions}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e;if(this._defaultRenderTarget){this._defaultRenderTarget.setPixelRatio(e)}}getMaxTextureSize(){return this._maxTextureSize}getFilterManager(){return this._filterManager}setFilterManager(e){this._filterManager=e}setClearColor(e){this._clearColor=e}getClearColor(){return this._clearColor}isOfType(e){return this._type===e}dispose(){P.warn(this.constructor.name,"`dispose` is abstract and not implemented in inherited class")}}});var D_,qm,Ao;var k_=_(()=>{ei();fl();Ue();yl();Wn();jm();di();Hm();({RendererType:D_}=bt);qm=class extends Hn{constructor(e=800,t=600,i){super(e,t,{...i});this.id=0;this.setCanvas((i==null?void 0:i.canvas)||Je.createCanvas());this._type=D_.CANVAS}_createContext(){const e=this._canvas;let t=e.getContext("2d");if(!t)return;if(this._options.debug){t=new bl(t)}this.id=qm.contextId++;this._context=t;this.emit("context",t);return t}_setupContext(){const e=this._context;if(!("imageSmoothingEnabled"in e)){["moz","webkit","ms"].forEach(t=>{if(e[t]){e[t]=true}})}else{e.imageSmoothingEnabled=true}this._defaultRenderTarget=new Ni(this._width,this._height,this._pixelRatio,this._canvas,this._context);this.setRenderTarget(this._defaultRenderTarget);this._filterManager=new ss(this)}render(e){const t=this._renderTarget.getContext();const i=e.getParent();e.setParent(new rs);e.updateTransform();if(i){e.setParent(i)}t.setTransform(1,0,0,1,0,0);t.globalAlpha=1;const{width:r,height:o}=this._canvas;t.clearRect(0,0,r,o);if(this._clearColor.a!==0){t.save();t.fillStyle=this._clearColor.toRGBA();t.fillRect(0,0,r,o);t.restore()}this.renderDisplayObject(e,this._renderTarget)}renderDisplayObject(e,t){const i=this._renderTarget;this._filterManager.setFilterStack(t.getFilterStack());this.setRenderTarget(t);e.renderCanvas(this);this.setRenderTarget(i)}getCurrentRenderTarget(){return this._renderTarget}setRenderTarget(e){this._renderTarget=e}getContext(){return this._renderTarget.getContext()}dispose(){ke(this._canvas);this._filterManager.dispose()}};Ao=qm;Ao.contextId=0;Ao.type=D_.CANVAS});var T_;var R_=_(()=>{T_=s=>{if(typeof window!=="undefined"){const{WebGLDebugUtils:e}=window;if(e){const t=(i,r)=>{console.error(`gl.${i}(${e.glFunctionArgsToString(i,r)})`)};s=e.makeDebugContext(s,null,t)}}return s}});var Km;var E_=_(()=>{Km=class{constructor(e){this.vertices=new Float32Array([0,0,100,0,100,100,0,100]);this.uvs=new Float32Array([0,0,1,0,1,1,0,1]);this.indices=new Uint16Array([0,1,2,0,3,2]);this.colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]);this.vertexBuffer=null;this.indexBuffer=null;this.gl=e;this.initBuffers();this.uploadBuffers()}map(e,t){const{x:i,y:r}=t;this.uvs[2]=t.width/e.width;this.uvs[4]=this.uvs[2];this.uvs[5]=t.height/e.height;this.uvs[7]=this.uvs[5];this.vertices[0]=i;this.vertices[1]=r;this.vertices[2]=i+t.width;this.vertices[3]=r;this.vertices[4]=this.vertices[2];this.vertices[5]=r+t.height;this.vertices[6]=i;this.vertices[7]=this.vertices[5];this.uploadBuffers()}getVertexBuffer(){return this.vertexBuffer}getIndexBuffer(){return this.indexBuffer}dispose(){this.cleanBuffer()}initBuffers(){const{gl:e}=this;this.cleanBuffer();this.vertexBuffer=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer);e.bufferData(e.ARRAY_BUFFER,(8+8+16)*4,e.DYNAMIC_DRAW);this.indexBuffer=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW)}uploadBuffers(){const{gl:e}=this;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer);e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices);e.bufferSubData(e.ARRAY_BUFFER,8*4,this.uvs);e.bufferSubData(e.ARRAY_BUFFER,(8+8)*4,this.colors)}cleanBuffer(){const{gl:e}=this;e.deleteBuffer(this.vertexBuffer);e.deleteBuffer(this.indexBuffer)}}});var Gi;var qn=_(()=>{Ue();Oo();Gi=class{constructor(e,t,i,r,o=false){this._renderer=e;this._gl=e.getContext();this._width=t;this._height=i;this._frame=null;this._pixelRatio=r;this._projectionMatrix=new xt;this._mipMapping=false;this._baseTexture=new ze;const n=this._baseTexture.getFrame();n.width=t;n.height=i;this._baseTexture.setPixelRatio(r);this._baseTexture.setLoaded(true);this._framebuffer=null;this._isRoot=o;this._filterStack=[{renderTarget:this,filters:[]}];if(!o){this._initFrameBuffer()}}resizeTo(e){this._width=e.x|0;this._height=e.y|0;this._baseTexture.resizeTo(e);if(!this._isRoot){this._resizeTexture()}this._baseTexture.setMinFilter(this._getMinFilter());this._baseTexture.setMagFilter(this._getMagFilter());this._calculateProjectionMatrix()}_getMinFilter(){let e=ze.DefaultMinFilter;if(this._mipMapping){e=ze.TrilinearFilter}return e}_getMagFilter(){return ze.DefaultMagFilter}_resizeTexture(){const e=this._gl;const t=this._width*this._pixelRatio;const i=this._height*this._pixelRatio;if(this._texture){e.deleteTexture(this._texture);this._texture=null}this._texture=e.createTexture();e.bindTexture(e.TEXTURE_2D,this._texture);e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,i,0,e.RGBA,e.UNSIGNED_BYTE,null);e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._texture,0);if(this._texture){this._baseTexture.setGLTextureForRenderer(this._texture,this._renderer)}if(this._renderer._options.debug){ts.checkFramebufferStatus("WebGLRenderTarget#_initFramebuffer",e)}const r=new L(this._width,this._height);if(R.isPowerOfTwo(r)){P.info("WebGLRenderTarget","Mip-mapping enabled");this._mipMapping=true}else{this._mipMapping=false}this._baseTexture.setMipMappingEnabled(this._mipMapping)}activate(){const e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer);this._calculateProjectionMatrix();e.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio);e.disable(e.STENCIL_TEST)}clear(e=E.TRANSPARENT){const t=this._gl;t.bindFramebuffer(t.FRAMEBUFFER,this._framebuffer);if(this._renderer._options.debug){ts.checkFramebufferStatus("WebGLRenderTarget#clear",t)}t.clearColor.apply(t,e.toGLColor());t.clear(t.COLOR_BUFFER_BIT)}_calculateProjectionMatrix(){const e=this._projectionMatrix;e.reset();const t=this._frame||new be(0,0,this._width,this._height);const{x:i,y:r}=t;if(!this._isRoot){e.a=1/this._width*2;e.d=1/this._height*2;e.tx=-1-i*e.a;e.ty=-1-r*e.d}else{e.a=1/this._width*2;e.d=-1/this._height*2;e.tx=-1-i*e.a;e.ty=1-r*e.d}}_initFrameBuffer(){const e=this._gl;if(this._framebuffer){e.deleteFramebuffer(this._framebuffer);this._framebuffer=null}if(this._texture){e.deleteTexture(this._texture);this._texture=null}this._framebuffer=e.createFramebuffer();this._texture=e.createTexture();e.bindTexture(e.TEXTURE_2D,this._texture);e.bindFramebuffer(e.FRAMEBUFFER,this._framebuffer);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this._texture,0);if(this._texture){this._baseTexture.setGLTextureForRenderer(this._texture,this._renderer)}this.resizeTo(new L(this._width,this._height));if(this._renderer._options.debug){ts.checkFramebufferStatus("WebGLRenderTarget#_initFramebuffer",e)}}getProjectionMatrix(){return this._projectionMatrix}getTexture(){return this._texture}getFrame(){return this._frame}setFrame(e){this._frame=e}getFilterStack(){return this._filterStack}getPixelRatio(){return this._pixelRatio}setPixelRatio(e){this._pixelRatio=e;if(!this._isRoot){this._resizeTexture()}}getBaseTexture(){return this._baseTexture}dispose(){const e=this._gl;this._baseTexture.dispose();if(this._framebuffer){e.deleteFramebuffer(this._framebuffer);this._framebuffer=null}if(this._texture){e.deleteTexture(this._texture);this._texture=null}}}});var Kn;var Xm=_(()=>{Vm();Ue();E_();di();qn();Kn=class{constructor(e){this._renderer=e;this._filterStack=[];this._currentFrame=null;this._renderTargets=[];this._textureFrame=new be(0,0,e.getWidth(),e.getHeight());this._onContextChange=this._onContextChange.bind(this);this._renderer.on("context",this._onContextChange);this._onContextChange()}resizeTo(e){this._textureFrame.width=e.x;this._textureFrame.height=e.y;this._renderTargets.forEach(t=>t.resizeTo(e))}getFilterStack(){return this._filterStack}setFilterStack(e){this._filterStack=e}_getOrCreateRenderTarget(e=false){let t=this._renderTargets.pop();if(!t){t=new Gi(this._renderer,this._textureFrame.width,this._textureFrame.height,1)}if(this._currentFrame){t.setFrame(this._currentFrame)}if(e){t.clear()}return t}pushFilters(e,t){const i=e.getBounds();this._currentFrame=i;const r=e.getFilterRectangle();if(r.width>0&&r.height>0){this._currentFrame=r}const o=this._getOrCreateRenderTarget();this._renderer.setRenderTarget(o);const n=t[0]instanceof So;if(n){o.clear(this._renderer.getClearColor())}else{o.clear()}this._filterStack.push({renderTarget:o,filters:t})}popFilters(){const e=this._filterStack.pop();if(!e)return void 0;const{filters:t,renderTarget:i}=e;const r=this._filterStack[this._filterStack.length-1];const o=i;const n=r.renderTarget;const a=o.getFrame();if(a){this._quad.map(this._textureFrame,a)}const l=t[0].getShaderForRenderer(this._renderer);const u=this._quad.getVertexBuffer();const c=this._quad.getIndexBuffer();const h=this._renderer.getContext();h.bindBuffer(h.ARRAY_BUFFER,u);h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,c);const m=l.getAttributeLocations();h.vertexAttribPointer(m.a_position,2,h.FLOAT,false,0,0);h.vertexAttribPointer(m.a_texCoord,2,h.FLOAT,false,0,2*4*4);h.vertexAttribPointer(m.a_color,4,h.FLOAT,false,0,4*4*4);this._renderer.updateTexture(o.getBaseTexture(),false);if(t.length===1){t[0].apply(this._renderer,o,n);this._renderTargets.push(o)}else{this._applyFilters(t,o,n)}return t}_applyFilters(e,t,i){let r=t;let o=this._getOrCreateRenderTarget(true);this._renderer.updateTexture(o.getBaseTexture(),false);const n=e[e.length-1];e.forEach(a=>{const l=a===n;if(!l){a.apply(this._renderer,r,o,true);const u=r;r=o;o=u}else{a.apply(this._renderer,r,i,true)}});this._renderTargets.push(r);this._renderTargets.push(o)}_onContextChange(){this._renderTargets.length=0;if(yo(this._renderer)){if(this._quad){this._quad.dispose()}this._quad=new Km(this._renderer.getContext())}}dispose(){this._renderer.off("context",this._onContextChange);if(this._quad){this._quad.dispose()}this._renderTargets.forEach(e=>{e.dispose()})}}});var S_=we((Sz,Ym)=>{var Xn=function(){function s(c){i.appendChild(c.dom);return c}function e(c){for(var h=0;h<i.children.length;h++)i.children[h].style.display=h===c?"block":"none";t=c}var t=0,i=document.createElement("div");i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000";i.addEventListener("click",function(c){c.preventDefault();e(++t%i.children.length)},false);var r=(performance||Date).now(),o=r,n=0,a=s(new Xn.Panel("FPS","#0ff","#002")),l=s(new Xn.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=s(new Xn.Panel("MB","#f08","#201"));e(0);return{REVISION:16,dom:i,addPanel:s,showPanel:e,begin:function(){r=(performance||Date).now()},end:function(){n++;var c=(performance||Date).now();l.update(c-r,200);if(c>o+1e3&&(a.update(1e3*n/(c-o),100),o=c,n=0,u)){var h=performance.memory;u.update(h.usedJSHeapSize/1048576,h.jsHeapSizeLimit/1048576)}return c},update:function(){r=this.end()},domElement:i,setMode:e}};Xn.Panel=function(s,e,t){var i=Infinity,r=0,o=Math.round,n=o(window.devicePixelRatio||1),a=80*n,l=48*n,u=3*n,c=2*n,h=3*n,m=15*n,d=74*n,f=30*n,b=document.createElement("canvas");b.width=a;b.height=l;b.style.cssText="width:80px;height:48px";var y=b.getContext("2d");y.font="bold "+9*n+"px Helvetica,Arial,sans-serif";y.textBaseline="top";y.fillStyle=t;y.fillRect(0,0,a,l);y.fillStyle=e;y.fillText(s,u,c);y.fillRect(h,m,d,f);y.fillStyle=t;y.globalAlpha=.9;y.fillRect(h,m,d,f);return{dom:b,update:function(g,C){i=Math.min(i,g);r=Math.max(r,g);y.fillStyle=t;y.globalAlpha=1;y.fillRect(0,0,a,m);y.fillStyle=e;y.fillText(o(g)+" "+s+" ("+o(i)+"-"+o(r)+")",u,c);y.drawImage(b,h+n,m,d-n,f,h,m,d-n,f);y.fillRect(h+d-n,m,n,f);y.fillStyle=t;y.globalAlpha=.9;y.fillRect(h+d-n,m,n,o((1-g/C)*f))}}};typeof Ym==="object"&&(Ym.exports=Xn)});var yr,xl;var F_=_(()=>{yr=Ur(S_());xl=class{constructor(e){this._context=e;this._domAvailable=typeof document!=="undefined";this._hookIntoContext();this._textures={};this._framebuffers={};this._programs={};this._shaders={};this._buffers={};this._boundTexture=null;this._id=0;this._enums={};this._setupStats();this._createEnumMap();this._updateMemoryStats=this._updateMemoryStats.bind(this);this._updateMemoryStats()}_createEnumMap(){for(const e in this._context){const t=this._context[e];if(typeof t==="number"){this._enums[t]=e}}}_enumValueToString(e){const t=this._enums[e];return typeof t==="undefined"?e:t}_setupStats(){if(!this._domAvailable)return;this._stats=new yr.default;this._stats.showPanel(3);this._memPanel=this._stats.addPanel(new yr.default.Panel("MB [WebGL]","#43ADEB","#282828"));this._texPanel=this._stats.addPanel(new yr.default.Panel("Textures","#43ADEB","#282828"));this._bufPanel=this._stats.addPanel(new yr.default.Panel("Buffers","#43ADEB","#282828"));this._fboPanel=this._stats.addPanel(new yr.default.Panel("FBOs","#43ADEB","#282828"));this._prgPanel=this._stats.addPanel(new yr.default.Panel("Programs","#43ADEB","#282828"));this._shdPanel=this._stats.addPanel(new yr.default.Panel("Shaders","#43ADEB","#282828"))}_updatePanel(e){if(!this._domAvailable)return;this._stats.begin();switch(e){case"tex":this._texPanel.update(this.getTexturesCount(),50);break;case"buf":this._bufPanel.update(this.getBuffersCount(),50);break;case"fbo":this._fboPanel.update(this.getFBOCount(),50);break;case"prg":this._prgPanel.update(this.getProgramCount(),50);break;case"shd":this._shdPanel.update(this.getShaderCount(),50);break}this._stats.end()}getTexturesCount(){return Object.keys(this._textures).length}getBuffersCount(){return Object.keys(this._buffers).length}getFBOCount(){return Object.keys(this._framebuffers).length}getProgramCount(){return Object.keys(this._programs).length}getShaderCount(){return Object.keys(this._shaders).length}_updateMemoryStats(){if(!this._domAvailable)return;const e=this._getMemoryUsage()/1e3/1e3;this._memPanel.update(e,400);setTimeout(this._updateMemoryStats,1e3)}_getMemoryUsage(){let e=0;for(const t in this._textures){e+=this._textures[t].memory}for(const t in this._buffers){e+=this._buffers[t].memory}return e}_hookIntoContext(){for(const e in this._context){const t=this._context[e];if(typeof t==="function"){this[e]=function(...i){const r=this._context[e];return this._trackGLCall(r,e,i)}}else{this._makePropertyWrapper(e)}}}_makePropertyWrapper(e){const t=["_context"];if(t.indexOf(e)!==-1)return;const i=this._context;this.__defineGetter__(e,()=>{return i[e]});this.__defineSetter__(e,r=>{i[e]=r})}_trackGLCall(e,t,i){const r=["texImage2D","bindTexture","createTexture","deleteTexture","createBuffer","bindBuffer","bufferData","deleteBuffer","createFramebuffer","deleteFramebuffer","createProgram","deleteProgram","createShader","deleteShader"];let o;if(r.indexOf(t)!==-1){o=this[`_${t}`](i)}else{o=e.apply(this._context,i)}const n=this._context.getError();if(n!==0){let a=i.join(", ");if(a.length>100){a=`${a.substr(0,100)}...`}console.error(new Error(`WebGL Error ${this._enumValueToString(n)} in ${t}(${a})`))}return o}_createProgram(){const e=this._context.createProgram();e._wmmId=this._id++;this._programs[e._wmmId]=e;this._updatePanel("prg");return e}_deleteProgram([e]){if(!e||!this._programs[e._wmmId])return;delete this._programs[e._wmmId];this._context.deleteProgram(e);this._updatePanel("prg")}_createShader([e]){const t=this._context.createShader(e);t._wmmId=this._id++;this._shaders[t._wmmId]=t;this._updatePanel("shd");return t}_deleteShader([e]){if(!e||!this._shaders[e._wmmId])return;delete this._shaders[e._wmmId];this._context.deleteShader(e);this._updatePanel("shd")}_createFramebuffer(){const e=this._context.createFramebuffer();e._wmmId=this._id++;this._framebuffers[e._wmmId]=e;this._updatePanel("fbo");return e}_deleteFramebuffer([e]){if(!e||!this._framebuffers[e._wmmId])return;delete this._framebuffers[e._wmmId];this._context.deleteFramebuffer(e);this._updatePanel("fbo")}_createBuffer(){const e=this._context.createBuffer();e._wmmId=this._id++;this._buffers[e._wmmId]={buffer:e,memory:0};this._updatePanel("buf");return e}_bindBuffer([e,t]){this._context.bindBuffer(e,t);this._boundBuffer=t._wmmId}_bufferData([e,t,i]){this._context.bufferData(e,t,i);let r;if(typeof t==="number"){r=t}else if("byteLength"in t){r=t.byteLength}else if("length"in t){r=t.length}this._buffers[this._boundBuffer].memory=r}_deleteBuffer([e]){if(!e||!this._buffers[e._wmmId])return;delete this._buffers[e._wmmId];this._context.deleteBuffer(e);this._updatePanel("buf")}_createTexture(){const e=this._context.createTexture();e._wmmId=this._id++;this._textures[e._wmmId]={texture:e,memory:0};this._updatePanel("tex");return e}_deleteTexture([e]){if(!e||!this._textures[e._wmmId])return;delete this._textures[e._wmmId];this._context.deleteTexture(e);this._updatePanel("tex")}_bindTexture([e,t]){this._context.bindTexture(e,t);this._boundTexture=t._wmmId}_texImage2D(e){let[,,t,i,r,o,,,n]=e;if(typeof n==="undefined"){n=o}this._context.texImage2D.apply(this._context,e);const a=this._calculateByteCountForTexture(t,i,r,n);this._textures[this._boundTexture].memory=a}_calculateByteCountForTexture(e,t,i,r){if(r!==null){if("width"in r){t=r.width;i=r.height}else{return r.length}}let o=1;switch(e){case this._context.ALPHA:o=1;break;case this._context.RGB:o=3;break;case this._context.RGBA:o=4;break}return t*i*o}}});var Yn;var Jm=_(()=>{Yn=class{constructor(e){this._renderer=e;this._onContextChange=this._onContextChange.bind(this);this._renderer.on("context",this._onContextChange)}_onContextChange(){}start(){}stop(){this.flush()}flush(){}dispose(){this._renderer.off("context",this._onContextChange);delete this._renderer}}});var $m;var O_=_(()=>{Ue();Jm();$m=class extends Yn{constructor(e){super(e);this._vertexBuffer=null;this._indexBuffer=null;this._maxBatchSize=ko;this._vertices=new ArrayBuffer(ko*4*fr);this._positions=new Float32Array(this._vertices);this._colors=new Uint32Array(this._vertices);this._indices=new Uint16Array(ko*6);for(let t=0,i=0;t<ko*6;t+=6,i+=4){this._indices[t+0]=i+0;this._indices[t+1]=i+1;this._indices[t+2]=i+2;this._indices[t+3]=i+0;this._indices[t+4]=i+2;this._indices[t+5]=i+3}this._sprites=[];this._currentBatchSize=0;this._onContextChange()}render(e){const t=e.getTexture();if(!t)return;const i=t.getFrame();const r=t.getBaseTexture();if(this._currentBatchSize>=this._maxBatchSize){this.flush()}const o=t.getUVs();if(!o){return}const n=this._currentBatchSize*fr;this._addVertexCoordinates(e,n,i);this._addTextureUVs(e,n,o);this._addColors(e,n);this._sprites[this._currentBatchSize]=e;this._currentBatchSize++}_addColors(e,t){const i=this._colors;const r=16777215;const o=(r>>16)+(r&65280)+((r&255)<<16)+(e.getWorldAlpha()*255<<24);i[t+4]=i[t+9]=i[t+14]=i[t+19]=o}_addTextureUVs(e,t,i){const r=this._positions;const[o,n,a,l]=i;r[t+2]=o.x;r[t+3]=o.y;r[t+7]=n.x;r[t+8]=n.y;r[t+12]=a.x;r[t+13]=a.y;r[t+17]=l.x;r[t+18]=l.y}_addVertexCoordinates(e,t,i){const r=this._positions;const o=e.getWorldTransform();const n=e.getAnchor();const a=o.rectangleToCoordinates(i,n);const l=5;for(let u=0;u<4;u++){r[t+u*l]=a[u].x;r[t+u*l+1]=a[u].y}}_onContextChange(){const e=this._renderer.getContext();this._shader=this._renderer.shaders.default;if(this._vertexBuffer){this._vertexBuffer=null}if(this._indexBuffer){this._indexBuffer=null}this._vertexBuffer=e.createBuffer();this._indexBuffer=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this._indexBuffer);e.bufferData(e.ELEMENT_ARRAY_BUFFER,this._indices,e.STATIC_DRAW);e.bindBuffer(e.ARRAY_BUFFER,this._vertexBuffer);e.bufferData(e.ARRAY_BUFFER,this._vertices,e.DYNAMIC_DRAW)}start(){if(this._vertexBuffer&&this._indexBuffer){this._shader.setupBuffers(this._vertexBuffer,this._indexBuffer)}}flush(){var m;const e=this._renderer;const t=e.getContext();if(this._currentBatchSize===0){return}if(this._currentBatchSize>ko*.5){t.bufferSubData(t.ARRAY_BUFFER,0,this._vertices)}else{const d=this._positions.subarray(0,this._currentBatchSize*fr);t.bufferSubData(t.ARRAY_BUFFER,0,d)}let i=0;let r=null;let o=null;let n=null;let a=null;let l=false;let u=false;let c=null;let h=0;for(let d=0,f=this._currentBatchSize;d<f;d++){c=this._sprites[d];o=(m=c.getTexture())==null?void 0:m.getBaseTexture();a=c.getShader()||this._shader;l=n!==a;u=r!==o;if(u||l){if(r){this._renderBatch(r,i,h)}h=d;i=0;r=o;if(l){n=a;e.setShader(n);const b=e.getCurrentRenderTarget();const y=b.getProjectionMatrix().toArray();n.setUniform("u_projMatrix",y);n.syncUniforms();t.activeTexture(t.TEXTURE0)}}i++}if(r){this._renderBatch(r,i,h)}this._currentBatchSize=0;this._sprites=[]}_renderBatch(e,t,i){if(t===0){return}const r=this._renderer;const o=r.getContext();let n=e.getGLTextureForRenderer(r);if(!n){n=r.getOrCreateGLTexture(e)}if(e.isDirty()){r.updateTexture(e);e.setDirty(false)}o.activeTexture(o.TEXTURE0+e.getGLUnit());o.bindTexture(o.TEXTURE_2D,n);const a=t*6;const l=i*6*2;o.drawElements(o.TRIANGLES,a,o.UNSIGNED_SHORT,l)}dispose(){const e=this._renderer;const t=e.getContext();this._sprites.forEach(i=>{i.dispose()});if(this._vertexBuffer){t.deleteBuffer(this._vertexBuffer);this._vertexBuffer=null}if(this._indexBuffer){t.deleteBuffer(this._indexBuffer);this._indexBuffer=null}delete this._vertices;delete this._positions;delete this._colors;delete this._indices;super.dispose()}}});var Zm,vl;var A_=_(()=>{R_();ei();Ft();fl();Ue();Xm();zm();jm();di();qn();F_();Hm();Jm();O_();Zm=class extends Hn{constructor(e=800,t=600,i){super(e,t,i);this.type=H.WEBGL;this.maxTextureDimensions=null;this._type=H.WEBGL;this._onContextLost=this._onContextLost.bind(this);this._onContextRestored=this._onContextRestored.bind(this);this.setCanvas(this._options.canvas||Je.createCanvas());this.shaders={default:new Lm(this,void 0,void 0)};this.renderers={sprite:new $m(this)}}_onContextLost(e){e.preventDefault();P.warn(this.constructor.name,"WebGL context has been lost - trying to restore.");this.emit("context-lost")}_onContextCreationError(e){e.preventDefault();P.warn(this.constructor.name,`Failed to create WebGL context: ${e.statusMessage||"Unknown error"}`)}_onContextRestored(){P.warn(this.constructor.name,"WebGL context has been restored. Clearing all textures.");this._createContext();this._setupContext();this.emit("context-restored")}_onBeforeContext(){if(this._filterManager){this._filterManager.dispose()}this._filterManager=new Kn(this);this._currentObjectRenderer=new Yn(this)}setShader(e){this._currentShader=e;this._context.useProgram(e.getProgram());this._setAttributesForShader(e)}setCanvas(e){if(this._canvas){this._removeContextEventListeners()}super.setCanvas(e);this._addContextEventListeners()}_addContextEventListeners(){if(Cm(this._canvas)){this._canvas.addEventListener("webglcontextlost",this._onContextLost);this._canvas.addEventListener("webglcontextrestored",this._onContextRestored);this._canvas.addEventListener("webglcontextcreationerror",this._onContextCreationError)}}_removeContextEventListeners(){if(Cm(this._canvas)){this._canvas.removeEventListener("webglcontextlost",this._onContextLost);this._canvas.removeEventListener("webglcontextrestored",this._onContextRestored);this._canvas.removeEventListener("webglcontextcreationerror",this._onContextCreationError)}}_setAttributesForShader(e){if(!this._canvas)return;const t=this._context;const i=e.getAttributes();const r=e.getAttributeLocations();i.forEach(o=>{const n=r[o];t.enableVertexAttribArray(n)})}_createContext(){if(!this._canvas)return;let e=Je.glGet(this._canvas);if(this._options.debug){T_(e)}if(this._options.debug){e=new bl(e);e=new xl(e)}this.id=Zm.contextId++;this._context=e;this._maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE);this.emit("context",e);return e}_setupContext(){const e=this._context;e.disable(e.DEPTH_TEST);e.disable(e.CULL_FACE);e.enable(e.BLEND);e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA);this._defaultRenderTarget=new Gi(this,this._width,this._height,this._pixelRatio,true);this.setRenderTarget(this._defaultRenderTarget);this._getMaxPrecision()}getContext(){return this._context}_getMaxPrecision(){const e=this._context;const t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);this._maxFloatPrecision=(t==null?void 0:t.precision)!==0?zt.High:zt.Medium;const i=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_INT);this._maxIntPrecision=(i==null?void 0:i.rangeMax)!==0?zt.High:zt.Low}resizeTo(e,t=true){super.resizeTo(e,t);if(this._currentRenderTarget){this._currentRenderTarget.resizeTo(e)}this._context=Je.glResize(this._context,e)}setRenderTarget(e=this._defaultRenderTarget){this._currentRenderTarget=e;this._currentRenderTarget.activate()}setObjectRenderer(e){this._currentObjectRenderer.stop();this._currentObjectRenderer=e;this._currentObjectRenderer.start()}render(e){this.setRenderTarget(this._defaultRenderTarget);this._defaultRenderTarget.clear(this._clearColor);const t=e.getParent();e.setParent(new rs);e.updateTransform();if(t){e.setParent(t)}this.renderDisplayObject(e,this._defaultRenderTarget)}renderDisplayObject(e,t){this.setRenderTarget(t);this._filterManager.setFilterStack(t.getFilterStack());e.renderWebGL(this);this._currentObjectRenderer.flush()}clear(){const e=this._context;e.clearColor.apply(e,this._clearColor.toGLColor);e.clear(e.COLOR_BUFFER_BIT)}save(){return{renderTarget:this._currentRenderTarget,objectRenderer:this._currentObjectRenderer,filterStack:this._filterManager.getFilterStack()}}restore(e){this.setRenderTarget(e.renderTarget);this._filterManager.setFilterStack(e.filterStack);this._currentObjectRenderer=e.objectRenderer}getOrCreateGLTexture(e){const t=this._context;let i=e.getGLTextureForRenderer(this);if(!i){i=t.createTexture();e.setGLTextureForRenderer(i,this)}return i}updateTexture(e,t=true){const i=e.getSource();const r=this._context;const o=e.getGLUnit();const n=this.getOrCreateGLTexture(e);r.activeTexture(r.TEXTURE0+o);r.bindTexture(r.TEXTURE_2D,n);r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);if(t&&i){Je.glTexImage(r,i)}if(e.isMipMappingEnabled()){r.generateMipmap(r.TEXTURE_2D)}else{r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,e.getGLRepeat(r,"x"));r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,e.getGLRepeat(r,"y"))}r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,e.getGLFilter(r,"min"));r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,e.getGLFilter(r,"mag"));r.activeTexture(r.TEXTURE0)}getMaxDimensions(){if(!this.maxTextureDimensions){this.maxTextureDimensions=Je.glMaxTexture(this._context)}return this.maxTextureDimensions}getCurrentRenderTarget(){return this._currentRenderTarget}getCurrentObjectRenderer(){return this._currentObjectRenderer}getMaxFloatPrecision(){return this._maxFloatPrecision}getMaxIntPrecision(){return this._maxIntPrecision}dispose(){if(this._canvas){ke(this._canvas)}this._filterManager.dispose();this._currentObjectRenderer.dispose();this._defaultRenderTarget.dispose();for(const i in this.shaders){this.shaders[i].dispose();delete this.shaders[i]}this._removeContextEventListeners();const e=this._context;const t=e.getExtension("WEBGL_lose_context");if(t){t.loseContext()}}};vl=Zm;vl.contextId=0});var ST,FT,Qm;var I_=_(()=>{zi();ST=()=>[new L(0,0),new L(1,0),new L(1,1),new L(0,1)];FT=(s,e,t)=>{const[i,r,o,n]=s;i.x=e.x/t.width;i.y=e.y/t.height;r.x=(e.x+e.width)/t.width;r.y=e.y/t.height;o.x=(e.x+e.width)/t.width;o.y=(e.y+e.height)/t.height;n.x=e.x/t.width;n.y=(e.y+e.height)/t.height;return s};Qm={create:ST,updateViaFrames:FT}});var br;var ed=_(()=>{I_();Ue();Oo();br=class extends mt{constructor(e,t){super();if(!(e instanceof ze)){throw new Error("`baseTexture` should be an instance of BaseTexture")}this._uvs=Qm.create();this._frame=t?t.clone():new be(0,0,1,1);this._frameLocked=Boolean(t);this._onBaseTextureLoaded=this._onBaseTextureLoaded.bind(this);this._onBaseTextureUpdated=this._onBaseTextureUpdated.bind(this);this.setBaseTexture(e)}static fromImage(e){const t=new ze(e);return new br(t)}static fromCanvas(e){const t=new ze(e);return new br(t)}_onBaseTextureLoaded(){if(!this._frameLocked){const e=this._baseTexture.getFrame().clone();this.setFrame(e)}this._baseTexture.on("update",this._onBaseTextureUpdated)}_onBaseTextureUpdated(){const{width:e,height:t}=this._baseTexture.getFrame();this._frame.width=e;this._frame.height=t;this.emit("update")}_updateUVs(){this._uvs=Qm.updateViaFrames(this._uvs,this._frame,this._baseTexture.getFrame())}getBaseTexture(){return this._baseTexture}setBaseTexture(e){this._baseTexture=e;if(!this._baseTexture.isLoaded()){this._baseTexture.once("loaded",this._onBaseTextureLoaded)}else{const{width:t,height:i}=e.getFrame();if(!this._frameLocked){this._frame=new be(0,0,t,i)}this._onBaseTextureLoaded()}}getFrame(){return this._frame}setFrame(e){this._frame=e;this._updateUVs()}getWidth(){return this._frame.width}getHeight(){return this._frame.height}getUVs(){return this._uvs}getDimensions(){return new L(this._frame.width,this._frame.height)}dispose(e=true){e&&this._baseTexture.dispose()}}});var Jn,$n;var td=_(()=>{Ft();Ue();yl();Xm();Wn();qn();Oo();ed();Jn=s=>s._type===H.WEBGL;$n=class extends br{constructor(e,t=100,i=100,r=1){super(new ze,new be(0,0,t,i));this._loaded=true;this._width=t;this._height=i;this._pixelRatio=r;this._renderer=e;this._setupFilterManager();this._setupBuffer();this.setBaseTexture(this._renderTarget.getBaseTexture());this._updateUVs()}_setupFilterManager(){if(this._filterManager){this._filterManager.dispose()}if(Jn(this._renderer)){this._filterManager=new Kn(this._renderer)}else{this._filterManager=new ss(this._renderer)}this._filterManager.resizeTo(new L(this._width,this._height))}_setupBuffer(){if(this._renderTarget){this._renderTarget.dispose()}if(Jn(this._renderer)){this._renderTarget=new Gi(this._renderer,this._width,this._height,this._pixelRatio)}else{this._renderTarget=new Ni(this._width,this._height,this._pixelRatio)}}clear(e){this._renderTarget.clear(e)}resizeTo(e){if(this._width===e.x&&this._height===e.y){return}this._width=e.x;this._height=e.y;this._frame.width=e.x;this._frame.height=e.y;this._renderTarget.resizeTo(e);this._filterManager.resizeTo(e)}render(e){if(Jn(this._renderer)){this._renderWebGL(e)}else{this._renderCanvas(e)}}_renderWebGL(e){if(!Jn(this._renderer))return;this._renderTarget.activate();e.getWorldTransform().reset();e.getChildren().forEach(i=>{i.updateTransform()});const t=this._renderer.getFilterManager();this._renderer.setFilterManager(this._filterManager);this._renderer.renderDisplayObject(e,this._renderTarget);this._renderer.setFilterManager(t)}_renderCanvas(e){if(Jn(this._renderer))return;e.getWorldTransform().reset();e.getChildren().forEach(i=>{i.updateTransform()});const t=this._renderer.getFilterManager();this._renderer.setFilterManager(this._filterManager);this._renderer.renderDisplayObject(e,this._renderTarget);this._renderer.setFilterManager(t)}getRenderTarget(){return this._renderTarget}dispose(){this._renderTarget.dispose();this._filterManager.dispose();super.dispose()}}});var Io,Wi;var Zn=_(()=>{Io={EXPORT:"export",CLOSE:"close",OPERATION_CREATED:"operation:created",OPERATION_UPDATED:"operation:updated",OPERATION_REMOVED:"operation:removed",EDITOR_READY:"editor:ready",WINDOW_RESIZE:"window:resize",ZOOM_DONE:"editor:zoom_done",HISTORY_UNDO:"history:undo",HISTORY_UPDATED:"history:update",FEATURES_DISABLED:"editor:features:disabled",FEATURES_ENABLED:"editor:features:enabled",FEATURES_UPDATED:"editor:features:updated",TRANSFORM_REAPPLY_RATIO:"transform:reapply_ratio"};Wi={DEFAULTS:{FILTERS:[{identifier:"imgly_filters_duotone",defaultName:"DuoTone",assetFileName:"duotone",filters:[{identifier:"imgly_duotone_desert",defaultName:"Desert",lightColor:"#e1de9a",darkColor:"#cb2129"},{identifier:"imgly_duotone_peach",defaultName:"Peach",lightColor:"#e9abb8",darkColor:"#0040ff"},{identifier:"imgly_duotone_clash",defaultName:"Clash",lightColor:"#f41a0f",darkColor:"#23007c"},{identifier:"imgly_duotone_plum",defaultName:"Plum",lightColor:"#74d7ff",darkColor:"#23007c"},{identifier:"imgly_duotone_breezy",defaultName:"Breezy",lightColor:"#68fdff",darkColor:"#c20000"},{identifier:"imgly_duotone_deepblue",defaultName:"Deep Blue",lightColor:"#2de9eb",darkColor:"#58007c"},{identifier:"imgly_duotone_frog",defaultName:"Frog",lightColor:"#5bff60",darkColor:"#7f23a9"},{identifier:"imgly_duotone_sunset",defaultName:"Sunset",lightColor:"#f8ea46",darkColor:"#c400be"}]},{identifier:"imgly_filters_bw",assetFileName:"b&w",defaultName:"Black & White",filters:[{identifier:"imgly_lut_ad1920",defaultName:"1920 A.D.",lutImage:"filters/imgly_lut_ad1920_5_5_128.png"},{identifier:"imgly_lut_bw",defaultName:"Greyed",lutImage:"filters/imgly_lut_bw_5_5_128.png"},{identifier:"imgly_lut_x400",defaultName:"Dusty",lutImage:"filters/imgly_lut_dusty_5_5_128.png"},{identifier:"imgly_lut_litho",defaultName:"Litho",lutImage:"filters/imgly_lut_litho_5_5_128.png"},{identifier:"imgly_lut_sepiahigh",defaultName:"Sepia",lutImage:"filters/imgly_lut_sepia_5_5_128.png"},{identifier:"imgly_lut_plate",defaultName:"Weathered",lutImage:"filters/imgly_lut_weathered_5_5_128.png"},{identifier:"imgly_lut_sin",defaultName:"Hard Stuff",lutImage:"filters/imgly_lut_hard_stuff_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8}]},{identifier:"imgly_filters_retro",assetFileName:"vintage",defaultName:"Vintage",filters:[{identifier:"imgly_lut_blues",defaultName:"Polaroid",lutImage:"filters/imgly_lut_polaroid_5_5_128.png"},{identifier:"imgly_lut_front",defaultName:"Sunny 70s",lutImage:"filters/imgly_lut_sunny_70s_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_texas",defaultName:"Oldtimer",lutImage:"filters/imgly_lut_oldtimer_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_celsius",defaultName:"Inferno",lutImage:"filters/imgly_lut_inferno_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_cool",defaultName:"Snappy",lutImage:"filters/imgly_lut_snappy_5_5_128.png"}]},{identifier:"imgly_filters_analog",assetFileName:"smooth",defaultName:"Smooth",filters:[{identifier:"imgly_lut_chest",defaultName:"Chestnut",lutImage:"filters/imgly_lut_chestnut_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_winter",defaultName:"Softly",lutImage:"filters/imgly_lut_softly_5_5_128.png"},{identifier:"imgly_lut_kdynamic",defaultName:"Pebble",lutImage:"filters/imgly_lut_pebble_5_5_128.png"},{identifier:"imgly_lut_fall",defaultName:"Moss",lutImage:"filters/imgly_lut_moss_5_5_128.png"},{identifier:"imgly_lut_lenin",defaultName:"Lemon",lutImage:"filters/imgly_lut_lemon_5_5_128.png"},{identifier:"imgly_lut_pola669",defaultName:"Green Gap",lutImage:"filters/imgly_lut_green_gap_5_5_128.png"}]},{identifier:"imgly_filters_winter",assetFileName:"cold",defaultName:"Cold",filters:[{identifier:"imgly_lut_elder",defaultName:"Colla",lutImage:"filters/imgly_lut_colla_5_5_128.png"},{identifier:"imgly_lut_orchid",defaultName:"Solanus",lutImage:"filters/imgly_lut_solanus_5_5_128.png"},{identifier:"imgly_lut_bleached",defaultName:"Kalmen",lutImage:"filters/imgly_lut_kalmen_5_5_128.png"},{identifier:"imgly_lut_bleachedblue",defaultName:"Joran",lutImage:"filters/imgly_lut_joran_5_5_128.png"},{identifier:"imgly_lut_breeze",defaultName:"Levante",lutImage:"filters/imgly_lut_levante_5_5_128.png"},{identifier:"imgly_lut_blueshadows",defaultName:"Zephyr",lutImage:"filters/imgly_lut_zephyr_5_5_128.png"}]},{identifier:"imgly_filters_summer",assetFileName:"warm",defaultName:"Warm",filters:[{identifier:"imgly_lut_sunset",defaultName:"Golden",lutImage:"filters/imgly_lut_golden_5_5_128.png"},{identifier:"imgly_lut_eighties",defaultName:"Low Fire",lutImage:"filters/imgly_lut_low_fire_5_5_128.png"},{identifier:"imgly_lut_evening",defaultName:"Sunrise",lutImage:"filters/imgly_lut_sunrise_5_5_128.png"},{identifier:"imgly_lut_k2",defaultName:"Flat Black",lutImage:"filters/imgly_lut_flat_black_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_nogreen",defaultName:"Pumpkin",lutImage:"filters/imgly_lut_pumpkin_5_5_128.png"}]},{identifier:"imgly_filters_legacy",defaultName:"Legacy",assetFileName:"legacy",filters:[{identifier:"imgly_lut_ancient",defaultName:"Ancient",lutImage:"filters/imgly_lut_ancient_5_5_128.png"},{identifier:"imgly_lut_cottoncandy",defaultName:"Candy",lutImage:"filters/imgly_lut_cottoncandy_5_5_128.png"},{identifier:"imgly_lut_classic",defaultName:"Classic",lutImage:"filters/imgly_lut_classic_5_5_128.png"},{identifier:"imgly_lut_colorful",defaultName:"Colorful",lutImage:"filters/imgly_lut_colorful_5_5_128.png"},{identifier:"imgly_lut_creamy",defaultName:"Creamy",lutImage:"filters/imgly_lut_creamy_5_5_128.png"},{identifier:"imgly_lut_fixie",defaultName:"Fixie",lutImage:"filters/imgly_lut_fixie_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_food",defaultName:"Food",lutImage:"filters/imgly_lut_food_5_5_128.png"},{identifier:"imgly_lut_fridge",defaultName:"Fridge",lutImage:"filters/imgly_lut_fridge_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_glam",defaultName:"Glam",lutImage:"filters/imgly_lut_glam_5_5_128.png"},{identifier:"imgly_lut_gobblin",defaultName:"Gobblin",lutImage:"filters/imgly_lut_gobblin_5_5_128.png"},{identifier:"imgly_lut_highcontrast",defaultName:"Hicon",lutImage:"filters/imgly_lut_highcontrast_5_5_128.png"},{identifier:"imgly_lut_highcarb",defaultName:"High Carb",lutImage:"filters/imgly_lut_highcarb_5_5_128.png"},{identifier:"imgly_lut_k1",defaultName:"K1",lutImage:"filters/imgly_lut_k1_5_5_128.png"},{identifier:"imgly_lut_k6",defaultName:"K6",lutImage:"filters/imgly_lut_k6_5_5_128.png"},{identifier:"imgly_lut_keen",defaultName:"Keen",lutImage:"filters/imgly_lut_keen_5_5_128.png"},{identifier:"imgly_lut_lomo",defaultName:"Lomo",lutImage:"filters/imgly_lut_lomo_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_lomo100",defaultName:"Lomo 100",lutImage:"filters/imgly_lut_lomo100_5_5_128.png"},{identifier:"imgly_lut_lucid",defaultName:"Lucid",lutImage:"filters/imgly_lut_lucid_5_5_128.png"},{identifier:"imgly_lut_mellow",defaultName:"Mellow",lutImage:"filters/imgly_lut_mellow_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_neat",defaultName:"Neat",lutImage:"filters/imgly_lut_neat_5_5_128.png"},{identifier:"imgly_lut_pale",defaultName:"Pale",lutImage:"filters/imgly_lut_pale_5_5_128.png"},{identifier:"imgly_lut_pitched",defaultName:"Pitched",lutImage:"filters/imgly_lut_pitched_5_5_128.png"},{identifier:"imgly_lut_polasx",defaultName:"Pola SX",lutImage:"filters/imgly_lut_polasx_5_5_128.png"},{identifier:"imgly_lut_pro400",defaultName:"Pro 400",lutImage:"filters/imgly_lut_pro400_5_5_128.png"},{identifier:"imgly_lut_quozi",defaultName:"Quozi",lutImage:"filters/imgly_lut_quozi_5_5_128.png"},{identifier:"imgly_lut_settled",defaultName:"Settled",lutImage:"filters/imgly_lut_settled_5_5_128.png"},{identifier:"imgly_lut_seventies",defaultName:"Seventies",lutImage:"filters/imgly_lut_seventies_5_5_128.png"},{identifier:"imgly_lut_soft",defaultName:"Soft",lutImage:"filters/imgly_lut_soft_5_5_128.png"},{identifier:"imgly_lut_steel",defaultName:"Steel",lutImage:"filters/imgly_lut_steel_5_5_128.png"},{identifier:"imgly_lut_summer",defaultName:"Summer",lutImage:"filters/imgly_lut_summer_5_5_128.png"},{identifier:"imgly_lut_tender",defaultName:"Tender",lutImage:"filters/imgly_lut_tender_5_5_128.png"},{identifier:"imgly_lut_twilight",defaultName:"Twilight",lutImage:"filters/imgly_lut_twilight_5_5_128.png"}]}],OVERLAYS:[{identifier:"imgly_overlay_golden",defaultName:"Golden",image:"overlays/imgly_overlay_golden.jpg",thumbnail:"overlays/imgly_overlay_golden_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_bokeh",defaultName:"Bokeh",image:"overlays/imgly_overlay_bokeh.jpg",thumbnail:"overlays/imgly_overlay_bokeh_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_hearts",defaultName:"Hearts",image:"overlays/imgly_overlay_hearts.jpg",thumbnail:"overlays/imgly_overlay_hearts_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak1",defaultName:"Light Leak",image:"overlays/imgly_overlay_lightleak1.jpg",thumbnail:"overlays/imgly_overlay_lightleak1_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak2",defaultName:"Light Leak 2",image:"overlays/imgly_overlay_lightleak2.jpg",thumbnail:"overlays/imgly_overlay_lightleak2_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_rain",defaultName:"Rain",image:"overlays/imgly_overlay_rain.jpg",thumbnail:"overlays/imgly_overlay_rain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_wood",defaultName:"Wood",image:"overlays/imgly_overlay_wood.jpg",thumbnail:"overlays/imgly_overlay_wood_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_mosaic",defaultName:"Mosaic",image:"overlays/imgly_overlay_mosaic.jpg",thumbnail:"overlays/imgly_overlay_mosaic_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_chop",defaultName:"Chop",image:"overlays/imgly_overlay_chop.jpg",thumbnail:"overlays/imgly_overlay_chop_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_vintage",defaultName:"Vintage",image:"overlays/imgly_overlay_vintage.jpg",thumbnail:"overlays/imgly_overlay_vintage_thumb.jpg",blendMode:"darken"},{identifier:"imgly_overlay_metal",defaultName:"Metal",image:"overlays/imgly_overlay_metal.jpg",thumbnail:"overlays/imgly_overlay_metal_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_paper",defaultName:"Paper",image:"overlays/imgly_overlay_paper.jpg",thumbnail:"overlays/imgly_overlay_paper_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_painting",defaultName:"Painting",image:"overlays/imgly_overlay_painting.jpg",thumbnail:"overlays/imgly_overlay_painting_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_grain",defaultName:"Grain",image:"overlays/imgly_overlay_grain.jpg",thumbnail:"overlays/imgly_overlay_grain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_clouds",defaultName:"Clouds",image:"overlays/imgly_overlay_clouds.jpg",thumbnail:"overlays/imgly_overlay_clouds_thumb.jpg",blendMode:"softLight"},{identifier:"imgly_overlay_wall1",defaultName:"Wall",image:"overlays/imgly_overlay_wall1.jpg",thumbnail:"overlays/imgly_overlay_wall1_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_wall2",defaultName:"Wall 2",image:"overlays/imgly_overlay_wall2.jpg",thumbnail:"overlays/imgly_overlay_wall2_thumb.jpg",blendMode:"overlay"}],FRAME_CATEGORIES:[{identifier:"imgly_frame_generic",defaultName:"Generic",metaData:{backgroundImage:"frames/generic.png"},frames:[{identifier:"imgly_frame_dia",defaultName:"Dia",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_left.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_right.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",defaultName:"Art Decor",tintable:true,layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",defaultName:"Black Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",defaultName:"Low Poly",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",defaultName:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}}]}],STICKER_CATEGORIES:[{identifier:"imgly_sticker_emoticons",defaultName:"Emoticons",metaData:{backgroundImage:"stickers/emoticons/background.png"},stickers:[{identifier:"imgly_sticker_emoticons_alien",defaultName:"Alien",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_alien.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_alien.png"],width:1e3,height:935}}},{identifier:"imgly_sticker_emoticons_angel",defaultName:"Angel",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angel.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angel.png"]}}},{identifier:"imgly_sticker_emoticons_angry",defaultName:"Angry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angry.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angry.png"]}}},{identifier:"imgly_sticker_emoticons_anxious",defaultName:"Anxious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_anxious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_anxious.png"]}}},{identifier:"imgly_sticker_emoticons_asleep",defaultName:"Asleep",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_asleep.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_asleep.png"]}}},{identifier:"imgly_sticker_emoticons_attention",defaultName:"Attention",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_attention.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_attention.png"]}}},{identifier:"imgly_sticker_emoticons_baby_chicken",defaultName:"Baby Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_baby_chicken.png"],width:61,height:42},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_baby_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_batman",defaultName:"Batman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_batman.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_batman.png"]}}},{identifier:"imgly_sticker_emoticons_beer",defaultName:"Beer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_beer.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_beer.png"]}}},{identifier:"imgly_sticker_emoticons_blush",defaultName:"Blush",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_blush.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_blush.png"]}}},{identifier:"imgly_sticker_emoticons_boxer",defaultName:"Boxer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_boxer.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_boxer.png"]}}},{identifier:"imgly_sticker_emoticons_business",defaultName:"Business",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_business.png"],width:60,height:63},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_business.png"]}}},{identifier:"imgly_sticker_emoticons_chicken",defaultName:"Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_chicken.png"],width:63,height:55},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_chicken.png"]}}},{identifier:"imgly_sticker_emoticons_cool",defaultName:"Cool",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cool.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cool.png"]}}},{identifier:"imgly_sticker_emoticons_cry",defaultName:"Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cry.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cry.png"]}}},{identifier:"imgly_sticker_emoticons_deceased",defaultName:"Deceased",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_deceased.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_deceased.png"]}}},{identifier:"imgly_sticker_emoticons_devil",defaultName:"Devil",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_devil.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_devil.png"]}}},{identifier:"imgly_sticker_emoticons_duckface",defaultName:"Duckface",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_duckface.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_duckface.png"]}}},{identifier:"imgly_sticker_emoticons_furious",defaultName:"Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_furious.png"],width:62,height:61},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_furious.png"]}}},{identifier:"imgly_sticker_emoticons_grin",defaultName:"Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_grin.png"]}}},{identifier:"imgly_sticker_emoticons_guitar",defaultName:"Guitar",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_guitar.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_guitar.png"]}}},{identifier:"imgly_sticker_emoticons_harry_potter",defaultName:"Harry Potter",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_harry_potter.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_harry_potter.png"]}}},{identifier:"imgly_sticker_emoticons_hippie",defaultName:"Hippie",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hippie.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hippie.png"]}}},{identifier:"imgly_sticker_emoticons_hitman",defaultName:"Hitman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hitman.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hitman.png"]}}},{identifier:"imgly_sticker_emoticons_humourous",defaultName:"Humourous",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_humourous.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_humourous.png"]}}},{identifier:"imgly_sticker_emoticons_idea",defaultName:"Idea",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_idea.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_idea.png"]}}},{identifier:"imgly_sticker_emoticons_impatient",defaultName:"Impatient",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_impatient.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_impatient.png"]}}},{identifier:"imgly_sticker_emoticons_kiss",defaultName:"Kiss",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kiss.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kiss.png"]}}},{identifier:"imgly_sticker_emoticons_kisses",defaultName:"Kisses",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kisses.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kisses.png"]}}},{identifier:"imgly_sticker_emoticons_laugh",defaultName:"Laugh",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_laugh.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_laugh.png"]}}},{identifier:"imgly_sticker_emoticons_loud_cry",defaultName:"Loud Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loud_cry.png"],width:64,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loud_cry.png"]}}},{identifier:"imgly_sticker_emoticons_loving",defaultName:"Loving",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loving.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loving.png"]}}},{identifier:"imgly_sticker_emoticons_masked",defaultName:"Masked",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_masked.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_masked.png"]}}},{identifier:"imgly_sticker_emoticons_music",defaultName:"Music",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_music.png"],width:62,height:54},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_music.png"]}}},{identifier:"imgly_sticker_emoticons_nerd",defaultName:"Nerd",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_nerd.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_nerd.png"]}}},{identifier:"imgly_sticker_emoticons_ninja",defaultName:"Ninja",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_ninja.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_ninja.png"]}}},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",defaultName:"Not Speaking To You",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_not_speaking_to_you.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_not_speaking_to_you.png"]}}},{identifier:"imgly_sticker_emoticons_pig",defaultName:"Pig",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pig.png"],width:63,height:41},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pig.png"]}}},{identifier:"imgly_sticker_emoticons_pumpkin",defaultName:"Pumpkin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pumpkin.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pumpkin.png"]}}},{identifier:"imgly_sticker_emoticons_question",defaultName:"Question",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_question.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_question.png"]}}},{identifier:"imgly_sticker_emoticons_rabbit",defaultName:"Rabbit",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_rabbit.png"],width:65,height:47},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_rabbit.png"]}}},{identifier:"imgly_sticker_emoticons_sad",defaultName:"Sad",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sad.png"]},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sad.png"]}}},{identifier:"imgly_sticker_emoticons_sick",defaultName:"Sick",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sick.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sick.png"]}}},{identifier:"imgly_sticker_emoticons_skateboard",defaultName:"Skateboard",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skateboard.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skateboard.png"]}}},{identifier:"imgly_sticker_emoticons_skull",defaultName:"Skull",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skull.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skull.png"]}}},{identifier:"imgly_sticker_emoticons_sleepy",defaultName:"Sleepy",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sleepy.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sleepy.png"]}}},{identifier:"imgly_sticker_emoticons_smile",defaultName:"Smile",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smile.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smile.png"]}}},{identifier:"imgly_sticker_emoticons_smoking",defaultName:"Smoking",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smoking.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smoking.png"]}}},{identifier:"imgly_sticker_emoticons_sobbing",defaultName:"Sobbing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sobbing.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sobbing.png"]}}},{identifier:"imgly_sticker_emoticons_star",defaultName:"Star",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_star.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_star.png"]}}},{identifier:"imgly_sticker_emoticons_steaming_furious",defaultName:"Steaming Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_steaming_furious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_steaming_furious.png"]}}},{identifier:"imgly_sticker_emoticons_sunbathing",defaultName:"Sunbathing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sunbathing.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sunbathing.png"]}}},{identifier:"imgly_sticker_emoticons_tired",defaultName:"Tired",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tired.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tired.png"]}}},{identifier:"imgly_sticker_emoticons_tongue_out_wink",defaultName:"Tongue Out Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tongue_out_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tongue_out_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wave",defaultName:"Wave",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wave.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wave.png"]}}},{identifier:"imgly_sticker_emoticons_wide_grin",defaultName:"Wide Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wide_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wide_grin.png"]}}},{identifier:"imgly_sticker_emoticons_wink",defaultName:"Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wink.png"]}}},{identifier:"imgly_sticker_emoticons_wrestler",defaultName:"Wrestler",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wrestler.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wrestler.png"]}}}]},{identifier:"imgly_sticker_shapes",defaultName:"Shapes",metaData:{backgroundImage:"stickers/shapes/background.png"},stickers:[{identifier:"imgly_sticker_shapes_arrow_02",defaultName:"Arrow 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236}}},{identifier:"imgly_sticker_shapes_arrow_03",defaultName:"Arrow 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_01",defaultName:"Badge 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_04",defaultName:"Badge 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589}}},{identifier:"imgly_sticker_shapes_badge_06",defaultName:"Badge 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733}}},{identifier:"imgly_sticker_shapes_badge_08",defaultName:"Badge 4",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_11",defaultName:"Badge 5",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_12",defaultName:"Badge 6",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903}}},{identifier:"imgly_sticker_shapes_badge_13",defaultName:"Badge 7",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718}}},{identifier:"imgly_sticker_shapes_badge_15",defaultName:"Badge 8",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_18",defaultName:"Badge 9",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_19",defaultName:"Badge 10",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_19.png"],width:2127,height:481},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_19.png"],width:2127,height:481}}},{identifier:"imgly_sticker_shapes_badge_20",defaultName:"Badge 11",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404}}},{identifier:"imgly_sticker_shapes_badge_28",defaultName:"Badge 12",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_32",defaultName:"Badge 13",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_35",defaultName:"Badge 14",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002}}},{identifier:"imgly_sticker_shapes_badge_36",defaultName:"Badge 15",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668}}},{identifier:"imgly_sticker_shapes_spray_01",defaultName:"Spray 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039}}},{identifier:"imgly_sticker_shapes_spray_03",defaultName:"Spray 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779}}},{identifier:"imgly_sticker_shapes_spray_04",defaultName:"Spray 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248}}}]}]}}});function A(s,e,t){if(s!=null)if(typeof s=="number")this.fromNumber(s,e,t);else if(e==null&&typeof s!="string")this.fromString(s,256);else this.fromString(s,e)}function ce(){return new A(null)}function AT(s,e,t,i,r,o){while(--o>=0){var n=e*this[s++]+t[i]+r;r=Math.floor(n/67108864);t[i++]=n&67108863}return r}function IT(s,e,t,i,r,o){var n=e&32767,a=e>>15;while(--o>=0){var l=this[s]&32767;var u=this[s++]>>15;var c=a*l+u*n;l=n*l+((c&32767)<<15)+t[i]+(r&1073741823);r=(l>>>30)+(c>>>15)+a*u+(r>>>30);t[i++]=l&1073741823}return r}function PT(s,e,t,i,r,o){var n=e&16383,a=e>>14;while(--o>=0){var l=this[s]&16383;var u=this[s++]>>14;var c=a*l+u*n;l=n*l+((c&16383)<<14)+t[i]+r;r=(l>>28)+(c>>14)+a*u;t[i++]=l&268435455}return r}function B_(s){return BT.charAt(s)}function M_(s,e){var t=wl[s.charCodeAt(e)];return t==null?-1:t}function MT(s){for(var e=this.t-1;e>=0;--e)s[e]=this[e];s.t=this.t;s.s=this.s}function LT(s){this.t=1;this.s=s<0?-1:0;if(s>0)this[0]=s;else if(s<-1)this[0]=s+this.DV;else this.t=0}function vr(s){var e=ce();e.fromInt(s);return e}function zT(s,e){var t;if(e==16)t=4;else if(e==8)t=3;else if(e==256)t=8;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else{this.fromRadix(s,e);return}this.t=0;this.s=0;var i=s.length,r=false,o=0;while(--i>=0){var n=t==8?s[i]&255:M_(s,i);if(n<0){if(s.charAt(i)=="-")r=true;continue}r=false;if(o==0)this[this.t++]=n;else if(o+t>this.DB){this[this.t-1]|=(n&(1<<this.DB-o)-1)<<o;this[this.t++]=n>>this.DB-o}else this[this.t-1]|=n<<o;o+=t;if(o>=this.DB)o-=this.DB}if(t==8&&(s[0]&128)!=0){this.s=-1;if(o>0)this[this.t-1]|=(1<<this.DB-o)-1<<o}this.clamp();if(r)A.ZERO.subTo(this,this)}function UT(){var s=this.s&this.DM;while(this.t>0&&this[this.t-1]==s)--this.t}function NT(s){if(this.s<0)return"-"+this.negate().toString(s);var e;if(s==16)e=4;else if(s==8)e=3;else if(s==2)e=1;else if(s==32)e=5;else if(s==4)e=2;else return this.toRadix(s);var t=(1<<e)-1,i,r=false,o="",n=this.t;var a=this.DB-n*this.DB%e;if(n-- >0){if(a<this.DB&&(i=this[n]>>a)>0){r=true;o=B_(i)}while(n>=0){if(a<e){i=(this[n]&(1<<a)-1)<<e-a;i|=this[--n]>>(a+=this.DB-e)}else{i=this[n]>>(a-=e)&t;if(a<=0){a+=this.DB;--n}}if(i>0)r=true;if(r)o+=B_(i)}}return r?o:"0"}function GT(){var s=ce();A.ZERO.subTo(this,s);return s}function WT(){return this.s<0?this.negate():this}function VT(s){var e=this.s-s.s;if(e!=0)return e;var t=this.t;e=t-s.t;if(e!=0)return this.s<0?-e:e;while(--t>=0)if((e=this[t]-s[t])!=0)return e;return 0}function Cl(s){var e=1,t;if((t=s>>>16)!=0){s=t;e+=16}if((t=s>>8)!=0){s=t;e+=8}if((t=s>>4)!=0){s=t;e+=4}if((t=s>>2)!=0){s=t;e+=2}if((t=s>>1)!=0){s=t;e+=1}return e}function jT(){if(this.t<=0)return 0;return this.DB*(this.t-1)+Cl(this[this.t-1]^this.s&this.DM)}function HT(s,e){var t;for(t=this.t-1;t>=0;--t)e[t+s]=this[t];for(t=s-1;t>=0;--t)e[t]=0;e.t=this.t+s;e.s=this.s}function qT(s,e){for(var t=s;t<this.t;++t)e[t-s]=this[t];e.t=Math.max(this.t-s,0);e.s=this.s}function KT(s,e){var t=s%this.DB;var i=this.DB-t;var r=(1<<i)-1;var o=Math.floor(s/this.DB),n=this.s<<t&this.DM,a;for(a=this.t-1;a>=0;--a){e[a+o+1]=this[a]>>i|n;n=(this[a]&r)<<t}for(a=o-1;a>=0;--a)e[a]=0;e[o]=n;e.t=this.t+o+1;e.s=this.s;e.clamp()}function XT(s,e){e.s=this.s;var t=Math.floor(s/this.DB);if(t>=this.t){e.t=0;return}var i=s%this.DB;var r=this.DB-i;var o=(1<<i)-1;e[0]=this[t]>>i;for(var n=t+1;n<this.t;++n){e[n-t-1]|=(this[n]&o)<<r;e[n-t]=this[n]>>i}if(i>0)e[this.t-t-1]|=(this.s&o)<<r;e.t=this.t-t;e.clamp()}function YT(s,e){var t=0,i=0,r=Math.min(s.t,this.t);while(t<r){i+=this[t]-s[t];e[t++]=i&this.DM;i>>=this.DB}if(s.t<this.t){i-=s.s;while(t<this.t){i+=this[t];e[t++]=i&this.DM;i>>=this.DB}i+=this.s}else{i+=this.s;while(t<s.t){i-=s[t];e[t++]=i&this.DM;i>>=this.DB}i-=s.s}e.s=i<0?-1:0;if(i<-1)e[t++]=this.DV+i;else if(i>0)e[t++]=i;e.t=t;e.clamp()}function JT(s,e){var t=this.abs(),i=s.abs();var r=t.t;e.t=r+i.t;while(--r>=0)e[r]=0;for(r=0;r<i.t;++r)e[r+t.t]=t.am(0,i[r],e,r,0,t.t);e.s=0;e.clamp();if(this.s!=s.s)A.ZERO.subTo(e,e)}function $T(s){var e=this.abs();var t=s.t=2*e.t;while(--t>=0)s[t]=0;for(t=0;t<e.t-1;++t){var i=e.am(t,e[t],s,2*t,0,1);if((s[t+e.t]+=e.am(t+1,2*e[t],s,2*t+1,i,e.t-t-1))>=e.DV){s[t+e.t]-=e.DV;s[t+e.t+1]=1}}if(s.t>0)s[s.t-1]+=e.am(t,e[t],s,2*t,0,1);s.s=0;s.clamp()}function ZT(s,e,t){var i=s.abs();if(i.t<=0)return;var r=this.abs();if(r.t<i.t){if(e!=null)e.fromInt(0);if(t!=null)this.copyTo(t);return}if(t==null)t=ce();var o=ce(),n=this.s,a=s.s;var l=this.DB-Cl(i[i.t-1]);if(l>0){i.lShiftTo(l,o);r.lShiftTo(l,t)}else{i.copyTo(o);r.copyTo(t)}var u=o.t;var c=o[u-1];if(c==0)return;var h=c*(1<<this.F1)+(u>1?o[u-2]>>this.F2:0);var m=this.FV/h,d=(1<<this.F1)/h,f=1<<this.F2;var b=t.t,y=b-u,g=e==null?ce():e;o.dlShiftTo(y,g);if(t.compareTo(g)>=0){t[t.t++]=1;t.subTo(g,t)}A.ONE.dlShiftTo(u,g);g.subTo(o,o);while(o.t<u)o[o.t++]=0;while(--y>=0){var C=t[--b]==c?this.DM:Math.floor(t[b]*m+(t[b-1]+f)*d);if((t[b]+=o.am(0,C,t,y,0,u))<C){o.dlShiftTo(y,g);t.subTo(g,t);while(t[b]<--C)t.subTo(g,t)}}if(e!=null){t.drShiftTo(u,e);if(n!=a)A.ZERO.subTo(e,e)}t.t=u;t.clamp();if(l>0)t.rShiftTo(l,t);if(n<0)A.ZERO.subTo(t,t)}function QT(s){var e=ce();this.abs().divRemTo(s,null,e);if(this.s<0&&e.compareTo(A.ZERO)>0)s.subTo(e,e);return e}function os(s){this.m=s}function eR(s){if(s.s<0||s.compareTo(this.m)>=0)return s.mod(this.m);else return s}function tR(s){return s}function iR(s){s.divRemTo(this.m,null,s)}function rR(s,e,t){s.multiplyTo(e,t);this.reduce(t)}function sR(s,e){s.squareTo(e);this.reduce(e)}function oR(){if(this.t<1)return 0;var s=this[0];if((s&1)==0)return 0;var e=s&3;e=e*(2-(s&15)*e)&15;e=e*(2-(s&255)*e)&255;e=e*(2-((s&65535)*e&65535))&65535;e=e*(2-s*e%this.DV)%this.DV;return e>0?this.DV-e:-e}function ns(s){this.m=s;this.mp=s.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<s.DB-15)-1;this.mt2=2*s.t}function nR(s){var e=ce();s.abs().dlShiftTo(this.m.t,e);e.divRemTo(this.m,null,e);if(s.s<0&&e.compareTo(A.ZERO)>0)this.m.subTo(e,e);return e}function aR(s){var e=ce();s.copyTo(e);this.reduce(e);return e}function lR(s){while(s.t<=this.mt2)s[s.t++]=0;for(var e=0;e<this.m.t;++e){var t=s[e]&32767;var i=t*this.mpl+((t*this.mph+(s[e]>>15)*this.mpl&this.um)<<15)&s.DM;t=e+this.m.t;s[t]+=this.m.am(0,i,s,e,0,this.m.t);while(s[t]>=s.DV){s[t]-=s.DV;s[++t]++}}s.clamp();s.drShiftTo(this.m.t,s);if(s.compareTo(this.m)>=0)s.subTo(this.m,s)}function uR(s,e){s.squareTo(e);this.reduce(e)}function cR(s,e,t){s.multiplyTo(e,t);this.reduce(t)}function mR(){return(this.t>0?this[0]&1:this.s)==0}function dR(s,e){if(s>4294967295||s<1)return A.ONE;var t=ce(),i=ce(),r=e.convert(this),o=Cl(s)-1;r.copyTo(t);while(--o>=0){e.sqrTo(t,i);if((s&1<<o)>0)e.mulTo(i,r,t);else{var n=t;t=i;i=n}}return e.revert(t)}function pR(s,e){var t;if(s<256||e.isEven())t=new os(e);else t=new ns(e);return this.exp(s,t)}function hR(){var s=ce();this.copyTo(s);return s}function fR(){if(this.s<0){if(this.t==1)return this[0]-this.DV;else if(this.t==0)return-1}else if(this.t==1)return this[0];else if(this.t==0)return 0;return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function gR(){return this.t==0?this.s:this[0]<<24>>24}function _R(){return this.t==0?this.s:this[0]<<16>>16}function yR(s){return Math.floor(Math.LN2*this.DB/Math.log(s))}function bR(){if(this.s<0)return-1;else if(this.t<=0||this.t==1&&this[0]<=0)return 0;else return 1}function xR(s){if(s==null)s=10;if(this.signum()==0||s<2||s>36)return"0";var e=this.chunkSize(s);var t=Math.pow(s,e);var i=vr(t),r=ce(),o=ce(),n="";this.divRemTo(i,r,o);while(r.signum()>0){n=(t+o.intValue()).toString(s).substr(1)+n;r.divRemTo(i,r,o)}return o.intValue().toString(s)+n}function vR(s,e){this.fromInt(0);if(e==null)e=10;var t=this.chunkSize(e);var i=Math.pow(e,t),r=false,o=0,n=0;for(var a=0;a<s.length;++a){var l=M_(s,a);if(l<0){if(s.charAt(a)=="-"&&this.signum()==0)r=true;continue}n=e*n+l;if(++o>=t){this.dMultiply(i);this.dAddOffset(n,0);o=0;n=0}}if(o>0){this.dMultiply(Math.pow(e,o));this.dAddOffset(n,0)}if(r)A.ZERO.subTo(this,this)}function wR(s,e,t){if(typeof e=="number"){if(s<2)this.fromInt(1);else{this.fromNumber(s,t);if(!this.testBit(s-1))this.bitwiseTo(A.ONE.shiftLeft(s-1),sd,this);if(this.isEven())this.dAddOffset(1,0);while(!this.isProbablePrime(e)){this.dAddOffset(2,0);if(this.bitLength()>s)this.subTo(A.ONE.shiftLeft(s-1),this)}}}else{var i=new Array,r=s&7;i.length=(s>>3)+1;e.nextBytes(i);if(r>0)i[0]&=(1<<r)-1;else i[0]=0;this.fromString(i,256)}}function CR(){var s=this.t,e=new Array;e[0]=this.s;var t=this.DB-s*this.DB%8,i,r=0;if(s-- >0){if(t<this.DB&&(i=this[s]>>t)!=(this.s&this.DM)>>t)e[r++]=i|this.s<<this.DB-t;while(s>=0){if(t<8){i=(this[s]&(1<<t)-1)<<8-t;i|=this[--s]>>(t+=this.DB-8)}else{i=this[s]>>(t-=8)&255;if(t<=0){t+=this.DB;--s}}if((i&128)!=0)i|=-256;if(r==0&&(this.s&128)!=(i&128))++r;if(r>0||i!=this.s)e[r++]=i}}return e}function DR(s){return this.compareTo(s)==0}function kR(s){return this.compareTo(s)<0?this:s}function TR(s){return this.compareTo(s)>0?this:s}function RR(s,e,t){var i,r,o=Math.min(s.t,this.t);for(i=0;i<o;++i)t[i]=e(this[i],s[i]);if(s.t<this.t){r=s.s&this.DM;for(i=o;i<this.t;++i)t[i]=e(this[i],r);t.t=this.t}else{r=this.s&this.DM;for(i=o;i<s.t;++i)t[i]=e(r,s[i]);t.t=s.t}t.s=e(this.s,s.s);t.clamp()}function ER(s,e){return s&e}function SR(s){var e=ce();this.bitwiseTo(s,ER,e);return e}function sd(s,e){return s|e}function FR(s){var e=ce();this.bitwiseTo(s,sd,e);return e}function L_(s,e){return s^e}function OR(s){var e=ce();this.bitwiseTo(s,L_,e);return e}function z_(s,e){return s&~e}function AR(s){var e=ce();this.bitwiseTo(s,z_,e);return e}function IR(){var s=ce();for(var e=0;e<this.t;++e)s[e]=this.DM&~this[e];s.t=this.t;s.s=~this.s;return s}function PR(s){var e=ce();if(s<0)this.rShiftTo(-s,e);else this.lShiftTo(s,e);return e}function BR(s){var e=ce();if(s<0)this.lShiftTo(-s,e);else this.rShiftTo(s,e);return e}function MR(s){if(s==0)return-1;var e=0;if((s&65535)==0){s>>=16;e+=16}if((s&255)==0){s>>=8;e+=8}if((s&15)==0){s>>=4;e+=4}if((s&3)==0){s>>=2;e+=2}if((s&1)==0)++e;return e}function LR(){for(var s=0;s<this.t;++s)if(this[s]!=0)return s*this.DB+MR(this[s]);if(this.s<0)return this.t*this.DB;return-1}function zR(s){var e=0;while(s!=0){s&=s-1;++e}return e}function UR(){var s=0,e=this.s&this.DM;for(var t=0;t<this.t;++t)s+=zR(this[t]^e);return s}function NR(s){var e=Math.floor(s/this.DB);if(e>=this.t)return this.s!=0;return(this[e]&1<<s%this.DB)!=0}function GR(s,e){var t=A.ONE.shiftLeft(s);this.bitwiseTo(t,e,t);return t}function WR(s){return this.changeBit(s,sd)}function VR(s){return this.changeBit(s,z_)}function jR(s){return this.changeBit(s,L_)}function HR(s,e){var t=0,i=0,r=Math.min(s.t,this.t);while(t<r){i+=this[t]+s[t];e[t++]=i&this.DM;i>>=this.DB}if(s.t<this.t){i+=s.s;while(t<this.t){i+=this[t];e[t++]=i&this.DM;i>>=this.DB}i+=this.s}else{i+=this.s;while(t<s.t){i+=s[t];e[t++]=i&this.DM;i>>=this.DB}i+=s.s}e.s=i<0?-1:0;if(i>0)e[t++]=i;else if(i<-1)e[t++]=this.DV+i;e.t=t;e.clamp()}function qR(s){var e=ce();this.addTo(s,e);return e}function KR(s){var e=ce();this.subTo(s,e);return e}function XR(s){var e=ce();this.multiplyTo(s,e);return e}function YR(){var s=ce();this.squareTo(s);return s}function JR(s){var e=ce();this.divRemTo(s,e,null);return e}function $R(s){var e=ce();this.divRemTo(s,null,e);return e}function ZR(s){var e=ce(),t=ce();this.divRemTo(s,e,t);return new Array(e,t)}function QR(s){this[this.t]=this.am(0,s-1,this,0,0,this.t);++this.t;this.clamp()}function eE(s,e){if(s==0)return;while(this.t<=e)this[this.t++]=0;this[e]+=s;while(this[e]>=this.DV){this[e]-=this.DV;if(++e>=this.t)this[this.t++]=0;++this[e]}}function Qn(){}function U_(s){return s}function tE(s,e,t){s.multiplyTo(e,t)}function iE(s,e){s.squareTo(e)}function rE(s){return this.exp(s,new Qn)}function sE(s,e,t){var i=Math.min(this.t+s.t,e);t.s=0;t.t=i;while(i>0)t[--i]=0;var r;for(r=t.t-this.t;i<r;++i)t[i+this.t]=this.am(0,s[i],t,i,0,this.t);for(r=Math.min(s.t,e);i<r;++i)this.am(0,s[i],t,i,0,e-i);t.clamp()}function oE(s,e,t){--e;var i=t.t=this.t+s.t-e;t.s=0;while(--i>=0)t[i]=0;for(i=Math.max(e-this.t,0);i<s.t;++i)t[this.t+i-e]=this.am(e-i,s[i],t,0,0,this.t+i-e);t.clamp();t.drShiftTo(1,t)}function Bo(s){this.r2=ce();this.q3=ce();A.ONE.dlShiftTo(2*s.t,this.r2);this.mu=this.r2.divide(s);this.m=s}function nE(s){if(s.s<0||s.t>2*this.m.t)return s.mod(this.m);else if(s.compareTo(this.m)<0)return s;else{var e=ce();s.copyTo(e);this.reduce(e);return e}}function aE(s){return s}function lE(s){s.drShiftTo(this.m.t-1,this.r2);if(s.t>this.m.t+1){s.t=this.m.t+1;s.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(s.compareTo(this.r2)<0)s.dAddOffset(1,this.m.t+1);s.subTo(this.r2,s);while(s.compareTo(this.m)>=0)s.subTo(this.m,s)}function uE(s,e){s.squareTo(e);this.reduce(e)}function cE(s,e,t){s.multiplyTo(e,t);this.reduce(t)}function mE(s,e){var t=s.bitLength(),i,r=vr(1),o;if(t<=0)return r;else if(t<18)i=1;else if(t<48)i=3;else if(t<144)i=4;else if(t<768)i=5;else i=6;if(t<8)o=new os(e);else if(e.isEven())o=new Bo(e);else o=new ns(e);var n=new Array,a=3,l=i-1,u=(1<<i)-1;n[1]=o.convert(this);if(i>1){var c=ce();o.sqrTo(n[1],c);while(a<=u){n[a]=ce();o.mulTo(c,n[a-2],n[a]);a+=2}}var h=s.t-1,m,d=true,f=ce(),b;t=Cl(s[h])-1;while(h>=0){if(t>=l)m=s[h]>>t-l&u;else{m=(s[h]&(1<<t+1)-1)<<l-t;if(h>0)m|=s[h-1]>>this.DB+t-l}a=i;while((m&1)==0){m>>=1;--a}if((t-=a)<0){t+=this.DB;--h}if(d){n[m].copyTo(r);d=false}else{while(a>1){o.sqrTo(r,f);o.sqrTo(f,r);a-=2}if(a>0)o.sqrTo(r,f);else{b=r;r=f;f=b}o.mulTo(f,n[m],r)}while(h>=0&&(s[h]&1<<t)==0){o.sqrTo(r,f);b=r;r=f;f=b;if(--t<0){t=this.DB-1;--h}}}return o.revert(r)}function dE(s){var e=this.s<0?this.negate():this.clone();var t=s.s<0?s.negate():s.clone();if(e.compareTo(t)<0){var i=e;e=t;t=i}var r=e.getLowestSetBit(),o=t.getLowestSetBit();if(o<0)return e;if(r<o)o=r;if(o>0){e.rShiftTo(o,e);t.rShiftTo(o,t)}while(e.signum()>0){if((r=e.getLowestSetBit())>0)e.rShiftTo(r,e);if((r=t.getLowestSetBit())>0)t.rShiftTo(r,t);if(e.compareTo(t)>=0){e.subTo(t,e);e.rShiftTo(1,e)}else{t.subTo(e,t);t.rShiftTo(1,t)}}if(o>0)t.lShiftTo(o,t);return t}function pE(s){if(s<=0)return 0;var e=this.DV%s,t=this.s<0?s-1:0;if(this.t>0)if(e==0)t=this[0]%s;else for(var i=this.t-1;i>=0;--i)t=(e*t+this[i])%s;return t}function hE(s){var e=s.isEven();if(this.isEven()&&e||s.signum()==0)return A.ZERO;var t=s.clone(),i=this.clone();var r=vr(1),o=vr(0),n=vr(0),a=vr(1);while(t.signum()!=0){while(t.isEven()){t.rShiftTo(1,t);if(e){if(!r.isEven()||!o.isEven()){r.addTo(this,r);o.subTo(s,o)}r.rShiftTo(1,r)}else if(!o.isEven())o.subTo(s,o);o.rShiftTo(1,o)}while(i.isEven()){i.rShiftTo(1,i);if(e){if(!n.isEven()||!a.isEven()){n.addTo(this,n);a.subTo(s,a)}n.rShiftTo(1,n)}else if(!a.isEven())a.subTo(s,a);a.rShiftTo(1,a)}if(t.compareTo(i)>=0){t.subTo(i,t);if(e)r.subTo(n,r);o.subTo(a,o)}else{i.subTo(t,i);if(e)n.subTo(r,n);a.subTo(o,a)}}if(i.compareTo(A.ONE)!=0)return A.ZERO;if(a.compareTo(s)>=0)return a.subtract(s);if(a.signum()<0)a.addTo(s,a);else return a;if(a.signum()<0)return a.add(s);else return a}function gE(s){var e,t=this.abs();if(t.t==1&&t[0]<=pt[pt.length-1]){for(e=0;e<pt.length;++e)if(t[0]==pt[e])return true;return false}if(t.isEven())return false;e=1;while(e<pt.length){var i=pt[e],r=e+1;while(r<pt.length&&i<fE)i*=pt[r++];i=t.modInt(i);while(e<r)if(i%pt[e++]==0)return false}return t.millerRabin(s)}function _E(s){var e=this.subtract(A.ONE);var t=e.getLowestSetBit();if(t<=0)return false;var i=e.shiftRight(t);s=s+1>>1;if(s>pt.length)s=pt.length;var r=ce();for(var o=0;o<s;++o){r.fromInt(pt[Math.floor(Math.random()*pt.length)]);var n=r.modPow(i,this);if(n.compareTo(A.ONE)!=0&&n.compareTo(e)!=0){var a=1;while(a++<t&&n.compareTo(e)!=0){n=n.modPowInt(2,this);if(n.compareTo(A.ONE)==0)return false}if(n.compareTo(e)!=0)return false}}return true}var id,xr,OT,P_,rd,BT,wl,Po,Wt,pt,fE,N_;var G_=_(()=>{id={};if(true){id=typeof window!=="undefined"?window.navigator:{}}OT=244837814094590;P_=(OT&16777215)==15715070;if(P_&&id.appName=="Microsoft Internet Explorer"){A.prototype.am=IT;xr=30}else if(P_&&id.appName!="Netscape"){A.prototype.am=AT;xr=26}else{A.prototype.am=PT;xr=28}A.prototype.DB=xr;A.prototype.DM=(1<<xr)-1;A.prototype.DV=1<<xr;rd=52;A.prototype.FV=Math.pow(2,rd);A.prototype.F1=rd-xr;A.prototype.F2=2*xr-rd;BT="0123456789abcdefghijklmnopqrstuvwxyz";wl=new Array;Po="0".charCodeAt(0);for(Wt=0;Wt<=9;++Wt)wl[Po++]=Wt;Po="a".charCodeAt(0);for(Wt=10;Wt<36;++Wt)wl[Po++]=Wt;Po="A".charCodeAt(0);for(Wt=10;Wt<36;++Wt)wl[Po++]=Wt;os.prototype.convert=eR;os.prototype.revert=tR;os.prototype.reduce=iR;os.prototype.mulTo=rR;os.prototype.sqrTo=sR;ns.prototype.convert=nR;ns.prototype.revert=aR;ns.prototype.reduce=lR;ns.prototype.mulTo=cR;ns.prototype.sqrTo=uR;A.prototype.copyTo=MT;A.prototype.fromInt=LT;A.prototype.fromString=zT;A.prototype.clamp=UT;A.prototype.dlShiftTo=HT;A.prototype.drShiftTo=qT;A.prototype.lShiftTo=KT;A.prototype.rShiftTo=XT;A.prototype.subTo=YT;A.prototype.multiplyTo=JT;A.prototype.squareTo=$T;A.prototype.divRemTo=ZT;A.prototype.invDigit=oR;A.prototype.isEven=mR;A.prototype.exp=dR;A.prototype.toString=NT;A.prototype.negate=GT;A.prototype.abs=WT;A.prototype.compareTo=VT;A.prototype.bitLength=jT;A.prototype.mod=QT;A.prototype.modPowInt=pR;A.ZERO=vr(0);A.ONE=vr(1);Qn.prototype.convert=U_;Qn.prototype.revert=U_;Qn.prototype.mulTo=tE;Qn.prototype.sqrTo=iE;Bo.prototype.convert=nE;Bo.prototype.revert=aE;Bo.prototype.reduce=lE;Bo.prototype.mulTo=cE;Bo.prototype.sqrTo=uE;pt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];fE=(1<<26)/pt[pt.length-1];A.prototype.chunkSize=yR;A.prototype.toRadix=xR;A.prototype.fromRadix=vR;A.prototype.fromNumber=wR;A.prototype.bitwiseTo=RR;A.prototype.changeBit=GR;A.prototype.addTo=HR;A.prototype.dMultiply=QR;A.prototype.dAddOffset=eE;A.prototype.multiplyLowerTo=sE;A.prototype.multiplyUpperTo=oE;A.prototype.modInt=pE;A.prototype.millerRabin=_E;A.prototype.clone=hR;A.prototype.intValue=fR;A.prototype.byteValue=gR;A.prototype.shortValue=_R;A.prototype.signum=bR;A.prototype.toByteArray=CR;A.prototype.equals=DR;A.prototype.min=kR;A.prototype.max=TR;A.prototype.and=SR;A.prototype.or=FR;A.prototype.xor=OR;A.prototype.andNot=AR;A.prototype.not=IR;A.prototype.shiftLeft=PR;A.prototype.shiftRight=BR;A.prototype.getLowestSetBit=LR;A.prototype.bitCount=UR;A.prototype.testBit=NR;A.prototype.setBit=WR;A.prototype.clearBit=VR;A.prototype.flipBit=jR;A.prototype.add=qR;A.prototype.subtract=KR;A.prototype.multiply=XR;A.prototype.divide=JR;A.prototype.remainder=$R;A.prototype.divideAndRemainder=ZR;A.prototype.modPow=mE;A.prototype.modInverse=hE;A.prototype.pow=rE;A.prototype.gcd=dE;A.prototype.isProbablePrime=gE;A.prototype.square=YR;N_=A});function W_(s){var e=8;var t=0;function i(y,g){var C=(y&65535)+(g&65535);var v=(y>>16)+(g>>16)+(C>>16);return v<<16|C&65535}function r(y,g){return y>>>g|y<<32-g}function o(y,g){return y>>>g}function n(y,g,C){return y&g^~y&C}function a(y,g,C){return y&g^y&C^g&C}function l(y){return r(y,2)^r(y,13)^r(y,22)}function u(y){return r(y,6)^r(y,11)^r(y,25)}function c(y){return r(y,7)^r(y,18)^o(y,3)}function h(y){return r(y,17)^r(y,19)^o(y,10)}function m(y,g){var C=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298);var v=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225);var x=new Array(64);var B,w,D,j,W,J,te,Q,K,ye;var lt,Ze;y[g>>5]|=128<<24-g%32;y[(g+64>>9<<4)+15]=g;for(var K=0;K<y.length;K+=16){B=v[0];w=v[1];D=v[2];j=v[3];W=v[4];J=v[5];te=v[6];Q=v[7];for(var ye=0;ye<64;ye++){if(ye<16)x[ye]=y[ye+K];else x[ye]=i(i(i(h(x[ye-2]),x[ye-7]),c(x[ye-15])),x[ye-16]);lt=i(i(i(i(Q,u(W)),n(W,J,te)),C[ye]),x[ye]);Ze=i(l(B),a(B,w,D));Q=te;te=J;J=W;W=i(j,lt);j=D;D=w;w=B;B=i(lt,Ze)}v[0]=i(B,v[0]);v[1]=i(w,v[1]);v[2]=i(D,v[2]);v[3]=i(j,v[3]);v[4]=i(W,v[4]);v[5]=i(J,v[5]);v[6]=i(te,v[6]);v[7]=i(Q,v[7])}return v}function d(y){var g=Array();var C=(1<<e)-1;for(var v=0;v<y.length*e;v+=e){g[v>>5]|=(y.charCodeAt(v/e)&C)<<24-v%32}return g}function f(y){y=y.replace(/\r\n/g,"\n");var g="";for(var C=0;C<y.length;C++){var v=y.charCodeAt(C);if(v<128){g+=String.fromCharCode(v)}else if(v>127&&v<2048){g+=String.fromCharCode(v>>6|192);g+=String.fromCharCode(v&63|128)}else{g+=String.fromCharCode(v>>12|224);g+=String.fromCharCode(v>>6&63|128);g+=String.fromCharCode(v&63|128)}}return g}function b(y){var g=t?"0123456789ABCDEF":"0123456789abcdef";var C="";for(var v=0;v<y.length*4;v++){C+=g.charAt(y[v>>2]>>(3-v%4)*8+4&15)+g.charAt(y[v>>2]>>(3-v%4)*8&15)}return C}s=f(s);return b(m(d(s),s.length*e))}var V_=_(()=>{});var yE,bE,as;var j_=_(()=>{yE=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/g;bE=/^(0|[1-9]\d*)\.(0|[1-9]\d*)(\.(0|[1-9]\d*))?(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/g;as=class{get major(){return this._major}get minor(){return this._minor}get patch(){return this._patch}constructor(e,t=false){const i=t?bE:yE;const r=i.exec(e);i.lastIndex=0;this._major=r[1];this._minor=r[2];this._patch=r[3]||0}equals(e){return this._major===e._major&&this._minor===e._minor&&this._patch===e._patch}isMoreRecentThan(e){if(this._major<e.major)return false;if(this._major>e.major)return true;if(this._minor<e.minor)return false;if(this._minor>e.minor)return true;if(this._patch<=e.patch)return false;if(this._patch>e.patch)return true}}});function xE(s){return s.map(e=>{return`0${(e&255).toString(16)}`.slice(-2)}).join("")}var tt,vE,wE,H_,CE,q_,od,DE,kE,nd,TE,K_,ad,Dl;var ld=_(()=>{Co();G_();V_();bo();j_();pi();tt=s=>R.byteArrayToString(Ut.decode(s));vE="TDNSeVlXTnJQMkZ3YVV0bGVUMD0=";wE="ZW50ZXJwcmlzZV9saWNlbnNl";H_="YXBwX2lkZW50aWZpZXJz";CE="cGxhdGZvcm0=";q_="ZmVhdHVyZXM=";od="ZXhwaXJlc19hdA==";DE="ZG9tYWlucw==";kE="YXBpX3Rva2Vu";nd="c2lnbmF0dXJl";TE="dmVyc2lvbg==";K_=class{constructor(e){this._version="2.4";this._l=typeof e==="string"?e.trim():e;this._e=this._parseBigInt("65537",10);this._n=this._parseBigInt("681984042382424091378806337544846672160292647422517223678775230983366046720611873368204040735766698395282492937192783016867164773742859209434481353888637963692711665138989982680829529436715362566735813634679619274059040232728883894511099669775400556584329435375723951309340934658571478665059403241851229195311069345899870108307225910988692123234379186643268583453907260879685992156955936561142314233983397819356937109343127504441076920088455337597736475086676246750168976219763398350254797168313954762459542746440628077261880980924552698138857743609502132632199713575442848784271304503226045319991689413234228439044522583790713890093165912455428688507463773064216328753265963237930998706891042679105987175588970202082466871461192706070321938250462103821558100761330890228135620208935801286878657384108721268761878694436895194628411397454202904351577771506916746612289964053490210990342857409030179406810634136188751670648983222653319056818302012063874664196648868156305696644664362171542503665321455971335955948698828939948786720193132672749776162913092000667953299803216404664087988046584107737900256954976744353601826341965438148646041640662195744770544094748295945844184507459808803114917301124088082458306086473490516969815873631",10);this._parseLicense()}v(){return this._sigValid()&&!this.isExp()}_jsonValid(){try{this._decLic=JSON.parse(this._l)}catch(e){this._decLic={};return false}return true}_hostnameValid(){if(typeof window==="undefined")return true;if(!this._decLic[tt(H_)].length)return true;const{hostname:e}=window.location;let t=false;this._decLic[tt(H_)].forEach(i=>{if(R.wildCardMatch(e,i)){t=true}});return t}_platformValid(){const e=this._decLic[tt(CE)];const t=true?"HTML5":"Server";return t===e}c(){return new Promise((e,t)=>{const i=this._validateError();if(i!==null){t(i)}e()})}validate(){const e=this._validateError();if(e!==null){return false}return true}_validateError(){const e=typeof this._l;if(e!=="string"||!this._jsonValid()){const t=new Error;t.code="ELICINVFMT";return t}if(!this._sigValid()){const t=new Error;t.code="ELICINV";return t}if(!this._hostnameValid()){const t=new Error;t.code="ELICINVHOST";return t}if(!this._platformValid()){const t=new Error;t.code="ELICINVPLAT";return t}if(this.isExp()){const t=new Error;t.code="ELICEXP";return t}return null}isToolAllowed(e){return this._includesFeature(e)}isWhiteLabel(){return this._includesFeature("whitelabel",new as("2.4",true))}areCustomAssetsAllowed(){return this._includesFeature("customassets",new as("2.4",true))}t(){if(this._decLic.enterprise_license)return Promise.resolve();if(this._includesFeature("noexporttracking",new as("2.4",true)))return Promise.resolve();const e=this._decLic[tt(DE)][0]+tt(tt(vE))+this._decLic[tt(kE)];const t=new Nt(e);return t.load().catch(()=>{})}isENT(){if(!this._decLic)return false;return this._decLic[tt(wE)]}_sigValid(){return this._verify(this._message,this._sig)}exp(){return!!this._decLic[tt(od)]}dl(){return Math.ceil((this._expAt()-Date.now())/(60*60*24*1e3))}isExp(e=Date.now()){if(this._decLic[tt(od)]===null)return false;return e>this._expAt()}_expAt(){return this._decLic[tt(od)]*1e3}_verify(e,t){let i;let r;r=this._encodeMessage(e);i=this._decodeSignature(t);i=i.substr(-64);const o=r===i;return o}_encodeMessage(e){const t=W_(e);return t}_decodeSignature(e){let t;e=Ut.decode(e);e=xE(e);e=this._parseBigInt(e,16);t=e.modPowInt(this._e,this._n);t=t.toString(16);return t}_parseBigInt(e,t){return new N_(e,t)}_parseLicense(){if(typeof this._l!=="string")return;if(!this._jsonValid())return;this._sig=this._decLic[tt(nd)]||"";delete this._decLic[tt(nd)];this._sig=this._sig.replace(/[^A-Za-z0-9+/=]/g,"");this._message=this._l.replace(new RegExp(`,"${tt(nd)}":"([^"]*)"`),"")}_includesFeature(e,t=new as("1.0",true)){const i=new as(this._decLic[tt(TE)],true);if(t.isMoreRecentThan(i))return true;return this._decLic[tt(q_)]&&this._decLic[tt(q_)].indexOf(e)!==-1}};ad=class{v(){return true}c(){return Promise.resolve()}isToolAllowed(e){return true}isWhiteLabel(){return false}areCustomAssetsAllowed(){return true}t(){return Promise.resolve()}isENT(){return false}exp(){return false}dl(){return 0}isExp(e=Date.now()){return false}};Dl=K_});var ls,Vi,wr,X_,kl;var Y_=_(()=>{ls=typeof window==="undefined"?global:window;Vi=ls.requestAnimationFrame;wr=ls.cancelAnimationFrame;X_=0;kl=["ms","moz","webkit","o"];for(let s=0;s<kl.length&&!Vi;++s){Vi=ls[`${kl[s]}RequestAnimationFrame`];wr=ls[`${kl[s]}CancelAnimationFrame`]||ls[`${kl[s]}CancelRequestAnimationFrame`]}if(Vi){Vi=Vi.bind(ls)}if(wr){wr=wr.bind(ls)}if(!Vi){Vi=function(s,e){const t=new Date().getTime();const i=Math.max(0,16-(t-X_));const r=setTimeout(function(){s(t+i)},i);X_=t+i;return r}}if(!wr){wr=function(s){clearTimeout(s)}}});var J_,ud;var $_=_(()=>{ti();zi();J_=class{constructor(e=new L(0,0),t=new L(1,1),i=new L(2,-1),r=new L(2,0)){this._p0=e.clone();this._p1=t.clone();this._p2=i.clone();this._p3=r.clone();this._segments=[];this._length=-1;this._sample=[]}set(e=new L(0,0),t=new L(1,1),i=new L(2,1),r=new L(2,0)){this._p0=e.clone();this._p1=t.clone();this._p2=i.clone();this._p3=r.clone()}getLength(){return this._length}calculateSegments(e=100){let t=0;let i=0;const r=[];const o=1/e;let n=this._p0.clone();for(let a=1;a<=e;a++){const l=[];l.push({t,s:i,point:n});t+=o;t=Math.min(t,1);const u=this.evalAt(t);const c=u.clone().subtract(n);i+=c.len();l.push({t,s:i,point:u});r.push(l);n=u}this._segments=r;this._length=i;return i}evalAt(e){e=this.normalizeParameter(e);const t=this._p0.clone().multiply((1-e)**3);const i=this._p1.clone().multiply(3*(1-e)*(1-e)*e);const r=this._p2.clone().multiply(3*(1-e)*e*e);const o=this._p3.clone().multiply(e*e*e);return t.add(i).add(r).add(o)}isInSegment(e,t){e=this.normalizeArcLength(e);return e>=t[0].s&&e<=t[1].s}getArcLengthSegment(e){e=this.normalizeArcLength(e);for(let t=0;t<this._segments.length;t++){const i=this._segments[t];if(this.isInSegment(e,i)){return i}}return null}normalizeArcLength(e){return Math.max(Math.min(this._length,e),0)}normalizeParameter(e){return Math.max(Math.min(1,e),0)}getParameterForArcLength(e){const t=this.normalizeArcLength(e);const i=this.getArcLengthSegment(t);if(!i){P.warn("CubicBezierCurve#getParameterForArcLength","Segment not found.");return-1}const r=(t-i[1].s)/(i[0].s-i[1].s);return r*i[0].t+(1-r)*i[1].t}evalAtArcLength(e){return this.evalAt(this.getParameterForArcLength(e))}approximateAtArcLength(e){const t=this.normalizeArcLength(e);const i=this.getArcLengthSegment(t);if(!i){return-1}const r=(t-i[1].s)/(i[0].s-i[1].s);return i[0].point.clone().multiply(r).add(i[1].point.clone().multiply(1-r))}parameterSample(e=100){const t=1/e;const i=[];let r=0;for(let o=0;o<=e+1;o++){i.push(this.evalAt(r));r+=t}this._sample=i;return[...i]}arcLengthApproxSample(e=100,t=false,i=false){const r=this._length/e;const o=[];let n=0;for(let a=t?1:0;a<e+1;a++){o.push(this.approximateAtArcLength(n));n+=r}if(i){o.pop()}this._sample=o;return[...o]}};ud=J_});var Z_,cd;var Q_=_(()=>{Z_=class{constructor(e,t){this.min=e;this.max=t}getMin(){return this.min}getMax(){return this.max}getLength(){return this.max-this.min}contains(e){return this.min<=e&&e<=this.max}};cd=Z_});var ht,md;var ey=_(()=>{ht=class{constructor(e,t,i){this.x=e;this.y=t;this.z=i;if(typeof this.x==="undefined"){this.x=0}if(typeof this.y==="undefined"){this.y=0}if(typeof this.z==="undefined"){this.z=0}}set(e,t,i){this.x=e;this.y=t;this.z=i;return this}clone(){return new ht(this.x,this.y,this.z)}copy(e){this.x=e.x;this.y=e.y;this.z=e.z;return this}clamp(e,t){const i=e!==null&&typeof e!=="undefined";const r=t!==null&&typeof t!=="undefined";if(!(e instanceof ht)&&i){e=new ht(e,e,e)}if(!(t instanceof ht)&&r){t=new ht(t,t,t)}if(i){this.x=Math.max(e.x,this.x);this.y=Math.max(e.y,this.y);this.z=Math.max(e.z,this.z)}if(r){this.x=Math.min(t.x,this.x);this.y=Math.min(t.y,this.y);this.z=Math.min(t.z,this.z)}return this}divide(e){if(e instanceof ht){this.x/=e.x;this.y/=e.y;this.z/=e.z}else{this.x/=e;this.y/=e;this.z/=e}return this}subtract(e){if(e instanceof ht){this.x-=e.x;this.y-=e.y;this.z-=e.z}else{this.x-=e;this.y-=e;this.z-=e}return this}multiply(e){if(e instanceof ht){this.x*=e.x;this.y*=e.y;this.z*=e.z}else{this.x*=e;this.y*=e;this.z*=e}return this}add(e){if(e instanceof ht){this.x+=e.x;this.y+=e.y;this.z+=e.z}else{this.x+=e;this.y+=e;this.z+=e}return this}equals(e){if(e instanceof ht){return e.x===this.x&&e.y===this.y&&e.z===this.z}return e===this.x&&e===this.y&&e===this.z}round(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this}ceil(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this}floor(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this}fract(){this.x%=1;this.y%=1;this.z%=1;return this}toInt(){this.x|=0;this.y|=0;this.z|=0;return this}abs(){this.x=Math.abs(this.x);this.y=Math.abs(this.y);this.z=Math.abs(this.z);return this}len(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}min(){return Math.min(Math.min(this.x,this.y),this.z)}max(){return Math.max(Math.max(this.x,this.y),this.z)}toObject(){return{x:this.x,y:this.y,z:this.z}}toString(){return`Vector3({ x: ${this.x}, y: ${this.y}, z: ${this.z} })`}roundDecimal(e){this.x=parseFloat(this.x.toFixed(e));this.y=parseFloat(this.y.toFixed(e));this.z=parseFloat(this.z.toFixed(e));return this}static fromObject(e){return new ht(e.x,e.y,e.z)}static get NULL(){return new ht(0,0,0)}};md=ht});var M={};Me(M,{ColorMatrix:()=>Nn,CubicBezierCurve:()=>ud,Matrix:()=>xt,Range:()=>cd,Rectangle:()=>be,Vector2:()=>L,Vector3:()=>md});var dd=_(()=>{Bm();$_();Im();Q_();Pm();zi();ey()});var ea={};Me(ea,{Base64:()=>Ut,Color:()=>E,ColorMatrix:()=>Nn,Configurable:()=>X,Constants:()=>bt,CubicBezierCurve:()=>ud,Engine:()=>T,EventEmitter:()=>mt,Events:()=>Io,FreeLicenseChecker:()=>ad,GLUtils:()=>ts,LicenseChecker:()=>Dl,Log:()=>P,Matrix:()=>xt,Range:()=>cd,Rectangle:()=>be,Utils:()=>R,Vector2:()=>L,Vector3:()=>md,cancelAnimationFrame:()=>wr,requestAnimationFrame:()=>Vi});var us=_(()=>{ti();Zn();Ft();ta();bo();es();Ro();Do();Am();ld();pi();Y_();dd()});var pd;var ty=_(()=>{gl();hd();td();us();pd=class{constructor(){this._container=new hi;this._sprite=new ia;this._container.addChild(this._sprite)}render(e,t,i){const r=i.getDimensions();const o=this._getNextHighestPOT(r);if(!this._renderTexture){this._renderTexture=new $n(e,o.x,o.y)}else{this._renderTexture.resizeTo(o)}const n=this._renderTexture.getDimensions();this._sprite.setTexture(i);this._sprite.updateTransform();this._renderTexture.clear();this._renderTexture.render(this._container);this._updateSprite(e,t,r,n)}_updateSprite(e,t,i,r){t.setTexture(this._renderTexture);this._renderTexture.setFrame(new be(0,0,i.x,i.y))}_getNextHighestPOT(e){return new L(R.nextHighestPOT(e.x),R.nextHighestPOT(e.y))}getRenderTexture(){return this._renderTexture}dispose(){if(!this._renderTexture){return}this._renderTexture.dispose();delete this._renderTexture}}});var ia;var hd=_(()=>{ty();gl();Ue();ia=class extends hi{constructor(e){super();this._shader=null;this._width=0;this._height=0;this._anchor=new L(0,0);this._canvasSmoothingEnabled=true;this._smoothDownscaling=false;this._onTextureUpdate=this._onTextureUpdate.bind(this);this.setTexture(e)}_onTextureUpdate(){this._boundsNeedUpdate=true;this._localBoundsNeedUpdate=true}_renderWebGL(e){const t=e.save();if(this._smoothDownscaling){if(!this._potRenderer){this._potRenderer=new pd}if(this._texture){this._potRenderer.render(e,this,this._texture)}}e.restore(t);e.setObjectRenderer(e.renderers.sprite);e.renderers.sprite.render(this)}_renderCanvas(e){if(!this._texture)return;const t=this._worldTransform;const i=this._texture.getFrame();const{width:r,height:o}=i;const n=e.getCurrentRenderTarget().getPixelRatio();const a=this._anchor.x*-r|0;const l=this._anchor.y*-o|0;const u=e.getContext();u.setTransform(t.a,t.b,t.c,t.d,t.tx*n,t.ty*n);u.globalAlpha=this.getWorldAlpha();if(!this._texture)return;const c=this._texture.getBaseTexture();const h=c.getPixelRatio();const m=c.getSource();u.imageSmoothingEnabled=this._canvasSmoothingEnabled;if("beforeDraw"in e){e.beforeDraw(u)}u.drawImage(m,0,0,(m.naturalWidth||r)*h,(m.naturalHeight||o)*h,a*n,l*n,r*n,o*n)}isAtPosition(e){if(!this._texture)return void 0;const t=this._worldTransform.applyInverseToVector(e);const i=this._texture.getFrame();const{width:r,height:o}=i;const n=new L(-r,-o);n.multiply(this._anchor);const a=n.clone().add(r,o);if(t.x<n.x||t.x>a.x||t.y<n.y||t.y>a.y){return false}return true}getLocalBounds(){if(this._localBoundsNeedUpdate&&this._texture){const e=this._localBounds;const t=this._texture.getFrame();e.x=-t.width*this._anchor.x;e.y=-t.height*this._anchor.y;e.width=t.width;e.height=t.height;this._localBoundsNeedUpdate=false}return this._localBounds.clone()}getBounds(){if(this._boundsNeedUpdate&&this._texture){const e=this._bounds;const t=this._texture.getFrame();const i=this._worldTransform;const r=this._anchor;const o=i.rectangleToCoordinates(t,r);let n=o[0].x;let a=o[0].y;let l=n;let u=a;o.forEach(({x:c,y:h})=>{n=Math.min(n,c);a=Math.min(a,h);l=Math.max(l,c);u=Math.max(u,h)});e.x=n;e.width=Math.abs(l-n);e.y=a;e.height=Math.abs(u-a);this._boundsNeedUpdate=false}return this._bounds.clone()}getTexture(){return this._texture}clearTexture(e=true){if(!this._texture){return}this._texture.off("update",this._onTextureUpdate);e&&this._texture.dispose();this._texture=null;if(this._potRenderer){e&&this._potRenderer.dispose();delete this._potRenderer}}setTexture(e){if(!e)return;if(this._texture){this._texture.off("update",this._onTextureUpdate)}if(this._potRenderer){this._potRenderer.getRenderTexture().getBaseTexture().setDirty(true)}this._texture=e;if(e.getBaseTexture().isLoaded()){this._onTextureUpdate()}e.on("update",this._onTextureUpdate)}getShader(){return this._shader}setShader(e){this._shader=e}getWidth(){return this._width}setWidth(e){if(!this._texture)return;this._scale.x=e/this._texture.getFrame().width;this._width=e;this._boundsNeedUpdate=true;this._localBoundsNeedUpdate=true}getHeight(){return this._height}setHeight(e){if(!this._texture)return;this._scale.y=e/this._texture.getFrame().height;this._height=e;this._boundsNeedUpdate=true;this._localBoundsNeedUpdate=true}getDimensions(){return new L(this._width,this._height)}getAnchor(){return this._anchor}setAnchor(e,t){this._anchor.set(e,t);this._boundsNeedUpdate=true;this._localBoundsNeedUpdate=true}isSmoothDownscaling(){return this._smoothDownscaling}setSmoothDownscaling(e){this._smoothDownscaling=e}dispose(e=false,t=false){if(this._texture){this._texture.off("update",this._onTextureUpdate)}(e||t)&&this._texture&&this._texture.dispose(t);if(this._potRenderer){this._potRenderer.dispose()}}}});var RE,T;var ta=_(()=>{gl();Vm();Eo();yl();k_();A_();hd();Oo();td();ed();Wn();wm();di();qn();RE={CanvasFilterManager:ss,Container:hi,BaseTexture:ze,Texture:br,RenderTexture:$n,WebGLRenderTarget:Gi,CanvasRenderTarget:Ni,Sprite:ia,Filter:ii,Filters:Wm,PixelArrayImage:_o,autoDetectRenderer(s,e,t={}){if(Je.isSupported()){return new vl(s,e,t)}return new Ao(s,e,t)},canvasRenderer(s,e,t={}){return new Ao(s,e,t)}};T=RE});var iy,ry;var sy=_(()=>{iy=class{static current(){return process.env.ENV}static isTest(){return process.env.ENV==="test"}static isDevelopment(){return process.env.ENV==="development"}static isProduction(){return process.env.ENV==="production"||!this.isTest()&&!this.isDevelopment()}};ry=iy});var oy,cs;var Tl=_(()=>{oy=class{constructor(e){this._head=0;this._buf=e}peekInt8(){return this._buf[this._head]}peekInt16(e=false){const t=this._buf[this._head];const i=this._buf[this._head+1];if(!e){return(t<<8)+i}return(i<<8)+t}peekInt24(e=false){const t=this._buf[this._head];const i=this._buf[this._head+1];const r=this._buf[this._head+2];if(!e){return(t<<16)+(i<<8)+r}return(r<<16)+(i<<8)+t}peekInt32(e=false){const t=this._buf[this._head];const i=this._buf[this._head+1];const r=this._buf[this._head+2];const o=this._buf[this._head+3];if(!e){return(t<<32)+(i<<16)+(r<<8)+o}return(o<<32)+(r<<16)+(i<<8)+t}writeInt8(e){this._buf[this._head]=e&255}writeInt16(e){this._buf[this._head]=e>>8;this._buf[this._head+1]=e&255}readInt8(){const e=this.peekInt8();this._head+=1;return e}readInt16(e=false){const t=this.peekInt16(e);this._head+=2;return t}readInt24(e=false){const t=this.peekInt24(e);this._head+=3;return t}readInt32(e=false){const t=this.peekInt32(e);this._head+=4;return t}readString(e){let t="";for(let i=0;i<e;i++){const r=this.readInt8();t+=String.fromCharCode(r)}return t}getHead(){return this._head}setHead(e){this._head=e}};cs=oy});var EE,SE,Mo;var Rl=_(()=>{EE={SOI:65496,SOS:65498,APP0:65504,APP1:65505,JFIF:65504,EXIF:65505};SE={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"};Mo={MARKERS:EE,EXIF_TAGS:SE}});var fd,FE,ny,ay,ly;var uy=_(()=>{Tl();pi();Rl();({invariant:fd}=R);({MARKERS:FE,EXIF_TAGS:ny}=Mo);ay=class{constructor(e){this._buf=e;this._stream=new cs(this._buf);this._stream.setHead(0);this._parse();this._bigEndian=false}isValid(){this._stream.setHead(0);const e=this._stream.readInt16();if(e!==FE.EXIF){return false}const t=this._stream.readInt16();if(!(t>0)){return false}const i=this._stream.readString(4);if(i!=="Exif"){return false}return true}_parse(){if(!this.isValid()){return}this._stream.setHead(10);const e=this._stream.getHead();this._bigEndian=false;const t=this._stream.readInt16();if(t===18761){this._bigEndian=false}else if(t===19789){this._bigEndian=true}else{fd(false,"Invalid TIFF data: No endian type found")}fd(this._stream.readInt16(!this._bigEndian)===42,"Invalid TIFF data: No 0x002A");const i=this._stream.readInt32(!this._bigEndian);fd(i>=8,"Invalid TIFF data: First IFD offset < 8");const r=e+i;const o=this._readTags(this._stream,e,r,this._bigEndian);this._tags=o.tags;this._tagData=o.tagData}getTags(){return this._tags}getTagData(){return this._tagData}setOrientation(e){if(this._tagData.Orientation){const{entryOffset:t}=this._tagData.Orientation;this._stream.setHead(t+8);this._stream.writeInt16(this._bigEndian?e:(e&255)<<8|e>>8&255)}}_readTags(e,t,i,r){e.setHead(i);const o=e.readInt16(!r);const n={};const a=[];for(let l=0;l<o;l++){const u=i+l*12+2;e.setHead(u);let c=e.readInt16(!r);let h;let m;let d;if(ny[c]){c=ny[c];h=e.readInt16(!r);m=e.readInt32(!r);d=e.readInt32(!r)+t;let f=null;switch(h){case 1:case 7:if(m===1){f=e.readInt8(!r)}else{f=[];for(let b=0;b<m;b++){f.push(e.readInt8(!r))}}break;case 2:e.setHead(m>4?d:u+8);f=e.readString(m);break;case 3:e.setHead(m>2?d:u+8);if(m===1){f=e.readInt16(!r)}else{f=[];for(let b=0;b<m;b++){f.push(e.readInt16(!r))}}break;case 4:case 9:e.setHead(m>1?d:u+8);if(m===1){f=e.readInt32(!r)}else{f=[];for(let b=0;b<m;b++){f.push(e.readInt32(!r))}}break;case 5:case 10:e.setHead(d);if(m===1){const b=e.readInt32(!r);const y=e.readInt32(!r);f=b/y}else{f=[];for(let b=0;b<m;b++){const y=e.readInt32(!r);const g=e.readInt32(!r);const C=y/g;f.push(C)}}break}n[c]=f;a[c]={value:f,numValues:m,entryOffset:u,valueOffset:d,type:h}}}return{tags:n,tagData:a}}getBuffer(){return this._buf}};ly=ay});var OE,cy,gd;var my=_(()=>{Tl();Rl();({MARKERS:OE}=Mo);cy=class{constructor(e){this._buf=e;this._stream=new cs(this._buf);this._stream.setHead(0)}isValid(){this._stream.setHead(0);const e=this._stream.readInt16();if(e!==OE.APP0){return false}const t=this._stream.readInt16();if(!(t>=16)){return false}const i=this._stream.readString(4);const r=this._stream.readInt8();if(!(i==="JFIF")){return false}if(!(r===0)){return false}return true}setUnitDensity(e){this._stream.setHead(11);this._stream.writeInt8(e)}setDensityX(e){this._stream.setHead(12);this._stream.writeInt16(e)}setDensityY(e){this._stream.setHead(14);this._stream.writeInt16(e)}getUnitDensity(){this._stream.setHead(11);return this._stream.readInt8()}getDensityX(){this._stream.setHead(12);return this._stream.readInt16()}getDensityY(){this._stream.setHead(14);return this._stream.readInt16()}getBuffer(){return this._buf}};gd=cy});var ra,El,AE,gi,sa;var _d=_(()=>{Tl();bo();Rl();uy();my();pi();({MARKERS:ra}=Mo);El="data:image/jpeg;base64,";AE=new RegExp(`^${El}`,"i");gi=class{constructor(e){this._buf=e;this._stream=new cs(this._buf);this._stream.setHead(0);this._segments=this._sliceIntoSegments(this._buf);this._exifData=new ly(this._getMarkerBuffer(ra.EXIF));this._jfifData=new gd(this._getMarkerBuffer(ra.JFIF))}static toDataURL(e){return El+Ut.encode(e)}static fromDataURL(e){const t=e.replace(El,"");const i=Ut.decode(t);return i}restoreSegmentsInArray(e){e=this.restoreExifTagsToImageData(e);return this.restoreJfifSegmentToImageData(e)}restoreSegments(e){let t=gi.fromDataURL(e);t=this.restoreSegmentsInArray(t);return gi.toDataURL(t)}restoreExifTagsToImageData(e){if(!this._exifData.isValid()){return e}const t=this._sliceIntoSegments(e);const i=t[1][0];const r=e.slice(0,i);const o=e.slice(i);let n=r.concat(this._exifData.getBuffer());n=n.concat(o);return n}restoreJfifSegmentToImageData(e){if(!this._jfifData.isValid()){return e}const t=this._sliceIntoSegments(e);const i=this._findSegment(ra.JFIF,t);let r=[];if(i){const o=i[0];const n=i[1];const a=e.slice(0,o);const l=e.slice(o,n);const u=e.slice(n);const c=new gd(l);c.setDensityX(this._jfifData.getDensityX());c.setDensityY(this._jfifData.getDensityY());c.setUnitDensity(this._jfifData.getUnitDensity());r=a.concat(l).concat(u)}else{return e}return r}restoreExifTags(e){const t=gi.fromDataURL(e);const i=this.restoreExifTagsToImageData(t);return gi.toDataURL(i)}restoreJfifSegment(e){if(!this._jfifData.isValid()){return e}const t=gi.fromDataURL(e);const i=this.restoreJfifSegmentToImageData(t);return gi.toDataURL(i)}setOrientation(e){return this._exifData.setOrientation(e)}static isJPEG(e){return AE.test(e)}static bufferIsJPEG(e){return e[0]===255&&e[1]===216&&e[2]===255}static fromBase64String(e){const t=e.replace(El,"");const i=Ut.decode(t);return new gi(i)}_findSegment(e,t=this._segments){for(let i=0;i<t.length;i++){const r=t[i][0];const o=t[i][1];this._stream.setHead(r);const n=this._stream.peekInt16();if(n===e){return[r,o]}}return false}_getLastSegment(e=this._segments){return e[e.length-1]}_getMarkerBuffer(e,t=this._segments){const i=this._findSegment(e,t);if(i){const r=i[0];const o=i[1];return this._buf.slice(r,o)}return false}_sliceIntoSegments(e){const t=new cs(e);const i=[];while(t.getHead()<e.length){const r=t.readInt16();if(r===ra.SOI){continue}if(r===ra.SOS){break}if(r>=65280&&r<=65535){const o=t.readInt16();const n=t.getHead()+o-2;i.push([t.getHead()-4,n]);t.setHead(n)}else{throw new Error(`Invalid marker: 0x${r.toString(16)}`)}}this._stream.setHead(0);return i}getTags(){return this._exifData.getTags()}getTagData(){return this._exifData.getTagData()}dispose(){this._buf=[];this._segments=[]}};sa=gi});var dy,ft;var Sl=_(()=>{if(true){dy=typeof window!=="undefined"&&window.Image}if(false){dy=null.Image}ft=dy});var Fl,Ol;var yd=_(()=>{us();Do();Fl=class extends mt{constructor(e=[]){super();this._onOperationUpdate=this._onOperationUpdate.bind(this);this._cacheEnabled=true;this._stack=e;this._stack.forEach(t=>{t.on("update",this._onOperationUpdate)})}clear(){this.forEach(e=>this.remove(e));this._stack=[]}hasChanges(){return this._stack.filter(e=>!!e).some(e=>e.hasChanges())}_onOperationUpdate(e,t){this.emit(Io.OPERATION_UPDATED,e,t)}enableCache(){this._cacheEnabled=true}disableCache(){this._cacheEnabled=false}forEach(e){return this._stack.filter(t=>!!t).forEach(e)}render(e,t){const i=t;const r=this._stack.filter(u=>!!u).filter(u=>u.getEnabled());r.reverse();const o=r.filter(u=>!u.isDirtyForRenderer(e.getRenderer()))[0];const n=r.indexOf(o);r.reverse();let a=0;if(n!==-1){a=r.length-n-1}for(let u=0;u<a;u++){P.info(this.constructor.name,`Skipping ${r[u].constructor.name}`)}let l=Promise.resolve(i);for(let u=a;u<r.length;u++){const c=r[u];let h;let m;l=l.then(d=>{return c.render(d).then(f=>{if(h&&f!==h&&!this._cacheEnabled){m.disposeRenderTextures()}h=f;m=c;return f})})}return l.then(u=>{const c=!r.some(h=>h.isDirtyForRenderer(e.getRenderer()));return{outputTexture:u,renderDone:c}})}validateSettings(){return Promise.all(this._stack.filter(e=>!!e).map(e=>e.validateSettings()))}setAllToDirty(e=false){this.forEach(t=>t.setDirty(true,e))}updateDirtinessForRenderer(e){let t=false;for(let i=0;i<this._stack.length;i++){const r=this._stack[i];if(!r)continue;if(r.isDirtyForRenderer(e)){t=true}if(t){r.setDirtyForRenderer(true,e)}}}push(e){this._stack.push(e);e.on("update",this._onOperationUpdate)}pop(){const e=this._stack.pop();if(e){e.off("update",this._onOperationUpdate);e.dispose()}}unshift(e){this._stack.unshift(e);e.on("update",this._onOperationUpdate)}clone(){return new Fl(this._stack.slice(0))}get(e){return this._stack[e]}getByIdentifier(e){return R.Array.find(this._stack,t=>t&&t.constructor.identifier===e)}getIndexByIdentifier(e){return R.Array.findIndex(this._stack,t=>t&&t.constructor.identifier===e)}moveToTop(e){const t=R.Array.findIndex(this._stack,r=>r&&r.constructor.identifier===e);if(t<0||t===this._stack.length-1){return}const i=this.getByIdentifier(e);this._stack.splice(t,1);this._stack[this._stack.length]=i}set(e,t){if(this._stack[e]){this._stack[e].off("update",this._onOperationUpdate);this._stack[e].dispose()}this._stack[e]=t;t.on("update",this._onOperationUpdate)}remove(e){const t=this._stack.indexOf(e);if(t===-1){return}if(this._stack[t]){this._stack[t].off("update",this._onOperationUpdate);this._stack[t].dispose()}this._stack.splice(t,1)}removeAt(e){if(this._stack[e]){this._stack[e].off("update",this._onOperationUpdate);this._stack[e].dispose()}delete this._stack[e]}getStack(){return this._stack}dispose(){this.forEach(e=>{e.dispose()})}};Ol=Fl});var py,hy,Al;var bd=_(()=>{us();py=typeof window!=="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):jn();hy=class{constructor(e,t){this._tag=e;this._name=t;this._start=py()}stop(){const e=py();const t=e-this._start;const i=Math.round(1e3/t);P.info(this._tag,`${this._name} took ${t.toFixed(2)}ms (${i} FPS)`)}};Al=hy});var xd,le;var vd=_(()=>{ti();Ft();ta();Ro();bd();xd=class extends X{constructor(e,t={}){super(t,{enabled:{type:p.BOOLEAN,default:true,serializable:false}});this._sdk=e;this._cacheEnabled=false;this._dirtiness={};this._sprite=new T.Sprite;this._container=new T.Container;this._container.addChild(this._sprite)}_onOptionsChange(){this.setDirty(true)}render(e){if(!this.getEnabled()){P.info(this.constructor.name,"Disabled - skipping");return Promise.resolve(e)}if(!this._renderTexture){const o=e.getDimensions().floor();this._renderTexture=new T.RenderTexture(this._sdk.getRenderer(),o.x,o.y)}const t=this._sdk.getRenderer();let i;let r;if(P.canLog("info")){r=new Al(this.constructor.name,"Rendering")}if(this.isDirtyForRenderer(t)){this._sprite.setTexture(e);const o=this.getNewDimensions(e.getDimensions()).floor();this._renderTexture.resizeTo(o);this._renderTexture.clear();i=this._render(e).then((n=false)=>{this.setDirtyForRenderer(n,t);return this._renderTexture})}else{P.info(this.constructor.name,"Rendering from cache");i=Promise.resolve(this._renderTexture)}return i.then(o=>{if(r)r.stop();return o})}_render(e){let t;if(this._sdk.getRenderer().isOfType(H.WEBGL)){t=this._renderWebGL.bind(this)}else{t=this._renderCanvas.bind(this)}return t(e)}_renderWebGL(e){throw new Error("Operation#_renderWebGL is abstract and not implemented in inherited class.")}_renderCanvas(e){throw new Error("Operation#_renderCanvas is abstract and not implemented in inherited class.")}getNewDimensions(e){return e.clone()}onBeforeExport(){if(this.transform&&this._tempTransformChange){this.transform(this._tempTransformChange)}this._onBeforeExport()}onAfterExport(){if(this.transform&&this._tempInverseTransformChange){this.transform(this._tempInverseTransformChange)}this._onAfterExport()}_onBeforeExport(){}_onAfterExport(){}setTemporaryTransformChange(e,t){this._tempTransformChange=e;this._tempInverseTransformChange=t}reset(){this._dirty=true;this._glslPrograms={}}isDirtyForRenderer(e){const t=this._dirtiness[e.id];return typeof t==="undefined"?true:t}setDirtyForRenderer(e,t,i=false){this._dirtiness[t.id]=e}setDirty(e,t=false){for(const i in this._dirtiness){this.setDirtyForRenderer(e,{id:i},t)}}getSDK(){return this._sdk}getInputDimensions(e=true){let t=this._sdk.getInputDimensions();if(e){t.multiply(this._sdk.getZoom()).floor()}let i;this._sdk.getOperationsStack().forEach(r=>{if(i)return;if(r===this){i=true;return}t=r.getNewDimensions(t)});return t.floor()}clone(){const e=this.constructor;return new e(this._sdk,this.serializeOptions())}disposeRenderTextures(){if(this._renderTexture){this._renderTexture.dispose()}this._renderTexture=null}dispose(){this.disposeRenderTextures();this._sprite.dispose()}};xd.identifier=null;le=xd});var IE,Il,fy;var gy=_(()=>{us();zi();vd();({OptionType:IE}=bt);Il=class extends le{getRotation(){let e=0;switch(this.getTags().Orientation){case 7:case 8:e=-90;break;case 3:case 4:e=-180;break;case 5:case 6:e=90;break}return e}_getFlipVertically(){const{Orientation:e}=this.getTags();return[5,7].indexOf(e)!==-1}_getFlipHorizontally(){const{Orientation:e}=this.getTags();return[2,4].indexOf(e)!==-1}_getFinalOptions(){return{rotation:this.getRotation(),flipVertically:this._getFlipVertically(),flipHorizontally:this._getFlipHorizontally()}}_render(e){const t=this._getFinalOptions();const i=t.rotation%360;const r=i*(Math.PI/180);this._sprite.setScale(t.flipHorizontally?-1:1,t.flipVertically?-1:1);this._sprite.setRotation(r);this._sprite.setAnchor(.5,.5);this._sprite.updateTransform();const o=this._sprite.getBounds();this._renderTexture.resizeTo(new L(o.width,o.height));this._sprite.setPosition(this._renderTexture.getDimensions().divide(2));this._renderTexture.render(this._container);return Promise.resolve()}getNewDimensions(e){const t=this._getFinalOptions();e=e.clone();if(t.rotation%180){e.flip()}return e}applyTo(e){const t=this._getFinalOptions();const i=R.createCanvas();if(Math.abs(t.rotation%180)===90){i.width=e.height;i.height=e.width}else{i.width=e.width;i.height=e.height}const r=i.getContext("2d");const o=t.rotation*Math.PI/180;const n=.5*(i.width-e.width);const a=.5*(i.height-e.height);r.translate(n,a);r.translate(.5*e.width,.5*e.height);r.rotate(o);r.translate(-.5*e.width,-.5*e.height);if(t.flipVertically){r.translate(0,e.height);r.scale(1,-1)}if(t.flipHorizontally){r.translate(e.width,0);r.scale(-1,1)}r.drawImage(e,0,0);return i}};Il.identifier="exif-orientation";Il.prototype.availableOptions={tags:{type:IE.OBJECT,default:{}}};fy=Il});var Lo={};Me(Lo,{ExifOrientationOperation:()=>fy});var wd=_(()=>{gy()});var Cd,_y;var yy=_(()=>{ei();Ft();ta();es();Ro();Sl();pi();Cd=class extends X{constructor(e,t={}){super(t);this._sdk=e}export(){const{imageFormat:e,transparent:t}=this._options;const i=r=>{if(!r.renderDone){return this._sdk.render().then(o=>{return i(o)})}return r};return this.validateSettings().then(()=>{return this._prepareSDK().then(r=>{return i(r)})}).then(r=>{const{outputTexture:o,renderDone:n}=r;const a=this._sdk.getRenderer();const l=a.getClearColor();if(e==="image/png"&&t){a.setClearColor(new E(0,0,0,0))}let u=a.getCanvas();if(a.isOfType(H.WEBGL)){u=this._createCanvasFromTexture(o)}a.setClearColor(l);return this._encodeImageFormat(u)}).then(r=>{return this._restoreExifMetadata(r,e)}).then(r=>{return this._restoreSDK().then(()=>r)})}_restoreExifMetadata(e,t,i){if(t===Zr.JPEG){const r=this._sdk.getExif();if(r){if(true){if(typeof e==="string"){e=r.restoreSegments(e)}}if(false){const{renderType:o}=this._options;if(o===St.BUFFER){e=Buffer.from(r.restoreSegmentsInArray([...e]))}else if(o===St.DATAURL&&typeof e==="string"){e=r.restoreSegments(e)}}}}return Promise.resolve(e)}_encodeAsDataURL(e,t,i){if(R.isBrowser){const r=e.toDataURL(t,i);ke(e);return Promise.resolve(r)}try{const r=e.toDataURL(t,i);ke(e);return Promise.resolve(r)}catch(r){return Promise.error(r)}}_encodeAsHTMLImage(e,t,i){return this._encodeAsDataURL(e,t,i).then(r=>{const o=new ft;o.src=r;ke(e);return Promise.resolve(o)})}_encodeAsBuffer(e,t,i){if(false){if(t===Zr.JPEG){const r=e.toBuffer(t,{quality:i,progressive:true,chromaSubsampling:false});ke(e);return Promise.resolve(r)}if(t===Zr.PNG){const r=e.toBuffer(t,{quality:i});ke(e);return Promise.resolve(r)}if(t===Zr.RAW){const r=e.toBuffer(t);ke(r);return Promise.resolve(r)}return Promise.reject(new Error(`Unsupported imageFormat: ${t}`))}return Promise.reject(new Error("Unsupported platform for RenderType"))}_encodeAsMSBlob(e,t,i){const r=e.msToBlob();ke(e);return Promise.resolve(r)}_encodeAsBLOB(e,t,i){return new Promise((r,o)=>{e.toBlob(n=>{r(n)},t,i)})}_encodeImageFormat(e){const{imageFormat:t,quality:i}=this._options;let{renderType:r}=this._options;if(r===St.BLOB&&e.msToBlob&&!e.toBlob){r=St.MSBLOB}switch(r){case St.IMAGE:{return this._encodeAsHTMLImage(e,t,i)}case St.DATAURL:{return this._encodeAsDataURL(e,t,i)}case St.BUFFER:{return this._encodeAsBuffer(e,t,i)}case St.MSBLOB:{return this._encodeAsMSBlob(e,t,i)}case St.BLOB:{return this._encodeAsBLOB(e,t,i)}}return Promise.reject(new Error(`Unsupported RenderType: ${r}!`))}_prepareSDK(){const e=this._sdk.getRenderer();this._sdkSettings={dimensions:e.getDimensions().clone(),textureQuality:this._sdk.getTextureQuality(),rendererPixelRatio:e.getPixelRatio(),renderMode:this._sdk.getRenderMode()};this._sdk.setRenderMode("export");this._sdk.setTextureQuality(1);const t=e.isOfType(H.CANVAS);e.setPixelRatio(1);e.resizeTo(this._sdk.getFinalDimensions(),t);this._sdk.setAllOperationsToDirty(true);const i=this._sdk.getOperationsStack();i.forEach(r=>{r.disposeRenderTextures()});i.disableCache();return this._sdk.render()}_restoreSDK(){const e=this._sdk.getOperationsStack();e.enableCache();this._sdk.setRenderMode(this._sdkSettings.renderMode);const t=this._sdk.getRenderer();const i=t.isOfType(H.CANVAS);t.setPixelRatio(this._sdkSettings.rendererPixelRatio);t.resizeTo(this._sdkSettings.dimensions,i);this._sdk.setTextureQuality(this._sdkSettings.textureQuality);this._sdk.setAllOperationsToDirty(true);return this._sdk.render()}_createCanvasFromTexture(e){const t=this._sdk.getRenderer();const i=this._sdk.getFinalDimensions();const r=this._sdk.getRenderer().getContext();const o=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,o);const n=e.getBaseTexture().getGLTextureForRenderer(t);r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,n,0);const a=new Uint8Array(i.x*i.y*4);r.readPixels(0,0,i.x,i.y,r.RGBA,r.UNSIGNED_BYTE,a);const l=this._checkPixelsForTransparency(a);let u;if(l){const d=new T.Sprite(e);d.setFilters([new T.Filters.UnpremultiplyFilter]);const f=new T.Container;f.addChild(d);u=new T.RenderTexture(t,i.x,i.y);u.render(f);const b=u.getBaseTexture().getGLTextureForRenderer(t);r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,b,0);r.readPixels(0,0,i.x,i.y,r.RGBA,r.UNSIGNED_BYTE,a);t.setRenderTarget();u.dispose()}const c=R.createCanvas();c.width=i.x;c.height=i.y;const h=c.getContext("2d");const m=h.createImageData(i.x,i.y);m.data.set(a);h.putImageData(m,0,0);r.deleteFramebuffer(o);return c}_checkPixelsForTransparency(e){const t=this._sdk.getFinalDimensions();const i=t.x*t.y*4;let r;for(let o=3;o<i;o+=4){r=e[o];if(r!==255){return true}}return false}};Cd.prototype.availableOptions={renderType:{type:p.STRING,available:R.values(St),default:St.IMAGE},imageFormat:{type:p.STRING,available:R.values(Zr),default:Zr.PNG},quality:{type:p.NUMBER,default:.8},transparent:{type:p.BOOLEAN,default:true}};_y=Cd});var PE,BE,Vt,by,ME,Dd,kd,ji,LE,cN,Ee,zE,UE,xy,vy,Ie;var wy=_(()=>{us();_d();Sl();yy();yd();bd();wd();({Rectangle:PE,Constants:BE,Engine:Vt,Utils:by,EventEmitter:ME,Events:Dd,Vector2:kd,Log:ji,Base64:LE,Color:cN}=ea);Ee=s=>by.byteArrayToString(LE.decode(s));({RenderType:zE,ImageFormat:UE,RendererType:xy}=BE);vy=class extends ME{constructor(e,t={}){super();I(this,"_onContextLost",()=>{this.emit("context-lost")});I(this,"_initWatermark",()=>{if(this._options.watermark&&this._options.watermark.watermarkURI){this._watermarkOperation=this.createOperation("watermark",{watermarkURI:this._options.watermark.watermarkURI,alignment:this._options.watermark.alignment,inset:this._options.watermark.inset,size:this._options.watermark.size,crossOrigin:this._options.crossOrigin})}});this._onOperationUpdate=this._onOperationUpdate.bind(this);this._onContextRestored=this._onContextRestored.bind(this);this.version="3.9.0";this[Ee("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]=true;this._preferredRenderer=e;this._options={...t,extensions:{},renderMode:"dynamic",versionCheck:true,displayWelcomeMessage:true,image:null,canvas:null,transparent:false,textureQuality:1,zoom:1,spriteScale:1,rotation:0,smoothDownscaling:false,smoothUpscaling:false,crossOrigin:"anonymous",logLevel:"warn",pixelRatio:Math.max(typeof window!=="undefined"&&window.devicePixelRatio||1,1)};if(this._options.smoothUpscaling){Vt.BaseTexture.DefaultMagFilter=Vt.BaseTexture.LinearFilter}this._options.extensions=Object.assign(this._options.extensions,{operations:[],controls:[],languages:[]});ji.setLevel(this._options.logLevel);this[Ee("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]=false;if(!this[Ee("X29wdGlvbnM=")][Ee("bGljZW5zZQ==")]){this[Ee("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]=true;this._l=new ea[Ee("RnJlZUxpY2Vuc2VDaGVja2Vy")]}else{const r=ea[Ee("TGljZW5zZUNoZWNrZXI=")];this._l=new r(this[Ee("X29wdGlvbnM=")][Ee("bGljZW5zZQ==")]);this._cv(true).then(()=>{this._ct()}).catch(o=>{ji.error(Ee("TGljZW5zaW5n"),o.message)})}this._defaultRenderMode=this._options.renderMode;this._renderMode=this._options.renderMode;this._textureQuality=this._options.textureQuality;this._offset=new kd;this._zoom=this._options.zoom;this._spriteScale=this._options.spriteScale;this._rotation=this._options.rotation;this._operations={};this._operationsStack=null;this.setOperationsStack(new Ol);this._container=new Vt.Container;this._sprite=new Vt.Sprite;this._container.addChild(this._sprite);this._inputTexture=this._options.inputTexture;this._currentInputTexture=null;this._currentTexture=null;this._resizedTexture=null;this._resizedContainer=new Vt.Container;this._resizedSprite=new Vt.Sprite;this._resizedContainer.addChild(this._resizedSprite);this._texturesToDispose=[];this.setSmoothDownscaling(this._options.smoothDownscaling);this._registerOperations();this._initRenderer();const i=this._renderer.constructor.type;if(this._options.displayWelcomeMessage){if(false){ji.log("Version:",`${this.version} (${i}) - https://img.ly/photo-sdk`)}}if(this[Ee("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]){ji.log(Ee("VGhlIFBob3RvRWRpdG9yIFNESyBpcyBhIGNvbW1lcmNpYWwgcHJvZHVjdC4gQmVmb3JlIGJlaW5nIGFibGUgdG8gdXNlIGl0IHdpdGhvdXQgbGltaXRhdGlvbnMsIHlvdSBuZWVkIHRvIHVubG9jayB0aGUgU0RLIHdpdGggYSBsaWNlbnNlIGZpbGUuIFlvdSBjYW4gb2J0YWluIGEgdGltZS1saW1pdGVkIGV2YWx1YXRpb24gbGljZW5zZSBieSBzdGFydGluZyBhIHRyaWFsIGF0IGh0dHBzOi8vd3d3LmltZy5seS9zaWdudXAgb3IgeW91IGNhbiBwdXJjaGFzZSBhIGxpY2Vuc2UgYnkgcmVxdWVzdGluZyBhIHF1b3RlIGF0IGh0dHBzOi8vd3d3LmltZy5seS9wcmljaW5nLgoKQmVjYXVzZSB5b3UgZGlkIG5vdCBzcGVjaWZ5IGEgbGljZW5zZSBmaWxlIHlldCwgdGhlIFNESyB3aWxsIG5vdyBkaXNwbGF5IGEgd2F0ZXJtYXJrIGltYWdlIG9uIHRvcCBvZiBhbnkgcGhvdG9zIHlvdSBkaXNwbGF5IG9yIGV4cG9ydCB3aXRoIGl0LiBGb3IgaW5zdHJ1Y3Rpb25zIGZvciBob3cgdG8gdW5sb2NrIHRoZSBTREssIHBsZWFzZSB2aXNpdCBodHRwczovL2ltZy5seS9kb2NzL3Blc2RrL3dlYi9pbnRyb2R1Y3Rpb24vZ2V0dGluZ19zdGFydGVkLg=="))}if(this._options.image){this.setImage(this._options.image,this._options.exif)}}_ct(){if(this._l.exp()){const e=this._l.isExp();if(e){ji.error(Ee("TGljZW5zaW5n"),Ee("WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAaW1nLmx5Lg=="))}else{ji.warn(Ee("TGljZW5zaW5n"),Ee("WW91ciB0cmlhbCBsaWNlbnNlIHdpbGwgZXhwaXJlIGluICVkIGRheXMu").replace("%d",this._l.dl()))}}}_cv(e=false){return this._l.c().catch(t=>{this[Ee("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]=false;let i=Ee("SW52YWxpZCBsaWNlbnNlLg==");if(e){if(t.code==="ELICEXP"){i=Ee("WW91ciB0cmlhbCBsaWNlbnNlIGhhcyBleHBpcmVkLiBQbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAaW1nLmx5Lg==")}else if(t.code==="ELICINVHOST"){i=Ee("VGhlIGJ1bmRsZSBpZGVudGlmaWVycyB0aGF0IHlvdSBzcGVjaWZpZWQgaW4geW91ciBsaWNlbnNlIGZpbGUgZG8gbm90IG1hdGNoIHRoZSBhcHAncyBidW5kbGUgaWRlbnRpZmllci4gUGxlYXNlIHVwZGF0ZSBhbmQgcmVkb3dubG9hZCB5b3VyIGxpY2Vuc2UgZnJvbSB5b3VyIGN1c3RvbWVyIGRhc2hib2FyZCBhdCBodHRwczovL3d3dy5pbWcubHkvbG9naW4u")}else if(t.code==="ELICINVPLAT"){i=Ee("VGhlIGxpY2Vuc2UgdGhhdCB5b3Ugc3BlY2lmaWVkIGlzIGZvciBhbm90aGVyIHBsYXRmb3JtLiBQbGVhc2UgZG93bmxvYWQgeW91ciBsaWNlbnNlIGZvciB0aGUgd2ViIHBsYXRmb3JtIGZyb20geW91ciBjdXN0b21lciBkYXNoYm9hcmQgYXQgaHR0cHM6Ly93d3cuaW1nLmx5L2xvZ2luLg==")}else if(t.code==="ELICINVFMT"){i=Ee("SW52YWxpZCBsaWNlbnNlIGZvcm1hdC4gUGxlYXNlIG1ha2Ugc3VyZSB5b3UncmUgcGFzc2luZyB5b3VyIGxpY2Vuc2UgYXMgYSBzdHJpbmcsIG5vdCBhcyBgJGZvcm1hdGAu").replace("$format",typeof this._options.license)}else if(t.code==="ELICINV"){i=Ee("VGhlIHNpZ25hdHVyZSBvZiB5b3VyIGxpY2Vuc2UgaXMgbm90IHZhbGlkLiBQbGVhc2UgdHJ5IHRvIHJlZG93bmxvYWQgeW91ciBsaWNlbnNlIGZyb20geW91ciBjdXN0b21lciBkYXNoYm9hcmQgYXQgaHR0cHM6Ly93d3cuaW1nLmx5L2xvZ2luLg==")}else{i=Ee("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAaW1nLmx5IHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")}}t.message=i;throw new Error(t)})}_t(){this._l.t()}_fl(){return this[Ee("Wm5KbFpVeHBZMlZ1YzAxdlpHVT0=")]}_onOperationUpdate(...e){this.emit(Dd.OPERATION_UPDATED,...e)}_onContextRestored(){ji.warn(this.constructor.name,"Trying to re-render after WebGL context has been restored.");this.setAllOperationsToDirty();this._operationsStack.forEach(e=>{e.disposeRenderTextures()});this.render()}export(e=zE.DATAURL,t=UE.PNG,i=.8,r=true){return this._cv(true).then(()=>{if(this.hasChanges()){this._t()}this._operationsStack.forEach(n=>{n.onBeforeExport()});const o=new _y(this,{renderType:e,imageFormat:t,quality:i,transparent:r});return o.export().then(n=>{this._operationsStack.forEach(a=>{a.onAfterExport()});return Promise.resolve(n)})})}render(e=true){if(!this._inputTexture){throw new Error("You need to set an image before calling PhotoEditorSDK#render.")}const t=this._renderer.getContext();if(t.startFrame){t.startFrame()}let i;if(ji.canLog("info")){i=new Al("\u26A1\u26A1\u26A1","Frame rendering")}ji.info("\u26A1\u26A1\u26A1","Rendering starts");const r=this._operationsStack;r.updateDirtinessForRenderer(this._renderer);return this._prepareTexture().then(o=>{if(this._renderMode==="export"){o=this._inputTexture}this._currentTexture=o;this._sprite.setTexture(o);this._container.updateTransform()}).then(()=>r.validateSettings()).then(()=>{if(this._fl()||!this[Ee("VG04Z1lHRndhVXRsZVdBZ2IzQjBhVzl1SUdkcGRtVnU=")]){if(!r.getByIdentifier("license-watermark")){this.createOperation("license-watermark")}else{r.moveToTop("license-watermark")}}if(!r.getByIdentifier("watermark")){this._initWatermark()}else{r.moveToTop("watermark")}return r.render(this,this._currentTexture)}).then(o=>{const{outputTexture:n}=o;this._currentTexture=n;this._sprite.setTexture(this._currentTexture);switch(this._renderMode){case"dynamic":{const a=this._renderer.getDimensions().clone().divide(2).add(this._offset);this._container.setScale(this._zoom/this.getTextureScale(),this._zoom/this.getTextureScale());this._container.setPosition(a);this._sprite.setAnchor(.5,.5);this._sprite.setScale(this._spriteScale,this._spriteScale);this._sprite.setRotation(this._rotation);break}case"export":this._container.setScale(1,1);this._container.setPosition(0,0);this._sprite.setAnchor(0,0);this._sprite.setPosition(0,0);this._sprite.setScale(this._spriteScale,this._spriteScale);this._sprite.setRotation(0);break;case"adapter":this._container.setScale(1,1);this._container.setPosition(0,0);this._sprite.setAnchor(0,0);this._sprite.setPosition(0,0);this._sprite.setScale(1,1);this._sprite.setRotation(0);break}if(e){this._renderer.render(this._container)}return o}).then(o=>{if(i){i.stop()}if(t.endFrame){t.endFrame()}this._disposeTextures();return o})}getTextureScale(){return Math.min(1,this._textureQuality*this._options.pixelRatio)}_prepareTexture(){return new Promise((e,t)=>{const i=this.getTextureScale();if(this._textureQuality===1){return e(this._inputTexture)}const r=this.getInputDimensions().multiply(i).floor();let o;if(!this._resizedTexture){this._resizedTexture=new Vt.RenderTexture(this._renderer,r.x,r.y);o=true}else if(!this._resizedTexture.getDimensions().equals(r)){this._resizedTexture.resizeTo(r);o=true}if(o){this._resizedSprite.setScale(i,i);this._resizedSprite.setTexture(this._inputTexture);this._resizedTexture.render(this._resizedContainer)}e(this._resizedTexture)})}_registerOperations(){this._operations={};for(const e in Lo){const t=Lo[e];this._operations[t.identifier]=t}this._operations={...this._operations,...this._options.extensions.operations}}registerOperations(e){e.forEach(t=>{this._operations[t.identifier]=t})}setAllOperationsToDirty(e=false){this._operationsStack.setAllToDirty(e)}createOperation(e,t={},i=true){const r=this._operations[e];if(!r){throw new Error(`No operation with identifier \`${e}\` found.`)}const o=new r(this,t);if(i){this.addOperation(o)}return o}addOperation(e){this._operationsStack.push(e)}removeOperation(e){this._operationsStack.remove(e)}getInputDimensions(){const e=this._inputTexture.getFrame();return new kd(e.width,e.height)}getFinalDimensions(e=false){let t=this.getInputDimensions();const i=this._operationsStack;i.forEach(r=>{if(!r.getEnabled())return;t=r.getNewDimensions(t)});if(e){t.multiply(this._spriteScale)}return t.floor()}getOutputDimensions(e=false){return this.getFinalDimensions(e).clone().multiply(this._zoom).floor()}getOutputTextureDimensions(e=false){const t=this.getTextureScale();let i=this.getInputDimensions().multiply(t).floor();this._operationsStack.forEach(r=>{i=r.getNewDimensions(i)});return i}getCrossOrigin(){return by.getCrossOrigin(this._options.crossOrigin||"Anonymous")}_initRenderer(){const e={canvas:this._options.canvas,pixelRatio:this._options.pixelRatio,debug:this._options.debug,transparent:this._options.transparent,clearColor:this._options.clearColor};let t;let i;if(this._renderMode!=="export"&&this._options.canvas){const{canvas:r}=this._options;t=r.width;i=r.height}else if(this._inputTexture){const r=this.getFinalDimensions();t=r.x;i=r.y}else{t=1;i=1}switch(this._preferredRenderer){case xy.WEBGL:this._renderer=Vt.autoDetectRenderer(t,i,e);this._renderer.on("context-restored",this._onContextRestored);this._renderer.on("context-lost",this._onContextLost);break;case xy.CANVAS:this._renderer=Vt.canvasRenderer(t,i,e);this._renderer.on("context-restored",this._onContextRestored);break;default:ji.warn("PhotoEditorSDK",`PhotoEditorSDK Error: Renderer \`${this._preferredRenderer}\` not supported. Falling back to automatically detected renderer.`);this._renderer=Vt.autoDetectRenderer(t,i,e)}}resizeTo(e){this._renderer.resizeTo(e,true)}reset(){this._operationsStack.clear()}parseExif(e){if(!e){return}let{src:t}=e;let i=false;let r=null;if(true){i=sa.isJPEG(t);r=t}else if(e instanceof ft&&e.rawSource){let o=e.rawSource;if(!(e.rawSource instanceof Buffer)){const n=e.rawSource.replace("data:image/jpeg;base64,","");o=Buffer.from(n,"base64");t=e.rawSource}else{t=e.rawSource.toString("base64")}i=sa.bufferIsJPEG(o);if(i){r=t}}if(i){let o=null;try{o=sa.fromBase64String(r)}catch(n){}if(!o){return}return o}}_handleExifOrientation(){const e=this._exif.getTags();if(e&&e.Orientation){const t=e.Orientation!==1&&e.Orientation!==2;const i=[2,4,5,7].indexOf(e.Orientation)!==-1;if(t||i){if(typeof navigator==="undefined"){if(!this._exifOperation){this._exifOperation=this.createOperation("exif-orientation")}this._exifOperation.setTags(e)}else{const r=window&&window.navigator&&window.navigator.userAgent||"";if(!!r.match(/msie|trident/i)||r.indexOf("Edge")!==-1||!CSS.supports("image-orientation","from-image")){if(!this._exifOperation){this._exifOperation=this.createOperation("exif-orientation")}this._exifOperation.setTags(e)}}this._exif.setOrientation(1)}}}correctExifOrientation(e){const t=this.parseExif(e);if(!t){return e}const i=t.getTags();if(i&&i.Orientation){const r=i.Orientation!==1&&i.Orientation!==2;const o=[2,4,5,7].indexOf(i.Orientation)!==-1;if(r||o){if(typeof navigator==="undefined"){const n=this.createOperation("exif-orientation",{},false);n.setTags(i);e=n.applyTo(e)}else{const n=window&&window.navigator&&window.navigator.userAgent||"";if(!!n.match(/msie|trident/i)||n.indexOf("Edge")!==-1||!CSS.supports("image-orientation","from-image")){const a=this.createOperation("exif-orientation",{},false);a.setTags(i);e=a.applyTo(e)}}t.setOrientation(1);i.Orientation=1;return e}}return e}hasImage(){return this._image!==null&&typeof this._image!=="undefined"}getImage(){return this._image}disposeTexture(e){this._texturesToDispose.push(e)}_disposeTextures(){for(let e=0;e<this._texturesToDispose.length;e++){this._texturesToDispose[e].dispose()}this._texturesToDispose=[]}setImage(e,t=null,i=null){this._disposeTextures();if(this._exifOperation){this.removeOperation(this._exifOperation);this._exifOperation=null}this._options.image=e;this._image=e;this._exif=t||this.parseExif(e);if(this._exif){this._handleExifOrientation()}const r=new Vt.BaseTexture(this._image);const o=new PE(0,0,this._image.naturalWidth||this._image.width,this._image.naturalHeight||this._image.height);if(i){o.width=i.x;o.height=i.y}if(this._resizedTexture){this._resizedTexture.dispose()}this._resizedTexture=null;if(this._inputTexture){this.disposeTexture(this._inputTexture.getBaseTexture())}this._inputTexture=new Vt.Texture(r,o);this._currentTexture=this._inputTexture;this._sprite.clearTexture(false);this._sprite.setTexture(this._inputTexture);this.emit("new-image");this.setAllOperationsToDirty(true)}setInputTexture(e){this._inputTexture=e}getCanvas(){return this._renderer.getCanvas()}setCanvas(e){this._renderer.setCanvas(e)}getSprite(){return this._sprite}getContainer(){return this._container}getOperationsStack(){return this._operationsStack}setOperationsStack(e){if(this._operationsStack){this._operationsStack.off(Dd.OPERATION_UPDATED,this._onOperationUpdate)}this._operationsStack=e;this._operationsStack.on(Dd.OPERATION_UPDATED,this._onOperationUpdate)}getOperations(){return this._operations}getRenderer(){return this._renderer}getOffset(){return this._offset}setOffset(e,t){if(e instanceof kd){this._offset.copy(e)}else{this._offset.set(e,t)}}getRenderMode(){return this._renderMode}setRenderMode(e){this._renderMode=e}getZoom(){return this._zoom}setZoom(e){this._zoom=e;this._container.setScale(this._zoom,this._zoom);this._container.updateTransform()}getTextureQuality(){if(this._renderMode==="export"){return 1}return this._textureQuality}setTextureQuality(e){if(e!==this._textureQuality){this.setAllOperationsToDirty(true)}this._textureQuality=Math.min(1,e);if(this._textureQuality===1&&this._resizedTexture){this._resizedTexture.dispose();this._resizedTexture=null}}getSpriteScale(){return this._spriteScale}setSpriteScale(e){this._spriteScale=e;this._sprite.setScale(e,e);this._sprite.updateTransform()}getPixelRatio(){return this._options.pixelRatio}getExif(){return this._exif}getOptions(){return this._options}getInputTexture(){return this._inputTexture}setSmoothDownscaling(e){this._options.smoothDownscaling=e;this._sprite.setSmoothDownscaling(e);this._resizedSprite.setSmoothDownscaling(e)}setRotation(e){this._rotation=e}getRotation(){return this._rotation}hasChanges(){return this.getOperationsStack().hasChanges()}dispose(){this._operationsStack.dispose();this._renderer.dispose();if(this._exif){this._exif.dispose()}if(this._resizedTexture){this._resizedTexture.dispose()}}};Ie=vy});var NE,q;var oa=_(()=>{ti();qg();Ft();ta();bo();es();Ro();sy();Do();_d();Sl();ld();dd();yd();pi();wd();vd();wy();Ie.version="3.9.0";Ie.Math=M;Ie.Operations=Lo;Ie.Engine=T;Ie.Color=E;Ie.LicenseChecker=Dl;Ie.Operation=le;Ie.EventEmitter=mt;Ie.Utils=R;Ie.Env=ry;Ie.OperationsStack=Ol;Ie.EXIF=sa;Ie.Image=ft;Ie.Configurable=X;Ie.Log=P;Ie.Loaders=Om;Ie.RenderType=St;Ie.ImageFormat=Zr;Ie.OptionType=p;Ie.RendererType=H;Ie.UniformType=O;Ie.Base64=Ut;NE={};Ie.UI=NE;q=Ie});var F=_(()=>{oa();oa()});var Dy;var Cy=_(()=>{Dy="precision highp float;\n\nvarying vec2 v_texCoord;\nuniform sampler2D u_image;\n\nuniform float u_gamma;\nuniform float u_shadows;\nuniform float u_highlights;\nuniform float u_whites;\nuniform float u_blacks;\n\nuniform mat4 u_colorMatrix;\nuniform vec4 u_colorOffset;\n\nconst float EPSILON = 0.0000001;\n\nfloat calculateLuminance(vec3 rgb) {\n    // This is the luminance calculation part of the RGB to HSL formular.\n    vec4 p = mix(\n        vec4(rgb.gb, 0.0, -1.0 / 3.0),\n        vec4(rgb.bg, -1.0, 2.0 / 3.0),\n        vec4(rgb.g < rgb.b)\n    );\n\n    vec4 q = mix(\n        vec4(rgb.r, p.yzx),\n        vec4(p.xyw, rgb.r),\n        vec4(rgb.r < p.x)\n    );\n\n    float croma = q.x - min(q.w, q.y);\n    float luminance = q.x - croma * 0.5;\n    return luminance;\n}\n\nvec3 map(vec3 x, float in_min, float in_max, float out_min, float out_max){\n  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;\n}\n\nvoid main() {\n\n  vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);\n  color.rgb /= max(color.a, EPSILON); // Revert premultiplied alpha\n\n  // Apply gamma\n  if (u_gamma != 1.0) {\n    color.rgb = pow(color.rgb, vec3(1.0 / max(u_gamma, EPSILON)));\n  }\n\n  // Apply shadows and highlights\n  float luminance = calculateLuminance(color.rgb);\n\n  float shadow = u_shadows >= 0.0\n    ? clamp(\n          pow(luminance, 1.0 / (u_shadows + 1.0))\n          + pow(luminance, 2.0 / (u_shadows + 1.0)) * -0.76\n          - luminance\n    , 0.0, max(u_shadows, 1.0))\n    : -clamp(\n          pow(luminance, 1.0 / (-u_shadows + 1.0))\n          + pow(luminance, 2.0 / (-u_shadows + 1.0)) * -0.76\n          - luminance\n    , 0.0, max(-u_shadows, 1.0));\n\n  float highlight = u_highlights < 0.0\n    ? clamp(\n          1.0\n          - pow(1.0 - luminance, 1.0 / (1.0 - u_highlights))\n          - pow(1.0 - luminance, 2.0 / (1.0 - u_highlights)) * -0.8\n          - luminance\n     , -1.0, 0.0)\n    : -clamp(\n          1.0\n          - pow(1.0 - luminance, 1.0 / (1.0 + u_highlights))\n          - pow(1.0 - luminance, 2.0 / (1.0 + u_highlights)) * -0.8\n          - luminance\n     , -1.0, 0.0);\n\n  // Bright color need more contrast and dark color need more brightness.\n  // This is to keep saturatation because the color information of a dark colors is lost.\n  float shadowContrast   = shadow * luminance * luminance;\n  float shadowBrightness = shadow - shadowContrast;\n\n  float offset = luminance + shadowContrast + highlight;\n  color.rgb = clamp(offset * ((color.rgb + shadowBrightness) / max(luminance, EPSILON)), 0.0, 1.0);\n  \n  // Apply Color Matrix\n  color.rgb = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0).rgb;\n  color.rgb = map(color.rgb, 0.0, 1.0, u_blacks / 2.0, 1.0 + u_whites / 2.0);\n  color = clamp(color, 0.0, 1.0);\n  color.rgb *= color.a; // Reset premultiplied alpha\n\n  gl_FragColor = color;\n}\n"});function Td(s,e,t,i,r){return(s-e)*(r-i)/(t-e)+i}var WE,zo,VE,Rd,Pl;var Ed=_(()=>{F();Cy();({ColorMatrix:WE}=M);zo=1e-7;VE=s=>{const e=Math.max(s.r,s.g,s.b);const t=Math.min(s.r,s.g,s.b);return(e+t)/2};Rd=class extends T.Filter{constructor(){super();this._fragmentSource=Dy}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=n.getImageData(0,0,o.width,o.height);const{colorMatrix:u,gamma:c,shadows:h,highlights:m,whites:d,blacks:f}=this._options;const b=c!==1;const y=h!==0||m!==0;let g=new E(0,0,0,0);for(let C=0;C<o.width*o.height;C++){const v=C*4;g.r=l.data[v]/255;g.g=l.data[v+1]/255;g.b=l.data[v+2]/255;if(b){g.r=Math.pow(g.r,1/Math.max(c,zo));g.g=Math.pow(g.g,1/Math.max(c,zo));g.b=Math.pow(g.b,1/Math.max(c,zo))}if(y){const x=VE(g);const B=h>=0?R.clamp(Math.pow(x,1/(h+1))+Math.pow(x,2/(h+1))*-.76-x,0,Math.max(h,1)):-R.clamp(Math.pow(x,1/(-h+1))+Math.pow(x,2/(-h+1))*-.76-x,0,Math.max(-h,1));const w=m<0?R.clamp(1-Math.pow(1-x,1/(1-m))-Math.pow(1-x,2/(1-m))*-.8-x,-1,0):-R.clamp(1-Math.pow(1-x,1/(1+m))-Math.pow(1-x,2/(1+m))*-.8-x,-1,0);const D=B*x*x;const j=B-D;const W=x+D+w;g.r=R.clamp(W*((g.r+j)/Math.max(x,zo)),0,1);g.g=R.clamp(W*((g.g+j)/Math.max(x,zo)),0,1);g.b=R.clamp(W*((g.b+j)/Math.max(x,zo)),0,1)}g=u.apply(g).clamp(0,1);g.r=Td(g.r,0,1,f/2,1+d/2);g.g=Td(g.g,0,1,f/2,1+d/2);g.b=Td(g.b,0,1,f/2,1+d/2);l.data[v]=g.r*255;l.data[v+1]=g.g*255;l.data[v+2]=g.b*255}a.putImageData(l,0,0)}};Rd.prototype.availableOptions={gamma:{type:p.NUMBER,default:1,uniformType:O.FLOAT},shadows:{type:p.NUMBER,default:0,uniformType:O.FLOAT},highlights:{type:p.NUMBER,default:1,uniformType:O.FLOAT},whites:{type:p.NUMBER,default:0,uniformType:O.FLOAT},blacks:{type:p.NUMBER,default:0,uniformType:O.FLOAT},colorMatrix:{type:p.COLOR_MATRIX,default:new WE,uniformType:O.MAT4},colorOffset:{type:p.ARRAY,default:[],uniformType:O.FLOAT4}};Pl=Rd});var Ty;var ky=_(()=>{Ty="precision mediump float;\n\n// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE\nuniform sampler2D u_image;\n\n// Size of one pixel == vec2(1.0 / u_image.width, 1.0 / u_image.height)\nuniform vec2 u_pixelDimension;\n\n// Range (-1.0 - 1.0)\nuniform float u_clarity;\n\nvarying vec2 v_texCoord;\n\nuniform mat4 u_colorMatrix;\nuniform vec4 u_colorOffset;\n\nconst float EPSILON = 0.000001;\n\nvec4 unpremultiply(vec4 col) {\n    col.rgb /= max(col.a, EPSILON);\n    return col;\n}\n\nvoid main() {\n    vec4 color = texture2D(u_image, v_texCoord);\n    color = unpremultiply(color);\n\n    // L = Left, R = Right, C = Center, T = Top, B = Bottom\n    vec4 colLB = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x, -u_pixelDimension.y));\n    vec4 colLC = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,                 0.0));\n    vec4 colLT = texture2D(u_image, v_texCoord + vec2(-u_pixelDimension.x,  u_pixelDimension.y));\n\n    vec4 colCL = texture2D(u_image, v_texCoord + vec2(                0.0, -u_pixelDimension.y));\n    vec4 colCR = texture2D(u_image, v_texCoord + vec2(                0.0,  u_pixelDimension.y));\n    \n    vec4 colRB = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x, -u_pixelDimension.y));\n    vec4 colRC = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,                 0.0));\n    vec4 colRT = texture2D(u_image, v_texCoord + vec2( u_pixelDimension.x,  u_pixelDimension.y));\n\n    vec4 mergedColor = color;\n    mergedColor.rgb += unpremultiply(colLB).rgb + unpremultiply(colLC).rgb + unpremultiply(colLT).rgb;\n    mergedColor.rgb += unpremultiply(colCL).rgb + unpremultiply(colCR).rgb;\n    mergedColor.rgb += unpremultiply(colRB).rgb + unpremultiply(colRC).rgb + unpremultiply(colRT).rgb;\n\n    mergedColor /= 9.0;\n\n    float grayValue = clamp(color.r * 0.3 + color.g * 0.59 + color.b * 0.1, 0.111111, 0.999999);\n    // 1.0 and 0.0 result in white not black, therefore we clamp\n\n    // Here we create a function that will map values below 0.1 to 0. Values above 0.2 will be mapped to 1,\n    // and for values between 0.1 and 0.2 it will produce a gradient.\n    // The funtion is mirror at 0.5, meaning values between 0.8 and 0.9 will result in a decending gradient.\n    // And values above 0.9 will be mapped to 0.\n    float frequenceFactor = min(smoothstep(1.0 - grayValue, 0.0, 0.11), smoothstep(grayValue, 0.0, 0.11));\n\n    // here we apply the high pass filter. Its strength is determined by the uniform ,\n    // and the frequence factor. That means the only the mid tones are affected by this filter.\n    // Clarity input is ranging from -1 to 1. But we want to strengthen the effect.\n    // Therefore we see this little magic number '3.7'.\n    color.rgb = clamp(color + clamp((color - mergedColor) * u_clarity * 3.7 * frequenceFactor, 0.0, 10.0), 0.0, 1.0).rgb;\n\n    // apply exposure but only to the mid tones.\n    color.rgb = color.rgb * pow(2.0, u_clarity * 0.27 * frequenceFactor);\n\n    // apply contrast and desaturation matrix\n    color.rgb = clamp(color * u_colorMatrix + u_colorOffset, 0.0, 1.0).rgb;\n\n    color.rgb *= color.a; // Premultiply alpha\n\n    gl_FragColor = clamp(color, 0.0, 1.0);\n}\n"});var HE,qE,Sd,Ry;var Ey=_(()=>{F();ky();({Vector2:HE,ColorMatrix:qE}=M);Sd=class extends T.Filter{constructor(){super();this._fragmentSource=Ty}_applyCanvas(e,t,i,r=false){const o=i.getContext();const n=t.getCanvas();const a=t.getContext();const{clarity:l}=this._options;const{colorMatrix:u}=this._options;const c=new E(this._options.colorOffset[0],this._options.colorOffset[1],this._options.colorOffset[2],this._options.colorOffset[3]);const{width:h}=n;const{height:m}=n;const d=a.getImageData(0,0,h,m);const f=o.createImageData(h,m);this.canvasShader(d,f,l,u,c);o.putImageData(f,0,0)}canvasShader(e,t,i,r,o){const n=(g,C,v)=>Math.min(Math.max(g,C),v);const a=(g,C,v)=>{const x=n((v-g)/(C-g),0,1);return x*x*(3-2*x)};const l=e.width*4;const{length:u}=e.data;const c=u-1;const h=0;const m=e.data;const d=t.data;const f=new E;const b=255*9;const y=g=>{g=g<h?h:g;g=g>c?c:g;return m[g]};for(let g=0;g<u;g+=4){let C=y(g+0);let v=y(g+1);let x=y(g+2);let B=y(g+3);const w=(C+y(g-4-l+0)+y(g-4+0)+y(g-4+l+0)+y(g-l+0)+y(g+l+0)+y(g+4-l+0)+y(g+4+0)+y(g+4+l))/b;const D=(v+y(g-4-l+1)+y(g-4+1)+y(g-4+l+1)+y(g-l+1)+y(g+l+1)+y(g+4-l+1)+y(g+4+1)+y(g+4+l+1))/b;const j=(x+y(g-4-l+2)+y(g-4+2)+y(g-4+l+2)+y(g-l+2)+y(g+l+2)+y(g+4-l+2)+y(g+4+2)+y(g+4+l+2))/b;const W=(B+y(g-4-l+3)+y(g-4+3)+y(g-4+l+3)+y(g-l+3)+y(g+l+3)+y(g+4-l+3)+y(g+4+3)+y(g+4+l+3))/b;C/=255;v/=255;x/=255;B/=255;const J=n(C*.3+v*.59+x*.1,.111111,.999999);const te=Math.min(a(1-J,0,.11),a(J,0,.11));const Q=i*3.7*te;const K=Math.pow(2,i*.27*te);const ye=n(C+n((C-w)*Q,0,10),0,1)*K;const lt=n(v+n((v-D)*Q,0,10),0,1)*K;const Ze=n(x+n((x-j)*Q,0,10),0,1)*K;const ni=n(B+n((B-W)*Q,0,10),0,1);f.set(ye,lt,Ze,ni);const ie=r.apply(f).clamp(0,1);d[g+0]=ie.r*255;d[g+1]=ie.g*255;d[g+2]=ie.b*255;d[g+3]=ie.a*255}}};Sd.prototype.availableOptions={clarity:{type:p.NUMBER,default:0,uniformType:O.FLOAT},pixelDimension:{type:p.VECTOR2,default:new HE(100,100),uniformType:O.FLOAT2},colorMatrix:{type:p.COLOR_MATRIX,default:new qE,uniformType:O.MAT4},colorOffset:{type:p.ARRAY,default:[],uniformType:O.FLOAT4}};Ry=Sd});var Fy;var Sy=_(()=>{Fy="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform vec2 u_pixelDimension;\nuniform float u_sharpness;\n \nconst float EPSILON = 0.000001;\n \nvoid main() {\n    vec4 color = clamp(texture2D(u_image, v_texCoord), 0.0, 1.0);\n\n    float factor        = mix(0.2, -1.0, float(u_sharpness > 0.0));\n    vec4 sharpenedColor = mix(0.2,  5.0, float(u_sharpness > 0.0)) * color;\n \n    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2(-1.0,  0.0)), 0.0, 1.0);\n    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 0.0, -1.0)), 0.0, 1.0);\n    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 0.0,  1.0)), 0.0, 1.0);\n    sharpenedColor += factor * clamp(texture2D(u_image, v_texCoord + u_pixelDimension * vec2( 1.0,  0.0)), 0.0, 1.0);\n \n    color.rgb /= max(color.a, EPSILON); // unpremultiply\n    sharpenedColor.rgb /= max(sharpenedColor.a, EPSILON); // unpremultiply\n \n    sharpenedColor = clamp(sharpenedColor, 0.0, 1.0);\n \n    color = clamp(mix(color, sharpenedColor, abs(u_sharpness)), 0.0, 1.0);\n      \n    gl_FragColor = vec4(color.rgb * color.a, color.a); // premultiply\n}"});var XE,Fd,Oy;var Ay=_(()=>{F();Sy();({Vector2:XE}=M);Fd=class extends T.Filter{constructor(){super();this._fragmentSource=Fy}_applyCanvas(e,t,i,r=false){const o=i.getContext();const n=t.getCanvas();const a=t.getContext();const{sharpness:l}=this._options;const{width:u}=n;const{height:c}=n;const h=a.getImageData(0,0,u,c);const m=o.createImageData(u,c);this.canvasShader(h,m,l);o.putImageData(m,0,0)}canvasShader(e,t,i){const r=(x,B,w)=>Math.min(Math.max(x,B),w);const o=1e-6;const{width:n}=e;const{height:a}=e;const l=e.data;const u=t.data;const c=(x,B,w)=>{return x*(1-w)+B*w};const h=x=>{return r(l[x]/255,0,1)};const m=(x,B)=>{const w=r(x,0,n-1);const D=r(B,0,a-1);return 4*(w+n*D)};const d=[];const f=[];const b=[-1,0,0,1];const y=[0,-1,1,0];const g=i>0?-1:.2;const C=i>0?5:.2;const v=Math.abs(i);for(let x=0;x<n;x++){for(let B=0;B<a;B++){const w=m(x,B);d[0]=h(w+0);d[1]=h(w+1);d[2]=h(w+2);d[3]=h(w+3);f[0]=C*d[0]*d[3];f[1]=C*d[1]*d[3];f[2]=C*d[2]*d[3];f[3]=C*d[3];for(let D=0;D<4;D++){const j=b[D];const W=y[D];const J=m(x+j,B+W);const te=h(J+3);f[3]+=g*te;for(let Q=0;Q<3;Q++){f[Q]+=g*h(J+Q)*te}}for(let D=0;D<3;D++){f[D]/=Math.max(f[3],o);f[D]=r(f[D],0,1)}f[3]=r(f[3],0,1);for(let D=0;D<4;D++){d[D]=r(c(d[D],f[D],v),0,1);u[w+D]=d[D]*255}}}}};Fd.prototype.availableOptions={sharpness:{type:p.NUMBER,default:0,uniformType:O.FLOAT},pixelDimension:{type:p.VECTOR2,default:new XE(100,100),uniformType:O.FLOAT2}};Oy=Fd});var Py;var Iy=_(()=>{Py="precision mediump float;\n\n// Input Image with config WRAP_S and WRAP_T: CLAMP_TO_EDGE\nuniform sampler2D u_image;\n\n// Range (-1.0 - 1.0)\nuniform float u_temperature;\n\nconst lowp vec3 warmFilter = vec3(0.93, 0.54, 0.0);\n\nconst mediump mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.596, -0.274, -0.322, 0.212, -0.523, 0.311);\nconst mediump mat3 YIQtoRGB = mat3(1.0, 0.956, 0.621, 1.0, -0.272, -0.647, 1.0, -1.105, 1.702);\n\nconst float EPSILON = 0.0000001;\n\nvarying vec2 v_texCoord;\nvoid main() {\n  float temperature = u_temperature;\n  const float tint = 0.0;\n  vec4 source = texture2D(u_image, v_texCoord);\n\n  source.rgb /= max(source.a, EPSILON);   // Revert premultiplied alpha\n\n  vec3 yiq = RGBtoYIQ * source.rgb;\n  yiq.b = clamp(yiq.b + tint*0.5226*0.1, -0.5226, 0.5226);\n  vec3 rgb = YIQtoRGB * yiq;\n\n  vec3 processed = mix(\n    (1.0 - 2.0 * (1.0 - rgb) * (1.0 - warmFilter)),\n    (2.0 * rgb * warmFilter),\n    vec3(rgb.r < 0.5, rgb.g < 0.5, rgb.b < 0.5)\n  );\n\n  vec4 color = vec4(mix(rgb, processed, temperature), source.a);\n\n  color.rgb *= color.a;   // Premultiply alpha again\n\n  gl_FragColor = color;\n}\n"});var Od,By;var My=_(()=>{F();Iy();Od=class extends T.Filter{constructor(){super();this._fragmentSource=Py}_applyCanvas(e,t,i,r=false){const o=i.getContext();const n=t.getCanvas();const a=t.getContext();const{temperature:l}=this._options;const{width:u}=n;const{height:c}=n;const h=a.getImageData(0,0,u,c);const m=o.createImageData(u,c);this.canvasShader(h,m,l);o.putImageData(m,0,0)}canvasShader(e,t,i){const r=(g,C,v)=>Math.min(Math.max(g,C),v);const o=(g,C,v)=>g*(1-v)+C*v;const n=(g,C)=>{const v=g[0]*C[0]+g[3]*C[1]+g[6]*C[2];const x=g[1]*C[0]+g[4]*C[1]+g[7]*C[2];const B=g[2]*C[0]+g[5]*C[1]+g[8]*C[2];return[v,x,B]};const{length:a}=e.data;const l=a-1;const u=0;const c=e.data;const h=t.data;const m=g=>{g=g<u?u:g;g=g>l?l:g;return c[g]};const d=[.93,.54,0];const f=[.299,.587,.114,.596,-.274,-.322,.212,-.523,.311];const b=[1,.956,.621,1,-.272,-.647,1,-1.105,1.702];const y=0;for(let g=0;g<a;g+=4){const C=m(g+0)/255;const v=m(g+1)/255;const x=m(g+2)/255;const B=m(g+3)/255;const w=[C,v,x];const D=n(f,w);D.z=r(D.z+y*.5226*.1,-.5226,.5226);const j=n(b,D);const W=[j[0]<.5?2*j[0]*d[0]:1-2*(1-j[0])*(1-d[0]),j[1]<.5?2*j[1]*d[1]:1-2*(1-j[1])*(1-d[1]),j[2]<.5?2*j[2]*d[2]:1-2*(1-j[2])*(1-d[2])];h[g+0]=o(j[0],W[0],i)*255;h[g+1]=o(j[1],W[1],i)*255;h[g+2]=o(j[2],W[2],i)*255;h[g+3]=B*255}}};Od.prototype.availableOptions={temperature:{type:p.NUMBER,default:0,uniformType:O.FLOAT}};By=Od});var Cr,na,Ly;var zy=_(()=>{F();Ed();Ey();Ay();My();({ColorMatrix:Cr}=M);na=class extends le{constructor(...e){super(...e);this._clarityFilter=new Ry;this._temperatureFilter=new By;this._sharpnessFilter=new Oy;this._filter=new Pl;this._sprite.setFilters([this._clarityFilter,this._temperatureFilter,this._filter])}_render(e){const t=e.getDimensions();t.x=1/t.x;t.y=1/t.y;const i=new Cr;i.multiply(Cr.createSaturationMatrix(-.3*this._options.clarity+1));i.multiply(Cr.createContrastMatrix(.1*this._options.clarity+1));this._clarityFilter.set({clarity:this._options.clarity,pixelDimension:t,colorMatrix:i,colorOffset:i.getOffsets()});this._temperatureFilter.set({temperature:this._options.temperature});this._sharpnessFilter.set({sharpness:this._options.sharpness,pixelDimension:t});const r=new Cr;r.multiply(Cr.createExposureMatrix(this._options.exposure));r.multiply(Cr.createSaturationMatrix(this._options.saturation+1));r.multiply(Cr.createContrastMatrix((this._options.contrast>0?this._options.contrast*2:this._options.contrast)+1));r.multiply(Cr.createBrightnessMatrix(this._options.brightness));this._filter.set({gamma:this._options.gamma,shadows:this._options.shadows,highlights:this._options.highlights,whites:this._options.whites,blacks:this._options.blacks,colorMatrix:r,colorOffset:r.getOffsets()});const o=[];if(this._options.clarity!==0){o.push(this._clarityFilter)}if(this._options.sharpness!==0){o.push(this._sharpnessFilter)}if(this._options.temperature!==0){o.push(this._temperatureFilter)}o.push(this._filter);this._sprite.setFilters(o);this._renderTexture.render(this._container);return Promise.resolve()}dispose(){super.dispose();this._filter.dispose();this._clarityFilter.dispose();this._temperatureFilter.dispose();this._sharpnessFilter.dispose()}};na.identifier="adjustments";na.prototype.availableOptions={brightness:{type:p.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},saturation:{type:p.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},contrast:{type:p.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},gamma:{type:p.NUMBER,default:1,minValue:.5,midValue:1,maxValue:2},exposure:{type:p.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},shadows:{type:p.NUMBER,default:0,minValue:-2,midValue:0,maxValue:2},highlights:{type:p.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},clarity:{type:p.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},whites:{type:p.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},blacks:{type:p.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},temperature:{type:p.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1},sharpness:{type:p.NUMBER,default:0,minValue:-1,midValue:0,maxValue:1}};q.Operations.AdjustmentsOperation=na;Ly=na});var Ny;var Uy=_(()=>{Ny="/*\n * Based on evanw's glfx.js tilt shift shader:\n * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js\n * @license\n */\n\nuniform sampler2D u_image;\nuniform float u_blurRadius;\nuniform vec2 u_delta;\nuniform vec2 u_texSize;\nvarying vec2 v_texCoord;\n\nfloat random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt = dot(co.xy,vec2(a,b));\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(gl_FragCoord.xy / u_texSize.xy);\n    float radius = u_blurRadius;\n\n    const float steps = 30.0;\n\n    for (float t = -steps; t <= steps; t++) {\n        float percent = (t + offset - 0.5) / steps;\n        float weight = 1.0 - abs(percent);\n\n        // Somehow `sample` is a keyword in headless-gl\n        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);\n\n        color += _sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n}\n"});var Bl,Ad,vt;var Uo=_(()=>{F();Uy();({Vector2:Bl}=M);Ad=class extends T.Filter{constructor(...e){super(...e);this._fragmentSource=Ny;this._lastBlurRadius=null;this._lastDimensions=new Bl(0,0);this._blurredRenderTarget=new T.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=false,o=null){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}const n=t.getCanvas();const a=t.getContext();const l=i.getContext();if(this._lastBlurRadius===this._options.blurRadius){l.drawImage(n,0,0)}const u=a.getImageData(0,0,n.width,n.height);const c=l.getImageData(0,0,n.width,n.height);let h=this._options.blurRadius;const{delta:m}=this._options;const d=30;for(let f=0;f<n.width;f++){for(let b=0;b<n.height;b++){const y=f+b*n.width;const g=y*4;let C=0;let v=0;let x=0;let B=0;let w=0;if(o){h=o(f/n.width,b/n.height)}const D=this._random(f,1-b/n.height);for(let j=-d;j<=d;j++){const W=(j+D-.5)/d;const J=1-Math.abs(W);const te=m.x*W*h;const Q=m.y*W*h;const K=Math.max(Math.min(f+te,n.width-1),0);const ye=Math.max(Math.min(b+Q,n.height-1),0);const lt=(Math.round(ye)*n.width+Math.round(K))*4;const Ze=u.data[lt+3];const ni=Ze*u.data[lt];const ie=Ze*u.data[lt+1];const Be=Ze*u.data[lt+2];C+=ni*J;v+=ie*J;x+=Be*J;B+=Ze*J;w+=J}C/=w;v/=w;x/=w;B/=w;c.data[g]=C/B;c.data[g+1]=v/B;c.data[g+2]=x/B;c.data[g+3]=B}}l.putImageData(c,0,0);this._lastDimensions.copy(new Bl(n.width,n.height))}_renderLQBlur(e,t,i,r){const o=t.getDimensions();const n=!this._lastDimensions.equals(o);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio());this._blurredRenderTarget.resizeTo(t.getDimensions());i.setPixelRatio(t.getPixelRatio());i.resizeTo(t.getDimensions());if(this._lastBlurRadius!==this._options.blurRadius||n){this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius);this._lastBlurRadius=this._options.blurRadius}const a=i.getContext();a.drawImage(this._blurredRenderTarget.getCanvas(),0,0);this._lastDimensions.copy(o)}_random(e,t){const i=12.9898;const r=78.233;const o=43758.5453;const n=e*i+t*r;const a=n-3.14*Math.floor(n/3.14);const l=Math.sin(a)*o;return l-Math.floor(l)}};Ad.prototype.availableOptions={blurRadius:{type:p.NUMBER,default:30,uniformType:O.FLOAT},delta:{type:p.VECTOR2,default:new Bl(1,1),uniformType:O.FLOAT2},texSize:{type:p.VECTOR2,default:new Bl(100,100),uniformType:O.FLOAT2},blurQuality:{type:p.STRING,default:"low"}};vt=Ad});var Gy,aa,Wy;var Vy=_(()=>{F();Uo();({Vector2:Gy}=M);aa=class extends le{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius;const t={blurQuality:{type:p.STRING}};this._horizontalFilter=new vt({},t);this._verticalFilter=new vt({},t);this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]);this._horizontalFilter.setDelta(new Gy(.5,.5));this._verticalFilter.setDelta(new Gy(-.5,.5));this._filter=new vt({},t)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){if(this._options.highQualityCanvasBlur){return this._renderBlur(e)}return this._renderLQCanvasBlur(e)}_renderBlur(e){const t=e.getDimensions();const i=t.min();const{blurRadius:r}=this._options;const o={blurRadius:r*i,texSize:t,blurQuality:"high"};this._horizontalFilter.set(o);this._verticalFilter.set(o);this._renderTexture.render(this._container);return Promise.resolve()}_renderLQCanvasBlur(e){const{blurRadius:t}=this._options;const i=e.getDimensions();this._filter.set({blurRadius:t,texSize:i,blurQuality:"low"});this._sprite.setFilters([this._filter]);this._renderTexture.render(this._container);return Promise.resolve()}transform(e){const t=this.getBlurRadius();const i=e.applyToRelativeSize(t);this.set({blurRadius:i},false)}dispose(){super.dispose();this._filter.dispose();this._verticalFilter.dispose();this._horizontalFilter.dispose()}hasChanges(){return true}};aa.identifier="blur";aa.prototype.availableOptions={blurRadius:{type:p.NUMBER,default:.025},highQualityCanvasBlur:{type:p.BOOLEAN,default:false}};q.Operations.BlurOperation=aa;Wy=aa});var Hy;var jy=_(()=>{Hy="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform sampler2D u_filteredImage;\nuniform float u_intensity;\n\nvoid main() {\n  vec4 color0 = texture2D(u_image, v_texCoord);\n  vec4 color1 = texture2D(u_filteredImage, v_texCoord);\n  gl_FragColor = mix(color0, color1, u_intensity);\n}\n"});var Id,qy,Pd;var Ky=_(()=>{F();jy();Id=class extends T.Filter{constructor(){super();this._fragmentSource=Hy}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=i.getContext();const{filteredCanvas:a}=this._options;n.save();n.drawImage(o,0,0);n.globalAlpha=this._options.intensity;n.drawImage(a,0,0);n.restore()}};Id.prototype.availableOptions={filteredImage:{type:p.NUMBER,default:1,uniformType:O.INT},filteredCanvas:{type:p.OBJECT,default:null},intensity:{type:p.NUMBER,default:1,uniformType:O.FLOAT}};qy=class{constructor(e=1){this._intensity=e;this._stack=[];this._dirtiness={};this._renderTextures={};this._container=new T.Container;this._sprite=new T.Sprite;this._container.addChild(this._sprite);this._blendFilter=new Id}push(e){this._stack.push(e)}clear(){this._stack=[]}render(e,t,i){if(this.isEmpty()){return Promise.resolve()}const r=e.getRenderer();this._sprite.setTexture(t);let o=this._renderTextures[r.id];if(!o){const l=e.getSprite().getTexture().getFrame();o=new T.RenderTexture(e.getRenderer(),l.width,l.height);this._renderTextures[r.id]=o}const n=i.getDimensions();o.resizeTo(n);const a=this.isDirtyForRenderer(r);if(a){this._stack.forEach(u=>{u.update(e)});const l=this._stack.map(u=>u.getFilter());this._sprite.setFilters(l);o.render(this._container);this.setDirtyForRenderer(false,r)}this._blendFilter.setIntensity(this._intensity);if(r.isOfType(H.CANVAS)){this._blendFilter.setFilteredCanvas(o.getRenderTarget().getCanvas())}else if(r.isOfType(H.WEBGL)){const l=o.getBaseTexture();l.setGLUnit(this._blendFilter.getFilteredImage());r.updateTexture(l,false)}this._sprite.setFilters([this._blendFilter]);i.clear(E.TRANSPARENT);i.render(this._container);if(a){this.disposeRenderTextures()}return Promise.resolve()}setIntensity(e){this._intensity=e}isEmpty(){return this._stack.length===0}isDirtyForRenderer(e){if(!(e.id in this._dirtiness)){this._dirtiness[e.id]=true}return this._dirtiness[e.id]}setDirtyForRenderer(e,t){this._dirtiness[t.id]=e}setDirty(e){for(const t in this._dirtiness){this._dirtiness[t]=e}}disposeRenderTextures(){for(const e in this._renderTextures){this._renderTextures[e].dispose();delete this._renderTextures[e]}}dispose(){this.disposeRenderTextures();this._stack.forEach(e=>e.dispose());this._stack=[];this._blendFilter.dispose();this._sprite.dispose()}};Pd=qy});var No,G;var me=_(()=>{F();Ky();No=class extends X{constructor(e={},t={}){super(e,{intensity:{type:p.NUMBER,default:1,setter(i){this._stack&&this._stack.setIntensity(i);return i}},dirty:{type:p.BOOLEAN,default:true},...t});this._stack=new Pd(this._options.intensity)}render(e,t,i){return this._stack.render(e,t,i).then(r=>{this.setDirty(false);return r})}setDirtyForRenderer(e,t){this._stack.setDirtyForRenderer(e,t)}disposeRenderTextures(){this._stack.disposeRenderTextures()}dispose(){this._stack.dispose()}};No.identifier=null;No.isIdentity=false;No.displayName=null;No.PrimitivesStack=Pd;G=No});var Yy;var Xy=_(()=>{Yy="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform float u_brightness;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4((texColor.rgb + vec3(u_brightness) * texColor.a), texColor.a);;\n}\n"});var Jy,_e;var ot=_(()=>{F();Jy=class extends X{update(){}getFilter(){return this._filter}dispose(){if(this._filter){this._filter.dispose();this._filter=null}}};_e=Jy});var Ml,Bd,ms;var $y=_(()=>{F();Xy();ot();Ml=class extends T.Filter{constructor(){super();this._fragmentSource=Yy}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=n.getImageData(0,0,o.width,o.height);let{brightness:u}=this._options;if(u===0){a.putImageData(l,0,0);return}u*=255;for(let c=0;c<o.width*o.height;c++){const h=c*4;l.data[h]+=u;l.data[h+1]+=u;l.data[h+2]+=u}a.putImageData(l,0,0)}};Ml.prototype.availableOptions={brightness:{type:p.NUMBER,default:0,uniformType:O.FLOAT}};Bd=class extends _e{constructor(...e){super(...e);this._filter=new Ml}update(){this._filter.setBrightness(this._options.brightness)}};Bd.prototype.availableOptions=Ml.prototype.availableOptions;ms=Bd});var Qy;var Zy=_(()=>{Qy="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform float u_contrast;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor = vec4(((texColor.rgb - vec3(0.5)) * u_contrast + vec3(0.5) * texColor.a), texColor.a);\n}\n"});var Ll,Md,wt;var eb=_(()=>{F();Zy();ot();Ll=class extends T.Filter{constructor(){super();this._fragmentSource=Qy}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=n.getImageData(0,0,o.width,o.height);const{contrast:u}=this._options;if(u===1){return}for(let c=0;c<o.width*o.height;c++){const h=c*4;l.data[h]=(l.data[h]-127)*u+127;l.data[h+1]=(l.data[h+1]-127)*u+127;l.data[h+2]=(l.data[h+2]-127)*u+127}a.putImageData(l,0,0)}};Ll.prototype.availableOptions={contrast:{type:p.NUMBER,default:1,uniformType:O.FLOAT}};Md=class extends _e{constructor(...e){super(...e);this._filter=new Ll}update(){this._filter.setContrast(this._options.contrast)}};Md.prototype.availableOptions=Ll.prototype.availableOptions;wt=Md});var ib;var tb=_(()=>{ib="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform mat4 u_colorMatrix;\nuniform vec4 u_colorMatrixOffset;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor = texColor * u_colorMatrix + u_colorMatrixOffset;\n}\n"});var t1,zl,Ld,Ul;var rb=_(()=>{F();tb();ot();({ColorMatrix:t1}=M);zl=class extends T.Filter{constructor(){super();this._fragmentSource=ib}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=n.getImageData(0,0,o.width,o.height);const{colorMatrix:u}=this._options;let c=new E(0,0,0,0);for(let h=0;h<o.width*o.height;h++){const m=h*4;c.r=l.data[m]/255;c.g=l.data[m+1]/255;c.b=l.data[m+2]/255;c=u.apply(c);l.data[m]=c.r*255;l.data[m+1]=c.g*255;l.data[m+2]=c.b*255}a.putImageData(l,0,0)}};zl.prototype.availableOptions={colorMatrix:{type:p.COLOR_MATRIX,default:new t1,uniformType:O.MAT4},colorMatrixOffset:{type:p.ARRAY,default:[],uniformType:O.FLOAT4}};Ld=class extends _e{constructor(...e){super(...e);this._filter=new zl}update(){this._filter.setColorMatrix(this._options.colorMatrix)}};Ld.prototype.availableOptions=zl.prototype.availableOptions;Ul=Ld});var ob;var sb=_(()=>{ob="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform float u_desaturation;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  vec3 grayXfer = vec3(0.3, 0.59, 0.11);\n  vec3 gray = vec3(dot(grayXfer, texColor.xyz));\n  gl_FragColor = vec4(mix(texColor.xyz, gray, u_desaturation) * texColor.a, texColor.a);\n}\n"});var Nl,zd,_i;var nb=_(()=>{F();sb();ot();Nl=class extends T.Filter{constructor(){super();this._fragmentSource=ob}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=n.getImageData(0,0,o.width,o.height);const u=[.3,.59,.11];const{desaturation:c}=this._options;for(let h=0;h<o.width*o.height;h++){const m=h*4;const d=u[0]*l.data[m]/255+u[1]*l.data[m+1]/255+u[2]*l.data[m+2]/255;l.data[m]+=(d*255-l.data[m])*c;l.data[m+1]+=(d*255-l.data[m+1])*c;l.data[m+2]+=(d*255-l.data[m+2])*c}a.putImageData(l,0,0)}};Nl.prototype.availableOptions={desaturation:{type:p.NUMBER,default:1,uniformType:O.FLOAT}};zd=class extends _e{constructor(...e){super(...e);this._filter=new Nl}update(){this._filter.setDesaturation(this._options.desaturation)}};zd.prototype.availableOptions=Nl.prototype.availableOptions;_i=zd});var lb;var ab=_(()=>{lb='precision highp float;\n\nuniform sampler2D u_image;\nuniform vec4 u_lightColor;\nuniform vec4 u_darkColor;\nuniform float u_intensity;\nvarying vec2 v_texCoord;\n\nconst float EPSILON = 0.0000001;\nconst vec3 GRAYSCALE_WEIGHTS = vec3(0.2126, 0.7152, 0.0722);\n\nvec4 duotoneKernel(vec4 sampledCol, vec4 light, vec4 dark, float intensity) {\n  vec4 color = clamp(sampledCol, 0.0, 1.0);\n  color.rgb /= max(color.a, EPSILON);\n  color = clamp(color, 0.0, 1.0); // necessary to get rid of all extended sRGB issues with OpenGL ES\n \n  // Apply intensity as "symmetric gamma"\n  if (intensity > 0.0) {\n    color.rgb = 1.0 - pow(1.0 - color.rgb, vec3(max(intensity + 1.0, EPSILON)));\n  } else {\n    color.rgb = pow(color.rgb, vec3(max(-intensity + 1.0, EPSILON)));\n  }\n \n  // Colorimetric (perceptual luminance-preserving) RGB to grayscale conversion\n  // https://en.wikipedia.org/wiki/Grayscale#Colorimetric_(perceptual_luminance-preserving)_conversion_to_grayscale\n  float luminance = dot(GRAYSCALE_WEIGHTS, color.rgb);\n \n  // Apply DuoTone\n  vec4 duotone = mix(dark, light, clamp(luminance, 0.0, 1.0));\n  duotone.a *= color.a;\n  \n  duotone.rgb *= duotone.a;\n\n  return duotone;\n}\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor = duotoneKernel(texColor, u_lightColor, u_darkColor, u_intensity);\n}'});var Gl,Ud,Wl;var ub=_(()=>{F();ab();ot();Gl=class extends T.Filter{constructor(){super();this._fragmentSource=lb}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=n.getImageData(0,0,o.width,o.height);const{lightColor:u,darkColor:c,intensity:h}=this._options;for(let m=0;m<o.width*o.height;m++){const d=m*4;const f=l.data[d]/255;const b=l.data[d+1]/255;const y=l.data[d+2]/255;const g=l.data[d+3]/255;const C=new E(f,b,y,g);const v=this._duoToneKernel(C,u,c,h);l.data[d]=v.r*255;l.data[d+1]=v.g*255;l.data[d+2]=v.b*255;l.data[d+3]=v.a*255}a.putImageData(l,0,0)}_duoToneKernel(e,t,i,r){const o=1e-7;e.clone().clamp(0,1);if(r>0){const u=Math.max(r+1,o);e.r=1-Math.pow(1-e.r,u);e.g=1-Math.pow(1-e.g,u);e.b=1-Math.pow(1-e.b,u)}else{const u=Math.max(-r+1,o);e.r=Math.pow(e.r,u);e.g=Math.pow(e.g,u);e.b=Math.pow(e.b,u)}const n=.2126*e.r+.7152*e.g+.0722*e.b;const a=Math.min(Math.max(n,0),1);const l=i.clone().mix(t,a);l.a*=e.a;return l}};Gl.prototype.availableOptions={lightColor:{type:p.COLOR,default:E.RED,uniformType:O.FLOAT4},darkColor:{type:p.COLOR,default:E.BLACK,uniformType:O.FLOAT4},intensity:{type:p.NUMBER,default:.5,uniformType:O.FLOAT}};Ud=class extends _e{constructor(...e){super(...e);this._filter=new Gl}update(){this._filter.setLightColor(this._options.lightColor);this._filter.setDarkColor(this._options.darkColor);const e=2*this._options.intensity-1;this._filter.setIntensity(e)}};Ud.prototype.availableOptions=Gl.prototype.availableOptions;Wl=Ud});var mb;var cb=_(()=>{mb="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform vec3 u_gamma;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  vec3 rgb = vec3(texColor.r, texColor.g, texColor.b);\n  rgb = pow(rgb, u_gamma);\n  gl_FragColor = vec4(rgb * texColor.a, texColor.a);;\n}\n"});var Vl,Nd,jl;var db=_(()=>{F();cb();ot();Vl=class extends T.Filter{constructor(){super();this._fragmentSource=mb}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=n.getImageData(0,0,o.width,o.height);const{gamma:u}=this._options;const c=new Float32Array(256);for(let d=0;d<256;d++){c[d]=255*Math.pow(d/255,u.r)}const h=new Float32Array(256);for(let d=0;d<256;d++){h[d]=255*Math.pow(d/255,u.g)}const m=new Float32Array(256);for(let d=0;d<256;d++){m[d]=255*Math.pow(d/255,u.b)}for(let d=0;d<o.width*o.height;d++){const f=d*4;l.data[f]=c[l.data[f]];l.data[f+1]=h[l.data[f+1]];l.data[f+2]=m[l.data[f+2]]}a.putImageData(l,0,0)}};Vl.prototype.availableOptions={gamma:{type:p.COLOR,default:E.WHITE,uniformType:O.FLOAT3}};Nd=class extends _e{constructor(...e){super(...e);this._filter=new Vl}update(){this._filter.setGamma(this._options.gamma)}};Nd.prototype.availableOptions=Vl.prototype.availableOptions;jl=Nd});var hb;var pb=_(()=>{hb="varying vec2 v_texCoord;\nuniform sampler2D u_image;\n\nuniform vec3 u_color;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n\n  vec2 textureCoord = v_texCoord - vec2(0.5, 0.5);\n  textureCoord /= 0.75;\n\n  float d = 1.0 - dot(textureCoord, textureCoord);\n  d = clamp(d, 0.2, 1.0);\n  vec3 newColor = texColor.rgb * d * u_color.rgb;\n  gl_FragColor = vec4(vec3(newColor) * texColor.a, texColor.a);\n}\n"});var Hl,Gd,Go;var fb=_(()=>{F();pb();ot();Hl=class extends T.Filter{constructor(){super();this._fragmentSource=hb}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=n.getImageData(0,0,o.width,o.height);const{color:u}=this._options;let c;for(let h=0;h<o.width;h++){for(let m=0;m<o.height;m++){const d=(o.width*m+h)*4;const f=h/o.width;const b=m/o.height;const y=(f-.5)/.75;const g=(b-.5)/.75;const C=y*y;const v=g*g;c=1-(C+v);c=Math.min(Math.max(c,.1),1);l.data[d]*=c*u.r;l.data[d+1]=l.data[d+1]*(c*u.g);l.data[d+2]=l.data[d+2]*(c*u.b);l.data[d+3]=255}}a.putImageData(l,0,0)}};Hl.prototype.availableOptions={color:{type:p.COLOR,default:E.WHITE,uniformType:O.FLOAT3}};Gd=class extends _e{constructor(...e){super(...e);this._filter=new Hl}update(){this._filter.setColor(this._options.color)}};Gd.prototype.availableOptions=Hl.prototype.availableOptions;Go=Gd});var _b;var gb=_(()=>{_b="varying vec2 v_texCoord;\nuniform sampler2D u_image;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  texColor.b = texColor.g * 0.33;\n  texColor.r = texColor.r * 0.6;\n  texColor.b += texColor.r * 0.33;\n  texColor.g = texColor.g * 0.7;\n  gl_FragColor = texColor;\n}\n"});var yb,bb,ql;var xb=_(()=>{F();gb();ot();yb=class extends T.Filter{constructor(){super();this._fragmentSource=_b}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=n.getImageData(0,0,o.width,o.height);for(let u=0;u<o.width;u++){for(let c=0;c<o.height;c++){const h=(o.width*c+u)*4;l.data[h+2]=l.data[h+1]*.33;l.data[h]*=.6;l.data[h+2]+=l.data[h]*.33;l.data[h+1]=l.data[h+1]*.7;l.data[h+3]=255}}a.putImageData(l,0,0)}};bb=class extends _e{constructor(...e){super(...e);this._filter=new yb}};ql=bb});var wb;var vb=_(()=>{wb="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nvec3 W = vec3(0.2125, 0.7154, 0.0721);\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float luminance = dot(texColor.rgb, W);\n  gl_FragColor = vec4(vec3(luminance) * texColor.a, texColor.a);\n}\n"});var Cb,Db,Wo;var kb=_(()=>{F();vb();ot();Cb=class extends T.Filter{constructor(){super();this._fragmentSource=wb}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=n.getImageData(0,0,o.width,o.height);for(let u=0;u<o.width;u++){for(let c=0;c<o.height;c++){const h=(o.width*c+u)*4;const m=l.data[h]*.2125+l.data[h+1]*.7154+l.data[h+2]*.0721;l.data[h]=m;l.data[h+1]=m;l.data[h+2]=m}}a.putImageData(l,0,0)}};Db=class extends _e{constructor(...e){super(...e);this._filter=new Cb}};Wo=Db});var Rb;var Tb=_(()=>{Rb="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform sampler2D u_lookupTable;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float r = texture2D(u_lookupTable, vec2(texColor.r, 0.0)).r;\n  float g = texture2D(u_lookupTable, vec2(texColor.g, 0.0)).g;\n  float b = texture2D(u_lookupTable, vec2(texColor.b, 0.0)).b;\n\n  gl_FragColor = vec4(vec3(r, g, b) * texColor.a, texColor.a);\n}\n"});var Wd,Eb,Kl;var Vd=_(()=>{F();Tb();ot();Wd=class extends T.Filter{constructor(...e){super(...e);this._fragmentSource=Rb}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=n.getImageData(0,0,o.width,o.height);const u=this._options.lookupTableData;for(let c=0;c<o.width*o.height;c++){const h=c*4;const m=l.data[h];l.data[h]=u[m*4];const d=l.data[h+1];l.data[h+1]=u[1+d*4];const f=l.data[h+2];l.data[h+2]=u[2+f*4]}a.putImageData(l,0,0)}};Wd.prototype.availableOptions={lookupTable:{type:p.NUMBER,default:1,uniformType:O.INT},lookupTableData:{type:p.ARRAY,default:[]}};Eb=class extends _e{constructor(...e){super(...e);this._filter=new Wd({lookupTable:this._options.textureGLUnit});this._textures={};this._renderers={}}update(e){const t=e.getRenderer();if(t.isOfType(H.WEBGL)){this._updateWebGLTexture(e)}else if(t.isOfType(H.CANVAS)){this._filter.setLookupTableData(this._options.data)}}_updateWebGLTexture(e){if(typeof this._options.data==="undefined"){throw new Error("LookupTable: No data specified.")}const t=new Uint8Array(this._options.data);const i=e.getRenderer();const{id:r}=i;this._renderers[r]=i;if(!this._textures[r]){this._textures[r]=new T.BaseTexture}const o=this._textures[r];const n=new T.PixelArrayImage(256,1,t);o.setSource(n);o.setGLUnit(this._options.textureGLUnit);if(i.isOfType(H.WEBGL)){i.updateTexture(o)}}dispose(){super.dispose();for(const e in this._textures){this._textures[e].dispose();delete this._textures[e]}delete this._options.data}};Kl=Eb});var Fb;var Sb=_(()=>{Fb="/**\n * Based off of GPUImage's LookupFilter:\n * https://github.com/BradLarson/GPUImage/blob/master/framework/Source/GPUImageLookupFilter.m\n */\n\nvarying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform sampler2D u_lookupTable;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float blueColor = texColor.b * 63.0;\n\n  vec2 quad1;\n  quad1.y = floor(floor(blueColor) / 8.0);\n  quad1.x = floor(blueColor) - (quad1.y * 8.0);\n\n  vec2 quad2;\n  quad2.y = floor(ceil(blueColor) / 8.0);\n  quad2.x = ceil(blueColor) - (quad2.y * 8.0);\n\n  vec2 texCoord1;\n  texCoord1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);\n  texCoord1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);\n\n  vec2 texCoord2;\n  texCoord2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.r);\n  texCoord2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * texColor.g);\n\n  vec4 newColor1 = texture2D(u_lookupTable, texCoord1);\n  vec4 newColor2 = texture2D(u_lookupTable, texCoord2);\n\n  vec4 newColor = mix(newColor1, newColor2, fract(blueColor));\n  gl_FragColor = mix(texColor, vec4(newColor.rgb, texColor.w), texColor.a);\n}\n"});var Ob,Ab,jd,Hd,Xl;var Ib=_(()=>{F();Sb();ot();({Vector2:Ob}=M);Ab=3;jd=class extends T.Filter{constructor(){super();this._precomputeQuads();this._fragmentSource=Fb}_precomputeQuads(){this._quads=[];for(let e=0;e<256;e++){const t=e/255*63;const i=new Ob;i.y=(t|0)*.125|0;i.x=(t|0)-i.y*8;this._quads.push(i)}}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=this._options.lookupTableImage;const u=this._createImageCanvas(l);const c=u.getContext("2d");const h=n.getImageData(0,0,o.width,o.height);const m=c.getImageData(0,0,l.width,l.height);const d=new Ob;for(let f=0;f<o.width*o.height*4;f+=4){const b=h.data[f];const y=h.data[f+1];const g=h.data[f+2];const C=h.data[f+3]/255;const v=this._quads[g];const x=64;d.x=v.x*x;d.y=v.y*x;d.x+=Math.floor(b/4);d.y+=Math.floor(y/4);const B=(l.width*d.y+d.x)*4|0;let w=m.data[B];w=b*(1-C)+w*C;let D=m.data[B+1];D=y*(1-C)+D*C;let j=m.data[B+2];j=g*(1-C)+j*C;h.data[f]=w;h.data[f+1]=D;h.data[f+2]=j}a.putImageData(h,0,0)}_createImageCanvas(e){const t=R.createCanvas();t.width=e.width;t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0);return t}};jd.prototype.availableOptions={lookupTable:{type:p.NUMBER,default:Ab,uniformType:O.INT},lookupTableImage:{type:p.IMAGE,uniformType:null}};Hd=class extends _e{constructor(...e){super(...e);this._filter=new jd;this._textures={}}update(e){const t=e.getRenderer();if(t.isOfType(H.WEBGL)){this._updateWebGLTexture(e)}else if(t.isOfType(H.CANVAS)){this._filter.setLookupTableImage(this._options.image)}}_updateWebGLTexture(e){const t=e.getRenderer();const{id:i}=t;if(!this._textures[i]){this._textures[i]=new T.BaseTexture}const r=this._textures[i];r.setSource(this._options.image);r.setGLUnit(Ab);t.updateTexture(r)}dispose(){super.dispose();for(const e in this._textures){delete this._textures[e]}}};Hd.prototype.availableOptions={image:{type:p.IMAGE}};Xl=Hd});var Bb;var Pb=_(()=>{Bb="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform float u_saturation;\n\nconst vec3 luminanceWeighting = vec3(0.2125, 0.7154, 0.0721);\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float luminance = dot(texColor.rgb, luminanceWeighting);\n\n  vec3 greyScaleColor = vec3(luminance);\n\n  gl_FragColor = vec4(mix(greyScaleColor, texColor.rgb, u_saturation) * texColor.a, texColor.a);\n}\n"});var Yl,qd,Ct;var Mb=_(()=>{F();Pb();ot();Yl=class extends T.Filter{constructor(){super();this._fragmentSource=Bb}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=n.getImageData(0,0,o.width,o.height);const{saturation:u}=this._options;for(let c=0;c<o.width;c++){for(let h=0;h<o.height;h++){const m=(o.width*h+c)*4;const d=l.data[m]*.2125+l.data[m+1]*.7154+l.data[m+2]*.0721;l.data[m]=d*(1-u)+l.data[m]*u;l.data[m+1]=d*(1-u)+l.data[m+1]*u;l.data[m+2]=d*(1-u)+l.data[m+2]*u}}a.putImageData(l,0,0)}};Yl.prototype.availableOptions={saturation:{type:p.NUMBER,default:0,uniformType:O.FLOAT}};qd=class extends _e{constructor(...e){super(...e);this._filter=new Yl}update(){this._filter.setSaturation(this._options.saturation)}};qd.prototype.availableOptions=Yl.prototype.availableOptions;Ct=qd});var zb;var Lb=_(()=>{zb="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform vec3 u_color;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  vec4 overlayVec4 = vec4(u_color, texColor.a);\n  gl_FragColor = max(overlayVec4 * texColor.a, texColor);\n}\n"});var Jl,Kd,$l;var Ub=_(()=>{F();Lb();ot();Jl=class extends T.Filter{constructor(){super();this._fragmentSource=zb}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=n.getImageData(0,0,o.width,o.height);for(let u=0;u<o.width;u++){for(let c=0;c<o.height;c++){const h=(o.width*c+u)*4;l.data[h]=Math.max(this._options.color.r*255,l.data[h]);l.data[h+1]=Math.max(this._options.color.g*255,l.data[h+1]);l.data[h+2]=Math.max(this._options.color.b*255,l.data[h+2])}}a.putImageData(l,0,0)}};Jl.prototype.availableOptions={color:{type:p.COLOR,default:E.WHITE,uniformType:O.FLOAT3}};Kd=class extends _e{constructor(...e){super(...e);this._filter=new Jl}update(){this._filter.setColor(this._options.color)}};Kd.prototype.availableOptions=Jl.prototype.availableOptions;$l=Kd});var Xd,Z;var Nb=_(()=>{F();Vd();Xd=class extends Kl{constructor(...e){super(...e);if(!this._options.rgbControlPoints){this._options.rgbControlPoints={red:this._options.controlPoints,green:this._options.controlPoints,blue:this._options.controlPoints}}this._updateLookupTable()}_updateLookupTable(){const e=this._calculateSplineCurve(this._options.rgbControlPoints.red);const t=this._calculateSplineCurve(this._options.rgbControlPoints.green);const i=this._calculateSplineCurve(this._options.rgbControlPoints.blue);this._options.data=this._buildLookupTable(e,t,i)}_buildLookupTable(e,t,i){const r=[];for(let o=0;o<256;o++){r.push(Math.min(Math.max(o+e[o],0),255));r.push(Math.min(Math.max(o+t[o],0),255));r.push(Math.min(Math.max(o+i[o],0),255));r.push(255)}return r}_calculateSplineCurve(e){e=e.sort(function(n,a){return n[0]>a[0]});const t=this._getSplineCurve(e);const i=t[0];let r;if(i[0]>0){for(r=0;r<i[0];r++){t.unshift([0,0])}}const o=[];for(r=0;r<t.length;r++){const n=t[r];const a=[n[0],n[0]];let l=Math.sqrt(Math.pow(a[0]-n[0],2)+Math.pow(a[1]-n[1],2));if(a[1]>n[1]){l=-l}o.push(l)}return o}_getSplineCurve(e){const t=this._secondDerivative(e);const i=t.length;const r=[];let o;for(o=0;o<i;o++){r[o]=t[o]}const n=[];for(o=0;o<i-1;o++){const a=e[o];const l=e[o+1];for(let u=a[0];u<l[0];u++){const c=(u-a[0])/(l[0]-a[0]);const h=1-c;const m=c;const d=l[0]-a[0];let f=h*a[1]+m*l[1]+d*d/6*((h*h*h-h)*r[o]+(m*m*m-m)*r[o+1]);if(f>255){f=255}else if(f<0){f=0}n.push([u,f])}}if(n.length===255){n.push(e[e.length-1])}return n}_secondDerivative(e){const t=e.length;if(t<=0||t===1){return null}const i=[];const r=[];let o;let n;i[0]=[0,1,0];for(o=1;o<t-1;o++){const l=e[o-1];const u=e[o];const c=e[o+1];i[o]=i[o]||[];i[o][0]=(u[0]-l[0])/6;i[o][1]=(c[0]-l[0])/3;i[o][2]=(c[0]-u[0])/6;r[o]=(c[1]-u[1])/(c[0]-u[0])-(u[1]-l[1])/(u[0]-l[0])}r[0]=0;r[t-1]=0;i[t-1]=[0,1,0];for(o=1;o<t;o++){n=i[1][0]/i[o-1][1];i[o][1]-=n*i[o-1][2];i[o][0]=0;r[o]-=n*r[o-1]}for(o=t-2;o>0;o--){n=i[o][2]/i[o+1][1];i[o][1]-=n*i[o+1][0];i[o][2]=0;r[o]-=n*r[o+1]}const a=[];for(o=0;o<t;o++){a[o]=r[o]/i[o][1]}return a}};Xd.prototype.availableOptions={rgbControlPoints:{type:p.OBJECT},controlPoints:{type:p.ARRAY,default:[]},textureGLUnit:{type:p.NUMBER,default:1}};Z=Xd});var Wb;var Gb=_(()=>{Wb="varying vec2 v_texCoord;\nuniform sampler2D u_image;\n\nvoid main() {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  float gray = texColor.r * 0.3 + texColor.g * 0.3 + texColor.b * 0.3;\n  gray -= 0.2;\n  gray = clamp(gray, 0.0, 1.0);\n  gray += 0.15;\n  gray *= 1.4;\n  gl_FragColor = vec4(vec3(gray) * texColor.a, texColor.a);\n}\n"});var Vb,jb,Zl;var Hb=_(()=>{F();Gb();ot();Vb=class extends T.Filter{constructor(){super();this._fragmentSource=Wb}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=n.getImageData(0,0,o.width,o.height);for(let u=0;u<o.width;u++){for(let c=0;c<o.height;c++){const h=(o.width*c+u)*4;let m=l.data[h]/255*.3+l.data[h+1]/255*.3+l.data[h+2]/255*.3;m-=.2;m=Math.max(0,Math.min(1,m));m+=.15;m*=1.4;m*=255;l.data[h]=m;l.data[h+1]=m;l.data[h+2]=m}}a.putImageData(l,0,0)}};jb=class extends _e{constructor(...e){super(...e);this._filter=new Vb}};Zl=jb});var Kb;var qb=_(()=>{Kb="precision highp float;\n\nuniform sampler2D u_image;\n\nuniform sampler2D u_lookupTable;\n\nuniform float u_resolution;     // Texture-Resolution, must be power of 2: 64, 128, 256, 512, 1024, 2048, 4096\nuniform float u_horizontalTileCount; // Horizontal Blue Tiles\nuniform float u_verticalTileCount; // Vertical Blue Tiles\n\nvarying vec2 v_texCoord;\n\nconst float EPSILON = 0.000001;\n\n// Try to get the exact pixel of the lut map image\nvec3 lutColor(int texPosX, int texPosY) {\n    return texture2D(u_lookupTable, (0.5 / u_resolution) + vec2(float(texPosX), float(texPosY)) / u_resolution).rgb;\n}\n\nvec3 bilinearInterpolate(vec3 cRfGf, vec3 cRfGc, vec3 cRcGf, vec3 cRcGc, float redFract, float greenFract) {\n    return mix(mix(cRfGf, cRcGf, redFract), mix(cRfGc, cRcGc, redFract), greenFract);\n}\n\nvoid main() {\n    vec4 inputColor = clamp(texture2D(u_image, v_texCoord.xy), 0.0, 1.0);\n\n    vec3 sourceColor = vec3(inputColor.rgb / max(inputColor.a, EPSILON)); \n\n    vec3 ranges = vec3(\n        floor(u_resolution / u_horizontalTileCount - 1.0),\n        floor(u_resolution / u_verticalTileCount - 1.0),\n        floor(u_horizontalTileCount * u_horizontalTileCount - 1.0)\n    );\n    \n    vec3 tmp = sourceColor * ranges;\n    ivec3 floors = ivec3(tmp);\n    ivec3 ceils = ivec3(ceil(tmp));\n    vec3 fracts = fract(tmp);\n\n    // Map tile index to tile pixel pos.\n    ivec2 pixelsPerTile = ivec2(\n        u_resolution / u_horizontalTileCount, \n        u_resolution / u_verticalTileCount\n      );\n\n    ivec2 tileFloor; // Blue tile index\n    tileFloor.y = floors.z / int(u_horizontalTileCount);\n    tileFloor.x = (floors.z - (tileFloor.y * int(u_horizontalTileCount)));\n\n    ivec2 tileCeil; // Blue tile index\n    tileCeil.y = ceils.z / int(u_horizontalTileCount);\n    tileCeil.x = (ceils.z - (tileCeil.y * int(u_horizontalTileCount)));\n    \n    tileFloor *= pixelsPerTile;\n    tileCeil *= pixelsPerTile; \n    \n    \n    // Interpolate between red and green\n    vec3 lutColorFB = bilinearInterpolate(\n        lutColor(tileFloor.x + floors.x, tileFloor.y + floors.y),\n        lutColor(tileFloor.x + floors.x, tileFloor.y + ceils.y),\n        lutColor(tileFloor.x + ceils.x,  tileFloor.y + floors.y),\n        lutColor(tileFloor.x + ceils.x,  tileFloor.y + ceils.y),\n        fracts.x, fracts.y\n    );\n    vec3 lutColorCB = bilinearInterpolate(\n        lutColor(tileCeil.x + floors.x, tileCeil.y + floors.y),\n        lutColor(tileCeil.x + floors.x, tileCeil.y + ceils.y),\n        lutColor(tileCeil.x + ceils.x,  tileCeil.y + floors.y),\n        lutColor(tileCeil.x + ceils.x,  tileCeil.y + ceils.y),\n        fracts.x, fracts.y\n    );\n\n    // Interpolate between the blue values\n    vec3 interpolation = mix(lutColorFB, lutColorCB, fracts.z);\n\n    // Round Color Values to prevent that for ex. 254.999999 is cutting to 254 instead of 255;\n    interpolation = clamp(floor(interpolation * 255. + .5) / 255., 0.0, 1.0);\n\n    gl_FragColor = vec4(interpolation.rgb * inputColor.a, inputColor.a);\n}\n"});var Ql,Xb,Yb,Yd,Jd,eu;var Jb=_(()=>{F();qb();ot();({Vector2:Ql,Vector3:Xb}=M);Yb=3;Yd=class extends T.Filter{constructor(){super();this._precomputeQuads();this._fragmentSource=Kb}_precomputeQuads(){this._quads=[];for(let e=0;e<256;e++){const t=e/255*63;const i=new Ql;i.y=(t|0)*.125|0;i.x=(t|0)-i.y*8;this._quads.push(i)}}_applyCanvas(e,t,i,r=false){const{resolution:o,horizontalTileCount:n,verticalTileCount:a}=this._options;const l=t.getCanvas();const u=t.getContext();const c=i.getContext();const h=this._options.lookupTableImage;const m=this._createImageCanvas(h);const d=m.getContext("2d");let f={width:128,height:128};if(o){f={width:o,height:o}}else if(h.width&&h.height){f={width:h.width,height:h.height}}const b=u.getImageData(0,0,l.width,l.height);const y=d.getImageData(0,0,f.width,f.height);const g=new Xb(f.width/n-1|0,f.height/a-1|0,n*a-1|0);const C=new E;const v=new E;const x=new E;const B=new E;const w=new E;const D=new E;const j=new E;const W=new E;const J=new Ql;const te=new Ql;const Q=(ie,Be,Ce,ve)=>{ie.r=Be.r*(1-ve)+Ce.r*ve;ie.g=Be.g*(1-ve)+Ce.g*ve;ie.b=Be.b*(1-ve)+Ce.b*ve};const K=(ie,Be,Ce)=>{Be=.5+Be|0;Ce=.5+Ce|0;const ve=(Ce*f.width+Be)*4;ie.r=y.data[ve]/255;ie.g=y.data[ve+1]/255;ie.b=y.data[ve+2]/255;ie.a=y.data[ve+3]/255};const ye=new E;const lt=new E;const Ze=(ie,Be,Ce,ve,ae,Oe,rt)=>{Q(ye,Be,ve,Oe);Q(lt,Ce,ae,Oe);Q(ie,ye,lt,rt)};const ni=new Ql(f.width,f.height).divide(n,a).floor();for(let ie=0;ie<l.width*l.height*4;ie+=4){C.set(b.data[ie]/255,b.data[ie+1]/255,b.data[ie+2]/255,b.data[ie+3]/255);const Be=new Xb(C.r*g.x,C.g*g.y,C.b*g.z);const Ce=Be.clone().floor().toInt();const ve=Be.clone().ceil().toInt();const ae=Be.clone().fract();J.y=Ce.z/n|0;J.x=Ce.z-J.y*n|0;te.y=ve.z/n|0;te.x=ve.z-te.y*n|0;J.multiply(ni);te.multiply(ni);K(w,J.x+Ce.x,J.y+Ce.y);K(D,J.x+Ce.x,J.y+ve.y);K(j,J.x+ve.x,J.y+Ce.y);K(W,J.x+ve.x,J.y+ve.y);Ze(x,w,D,j,W,ae.x,ae.y);K(w,te.x+Ce.x,te.y+Ce.y);K(D,te.x+Ce.x,te.y+ve.y);K(j,te.x+ve.x,te.y+Ce.y);K(W,te.x+ve.x,te.y+ve.y);Ze(B,w,D,j,W,ae.x,ae.y);Q(v,x,B,ae.z);b.data[ie]=Math.ceil(v.r*255);b.data[ie+1]=Math.ceil(v.g*255);b.data[ie+2]=Math.ceil(v.b*255)}c.putImageData(b,0,0)}_createImageCanvas(e){const t=R.createCanvas();t.width=e.width;t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0);return t}};Yd.prototype.availableOptions={lookupTable:{type:p.NUMBER,default:Yb,uniformType:O.INT},lookupTableImage:{type:p.IMAGE,uniformType:null},resolution:{type:p.NUMBER,uniformType:O.FLOAT},horizontalTileCount:{type:p.NUMBER,default:5,uniformType:O.FLOAT},verticalTileCount:{type:p.NUMBER,default:5,uniformType:O.FLOAT}};Jd=class extends _e{constructor(...e){super(...e);this._filter=new Yd;this._textures={}}update(e){const t=e.getRenderer();if(t.isOfType(H.WEBGL)){this._updateWebGLTexture(e)}else if(t.isOfType(H.CANVAS)){this._filter.setLookupTableImage(this._options.image)}const{resolution:i,verticalTileCount:r,horizontalTileCount:o,image:n}=this._options;this._filter.set({resolution:i||n.width,verticalTileCount:r,horizontalTileCount:o})}_updateWebGLTexture(e){const t=e.getRenderer();const{id:i}=t;if(!this._textures[i]){this._textures[i]=new T.BaseTexture}const r=this._textures[i];r.setSource(this._options.image);r.setGLUnit(Yb);r.setMinFilter(T.BaseTexture.NearestFilter);t.updateTexture(r)}dispose(){super.dispose();for(const e in this._textures){delete this._textures[e]}}};Jd.prototype.availableOptions={image:{type:p.IMAGE},resolution:{type:p.NUMBER},horizontalTileCount:{type:p.NUMBER,default:5},verticalTileCount:{type:p.NUMBER,default:5}};eu=Jd});var $d={};Me($d,{Brightness:()=>ms,ColorMatrixPrimitive:()=>Ul,Contrast:()=>wt,Desaturation:()=>_i,DuoTone:()=>Wl,Gamma:()=>jl,Glow:()=>Go,Gobblin:()=>ql,Grayscale:()=>Wo,LookupTable:()=>Kl,LookupTableImage:()=>Xl,Saturation:()=>Ct,SoftColorOverlay:()=>$l,ThreeDLookupTableImage:()=>eu,ToneCurve:()=>Z,X400:()=>Zl});var de=_(()=>{$y();eb();rb();nb();ub();db();fb();xb();kb();Vd();Ib();Mb();Ub();Nb();Hb();Jb()});var tu,iu;var Zd=_(()=>{me();de();tu=class extends G{constructor(...e){super(...e);this._stack.push(new ms({brightness:0}))}render(e,t,i){if(this._stack.isEmpty()){this._stack.push(new ms({brightness:0}))}return super.render(e,t,i)}};tu.isIdentity=true;tu.identifier="identity";iu=tu});var Qd,$b;var Zb=_(()=>{me();de();Qd=class extends G{constructor(...e){super(...e);this._stack.push(new wt({contrast:.63}));this._stack.push(new ms({brightness:.12}));this._stack.push(new Z({rgbControlPoints:{red:[[0,38],[94,94],[148,142],[175,187],[255,255]],green:[[0,0],[77,53],[171,190],[255,255]],blue:[[0,10],[48,85],[174,228],[255,255]]}}))}};Qd.identifier="a15";$b=Qd});var ep,Qb;var ex=_(()=>{me();de();ep=class extends G{constructor(...e){super(...e);this._stack.push(new _i({desaturation:.5}));this._stack.push(new Z({rgbControlPoints:{red:[[0,0],[170,170],[212,219],[234,242],[255,255]],green:[[0,0],[170,168],[234,231],[255,255]],blue:[[0,0],[170,170],[212,208],[255,255]]}}))}};ep.identifier="breeze";Qb=ep});var tp,tx;var ix=_(()=>{me();de();tp=class extends G{constructor(...e){super(...e);this._stack.push(new Wo)}};tp.identifier="bw";tx=tp});var ip,rx;var sx=_(()=>{me();de();ip=class extends G{constructor(...e){super(...e);this._stack.push(new Wo);this._stack.push(new wt({contrast:1.5}))}};ip.identifier="bwhard";rx=ip});var rp,ox;var nx=_(()=>{me();de();rp=class extends G{constructor(...e){super(...e);this._stack.push(new Z({rgbControlPoints:{red:[[0,69],[55,110],[202,230],[255,255]],green:[[0,44],[89,93],[185,141],[255,189]],blue:[[0,76],[39,82],[218,138],[255,171]]}}))}};rp.identifier="celsius";ox=rp});var sp,ax;var lx=_(()=>{me();de();sp=class extends G{constructor(...e){super(...e);this._stack.push(new Z({rgbControlPoints:{red:[[0,0],[44,44],[124,143],[221,204],[255,255]],green:[[0,0],[130,127],[213,199],[255,255]],blue:[[0,0],[51,52],[219,204],[255,255]]}}))}};sp.identifier="chest";ax=sp});var ru,ux;var cx=_(()=>{F();me();de();ru=class extends G{constructor(...e){super(...e,{intensity:{type:p.NUMBER,default:.5,required:true,setter(t){if(this._filterPrimitive){this._filterPrimitive.setIntensity(t);this._stack.setIntensity(1)}this._dirty=true;return t}}});this._filterPrimitive=new Wl({lightColor:this._options.lightColor||E.WHITE,darkColor:this._options.darkColor||E.BLACK,intensity:this._options.intensity||.5});this._stack.push(this._filterPrimitive)}};ru.prototype.availableOptions={lightColor:{type:p.COLOR,default:E.WHITE,required:true,setter(s){if(this._filterPrimitive){this._filterPrimitive.setLightColor(s)}this.setDirty&&this.setDirty(true);return s}},darkColor:{type:p.COLOR,default:E.BLACK,required:true,setter(s){if(this._filterPrimitive){this._filterPrimitive.setDarkColor(s)}this.setDirty&&this.setDirty(true);return s}},intensity:{type:p.NUMBER,default:.5,required:true}};ru.identifier="duotone";ux=ru});var op,mx;var dx=_(()=>{me();de();op=class extends G{constructor(...e){super(...e);this._stack.push(new Z({rgbControlPoints:{red:[[0,0],[44,28],[63,48],[128,132],[235,248],[255,255]],green:[[0,0],[20,10],[60,45],[190,209],[211,231],[255,255]],blue:[[0,31],[41,62],[150,142],[234,212],[255,224]]}}))}};op.identifier="fixie";mx=op});var np,px;var hx=_(()=>{me();de();np=class extends G{constructor(...e){super(...e);this._stack.push(new Ct({saturation:1.35}));this._stack.push(new wt({contrast:1.1}))}};np.identifier="food";px=np});var ap,fx;var gx=_(()=>{me();de();ap=class extends G{constructor(...e){super(...e);this._stack.push(new Z({rgbControlPoints:{red:[[0,9],[21,11],[45,24],[255,220]],green:[[0,12],[21,21],[42,42],[150,150],[170,173],[255,210]],blue:[[0,28],[43,72],[128,185],[255,220]]}}))}};ap.identifier="fridge";fx=ap});var lp,_x;var yx=_(()=>{me();de();lp=class extends G{constructor(...e){super(...e);this._stack.push(new Z({rgbControlPoints:{red:[[0,65],[28,67],[67,113],[125,183],[187,217],[255,229]],green:[[0,52],[42,59],[104,134],[169,209],[255,240]],blue:[[0,52],[65,68],[93,104],[150,153],[255,198]]}}))}};lp.identifier="front";_x=lp});var up,bx;var xx=_(()=>{me();de();up=class extends G{constructor(...e){super(...e);this._stack.push(new wt({contrast:1.1}));this._stack.push(new Z({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[127,127],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}}))}};up.identifier="glam";bx=up});var cp,vx;var wx=_(()=>{me();de();cp=class extends G{constructor(...e){super(...e);this._stack.push(new ql)}};cp.identifier="gobblin";vx=cp});var mp,Cx;var Dx=_(()=>{me();de();mp=class extends G{constructor(...e){super(...e);this._stack.push(new Z({controlPoints:[[0,0],[53,32],[91,80],[176,205],[255,255]]}));this._stack.push(new Ct({saturation:.9}))}};mp.identifier="k1";Cx=mp});var dp,kx;var Tx=_(()=>{F();me();de();dp=class extends G{constructor(...e){super(...e);this._stack.push(new Z({controlPoints:[[0,0],[54,33],[77,82],[94,103],[122,126],[177,193],[229,232],[255,255]]}));this._stack.push(new $l({color:new E(40/255,40/255,40/255)}))}};dp.identifier="k2";kx=dp});var pp,Rx;var Ex=_(()=>{me();de();pp=class extends G{constructor(...e){super(...e);this._stack.push(new Ct({saturation:.5}))}};pp.identifier="k6";Rx=pp});var hp,Sx;var Fx=_(()=>{me();de();hp=class extends G{constructor(...e){super(...e);this._stack.push(new Z({controlPoints:[[0,0],[17,27],[46,69],[90,112],[156,200],[203,243],[255,255]]}));this._stack.push(new Ct({saturation:.7}))}};hp.identifier="kdynamic";Sx=hp});var fp,Ox;var Ax=_(()=>{me();de();fp=class extends G{constructor(...e){super(...e);this._stack.push(new _i({desaturation:.4}));this._stack.push(new Z({rgbControlPoints:{red:[[0,20],[40,20],[106,111],[129,153],[190,223],[255,255]],green:[[0,20],[40,20],[62,41],[106,108],[132,159],[203,237],[255,255]],blue:[[0,40],[40,40],[73,60],[133,160],[191,297],[203,237],[237,239],[255,255]]}}))}};fp.identifier="lenin";Ox=fp});var gp,Ix;var Px=_(()=>{me();de();gp=class extends G{constructor(...e){super(...e);this._stack.push(new Z({controlPoints:[[0,0],[87,20],[131,156],[183,205],[255,200]]}))}};gp.identifier="lomo";Ix=gp});var _p,Bx;var Mx=_(()=>{me();de();_p=class extends G{constructor(...e){super(...e);this._stack.push(new Z({rgbControlPoints:{red:[[0,0],[41,84],[87,134],[255,255]],green:[[0,0],[255,216]],blue:[[0,0],[255,131]]}}))}};_p.identifier="mellow";Bx=_p});var h1,yp,Lx;var zx=_(()=>{F();me();de();({ColorMatrix:h1}=M);yp=class extends G{constructor(...e){super(...e);const t=new h1(.8158218291630716,0,0,0,-.01779810181190647,0,.8098360655737704,0,0,.0916393442622953,0,0,.4596336773932402,0,.12760574782432707,0,0,0,1,0);this._stack.push(new Ul({colorMatrix:t}));const i=new E(.8,.6,.9);this._stack.push(new jl({gamma:i}))}};yp.identifier="metal";Lx=yp});var bp,Ux;var Nx=_(()=>{me();de();bp=class extends G{constructor(...e){super(...e);this._stack.push(new Z({rgbControlPoints:{red:[[0,40],[255,230]],green:[[0,10],[255,225]],blue:[[0,20],[255,181]]}}));this._stack.push(new Go)}};bp.identifier="morning";Ux=bp});var xp,Gx;var Wx=_(()=>{me();de();xp=class extends G{constructor(...e){super(...e);this._stack.push(new Z({rgbControlPoints:{red:[[0,0],[115,130],[195,215],[255,255]],green:[[0,0],[148,153],[172,215],[255,255]],blue:[[0,46],[58,75],[178,205],[255,255]]},textureGLUnit:2}));this._stack.push(new Z({controlPoints:[[0,0],[117,151],[189,217],[255,255]],textureGLUnit:3}));this._stack.push(new _i({desaturation:.65}))}};xp.identifier="orchid";Gx=xp});var vp,Vx;var jx=_(()=>{me();de();vp=class extends G{constructor(...e){super(...e);this._stack.push(new Z({rgbControlPoints:{red:[[0,0],[94,74],[181,205],[255,255]],green:[[0,0],[34,34],[99,76],[176,190],[255,255]],blue:[[0,0],[102,73],[227,213],[255,255]]}}));this._stack.push(new Ct({saturation:.8}));this._stack.push(new wt({contrast:1.5}))}};vp.identifier="pola";Vx=vp});var wp,Hx;var qx=_(()=>{me();de();wp=class extends G{constructor(...e){super(...e);this._stack.push(new Z({rgbControlPoints:{red:[[0,0],[56,18],[196,209],[255,255]],green:[[0,38],[71,84],[255,255]],blue:[[0,0],[131,133],[204,211],[255,255]]}}));this._stack.push(new Ct({saturation:.8}));this._stack.push(new wt({contrast:1.5}))}};wp.identifier="pola669";Hx=wp});var Cp,Kx;var Xx=_(()=>{me();de();Cp=class extends G{constructor(...e){super(...e);this._stack.push(new _i({desaturation:.65}));this._stack.push(new Z({rgbControlPoints:{red:[[0,50],[40,78],[118,170],[181,211],[255,255]],green:[[0,27],[28,45],[109,157],[157,195],[179,208],[206,212],[255,240]],blue:[[0,50],[12,55],[46,103],[103,162],[194,182],[241,201],[255,219]]}}))}};Cp.identifier="quozi";Kx=Cp});var Dp,Yx;var Jx=_(()=>{me();de();Dp=class extends G{constructor(...e){super(...e);this._stack.push(new Z({rgbControlPoints:{red:[[0,129],[75,153],[181,227],[255,255]],green:[[0,8],[111,85],[212,158],[255,226]],blue:[[0,5],[75,22],[193,90],[255,229]]}}));this._stack.push(new Go)}};Dp.identifier="semired";Yx=Dp});var kp,$x;var Zx=_(()=>{me();de();kp=class extends G{constructor(...e){super(...e);this._stack.push(new Z({rgbControlPoints:{red:[[0,0],[62,82],[141,154],[255,255]],green:[[0,39],[56,96],[192,176],[255,255]],blue:[[0,0],[174,99],[255,235]]},textureGLUnit:2}));this._stack.push(new Z({controlPoints:[[0,0],[55,20],[158,191],[255,255]],textureGLUnit:3}))}};kp.identifier="sunny";$x=kp});var Tp,Qx;var e0=_(()=>{me();de();Tp=class extends G{constructor(...e){super(...e);this._stack.push(new Z({rgbControlPoints:{red:[[0,72],[89,99],[176,212],[255,237]],green:[[0,49],[255,192]],blue:[[0,72],[255,151]]}}))}};Tp.identifier="texas";Qx=Tp});var Rp,t0;var i0=_(()=>{me();de();Rp=class extends G{constructor(...e){super(...e);this._stack.push(new Zl)}};Rp.identifier="x400";t0=Rp});var su,r0;var s0=_(()=>{F();me();de();su=class extends G{constructor(...e){super(...e);this._lutPrimitive=new Xl({image:this._options.image});this._stack.push(this._lutPrimitive)}};su.prototype.availableOptions={image:{type:p.IMAGE,required:true,setter(s){if(this._lutPrimitive){this._lutPrimitive.setImage(s)}this.setDirty(true);return s}}};su.identifier="lut";r0=su});var ou,o0;var n0=_(()=>{F();me();de();ou=class extends G{constructor(...e){super(...e);const{image:t,resolution:i,verticalTileCount:r,horizontalTileCount:o}=this._options;this._lutPrimitive=new eu({image:t,resolution:i,verticalTileCount:r,horizontalTileCount:o});this._stack.push(this._lutPrimitive)}};ou.prototype.availableOptions={image:{type:p.IMAGE,required:true,setter(s){if(this._lutPrimitive){this._lutPrimitive.setImage(s)}this.setDirty(true);return s}},resolution:{type:p.NUMBER},horizontalTileCount:{type:p.NUMBER,default:5},verticalTileCount:{type:p.NUMBER,default:5}};ou.identifier="3d-lut";o0=ou});var Ep={};Me(Ep,{A15Filter:()=>$b,BWFilter:()=>tx,BWHardFilter:()=>rx,BreezeFilter:()=>Qb,CelsiusFilter:()=>ox,ChestFilter:()=>ax,DuoToneFilter:()=>ux,FixieFilter:()=>mx,FoodFilter:()=>px,FridgeFilter:()=>fx,FrontFilter:()=>_x,GlamFilter:()=>bx,GobblinFilter:()=>vx,IdentityFilter:()=>iu,K1Filter:()=>Cx,K2Filter:()=>kx,K6Filter:()=>Rx,KDynamicFilter:()=>Sx,LUTFilter:()=>r0,LeninFilter:()=>Ox,LomoFilter:()=>Ix,MellowFilter:()=>Bx,MetalFilter:()=>Lx,MorningFilter:()=>Ux,OrchidFilter:()=>Gx,Pola669Filter:()=>Hx,PolaFilter:()=>Vx,QuoziFilter:()=>Kx,SemiredFilter:()=>Yx,SunnyFilter:()=>$x,TexasFilter:()=>Qx,ThreeDLUTFilter:()=>o0,X400Filter:()=>t0});var a0=_(()=>{Zd();Zb();ex();ix();sx();nx();lx();cx();dx();hx();gx();yx();xx();wx();Dx();Tx();Ex();Fx();Ax();Px();Mx();zx();Nx();Wx();jx();qx();Xx();Jx();Zx();e0();i0();s0();n0()});var Dr,l0;var u0=_(()=>{F();a0();me();Zd();de();Dr=class extends le{_render(e){return this._selectedFilter.render(this._sdk,e,this._renderTexture)}render(e){if(this._selectedFilter.getDirty()){this.setDirty(true)}if(!this.getEnabled()){this.setDirtyForRenderer(false,this._sdk.getRenderer());return Promise.resolve(e)}return super.render(e)}setDirtyForRenderer(e,t){super.setDirtyForRenderer(e,t);this._selectedFilter.setDirtyForRenderer(e,t)}disposeRenderTextures(){super.disposeRenderTextures();if(this._selectedFilter){this._selectedFilter.disposeRenderTextures()}}dispose(){super.dispose();if(this._selectedFilter){this._selectedFilter.dispose()}}restoreSnapshot(e){const t={...e};delete t.filter;if(e.filter){const i=e.filter.constructor;if(i.identifier==="3d-lut"){this.setFilter(new i({image:e.filter.getImage(),resolution:e.filter.getResolution(),horizontalTileCount:e.filter.getHorizontalTileCount(),verticalTileCount:e.filter.getVerticalTileCount()}))}else if(i.identifier==="duotone"){this.setFilter(new i({lightColor:e.filter.getLightColor(),darkColor:e.filter.getDarkColor(),intensity:e.filter.getIntensity()}))}else{this.setFilter(new i)}}this.set(t)}resetToDefaultFilterIntensity(){const e=this._selectedFilter&&this._selectedFilter.availableOptions;const t=e&&e.intensity.default;this.setIntensity(t||1)}};Dr.identifier="filter";Dr.prototype.availableOptions={identifier:{type:p.STRING,default:"identity"},intensity:{type:p.NUMBER,default:1,setter(s){this._selectedFilter&&this._selectedFilter.setIntensity(s);return s}},filter:{type:p.OBJECT,default:new iu,setter(s){if(this._selectedFilter){this._selectedFilter.dispose();this._selectedFilter=null}this._selectedFilter=s;if(typeof this._options.intensity!=="undefined"){this._selectedFilter.set({intensity:this._options.intensity})}return s}}};Dr.FilterPrimitives=$d;Dr.Filters=Ep;Dr.Filter=G;q.Operations.FilterOperation=Dr;l0=Dr});var la,c0;var m0=_(()=>{F();la=class extends le{constructor(...e){super(...e);this._flipContainer=new T.Container}_render(e){const{outputResolution:t,flipHorizontally:i,flipVertically:r}=this._options;if(i||r){const o=e.getDimensions();if(!this._flipRenderTexture){this._flipRenderTexture=new T.RenderTexture(this._sdk.getRenderer(),o.x,o.y);this._flipSprite=new T.Sprite(this._flipRenderTexture);this._flipContainer.addChild(this._flipSprite)}else{this._flipRenderTexture.resizeTo(o)}const n=i?-1:1;const a=r?-1:1;this._flipSprite.setScale(n,a);this._flipSprite.setPivot(0,0);this._flipSprite.setPosition(o.x*(1-n)*.5,o.y*(1-a)*.5);this._flipRenderTexture.clear();this._flipRenderTexture.render(this._container);this._renderTexture.render(this._flipContainer)}else{this._renderTexture.render(this._container)}return Promise.resolve()}};la.identifier="flip";la.prototype.availableOptions={flipHorizontally:{type:p.BOOLEAN,default:false},flipVertically:{type:p.BOOLEAN,default:false}};q.Operations.FlipOperation=la;c0=la});var Vo,jo,d0;var p0=_(()=>{F();({Vector2:Vo}=M);jo=class extends le{constructor(...e){super(...e);this._colorOverlayFilter=new T.Filters.ColorOverlayFilter({color:this.getTintColor()});this._frameContainer=new T.Container;this._resetSprites();if(this._options.frame){this._createSpritesForFrame(this._options.frame)}}_resetSprites(){this._spriteGroups={top:{},left:{},right:{},bottom:{}};this._sprites=[];this._repeatSprites={top:[],left:[],right:[],bottom:[]}}_createSpritesForFrame(e){if(!e)return this._disposeSprites();const{imageGroups:t,layoutMode:i}=e;this._layoutMode=i||"horizontal-inside";this._disposeSprites();["top","left","right","bottom"].forEach(r=>{if(typeof t[r]==="undefined")return;["start","mid","end"].forEach(o=>{if(typeof t[r][o]==="undefined")return;let n=t[r][o];if("image"in n){n=n.image}const a=T.Texture.fromImage(n);const l=new T.Sprite(a);this._spriteGroups[r][o]=l;this._sprites.push(l);this._frameContainer.addChild(l)})})}_render(e){const t=this._renderTexture.getDimensions();if(this._options.frame){this._colorOverlayFilter.setColor(this.getTintColor());this._updateSprites(e)}if(!this._frameRenderTexture){this._frameRenderTexture=new T.RenderTexture(this._sdk.getRenderer(),t.x,t.y);this._frameSprite=new T.Sprite(this._frameRenderTexture);this._container.addChild(this._frameSprite)}else{this._frameRenderTexture.resizeTo(t)}this._frameSprite.setAlpha(this._options.alpha);if(this._options.frame&&this._options.frame.tintable){this._frameSprite.setFilters([this._colorOverlayFilter])}else{this._frameSprite.setFilters([])}this._frameRenderTexture.clear();this._frameRenderTexture.render(this._frameContainer);this._renderTexture.render(this._container);return Promise.resolve()}_updateSprites(e){const t=e.getDimensions();this._frameWidth=Math.ceil(e.getDimensions().min()*this._options.scale);this._updateHorizontalSpriteGroup(e,"top",0);this._updateHorizontalSpriteGroup(e,"bottom",t.y-this._frameWidth);this._updateVerticalSpriteGroup(e,"left",0);this._updateVerticalSpriteGroup(e,"right",t.x-this._frameWidth)}_updateHorizontalSpriteGroup(e,t,i=0){const r=e.getDimensions();const o=this._layoutMode==="vertical-inside";const n=this._spriteGroups[t].start;const a=this._spriteGroups[t].mid;const l=this._spriteGroups[t].end;let u=0;let c=0;let h;let m;if(n){h=n.getTexture().getDimensions();m=h.y/h.x;u=Math.floor(this._frameWidth/m);const d=new Vo(0,i);d.x=o?this._frameWidth:0;n.setPosition(d);n.setHeight(this._frameWidth);n.setWidth(u)}if(l){h=l.getTexture().getDimensions();m=h.y/h.x;c=Math.floor(this._frameWidth*m);const d=new Vo(r.x-c,i);d.x-=o?this._frameWidth:0;l.setPosition(d);l.setHeight(this._frameWidth);l.setWidth(c)}if(a){h=a.getTexture().getDimensions();m=h.y/h.x;const d=new Vo(u,i);let f=r.x-u-c;if(o){d.x+=this._frameWidth;f-=this._frameWidth*2}a.setPosition(d);a.setWidth(f);a.setHeight(this._frameWidth);if(false){a._canvasSmoothingEnabled=false}if(this._options.frame.imageGroups[t].mid.mode==="repeat"){const b=this._frameWidth/m;const y=Math.ceil(f/b);let g=0;if(y!==-1){let C=Math.round(f/y);a.setWidth(C);g+=C;this._ensureRepeatSpritesExist(y-1,t,a);for(let v=0;v<y-1;v++){C=Math.round((f-g)/(y-v-1));const x=this._repeatSprites[t][v];const B=d.clone().add(g,0).floor();x.setPosition(B);x.setWidth(C);x.setHeight(this._frameWidth);g+=C}}}}}_ensureRepeatSpritesExist(e,t,i){i.getTexture().setMaxListeners(e+1);const r=this._repeatSprites[t].length;if(e>r){const o=e-r;for(let n=0;n<o;n++){const a=new T.Sprite(i.getTexture());this._repeatSprites[t].push(a);this._frameContainer.addChild(a);this._sprites.push(a)}}else if(e<r){const o=this._repeatSprites[t].splice(e);o.forEach(n=>{const a=this._sprites.indexOf(n);if(a===-1)return;this._sprites.splice(a,1);this._frameContainer.removeChild(n);n.dispose()})}}_updateVerticalSpriteGroup(e,t,i=0){const r=e.getDimensions();const o=this._layoutMode==="horizontal-inside";const n=this._spriteGroups[t].start;const a=this._spriteGroups[t].mid;const l=this._spriteGroups[t].end;let u=0;let c=0;let h;let m;if(n){h=n.getTexture().getDimensions();m=h.y/h.x;u=Math.floor(this._frameWidth*m);const d=new Vo(i,0);d.y=o?this._frameWidth:0;n.setPosition(d);n.setWidth(this._frameWidth);n.setHeight(u)}if(l){h=l.getTexture().getDimensions();m=h.y/h.x;c=Math.floor(this._frameWidth*m);const d=new Vo(i,r.y-c);d.y-=o?this._frameWidth:0;l.setPosition(d);l.setWidth(this._frameWidth);l.setHeight(c)}if(a){h=a.getTexture().getDimensions();m=h.y/h.x;const d=new Vo(i,u);let f=r.y-u-c;if(o){d.y+=this._frameWidth;f-=this._frameWidth*2}a.setPosition(d);a.setHeight(f);a.setWidth(this._frameWidth);if(false){a._canvasSmoothingEnabled=false}if(this._options.frame.imageGroups[t].mid.mode==="repeat"){const b=this._frameWidth*m;const y=Math.ceil(f/b);let g=0;if(y!==-1){let C=Math.round(f/y);a.setHeight(C);g+=C;this._ensureRepeatSpritesExist(y-1,t,a);for(let v=0;v<y-1;v++){C=Math.round((f-g)/(y-v-1));const x=this._repeatSprites[t][v];const B=d.clone().add(0,g).floor();x.setPosition(B);x.setHeight(C);x.setWidth(this._frameWidth);g+=C}}}}}_disposeSprites(){this._sprites.forEach(e=>{this._frameContainer.removeChild(e);e.getTexture().dispose();e.dispose()});this._resetSprites()}dispose(){super.dispose();this._disposeSprites();if(this._colorOverlayFilter)this._colorOverlayFilter.dispose();if(this._frameRenderTexture)this._frameRenderTexture.dispose()}static validateFrame(e){if(!e)return;const{imageGroups:t,layoutMode:i}=e;if(typeof e.identifier!=="string"){throw new Error("Frame needs a property `identifier` of type String.")}if(typeof e.imageGroups!=="object"){throw new Error("Frame needs a property `imageGroups` of type Object.")}const r=o=>{const{start:n,end:a,mid:l}=t[o];if(typeof t[o]==="undefined")return;if(typeof t[o]!=="object"){throw new Error(`Frame: \`imageGroups.${o}\` needs to be of type Object.`)}if(typeof n!=="undefined"&&!(n instanceof ft||typeof HTMLImageElement!=="undefined"&&n instanceof HTMLImageElement)){throw new Error(`Frame: \`imageGroups.${o}.start\` needs to be of type Image.`)}if(typeof l!=="undefined"&&!(n instanceof ft||typeof HTMLImageElement!=="undefined"&&n instanceof HTMLImageElement)&&typeof l!=="object"){throw new Error(`Frame: \`imageGroups.${o}.mid\` needs to be of type Image or Object.`)}if(typeof a!=="undefined"&&!(a instanceof ft||typeof HTMLImageElement!=="undefined"&&a instanceof HTMLImageElement)){throw new Error(`Frame: \`imageGroups.${o}.end\` needs to be of type Image.`)}};if(typeof i!=="undefined"&&["vertical-inside","horizontal-inside"].indexOf(i)===-1){throw new Error(`Frame: \`layoutMode\` must be one of vertical-inside, horizontal-inside`)}if(typeof tintable!=="undefined"&&typeof tintable!=="boolean"){throw new Error(`Frame: \`tintable\` needs to be of type Boolean.`)}r("top");r("left");r("right");r("bottom")}};jo.identifier="frame";jo.prototype.availableOptions={frame:{type:p.OBJECT,validation:jo.validateFrame,setter(s,e){if(!e){this._createSpritesForFrame(s)}return s},default:null},alpha:{type:p.NUMBER,default:1},tintColor:{type:p.COLOR,default:new E(1,1,1,0)},scale:{type:p.NUMBER,default:.1}};q.Operations.FrameOperation=jo;d0=jo});var h0;var f0=_(()=>{h0="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAAAAADRE4smAAAsTElEQVR4Ae1d4bHjOM5ECAgBISgEZLDOwMrAysDMwMpAzkCTAUNQCAyBIfCr2ifI1DNh+c1tfTMg3b9udtZXC7tJdgMgCP8foJAUBIJx92eoEy5puAKkHH1jX0AchqoJcLwGlv1fDVAnyKtfQMoB1WLQKBBCyuCgVvQhvQGoF3RPb2Bs/AsgEDS6BqbGvwACaHsT+AV1AK/4W18AQy3gCxTAR2vAQxW4xHSD3/kC/qlI9NK7hqg6H8SLspiPv4C+kv0v6ouZQuUEEMfndUtcOQH6qJ9nR2sg1kD+FSdQ4GLS4MA82B+uZvJJRQXkFwT8uRp2VQl99xuGiOyTX4//+AuYqtj/BBGPiVITATjtEel4pdRFAJ/2uP08K9KBYXwPaT5OC9Vlg/kneQ0cUwHcQvz6F7BAXVuA/3GNsG8ofqBQmw3uUg7dCglcZQSgJHizvO1qy4OM3wPCH64BV1fnR8QfdkqAcWD86Q86KP9+o/EjGMfwrhVSpPPUWvy9YoMbsEIqAVrSgXBSCFC3FdK/sV+txc/Kv93OEpgrawiYfybsSWkIaMcK3SurB1P8Ufyk2OB2rNCoEKCV+BW2tGOFXG2N0RiUkkgZUfmumrFCfW0EgNOPKlxB6YtvQAcqRrix+BfFBjdjhVgnQL3xk+cyWwYQVG6FLjOs6PTjotaSCF5T8iUXJLSo3gqxT4kLPig6BKheB1/+/dvzEwGi/KParSDN+arAtMFTA/Gz3+8KTiF/tVZoaxx034zwwlAPvsc/7cifx+8U8tdqhfqwXxVihOMAgnp1sJA/lzu9Tv4KrRD7fFVki2VE+IuB3anvT0z/Y/x9KBRKexPkJ+77njv835YA3kvuaPm79z+6zDGtiP5Mv1sSObMv7gr8l5MfkMclCZaJf9sK0TUWd4U58N8b/NWnb5jo9+KPShM4EvzN4DGmPcL5p1ZIgVghhr8VNBZjuP4P8Rsr/fReGW72UyukIKDJeRYz/rQkoiAYHWkSTz+2QgrOVq657bG8xYAlHWBEQzcdf+OH43SAcPp7o3/N3un34zeS98Vbeonu51ZIYCHve/tPhvl4e+QXdP/JMB9KOkRN/42gJf0ni5eiNfILzjH9J4t3NLn/0QH737etzhj5Bdf0GhP9XlXMRt2Lwu+TX4/fUtH3+t+Jl0H/Co3+/hPmQomPjJQV8iu//9Hi5fk3rJAnU3VMnfyXeJzI8HbIL7i8vf+RT8m9a4WsFH3vzzFPzo3LM/mXlN6P3wT5NeXqJ+fmIP/9+0xJfHsJ2Cj69tqap/BE/lILG49z8CMXCGWl6Bu0Ne/2//19LDa942lalvlMZUKNaOBhA0Xw4578xZQQzvJT0y5+Qx0PFz1b2ZXThFxMoF0LVsh3IDCSALqjPg1QwEX6hC1Wp5DfxAqIp+MyiS/rx+m7FQps7l7j+E6O3Jf1Y8DdPxXy23IAsXunTHIqH6BD/k/lJDGlABaN/Epd5FpuBD5ZIL8gHJd8TkGr6VIoN8J6cc/Gwqf3aoRz+dMRBLNDm62c03s1wshlBe0en2GLQ84mhfyaTOQKZl7e9RWg1ggnVO4D/TJ+q5UV8mstLX0Fjz/E1wW/Uo/EoGb9gu1O5vhWgTzqBGAwAER9C3RKj4SqlIO5sacEpPNfJ38OBstHAIdJlwD/vDXk3wNYPQLwFmHO/6wE9rKwPWilv2DkcRNWy9esng45olr9PhuYbQ+JtQ3Qq4VdTSo6S+FvZ5pXNSC/1+NL2ZdkpuNXDjTI42f9BNPj90ohMRh42UyYqhRuemUJ6GJ3MLMC5ECDlAaFAPG9MnEoN9IFMvCymaxUhQCjniXL0ZeXiTPR8Qqi449nNnL5ik8oCqURDb1l7RQCeM0kRX2jGIKBxP8lJgHk8XdpB1eO32F8ofV49H6+oKWXfVIkpRkCi0sgcP/qpOhn7ye2sfmlBLmKobK8FbB0RATbo037qCazx9dL4L4WtXtrCS/dzcLuN4yvbcy4bmzRMgHQv0hmDOoSEB044pMaYMvsh10I/nUqE4fCRjFazfaWWNwdXF7tu8JGgXbHdwkBgvK3DgowvQFq15WGstWLeFw0DaYn14DEf/zwn1ozNoZRKWm8//Bfb3i0JZYJIPHHN24BX5NxDfjqzdrhjQkGFCxvgaFIgHRTVsd01DR5tj7OX0D7M0CXeLiYrvneiwSQ0h0fzoK4Ku0AhhBfpbTno1kQtNh+7HZQCOA1hRToVUnU2Z/jK2BtpsFVSaLZ1ECsEECPP02kNgQGsj/NXxBUkxDOek+UA2NAjQABdZPkXX/qR68PSrG8BjYM+t+G+XLq+zEqrDGFRSFAcppE0jGBRWAqI6JmE3WQ9Unu8BS/SwewpADZB3p/eNdNqXtbHXOHt3Q9ssHwvJ6X9CYCWah7BDq+AK1YoUO4v7/j5Xpgg+FZB1Os4/cXyRo6RQWqVnCs4fdnr031jBoBJH6u4vfvo+bks5KPL2d9vPXfP/frE2rFkCWmBCVR36djeAQ7Qx4HbXKRi0VVg0s6RBysdLwspKjA6FKCoqrrjZ9+eE97XBUn5IdyXMcMCJ2dmn8gpSDIIUH5dz2F4zlxpobcXpU1AF6p/45mh9yyks0tqMChT6DUfynYnHCqXuCasOiEmLXUxhBNDrnFosWJXdEG/wIPapf/EEwOeew0AbdQcQ08VQb4cFh6OMNfC3XC97lUDInAcNfiB3IFCsSRrOV5BYEKTsg/uV5/MC7cn420O+mH4JAnPlCLv/BcQvQXNFbvVhiQrQFwL9YK3UPKEUa2NOFBYQDv7JF7md1EdrMPIYRlujDaerNSV+5Z0AwYXia4u370SwghzGNPxjL9Snsb7u4vY1B0sFW4N6a8nnK+99YrvDr/leaeZdf3zjXEj1d+a9bt9fsa8HJwmn6+mafCAa8L4fu++uHtlzgvMS1lHagwIORrgBUrZAXkc/EejvP3w/7A72zHL2p9KEhh9SS857ZHt0I2Nr+9cuHjCk73Le0xWo4faM7Fi8SnY8anNaBbIRObn3bFWU8JbfFGoEL8wRT/47a2VSnsn05CzoTwgRUyUvSKqPW9h+fhlz4JYJAzwaYO7PPgOk0KB/d9H8QkiGDXCtFccHmFzMY+umu+QmASX2AvfmVqcYnRw/CNAVnEnS0rpBe9WOV/950BfRJALAoHYZOxtJcqhSP2307CMd/ubVohWf7H/Hffyts3SgJYI/UmdeC91KWqMLqLiiz4VSSTN8j/k6YDI+KeLXNGgKHUCBjPNtNeuhRm9SnIWBSOHu2lfXX+T2qNBNJUEA4zGU376lLY6z0O3TOZ4mCc/4Uit1MIEOX/TG93MPTEmS6FWWOAeL7BzstmgkGb51AocisMgE3uDAr5jZX/dSmMGgN+fSuReDJ3zUsw61ZQYUA2KNIL+U3Bvy+FtUeR445Mgc3zX81suCIBpJDEOvkrkcLajLDu8YE41ML/U0kf9CUCxE04LDr565DCYh2VxC/FEcEWKCqxKEVujs8E2HIeevD1SOHiPvgL7H4Dig9Si9xdeCZADzoqk8JlBkQQVMN/vchL4YkAE+ioTAorDOgq4n8ijRsLFBgAevW3Vil8XP21rwOVMAsMAL32V6UUVh74a4v/uRkG/U3LOqWwMCPqN32sTz0LKjduz6MOQc/7ViqFV3RRz/tWy//0/DAC6KhZCstJeFz3qq0kJhiVza8RKSwMsL//6SUxhf8Cp2x+DUhhAS0D1IGT4mtf9vs6ZfNrRQofo9KSmIrWpDA0wf/3+30blMI6Ki6JKfxvUwq/j6q6IxW0I4W7tvgfj940b0wK+w5qRFAHeTtlvGGbUjgw6KjUB0VlvF2DUjg6bJD/vbL5tSeFp5r5T/pkOK9sfo1JYc/N8l/Z/JqSwvHcMP/vyubXkBRmhHpx3B3JoKANHdgAlO5IDQ1JYQUf/rcmhQUf/rcqhVsAxWb5r0hhT9AU3NGzNm1J4cAN8l/J+zYohaOD9tD/DZvfnyUe/3n+I8Ifg//jmx/58Oel8B/N+/Z/cu/hP7z54e2Pdx5STOEEfwzs/2zn3f3PHv7zX9B5ODj80zJs+pPzY/nPZ2Ju0CrEifEn/laBsc0cHLYXv/IN9E3m4Pp43WViTtAY8Ba3aWON5aBlbvuMz/ETNIJrfFxG4awdA7GJ6LNHqfL4Ox8RWgCG3ZNU960d4xKnlkpwgTIrSHhrxw/E7DaK6KD5a2PklhLQoXsUJZfYkB9Y8iepxAr5NmryMq81PMSvU14eqBf37QsI9O2emkeoFnilx0Ocp7AdgxhaqUjy7WF9fP9gADexAK4xzY8dcKAHA06///KAwSc7ZQ/E/nEO+tpvIsmUJd52QL/NXcKv+MOp+txHSml57IH/iBgaVkZ4qt/6+G0HjCgMWAi4bvLnfn/Y9sARoM+e5lu4kfhlB2S4xM0O9tRKE27ETQUC3pMwAIdm4pcdcPZJMEETkNKnJMBvMQn+qTrvG1OcSF7rcPtGvFC/9cOrT2m5kGTAut3LJUvlhz/N35+gpWz06Ii01H74c5CDLit94sP29YFrJn9MgnMW/yC2r3p0Pr90MmzZzlCr7dMf645Z/Czjh6ov+n67f71I6fMuJ38D5J8uX0d+v/I+rDtggMohNic697Xgs9LnIJaoWuD2sJ4YgCmLP3z54KpB4FehIwWvTqzQ15dT+eE/SLCS650yK3iv/hoe+Yji+0T2sjBhAqxXAIjyjbj6PiHAmFnhE9du/f4N8+H7vPwP6YJ1VP3hL/HTVgeQ+CO1cfh3m+85i+hZrdDYgvL14vtWLzjRGn/1RV8vJn/1PYPPHtzoK099bQl+3l++li9gEPdfd+pLCL8kwfbizFz34S+hFudwTQSC6lNfJymBtTSD4ZYEAfP4fWil4yskgcvvX8dx/Yula2XulNuXAF1sYgOA8fvYPfF9dK99A5D4w2nO4xcrTN5zI1f9PIv4391+7MOI9ccfHK6kn9+4/VkhJYaFt6CPbz8i16J888O9EP8vRS8PUAl4waf+t+Xw9ieHiJUo3/Acv89aoEnRyxGrSX255/dIhk0HRYdKwuxWS9F3F3+/i39hvVTsqkl9RVL6/4DTiHrCrKsj7RUH0OLHF59yWE3qy3dPfkiWd/fiU1xH3nfCkh90x58yD17KGR6pg+gJsypsYU5jhAx3PX4RhvHfT3FXw0VXh/IFvDf6xT0WAF7R8JAT9+hz9f4p/tAdTQbqvOXZGLj7nS9xeIpx1oLbbMIlJmdV+fot/q9N/Vv8+gEvNgFvpnXgJQ6yBZwK8/5C8nx0TYa9yEeTh/9Z6n1TfJr3h8W0FxLhI/5oeEjc+ovLiJv5WfTwAOVvQGSyIJ6sKt8t/jcFbf81lvUs8RuWwXSXXzyvf+BhxiSk9HVNhvRP2VK+nBf7jz8ldyS6/FNosugr7L2r87aVT8k1GfmUtS+A/I6582O0Q3c7/pQwYFTkowWcQj5imzJPc+GDTwmmVT4tIiYMYc74fpL4py9ZwMfk37eLiZiwBIyZ9esyT8OKpxHJkGOQazIiJuyAokg39om3+C9Rv+zRxfV37/u7XBTL5WNAm/Nt8RrD5mlo1j2NNMdF11+CXJRaFPloJf5/A172I45id5j56cQ5B7ONUlLs4vBlfk+Zp5mV/f9pKNgAbPCRenfakh8hyineHwpaKYlmi4GA7clgvjjHWzhLklPcK88OKdURvy4Bb+uxIuwdpBTE/GdKwB/L4HwgbFwvRnr5lC31u9AWsZSzOP+DQKmOyP8Om3x0aGa8LaxVXr9nLms05svk5wt9i19uxpJ8ythN3yC716OcNWq1LR5nP55R/pVI24youB4GExrq94Z11+e0tfmwJ4B7isML4TtRPhAXZukXcnEwlfoSeDH/538NzgyAMXnWPxSuu6oBytGB0bMp6w8Sv/R90vzvH9Gh1iMu2lAG4kohBE3NxpYk1ipc+REOh6+Oz4KTpSVtWDBrlOu3wUhkavOLad3HNvN/jXrH55QyxO4R/1XCN1f09bxecxw3KS/aRp2MKBDbs2QjE60giFeTfYwkfhl1qc+EFwTxTp1fTYAZIEmT5+bn/N78zqT//hucVAAvsnnYwJbp+ueh5kni1zUsbbnyPmTxC5ylAZ9LbmM7Ocn5oJx1F4tLd8n8+DwZbsb5cN7kS1u677TJYD38WTKHYnsFg62WxyGzsZeNv/5lEgtlLE6W+SFTv79k8ANmQz6zfm+vkR+3Y4PyE5SAraW9HotXbOwqhxhkL3CofAGn/DqEX/8w2kp99WvRY0tjMWT85fJVT1688D/sOgdZrPDZ3E3fEcXGbk99fDl75b7DWVa9yxPBYbOCZGrMwcIy2DKsNlCGvKPiF3mVABFWeKmdREuN4FK+9ZSVAPOcL7LyqSDdkmOuiMJXGjywpc1PjrgxzwPozucqtT2UnXJHAHCewAzu+zy9S3uMimbK58B5UdKbifDO1kXvEXclcJi6+yvlG5LEL1bn4QjAGih71pe7VQpHpiDfjP61RQLOloBkfkwhT10PUv8BD8BBL9/KtoEwbicF4GIsfKV5fZPCTu9kRMkMSMmUHhVwNvqmLV5jOq2LG9IZAHsEBYMk/8XxTMyXYC3zozWvbxVd4sMJIbzSJ1z4tJ4lRvnPIT2sIKSIr56D4rTFP37PgxlE3ugRsnn3BZDb7YHJ56lCo6PxwiP6dP7iP5QzGBzWfDBmme/F/O+fp65G3Iq+xQUg3T6DeMUBurgvhhge+BN4lXLgFL8o9n5JaZLh8LP92VicZ3ul6KtVfRda9f64HhVdSAJPhvkfnZwJUd0nRfGNKXknR2UfzN8BH/eZ6+GstkmL4ospDXHd9Ogek1yFsQiSSrZc9iJVLQoD+pQiSfwAXe8ujGAXIoVfYsgz/D6lsd9kL/LF9WSc/x28GX+6/ssZHlTRY9cKvoTPTvoxpQBeoU1l/BcsW5p8wpiSsxu/fo/7JfjRJDz0KSWULJB5DBLIYfzrybeElDxYjl8J7o3LUotL6UsD93Cv5EkUeePmHbXopQUmAsxS9K0AXkzgYdZ4cFuZgGIlM+F5LQe+Fb8wgIFiPVOB6R0PtzoflyRp5ORT1uFVD1+In4Lsl4xQDbq3s8Y3EcQIyLXwH99Xiw5oEfnXGsT59dI/2Wj8uMiR0RrE+XRRJEOb8cM4QJPgrXY8c8vxtwtxfk3HP0G7wCgjENoExRQYWoaTJ1EaxeCgbaCBw98KPvjggw8++OCDDz744IMPPvjggw8++OCDDz744IMP8NZD22APDeMaU9sEIN9w+4k81dAu8CpjdxqAPoqpVcgYcmyY/A01oOlz+Klh8rdLAJqTgNokv+AXtAH9AT5ul/zN3kAKSdDiDaQh5QjQHkLK0TfH/+YJsKQcAzSGLuWIrd6/EbRnhCntAO1hVAZWt4KYchBA2yqoPSMcWifAqXECzClHB82hS40ZYTzrGqiNPAjvosSUY2kh7xsIHnAt2WCpe11VFRQaKPru3W7fFAGk7hVIUUGxhaJvyq/dc8rhWql7hbOigmonvyB0xUSAa6bulW5YVEFYPfkFcg4244Kk7iUIVFJBVD/5BQs9H4FTE0VfwbWggromyJ+fg0vK4Nso+u6kUFe/ERbyP+EmR2DlBOh8KiMwANXvgygkBYFgbMEGu6ThCqAQoI0vIA6DToAm1sBCoYWGAPLqF9CIDR40CoTQhhHuQ3oDUC/ont7A2PgXQCBodA1MjX8BBND2JvCrmrwHvvsFVGqD+aJUw17DV5P3vcHvfAH/VCR66V1DVJ0P4kVZzMdfQF9R3tfrjlBHqMfxedUS106APurn2dEaiBUVPU6gwMWkwdVU9wov14iCCsgvCPhzNTxWJfTdbxgiqqjo637uCKeqir4RD4hSGQE47RHpYKVURwBfKHf+cA10NdzyEMwHaaHqbDD/JK+BYyqAW4hf/wIWqGsL8D+uEfYtxK9/AaGqez5ihXS4yghA6RuGHzYKhLou++pWSF0Drq7Oj4g/7JQA48D40x900P/9FuNHMI7hXSukSOeptfh73QY3YIV0ArSiA+GkEKBuK6R/Y79ai5/1f7uRJTBX1hAw/0zYk94Q0IgVuldWD6b4o/hJt8GNWKFRJ0AT8etsacQKudoaozHoJZECov5dtWGF+toIAKcfVbiC3hDQhg7UjXAb8S+6DW7DCrFCgKrjJ89ltgwgqNwKXWZlXK4QoNaSiEyL8SUXJLSo3gqxT4kLPig6BKhcB8u0mPMTAaL8o9qtIM35qsC0wVMD8bPf7wpOIX+1VmhrHHTfjPDCFc4AFkw5+XfxO4X8tVqhPuxXhRjhOICgXh0s5M/lTq+Qv04rxD5fFdliGRH+YmB36vsT0/8Yfx8KhdLeBPmJ+77nDv+3JYD3kjta/u79jy5zTCuiP9PvlkTO7Iu7Av/l5AfkcUmCZeLftkJ0jcVdYQ789wZ/9YXZZr8Vf1SawJHgbwaPsTje7n0rpEKsEMPfChqLMVz/h/iNlX56rww3+6kVUhDQ5DyLGX9aElEQjI40iacfWyEFZ1OzTTcs+LMX0RSMaGm87c9/OE4HCKe/fbK/hun34zeS98Vbeonu51ZIYCHve/tPhvl4e+QXdP/JMB9KOkRN/42gJf0ni5eiNfILzjH9J4t3NLn/0QH737etzhj5Bdf0GhP9XlXMRt2Lwu+TX4/fUtH3+t+Jl0H/Co3+/hPmQomPjJQJ8uu//9Hi5fk3rJAnU3VMnfyXeJzI8HbIL7i8vf+RT8m9a4WsFH3vzzFPzo3LM/mXlN6I3xL5NeXqJ+fmIP/9+0xJfHsJ2Cj69tqap/BE/lILG49z8CMXCGWl6Bu0Ne/2//19LDa942lalvlMZUKNaOBhA0Xw4578xZQQzvsXoSR+Qx0PFz1b2ZXThFxMoF0LVsh3IDCSALqjPg1QwEX6hC1WZ4L8ygqIp+MyiS/rx+m7FQps7l7j+E6O3Jf1Y8DdPxXy23IAsXunTHIqH6BD/k/lJDGlABaN/Epd5FpuBD4J+S0gHJd8TkGr6VIoN8J6cc/Gwqf3aoRz+dMRBLNDm62c03s1wshlBe0en2GLQ84mjfyKTOQKZl7e9RWg1ggnVO4D/TJ+q5U18istLX0Fjz9EreCnP4E5qFm/YLuTOb5VII86ARgMAFHfAp3aI6Eo5WBu7CkB6fzXyZ+DwfIRwGHSJcA/bw359wBWjwC8RZjzP2uBvSpsD1rpLxh53ITV8jWrp0OOqFa/zwZm20NibQP0emFXkYrOUvjbmeZVDcjv9fhS9iWZ6fiVAw3y+Fk/wfT4vVJIDAZeNhOmKoWbXlsCqtgdzKwAOdAgpUEhQHyvTBzKjXSBDLxsJitVIcCoZ8ly9OVl4kx0vILo+OOZjVy+4hOKQmlEQ29ZO4UAXjNJUd8ohmAg8X+JSQB5/F3awZXjdxhfaD0evZ8vaOllnxRJaYbA4hII3L86KfrZ+4ltbH4pQa5iqCxvBSwdEcH2aNM+qsns8fUSuK9F7d5gwktxs7D7DeNrGzOuG1u0TAD0L5IZg7oERAeO+KQG2DL7YReCf53KxKGwUYxWs70lFncHl1f7rrBRoN3xXUKAoPytgwIMb4D6daWhbPUiHhdNg+nJNSDxHz/8p9aMjWFUShrvP/zXGx5tiWUCSPzxjVvA12RcA756tHh4Y4IBBctbYCgSIN2U1TEdNU2erY/zF9D+DNAlHi6ma773IgGkdMeHsyCuSjuAIcRXKe35aBYELbYfux0UAnhNIQV6VRJ19uf4ClibaXBVkmg2NRArBNDjTxOpDYGB7E/zFwTVJISz3hPlwBhQI0BA3SR515/60WuDUmyvgQ2D/rdhvpz6fowKa0xhUQiQnC6RNExgEZjKiKjbRA1kfZI7PMXv0gEsKUD2gd4f3nXT694mx9zhLV2PbDA8r+clvYlAFuoegY4vQCtW6BDu7+94uR7YYHjWwRTr+P1FsoZOVYGKFRxr+P3Za1M9o0YAiZ+r+P37qDj5vOTjy1kfb/33z/36hFoxZIkpQUnU9+kYHsHOkMdBm1zkYlHV4JIOEQcrHS8LKSowupSgqOp646cf3tMeV8UJ+aEc1zEDQmen5h9IKQhySFD+XU/heE6cqSG3V2UNgFfqv6PZIbesZHMLKnDoEyj1XwomJ5zqF7gmLDohZi21MUSTQ26xaHFiV7TBv8CD2uU/BJNDHjtNwC1UXANPlQE+HJYezvDXQp3wfS4VQyIw3LX4gVyBAnEka3leQaCCE/JPrtcfjAv3ZyPtTvohOOSJDyzErz2XEP0FbdW7FQbkawDci7VC95ByhJEtTXhQGMA7e+ReZjeR3exDCGGZLozW3qxUlHseNAOGlwnurh/9EkII89iTsUy/0t6Gu/vLGBQdbBXujSmvp5zvvfUKr85/pbln2fW9cw3x45XfmnV7/b4GvBycpp9v5qlwwOtC+L6vfnj7Jc5LTEtZByoMCPkaYMUKWQH5XLyH4/z9sD/wO9vxi1ofClJYPQnvue1RrJCZzW+vXPi4gtN9S3uMluMHmnPxIvHpmPFpDShWyMjmp15x1lNCW7wRqBB/MMX/uK1tVQr7p5OQMyF8YIWMFL0ian3v4Xn4pU8CGORMsKkD+zy4TpPCwX3fBzEJIti1QjQXXF4hs7GP7pqvEJjEFxiLX59aXGL0MHxjQBZxZ84KKUUvVvnffWdAnwQQi8JB2GQs7aVK4Yj9t5NwzLZ7o1ZIlv8x/9238vaNkgDWSL1JHXgvdakqjO6iIgt+FcnkDfL/pOnAiLhny5wRYCg1AsazzbSXLoVZfQoyFoWjR3tpX53/k1ojgTQVhMNMRtO+uhT2eo9D90ymOBjnf6HI7RQCRPk/09odTD1xpkth1hggnm+w87KZYNDmORSK3AoDYJM7g0J+Y+V/XQqjxoBf30oknsxd8xLMuhVUGJANivRCflPw70th7VHkuCNTYPP8VzMbrkgAKSSxQv56pLA2I6x7fCAOtfD/VNIHfYkAcRMOi0L+aqSwWEcl8UtxRLAFikosSpGb4zMBtpyHEnxVUri4D/4C5Ruw7IOUIncXngnQg4L6pHCZAREENfFfKfJSeCLABDoqk8IKA7qK+J9I48YCBQaAXv2tVQofV3/t60AlzAIDQK/9VSuF9Qf+GuF/boZBf9OyTikszIjaTR/7U8+Cyo3b86hD0PO+lUrhFV1U8r418z89P4wAOqqVwnISHte9KiyJCUZl82tECgsD7O9/eklM4b/AKZtfA1JYQMsAdeCk+NqX/b5O2fxakcIHqLckpqI1KQxN8P/9ft/mpLCOqktiCv/blMLvo6ruSAXtSOGuLf7HozfNG5PCvoMaEdRB3k4Zb9imFA4MCur1QVEZb9egFI4OG+R/r2x+7UnhqWb+kz4ZziubX2NS2HOz/Fc2v6akcDw3zP+7svk1JIUZoWocdEcyKGhABzYAvTtSQ0NSWMGH/61J4Q//Bc1J4YZAsU3+61LYEzQFd/SsTVtSOHCD/Ffyvg1K4eigPfTK5tcQuG3++9Y2P+Ur8Nwy/6ODhkExhRM0i7tsfu1icNgy/2eGD+zDMhAaByI0DPIB2kbfsgbDmxSiWwV7aURoErNy/aSxXNwErYKU6yetpeP5E3/bW4BvL+724le+gb7JQmwfr7ty3Kk99Ru7PBcdsDXlm2Z8jp+gBci77UNejnINpQSu2cukefydb8QPYNi9S3rfenIvcWqpDytQZgUJb+34gZhdSRYdNH9tjNxSF0LoHp1pS2zIDyz5u6RihXwbjZkytD88xK/Tn5+qFPftCwj0bViBR6gWeKXHa+ynsB2DGFppS+Pbw/r4/sEAbmIBXGOaHzvgQA8GnH7/+SmD77bLHoj94xz0tV9Hl1GbvO2Afhu+iV/xh1P1uY+U0vLYA/8RMTSsjPBUv/Xx2w4YURiwEHDd5M/9/rDtgSNAn73PvHAj8csOyHCJmx3sqZX204ibCgS8J2EADs3ELzvg7JNgaqv0KQnwW0yCf6rO+8YUJ5In29z+Nkao3/rh1ae0XEgyYN3u+bql8sOfZtnlJH7K5s+PSEvthz8HOeiy0ic+bF8fuGbyxyQ4Z/EP1ds+Qefzm8fDlu0MVds+QR/SAzGLn2UGZQstjxscwCKlz7uc/A2Qf7p8Hfn9yvuw7oABKofYnOjc14LPSp+DWKJqgdvrymIApiz+8OWDqwaBX4WOFLw6sUJfX07lh/8gwUqud8qs4L3668jkI4rvE9nLwoQJsF4BIMo3ovi+lQBjZoVPXLv1+zfMh+/z8j+kC9ZR9Ye/xE9bHUDij9TG4d9tvucsome1QmMLyteL71u94ERr/NUXfb2Y/NX3DD57da2vPPW1Jfh5P4FHvoChbvcvqS8h/JI2yLODc92Hv4RaHMY6EQiqT32dpATW0iCuWxIEzOP3oZWOr5AELh/CE8f1L5auleGjbl8CdLGJDQDG77OXxffRvfYNQOIPpzmPX6wwec+NXPXzLOJ/d/uxDyPWH39wuJJ+fuP2Z4WUGBbegj6+/Yhci/LND/dC/L8UvTxAJeAFn/rflsPbnxwiVqJ8w3P8PmuBJkUvR6wm9eWeH6UbNh0UHSoJs1stRd9d/P0u/oX1UrGrJvUVSen/A04j6gmzro60VxxAix9ffMphNakv3z35IVne3YtPcR153wlLftAdf8o8eClneKQOoifMqrCFOY0RMtz1+EUYxn8/xV0NF10dyhfw3ugX91gAeEXDQ07co8/V+6f4Q3c0Gajzlmdj4O53vsThKcZZC26zCZeYnFXl67f4vzb1b/HrB7zYBLyZ1oGXOMgWcCrM+wvJ89E1GfYiH00e/mep903xad4fFtNeSISP+KMoJbsTHmXEzfwseniA8jcgMlkQT1aV7xb/m4K2/5rNf5b4Dctgussvntc/8DBjElL6uiZD+qdsKV/Oi/3Hn5I7El3+KTRZ9BX23oXK9Oan5JqMfMraF0B+x9z5Mdqhux1/ShgwavLRAE4hf2eFMk9z4YNPCaZVPi0iJgxhzvh+kvinL1nAx+Tft4uJmLAEjJn16zJPw+JpFMmQY5BrMvbGRVMU6cY+8Rb/JeqXPbq4/u59f5eLYrl8DGhzvi1eY9g8Dc26p5HmuOj6S5CLUosmH43E/2/Ay37EUewOMz+dOOdgtlFKil0cvszvKfM0s7L/Pw0FG3L56DuwAXfakh8hyineHwpaKYlmi4GA7clgvjjHWzhLklPcK29PKtURvy4Bb+vFSuwdpBTE/GdKwB/L4HwgbFwvRnr5lC31u9AWsZSzOP+DQKmOyP8Om3x0aGa8LaxVXr9nLms05svk5wt9i19uxpJ8ythN3yC716OcNWq1LR5nP55R/pVI24youB4GExrq94Z11+e0tfmwJ4B7isML4TtRPhAXZukXcnEwlfoSeDH/538NzgyAMXnWPxSuu6oBytGB0bMp6w8Sv/R90vzvH9Gh1iMu2lAG4kohBE3NxpYk1ipc+REOh6+Oz4KTpSVtWDBrlOu3wUhkavOLad3HNvN/jXrH55QyxO4R/1XCN1f09bxecxw3KS/aRp2MKBDbs+QjE40giFeTfYwkfhl1qc+EFwTxTp1fTYAZIEmT5+bn/N78zqT//hucVAAvsnnYwJbp+ueh5kni1zUsbbnyPmTxC5ylAZ9LbmM7Ocn5oJx1F4tLd8n8+DwZbsb5cN7kS1u677TJYD38WTKHYnsFg62WxyGzsZeNv/5lEgtlLE6W+SFTv79k8ANmQz6zfm+vkR+3Y4PyE5SAraW9HotXbOwqhxhkL3CofAGn/DqEX/8w2kp99WvRY0tjMWT85fJVT1688D/sOgdZrPDZ3E3fEcXGbk99fDl75b7DWVa9yxPBYbOCZGrMwcIy2DKsNlCGvKPiF3mVABFWeKmdREuN4FK+9ZSVAPOcL7LyqSDdkmOuiMJXGjywpc1PjrgxzwPozucqtT2UnXJHAHCewAzu+zy9S3uMimbK58B5UdKbifDO1kXvEXclcJi6+yvlG5LEL1bn4QjAGih71pe7VQpHpiDfjP61RQLOl4BkfiwhT10PUv8BD8BBL9/KtoEwbicF4GIpfL15fZPCTu9kRMkMSMmUHhVwNvqmLV5jOq2LG9IZAHsEBYMk/8XxTMyXYCvzozevbxVd4sMJIbzSJ1z4tJ4lRvnPIT2sIKSIr56D4rTFP37PgxlE3ugRsnn3BZDb7YHJ56lCo6PxwiP6dP7iP5QzGBzWfDBmme/F/O+fp65G3Iq+xQUg3T6DeMUBurgrhlge+BN4lXLgFL8o9n5JaZLh8LP92VicZ3ul6KtVfRda9f64HhVdSAJPhvkfnZwJUd0nRfGNKXknR2UfzN8BH/eZ6+GstkmL4ospDXHd9Ogek1yFsQiSSrZc9iJVLQoD+pQiSfwAXe8ujGAXIoVfYsgz/D6lsd9kL/LF9WSc/x28GX+6/ssZHlTRY9cKvoTPTvoxpQBeoU1l/BcsW5p8wpiSMx2/co/7JfjRJDz0KSWULJB5DIeBSPzrybeElDyYjV8P7o3LUotL6UsD93Cv5EkUeePmHbXopQUmAsxS9K0AXkzgYdZ4cFuZgGIlM+F5LQe+Fb8wgIFiPVOB6R0PtzoflyRp5ORT1uFVD1+In4Lsl4xQDbq3s8Y3EcQIyLXwH99Xiw5oEfnXGsT59dI/2Wj8uMiR0RrE+XRRJEOb8cM4QJPgrXY8c8vxNwtxfm3HP0G7wCgjENoExRQYWoaTJ1EaxeCgbaC5w/+DDz744IMPPvjggw8++OCDDz744IMPDABvPbQN9tAwrjG1TQDyDdceZU53u8CrzFxoAPocjlYhM2ixXfK31H2gD2GmhsnfLgFoTgJqk/yCX9AMlNeXuF3yN9t+HpKgxfbzIeUI0B5CytE3x//mCbCkHAM0hi7liK02XwvaM8KUdoD2MCrTSltBTDkIoG0V1J4RDq0T4NQ4AeaUo4Pm0KXGjDCeFQ3UTB6Ed1FiyrG0kPcNBA+4lmyw1L2uqgoKLRR9d263b4oAUvcKpKig2ELRN+V3LjnlcK3UvcJZUUG1k18QumIiwDVT90o3LKogrJ78AjkHm3FBUvcSBCqpIKqf/IKFno/AqYmir+BaUEFdE+TPz8ElZfBtFH13Uqir3wgL+Z9wkyOwcgJ0PpURGID+qA/6P9HpZtdg1QgHAAAAAElFTkSuQmCC"});var _0;var g0=_(()=>{_0="uniform sampler2D u_image;\nuniform sampler2D u_watermarkTex;\n\nvarying vec2 v_texCoord;\n\n\nvoid main() {\n  vec4 color = texture2D(u_image, v_texCoord);\n  vec4 watermarkColor = texture2D(u_watermarkTex, v_texCoord);\n\n  if (watermarkColor.r > 0.8) {\n    gl_FragColor = mix(color, watermarkColor, 0.3);\n  } else {\n    gl_FragColor = color;\n  }\n}\n"});var nu;var y0=_(()=>{F();g0();nu=class extends T.Filter{constructor(...e){super(...e);this._fragmentSource=_0}_applyWebGL(e,t,i,r=false){const o=e.getContext();const{canvas:n}=o;const a=this.getShaderForRenderer(e);const l=t.getFrame();const u=this._watermarkCanvas;if(!u||l.width!==u.width||l.height!==u.height){this._createWatermarkCanvas(l.width,l.height)}const c=T.Texture.fromCanvas(this._watermarkCanvas);const h=c.getBaseTexture();e.updateTexture(h);h.setGLUnit(1);e.setRenderTarget(i);if(r){i.clear()}e.setShader(a);const m=e.getCurrentRenderTarget().getProjectionMatrix().toArray();a.setUniform("u_projMatrix",m);a.syncUniforms();o.uniform1i(o.getUniformLocation(a.getProgram(),"u_watermarkTex"),1);o.activeTexture(o.TEXTURE0);o.bindTexture(o.TEXTURE_2D,t.getTexture());o.activeTexture(o.TEXTURE1);o.bindTexture(o.TEXTURE_2D,h.getGLTextureForRenderer(e));o.drawElements(o.TRIANGLES,6,o.UNSIGNED_SHORT,0);c.dispose()}_createWatermarkCanvas(e,t){const i=this._options.watermarkImage;const r=R.createCanvas();r.width=e;r.height=t;const o=r.getContext("2d");const n=o.createPattern(i,"repeat");o.fillStyle=n;o.fillRect(0,0,r.width,r.height);this._watermarkCanvas=r;this._watermarkContext=o}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const l=this._options.watermarkImage;this._createWatermarkCanvas(o.width,o.height);const u=n.getImageData(0,0,o.width,o.height);const c=this._watermarkContext.getImageData(0,0,o.width,o.height);const h=new E;const m=new E;const d=new E;for(let f=0;f<o.width*o.height*4;f+=4){h.set(u.data[f]/255,u.data[f+1]/255,u.data[f+2]/255,u.data[f+3]/255);m.set(c.data[f]/255,c.data[f+1]/255,c.data[f+2]/255,c.data[f+3]/255);if(m.r>.8){d.copy(h.clone().mix(m,.3))}else{d.copy(h)}u.data[f]=d.r*255;u.data[f+1]=d.g*255;u.data[f+2]=d.b*255;u.data[f+3]=d.a*255}a.putImageData(u,0,0)}};nu.prototype.availableOptions={watermarkImage:{type:p.OBJECT,required:true}}});var ua,b0;var x0=_(()=>{F();f0();y0();ua=class extends le{constructor(...e){super(...e);I(this,"_applyWatermarkFilter",()=>{if(!this._watermarkFilter){this._watermarkFilter=new nu({watermarkImage:this._watermarkImage})}this._sprite.setFilters([this._watermarkFilter]);this._renderTexture.render(this._container);return Promise.resolve()});I(this,"_loadWatermarkImage",()=>{if(!this._watermarkImage){return new Promise((e,t)=>{this._watermarkImage=new ft;this._watermarkImage.onload=e;this._watermarkImage.src=h0})}return Promise.resolve()});this._watermarkFilter=null;this._watermarkImage=null}_render(e){return this._loadWatermarkImage().then(this._applyWatermarkFilter)}dispose(){if(this._watermarkFilter){this._watermarkFilter.dispose()}super.dispose()}};ua.identifier="license-watermark";ua.prototype.availableOptions={};q.Operations.LicenseWatermarkOperation=ua;b0=ua});var w0;var v0=_(()=>{w0="/*!\n * Based on evanw's glfx.js tilt shift shader:\n * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js\n */\n\nuniform sampler2D u_image;\nuniform float u_blurRadius;\nuniform vec2 u_controlPoint1;\nuniform vec2 u_controlPoint2;\nuniform vec2 u_delta;\nuniform vec2 u_texSize;\nvarying vec2 v_texCoord;\n\nfloat random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt = dot(co.xy,vec2(a,b));\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    vec2 vector = u_controlPoint2 - u_controlPoint1;\n    float offset = random(gl_FragCoord.xy / u_texSize.xy);\n\n    float radius = smoothstep(0.0, 1.0,\n      abs(\n        clamp(dot(v_texCoord - u_controlPoint1, vector) / dot(vector, vector), 0.0, 1.0)\n      )\n    ) * u_blurRadius;\n\n    for (float t = -30.0; t <= 30.0; t++) {\n      float percent = (t + offset - 0.5) / 30.0;\n      float weight = 1.0 - abs(percent);\n      vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);\n\n      color += _sample * weight;\n      total += weight;\n    }\n\n    gl_FragColor = color / total;\n}\n"});var Hi,Sp,au;var C0=_(()=>{F();Uo();v0();({Vector2:Hi}=M);Sp=class extends T.Filter{constructor(...e){super(...e);this._fragmentSource=w0;this._lastBlurRadius=null;this._lastControlPoint1=new Hi;this._lastControlPoint2=new Hi;this._blurFilter=new vt;this._blurredRenderTarget=new T.CanvasRenderTarget(100,100,1);this._maskRenderTarget=new T.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=false){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}const o=t.getDimensions();const n=!i.getDimensions().equals(o);const a=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;if(a){const l=new Hi(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(l);const u={blurRadius:this._options.blurRadius,texSize:o};const c=(b,y,g)=>Math.min(Math.max(b,y),g);const h=(b,y,g)=>{const C=c((g-b)/(y-b),0,1);return C*C*(3-2*C)};const m=this._options.controlPoint2.clone().subtract(this._options.controlPoint1.clone());const{blurRadius:d}=this._options;const f=(b,y)=>{return h(0,1,Math.abs(c(new Hi(b,y).subtract(this._options.controlPoint1).dot(m)/m.dot(m),0,1)))*d};this._blurFilter.set(u);this._blurFilter._applyCanvas(e,t,i,r,f);this._lastBlurRadius=this._options.blurRadius}}_renderLQBlur(e,t,i,r=false){const o=t.getDimensions();const n=!this._blurredRenderTarget.getDimensions().equals(o);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio());this._blurredRenderTarget.resizeTo(t.getDimensions());this._maskRenderTarget.setPixelRatio(t.getPixelRatio());this._maskRenderTarget.resizeTo(t.getDimensions());const a=!this._lastControlPoint1.equals(this._options.controlPoint1)||!this._lastControlPoint2.equals(this._options.controlPoint2)||n;const l=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;if(a){this._renderMask();this._lastControlPoint1=this._options.controlPoint1.clone();this._lastControlPoint2=this._options.controlPoint2.clone()}if(l){this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius);this._lastBlurRadius=this._options.blurRadius}this._applyMask(t,i)}_renderMask(){const e=this._maskRenderTarget.getCanvas();const t=this._maskRenderTarget.getContext();const i=new Hi(e.width,e.height);const r=this._options.controlPoint1.clone().multiply(i);const o=this._options.controlPoint2.clone().multiply(i);const n=t.createLinearGradient(r.x,r.y,o.x,o.y);n.addColorStop(0,"#FFFFFF");n.addColorStop(1,"#000000");t.fillStyle=n;t.fillRect(0,0,e.width,e.height)}_applyMask(e,t){const i=t.getContext();const r=e.getCanvas();const o=e.getContext();const n=this._blurredRenderTarget.getContext();const a=this._maskRenderTarget.getContext();const l=o.getImageData(0,0,r.width,r.height);const u=l.data;const c=n.getImageData(0,0,r.width,r.height).data;const h=a.getImageData(0,0,r.width,r.height).data;let m;for(let d=0;d<r.width*r.height*4;d+=4){m=h[d]/255;u[d]=m*u[d]+(1-m)*c[d];u[d+1]=m*u[d+1]+(1-m)*c[d+1];u[d+2]=m*u[d+2]+(1-m)*c[d+2]}i.putImageData(l,0,0)}dispose(){super.dispose();this._blurFilter.dispose();this._blurredRenderTarget.dispose();this._maskRenderTarget.dispose()}};Sp.prototype.availableOptions={blurRadius:{type:p.NUMBER,default:30,uniformType:O.FLOAT},controlPoint1:{type:p.VECTOR2,default:new Hi(0,.5),uniformType:O.FLOAT2},controlPoint2:{type:p.VECTOR2,default:new Hi(1,.5),uniformType:O.FLOAT2},delta:{type:p.VECTOR2,default:new Hi(1,1),uniformType:O.FLOAT2},texSize:{type:p.VECTOR2,default:new Hi(100,100),uniformType:O.FLOAT2}};au=Sp});var lu,ca,D0;var k0=_(()=>{F();C0();({Vector2:lu}=M);ca=class extends le{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius;this._lastControlPoint1=this._options.controlPoint1.clone();this._lastControlPoint2=this._options.controlPoint2.clone();const t={blurQuality:{type:p.STRING}};this._horizontalFilter=new au({},t);this._verticalFilter=new au({},t);this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]);this._horizontalFilter.setDelta(new lu(.5,.5));this._verticalFilter.setDelta(new lu(-.5,.5));this._filter=new au({},t)}rotate(e){const{controlPoint1:t}=this._options;const{controlPoint2:i}=this._options;if(e===90){t.flip();t.x=1-t.x;i.flip();i.x=1-i.x}else if(e===-90){t.flip();t.y=1-t.y;i.flip();i.y=1-i.y}this.set({controlPoint1:t,controlPoint2:i})}flip(e){const{controlPoint1:t}=this._options;const{controlPoint2:i}=this._options;switch(e){case"horizontal":t.x=1-t.x;i.x=1-i.x;break;case"vertical":t.y=1-t.y;i.y=1-i.y;break}this.set({controlPoint1:t,controlPoint2:i})}transform(e){const t={};["controlPoint1","controlPoint2"].forEach(i=>{const r=this.getOption(i);t[i]=e.applyToRelativePoint(r)});["blurRadius"].forEach(i=>{const r=this.getOption(i);t[i]=e.applyToRelativeSize(r)});this.set(t,false)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){if(this._options.highQualityCanvasBlur){return this._renderBlur(e)}return this._renderLQCanvasBlur(e)}_renderBlur(e){const t=e.getDimensions();const i=t.min();const{blurRadius:r,controlPoint1:o,controlPoint2:n}=this._options;const a={blurRadius:r*i,controlPoint1:o.clone(),controlPoint2:n.clone(),texSize:t,blurQuality:"high"};this._horizontalFilter.set(a);this._verticalFilter.set(a);this._renderTexture.render(this._container);return Promise.resolve()}_renderLQCanvasBlur(e){const t=e.getDimensions();const{blurRadius:i,controlPoint1:r,controlPoint2:o}=this._options;this._filter.set({blurRadius:i,controlPoint1:r.clone(),controlPoint2:o.clone(),texSize:t,blurQuality:"low"});this._sprite.setFilters([this._filter]);this._renderTexture.render(this._container);return Promise.resolve()}dispose(){super.dispose();this._filter.dispose();this._verticalFilter.dispose();this._horizontalFilter.dispose()}hasChanges(){return true}};ca.identifier="linear-focus";ca.prototype.availableOptions={controlPoint1:{type:p.VECTOR2,default:new lu(0,.5)},controlPoint2:{type:p.VECTOR2,default:new lu(1,.5)},blurRadius:{type:p.NUMBER,default:.025},highQualityCanvasBlur:{type:p.BOOLEAN,default:false}};q.Operations.LinearFocusOperation=ca;D0=ca});var R0;var T0=_(()=>{R0="/*\n * Based on evanw's glfx.js tilt shift shader:\n * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js\n * @license\n */\n\nuniform sampler2D u_image;\nuniform float u_blurRadius;\nuniform float u_gradientSize;\nuniform float u_size;\nuniform vec2 u_start;\nuniform vec2 u_end;\nuniform vec2 u_delta;\nuniform vec2 u_texSize;\nvarying vec2 v_texCoord;\n\nfloat random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt = dot(co.xy,vec2(a,b));\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(gl_FragCoord.xy / u_texSize.xy);\n\n    vec2 normal = normalize(vec2(u_start.y - u_end.y, u_end.x - u_start.x));\n    float radius = smoothstep(0.0, 1.0,\n      (abs(\n        dot(v_texCoord * u_texSize - u_start, normal)\n      ) - u_size) / u_gradientSize\n    ) * u_blurRadius;\n\n    for (float t = -30.0; t <= 30.0; t++) {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);\n\n        color += _sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n}\n"});var qi,Fp,uu;var E0=_(()=>{F();Uo();T0();({Vector2:qi}=M);Fp=class extends T.Filter{constructor(...e){super(...e);this._fragmentSource=R0;this._lastBlurRadius=null;this._lastGradientRadius=null;this._lastStart=new qi;this._lastEnd=new qi;this._blurFilter=new vt;this._blurredRenderTarget=new T.CanvasRenderTarget(100,100,1);this._maskRenderTarget=new T.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=false){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}const o=t.getDimensions();const n=!i.getDimensions().equals(o);const a=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;if(a){const l=new qi(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(l);const u={blurRadius:this._options.blurRadius,texSize:o};const c=(x,B,w)=>Math.min(Math.max(x,B),w);const h=(x,B,w)=>{const D=c((w-x)/(B-x),0,1);return D*D*(3-2*D)};const{blurRadius:m,gradientSize:d,size:f,start:b,end:y,texSize:g}=this._options;const C=new qi(b.y-y.y,y.x-b.x);C.divide(C.len());const v=(x,B)=>{return h(0,1,(Math.abs(g.clone().multiply(x,B).subtract(b).dot(C))-f)/d)*m};this._blurFilter.set(u);this._blurFilter._applyCanvas(e,t,i,r,v);this._lastBlurRadius=this._options.blurRadius}}_renderLQBlur(e,t,i,r=false){const o=t.getDimensions();const n=!this._blurredRenderTarget.getDimensions().equals(o);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio());this._blurredRenderTarget.resizeTo(t.getDimensions());this._maskRenderTarget.setPixelRatio(t.getPixelRatio());this._maskRenderTarget.resizeTo(t.getDimensions());const a=!this._lastStart.equals(this._options.start)||!this._lastEnd.equals(this._options.end)||this._lastGradientRadius!==this._options.size||n;const l=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;if(a){this._renderMask();this._lastStart=this._options.start.clone();this._lastEnd=this._options.end.clone();this._lastGradientRadius=this._options.size}if(l){this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius);this._lastBlurRadius=this._options.blurRadius}this._applyMask(t,i)}_renderMask(){const e=this._maskRenderTarget.getCanvas();const t=this._maskRenderTarget.getContext();const i=this._maskRenderTarget.getPixelRatio();const r=new qi(e.width,e.height);const o=this._options.size*r.min()*i;const n=this._options.gradientSize*r.min()*i;const a=this._options.start.clone().multiply(r);const l=this._options.end.clone().multiply(r);const u=l.clone().subtract(a);const c=a.clone().add(u.clone().divide(2));const h=u.len();const m=u.clone().divide(h);const d=c.clone().add((o+n)*m.y,-(o+n)*m.x);const f=c.clone().add(-(o+n)*m.y,(o+n)*m.x);const b=t.createLinearGradient(d.x,d.y,f.x,f.y);const y=f.clone().subtract(d).len();b.addColorStop(0,"#000000");b.addColorStop(n/2/y,"#FFFFFF");b.addColorStop(1-n/2/y,"#FFFFFF");b.addColorStop(1,"#000000");t.fillStyle=b;t.fillRect(0,0,e.width,e.height)}_applyMask(e,t){const i=t.getContext();const r=e.getCanvas();const o=e.getContext();const n=this._blurredRenderTarget.getContext();const a=this._maskRenderTarget.getContext();const l=o.getImageData(0,0,r.width,r.height);const u=l.data;const c=n.getImageData(0,0,r.width,r.height).data;const h=a.getImageData(0,0,r.width,r.height).data;let m;for(let d=0;d<r.width*r.height*4;d+=4){m=h[d]/255;u[d]=m*u[d]+(1-m)*c[d];u[d+1]=m*u[d+1]+(1-m)*c[d+1];u[d+2]=m*u[d+2]+(1-m)*c[d+2]}i.putImageData(l,0,0)}dispose(){super.dispose();this._blurFilter.dispose()}};Fp.prototype.availableOptions={blurRadius:{type:p.NUMBER,default:30,uniformType:O.FLOAT},size:{type:p.NUMBER,default:50,uniformType:O.FLOAT},gradientSize:{type:p.NUMBER,default:50,uniformType:O.FLOAT},start:{type:p.VECTOR2,default:new qi(0,.5),uniformType:O.FLOAT2},end:{type:p.VECTOR2,default:new qi(1,.5),uniformType:O.FLOAT2},delta:{type:p.VECTOR2,default:new qi(1,1),uniformType:O.FLOAT2},texSize:{type:p.VECTOR2,default:new qi(100,100),uniformType:O.FLOAT2}};uu=Fp});var cu,ma,S0;var F0=_(()=>{F();E0();({Vector2:cu}=M);ma=class extends le{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius;this._lastSize=this._options.size;this._lastGradientSize=this._options.gradientSize;const t={blurQuality:{type:p.STRING}};this._horizontalFilter=new uu({},t);this._verticalFilter=new uu({},t);this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]);this._horizontalFilter.setDelta(new cu(.5,.5));this._verticalFilter.setDelta(new cu(-.5,.5));this._filter=new uu({},t);this._renderBlur.bind(this)}rotate(e){const{start:t}=this._options;const{end:i}=this._options;if(e===90){t.flip();t.x=1-t.x;i.flip();i.x=1-i.x}else if(e===-90){t.flip();t.y=1-t.y;i.flip();i.y=1-i.y}this.set({start:t,end:i})}flip(e){const{start:t}=this._options;const{end:i}=this._options;switch(e){case"horizontal":t.x=1-t.x;i.x=1-i.x;break;case"vertical":t.y=1-t.y;i.y=1-i.y;break}this.set({start:t,end:i})}transform(e){const t={};["start","end"].forEach(i=>{const r=this.getOption(i);t[i]=e.applyToRelativePoint(r)});["blurRadius","size","gradientSize"].forEach(i=>{const r=this.getOption(i);t[i]=e.applyToRelativeSize(r)});this.set(t,false)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){if(this._options.highQualityCanvasBlur){return this._renderBlur(e)}return this._renderLQCanvasBlur(e)}_renderBlur(e){const t=e.getDimensions();const i=t.min();const r=this._options.start.clone();const o=this._options.end.clone();const{blurRadius:n,size:a,gradientSize:l}=this._options;const u={blurRadius:n*i,size:a*i,gradientSize:l*i,start:r.clone().multiply(t),end:o.clone().multiply(t),texSize:t,blurQuality:"high"};this._horizontalFilter.set(u);this._verticalFilter.set(u);this._renderTexture.render(this._container);return Promise.resolve()}_renderLQCanvasBlur(e){const t=e.getDimensions();const{blurRadius:i,size:r,gradientSize:o,start:n,end:a}=this._options;this._filter.set({blurRadius:i,gradientSize:o,size:r,start:n.clone(),end:a.clone(),texSize:t,blurQuality:"low"});this._sprite.setFilters([this._filter]);this._renderTexture.render(this._container);return Promise.resolve()}dispose(){super.dispose();this._filter.dispose();this._verticalFilter.dispose();this._horizontalFilter.dispose()}hasChanges(){return true}};ma.identifier="mirrored-focus";ma.prototype.availableOptions={start:{type:p.VECTOR2,default:new cu(0,.5)},end:{type:p.VECTOR2,default:new cu(1,.5)},blurRadius:{type:p.NUMBER,default:.025},size:{type:p.NUMBER,default:.1},gradientSize:{type:p.NUMBER,default:.1},highQualityCanvasBlur:{type:p.BOOLEAN,default:false}};q.Operations.MirroredFocusOperation=ma;S0=ma});var y1,da,O0;var A0=_(()=>{F();({Vector2:y1}=M);da=class extends le{_render(e){const t=this._options.rotation%360;const i=t*(Math.PI/180);const r=t===90||t===270;const o=this._options.flipHorizontally!==this._options.flipVertically;const n=r&&o?!this._options.flipVertically:this._options.flipVertically;const a=r&&o?!this._options.flipHorizontally:this._options.flipHorizontally;this._sprite.setScale(a?-1:1,n?-1:1);this._sprite.setRotation(i);this._sprite.setAnchor(.5,.5);this._sprite.updateTransform();const l=this._sprite.getBounds();this._renderTexture.resizeTo(new y1(l.width,l.height));this._sprite.setPosition(this._renderTexture.getDimensions().divide(2).round());this._renderTexture.render(this._container);return Promise.resolve()}getNewDimensions(e){e=e.clone();if(this._options.rotation%180){e.flip()}return e}flip(e){const{rotation:t}=this._options;if(t===90||t===270){if(e==="vertical"){e="horizontal"}else{e="vertical"}}switch(e){case"vertical":this.setFlipVertically(!this.getFlipVertically());break;case"horizontal":this.setFlipHorizontally(!this.getFlipHorizontally());break}}};da.identifier="orientation";da.prototype.availableOptions={rotation:{type:p.NUMBER,default:0,validation(s){if(s%90!==0){throw new Error("OrientationOperation: `rotation` has to be a multiple of 90.")}},setter:s=>(s+360)%360},flipVertically:{type:p.BOOLEAN,default:false},flipHorizontally:{type:p.BOOLEAN,default:false}};q.Operations.OrientationOperation=da;O0=da});var mu,pa,I0;var P0=_(()=>{F();({Vector2:mu}=M);pa=class extends le{constructor(...e){super(...e);this._flipContainer=new T.Container}_render(e){const{position:t,rotation:i,scale:r,pivot:o,outputResolution:n}=this._options;const a=this._sdk.getTextureScale();const l=n.clone().multiply(a).ceil();this._renderTexture.resizeTo(l);this._sprite.setRotation(i);this._sprite.setPosition(t);this._sprite.setPivot(o);this._sprite.setScale(r);this._renderTexture.render(this._container);return Promise.resolve()}getNewDimensions(e){const t=this._sdk.getTextureScale();return this._options.outputResolution.clone().multiply(t).ceil()}};pa.identifier="output";pa.prototype.availableOptions={position:{type:p.VECTOR2,default:new mu(0,0)},rotation:{type:p.NUMBER,default:0},scale:{type:p.VECTOR2,default:new mu(1,1)},pivot:{type:p.VECTOR2,default:new mu(0,0)},outputResolution:{type:p.VECTOR2,default:new mu(100,100)}};q.Operations.OutputOperation=pa;I0=pa});var du,B0,b1,Ho,M0;var L0=_(()=>{F();({OverlayFilter:du}=T.Filters);({Vector2:B0}=M);b1=4;Ho=class extends le{constructor(...e){super(...e);this._overlayTexture=T.Texture.fromImage(this._options.image);this._overlayContainer=new T.Container;this._overlaySprite=new T.Sprite;this._overlaySprite.setTexture(this._overlayTexture);this._overlaySprite.setAnchor(0,0);this._overlayContainer.addChild(this._overlaySprite);this._overlayFilter=new T.Filters.OverlayFilter({overlayImage:this._overlayTexture.getBaseTexture().getGLUnit(),overlayTexture:this._overlayTexture});this._sprite.setFilters([this._overlayFilter]);this._renderedOverlaySprite=new T.Sprite;this._renderedOverlayContainer=new T.Container;this._renderedOverlayContainer.addChild(this._renderedOverlaySprite);this._overlayRendered=false;this._lastInputDimensions=new B0(0,0)}setOption(e,t){super.setOption(e,t);if(e==="image"&&t&&this._sdk){const i=this._sdk.getRenderer();const r=this._overlayTexture.getBaseTexture();r.setSource(t);if(i.isOfType(H.WEBGL)){i.updateTexture(r)}this._overlayRendered=false}}_render(e){const t=e.getDimensions();const{image:i,alpha:r,blendMode:o}=this._options;if(!i){this._sprite.setFilters([]);this._renderTexture.render(this._container);return Promise.resolve()}if(!this._overlayRendered||!this._lastInputDimensions.equals(t)){this._renderOverlayToRenderTexture(e);this._overlayRendered=true;this._lastInputDimensions.copy(t)}this._overlayFilter.set({blendMode:o,overlayImage:this._overlayRenderTexture.getBaseTexture().getGLUnit(),overlayTexture:this._overlayRenderTexture,alpha:r});this._sprite.setFilters([this._overlayFilter]);this._renderTexture.render(this._container);return Promise.resolve()}_renderOverlayToRenderTexture(e){const t=this._sdk.getRenderer();const i=e.getDimensions();if(!this._overlayRenderTexture){this._overlayRenderTexture=new T.RenderTexture(t,i.x,i.y);this._renderedOverlaySprite.setTexture(this._overlayRenderTexture)}const{width:r,height:o}=this._options.image;const n=R.resizeVectorToFill(new B0(r,o),i);const{flipHorizontally:a,flipVertically:l}=this._options;const u=a?-1:1;const c=l?-1:1;this._overlaySprite.setWidth(n.x*u);this._overlaySprite.setHeight(n.y*c);this._overlaySprite.setPosition(i.x*(1-u)*.5,i.y*(1-c)*.5);const h=this._overlayRenderTexture.getBaseTexture();this._overlayRenderTexture.resizeTo(i);if(t.isOfType(H.WEBGL)){h.setGLUnit(b1);t.updateTexture(h,false)}this._overlayRenderTexture.render(this._overlayContainer)}dispose(){super.dispose();if(this._overlaySprite)this._overlaySprite.dispose();if(this._overlayRenderTexture)this._renderedOverlaySprite.dispose();if(this._overlayFilter)this._overlayFilter.dispose();if(this._overlayTexture)this._overlayTexture.dispose();if(this._overlayRenderTexture)this._overlayRenderTexture.dispose();if(this._renderedOverlaySprite)this._renderedOverlaySprite.dispose()}};Ho.identifier="overlay";Ho.BLEND_MODES=du.BLEND_MODES;Ho.prototype.availableOptions={identifier:{type:p.STRING},image:{type:p.IMAGE},blendMode:{type:p.NUMBER,default:du.BLEND_MODES.MULTIPLY,available:Object.keys(du.BLEND_MODES).map(s=>du.BLEND_MODES[s])},alpha:{type:p.NUMBER,default:1},flipHorizontally:{type:p.BOOLEAN,default:false},flipVertically:{type:p.BOOLEAN,default:false}};q.Operations.OverlayOperation=Ho;M0=Ho});var U0;var z0=_(()=>{U0="/*\n * Based on evanw's glfx.js tilt shift shader:\n * https://github.com/evanw/glfx.js/blob/master/src/filters/blur/tiltshift.js\n * @license\n */\n\nuniform sampler2D u_image;\nuniform float u_radius;\nuniform float u_blurRadius;\nuniform float u_gradientRadius;\nuniform vec2 u_position;\nuniform vec2 u_delta;\nuniform vec2 u_texSize;\nvarying vec2 v_texCoord;\n\nconst float blurSteps = 30.0;\nconst float EPSILON = 0.000000001;\n\nfloat random(vec2 co)\n{\n    highp float a = 12.9898;\n    highp float b = 78.233;\n    highp float c = 43758.5453;\n    highp float dt = dot(co.xy,vec2(a,b));\n    highp float sn = mod(dt, 3.14);\n    return fract(sin(sn) * c);\n}\n\nvoid main() {\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    vec2 coord = v_texCoord * u_texSize;\n    vec2 diff = coord - u_position;\n    float dist = sqrt(diff.x * diff.x + diff.y * diff.y);\n\n    float blurPercentage = smoothstep( \n      0.0, 1.0,\n      (abs(dist) - u_radius) / u_gradientRadius\n    );\n\n    float radius = blurPercentage * u_blurRadius;\n    float offset = random(gl_FragCoord.xy / u_texSize.xy);\n\n    for (float t = -blurSteps; t <= blurSteps; t++) {\n        float percent = (t + offset - 0.5) / blurSteps;\n        float weight = 1.0 - abs(percent);\n        vec4 _sample = texture2D(u_image, v_texCoord + u_delta * percent * radius / u_texSize);\n\n        color += _sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / max(total, EPSILON);\n}\n"});var qo,Op,pu;var N0=_(()=>{F();Uo();z0();({Vector2:qo}=M);Op=class extends T.Filter{constructor(...e){super(...e);this._fragmentSource=U0;this._lastBlurRadius=null;this._lastGradientRadius=null;this._lastPosition=new qo;this._blurFilter=new vt;this._blurredRenderTarget=new T.CanvasRenderTarget(100,100,1);this._maskRenderTarget=new T.CanvasRenderTarget(100,100,1)}_applyCanvas(e,t,i,r=false){if(this._options.blurQuality==="low"){this._renderLQBlur(e,t,i,r);return}const o=t.getDimensions();const n=!i.getDimensions().equals(o);const{blurRadius:a,position:l,texSize:u,gradientRadius:c}=this._options;const h=t.getBaseTexture().isDirty()||this._lastBlurRadius!==a||n;if(h){const m=new qo(this._options.delta.x,this._options.delta.y);this._blurFilter.setDelta(m);const d={blurRadius:a,texSize:o};const f=(g,C,v)=>Math.min(Math.max(g,C),v);const b=(g,C,v)=>{const x=f((v-g)/(C-g),0,1);return x*x*(3-2*x)};const y=(g,C)=>{return b(0,1,(Math.abs(u.clone().multiply(g,C).subtract(l).len())-this._options.radius)/(c*2))*a};this._blurFilter.set(d);this._blurFilter._applyCanvas(e,t,i,r,y);this._lastBlurRadius=a}}_renderLQBlur(e,t,i,r=false){const o=t.getDimensions();const n=!this._blurredRenderTarget.getDimensions().equals(o);this._blurredRenderTarget.setPixelRatio(t.getPixelRatio());this._blurredRenderTarget.resizeTo(t.getDimensions());this._maskRenderTarget.setPixelRatio(t.getPixelRatio());this._maskRenderTarget.resizeTo(t.getDimensions());const a=!this._lastPosition.equals(this._options.position)||this._lastGradientRadius!==this._options.gradientRadius||n;const l=t.getBaseTexture().isDirty()||this._lastBlurRadius!==this._options.blurRadius||n;if(a){this._renderMask();this._lastPosition=this._options.position.clone();this._lastGradientRadius=this._options.gradientRadius}if(l){this._blurImage(t,this._blurredRenderTarget,this._options.blurRadius);this._lastBlurRadius=this._options.blurRadius}this._applyMask(t,i)}_renderMask(){const e=this._maskRenderTarget.getCanvas();const t=this._maskRenderTarget.getContext();const i=new qo(e.width,e.height);const r=this._maskRenderTarget.getPixelRatio();const o=this._options.position.clone().multiply(i);let{radius:n,gradientRadius:a}=this._options;n*=e.height;a*=e.height;const l=t.createRadialGradient(o.x,o.y,0,o.x,o.y,(n+a)*r);l.addColorStop(0,"#FFFFFF");l.addColorStop(n/(n+a),"#FFFFFF");l.addColorStop(1,"#000000");t.fillStyle=l;t.fillRect(0,0,i.x,i.y)}_applyMask(e,t){const i=t.getContext();const r=e.getCanvas();const o=e.getContext();const n=this._blurredRenderTarget.getContext();const a=this._maskRenderTarget.getContext();const l=o.getImageData(0,0,r.width,r.height);const u=l.data;const c=n.getImageData(0,0,r.width,r.height).data;const h=a.getImageData(0,0,r.width,r.height).data;let m;for(let d=0;d<r.width*r.height*4;d+=4){m=h[d]/255;u[d]=m*u[d]+(1-m)*c[d];u[d+1]=m*u[d+1]+(1-m)*c[d+1];u[d+2]=m*u[d+2]+(1-m)*c[d+2]}i.putImageData(l,0,0)}dispose(){super.dispose();this._blurFilter.dispose();this._blurredRenderTarget.dispose();this._maskRenderTarget.dispose()}};Op.prototype.availableOptions={blurRadius:{type:p.NUMBER,default:30,uniformType:O.FLOAT},radius:{type:p.NUMBER,default:50,uniformType:O.FLOAT},gradientRadius:{type:p.NUMBER,default:25,uniformType:O.FLOAT},position:{type:p.VECTOR2,default:new qo(.5,.5),uniformType:O.FLOAT2},delta:{type:p.VECTOR2,default:new qo(1,1),uniformType:O.FLOAT2},texSize:{type:p.VECTOR2,default:new qo(100,100),uniformType:O.FLOAT2}};pu=Op});var Ap,ha,G0;var W0=_(()=>{F();N0();({Vector2:Ap}=M);ha=class extends le{constructor(...e){super(...e);this._lastBlurRadius=this._options.blurRadius;this._lastGradientRadius=this._options.gradientRadius;const t={blurQuality:{type:p.STRING}};this._horizontalFilter=new pu({},t);this._verticalFilter=new pu({},t);this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]);this._horizontalFilter.setDelta(new Ap(.5,.5));this._verticalFilter.setDelta(new Ap(-.5,.5));this._filter=new pu({},t)}rotate(e){const{position:t}=this._options;if(e===90){t.flip();t.x=1-t.x}else if(e===-90){t.flip();t.y=1-t.y}this.set({position:t})}flip(e){const{position:t}=this._options;switch(e){case"horizontal":t.x=1-t.x;break;case"vertical":t.y=1-t.y;break}this.set({position:t})}transform(e){const t={};const i=this.getPosition();t.position=e.applyToRelativePoint(i);["radius","blurRadius","gradientRadius"].forEach(r=>{const o=this.getOption(r);t[r]=e.applyToRelativeSize(o)});this.set(t,false)}_renderWebGL(e){return this._renderBlur(e)}_renderCanvas(e){if(this._options.highQualityCanvasBlur){return this._renderBlur(e)}return this._renderLQCanvasBlur(e)}_renderBlur(e){const t=e.getDimensions();const i=t.min();const{position:r,blurRadius:o,radius:n,gradientRadius:a}=this._options;const l={blurRadius:o*i,radius:n*i,gradientRadius:a*i,position:r.clone().multiply(t),texSize:t,blurQuality:"high"};this._horizontalFilter.set(l);this._verticalFilter.set(l);this._renderTexture.render(this._container);return Promise.resolve()}_renderLQCanvasBlur(e){const{blurRadius:t,radius:i,gradientRadius:r,position:o}=this._options;const n=e.getDimensions();this._filter.set({blurRadius:t,radius:i,gradientRadius:r,position:o,texSize:n,blurQuality:"low"});this._sprite.setFilters([this._filter]);this._renderTexture.render(this._container);return Promise.resolve()}dispose(){super.dispose();this._filter.dispose();this._verticalFilter.dispose();this._horizontalFilter.dispose()}hasChanges(){return true}};ha.identifier="radial-focus";ha.prototype.availableOptions={position:{type:p.VECTOR2,default:new Ap(.5,.5)},radius:{type:p.NUMBER,default:.25},gradientRadius:{type:p.NUMBER,default:.125},blurRadius:{type:p.NUMBER,default:.025},highQualityCanvasBlur:{type:p.BOOLEAN,default:false}};q.Operations.RadialFocusOperation=ha;G0=ha});var j0;var V0=_(()=>{j0="varying vec2 v_texCoord;\nuniform sampler2D u_image;\nuniform sampler2D u_filterImage;\nuniform sampler2D u_maskImage;\n\nvoid main() {\n  vec4 color0 = texture2D(u_image, v_texCoord);\n  vec4 color1 = texture2D(u_filterImage, v_texCoord);\n  vec4 mask = texture2D(u_maskImage, v_texCoord);\n  gl_FragColor = mix(color0, color1, mask);\n}\n"});var Ip,H0;var q0=_(()=>{F();V0();Ip=class extends T.Filter{constructor(){super();this._fragmentSource=j0}_applyCanvas(e,t,i,r=false){const o=t.getCanvas();const n=t.getContext();const a=i.getContext();const{maskCanvas:l,filterCanvas:u}=this._options;const c=l.getContext("2d");const h=u.getContext("2d");const m=c.getImageData(0,0,o.width,o.height).data;const d=n.getImageData(0,0,o.width,o.height);const f=d.data;const b=h.getImageData(0,0,o.width,o.height).data;let y;for(let g=0;g<o.width*o.height*4;g+=4){y=m[g]/255;f[g]=y*b[g]+(1-y)*f[g];f[g+1]=y*b[g+1]+(1-y)*f[g+1];f[g+2]=y*b[g+2]+(1-y)*f[g+2]}a.putImageData(d,0,0)}};Ip.prototype.availableOptions={maskImage:{type:p.NUMBER,default:1,uniformType:O.INT},maskCanvas:{type:p.OBJECT,default:null},filterImage:{type:p.NUMBER,default:2,uniformType:O.INT},filterCanvas:{type:p.OBJECT,default:null}};H0=Ip});var hu,K0,yi;var Ko=_(()=>{F();({Vector2:hu}=M);K0=class extends X{constructor(e,t){super(t);this._isDisposed=false;this._operation=e;this._dirtiness={};this.id=R.getUUID();this._renderTextures={};this._identitySprite=new T.Sprite;this._sprite=new T.Sprite;this._hitTestSprite=new T.Sprite;this._renderers=[]}applyScale(e){}applyRotation(e){const t=this._operation.getInputDimensions();let i=this.getRotation()*180/Math.PI;i+=e;this.setRotation(i*Math.PI/180);const r=(e+360)%360;const o=r*Math.PI/180;const n=Math.cos(o);const a=Math.sin(o);const l=this._options.position.clone().subtract(.5).multiply(t);const u=new hu(l.x*n-l.y*a,l.x*a+l.y*n).divide(t.clone().flip());this.setPosition(new hu(.5,.5).add(u))}applyFlip(e){const t=this.getPosition().clone();switch(e){case"horizontal":t.x=1-this._options.position.x;break;case"vertical":t.y=1-this._options.position.y;break}this.setPosition(t)}applyTransform(e){const t={};t.rotation=e.applyToRotation(this.getRotation());t.position=e.applyToRelativePoint(this.getPosition());if(this._options.dimensions){t.dimensions=e.applyToDimensions(this.getDimensions())}this.set(t,false)}getDisplayObject(){return this._sprite}getHitTestDisplayObject(){return this._sprite}_getTexture(){throw new Error("Sprite#_getTexture is abstract and not implemented in child class.")}_prepareRenderTexture(e){if(!this._renderTexture){const t=this._getTexture();this._renderTextureContainer=new T.Container;this._renderTextureSprite=new T.Sprite(t);this._renderTextureContainer.addChild(this._renderTextureSprite);this._renderTexture=this._getRenderTexture(e.getRenderer(),t.getDimensions())}else{this._renderTexture.clear()}}_rendersToRenderTexture(e){return e.getOptions().smoothDownscaling&&e.getRenderer().isOfType(H.WEBGL)}_optionEquals(e,t){if(e==="type"){return true}return super._optionEquals(e,t)}update(e,t){if(this._isDisposed){return}if(this._rendersToRenderTexture(e)){this._prepareRenderTexture(e);this._renderToRenderTexture(e)}this._updateSprite(t)}_updateSprite(e){const t=[this._sprite,this._hitTestSprite];t.forEach(i=>{if(!i.getTexture())return;i.setAnchor(this._options.anchor);i.setPosition(this._options.position.clone().multiply(e));if(typeof this._options.alpha!=="undefined"){i.setAlpha(this._options.alpha)}let{dimensions:r}=this._options;if(r){r=r.clone().multiply(this._operation.getSDK().getTextureScale());i.setWidth(r.x);i.setHeight(r.y)}i.updateTransform();const o=i.getTexture().getFrame();const n=new hu(o.width,o.height);i.setPivot(this._options.pivot.clone().multiply(n));i.setRotation(this._options.rotation);i.updateTransform()})}_renderToRenderTexture(e){const t=this._getTexture().getDimensions();const i=this._getRenderTexture(e.getRenderer(),t);const r=t.clone();if(this._options.smoothDownscaling){r.x=R.nextHighestPOT(r.x);r.y=R.nextHighestPOT(r.y)}this._renderTexture.resizeTo(r);this._renderTexture.render(this._renderTextureContainer);if(this._options.smoothDownscaling){const o=r.clone().subtract(t.x,t.y).divide(r);const n=i.getUVs().getUVs();n[0].x=n[3].x=0;n[1].x=n[2].x=1-o.x;n[0].y=n[1].y=0;n[2].y=n[3].y=1-o.y}this._sprite.setTexture(i)}isDirtyForRenderer(e){if(!(e.id in this._dirtiness)){this._dirtiness[e.id]=true}return this._dirtiness[e.id]}setDirtyForRenderer(e,t){this._renderers[t.id]=t;this._dirtiness[t.id]=e}setDirty(e){for(const t in this._dirtiness){this.setDirtyForRenderer(e,this._renderers[t])}}_getRenderTexture(e,t=new hu(100,100)){if(!this._renderTextures[e.id]){this._renderTextures[e.id]=new T.RenderTexture(e,t.x,t.y,1)}return this._renderTextures[e.id]}dispose(){this._isDisposed=true;for(const e in this._renderTextures){this._renderTextures[e].dispose()}}canBeDuplicated(){return true}canBeDeleted(){return true}canMaskCanvas(){return false}canAdjustPadding(){return false}canBeTakenToFront(){return true}canBeFlippedHorizontally(){return true}};yi=K0});var w1,kr;var Pp=_(()=>{F();({Vector2:w1}=M);kr=class extends X{constructor(...e){super(...e);this._lastOptions={};this._lastInputDimensions=new w1(0,0);this._brush=null}getBrushImage(e){if(this._brush&&this.optionsEqual(this._lastOptions)&&e.equals(this._lastInputDimensions)){return this._brush}const{image:t,size:i}=this._options;t.width=t.height=Math.ceil(i*e.min());const r=R.createCanvas();r.width=t.width;r.height=t.height;const o=r.getContext("2d");o.drawImage(t,0,0,r.width,r.height);const n=this._tintImageData(o.getImageData(0,0,r.width,r.height),r.width,r.height);o.putImageData(n,0,0);this._lastOptions=this.serializeOptions(["size","color"]);this._brush=r;this._lastInputDimensions=e.clone();return r}_tintImageData(e){const{color:t}=this._options;for(let i=0;i<e.data.length;i+=4){e.data[i]+=(t.r*255-e.data[i])*t.a;e.data[i+1]+=(t.g*255-e.data[i+1])*t.a;e.data[i+2]+=(t.b*255-e.data[i+2])*t.a}return e}clone(){const e=this.constructor;return new e(this._options)}};kr.prototype.availableOptions={identifier:{type:p.STRING},image:{type:p.IMAGE},size:{type:p.NUMBER,default:.05},color:{type:p.COLOR,default:E.RED}}});var ds;var X0=_(()=>{F();Pp();ds=class extends kr{getBrushImage(e){if(this._brush&&this.optionsEqual(this._lastOptions)&&e.equals(this._lastInputDimensions)){return this._brush}let{size:t,hardness:i,color:r}=this._options;const o=R.createCanvas();o.width=o.height=Math.ceil(t*e.min());const n=o.getContext("2d");r=r.clone();r.a=1;if(o.width===1){n.fillStyle=r.toRGBA();n.fillRect(0,0,1,1)}else{const a=n.createRadialGradient(o.width/2,o.height/2,Math.min(o.width/2-1,o.width/2*i),o.width/2,o.height/2,o.width/2);a.addColorStop(0,r.toRGBA());const l=r.clone();l.a=0;a.addColorStop(1,l.toRGBA());n.fillStyle=a;n.fillRect(0,0,o.width,o.height)}this._lastOptions=this.serializeOptions(["size","color","hardness"]);this._brush=o;this._lastInputDimensions=e.clone();return o}};ds.identifier="imgly_brush_radial";ds.prototype.availableOptions={...kr.prototype.availableOptions,hardness:{type:p.NUMBER,default:1}}});var C1,D1,Y0,J0;var $0=_(()=>{F();({Vector2:C1,CubicBezierCurve:D1}=M);Y0=class{constructor(e,t,i=3){this._path=e;this._drawnCanvases=[];this._position=t;this._smooth=i}getBezierCurve(e,t,i,r){if(!t){return null}let o;let n;if(!r){o=(i.x-t.x)/this._smooth;n=(i.y-t.y)/this._smooth}else{o=(r.x-t.x)/this._smooth;n=(r.y-t.y)/this._smooth}let a;let l;if(!e){a=(i.x-t.x)/this._smooth;l=(i.y-t.y)/this._smooth}else{a=(i.x-e.x)/this._smooth;l=(i.y-e.y)/this._smooth}const u=t.clone().add(a,l);const c=i.clone().subtract(o,n);return new D1(t,u,c,i)}renderToCanvas(e,t,i,r,o,n=1){if(this._drawnCanvases.indexOf(t)!==-1){return}const a=new C1(t.width,t.height);const l=t.getContext("2d");const u=this._position.clone().multiply(a);const c=r?r.getPosition().clone().multiply(a):null;const h=i?i.getPosition().clone().multiply(a):null;const m=o?o.getPosition().clone().multiply(a):null;const d=u.clone().subtract(c).len();const f=e.width/10;const b=this.getBezierCurve(h,c,u,m);let y;if(!b){y=[u]}else{b.calculateSegments(20);const g=b.getLength();y=b.arcLengthApproxSample(Math.ceil(g/f))}for(let g=0;g<y.length;g++){const C=y[g];let v=e.width*.5/(f*2);v*=1-n;v=1/(1+v);l.globalAlpha=v;l.drawImage(e,C.x-e.width/2,C.y-e.height/2,e.width,e.height)}l.globalAlpha=1;this._drawnCanvases.push(t)}setPosition(e){this._position=e}getPosition(){return this._position.clone()}setDirty(){this._drawnCanvases=[]}};J0=Y0});var Bp,fa;var Z0=_(()=>{F();$0();Bp=class extends X{constructor(e,t,i){super(t);this._operation=e;this._canvas=i||R.createCanvas();this._context=this._canvas.getContext("2d")}serializeOption(e,t=false){if(e==="controlPoints"){return this._options.controlPoints.map(i=>{const r=i.getPosition();return t?r.toObject():r.clone()})}return super.serializeOption(e,t)}_optionEquals(e,t){if(e==="controlPoints"){const{controlPoints:i}=this._options;for(let r=0,o=i.length;r<o;r++){if(!i[r].getPosition().equals(t[r])){return false}}return true}return super._optionEquals(e,t)}render(e){const{controlPoints:t,size:i}=this._options;if(t.length<2){return}const r=this.getBrush();const o=r&&r.getHardness?r.getHardness():1;R.ensureCanvasDimensions(this._canvas,e);if(!this._brush||this._lastBrushSize!==i||!e.equals(this._brushInputDimensions)){this._brushInputDimensions=e.clone();this._lastBrushSize=i}let n;let a;let l;let u;for(let c=0;c<t.length;c++){n=t[c-2];a=t[c-1];l=t[c];u=t[c+1];l.renderToCanvas(this._options.brush.getBrushImage(e),this._canvas,n,a,u,o)}}_createBrush(e){let{size:t,hardness:i,color:r}=this._options;const o=R.createCanvas();o.width=o.height=Math.ceil(t*e.min());const n=o.getContext("2d");r=r.clone();r.a=1;if(o.width===1){n.fillStyle=r.toRGBA();n.fillRect(0,0,1,1)}else{const a=n.createRadialGradient(o.width/2,o.height/2,Math.min(o.width/2-1,o.width/2*i),o.width/2,o.height/2,o.width/2);a.addColorStop(0,r.toRGBA());const l=r.clone();l.a=0;a.addColorStop(1,l.toRGBA());n.fillStyle=a;n.fillRect(0,0,o.width,o.height)}return o}addControlPoint(e){const t=new J0(this,e);this._options.controlPoints.push(t);this.emit("update",this)}getCanvas(){return this._canvas}setCanvas(e){this._canvas=e;this._context=e.getContext("2d")}setDirty(){this._context.clearRect(0,0,this._canvas.width,this._canvas.height);this._options.controlPoints.forEach(e=>{e.setDirty()})}forEachControlPoint(e){this._options.controlPoints.forEach(e)}renderToCanvas(e){const t=e.getContext("2d");t.save();t.globalAlpha=this._options.brush.getColor().a;t.drawImage(this._canvas,0,0);t.restore()}getCanvasDimensions(){return this._canvasDimensions}};Bp.prototype.availableOptions={id:{type:p.STRING,default:()=>R.getUUID()},brush:{type:p.OBJECT,required:true},controlPoints:{type:p.ARRAY,default:[]},closed:{type:p.BOOLEAN,default:false}};fa=Bp});var fu,ps,hs;var Mp=_(()=>{F();Ko();Pp();X0();Z0();({Vector2:fu}=M);ps=class extends yi{constructor(...e){super(...e);this._persistedPaths=[];this._outputCanvasDirty=true;this._outputCanvas=R.createCanvas();this._outputContext=this._outputCanvas.getContext("2d");this._persistCanvas=R.createCanvas();this._persistContext=this._persistCanvas.getContext("2d");this._nextCanvas=R.createCanvas();this._texture=T.Texture.fromCanvas(this._outputCanvas);this._sprite.setTexture(this._texture);this._onPathUpdate=this._onPathUpdate.bind(this)}applyFlip(e){this._options.paths.forEach(t=>{t.forEachControlPoint(i=>{const r=i.getPosition().clone();switch(e){case"horizontal":r.x=1-r.x;break;case"vertical":r.y=1-r.y;break}i.setPosition(r)});t.setDirty(true)});this._reset()}applyRotation(e){this._options.paths.forEach(t=>{t.forEachControlPoint(i=>{const r=i.getPosition().clone();if(e===90){r.flip();r.x=1-r.x}else if(e===-90){r.flip();r.y=1-r.y}i.setPosition(r)});t.setDirty(true)});this._reset()}applyTransform(e){let t=null;this._options.paths.forEach(i=>{i.forEachControlPoint(o=>{o.setPosition(e.applyToRelativePoint(o.getPosition()))});const r=i.getBrush();if(r!==t){r.setSize(e.applyToRelativeSize(r.getSize()));t=r}i.setDirty(true)});this._reset()}clearCanvas(){if(!this._outputCanvas){return}this._outputCanvasDirty=true;const{width:e,height:t}=this._outputCanvas;this._outputContext.clearRect(0,0,e,t)}clearPersistCanvas(){if(!this._persistCanvas){return}const{width:e,height:t}=this._persistCanvas;this._persistContext.clearRect(0,0,e,t)}serializeOptions(e,t=false){const i=super.serializeOptions(e,t);if(!e)i.type="brush";return i}serializeOption(e,t=false){if(e==="paths"){return this._options.paths.map(i=>i.serializeOptions(void 0,t))}return super.serializeOption(e,t)}createPath(e){const t=new fa(this._operation,{brush:e},this._nextCanvas);t.on("update",this._onPathUpdate);this._options.paths.push(t);this.setDirty(true);return t}_onPathUpdate(){this._operation.setDirty(true);this.setDirty(true)}_onPathPersist(e){e.renderToCanvas(this._persistCanvas);this._nextCanvas=e.getCanvas();const t=this._nextCanvas.getContext("2d");t.clearRect(0,0,this._nextCanvas.width,this._nextCanvas.height);this._persistedPaths.push(e)}_getTexture(){return this._texture}setDirtyForRenderer(e,t,i=false){super.setDirtyForRenderer(e,t,i);if(e&&i){this._persistedPaths=[];this.clearPersistCanvas();this._options.paths.forEach(r=>{r.setDirty(true)})}}setDirty(e,t=false){for(const i in this._dirtiness){this.setDirtyForRenderer(e,this._renderers[i],t)}}render(e){const t=this._operation.getSDK().getRenderer();if(!this.isDirtyForRenderer(t)){return}R.ensureCanvasDimensions(this._outputCanvas,e);R.ensureCanvasDimensions(this._persistCanvas,e);this._options.paths.forEach(i=>{i.render(e);if(i.getClosed()&&this._persistedPaths.indexOf(i)===-1){this._onPathPersist(i)}});this.clearCanvas();this._outputContext.drawImage(this._persistCanvas,0,0);this._options.paths.forEach(i=>{if(!i.getClosed()){i.renderToCanvas(this._outputCanvas)}});this.setDirtyForRenderer(false,t)}update(e,t){if(t){R.ensureCanvasDimensions(this._outputCanvas,t);R.ensureCanvasDimensions(this._persistCanvas,t);this._texture.getBaseTexture().update()}this.render(t);const i=e.getRenderer();if(i.isOfType(H.WEBGL)){i.updateTexture(this._texture.getBaseTexture())}super.update(e,t)}_reset(){this._persistedPaths=[];if(this._operation){this._operation.setDirty(true)}this.setDirty(true);this.clearCanvas();this.clearPersistCanvas()}getCanvas(){return this._outputCanvas}_createRadialBrush(){return new ds}_getTempCanvas(){return this._nextCanvas}dispose(){super.dispose();this._texture&&this._texture.getBaseTexture().dispose()}};ps.prototype.availableOptions={id:{type:p.STRING,default:()=>R.getUUID()},position:{type:p.VECTOR2,default:new fu(0,0)},scale:{type:p.VECTOR2,default:new fu(1,1)},anchor:{type:p.VECTOR2,default:new fu(0,0)},pivot:{type:p.VECTOR2,default:new fu(0,0)},rotation:{type:p.NUMBER,default:0},paths:{type:p.ARRAY,default:[],setter(s){s=s.map(e=>{if(e instanceof fa)return e;const{brush:t,closed:i}=e;const r=new fa(this._operation,{brush:t,closed:i},this._nextCanvas);e.controlPoints.forEach(o=>{r.addControlPoint(o)});return r});this._reset();return s}}};ps.type="brush";ps.Brush=kr;ps.Path=fa;ps.Brushes={RadialBrush:ds};hs=ps});var Q0,ga,ev;var tv=_(()=>{F();Uo();q0();Mp();({Vector2:Q0}=M);ga=class extends le{constructor(...e){super(...e);const t=this._sdk.getRenderer();this._lastBlurRadius=null;this._blurredRenderTexture=new T.RenderTexture(t,100,100,1);this._maskRenderTexture=new T.RenderTexture(t,100,100,1);this._brushSprite=new hs(this);this._brushSpriteContainer=new T.Container;const i=this._brushSprite.getDisplayObject();this._brushSpriteContainer.addChild(i);this._outputSprite=new T.Sprite;this._outputContainer=new T.Container;this._outputContainer.addChild(this._outputSprite);this._maskFilter=new H0;if(t.isOfType(H.WEBGL)){this._horizontalFilter=new vt;this._verticalFilter=new vt;this._sprite.setFilters([this._horizontalFilter,this._verticalFilter]);this._horizontalFilter.setDelta(new Q0(1,1));this._verticalFilter.setDelta(new Q0(-1,1));let r=this._maskRenderTexture.getBaseTexture();r.setGLUnit(this._maskFilter.getMaskImage());t.updateTexture(r,false);r=this._blurredRenderTexture.getBaseTexture();r.setGLUnit(this._maskFilter.getFilterImage());t.updateTexture(r,false)}else if(t.isOfType(H.CANVAS)){this._blurFilter=new vt;this._sprite.setFilters([this._blurFilter]);this._maskFilter.setMaskCanvas(this._maskRenderTexture.getRenderTarget().getCanvas());this._maskFilter.setFilterCanvas(this._blurredRenderTexture.getRenderTarget().getCanvas())}this._outputSprite.setFilters([this._maskFilter])}flip(e){this._brushSprite.applyFlip(e);this.setDirty(true,true);this._lastBlurRadius=null}rotate(e){this._brushSprite.applyRotation(e);this.setDirty(true,true);this._lastBlurRadius=null}transform(e,t){this._brushSprite.applyTransform(e,t);this.setDirty(true,true);this._lastBlurRadius=null}_render(e){this._renderBlur(e);this._renderMask(e);this._outputSprite.setTexture(e);this._renderTexture.render(this._outputContainer);return Promise.resolve()}_renderMask(e){const t=e.getDimensions();const i=this._maskRenderTexture.getDimensions();if(!i.equals(t)){this._maskRenderTexture.resizeTo(t)}this._brushSprite.update(this._sdk,t);this._maskRenderTexture.clear(E.BLACK);this._maskRenderTexture.render(this._brushSpriteContainer);const r=this._sdk.getRenderer();if(r.isOfType(H.WEBGL)){r.updateTexture(this._maskRenderTexture.getBaseTexture(),false)}}_renderBlur(e){const t=e.getDimensions();const i=this._blurredRenderTexture.getDimensions();if(!i.equals(t)){this._blurredRenderTexture.resizeTo(t)}const{blurRadius:r}=this._options;if(this._lastBlurRadius!==r||!i.equals(t)){const n=this._sdk.getRenderer();let a;if(n.isOfType(H.WEBGL)){const l=t.min();a={blurRadius:r*l,texSize:t};this._horizontalFilter.set(a);this._verticalFilter.set(a)}else if(n.isOfType(H.CANVAS)){a={blurRadius:r};this._blurFilter.set(a)}this._blurredRenderTexture.render(this._container);this._lastBlurRadius=r}const o=this._sdk.getRenderer();if(o.isOfType(H.WEBGL)){o.updateTexture(this._blurredRenderTexture.getBaseTexture(),false)}}getBrush(){return this._brushSprite}createPath(e,t=1){const i=new hs.Brushes.RadialBrush({size:e,hardness:t,color:E.WHITE});const r=this._brushSprite.createPath(i);this._options.paths.push(r);this.setDirty(true);return r}setDirtyForRenderer(e,t,i){super.setDirtyForRenderer(e,t,i);this._brushSprite.setDirtyForRenderer(e,t,i)}dispose(){super.dispose();const e=this._sdk.getRenderer();if(e.isOfType(H.WEBGL)){this._verticalFilter.dispose();this._horizontalFilter.dispose()}else{this._blurFilter.dispose()}this._brushSprite.dispose();this._maskFilter.dispose();this._blurredRenderTexture.dispose();this._maskRenderTexture.dispose()}hasChanges(){return true}};ga.identifier="selective-blur";ga.prototype.availableOptions={blurRadius:{type:p.NUMBER,default:.05},paths:{type:p.ARRAY,default:[],setter(s){if(this._brushSprite){this._brushSprite.setPaths(s)}return s}}};q.Operations.SelectiveBlurOperation=ga;ev=ga});var fs,gu,_u,yu;var iv=_(()=>{F();Ed();Ko();({Vector2:fs,ColorMatrix:gu}=M);_u=class extends yi{constructor(...e){super(...e);const{image:t}=this._options;const i=t.src||t.filePath||t.toDataUrl&&t.toDataURL();this._isSVG=i&&(!!i.match(/\w+\.svg(?=\?|$)/i)||i.match(/data:image\/svg/i));if(this._isSVG){this._canvas=R.createCanvas();this._context=this._canvas.getContext("2d");this._options.smoothDownscaling=false}if(t){this._onImageUpdate()}this._tintFilter=new T.Filters.TintFilter;this._adjustmentsFilter=new Pl;this._lastRenderedDimensions=fs.NULL;this._lastRenderedInputDimensions=fs.NULL;this._onOptionsChange=this._onOptionsChange.bind(this);this._options.adjustments.on("update",this._onOptionsChange)}applyScale(e){this.setDimensions(this.getDimensions().multiply(e))}serializeOptions(e,t=false){const i=super.serializeOptions(e,t);if(!e)i.type="sticker";return i}_rendersToRenderTexture(e){const t=this._options.smoothDownscaling&&!this._isSVG&&e.getRenderer().isOfType(H.WEBGL);return t||this._hasAdjustments()||this._options.tintMode!=="none"}_getTexture(){return this._inputTexture}update(e,t){const{dimensions:i,image:r}=this._options;if(i.equals(fs.NULL)){i.set(r.width,r.height)}this._sprite.setSmoothDownscaling(this._isSVG?false:this.getSmoothDownscaling());const o=!this._lastRenderedInputDimensions.equals(t)||!this._lastRenderedDimensions.equals(i)||this._lastRenderedImage!==r;if(o&&this._isSVG&&e.getRenderer().isOfType(H.WEBGL)){r.width=Math.round(i.x);r.height=Math.round(i.y);const a=4096;const l=r.width/r.height;if(r.width>a){r.width=a;r.height=Math.round(r.width/l)}if(r.height>a){r.height=a;r.width=Math.round(r.height*l)}this._canvas.width=r.width;this._canvas.height=r.height;this._context.clearRect(0,0,r.width,r.height);this._context.drawImage(r,0,0,r.width,r.height);this._inputTexture.getBaseTexture().update()}if(this._rendersToRenderTexture(e)){this._prepareRenderTexture(e)}const n=[];if(this._rendersToRenderTexture(e)){if(this._hasAdjustments()){n.push(this._adjustmentsFilter);const{adjustments:a}=this._options;const l=new gu;l.multiply(gu.createBrightnessMatrix(a.getBrightness()));l.multiply(gu.createSaturationMatrix(a.getSaturation()));l.multiply(gu.createContrastMatrix(a.getContrast()));this._adjustmentsFilter.set({colorMatrix:l})}if(this._options.tintMode&&this._options.tintMode!=="none"){n.push(this._tintFilter);this._tintFilter.set({mode:T.Filters.TintFilter.MODES[this._options.tintMode.toUpperCase()],color:this._options.tintColor});if(this._sprite.getTexture()&&this._sprite.getTexture()._baseTexture){this._sprite.getTexture()._baseTexture.setDirty(true)}}this._renderTextureSprite.setFilters(n)}if(this._rendersToRenderTexture(e)){this._renderToRenderTexture(e)}else{this._sprite.setTexture(this._inputTexture)}this._updateSprite(t);this._applyFlip();this._lastRenderedDimensions.copy(i);this._lastRenderedInputDimensions.copy(t);this._lastRenderedImage=r}_applyFlip(){const e=this._sprite.getScale();const{flipHorizontally:t,flipVertically:i}=this._options;if(t&&e.x>0||!t&&e.x<0){e.x*=-1}if(i&&e.y>0||!i&&e.y<0){e.y*=-1}this._sprite.setScale(e)}applyFlip(e){super.applyFlip(e);const t={rotation:this._options.rotation};const i=t.rotation/Math.PI*180;const r=i*-1;t.rotation=r*Math.PI/180;switch(e){case"horizontal":t.flipHorizontally=!this._options.flipHorizontally;this.set(t);break;case"vertical":t.flipVertically=!this._options.flipVertically;this.set(t);break}}_hasAdjustments(){const{adjustments:e}=this._options;return e.getBrightness()!==0||e.getSaturation()!==1||e.getContrast()!==1}_onImageUpdate(){let e=this._options.image;const t=this._operation.getSDK().getRenderer();if(this._isSVG&&t.isOfType(H.WEBGL)){e=this._canvas}if(this._inputTexture){this._inputTexture.dispose();this._inputTexture=null}this._inputTexture=T.Texture.fromImage(e);this._identitySprite.setTexture(this._inputTexture);this._sprite.setTexture(this._inputTexture);if(this._renderTexture){this._renderTextureSprite.setTexture(this._inputTexture);this._renderTexture.resizeTo(this._inputTexture.getDimensions())}this.setDirty(true)}scalesUniformly(){return this._options.resizeMode==="keepAspect"}setOption(e,t,i=true){super.setOption(e,t,i);if(e==="image"&&this._identitySprite){this._onImageUpdate()}}_onOptionsChange(){const e=this._dirtiness;for(const t in e){e[t]=true}}dispose(){super.dispose();if(this._inputTexture){this._inputTexture.dispose();this._inputTexture=null}this._tintFilter.dispose();this._adjustmentsFilter.dispose();this._options.adjustments.off("updated",this._onOptionsChange)}};_u.prototype.availableOptions={id:{type:p.STRING,default:()=>R.getUUID()},identifier:{type:p.STRING,default:""},image:{type:p.IMAGE,required:true},position:{type:p.VECTOR2,default:fs.NULL},dimensions:{type:p.VECTOR2,default:fs.NULL},anchor:{type:p.VECTOR2,default:new fs(0,0)},pivot:{type:p.VECTOR2,default:new fs(.5,.5)},rotation:{type:p.NUMBER,default:0},flipHorizontally:{type:p.BOOLEAN,default:false},flipVertically:{type:p.BOOLEAN,default:false},smoothDownscaling:{type:p.BOOLEAN,default:false},tintColor:{type:p.COLOR,default:E.WHITE},tintMode:{type:p.STRING,default:"none",available:["none","solid","colorized"]},resizeMode:{type:p.STRING,default:"keepAspect",available:["keepAspect","unrestricted"]},alpha:{type:p.NUMBER,default:1},adjustments:{type:p.CONFIGURABLE,structure:{brightness:{type:p.NUMBER,default:0},saturation:{type:p.NUMBER,default:1},contrast:{type:p.NUMBER,default:1}}}};_u.type="sticker";yu=_u});var bi,se;var Ot=_(()=>{bi=class{constructor(e){this._seed=e===void 0?bi.TimeSeed():e}seed(e){this._seed=e===void 0?bi.TimeSeed():e}next(){let e=this._seed|0;const t=e/bi.SEED_DIVIDER|0;const i=e%bi.SEED_DIVIDER|0;e=bi.SEED_LOW_MULTIPLY*i-bi.SEED_HIGH_MULTIPLY*t;if(e<=0){e+=bi.MAX}if(e===-1){e=bi.MAX-1}this._seed=e;return e}nextInRange(e,t){if(t===void 0){t=e;e=0}return e+this.next()%(t-e+1)}nextBool(e=1,t=1){return this.nextInRange(e+t-1)>=e}static TimeSeed(){return Date.now()}pickNext(e){if(!Array.isArray(e)){return null}return e[this.next()%e.length]}};se=bi;I(se,"MAX",2147483647);I(se,"SEED_DIVIDER",127773);I(se,"SEED_LOW_MULTIPLY",16807);I(se,"SEED_HIGH_MULTIPLY",2836)});var k1,Se;var xi=_(()=>{F();({Rectangle:k1}=M);Se=class{constructor(e=0,t=0){this.width=e;this.height=t}set(e,t){this.width=e;this.height=t}aspect(){return this.width/this.height}rectangle(e,t){return new k1(e,t,this.width,this.height)}clone(){return new Se(this.width,this.height)}scale(e,t){if(t===void 0){t=e}this.width*=e;this.height*=t;return this}copy(e){this.width=e.width;this.height=e.height;return this}fitInWidthWithOther(e,t=new Se){this.copy(Se.fitTwoInWidth(e,this,t)[0]);return this}static fitTwoInWidth(e,t,i){const r=t.width*i.height+t.height*i.width;const o=i.height*e/r;const n=t.width*o;const a=t.height*o;return[new Se(n,a),new Se(e-n,a)]}}});var rv,Lp,he;var jt=_(()=>{F();rv=Ur(nl());Lp=class extends X{async loadImages(e){return(0,rv.default)(e,async t=>this.addImage(t.path,t.fullPath,t.image))}addImage(e,t,i,r="anonymous"){const o=this.getImages();if(!i){return new Promise((n,a)=>{i=new ft;i.onload=()=>{o[e]={fullPath:t,image:i};n({fullPath:t,image:i})};i.crossOrigin=R.getCrossOriginValue(r);i.onerror=a;i.src=t})}o[e]={fullPath:t,image:i};return Promise.resolve({fullPath:t,image:i})}getImage(e){const t=this.getImages();const i=t[e];return i?i.image:null}getVariation(e){return this.getFonts()[e]}addFont(e,t){const i=this.getFonts();i[e]=t;return t}};Lp.prototype.availableOptions={images:{type:p.OBJECT,default:{}},fonts:{type:p.OBJECT,default:{}}};he=new Lp});var T1,R1,sv,E1,S1,F1,O1,A1,gt;var Xo=_(()=>{F();xi();jt();T1=(s,e,t,i)=>{const r=t*(i*4)+e*4;const o={r:s[r],g:s[r+1],b:s[r+2],a:s[r+3]};return o};R1=s=>s.a<=254;sv=(s,e,t)=>{let i=true;for(let r=0;r<t;r++){const o=T1(s,r,e,t);if(!R1(o)){i=false;break}}return i};E1=(s,e,t,i,r=false)=>{let o=0;for(let n=i+1;n<t;n++){if(!sv(s,n,e)){o=n-i+1}else if(r){break}}return o};S1=(s,e,t,i,r=false)=>{let o=0;for(let n=i-1;n>=0;n--){if(!sv(s,n,e)){o=i-n}else if(r){break}}return o};F1=(s,e,t,i,r)=>{s.beginPath();s.moveTo(e,t);s.lineTo(i,r);s.stroke()};O1=(s,e,t,i,r="red")=>{s.save();s.strokeStyle=r;F1(s,t,e,i,e);s.restore()};A1=(s,e,t,i,r,o="blue")=>{s.save();s.strokeStyle=o;s.strokeRect(e,t,i,r);s.restore()};gt=class extends X{constructor(e){super(e);const t=he.getVariation(this.getFontIdentifier());if(!t){P.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`)}this.set({fontVariation:t});this._metrics=null;this._canvas=R.createCanvas();this._context=this._canvas.getContext("2d");this._isDirty=true}_onOptionsChange(){this._isDirty=true}setOption(e,t,i=true,r=false){super.setOption(e,t,i,r);if(e==="fontIdentifier"&&!r){this.updateFontVariation()}}updateFontVariation(){const e=he.getVariation(this.getFontIdentifier());if(!e){P.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`)}this.setFontVariation(e);return e}setOptions(e={}){this._options={...this._options,...e};this._isDirty=true}_applyTextOptions(e=this._context,t={}){const{fontSize:i,fontVariation:r,lineHeight:o,textColor:n,alignment:a}={...this._options,...t};const{fontStyle:l,fontWeight:u,fontFamily:c}=r.serializeOptions();if(false){e.font=`${l} ${u} ${i}px ${c}`}if(true){e.font=`${l} ${u} ${i}px / ${o} ${c}`}e.fillStyle=n;e.textBaseline="alphabetic";e.textAlign=a||"left"}getTextMetrics(){if(!this._metrics||this._isDirty){this._calculateTextMetrics()}return{...this._metrics}}getSizeValue(){if(!this._metrics||this._isDirty){this._calculateTextMetrics()}return new Se(this._metrics.width,this._metrics.height)}fitWidth(e){const t=this.getFontVariation();if(!t){P.warn("TextDesignFont#fitText: missing font variation");return}this._applyTextOptions(this._context,{fontSize:50});const i=this._context.measureText(this.getText()).width;const r=e/i;const o=Math.floor(r*50);this.setFontSize(o);this._calculateTextMetrics();return this.getTextMetrics()}fitHeight(e){const t=this.getFontVariation();if(!t){P.warn("TextDesignFont#fitText: missing font variation");return}const i=this._calculateTextMetrics({fontSize:50}).height;const r=e/i;const o=Math.floor(r*50);this.setFontSize(o);this._calculateTextMetrics();return this.getTextMetrics()}_calculateTextMetrics(e={}){const t=this._canvas;const i=this._context;const r={...this._options,...e};const o=this.getText();this._applyTextOptions(i,r);const n=Math.ceil(i.measureText(o).width);const a=Math.floor(n+r.fontSize*2);const l=Math.floor(r.fontSize*3);t.width=a;t.height=l;const u=Math.floor(r.fontSize);const c=Math.floor(l*(3/5));this._applyTextOptions(i,r);i.fillText(o,u,c);const h=i.getImageData(0,0,t.width,t.height).data;const m=S1(h,a,l,c,this._options.excludeAccents);const d=E1(h,a,l,c,this._options.excludeAccents);const f=n;const b=m+d;this._metrics={width:f,height:b,ascender:m,descender:d};this._isDirty=false;return{...this._metrics}}draw(e=this._context,t=0,i=0,r,o=false){e.save();if(!this._metrics||this._isDirty){this._calculateTextMetrics()}this._applyTextOptions(e,r);e.fillText(this.getText(),t,i+this._metrics.ascender);if(o){A1(e,t,i,this._metrics.width,this._metrics.height);O1(e,i+this._metrics.ascender,t,t+this._metrics.width)}e.restore()}};gt.prototype.availableOptions={text:{type:p.STRING,default:""},fontIdentifier:{type:p.STRING,default:"imgly_font_open_sans_bold"},fontVariation:{type:p.OBJECT,default:null},lineHeight:{type:p.NUMBER,default:1},fontSize:{type:p.NUMBER,default:22},textColor:{type:p.STRING,default:"black"},strokeStyle:{type:p.STRING,default:"black"},outlineWidth:{type:p.NUMBER,default:0},textBaseline:{type:p.STRING,default:"alphabetic"},excludeAccents:{type:p.BOOLEAN,default:false}}});var _t;var gs=_(()=>{F();_t=class extends X{};_t.prototype.availableOptions={text:{type:p.STRING,default:""},frame:{type:p.OBJECT,default:null},font:{type:p.OBJECT,default:null}}});var Ht;var Yo=_(()=>{F();Ht=class extends X{};Ht.prototype.availableOptions={tintColor:{type:p.COLOR,default:E.BLACK},textColor:{type:p.COLOR,default:E.BLACK},alignment:{type:p.STRING,default:"left",available:["left","center","right"]},lineSpacing:{type:p.NUMBER,default:1},fontIdentifier:{type:p.STRING,default:"imgly_font_open_sans_bold"}}});var I1,Dt;var _a=_(()=>{F();xi();Yo();({Rectangle:I1}=M);Dt=class extends X{constructor(e){super(e);this.setSize(new Se(this.getWidth(),0));this.serverImageSmoothingFix=false}_getFrame(){const e=this.getSize();return new I1(0,0,e.width,e.height)}_getTextFrame(){return this._getFrame()}_getTextFrameForElement(e){return e.getFrame().clone()}_calculateLayoutElements(){P.warn("TextDesignRow is an abstract class.")}_getLayoutElements(){if(this._options.elements.length<=0){this.layout()}return this.getElements()}_fontSize(e){P.warn("TextDesignRow#_fontSize not implemented. @TODO: Is it necessary?");return 0}layout(){this.setElements(this._calculateLayoutElements());return this}textFrame(e,t){return e.getFrame().clone()}willRender(e){}didRender(e){}render(e){e.save();this._getLayoutElements().forEach(t=>{const{text:i,frame:r,font:o}=t.serializeOptions();const n=this.getAttributes();o.draw(e,r.x,r.y,{textColor:n.getTextColor().toRGBA(),alignment:n.getAlignment()})});e.restore()}};Dt.prototype.availableOptions={words:{type:p.OBJECT,default:null},width:{type:p.NUMBER,default:100},attributes:{type:p.CONFIGURABLE,default:new Ht},shearingAngle:{type:p.NUMBER,default:0},elements:{type:p.ARRAY,default:[]},size:{type:p.OBJECT,default:null}}});var P1,ya,ri;var ov=_(()=>{F();Xo();gs();_a();({Rectangle:P1}=M);ya=class extends Dt{_calculateLayoutElements(){if(this.getWords().size()<=0){return[]}const{orientation:e,width:t,size:i,relativeRowOffset:r,attributes:o}=this.serializeOptions();const{fontIdentifier:n}=o;const a=this.getWords().joined(3);const l=e===ya.Orientations.Left?[a[0],a[1],a[2]]:[a[1],a[2],a[0]];const u=R.Array.range(0,2).map(Q=>new gt({text:l[Q],fontIdentifier:n,fontSize:60}));const c=u.map(Q=>Q.getSizeValue());const h=c[0].width>c[1].width?0:1;const m=(h+1)%2;u[m].fitWidth(c[h].width);c[m]=u[m].getSizeValue();const d=(c[m].height+c[h].height)/(1-r);const f=new gt({text:l[2],fontIdentifier:n});f.fitHeight(d);const b=f.getSizeValue().width;const y=c[h].width;const g=t/(b+y);const C=g*b;const v=g*y;const x=g*d;const B=r*x;i.set(t,x);const w=R.Array.range(0,3).map(Q=>new gt({text:l[Q],fontIdentifier:n}));w[0].fitWidth(v);w[1].fitWidth(v);w[2].fitWidth(C);const D=e===ya.Orientations.Left?0:C;const j=e===ya.Orientations.Left?v:0;const W=[D,D,j];const J=[0,w[0].getSizeValue().height+B,0];const te=w.map((Q,K)=>new P1(W[K],J[K],Q.getSizeValue().width,Q.getSizeValue().height));return w.map((Q,K)=>new _t({text:l[K],font:w[K],frame:te[K]}))}};ri=ya;I(ri,"Orientations",{Right:"RIGHT",Left:"LEFT"});ri.prototype.availableOptions={...Dt.prototype.availableOptions,orientation:{type:p.STRING,default:ri.Orientations.Left,available:[ri.Orientations.Right,ri.Orientations.Left]},relativeRowOffset:{type:p.NUMBER,default:.05}}});var B1,$;var At=_(()=>{F();({Rectangle:B1}=M);$=class{constructor(e=0,t=0,i=0,r=0){this.top=e;this.left=t;this.bottom=i;this.right=r}multiply(e){this.top*=e;this.left*=e;this.bottom*=e;this.right*=e}toObject(){return{...this}}equals(e,t=0){return Math.abs(e.top-this.top)<=t&&Math.abs(e.left-this.left)<=t&&Math.abs(e.bottom-this.bottom)<=t&&Math.abs(e.right-this.right)<=t}scale(e=1,t){if(t===void 0){t=e}this.top*=t;this.bottom*=t;this.left*=e;this.right*=e;return this}clone(){return new $(this.top,this.left,this.bottom,this.right)}applyToRectangle(e){return new B1(e.x+this.left,e.y+this.top,e.width-this.left-this.right,e.height-this.top-this.bottom)}static get ZERO(){return new $(0,0,0,0)}}});var Fe;var qt=_(()=>{F();Xo();At();gs();_a();Fe=class extends Dt{_calculateLayoutElements(){const{attributes:e,imageInsets:t,size:i,width:r}=this.serializeOptions();const o=this.getWords().joined(1)[0]||"";const{fontIdentifier:n}=e;const a=new gt({text:o,fontIdentifier:n});a.fitWidth(this._getTextFrame().width);const l=a.getTextMetrics().height+t.top+t.bottom;i.height=l;const u=this._getTextFrame();const c=new _t({text:o,frame:u,font:a});return[c]}};Fe.prototype.availableOptions={...Dt.prototype.availableOptions,imageInsets:{type:p.OBJECT,default:new $}}});var Ki,nt,zp,Kt,bu,Jo,Up,nv,av,Xi;var Tr=_(()=>{F();({Rectangle:Ki,Vector2:nt}=M);zp=(s,e,t,i)=>{s.drawImage(e,t.x,t.y,t.width,t.height,i.x,i.y,i.width,i.height)};Kt=(s,e,t,i="source-over",r=false)=>{s.save();s.fillStyle=t.toRGBA();s.globalCompositeOperation=i;s.fillRect(e.x,e.y,e.width,e.height);if(r){s.strokeStyle=t.toRGBA();s.strokeWith=1;s.strokeRect(e.x,e.y,e.width,e.height)}s.restore()};bu=(s,e,t,i,r="source-over",o=false)=>{s.save();s.fillStyle=i.toRGBA();s.globalCompositeOperation=r;t=Math.min(Math.max(t,0),Math.min(e.height,e.width)*.5);const n=e.x;const a=e.x+e.width;const l=e.y;const u=e.y+e.height;s.beginPath();s.moveTo(n+t,l);s.arcTo(a,l,a,u,t);s.arcTo(a,u,n,u,t);s.arcTo(n,u,n,l,t);s.arcTo(n,l,a,l,t);s.closePath();s.fill();if(o){s.stroke()}s.restore()};Jo=(s,e,t,i=4)=>{s.save();s.strokeStyle=t.toRGBA();s.lineWidth=i;s.strokeRect(e.x,e.y,e.width,e.height);s.restore()};Up=(s,e,t,i="source-over")=>{s.save();const r=e.height/2;const o=e.y+r;let n=e.x+r;const a=e.x+e.width;s.fillStyle=t.toRGBA();s.globalCompositeOperation=i;while(n<a){s.beginPath();s.arc(n,o,r,0,2*Math.PI);s.fill();n+=r*4}s.restore()};nv=(s,e)=>{const t=e.applyToRectangle(s);const{x:i,y:r,width:o,height:n}=s;const a=[Ki.FromDiagonalPoints(new nt(0,0),new nt(t.x,t.y)),Ki.FromDiagonalPoints(new nt(0,t.y+t.height),new nt(t.x,n)),Ki.FromDiagonalPoints(new nt(t.x+t.width,t.y+t.height),new nt(o,n)),Ki.FromDiagonalPoints(new nt(t.x+t.width,0),new nt(o,t.y))].map(u=>u.translate(i,r));const l=[Ki.FromDiagonalPoints(new nt(t.x,0),new nt(t.x+t.width,t.y)),Ki.FromDiagonalPoints(new nt(0,t.y),new nt(t.x,t.y+t.height)),Ki.FromDiagonalPoints(new nt(t.x,t.y+t.height),new nt(t.x+t.width,n)),Ki.FromDiagonalPoints(new nt(t.x+t.width,t.y),new nt(o,t.y+t.height))].map(u=>u.translate(i,r));return{corners:a,bars:l,center:t}};av=(s,e,t,i)=>{const r=e.naturalWidth||e.width;const o=e.naturalHeight||e.height;const n=nv(new Ki(0,0,r,o),i);const a=nv(t,i);zp(s,e,n.center,a.center);R.Array.zip(n.corners,a.corners).forEach(([l,u])=>zp(s,e,l,u));R.Array.zip(n.bars,a.bars).forEach(([l,u])=>zp(s,e,l,u))};Xi=(s,e,t,i,r="source-atop")=>{s.save();if(i){s.globalAlpha=i.a}s.drawImage(e,t.x,t.y,t.width,t.height);if(i){s.globalAlpha=1}if(i){const o=i.clone();o.a=1;Kt(s,t,o,r)}s.restore()}});var Yi;var xu=_(()=>{F();Tr();At();qt();Yi=class extends Fe{_getTextColor(){if(this.getAutoAdjustTextColor()&&!this.getIsMasked()){if(this.getBackgroundColor().equals(E.WHITE)){return E.BLACK}return E.WHITE}return this.getAttributes().getTextColor().clone()}_getTextFrame(){return this.getImageInsets().applyToRectangle(this._getFrame())}_getTextFrameForElement(e){const t=super._getTextFrameForElement(e);const i=this.getImageInsets();if(this.getIsMasked()||this.getIsUsedInInvertedLayout()){t.y-=i.top}return t}willRender(e){if(false){if(this.serverImageSmoothingFix){e.imageSmoothingEnabled=true}}const t=this.getAttributes();t.setTextColor(this._getTextColor());const i=this.getImage();if(i){const r=this.getCapInsets();const o=this._getFrame();if(r&&!r.equals($.ZERO)){av(e,i,o,r)}else{e.drawImage(i,o.x,o.y,o.width,o.height)}Kt(e,o,this.getBackgroundColor(),"source-atop",true)}if((this.getIsMasked()||this.getIsUsedInInvertedLayout())&&i){e.save();e.globalCompositeOperation="destination-out"}}didRender(e){super.didRender(e);if(this.getIsMasked()||this.getIsUsedInInvertedLayout()){e.restore()}}};Yi.prototype.availableOptions={...Fe.prototype.availableOptions,image:{type:p.IMAGE,default:null},capInsets:{type:p.OBJECT,default:new $},backgroundColor:{type:p.COLOR,default:E.WHITE},autoAdjustTextColor:{type:p.BOOLEAN,default:true},isMasked:{type:p.BOOLEAN,default:true},isUsedInInvertedLayout:{type:p.BOOLEAN,default:false}}});var kt;var vu=_(()=>{F();At();kt=class extends X{insetsForWidth(e){return this.getRelativeInsets().clone().scale(e)}static get Small(){return new kt({imagePath:"text-design/images/imgly_text_design_asset_banderole_small.png",fontIdentifier:"imgly_font_campton_bold",relativeInsets:new $(.05,.2,.05,.2)})}static get Rectangle(){return new kt({imagePath:"text-design/images/imgly_text_design_asset_black_background.png",fontIdentifier:"imgly_font_campton_bold",relativeInsets:new $(.05,.05,.05,.05),needsImageSmoothingFix:true})}static get Celebrate1(){return new kt({imagePath:"text-design/images/imgly_text_design_asset_celebrate_01.png",fontIdentifier:"imgly_font_rasa_500",relativeInsets:new $(.05,.2,.05,.2)})}static get Celebrate2(){return new kt({imagePath:"text-design/images/imgly_text_design_asset_celebrate_02.png",fontIdentifier:"imgly_font_rasa_500",relativeInsets:new $(.05,.2,.05,.2)})}};kt.prototype.availableOptions={image:{type:p.IMAGE,default:null},imagePath:{type:p.STRING,default:null},relativeInsets:{type:p.OBJECT,default:new $},fontIdentifier:{type:p.STRING,default:"imgly_font_open_sans_bold"},needsImageSmoothingFix:{type:p.BOOLEAN,default:false}}});var wu;var lv=_(()=>{F();At();xi();wu=class extends X{getSize(){const e=this.getRows();const t=this.getWidth();const i=e.length-1;let r=e.reduce((n,a)=>n+a.getSize().height,0);r+=(i+1)*this.getRelativeLineSpacing()*t;const o=this.getRelativeInsets().clone().scale(t);r+=o.top+o.bottom;return new Se(t,r)}};wu.prototype.availableOptions={text:{type:p.STRING,default:""},lines:{type:p.ARRAY,default:[]},relativeInsets:{type:p.OBJECT,default:new $},relativeLineSpacing:{type:p.NUMBER,default:0},rows:{type:p.OBJECT,default:[]},background:{type:p.OBJECT,default:null},width:{type:p.NUMBER,default:0}}});var $e;var Rr=_(()=>{F();$e=class{constructor(e){this.words=[];if(e){this.splitIntoWords(e)}}splitIntoWords(e){this.words=e.match(/\S+/g)||[];return[...this.words]}get(){return[...this.words]}getWord(e){return this.words[e]}set(e){this.words=[...e];return this}slice(e,t){return $e.fromWords(this.words.slice(e,t))}getLowerCase(){return this.words.map(e=>e.toLowerCase())}getUpperCase(){return this.words.map(e=>e.toUpperCase())}size(){return this.words.length}countNumberOfCharacters(){return this.words.reduce((e,t)=>e+t.length,0)}joined(e){const t=this.size();const i=Math.floor(t/e);const r=t%e;let o=0;let n=0;return R.Array.range(0,e).map(a=>{o=n;const l=i+(a<r?1:0);n=Math.min(o+l,t);return R.Array.range(o,n).reduce((u,c)=>u+(c===o?"":" ")+this.words[c],"")})}static fromWords(e){const t=new $e;t.words=[...e];return t}}});var M1,L1,z1,je;var $o=_(()=>{F();Ot();At();qt();Yo();lv();Rr();M1=10;L1=4;z1=.4;je=class extends X{constructor(e){super(e);this._relativeInsets=new $;this._background=null;this._fontRandomizer=new se(0);this._lineNumberRandomizer=new se(0);this._wordsPerLineRandomizer=new se(0);this._seedPool=[this._fontRandomizer,this._lineNumberRandomizer,this._wordsPerLineRandomizer]}seed(e){this._seedPool.forEach(t=>t.seed(e))}getImagePaths(){return[]}onImagesLoaded(){}getMaximumNumberOfTries(){return M1}getMinLineCountOfRandom(){return L1}getRandomAdditionalLinePercentage(){return z1}_fontForRow(e,t){return this._fontRandomizer.pickNext(this.getFontIdentifiers())}_modifiedText(e){return e.replace("\n"," ").replace("	"," ")}_minimumNumberOfLines(e){return Math.ceil(Math.sqrt(e.size()))}_maximumNumberOfLines(e){return e.size()}_calculatedNumberOfLines(e){let t=this._minimumNumberOfLines(e);if(e.size()>=this.getMinLineCountOfRandom()){const i=Math.floor(Math.max(1,t*this.getRandomAdditionalLinePercentage()));t+=this._lineNumberRandomizer.nextInRange(0,i)}return Math.min(t,this._maximumNumberOfLines(e))}_randomizedNumberOfWordsPerLine(e,t){if(e>t){P.warn("TextDesign#_randomizedNumberOfWordsPerLine: Invalid number of lines");return t}const i=R.Array.repeat(1,e);R.Array.range(e,t).forEach(r=>{const o=this._wordsPerLineRandomizer.nextInRange(0,e-1);i[o]+=1});return i}_textLines(e){const t=new $e(e);const i=this._calculatedNumberOfLines(t);const r=this._randomizedNumberOfWordsPerLine(i,t.size());return r.reduce((o,n)=>({index:o.index+n,lines:[...o.lines,t.slice(o.index,Math.min(o.index+n,t.size()))]}),{index:0,lines:[]}).lines}_validTextLines(e){let t=this._textLines(e);let i=0;do{i=R.Array.findIndex(t,r=>r.countNumberOfCharacters()<3);if(i>=0){const r=t[i-1];const o=t[i+1];const n=r?r.countNumberOfCharacters():Number.MAX_SAFE_INTEGER;const a=o?o.countNumberOfCharacters():Number.MAX_SAFE_INTEGER;if(n<a&&r){r.words=[...r.words,...t[i].words];t=[...t.slice(0,i),...t.slice(i+1)]}else if(o){o.words=[...t[i].words,...o.words];t=[...t.slice(0,i),...t.slice(i+1)]}}}while(i>-1&&t.length>1);return t}_modifiedLines(e){return e}_getBackground(){return this._background}generateLayoutData(e,t){const i=this._modifiedText(e);const r=this._modifiedLines(this._validTextLines(i));const o=t*(1-this._relativeInsets.left-this._relativeInsets.right);const n=this._layoutRows(r,o);return new wu({text:i,relativeInsets:this._relativeInsets.clone(),relativeLineSpacing:this.getRelativeLineSpacing(),background:this._background||this._getBackground(),lines:r,rows:n,width:t})}_layoutRows(e,t){return e.map((i,r)=>this._randomLayoutRow(i,r,t,new Ht({fontIdentifier:this._fontForRow(r,i)})).layout())}_randomLayoutRow(e,t,i,r){return new Fe({words:e,width:i,attributes:r})}};I(je,"defaultFontIdentifiers",[]);I(je,"identifier","textdesign");je.prototype.availableOptions={fontIdentifiers:{type:p.ARRAY,default:[]},relativeLineSpacing:{type:p.NUMBER,default:0}}});var He;var Zo=_(()=>{F();Ot();ov();qt();xu();Yo();vu();jt();$o();He=class extends je{constructor(...e){super(...e);I(this,"getImagePaths",()=>{const e=this.getBanderoles();return e&&e.map(t=>t.getImagePath())||[]});I(this,"onImagesLoaded",()=>{const e=this.getBanderoles();if(e){e.forEach(t=>{const i=he.getImage(t.getImagePath());if(!i){P.warn(`TextDesignBlocks#onImagesLoaded: Image not found '${t.getImagePath()}'`);return}t.setImage(i)})}});this._rowTypeLessThan3WordsRandomizer=new se(0);this._rowTypeMoreThan3WordsRandomizer=new se(0);this._banderolesRandomizer=new se(0);this._seedPool=[...this._seedPool,this._rowTypeLessThan3WordsRandomizer,this._rowTypeMoreThan3WordsRandomizer,this._banderolesRandomizer]}_modifiedText(e){return super._modifiedText(e).toUpperCase()}generateLayoutData(e,t){this._options.hasMaskedText=false;return super.generateLayoutData(e,t)}_randomLayoutRow(e,t,i,r){if(e.size()<3){const n=this._rowTypeLessThan3WordsRandomizer.nextInRange(0,2)===0;return this._layoutRow(e,i,r,n)}const o=this._rowTypeMoreThan3WordsRandomizer.nextInRange(0,3);switch(o){case 0:return new ri({words:e,width:i,attributes:r,orientation:ri.Orientations.Left});case 1:return new ri({words:e,width:i,attributes:r,orientation:ri.Orientations.Right});case 2:return this._layoutRow(e,i,r,true);case 3:return new Fe({words:e,width:i,attributes:r});default:throw new Error(`TextDesignBlocks#_randomLayoutRow: Invalid randomValue generated: ${o}.`)}}_layoutRow(e,t,i,r){if(this.getHasMaskedText()){r=false}if(r){this.setHasMaskedText(true);const o=this._banderolesRandomizer.pickNext(this.getBanderoles());const n=new Yi({words:e,width:t,attributes:new Ht({alignment:"left",fontIdentifier:o.getFontIdentifier()}),image:o.getImage(),imageInsets:o.insetsForWidth(t),capInsets:null,backgroundColor:E.WHITE});if(o.getNeedsImageSmoothingFix()){n.serverImageSmoothingFix=true}return n}return new Fe({words:e,width:t,attributes:i})}};I(He,"defaultFontIdentifiers",["imgly_font_campton_bold"]);I(He,"identifier","imgly_text_design_blocks");I(He,"defaultBanderoles",[kt.Rectangle,kt.Small]);He.prototype.availableOptions={...je.prototype.availableOptions,fontIdentifiers:{type:p.ARRAY,default:He.defaultFontIdentifiers},relativeLineSpacing:{type:p.NUMBER,default:.025/3},hasMaskedText:{type:p.BOOLEAN,default:false},banderoles:{type:p.ARRAY,default:He.defaultBanderoles}}});var _s;var uv=_(()=>{F();qt();Zo();_s=class extends He{constructor(...e){super(...e);this._exclusiveFont=null}generateLayoutData(e,t){this._exclusiveFont=this._fontRandomizer.pickNext(this.getFontIdentifiers());return super.generateLayoutData(e,t)}_fontForRow(e,t){return this._exclusiveFont||super._fontForRow(e,t)}_layoutRow(e,t,i,r){return new Fe({words:e,width:t,attributes:i})}};I(_s,"defaultFontIdentifiers",["imgly_font_ostrich_sans_heavy","imgly_font_ostrich_sans_bold","imgly_font_ostrich_sans_black"]);I(_s,"identifier","imgly_text_design_blocks_condensed");_s.prototype.availableOptions={...He.prototype.availableOptions,fontIdentifiers:{type:p.ARRAY,default:_s.defaultFontIdentifiers}}});var ba,Er,Tt;var Np=_(()=>{F();Tr();xi();gs();_a();({Rectangle:ba}=M);Er=class extends Dt{constructor(...e){super(...e);this.setSize(new Se(this.getWidth(),this.getHeight()))}_calculateLayoutElements(){return[new _t({frame:this._getTextFrame()})]}render(e){const t=this._getFrame();const i=this.getType();const r=this.getAttributes();const o=r.getTextColor();const n=t.height/3;let a=new ba(t.x,t.y,t.width,n);let l=new ba(t.x,t.y+n*2,t.width,n);switch(i){case Er.FormType.Rect:Kt(e,t,o);break;case Er.FormType.DoubleRect:Kt(e,a,o);Kt(e,l,o);break;case Er.FormType.DoubleRectFirstPunctuated:Up(e,a,o);Kt(e,l,o);break;case Er.FormType.DoubleRectSecondPunctuated:Kt(e,a,o);Up(e,l,o);break;case Er.FormType.LongLine:{const u=t.height/2;const c=new ba(t.x,t.y,t.width,u);bu(e,c,c.height*.5,o);break}case Er.FormType.LongAndShortLine:{const u=t.height*.2;const c=u*.75;a=new ba(t.x,t.y+u,t.width,u);const h=t.x+t.width*.25;const m=t.y+t.height-c;l=new ba(h,m,t.width*.5,c);bu(e,a,a.height*.5,o);bu(e,l,l.height*.5,o);break}default:break}}};Tt=Er;I(Tt,"FormType",{Rect:"RECT",DoubleRect:"DOUBLE_RECT",DoubleRectFirstPunctuated:"DOUBLE_RECT_FIRST_PUNCTUATED",DoubleRectSecondPunctuated:"DOUBLE_RECT_SECOND_PUNCTUATED",LongLine:"LONG_LINE",LongAndShortLine:"LONG_AND_SHORT_LINE"});Tt.prototype.availableOptions={...Dt.prototype.availableOptions,height:{type:p.NUMBER,default:100},type:{type:p.STRING,default:Tt.FormType.Rect,available:R.values(Tt.FormType)}}});var vi;var Gp=_(()=>{F();qt();Np();Zo();vi=class extends He{_layoutRow(e,t,i,r){return new Fe({words:e,width:t,attributes:i})}_layoutRows(e,t){const i=super._layoutRows(e,t);const r=.032*t;const o=.08*t;const n=new Tt({width:t,height:r,type:Tt.FormType.LongLine,shearingAngle:0}).layout();const a=new Tt({width:t,height:o,type:Tt.FormType.LongAndShortLine,shearingAngle:0}).layout();return[n,...i,a]}};I(vi,"defaultFontIdentifiers",["imgly_font_sue_ellen_francisco"]);I(vi,"identifier","imgly_text_design_blocks_light");vi.prototype.availableOptions={...He.prototype.availableOptions,fontIdentifiers:{type:p.ARRAY,default:vi.defaultFontIdentifiers}}});var ys;var cv=_(()=>{F();qt();Yo();Gp();ys=class extends vi{_layoutRows(e,t){return e.map((i,r)=>this._randomLayoutRow(i,r,t,new Ht({fontIdentifier:this._fontForRow(r,i)})).layout())}_layoutRow(e,t,i,r){return new Fe({words:e,width:t,attributes:i})}};I(ys,"defaultFontIdentifiers",["imgly_font_sue_ellen_francisco"]);I(ys,"identifier","imgly_text_design_blocks_light-v3_1_0");ys.prototype.availableOptions={...vi.prototype.availableOptions,fontIdentifiers:{type:p.ARRAY,default:ys.defaultFontIdentifiers}}});var U1,Cu,si;var Du=_(()=>{F();Xo();Tr();xi();gs();qt();({Rectangle:U1}=M);Cu=class extends Fe{getImageSize(){const e=this.getLeftImage();const t=this.getRightImage();const i=this.getWords();const r=this.getAttributes();const o=r.getFontIdentifier();const n=e?new Se(e.width,e.height):new Se;const a=i.joined(1)[0];if(!a){return n}const l=new gt({text:a,fontIdentifier:o,fontSize:50});const u=l.getSizeValue();const c=t?2:1;n.scale(c,1);const h=n.clone().fitInWidthWithOther(this._getFrame().width,u);h.scale(1/c,1);return h}_getTextFrame(){const e=super._getTextFrame().clone();const t=this.getImageSize();const i=this.getRightImage();const r=this.getImagePosition();if(!i){if(r===Cu.ImagePosition.Left){e.x+=t.width}}else{e.x+=t.width;e.width-=2*t.width}return e}_calculateLayoutElements(){const e=super._calculateLayoutElements();const t=this._getFrame();const i=this.getRightImage();const r=this.getImageSize();const o=this.getImagePosition();const n=this._getTextFrame();const a=this.getAttributes();const l=a.getFontIdentifier();const u=new gt({text:"stickerClock",fontIdentifier:l});u.fitWidth(this._getTextFrame().width);const c=new U1().set(t.x,t.y,r.width,r.height);if(!i&&o===Cu.ImagePosition.Right){c.x+=n.width}e.push(new _t({text:"stickerClock",frame:c,font:u}));if(i){const h=e[0];if(h){const m=c.clone();m.translate(h.getFrame().width+m.width,0);e.push(new _t({text:"stickerClock",frame:m,font:u}))}}return e}render(e){const t=this._getLayoutElements();const i=this.getAttributes();const r=i.getTextColor();const o=this.getLeftImage();const n=this.getRightImage();const a=t[0];const l=t[1];const{font:u}=a.serializeOptions();const c=this._getTextFrameForElement(a);u.draw(e,c.x,c.y,{textColor:i.getTextColor().toRGBA(),alignment:i.getAlignment()});if(o){const h=l.getFrame();e.drawImage(o,h.x,h.y,h.width,h.height);Kt(e,h,r,"source-atop")}if(t.length>2){const h=t[2];const m=h.getFrame().clone();e.drawImage(n,m.x,m.y,m.width,m.height);Kt(e,m,r,"source-atop")}}};si=Cu;I(si,"ImagePosition",{Left:"LEFT",right:"RIGHT"});si.prototype.availableOptions={...Fe.prototype.availableOptions,leftImage:{type:p.IMAGE,default:null},rightImage:{type:p.IMAGE,default:null},imagePosition:{type:p.STRING,default:si.ImagePosition.Left,available:[si.ImagePosition.Left,si.ImagePosition.Right]}}});var xa,It;var Wp=_(()=>{F();qt();Du();vu();Rr();Zo();xa=class extends He{_fontForRow(e,t){const i=this.getFontIdentifiers();return i[e%i.length]}_minimumNumberOfLines(e){return Math.max(Math.floor(super._minimumNumberOfLines(e)*.7),1)}_maximumNumberOfLines(e){return Math.max(Math.floor(e.countNumberOfCharacters()/5),1)}_randomLayoutRow(e,t,i,r){return this._createSingleRow(xa.RowType.Single,e,i,r)}_createSingleRow(e,t,i,r){const o=r.getFontIdentifier();const n=o==="imgly_font_amberlight"||o==="imgly_font_handycheera_regular"?new $e().set(t.getLowerCase()):t;switch(e){case xa.RowType.Single:return new Fe({words:n,width:i,attributes:r});case xa.RowType.SingleImage:return new si({words:n,width:i,attributes:r});default:P.warn(`TextDesignCelebrate#_createSingleRow: Invalid row type '${e}'`);return null}}};It=xa;I(It,"defaultFontIdentifiers",["imgly_font_handycheera_regular","imgly_font_rasa_regular"]);I(It,"defaultBanderoles",[kt.Celebrate1,kt.Celebrate2]);I(It,"identifier","imgly_text_design_celebrate");I(It,"RowType",{Single:"SINGLE",SingleImage:"SINGLE_IMAGE"});It.prototype.availableOptions={...He.prototype.availableOptions,relativeLineSpacing:{type:p.NUMBER,default:.01875},fontIdentifiers:{type:p.ARRAY,default:It.defaultFontIdentifiers},banderoles:{type:p.ARRAY,default:It.defaultBanderoles}}});var qe;var ku=_(()=>{F();Xo();Rr();Tr();xi();Yo();gs();_a();qe=class extends Dt{constructor(...e){super(...e);this.setSize(new Se(this.getWidth(),this.getHeight()))}_getImageFrame(){const e=this._getTextFrame().clone();const t=this.getImage();if(this.getDrawingModeAspectFit()&&t){const i=Math.min(e.width/t.width,e.height/t.height);const r=t.width*i;const o=t.height*i;e.x+=(e.width-r)/2;e.y+=(e.height-o)/2;e.width=r;e.height=o}return e}_calculateLayoutElements(){return[new _t({text:"",frame:this._getImageFrame(),font:new gt})]}render(e){const t=this.getImage();const i=this._getImageFrame();const r=this.getAttributes();const o=r.getTextColor();Xi(e,t,i,o)}};I(qe,"RowImages",{decorative1:"text-design/images/imgly_text_design_asset_decorative_01.png",decorative2:"text-design/images/imgly_text_design_asset_decorative_02.png",decorative3:"text-design/images/imgly_text_design_asset_decorative_05.png",decorative4:"text-design/images/imgly_text_design_asset_decorative_06.png",celebrate1:"text-design/images/imgly_text_design_asset_celebrate_03.png",celebrate2:"text-design/images/imgly_text_design_asset_celebrate_04.png",celebrate3:"text-design/images/imgly_text_design_asset_celebrate_05.png"});qe.prototype.availableOptions={...Dt.prototype.availableOptions,words:{type:p.OBJECT,default:new $e},height:{type:p.NUMBER,default:0},image:{type:p.IMAGE,default:null},imagePath:{type:p.STRING,default:qe.RowImages.decorative1},drawingModeAspectFit:{type:p.BOOLEAN,default:false},attributes:{type:p.CONFIGURABLE,default:new Ht}}});var bs;var mv=_(()=>{F();Ot();qt();Du();ku();vu();jt();Rr();Zo();Wp();bs=class extends It{constructor(...e){super(...e);I(this,"getImagePaths",()=>{const e=this.getBanderoles();return[...e&&e.map(t=>t.getImagePath())||[],...this._celebrateTypes]});I(this,"onImagesLoaded",()=>{const e=this.getBanderoles();if(e){e.forEach(t=>{const i=he.getImage(t.getImagePath());if(!i){P.warn(`TextDesignBlocks#onImagesLoaded: Image not found '${t.getImagePath()}'`);return}t.setImage(i)})}});this._celebrateTypes=[qe.RowImages.celebrate1,qe.RowImages.celebrate2,qe.RowImages.celebrate3];this._exclusiveFont=null;this._typeRandomizer=new se(0);this._useMaskedRandomizer=new se(0);this._seedPool.push(this._typeRandomizer);this._seedPool.push(this._useMaskedRandomizer)}_fontForRow(e,t){const i=this.getFontIdentifiers();return i[e%(i.length-1)]}_layoutRows(e,t){const i=this._typeRandomizer.pickNext(this._celebrateTypes);const r=he.getImage(i);if(!r){P.warn(`TextDesignCelebrateSimple#_layoutRows: Image not fount '${i}'`)}const o=new qe({width:t,height:t*.5,drawingModeAspectFit:true,image:r}).layout();const n=super._layoutRows(e,t);return[o,...n]}_randomLayoutRow(e,t,i,r){const o=e.countNumberOfCharacters();const n=13;const a=4;if(o<a){r.setFontIdentifier("imgly_font_rasa_regular")}const l=this._useMaskedRandomizer.nextBool(2,1);if(o<n&&l&&!this.getHasMaskedText()){return this._layoutRow(e,i,r,true)}return super._randomLayoutRow(e,t,i,r)}};I(bs,"identifier","imgly_text_design_celebrate_simple");I(bs,"defaultFontIdentifiers",["imgly_font_amberlight","imgly_font_rasa_regular","imgly_font_rasa_500"]);bs.prototype.availableOptions={...It.prototype.availableOptions,fontIdentifiers:{type:p.ARRAY,default:bs.defaultFontIdentifiers}}});var xs;var Vp=_(()=>{F();xs=class extends X{render(e,t,i,r,o){P.warn("TextDesignBackground#render: Abstract class")}};xs.prototype.availableOptions={}});var Tu,wi;var dv=_(()=>{F();jt();Tr();Vp();({Rectangle:Tu}=M);wi=class extends xs{getImagePaths(){const{topImagePath:e,bottomImagePath:t,leftImagePath:i,rightImagePath:r}=this._options;return[e,t,i,r].filter(o=>o!=="")}render(e,t,i,r,o){const n=i.clone().scale(t.width);const a=t.rectangle(0,0);const l=he.getImage(this.getTopImagePath());const u=he.getImage(this.getLeftImagePath());const c=he.getImage(this.getRightImagePath());const h=he.getImage(this.getBottomImagePath());if(l){const m=l.width/l.height;const d=n.top*this.getTopImageFillRate();const f=d*m;const b=a.width/2;const y=b-f/2;const g=new Tu(y,0,f,d);Xi(e,l,g,r)}if(h){const m=h.width/h.height;const d=n.bottom*this.getBottomImageFillRate();const f=d*m;const b=a.width/2;const y=b-f/2;const g=new Tu(y,a.height-d,f,d);Xi(e,h,g,r)}if(u){const m=u.width/u.height;const d=n.left*this.getLeftImageFillRate();const f=d/m;const b=a.height/2;const y=b-f/2;const g=new Tu(0,y,d,f);Xi(e,u,g,r)}if(c){const m=c.width/c.height;const d=n.right*this.getRightImageFillRate();const f=d/m;const b=a.height/2;const y=b-f/2;const g=new Tu(a.width-d,y,d,f);Xi(e,c,g,r)}}};wi.prototype.availableOptions={topImagePath:{type:p.STRING,default:""},leftImagePath:{type:p.STRING,default:""},bottomImagePath:{type:p.STRING,default:""},rightImagePath:{type:p.STRING,default:""},topImageFillRate:{type:p.NUMBER,default:1},leftImageFillRate:{type:p.NUMBER,default:1},bottomImageFillRate:{type:p.NUMBER,default:1},rightImageFillRate:{type:p.NUMBER,default:1}};wi.Backgrounds=[new wi({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_1.png",leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_2.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_2.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background1_3.png",topImageFillRate:.8,leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.8}),new wi({leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_1.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_1.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background2_2.png",leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.6}),new wi({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background3_1.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background3_2.png",topImageFillRate:.6,bottomImageFillRate:.6}),new wi({topImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_1.png",leftImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_3.png",rightImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_3.png",bottomImagePath:"text-design/images/imgly_xib_image_text_design_equal_width_background4_2.png",topImageFillRate:.1,leftImageFillRate:.6,rightImageFillRate:.6,bottomImageFillRate:.6})]});var Ci;var jp=_(()=>{F();dv();Ot();At();qt();Rr();$o();Ci=class extends je{constructor(...e){super(...e);this._relativeInsets=new $(.1,.1,.1,.1);this._alreadyContainsARowWithScriptFont=false;this._backgroundsRandomizer=new se(0);this._seedPool.push(this._backgroundsRandomizer)}getImagePaths(){return R.Array.flatten(wi.Backgrounds.map(e=>e.getImagePaths()))}_getBackground(){return this._backgroundsRandomizer.pickNext(wi.Backgrounds)}generateLayoutData(e,t){this._alreadyContainsARowWithScriptFont=false;this._background=this._getBackground();return super.generateLayoutData(e,t)}_modifiedText(e){return super._modifiedText(e).toUpperCase()}_fontForRow(e,t){let i=super._fontForRow(e,t);if(i==="imgly_font_petit_formal_script"){if(this._alreadyContainsARowWithScriptFont){i="imgly_font_bungee_inline"}this._alreadyContainsARowWithScriptFont=true}return i}_randomLayoutRow(e,t,i,r){const o=r.getFontIdentifier()==="imgly_font_petit_formal_script";return new Fe({words:o?new $e().set(e.getLowerCase()):e,width:i,attributes:r})}};I(Ci,"identifier","imgly_text_design_equal_width");I(Ci,"defaultFontIdentifiers",["imgly_font_ultra","imgly_font_bungee_inline","imgly_font_petit_formal_script"]);Ci.prototype.availableOptions={...je.prototype.availableOptions,fontIdentifiers:{type:p.ARRAY,default:Ci.defaultFontIdentifiers},relativeLineSpacing:{type:p.NUMBER,default:.025}}});var vs;var pv=_(()=>{F();At();jp();vs=class extends Ci{constructor(...e){super(...e);this._relativeInsets=new $}_getBackground(){return null}};I(vs,"defaultFontIdentifiers",["imgly_font_ultra"]);I(vs,"identifier","imgly_text_design_equal_width_fat");vs.prototype.availableOptions={...Ci.prototype.availableOptions,fontIdentifiers:{type:p.ARRAY,default:vs.defaultFontIdentifiers}}});var Y;var Qo=_(()=>{F();At();Y=class extends X{insetsForWidth(e){const t=this.getRelativeInsets().clone();return t.scale(e)}};Y.prototype.availableOptions={imagePath:{type:p.STRING,default:""},minimumHeightRatio:{type:p.NUMBER,default:0},sizeToFitContent:{type:p.BOOLEAN,default:true},capInsets:{type:p.OBJECT,default:new $},relativeInsets:{type:p.OBJECT,default:new $}};Y.Box=new Y({imagePath:"text-design/images/imgly_text_design_asset_black_background.png",relativeInsets:new $(.1,.1,.1,.1)});Y.Badge1=new Y({imagePath:"text-design/images/imgly_text_design_asset_badge1.png",relativeInsets:new $(.3,.18,.2,.18)});Y.Badge2=new Y({imagePath:"text-design/images/imgly_text_design_asset_badge2.png",relativeInsets:new $(.3,.18,.2,.18)});Y.Badge3=new Y({imagePath:"text-design/images/imgly_text_design_asset_badge3.png",relativeInsets:new $(.3,.18,.2,.18)});Y.Badge4=new Y({imagePath:"text-design/images/imgly_text_design_asset_badge4.png",relativeInsets:new $(.3,.18,.2,.18)});Y.SpeechBubble1=new Y({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble_small2.png",relativeInsets:new $(.04,.07,.12,.07),capInsets:new $(19*3,57*3,41*3,17*3)});Y.SpeechBubble2=new Y({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble3.png",relativeInsets:new $(.04,.07,.12,.07),capInsets:new $(2*3,35*3,29*3,5*3)});Y.SpeechBubble3=new Y({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble_small.png",relativeInsets:new $(.165664675,.2,.165664675,.2),minimumHeightRatio:.7});Y.SpeechBubble4=new Y({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble4.png",relativeInsets:new $(.124800224,.2,.291200523,.2),minimumHeightRatio:.7});Y.SpeechBubble5=new Y({imagePath:"text-design/images/imgly_text_design_asset_speech_bubble5.png",relativeInsets:new $(.114892823,.27,.15984926,.27)});Y.Watercolor1=new Y({imagePath:"text-design/images/imgly_text_design_asset_watercolor_01.png",minimumHeightRatio:.7,relativeInsets:new $(.2,.25,.2,.25)});Y.Watercolor2=new Y({imagePath:"text-design/images/imgly_text_design_asset_watercolor_02.png",minimumHeightRatio:.7,relativeInsets:new $(.08,.25,.3,.25)});Y.Watercolor3=new Y({imagePath:"text-design/images/imgly_text_design_asset_watercolor_03.png",minimumHeightRatio:.7,relativeInsets:new $(.1,.2,.15,.2)})});var hv=we(Ru=>{"use strict";Object.defineProperty(Ru,"__esModule",{value:true});Ru.arabic=void 0;var N1="\u0620-\u064A\u066E-\u066F\u0671-\u06D5\u06EE-\u06EF\u06FA-\u06FF";var G1="\u0750-\u077F";var W1="[".concat(N1).concat(G1,"]");var V1="[\u064B-\u065F\u0670]";var j1="".concat(W1).concat(V1,"*");Ru.arabic=j1});var gv=we(Eu=>{"use strict";Object.defineProperty(Eu,"__esModule",{value:true});Eu.bengali=void 0;var fv="[\\u{0980}-\\u{09FF}]";var H1="[\\u{0980}-\\u{0983}\\u{09BC}-\\u{09D7}\\u{09E2}\\u{09E3}\\u{09FE}]";var q1="\\u{09CD}";var K1="".concat(fv,"(").concat(q1).concat(fv,"|").concat(H1,")*");Eu.bengali=K1});var yv=we(Su=>{"use strict";Object.defineProperty(Su,"__esModule",{value:true});Su.devanagari=void 0;var _v="[\\u{0900}-\\u{097F}]";var X1="[\\u{0900}-\\u{0903}\\u{093A}-\\u{0957}\\u{0962}\\u{0963}]";var Y1="\\u{094D}";var J1="".concat(_v,"(").concat(Y1).concat(_v,"|").concat(X1,")*");Su.devanagari=J1});var xv=we(Fu=>{"use strict";Object.defineProperty(Fu,"__esModule",{value:true});Fu.gujarati=void 0;var bv="[\\u{0A80}-\\u{0AFF}]";var $1="[\\u{0A81}-\\u{0A83}\\u{0ABC}\\u{0ABE}-\\u{0ACD}\\u{0AE2}\\u{0AE3}\\u{0AFA}-\\u{0AFF}]";var Z1="\\u{0ACD}";var Q1="".concat(bv,"(").concat(Z1).concat(bv,"|").concat($1,")*");Fu.gujarati=Q1});var vv=we(Ou=>{"use strict";Object.defineProperty(Ou,"__esModule",{value:true});Ou.hebrew=void 0;var e2="[\u05D0-\u05EA]";var t2="[\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7]";var i2="".concat(e2).concat(t2,"*");Ou.hebrew=i2});var wv=we(Au=>{"use strict";Object.defineProperty(Au,"__esModule",{value:true});Au.japaneseKana=void 0;var r2="[\\u{3041}-\\u{3096}\\u{309D}-\\u{309F}]";var s2="[\\u{30A0}-\\u{30FF}]";var o2="[\\u{3099}-\\u{309A}]";var n2="[\\u{309B}-\\u{309C}]";var a2="((".concat(s2,"|").concat(r2,")").concat(o2,"?|").concat(n2,")");Au.japaneseKana=a2});var Dv=we(Iu=>{"use strict";Object.defineProperty(Iu,"__esModule",{value:true});Iu.kannada=void 0;var Cv="[\\u{0C80}-\\u{0CFF}]";var l2="[\\u{0C81}-\\u{0C83}\\u{0CBC}\\u{0CBE}-\\u{0CCD}\\u{0CD5}\\u{0CD6}\\u{0CE2}\\u{0CE3}]";var u2="\\u{0CCD}";var c2="".concat(Cv,"(").concat(u2).concat(Cv,"|").concat(l2,")*");Iu.kannada=c2});var Tv=we(Pu=>{"use strict";Object.defineProperty(Pu,"__esModule",{value:true});Pu.khmer=void 0;var kv="[\\u{1780}-\\u{17FF}]";var m2="[\\u{17B6}-\\u{17D1}\\u{17D3}\\u{17DD}]";var d2="\\u{17D2}";var p2="".concat(kv,"(").concat(d2).concat(kv,"|").concat(m2,")*");Pu.khmer=p2});var Rv=we(Bu=>{"use strict";Object.defineProperty(Bu,"__esModule",{value:true});Bu.lao=void 0;var h2="[\\u{0E80}-\\u{0EFF}]";var f2="[\\u{0EB1}\\u{0EB4}-\\u{0EBC}\\u{0EC8}-\\u{0ECD}]";var g2="".concat(h2).concat(f2,"*");Bu.lao=g2});var Sv=we(Mu=>{"use strict";Object.defineProperty(Mu,"__esModule",{value:true});Mu.malayalam=void 0;var Ev="[\\u{0D00}-\\u{0D7F}]";var _2="[\\u{0D00}-\\u{0D03}\\u{0D3B}\\u{0D3C}\\u{0D3E}-\\u{0D4D}\\u{0D57}\\u{0D62}-\\u{0D63}]";var y2="\\u{0D4D}";var b2="".concat(Ev,"(").concat(y2).concat(Ev,"|").concat(_2,")*");Mu.malayalam=b2});var Ov=we(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:true});Lu.myanmar=void 0;var Fv="[\\u{1000}-\\u{109F}]";var x2=["\\u{102B}-\\u{1038}","\\u{103A}-\\u{103E}","\\u{1056}-\\u{1059}","\\u{105E}-\\u{1060}","\\u{1062}-\\u{1064}","\\u{1067}-\\u{106D}","\\u{1071}-\\u{1074}","\\u{1082}-\\u{108D}","\\u{108F}","\\u{109A}-\\u{109D}"];var v2="[".concat(x2.join(""),"]");var w2="\\u{1039}";var C2="".concat(Fv,"(").concat(w2).concat(Fv,"|").concat(v2,")*");Lu.myanmar=C2});var Av=we(zu=>{"use strict";Object.defineProperty(zu,"__esModule",{value:true});zu.tamil=void 0;var D2="[\\u{0B80}-\\u{0BFF}]";var k2="[\\u{0B82}-\\u{0B83}\\u{0BBE}-\\u{0BD7}\\u{0962}\\u{0963}]";var T2="".concat(D2).concat(k2,"*");zu.tamil=T2});var Pv=we(Uu=>{"use strict";Object.defineProperty(Uu,"__esModule",{value:true});Uu.telugu=void 0;var Iv="[\\u{0C00}-\\u{0C7F}]";var R2="[\\u{0C00}-\\u{0C04}\\u{0C3E}-\\u{0C56}\\u{0C62}\\u{0C63}]";var E2="\\u{0C4D}";var S2="".concat(Iv,"(").concat(E2).concat(Iv,"|").concat(R2,")*");Uu.telugu=S2});var Bv=we(Nu=>{"use strict";Object.defineProperty(Nu,"__esModule",{value:true});Nu.thai=void 0;var F2="[\\u0E00-\\u0E7F]";var O2="[\\u0E31\\u0E33-\\u0E3A\\u0E47-\\u0E4E]";var A2="".concat(F2).concat(O2,"*");Nu.thai=A2});var Mv=we(Gu=>{"use strict";Object.defineProperty(Gu,"__esModule",{value:true});Gu.tibetan=void 0;var I2="[\\u{0F00}-\\u{0FFF}]";var P2="[\\0F18\\0F19\\0F35\\0F37\\0F39\\0F3E\\0F3F\\u{0F71}-\\u{0F87}\\u{0F8D}-\\u{0FBC}\\u{0FC6}]";var B2="".concat(I2).concat(P2,"*");Gu.tibetan=B2});var zv=we(Sr=>{"use strict";Object.defineProperty(Sr,"__esModule",{value:true});Sr.emojiVariation=Sr.keyCap=Sr.countryFlag=void 0;var M2="[\\u{1F1E6}-\\u{1F1FF}]{2}";Sr.countryFlag=M2;var L2="[0-9#\\*][\\u{FE0F}]?\\u{20E3}";Sr.keyCap=L2;var z2=["[\\u{2600}-\\u{26FF}]","[\\u{2700}-\\u{27BF}]","[\\u{1F300}-\\u{1F5FF}]","[\\u{1F600}-\\u{1F64F}]","[\\u{1F680}-\\u{1F6FF}]","[\\u{1F700}-\\u{1F77F}]","[\\u{1F900}-\\u{1F9FF}]"];var Lv="(".concat(z2.join("|"),")");var U2="\\u{200D}";var N2="[\\u{FE0E}\\u{FE0F}]";var G2="[\\u{1F3FB}-\\u{1F3FF}]";var W2="".concat(Lv,"(").concat(U2).concat(Lv,"|").concat(G2,"|").concat(N2,")*");Sr.emojiVariation=W2});var Nv=we((Xj,Uv)=>{"use strict";var V2=hv();var j2=gv();var H2=yv();var q2=xv();var K2=vv();var X2=wv();var Y2=Dv();var J2=Tv();var $2=Rv();var Z2=Sv();var Q2=Ov();var eS=Av();var tS=Pv();var iS=Bv();var rS=Mv();var Hp=zv();var sS=[Hp.countryFlag,Hp.keyCap,Hp.emojiVariation,V2.arabic,j2.bengali,H2.devanagari,q2.gujarati,K2.hebrew,X2.japaneseKana,Y2.kannada,J2.khmer,$2.lao,Z2.malayalam,Q2.myanmar,eS.tamil,tS.telugu,iS.thai,rS.tibetan,"."];var oS=new RegExp("(".concat(sS.join("|"),")"),"gu");function nS(s){return s.match(oS)||[]}Uv.exports={splitGraphemes:nS}});var Gv,Wv,Wu;var qp=_(()=>{Gv=Ur(Nv());Wv=class{constructor(e){this._context=e;this._lastFontStyle={}}getLines(){let e=[];let t=[];const i=this._lines.length;for(let r=0;r<i;r++){const o=this._lines[r];const n=this._buildWords(o);const a=n.length;for(let l=0;l<a;l++){const u=n[l];const c=t.concat(u).join("").replace(/\s+$/i,"");const h=this._getWidth(c);if(h>this._maxWidth){if(t.length>0){e.push(t.join(""));t=[u]}const m=u.replace(/\s+$/i,"");if(this._getWidth(m)>this._maxWidth){const d=this._splitWord(u);e=e.concat(d.lines);if(d.rest){t=[d.rest]}}}else{t.push(u)}}e.push(t.join(""));t=[]}return e.map(r=>this._trimLine(r,this._context.textAlign))}_trimLine(e,t){return e}_buildWords(e){const t=[];let i="";const r=e.length;for(let o=0;o<r;o++){const n=e[o];i+=n;if(n===" "||n==="-"||o===r-1){t.push(i);i=""}}return t}_splitWord(e){const t={lines:[],rest:null};const i=(0,Gv.splitGraphemes)(e);const r=i.length;let o=[];for(let n=0;n<r;n++){const a=i[n];if(this._getWidth(o.concat(a).join(""))>this._maxWidth){if(o.length>0){t.lines.push(o.join(""))}o=[a]}else{o.push(a)}if(n===r-1&&o.length>0){t.rest=o.join("")}}return t}_fontStyleChanged(){if(this._context.font!==this._lastFontStyle){this._lastFontStyle=this._context.font;return true}return false}_getWidth(e){return this._context.measureText(e).width}setText(e){this._text=e;this._lines=e.split("\n")}setMaxWidth(e){this._maxWidth=e}};Wu=Wv});var Kp,Vv,Xp;var Yp=_(()=>{F();qp();({Vector2:Kp}=M);Vv=class{constructor(e,t){this._text=e;this._operation=t;this._textOptions={};this.rotation=0;this._createCanvas();this._createTexture()}_createCanvas(){this._canvas=R.createCanvas();this._context=this._canvas.getContext("2d");this._textSplitter=new Wu(this._context);this._finalCanvas=R.createCanvas();this._finalContext=this._finalCanvas.getContext("2d")}_createTexture(){this._texture=T.Texture.fromCanvas(this._canvas);this._finalTexture=T.Texture.fromCanvas(this._finalCanvas)}_applyTextOptions(e,t){t.font=`${this._text.getFontStyle()} ${this._text.getFontWeight()} ${e.fontSize}px "${this._text.getFontFamily()}"`;if(this._text.getTextMetrics()){t.textBaseline="alphabetic"}else{t.textBaseline="top"}t.textAlign=this._text.getAlignment();t.fillStyle=this._text.getColor().toRGBA();t.strokeStyle=this._text.getOutlineColor().toRGBA();const i=this._text.getOutlineWidth();if(i>0){t.lineWidth=i}}_buildOutputLines(e){this._textSplitter.setText(this._text.getText());this._textSplitter.setMaxWidth(e);return this._textSplitter.getLines().map(t=>{return t.replace(/\s+$/i,"")})}_renderTextLine(e,t,i){const r=this._text.getAlignment();const o=new Kp(0,t);switch(r){case"left":o.x=i;break;case"center":o.x=this._canvas.width/2;break;case"right":o.x=this._canvas.width-i;break}this._context.save();this._context.translate(o.x,o.y);this._context.fillText(e,0,0);this._context.restore();const n=this._text.getOutlineWidth();if(n>0){this._context.miterLimit=2;this._context.strokeText(e,o.x,o.y)}}update(e,t){const i=this.calculateFontStyles(e,t);if(i){const{dimensions:r,lines:o}=this._calculateText(e,i,t);this._renderText(e,r,o,i,t);this._updateFinalTexture()}}_updateFinalTexture(){const{width:e,height:t}=this._canvas;const{rotation:i}=this;const r=Math.cos(i);const o=Math.sin(i);const n=new Kp(Math.abs(e*r)+Math.abs(t*o),Math.abs(e*o)+Math.abs(t*r));this._finalCanvas.width=n.x;this._finalCanvas.height=n.y;this._finalContext.save();this._finalContext.translate(this._finalCanvas.width/2,this._finalCanvas.height/2);this._finalContext.rotate(i);this._finalContext.drawImage(this._canvas,-e/2,-t/2);this._finalContext.restore()}_renderText(e,t,i,r,o){this._canvas.width=t.x;this._canvas.height=t.y;if(this._text.getMaxHeight()){this._canvas.height=Math.min(this._text.getMaxHeight()*o.y,this._canvas.height)}this._context=this._canvas.getContext("2d");this._context.fillStyle=this._text.getBackgroundColor().toRGBA();this._context.fillRect(0,0,t.x,t.y);this._applyTextOptions(r,this._context);const n=this._padding(o);const a=this._text.getTextMetrics();const l=this._text.getFontSize()*o.y;const u=1/a.unitsPerEm*l;const c=a.ascender*u;for(let h=0;h<i.length;h++){const m=i[h];this._renderTextLine(m,r.topPadding+r.lineHeight*h+n+c,n)}}calculateFontStyles(e,t){const i=this._text.getFontFamily();const r=this._text.getFontSize()*t.y;const o=this._text.getAbsoluteTextHeight(t);const n=o*this._text.getLineHeight();const a=o*(this._text.getLineHeight()-1)/2;const l={fontFamily:i,fontSize:r,lineHeight:n,topPadding:a};if(this._textOptions.fontFamily!==i||this._textOptions.fontSize!==r||this._textOptions.lineHeight!==n){this._textOptions=l}return l}_calculateText(e,t,i){const r=this._text.getMaxWidth()*i.x;this._applyTextOptions(t,this._context);const o=new Kp;let n=this._text.getText().split("\n");if(typeof r!=="undefined"){o.x=r;n=this._buildOutputLines(r)}for(let u=0;u<n.length;u++){const c=n[u];o.x=Math.max(o.x,this._context.measureText(c).width)}const{lineHeight:a}=t;o.y=n.length*a;const l=this._padding(i);o.y+=l*2;o.x+=l*2;return{dimensions:o,lines:n}}_padding(e){const t=this._text.getAbsoluteTextHeight(e);const i=.2;return t*i}getTexture(){return this._texture}getFinalTexture(){return this._finalTexture}getDimensions(e,t){const i=this.calculateFontStyles(e,t);const{dimensions:r}=this._calculateText(e,i,t);return r}dispose(){if(this._measurementElement){document.body.removeChild(this._measurementElement)}if(this._texture){this._texture.dispose();this._texture=null}if(this._finalTexture){this._finalTexture.dispose();this._finalTexture=null}}};Xp=Vv});var jv,va;var Hv=_(()=>{F();qp();xi();jt();({Vector2:jv}=M);va=class extends X{constructor(e){super(e);this._textOptions={};this._createCanvas()}_createCanvas(){this._canvas=R.createCanvas();this._context=this._canvas.getContext("2d");this._textSplitter=new Wu(this._context);this._finalCanvas=R.createCanvas();this._finalContext=this._finalCanvas.getContext("2d");this.updateFontVariation()}setOption(e,t,i=true,r=false){super.setOption(e,t,i,r);if(e==="fontIdentifier"&&!r){this.updateFontVariation()}}updateFontVariation(){const e=he.getVariation(this.getFontIdentifier());if(!e){P.warn(`TextDesignFont: Unable to find font '${this._fontIdentifier}'`)}this.setFontVariation(e);return e}_applyTextOptions(e={},t=this._context){const{fontSize:i,fontVariation:r,lineHeight:o,textColor:n,alignment:a}={...this._options,...e};const{fontStyle:l,fontWeight:u,fontFamily:c}=r.serializeOptions();t.font=`${l} ${u} ${i}px "${c}"`;t.fillStyle=n;t.textBaseline="top";t.textAlign=a||"left"}_buildOutputLines(e){this._textSplitter.setText(this.getText());this._textSplitter.setMaxWidth(e);return this._textSplitter.getLines()}_renderTextLine(e,t){const i=this.getAlignment();const r=new jv(0,t);switch(i){case"center":r.x=this._canvas.width/2;break;case"right":r.x=this._canvas.width;break}this._context.fillText(e,r.x,r.y)}update(){const e=this.calculateFontStyles();if(e){const{dimensions:t,lines:i}=this._calculateText(e);this._dimensions=t;this._renderText(t,i,e)}}draw(e,t=0,i=0){this.update();e.drawImage(this._canvas,t,i,this._dimensions.x,this._dimensions.y)}_renderText(e,t,i){this._canvas.width=e.x;this._canvas.height=e.y;this._context=this._canvas.getContext("2d");this._applyTextOptions(i,this._context);for(let r=0;r<t.length;r++){const o=t[r];this._renderTextLine(o,i.topPadding+i.lineHeight*r)}}getFontFamily(){const e=this.getFontVariation();return e.getFontFamily()}calculateFontStyles(){const e=this.getFontFamily();const t=this.getFontSize();const i=this.getAbsoluteTextHeight();const r=i*this.getLineHeight();const o=i*(this.getLineHeight()-1)/2;const n={fontFamily:e,fontSize:t,textHeight:i,lineHeight:r,topPadding:o};this._textOptions={...n};return n}getTextMetrics(){const e=this.getFontVariation();return e.getTextMetrics()}getAbsoluteTextHeight(){const e=this.getFontSize();const t=this.getTextMetrics();if(t){const i=1/t.unitsPerEm*e;const r=t.ascender*i;const o=t.descender*i;return r+Math.abs(o)}return e*this.getLineHeight()*1.1}_calculateText(e){this._applyTextOptions(e,this._context);const t=new jv;let i=this.getText().split("\n");let r;if(typeof r!=="undefined"){t.x=r;i=this._buildOutputLines(r)}else{for(let n=0;n<i.length;n++){const a=i[n];t.x=Math.max(t.x,this._context.measureText(a).width)}}const{lineHeight:o}=e;t.y=i.length*o;return{dimensions:t,lines:i}}getDimensions(){const e=this.calculateFontStyles();const{dimensions:t}=this._calculateText(e);return t}fitMaxHeight(){this.update();const e=this.getDimensions();const t=this.getText().split("\n");const i=this.getMaxHeight()/e.y}fitMaxWidth(){const e=this.getDimensions().x;const t=this.getMaxWidth()/e;this.setFontSize(this.getFontSize()*t);this._textOptions.fontSize=this.getFontSize()}fitInFrame(e){this.setMaxWidth(e.width);this.setMaxHeight(e.height);this.fitMaxWidth();this.fitMaxHeight()}getSize(){const e=this.getDimensions();return new Se(e.x,e.y)}};va.prototype.availableOptions={text:{type:p.STRING,default:""},fontIdentifier:{type:p.STRING,default:"imgly_font_open_sans_bold"},fontVariation:{type:p.OBJECT,default:null},lineHeight:{type:p.NUMBER,default:1},fontSize:{type:p.NUMBER,default:22},textColor:{type:p.STRING,default:"black"},strokeStyle:{type:p.STRING,default:"black"},outlineWidth:{type:p.NUMBER,default:0},textBaseline:{type:p.STRING,default:"alphabetic"},excludeAccents:{type:p.BOOLEAN,default:true},maxWidth:{type:p.NUMBER,default:100},maxHeight:{type:p.NUMBER,default:0},alignment:{type:p.STRING,default:"left",available:["left","center","right"]}}});var Fr;var Vu=_(()=>{F();Yp();Xo();Hv();gs();xu();Fr=class extends Yi{_calculateLayoutElements(){const e=this.getWords();const t=this._getTextFrame();const i=this.getAttributes();const r=i.getFontIdentifier();const o=this.getImageInsets();const n=new gt({text:e.getWord(0),fontIdentifier:r});n.fitWidth(t.width);const a=new _t({text:e.getWord(0),frame:t,font:n});a.setFrame(this._getTextFrameForElement(a));const l=this.getSize();if(this.getSizeToFitContent()||l.height<=1){l.height=o.top+a.getFrame().height+o.bottom}l.height=Math.max(l.height,this.getMinimumHeight());return[a]}_getTextFrameForElement(e){const t=this.getWords();const i=t.getWord(0);const r=this.getAttributes();const o=r.getFontIdentifier();const n=this.getImageInsets();const a=this.getImageInsets().applyToRectangle(this._getFrame()).scale(this.getTextScaleFactor());const l=new va({text:i,fontIdentifier:o,alignment:r.getAlignment(),lineHeight:1});l.fitInFrame(a);const u=l.getSize();a.height=u.height;let c=u.height*this.getRowScaleFactor();if(this.getSizeToFitContent()){c+=n.top+n.bottom}const h=this._getFrame();const m=r.getAlignment();if(this.getCenteredVertically()){a.y=h.height/2-c/2+n.top}else{switch(m){case"left":a.y=h.height-c-n.bottom;break;case"center":a.y=h.height/2-c/2+c*this.getCenterOffset();a.x=(h.width-a.width)/2;break;case"right":a.x=h.width-a.width-n.right;break;default:break}}return a}render(e){e.save();this._getLayoutElements().forEach(t=>{let{text:i,frame:r}=t.serializeOptions();const o=this.getAttributes();const n=o.getFontIdentifier();const a=new va({text:i,fontIdentifier:n,alignment:o.getAlignment(),lineHeight:1,textColor:o.getTextColor().toRGBA()});r=this._getTextFrameForElement(t);a.fitInFrame(r);a.draw(e,r.x,r.y)});e.restore()}};Fr.prototype.availableOptions={...Yi.prototype.availableOptions,centerOffset:{type:p.NUMBER,default:0},sizeToFitContent:{type:p.BOOLEAN,default:false},textScaleFactor:{type:p.NUMBER,default:.95},rowScaleFactor:{type:p.NUMBER,default:1},minimumHeight:{type:p.NUMBER,default:0},centeredVertically:{type:p.BOOLEAN,default:false}}});var en,Pe;var ws=_(()=>{F();Qo();Ot();Vu();jt();Rr();$o();en=class extends je{constructor(...e){super(...e);this._rowType=Y.Box;this._alignmentRandomizer=new se(0);this._isMaskedRandomizer=new se(0);this._seedPool.push(this._alignmentRandomizer);this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return[Y.Box.getImagePath()]}_modifiedText(e){return super._modifiedText(e).toLowerCase()}_modifiedLines(e){const t=new $e;t.set([e.reduce((i,r)=>`${i}${i===""?"":"\n"}${r.joined(1)[0]}`,"")]);return[t]}_layoutRows(e,t){const i=super._layoutRows(e,t);const r=i[0];if(r&&this.getSquareLayout()){const o=r.getSize();o.height=o.width}return i}getAlignment(){return this._alignmentRandomizer.pickNext(this.constructor.ValidAlignments||en.ValidAlignments)}_randomLayoutRow(e,t,i,r){const o=this.getAlignment();const n=this._rowType;const a=he.getImage(n.getImagePath());r.setAlignment(o);const l=new Fr({words:e,width:i,attributes:r,image:a,imageInsets:n.insetsForWidth(i),capInsets:n.getCapInsets(),backgroundColor:E.WHITE,centerOffset:0,textScaleFactor:.7,isMasked:this._isMaskedRandomizer.nextBool()});if(this._rowType===Y.Box){l.serverImageSmoothingFix=true}const u=l.getSize();if(this.getSquareLayout()){u.height=u.width}else{u.height=Math.max(u.height,u.width*n.getMinimumHeightRatio())}return l}};Pe=en;I(Pe,"defaultFontIdentifiers",["imgly_font_galano_grotesque_bold"]);I(Pe,"Alignment",{Left:"left",Center:"center",Right:"right"});I(Pe,"ValidAlignments",[en.Alignment.Left,en.Alignment.Center,en.Alignment.Right]);I(Pe,"identifier","imgly_text_design_masked");Pe.prototype.availableOptions={...je.prototype.availableOptions,fontIdentifiers:{type:p.ARRAY,default:Pe.defaultFontIdentifiers},squareLayout:{type:p.BOOLEAN,default:true}}});var Or;var qv=_(()=>{F();Qo();Ot();ws();Or=class extends Pe{constructor(...e){super(...e);this._possibleRowTypes=[Y.Badge1,Y.Badge2,Y.Badge3,Y.Badge4];this._rowTypesRandomizer=new se(0);this._isMaskedRandomizer=new se(0);this._seedPool.push(this._rowTypesRandomizer);this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return this._possibleRowTypes.map(e=>e.getImagePath())}_randomLayoutRow(e,t,i,r){this._rowType=this._rowTypesRandomizer.pickNext(this._possibleRowTypes);r.setLineSpacing(.9);const o=super._randomLayoutRow(e,t,i,r);o.set({textScaleFactor:.9});return o}};I(Or,"defaultFontIdentifiers",["imgly_font_campton_bold"]);I(Or,"identifier","imgly_text_design_masked_badge");I(Or,"ValidAlignments",[Pe.Alignment.Center]);Or.prototype.availableOptions={...Pe.prototype.availableOptions,fontIdentifiers:{type:p.ARRAY,default:Or.defaultFontIdentifiers}}});var Pt;var ju=_(()=>{F();Qo();Ot();ws();Pt=class extends Pe{constructor(...e){super(...e);this._possibleRowTypes=[Y.SpeechBubble1,Y.SpeechBubble3];this._rowTypesRandomizer=new se(0);this._isMaskedRandomizer=new se(0);this._seedPool.push(this._rowTypesRandomizer);this._seedPool.push(this._isMaskedRandomizer)}getImagePaths(){return this._possibleRowTypes.map(e=>e.getImagePath())}_rowTypes(e){return this._possibleRowTypes}_randomLayoutRow(e,t,i,r){this._rowType=this._rowTypesRandomizer.pickNext(this._rowTypes(e));r.setLineSpacing(.9);const o=super._randomLayoutRow(e,t,i,r);o.set({textScaleFactor:1,minimumHeight:i*this._rowType.getMinimumHeightRatio(),sizeToFitContent:this._rowType.getSizeToFitContent(),centeredVertically:true});return o}};I(Pt,"defaultFontIdentifiers",["imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_roboto_black","imgly_font_roboto_light"]);I(Pt,"identifier","imgly_text_design_masked_speech_bubble");Pt.prototype.availableOptions={...Pe.prototype.availableOptions,fontIdentifiers:{type:p.ARRAY,default:Pt.defaultFontIdentifiers},squareLayout:{type:p.BOOLEAN,default:false},alignment:{type:p.STRING,default:"left",available:Pe.ValidAlignments}}});var Cs;var Kv=_(()=>{F();Qo();ws();ju();Cs=class extends Pt{constructor(...e){super(...e);this._possibleRowTypes=[Y.SpeechBubble2,Y.SpeechBubble4,Y.SpeechBubble2,Y.SpeechBubble4,Y.SpeechBubble5];this._possibleRowTypesForMin15=this._possibleRowTypes.slice(0,2);this._possibleRowTypesForMax14=this._possibleRowTypes.slice(2)}_rowTypes(e){return e.countNumberOfCharacters()<15?this._possibleRowTypesForMax14:this._possibleRowTypesForMin15}};I(Cs,"defaultFontIdentifiers",["imgly_font_permanent_marker"]);I(Cs,"identifier","imgly_text_design_masked_speech_bubble_comic");Cs.prototype.availableOptions={...Pt.prototype.availableOptions,fontIdentifiers:{type:p.ARRAY,default:Cs.defaultFontIdentifiers}}});var Ds;var Xv=_(()=>{F();Vu();ws();Ds=class extends Pe{_modifiedText(e){return super._modifiedText(e).toUpperCase()}_randomLayoutRow(e,t,i,r){const o=this._alignmentRandomizer.pickNext(Pe.ValidAlignments);r.setAlignment(o);return new Fr({words:e,width:i,attributes:r,image:null,backgroundColor:E.WHITE,centerOffset:0,sizeToFitContent:true,isMasked:false,autoAdjustTextColor:false})}};I(Ds,"defaultFontIdentifiers",["imgly_font_abril_fatface_regular"]);I(Ds,"identifier","imgly_text_design_multiline");Ds.prototype.availableOptions={...Pe.prototype.availableOptions,fontIdentifiers:{type:p.ARRAY,default:Ds.defaultFontIdentifiers}}});var aS,Hu;var Yv=_(()=>{F();({Rectangle:aS}=M);Hu=class extends X{getContentFrame(){const e=this.getFrame().clone();const t=e.width*.1;return e.insetBy(t,t)}intersects(e){return this.getFrame().intersects(e.getFrame())}};Hu.prototype.availableOptions={frame:{type:p.OBJECT,default:new aS}}});var Jv,oi;var qu=_(()=>{F();jt();Tr();Vp();Yv();({Rectangle:Jv}=M);oi=class extends xs{constructor(...e){super(...e);this._MAX_TRIES=1e3;this._PRECISION=1e3}render(e,t,i,r,o){const{imagePaths:n,relativeParticleSize:a}=this._options;if(n.length<=0){return}const l=t.width/t.height;const u=new Jv(Math.round(i.left*this._PRECISION),Math.round(i.top*this._PRECISION*l),this._PRECISION,this._PRECISION);u.width-=u.x+Math.round(i.right*this._PRECISION);u.height-=u.y+Math.round(i.bottom*this._PRECISION*l);const c=[];let h=0;let m=0;while(h<this.getParticleCount()&&m<this._MAX_TRIES){const d=a/2;const f=Math.round(d*this._PRECISION);const b=Math.round(d*this._PRECISION*l);const y=Math.floor(this._PRECISION)-f;const g=Math.floor(this._PRECISION)-b;const C=o.nextInRange(f,y);const v=o.nextInRange(b,g);const x=new Jv(C-f,v-b,2*f,2*b);if(!x.intersects(u)&&!this.hasCollision(c,x)){c.push(new Hu({frame:x}));h+=1}m+=1}for(let d=0;d<c.length;d++){const f=c[d];const b=o.pickNext(n);const y=he.getImage(b);const g=o.nextInRange(140,230)/255;const C=t.width/this._PRECISION;const v=t.height/this._PRECISION;const x=f.getContentFrame();x.x*=C;x.y*=v;x.width*=C;x.height*=v;const B=r.clone();B.a=g;Xi(e,y,x,B,"source-atop")}}hasCollision(e,t){for(let i=0;i<e.length;i++){if(t.intersects(e[i].getFrame())){return true}}return false}};oi.prototype.availableOptions={...xs.prototype.availableOptions,particleCount:{type:p.NUMBER,default:50},relativeParticleSize:{type:p.NUMBER,default:.08},imagePaths:{type:p.ARRAY,default:[]}}});var tn;var $v=_(()=>{F();qu();tn=class extends oi{};I(tn,"Images",["text-design/images/imgly_text_design_particle_brush_01.png","text-design/images/imgly_text_design_particle_brush_02.png","text-design/images/imgly_text_design_particle_brush_03.png","text-design/images/imgly_text_design_particle_brush_04.png","text-design/images/imgly_text_design_particle_brush_05.png","text-design/images/imgly_text_design_particle_brush_06.png","text-design/images/imgly_text_design_particle_brush_07.png","text-design/images/imgly_text_design_particle_brush_08.png","text-design/images/imgly_text_design_particle_brush_09.png","text-design/images/imgly_text_design_particle_brush_10.png"]);tn.prototype.availableOptions={...oi.prototype.availableOptions,imagePaths:{type:p.ARRAY,default:[...tn.Images]},relativeParticleSize:{type:p.NUMBER,default:.12}}});var rn;var Zv=_(()=>{F();qu();rn=class extends oi{};I(rn,"Images",["text-design/images/imgly_text_design_particle_circle_01.png","text-design/images/imgly_text_design_particle_circle_02.png","text-design/images/imgly_text_design_particle_circle_03.png","text-design/images/imgly_text_design_particle_circle_04.png","text-design/images/imgly_text_design_particle_circle_05.png","text-design/images/imgly_text_design_particle_circle_06.png","text-design/images/imgly_text_design_particle_circle_07.png","text-design/images/imgly_text_design_particle_circle_08.png","text-design/images/imgly_text_design_particle_circle_09.png","text-design/images/imgly_text_design_particle_circle_10.png"]);rn.prototype.availableOptions={...oi.prototype.availableOptions,imagePaths:{type:p.ARRAY,default:[...rn.Images]},relativeParticleSize:{type:p.NUMBER,default:.12}}});var sn;var Qv=_(()=>{F();qu();sn=class extends oi{};I(sn,"Images",["text-design/images/imgly_text_design_particle_triangle_01.png","text-design/images/imgly_text_design_particle_triangle_02.png","text-design/images/imgly_text_design_particle_triangle_03.png","text-design/images/imgly_text_design_particle_triangle_04.png","text-design/images/imgly_text_design_particle_triangle_05.png","text-design/images/imgly_text_design_particle_triangle_06.png","text-design/images/imgly_text_design_particle_triangle_07.png","text-design/images/imgly_text_design_particle_triangle_08.png","text-design/images/imgly_text_design_particle_triangle_09.png","text-design/images/imgly_text_design_particle_triangle_10.png"]);sn.prototype.availableOptions={...oi.prototype.availableOptions,imagePaths:{type:p.ARRAY,default:[...sn.Images]}}});var Ar,it;var Ku=_(()=>{F();Ot();At();qt();Du();ku();jt();Rr();$o();Ar=class extends je{constructor(...e){super(...e);this._relativeInsets=new $(0,0,0,0);this._INVALID_FONTS_IF_LESS_THEN_5_CHARS=["imgly_font_montserrat_light"];this._INVALID_FONTS_IF_LESS_THEN_4_CHARS=["imgly_font_montserrat_light","imgly_font_wolesbro"];this._lineCount=0;this._decorativeRowCreated=false;this._useImageRowRandomizer=new se(0);this._rowTypeRandomizer=new se(0);this._lineDecorativeTypeRandomizer=new se(0);this._seedPool.push(this._useImageRowRandomizer);this._seedPool.push(this._rowTypeRandomizer);this._seedPool.push(this._lineDecorativeTypeRandomizer)}getImagePaths(){return[...Ar.DecoratorImages,...Ar.RowImages]}_fontForRow(e,t){const i=t.countNumberOfCharacters();let r=this.getFontIdentifiers();if(i<4){r=r.filter(o=>this._INVALID_FONTS_IF_LESS_THEN_4_CHARS.indexOf(o)<0)}else if(i<5){r=r.filter(o=>this._INVALID_FONTS_IF_LESS_THEN_5_CHARS.indexOf(o)<0)}return r[e%r.length]}_modifiedText(e){return super._modifiedText(e).toUpperCase()}_modifiedLines(e){this._lineCount=e.length;return e}generateLayoutData(e,t){this._decorativeRowCreated=false;return super.generateLayoutData(e,t)}_randomLayoutRow(e,t,i,r){const o=r.getFontIdentifier();let n=e;switch(o){case"imgly_font_wolesbro":n=new $e().set(e.getLowerCase());break;case"imgly_font_permanent_marker":n=new $e().set(e.getUpperCase());break;default:break}const a=this.getDecorativeRowsInTheMiddleOnly()&&(t===0||t===this._lineCount-1);if(this._useImageRowRandomizer.nextBool()||this._decorativeRowCreated||a){return new Fe({words:n,width:i,attributes:r})}this._decorativeRowCreated=true;const[l,u]=this._randomDecoratorImages();return new si({words:e,width:i,attributes:r,leftImage:l,rightImage:u})}_layoutRows(e,t){const i=super._layoutRows(e,t);if(!this.getDecorationsVisible()){return i}const r=.0625*t;const o=new qe({width:t,height:r,image:he.getImage(this._rowTypeRandomizer.pickNext(Ar.RowImages))}).layout();const n=new qe({width:t,height:r,image:he.getImage(this._rowTypeRandomizer.pickNext(Ar.RowImages))}).layout();return[o,...i,n]}_randomDecoratorImages(){if(this._lineDecorativeTypeRandomizer.nextInRange(0,1)){return Ar.DecoratorImages.slice(0,2).map(e=>he.getImage(e))}return Ar.DecoratorImages.slice(2).map(e=>he.getImage(e))}};it=Ar;I(it,"defaultFontIdentifiers",["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro","imgly_font_montserrat_light"]);I(it,"identifier","imgly_text_design_sunshine");I(it,"RowImages",[qe.RowImages.decorative1,qe.RowImages.decorative2,qe.RowImages.decorative3,qe.RowImages.decorative4]);I(it,"DecoratorImages",["text-design/images/imgly_text_design_asset_decorative_03.png","text-design/images/imgly_text_design_asset_decorative_04.png","text-design/images/imgly_text_design_asset_decorative_07.png","text-design/images/imgly_text_design_asset_decorative_08.png"]);it.prototype.availableOptions={...je.prototype.availableOptions,fontIdentifiers:{type:p.ARRAY,default:it.defaultFontIdentifiers},relativeLineSpacing:{type:p.NUMBER,default:.025/3*4},decorationsVisible:{type:p.BOOLEAN,default:true},decorativeRowsInTheMiddleOnly:{type:p.BOOLEAN,default:false}}});var Ir,Ji;var ew=_(()=>{F();$v();Zv();Qv();Ot();At();jt();Ku();Ir=class extends it{constructor(...e){super(...e);this._relativeInsets=new $(.3,.3,.3,.3);this._backgroundRandomizer=new se(0);this._decoTypeRandomizer=new se(0);this._seedPool.push(this._backgroundRandomizer);this._seedPool.push(this._decoTypeRandomizer)}getImagePaths(){return[...it.RowImages,...R.Array.flatten(Ir.Backgrounds.map(e=>e.getImagePaths())),...Ir.DecoratorImages]}_getBackground(){return this._backgroundRandomizer.pickNext(Ir.Backgrounds)}_randomDecoratorImages(){switch(this._decoTypeRandomizer.nextInRange(0,2)){case 0:return Ir.DecoratorImages.slice(0,2).map(e=>he.getImage(e));case 1:case 2:return Ir.DecoratorImages.slice(2).map(e=>he.getImage(e));default:P.warn("TextDesignParticles#_randomDecoratorImages: Number generated not in valid range.");return Ir.DecoratorImages.slice(2).map(e=>he.getImage(e))}}};Ji=Ir;I(Ji,"defaultFontIdentifiers",["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro","imgly_font_montserrat_light"]);I(Ji,"identifier","imgly_text_design_particles");I(Ji,"Backgrounds",[new tn,new rn,new sn]);I(Ji,"DecoratorImages",["text-design/images/imgly_text_design_particle_holder_01.png","text-design/images/imgly_text_design_particle_holder_02.png","text-design/images/imgly_text_design_particle_holder_03.png","text-design/images/imgly_text_design_particle_holder_04.png"]);Ji.prototype.availableOptions={...it.prototype.availableOptions,fontIdentifiers:{type:p.ARRAY,default:Ji.defaultFontIdentifiers},decorationsVisible:{type:p.BOOLEAN,default:false},decorativeRowsInTheMiddleOnly:{type:p.BOOLEAN,default:true}}});var ks;var tw=_(()=>{F();Ot();At();Np();$o();ks=class extends je{constructor(...e){super(...e);this._relativeInsets=new $(.1,0,0,0);this._rowTypeRandomizer=new se(0);this._seedPool.push(this._rowTypeRandomizer)}_modifiedText(e){return super._modifiedText(e).toUpperCase()}_randomLayoutRow(e,t,i,r){const o=super._randomLayoutRow(e,t,i,r);o.setShearingAngle(this.getShearingAngle());return o}_layoutRows(e,t){const i=super._layoutRows(e,t);const r=R.values(Tt.FormType);const o=30;const n=new Tt({width:t,height:o,type:this._rowTypeRandomizer.pickNext(r),shearingAngle:this.getShearingAngle()}).layout();const a=new Tt({width:t,height:o,type:this._rowTypeRandomizer.pickNext(r),shearingAngle:this.getShearingAngle()}).layout();return[n,...i,a]}};I(ks,"defaultFontIdentifiers",["imgly_font_campton_bold"]);I(ks,"identifier","imgly_text_design_rotated");ks.prototype.availableOptions={...je.prototype.availableOptions,fontIdentifiers:{type:p.ARRAY,default:ks.defaultFontIdentifiers},relativeLineSpacing:{type:p.NUMBER,default:.025/3},shearingAngle:{type:p.NUMBER,default:-.1}}});var Xu;var iw=_(()=>{At();ku();jt();Ku();Xu=class extends it{constructor(...e){super(...e);this._relativeInsets=new $(0,.3,0,.3)}_layoutRows(e,t){const i=super._layoutRows(e,t);if(!this.getDecorationsVisible()){return i}const r=25;const o=new qe({width:t,height:r,image:he.getImage(this._rowTypeRandomizer.pickNext(it.RowImages))}).layout();const n=new qe({width:t,height:r,image:he.getImage(this._rowTypeRandomizer.pickNext(it.RowImages))}).layout();return[o,...i,n]}};I(Xu,"identifier","imgly_text_design_sunshine-v3_1_0")});var Ts;var rw=_(()=>{F();Qo();ws();ju();Ts=class extends Pt{constructor(...e){super(...e);this._possibleRowTypes=[Y.Watercolor1,Y.Watercolor2,Y.Watercolor3]}};I(Ts,"defaultFontIdentifiers",["imgly_font_permanent_marker","imgly_font_wolesbro","imgly_font_wolesbro"]);I(Ts,"identifier","imgly_text_design_watercolor");Ts.prototype.availableOptions={...Pt.prototype.availableOptions,fontIdentifiers:{type:p.ARRAY,default:Ts.defaultFontIdentifiers},alignment:{type:p.STRING,default:Pe.Alignment.Center,available:Pe.ValidAlignments}}});var lS,Yu,Jp;var sw=_(()=>{F();Ot();xu();Vu();xi();Tr();({Rectangle:lS}=M);Yu=1e3;Jp=class{constructor(){this._layoutData=null;this._layout=null;this._text="";this._seed=0;this._debugMode=false;this.randomizer=new se}createLayout(e,t,i){this._layout=e;this._text=t;this._seed=i;e.seed(i);this._layoutData=e.generateLayoutData(t,Yu)}calculateAspect(){if(!this._layoutData){P.warn("TextDesignRenderer#calculateAspect: No layout data");return 1}return this._layoutData.getSize().aspect()}draw(e,t,i,r){const o=this._layoutData;if(this._layoutData){const n=new Se(Yu,Yu/t.aspect());const a=t.width/Yu;const l=o.getRelativeInsets().clone().scale(n.width);const u=o.getRelativeLineSpacing()*n.width;let c=l.top;e.save();this.randomizer.seed(this._seed);const h=o.getBackground();if(h){h.render(e,t,o.getRelativeInsets(),r?E.WHITE:i,this.randomizer)}e.scale(a,a);o.getRows().forEach(m=>{e.save();const d=m.getAttributes();e.transform(1,m.getShearingAngle(),0,1,l.left,c);d.setTextColor(r?E.WHITE:i.clone());d.setTintColor(r?E.WHITE:i.clone());if(m instanceof Yi||m instanceof Fr){m.setBackgroundColor(r?E.WHITE:i.clone());m.setIsUsedInInvertedLayout(r)}if(this._debugMode){m._debugMode=true}m.willRender(e);m.render(e);m.didRender(e);if(this._debugMode){const f=m._getFrame();const b=m._getTextFrame();Jo(e,f,E.GREEN);Jo(e,b,E.BLUE);m._getLayoutElements().forEach(y=>{const g=y.getFrame();const C=m._getTextFrameForElement(y);Jo(e,g,new E(1,1,0));Jo(e,C,new E(0,1,1))})}c+=m.getSize().height+u;e.restore()});if(this._debugMode){Jo(e,new lS(0,0,n.width,n.height),E.RED)}e.restore()}}}});var Pr,on,Ju;var ow=_(()=>{F();Ko();Zo();uv();Gp();cv();Wp();mv();jp();pv();ws();qv();ju();Kv();Xv();ew();tw();Ku();iw();rw();Ot();xi();jt();sw();({Vector2:Pr}=M);on=class extends yi{constructor(e,t){super(e,t);this._isDisposed=false;this._renderer=new Jp;this._canvas=R.createCanvas();this._context=this._canvas.getContext("2d");this._texture=T.Texture.fromCanvas(this._canvas);this._sprite.setTexture(this._texture);this._aspect=1;this._isLayoutDirty=true;if(this.getSeed()<0){this.setSeed(se.TimeSeed())}}seed(e){this.setSeed(e||se.TimeSeed());this._isLayoutDirty=true}_updateLayout(){const e=this.getLayout();if(!e){return null}this._renderer.createLayout(e,this.getText(),this.getSeed());this._aspect=this._renderer.calculateAspect();this._isLayoutDirty=false;return true}applyTransform(e){super.applyTransform(e);const t={};if(this._options.dimensions){t.width=e.applyToRelativeSize(this.getWidth())}this.set(t,false)}applyFlip(e){super.applyFlip(e);let{rotation:t}=this._options;switch(e){case"horizontal":t+=(Math.PI-t)*2;this.setRotation(t);break;case"vertical":t+=(Math.PI/2-t)*2;this.setRotation(t);break}}update(e,t){const i=this._isLayoutDirty;if(this._isDisposed||i&&!this._updateLayout()){return}const r=this.getWidth()*t.min()/e.getTextureScale();const o=r/this._aspect;const n=new Pr(r,o);const a=new Pr(Math.round(r*2),Math.round(o*2)).clamp(new Pr(1,1),new Pr(Infinity,Infinity));const l=e.getRenderer();const u=l.getMaxDimensions()||Infinity;if(a.x>u){a.x=u;a.y=Math.round(a.x/this._aspect)}if(a.y>u){a.y=u;a.x=Math.round(a.y*this._aspect)}const c=R.ensureCanvasDimensions(this._canvas,a);if(i||c){this._context.clearRect(0,0,this._canvas.width,this._canvas.height);this._renderer.draw(this._context,new Se(a.x,a.y),this.getColor(),this.getInverted());this.setDimensions(n);this._texture.getBaseTexture().update();if(l.isOfType(H.WEBGL)){l.updateTexture(this._texture.getBaseTexture())}}super.update(e,t);this._applyFlip()}_applyFlip(){const e=this._sprite.getScale();const{flipHorizontally:t,flipVertically:i}=this._options;if(t&&e.x>0||!t&&e.x<0){e.x*=-1}if(i&&e.y>0||!i&&e.y<0){e.y*=-1}this._sprite.setScale(e)}_optionEquals(e,t){if(e==="layout"){const{layout:i}=this._options;if(!i&&t||!t&&i){return false}if(!t.constructor||!i.constructor){return false}if(i.constructor.identifier!==t.constructor.identifier){return false}return true}return super._optionEquals(e,t)}serializeOptions(e,t=false){if(e&&this.getPadding()<0){const r=e.indexOf("padding");if(r>-1){e.splice(r,1)}}const i=super.serializeOptions(e,t);if(!e)i.type="textdesign";return i}_getTexture(){return this._texture}canBeFlippedHorizontally(){return false}canBeDuplicated(){return true}canMaskCanvas(){return true}canAdjustPadding(){return true}dispose(){this._isDisposed=true;this._texture.dispose();this._sprite.dispose()}};on.Layouts={TextDesignBlocks:He,TextDesignBlocksCondensed:_s,TextDesignBlocksLight:vi,TextDesignCelebrate:It,TextDesignCelebrateSimple:bs,TextDesignEqualWidth:Ci,TextDesignEqualWidthFat:vs,TextDesignMasked:Pe,TextDesignMaskedBadge:Or,TextDesignMaskedSpeechBubble:Pt,TextDesignMaskedSpeechBubbleComic:Cs,TextDesignMultiline:Ds,TextDesignWatercolor:Ts,TextDesignSunshine:it,TextDesignParticles:Ji,TextDesignRotated:ks};on.LegacyLayouts={TextDesignBlocksLightV310:ys,TextDesignSunshineV310:Xu};on.AssetManager=he;on.prototype.availableOptions={id:{type:p.STRING,default:()=>R.getUUID()},position:{type:p.VECTOR2,default:new Pr(.5,.5)},dimensions:{type:p.VECTOR2,default:Pr.NULL},anchor:{type:p.VECTOR2,default:new Pr(0,0)},pivot:{type:p.VECTOR2,default:new Pr(.5,.5)},rotation:{type:p.NUMBER,default:0},flipHorizontally:{type:p.BOOLEAN,default:false},flipVertically:{type:p.BOOLEAN,default:false},layout:{type:p.OBJECT,default:null,setter(s){this._isLayoutDirty=true;return s}},text:{type:p.STRING,default:"",setter(s){this._isLayoutDirty=true;return s}},color:{type:p.COLOR,default:E.BLACK,setter(s){this._isLayoutDirty=true;return s}},padding:{type:p.NUMBER,default:.01,minValue:.01},width:{type:p.NUMBER,default:.8},inverted:{type:p.BOOLEAN,default:false,setter(s){this._isLayoutDirty=true;return s}},seed:{type:p.NUMBER,default:-1}};Ju=on});var $p,$u,Zu;var nw=_(()=>{F();Ko();Yp();({Vector2:$p}=M);$u=class extends yi{constructor(...e){super(...e);this._textRenderer=new Xp(this,this._operation);this._textRenderer.rotation=this.getRotation();this._sprite.setTexture(this._textRenderer.getFinalTexture());this._hitTestSprite.setTexture(this._textRenderer.getTexture())}serializeOptions(e,t=false){const i=super.serializeOptions(e,t);if(!e)i.type="text";return i}getDOMStyle(e,t){const i=this.getFontSize()*t.y;return{fontWeight:this._options.fontWeight,fontSize:`${i}px`,fontStyle:this._options.fontStyle,fontFamily:this._options.fontFamily,lineHeight:`${this.getAbsoluteTextHeight(t)*this.getLineHeight()}px`,color:this._options.color.toRGBA(),backgroundColor:this._options.backgroundColor.toRGBA(),textAlign:this._options.alignment}}getAbsoluteTextHeight(e){const t=this.getFontSize()*e.y;const i=this.getTextMetrics();if(i){const r=1/i.unitsPerEm*t;const o=i.ascender*r;const n=i.descender*r;return o+Math.abs(n)}return t*this.getLineHeight()*1.1}getDimensions(e,t){return this._textRenderer.getDimensions(e,t)}applyFlip(e){super.applyFlip(e);let{rotation:t}=this._options;switch(e){case"horizontal":t+=(Math.PI-t)*2;this.setRotation(t);break;case"vertical":t+=(Math.PI/2-t)*2;this.setRotation(t);break}}applyTransform(e){super.applyTransform(e);this.set({fontSize:e.scaleSize(this.getFontSize(),"y"),maxWidth:e.scaleSize(this.getMaxWidth(),"x")},false)}applyRotation(e){super.applyRotation(e);const t=(e+360)%360;const i=this._operation.getInputDimensions();if(t===90||t===270){this.setMaxWidth(this.getMaxWidth()/i.x*i.y);this.setFontSize(this.getFontSize()/i.y*i.x)}}setOption(e,t){const{flipHorizontally:i,flipVertically:r}=this._options;if(e==="rotation"){let o=t;if(i){o=Math.PI*2-o}if(r){o=Math.PI*2-o}this._options.rotation=o;if(this._textRenderer){this._textRenderer.rotation=o}this._rotation=o;this.emit("update");return}super.setOption(e,t)}getOption(e){if(e==="rotation"){return this._rotation}return super.getOption(e)}getHitTestDisplayObject(){return this._hitTestSprite}update(e,t){this._sprite.setVisible(this._options.visible);if(!this._options.visible)return;this._textRenderer.update(e,t);const i=this._textRenderer.getFinalTexture();const r=i.getBaseTexture();r.update();const o=e.getRenderer();if(o.isOfType(H.WEBGL)){o.updateTexture(i.getBaseTexture())}super.update(e,t);this._sprite.setRotation(0);this._textRenderer.getTexture().getBaseTexture().update();this._hitTestSprite.setRotation(this._rotation);this._hitTestSprite.updateTransform();this._applyFlip()}_applyFlip(){const e=this._sprite.getScale();const{flipHorizontally:t,flipVertically:i}=this._options;if(t&&e.x>0||!t&&e.x<0){e.x*=-1;this.setRotation(this._rotation)}if(i&&e.y>0||!i&&e.y<0){e.y*=-1;this.setRotation(this._rotation)}this._sprite.setScale(e)}_getTexture(){return this._textRenderer.getFinalTexture()}dispose(){super.dispose();this._textRenderer.dispose();this._hitTestSprite.dispose();this._sprite.dispose()}canBeFlippedHorizontally(){return false}canAdjustPadding(){return false}};$u.prototype.availableOptions={id:{type:p.STRING,default:()=>R.getUUID()},fontSize:{type:p.NUMBER,default:.1},characterSpacing:{type:p.NUMBER,default:0},lineHeight:{type:p.NUMBER,default:1.1},fontIdentifier:{type:p.STRING},fontFamily:{type:p.STRING,default:"Times New Roman"},fontWeight:{type:p.ALL,default:"normal"},fontStyle:{type:p.STRING,default:"normal"},textMetrics:{type:p.OBJECT,default:null},outlineWidth:{type:p.NUMBER,default:0},outlineColor:{type:p.COLOR,default:E.BLACK},alignment:{type:p.STRING,default:"left",available:["left","center","right"]},verticalAlignment:{type:p.STRING,default:"top",available:["top","center","bottom"]},color:{type:p.COLOR,default:new E(1,0,0,1)},backgroundColor:{type:p.COLOR,default:E.TRANSPARENT},position:{type:p.VECTOR2,default:new $p(.5,.5)},anchor:{type:p.VECTOR2,default:new $p(0,0)},pivot:{type:p.VECTOR2,default:new $p(.5,.5)},rotation:{type:p.NUMBER,default:0},text:{type:p.STRING,required:true},maxWidth:{type:p.NUMBER,default:.5},maxHeight:{type:p.NUMBER,default:0},visible:{type:p.BOOLEAN,default:true},flipHorizontally:{type:p.BOOLEAN,default:false},flipVertically:{type:p.BOOLEAN,default:false}};$u.type="text";Zu=$u});var Zp,$i,aw;var lw=_(()=>{F();Ko();Mp();iv();ow();nw();({Vector2:Zp}=M);$i=class extends le{constructor(...e){super(...e);this.setSmoothDownscaling(this._sdk.getOptions().smoothDownscaling);this._onSpriteUpdate=this._onSpriteUpdate.bind(this);this._maskCanvas=R.createCanvas();const t=this._options.sprites.slice();t.forEach(i=>{this.removeSprite(i);this.addSprite(i)})}getSpritesOfType(e){return this._options.sprites.filter(t=>t instanceof e)}rotate(e){this._options.sprites.forEach(t=>{t.applyRotation(e)})}flip(e){this._options.sprites.forEach(t=>{t.applyFlip(e)})}_onSpriteUpdate(e,t){this.emit("update",this);this.setDirty(true)}_applyRotation(e,t){this._options.sprites.forEach(i=>i.applyRotation(e,t))}transform(e){this._options.sprites.forEach(t=>t.applyTransform(e))}scale(e){this._options.sprites.forEach(t=>t.applyScale(e))}serializeOption(e,t=false){if(e==="sprites"){return this._options.sprites.map(i=>{return i.serializeOptions(void 0,t)})}return super.serializeOption(e,t)}createSticker(e){return new yu(this,e)}createText(e){return new Zu(this,e)}createBrush(e){return new hs(this,e)}createTextDesign(e){return new Ju(this,e)}addSprite(e){this._options.sprites.push(e);const t=this.getSmoothDownscaling();if(e.setSmoothDownscaling)e.setSmoothDownscaling(t);this._container.addChild(e.getDisplayObject());this.setDirty(true);e.on("update",this._onSpriteUpdate);this.emit("update",this,this._options.sprites)}removeSprite(e){const{sprites:t}=this._options;const i=t.indexOf(e);if(i!==-1){e.off("update",this._onSpriteUpdate);this._container.removeChild(e.getDisplayObject());t.splice(i,1);this.setDirty(true);return true}return false}_getOrientatedStageSize(){const e=this._sdk.getSprite().getTexture().getFrame();const t=this._sdk.getOperationsStack().getByIdentifier("orientation");if(t){const r=t?t.getRotation():0;const o=r===270||r===90;return o?new Zp(e.height,e.width):new Zp(e.width,e.height)}const i=this._sdk.getOperationsStack().getByIdentifier("output");if(i){return i.getOutputResolution()}return new Zp(e.width,e.height)}_render(e){const t=this._container;const{sprites:i}=this._options;const r=e.getDimensions().clone().floor();let o=new T.Container;o.addChild(this._sprite);return Promise.all(i.map(n=>n.validateSettings())).then(()=>{i.forEach(n=>n.update(this._sdk,r))}).then(()=>{this._renderTexture.clear();i.forEach(n=>{if(n.getInverted&&n.getInverted()){this._renderTexture.render(o);this._renderTexture.render(this._renderMaskedSprite(n.getDisplayObject(),n.getColor?n.getColor():E.WHITE,n.getPadding?n.getPadding():-1));o=new T.Container}else{o.addChild(n.getDisplayObject())}});this._renderTexture.render(o);t.addChild(this._sprite);i.forEach(n=>t.addChild(n.getDisplayObject()))})}_renderMaskedSprite(e,t,i){const r=this._maskCanvas;const o=e.getWorldTransform();const n=this._getOrientatedStageSize();R.ensureCanvasDimensions(r,n);const a=r.getContext("2d");a.clearRect(0,0,r.width,r.height);a.save();a.fillStyle=t.toRGBA();if(i<0){a.fillRect(0,0,n.x,n.y)}else{const c=Math.abs(e.getWidth()/e.getScale().x);const h=Math.abs(e.getHeight()/e.getScale().y);const m=c*i;a.transform(o.a,o.b,o.c,o.d,o.tx,o.ty);a.fillRect(-m,-m,c+m*2,h+m*2)}a.restore();a.save();a.globalCompositeOperation="destination-out";e._renderCanvas({getCurrentRenderTarget:()=>{return{getPixelRatio:()=>1}},beforeDraw:c=>{const h=e.getWidth();const m=e.getHeight();const d=e.getScale();const f=d.x<0;const b=d.y<0;c.translate(h,m);c.scale(f?-1:1,b?-1:1);c.translate(-h,-m)},getContext:()=>a});a.restore();const l=new T.Container;const u=new T.Sprite(T.Texture.fromCanvas(r));l.addChild(u);return l}takeSpriteToFront(e){const{sprites:t}=this._options;const i=t.indexOf(e);if(i===-1)return;R.moveArrayItem(t,i,t.length-1);const r=e.getDisplayObject();this._container.removeChild(r);this._container.addChild(r);this.setDirty(true)}getSpritesAtPosition(e,t){const i=[];this._options.sprites.forEach(c=>c.update(this._sdk,t));const r=this._sdk.getSprite();const o=r.getWorldTransform().applyInverseToVector(e);const{width:n,height:a}=r.getTexture().getFrame();const l=r.getAnchor().clone().multiply(-n,-a);o.subtract(l);const u=this._options.sprites.slice(0).reverse();for(let c=0,h=u.length;c<h;c++){const m=u[c];if(m.getHitTestDisplayObject().isAtPosition(o)){i.push(m)}}return i}setDirtyForRenderer(e,t,i){super.setDirtyForRenderer(e,t,i);this._options.sprites.forEach(r=>{r.setDirtyForRenderer(e,t,i)})}dispose(){super.dispose();this._options.sprites.forEach(e=>{e.dispose()})}};$i.StickerSprite=yu;$i.TextSprite=Zu;$i.BrushSprite=hs;$i.TextDesignSprite=Ju;$i.identifier="sprite";$i.prototype.availableOptions={sprites:{type:p.ARRAY,default:[],setter(s,e){s=s.map((t,i)=>{if(t instanceof yi){return t}const r={...t};delete r.type;switch(t.type){case"text":return new Zu(this,r);case"sticker":return new yu(this,r);case"brush":return new hs(this,r);case"textdesign":return new Ju(this,r);default:{P.error(this.constructor.name,`Invalid sprite type: ${t.type}`);return null}}});if(!e){if(this._options.sprites){const t=this._options.sprites.slice();t.forEach(i=>{i.dispose();this.removeSprite(i)})}s.forEach(t=>{this.addSprite(t)})}return s}},smoothDownscaling:{type:p.BOOLEAN,default:false}};q.Operations.SpriteOperation=$i;aw=$i});var uw,cw,mw;var dw=_(()=>{F();({Vector2:uw}=M);cw=class{constructor(e,t){this._options=t;this._oldOptions={start:e.getStart().clone(),end:e.getEnd().clone(),rotation:e.getRotation(),textureScale:e.getTextureScale()};this._inputDimensions=e.getInputDimensions(false);this._rotationDelta=t.rotation-e.getRotation();this._deltaCos=Math.cos(this._rotationDelta);this._deltaSin=Math.sin(this._rotationDelta);this._oldAbsoluteSize=this._oldOptions.end.clone().subtract(this._oldOptions.start).multiply(this._inputDimensions);this._newAbsoluteSize=t.end.clone().subtract(t.start).multiply(this._inputDimensions);this._absoluteStartDiff=this._oldOptions.start.clone().subtract(t.start).multiply(this._inputDimensions);this._scaleRatio=e.calculateScale(t.rotation)/e.calculateScale();this._sizeFactor=this._newAbsoluteSize.clone().divide(this._oldAbsoluteSize);this._textureScaleFactor=this._options.textureScale/e.getTextureScale()}applyToRelativePoint(e){const t=this._oldOptions.start;const i=this._oldOptions.end;const r=t.clone().add(i.clone().subtract(t).divide(2));const o=r.multiply(this._inputDimensions);const n=e.clone().multiply(this._oldAbsoluteSize).subtract(this._oldAbsoluteSize.clone().divide(2));const a=o.clone().add(n);const l=a.clone().subtract(this._inputDimensions.clone().divide(2));const u=new uw(l.x*this._deltaCos-l.y*this._deltaSin,l.x*this._deltaSin+l.y*this._deltaCos);const c=this._inputDimensions.clone().divide(2).add(u);const h=this._options.start.clone().multiply(this._inputDimensions);return c.clone().subtract(h).divide(this._newAbsoluteSize)}applyToRelativeSize(e){return e*this._oldAbsoluteSize.min()/this._newAbsoluteSize.min()}applyToDimensions(e){e=e.clone().multiply(this._scaleRatio);if(this._options.textureScale){e.multiply(this._textureScaleFactor)}return e}scaleSize(e,t="y"){return e/this._sizeFactor[t]}applyToRotation(e){return(e+this._rotationDelta)%(Math.PI*2)}invert(){const e=this._options.start.clone();const t=this._options.end.clone();const i=this._inputDimensions;const r=-this._rotationDelta;const o=Math.cos(r);const n=Math.sin(r);const a=this._oldAbsoluteSize;const l=this._newAbsoluteSize;const u=e.clone().subtract(t).multiply(i);const c=1/this._scaleRatio;const h=new uw(1/this._sizeFactor.x,1/this._sizeFactor.y);const m=1/this._textureScaleFactor;const d=this._oldOptions;this._oldOptions=this._options;this._options=d;this._inputDimensions=i;this._rotationDelta=r;this._deltaCos=o;this._deltaSin=n;this._oldAbsoluteSize=l;this._newAbsoluteSize=a;this._absoluteStartDiff=u;this._scaleRatio=c;this._sizeFactor=h;this._textureScaleFactor=m;return this}};mw=cw});var Qp,nn,pw;var hw=_(()=>{F();dw();({Vector2:Qp}=M);nn=class extends le{_render(e){this._sprite.setRotation(0);const t=e.getDimensions();const{start:i,end:r,rotation:o,textureScale:n}=this._options;const a=r.clone().subtract(i);const l=a.clone().divide(2);const u=i.clone().add(l);const c=this.calculateScale();const h=c*n;const m=t.clone().multiply(h).multiply(l);this._sprite.setAnchor(u);this._sprite.setRotation(o);this._sprite.setScale(h,h);this._sprite.setPosition(m);this._renderTexture.render(this._container);return Promise.resolve()}calculateScale(e=this._options.rotation){const t=this.getInputDimensions(false);const i=new Qp(Math.abs(t.x*Math.cos(e))+Math.abs(t.y*Math.sin(e)),Math.abs(t.x*Math.sin(e))+Math.abs(t.y*Math.cos(e)));const r=t.clone().subtract(i.clone()).divide(2).abs();let o=1;if(r.y>r.x){o=r.y*2/t.y+1}else{o=r.x*2/t.x+1}return o}getNewDimensions(e){const{start:t,end:i,textureScale:r}=this._options;const o=this.calculateScale();const n=e.clone().multiply(r*o).multiply(i.clone().subtract(t));return n.round()}flip(e){const{start:t,end:i}=this._options;const r=t.clone();if(e==="horizontal"){t.set(1-i.x,t.y);i.set(1-r.x,i.y)}else if(e==="vertical"){t.set(t.x,1-i.y);i.set(i.x,1-r.y)}}rotate(e){const{start:t,end:i}=this._options;const r=(e+360)%360;const o=Math.floor(r/90);for(let n=0;n<o;n++){const a=t.clone();t.set(1-i.y,a.x);i.set(1-a.y,i.x)}}_onBeforeExport(){this._wasEnabledBeforeExport=this.getEnabled();this.setEnabled(true)}_onAfterExport(){this.setEnabled(this._wasEnabledBeforeExport,true)}};nn.identifier="transform";nn.prototype.availableOptions={start:{type:p.VECTOR2,default:new Qp(0,0)},end:{type:p.VECTOR2,default:new Qp(1,1)},textureScale:{type:p.NUMBER,default:1},rotation:{type:p.NUMBER,default:0}};nn.TransformChange=mw;q.Operations.TransformOperation=nn;pw=nn});var wa,fw;var gw=_(()=>{xe();F();us();wa=class extends le{constructor(...e){super(...e);this._watermarkImage=null;this._watermarkTexture=null;this._loadWatermarkImage=()=>{if(!this._watermarkImage){if(!(this._options.watermarkURI instanceof window.Image)){const e={value:this._options.crossOrigin,cors:true};return ut.loadImage(this._options.watermarkURI,e).then(t=>{this._watermarkImage=t})}this._watermarkImage=this._options.watermarkURI}return Promise.resolve()};this._setWatermarkalignment=(e,t)=>{const i=Math.min(t.x,t.y)*R.clamp(this._options.inset,0,1);switch(this._options.alignment){case"center":this._watermarkSprite.setPosition(new L(t.x-e.x,t.y-e.y).divide(2));break;case"top-left":this._watermarkSprite.setPosition(new L(i,i));break;case"top-right":this._watermarkSprite.setPosition(new L(t.x-e.x-i,i));break;case"bottom-left":this._watermarkSprite.setPosition(new L(i,t.y-e.y-i));break;case"bottom-right":this._watermarkSprite.setPosition(new L(t.x-e.x-i,t.y-e.y-i));break;default:this._watermarkSprite.setPosition(new L(0,0));break}};this._watermarkSprite=new T.Sprite;this._watermarkSprite.setAnchor(0,0);this._container.addChild(this._watermarkSprite)}_render(e){const{alpha:t,size:i}=this._options;return this._loadWatermarkImage().then(()=>{if(this._watermarkImage){if(!this._watermarkTexture){this._watermarkTexture=T.Texture.fromImage(this._watermarkImage);this._watermarkSprite.setTexture(this._watermarkTexture)}const r=e.getDimensions();const{width:o,height:n}=this._watermarkImage;const a=R.resizeVectorToFit(new L(o,n),r.clone().multiply(R.clamp(i,0,1)));this._setWatermarkalignment(a,r);this._watermarkSprite.setWidth(a.x);this._watermarkSprite.setHeight(a.y);this._watermarkSprite.setAlpha(t);if(this._renderTexture){this._renderTexture.render(this._container)}}return Promise.resolve()})}dispose(){super.dispose();this._watermarkSprite.dispose()}};wa.identifier="watermark";wa.prototype.availableOptions={watermarkURI:{type:p.STRING,required:true},alignment:{type:p.STRING,default:"top-right"},inset:{type:p.NUMBER,default:"0.05"},size:{type:p.NUMBER,default:"0.2"},alpha:{type:p.NUMBER,default:1},crossOrigin:{type:p.STRING,default:"anonymous"}};q.Operations.WatermarkOperation=wa;fw=wa});var uS;var _w=_(()=>{F();zy();Vy();u0();m0();p0();x0();k0();F0();A0();P0();L0();W0();tv();lw();hw();gw();uS=[Ly,Wy,l0,d0,b0,D0,S0,O0,M0,G0,ev,aw,pw,fw,I0,c0];q.AllOperations=uS});var Di=_(()=>{_w();oa();oa()});var yw;var bw=_(()=>{yw=[{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:true,textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}}]},{fontFamily:"Aleo",variations:[{identifier:"imgly_font_aleo_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_aleo_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:805,descender:-195}}]},{fontFamily:"Amatic SC",variations:[{identifier:"imgly_font_amaticsc",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_amaticsc.woff",textMetrics:{unitsPerEm:1e3,ascender:1016,descender:-245}}]},{fontFamily:"Archivo",variations:[{identifier:"imgly_font_archivo_black",fontWeight:"normal",filePath:"fonts/imgly_font_archivo_black.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:878,descender:-210}}]},{fontFamily:"Bungee Inline",variations:[{identifier:"imgly_font_bungee_inline",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_bungee_inline.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}}]},{fontFamily:"Campton Book",variations:[{identifier:"imgly_font_campton_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_campton_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}}]},{fontFamily:"Carter",variations:[{identifier:"imgly_font_carter_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_carter_one.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2264,descender:-890}}]},{fontFamily:"Codystar",variations:[{identifier:"imgly_font_codystar",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_codystar.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:953,descender:-255}}]},{fontFamily:"Fira Sans",variations:[{identifier:"imgly_font_fira_sans_regular",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_fira_sans_regular.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:935,descender:-265}}]},{fontFamily:"Galano Grotesque",variations:[{identifier:"imgly_font_galano_grotesque_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_galano_grotesque_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Krona One",variations:[{identifier:"imgly_font_krona_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_krona_one.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2030,descender:-530}}]},{fontFamily:"Kumar One Outline",variations:[{identifier:"imgly_font_kumar_one_outline",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_kumar_one_outline.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1137,descender:-642}}]},{fontFamily:"Lobster",variations:[{identifier:"imgly_font_lobster",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_lobster.woff",textMetrics:{unitsPerEm:1e3,ascender:1e3,descender:-250}}]},{fontFamily:"Molle",variations:[{identifier:"imgly_font_molle",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_molle.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1852,descender:-701}}]},{fontFamily:"Monoton",variations:[{identifier:"imgly_font_monoton",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_monoton.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2366,descender:-822}}]},{fontFamily:"Nixie One",variations:[{identifier:"imgly_font_nixie_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_nixie_one.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:926,descender:-210}}]},{fontFamily:"Notable",variations:[{identifier:"imgly_font_notable",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_notable.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1143,descender:-157}}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}}]},{fontFamily:"Oswald SemiBold",variations:[{identifier:"imgly_font_oswald_semi_bold",fontWeight:600,fontStyle:"normal",filePath:"fonts/imgly_font_oswald_semi_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1193,descender:-289}}]},{fontFamily:"Palanquin Dark SemiBold",variations:[{identifier:"imgly_font_palanquin_dark_semi_bold",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_palanquin_dark_semi_bold.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1320,descender:-491}}]},{fontFamily:"Poppins",variations:[{identifier:"imgly_font_poppins",fontWeight:"bold",fontStyle:"normal",filePath:"fonts/imgly_font_poppins.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:1050,descender:-350}}]},{fontFamily:"Permanent Marker",variations:[{identifier:"imgly_font_permanent_marker",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_permanent_marker.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}}]},{fontFamily:"Roboto Black",variations:[{identifier:"imgly_font_roboto_black_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_black_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Roboto Light",variations:[{identifier:"imgly_font_roboto_light_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_light_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Sancreek",variations:[{identifier:"imgly_font_sancreek",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_sancreek.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:2104,descender:-738}}]},{fontFamily:"Stint Ultra Expanded",variations:[{identifier:"imgly_font_stint_ultra_expanded",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_stint_ultra_expanded.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1853,descender:-483}}]},{fontFamily:"Trashhand",variations:[{identifier:"imgly_font_trash_hand",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_trash_hand.woff",textMetrics:{unitsPerEm:1e3,ascender:759,descender:-304}}]},{fontFamily:"VT323",variations:[{identifier:"imgly_font_vt323",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_vt323.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Yeseva One",variations:[{identifier:"imgly_font_yeseva_one",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_yeseva_one.woff",provider:"file",textMetrics:{unitsPerEm:1e3,ascender:915,descender:-240}}]}]});var xw;var vw=_(()=>{xw=[{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:true,textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}}]},{fontFamily:"Abril Fatface",variations:[{identifier:"imgly_font_abril_fatface_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_abril_fatface_regular.woff",textMetrics:{unitsPerEm:1e3,ascender:1058,descender:-291}}]},{fontFamily:"Amberlight",variations:[{identifier:"imgly_font_amberlight",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_amberlight.woff",default:true,textMetrics:{unitsPerEm:1e3,ascender:750,descender:-250}}]},{fontFamily:"Bungee Inline",variations:[{identifier:"imgly_font_bungee_inline",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_bungee_inline.woff",default:true,textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}}]},{fontFamily:"Campton Book",variations:[{identifier:"imgly_font_campton_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_campton_bold.woff",default:true,textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}}]},{fontFamily:"Galano Grotesque",variations:[{identifier:"imgly_font_galano_grotesque_bold",fontWeight:"bold",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_galano_grotesque_bold.woff",default:true,textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}}]},{fontFamily:"Handycheera",variations:[{identifier:"imgly_font_handycheera_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_handycheera_regular.woff",default:true,textMetrics:{unitsPerEm:2048,ascender:2199,descender:-808}}]},{fontFamily:"Montserrat Light",variations:[{identifier:"imgly_font_montserrat_light",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_montserrat_light.woff",textMetrics:{unitsPerEm:1e3,ascender:968,descender:-251}}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_heavy",fontWeight:900,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_heavy.woff",textMetrics:{unitsPerEm:1e3,ascender:674,descender:0}}]},{fontFamily:"Permanent Marker",variations:[{identifier:"imgly_font_permanent_marker",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_permanent_marker.woff",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}}]},{fontFamily:"Petit Formal Script",variations:[{identifier:"imgly_font_petit_formal_script",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_petit_formal_script.woff",default:true,textMetrics:{unitsPerEm:2048,ascender:2033,descender:-527}}]},{fontFamily:"Rasa",variations:[{identifier:"imgly_font_rasa_regular",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_rasa_regular.woff",default:true,textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_rasa_500",fontWeight:500,fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_rasa_500.woff",default:true,textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}}]},{fontFamily:"Roboto Black",variations:[{identifier:"imgly_font_roboto_black",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_roboto_black.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_black_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_black_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Roboto Light",variations:[{identifier:"imgly_font_roboto_light",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_roboto_light.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light_italic",fontWeight:"normal",fontStyle:"italic",filePath:"fonts/imgly_font_roboto_light_italic.woff",provider:"file",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}}]},{fontFamily:"Sue Ellen Francisco",variations:[{identifier:"imgly_font_sue_ellen_francisco",fontWeight:"normal",fontStyle:"normal",filePath:"fonts/imgly_font_sue_ellen_francisco.woff",provider:"file",textMetrics:{unitsPerEm:1024,ascender:1362,descender:-634}}]},{fontFamily:"Ultra",variations:[{identifier:"imgly_font_ultra",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_ultra.woff",default:true,textMetrics:{unitsPerEm:2048,ascender:2066,descender:-561}}]},{fontFamily:"Wolesbro",variations:[{identifier:"imgly_font_wolesbro",fontWeight:"normal",fontStyle:"normal",provider:"file",filePath:"fonts/imgly_font_wolesbro.woff",textMetrics:{unitsPerEm:1e3,ascender:925,descender:-575}}]}]});var ww;var Cw=_(()=>{ww=[{identifier:"imgly_transforms_common",defaultName:"Common Ratios",ratios:[{identifier:"imgly_transform_common_custom",defaultName:"Custom",ratio:"*",selected:true},{identifier:"imgly_transform_common_square",defaultName:"Square",ratio:1},{identifier:"imgly_transform_common_4-3",defaultName:"4:3",ratio:4/3},{identifier:"imgly_transform_common_16-9",defaultName:"16:9",ratio:16/9}]},{identifier:"imgly_transforms_facebook",defaultName:"Facebook",ratios:[{identifier:"imgly_transform_facebook_profile",defaultName:"Profile Pic",dimensions:{x:300,y:300},forceDimensions:false,lockDimensions:true},{identifier:"imgly_transform_facebook_ad",defaultName:"Ad",dimensions:{x:1200,y:627}},{identifier:"imgly_transform_facebook_post",defaultName:"Post",dimensions:{x:940,y:788}},{identifier:"imgly_transform_facebook_cover",defaultName:"Cover",dimensions:{x:851,y:315}}]}]});var Dw,kw;var Tw=_(()=>{Di();bw();vw();Cw();Dw=[];if(typeof q.Operations.SpriteOperation!=="undefined"){Dw.push(q.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush)}kw={TRANSFORM_RATIO_CATEGORIES:ww,FONTS:yw,TEXT_DESIGN_FONTS:xw,BRUSHES:Dw}});var cS,Rw;var Ew=_(()=>{Zn();cS={...Io,LOAD:"load",SAVE:"save",EDITOR_RESIZE:"editor:resize",ZOOM:"editor:zoom",ZOOM_CHANGED:"editor:zoom_changed",HISTORY_REDO:"history:redo",HISTORY_BEFORE_REDO:"history:before-redo",TEXT_SCALED:"editor:text:scaled",TRANSFORM_RESIZE:"transform:resize",TRANSFORM_AFTER_EDIT:"transform:after-edit",ADDED_STICKER:"sticker:added-sticker",SPRITES_DESELECTED:"editor:sprite:deselected-all",CANVAS_FOCUS:"canvas:focus"};Rw=cS});var Te;var Sw=_(()=>{Tw();Ew();Te={EVENTS:Rw,DEFAULTS:kw}});function mS(){const{userAgent:s,appVersion:e}=navigator;if(e.indexOf("MSIE")!==-1){return e.match(/MSIE\s+?([0-9]+)/i)[1]}if(s.indexOf("Trident")!==-1){return s.match(/rv:([0-9]+)/i)[1]}return false}var Fw;var Ow=_(()=>{Fw={getIEVersion:mS}});var dS,Qu,pS,yt;var Aw=_(()=>{Di();Co();ti();ei();Ow();dS=q.Utils;({Vector2:Qu}=q.Math);pS={getInnerDimensionsForElement(s){const e=new Qu(s.offsetWidth,s.offsetHeight);const t=window.getComputedStyle(s,null);e.x-=parseInt(t.getPropertyValue("padding-left"),10);e.x-=parseInt(t.getPropertyValue("padding-right"),10);e.y-=parseInt(t.getPropertyValue("padding-top"),10);e.y-=parseInt(t.getPropertyValue("padding-bottom"),10);return e},getEventPosition(s){let e=s.clientX;let t=s.clientY;if(s.type.indexOf("touch")!==-1){if(!s.touches.length)return;e=s.touches[0].clientX;t=s.touches[0].clientY}return new Qu(e,t)},createTransparentPatternCanvas(){const s=document.createElement("canvas");const e=s.getContext("2d");s.width=10;s.height=10;e.fillStyle="white";e.fillRect(0,0,s.width,s.height);e.fillStyle="#cccccc";e.fillRect(0,0,s.width/2,s.height/2);e.fillRect(s.width/2,s.height/2,s.width,s.height);return s},supportsMSBlob(){const s=document.createElement("canvas");const e=typeof s.msToBlob!=="undefined";ke(s);return e},translate(s,e,t={}){let i=this.fetch(s,e);if(!i){P.info("Utils#translate",`Unable to translate \`${e}\``);return null}for(const r in t){i=i.replace(`\${${r}}`,t[r])}return i},fetch(s,e,t){e=e.replace(/\[(\w+)]/g,".$1");e=e.replace(/^\./,"");const i=e.split(".");for(let r=0;r<i.length;r++){const o=i[r];s=s[o];if(!s){break}}if(typeof s==="undefined"){return false}return s},isMobile(){const s=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(s)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(s.substr(0,4))},select(s,e,t=null){if(!t)t=r=>r;const i=[];e.forEach(r=>{s.forEach(o=>{const n=t(o);if(n===r){i.push(o)}})});return i},getJSONP(s){const e=new Nt(s);return e.load()},cloneCategories(s,e){return s.map(t=>{t=dS.clone(t);t[e]=t[e].slice(0);return t})},mergeCategories(s,e,t){s=this.cloneCategories(s,t);let i=null;e.forEach(r=>{s.forEach(o=>{if(r.identifier===o.identifier){i=o}});if(!i){s.push(r)}else{i[t]=i[t].concat(r[t])}});return s},wrapFiltersInCategories(s,e){return s.map(t=>{let i=t;if(!(e in i)){i={identifier:`imgly_filters_wrapped-${t.identifier}`,displayFlat:true,[e]:[t]}}return i})},getStyleObject(s){const e=window.getComputedStyle(s);const t={};for(const i in e){const r=e.getPropertyValue(i);const o=i.replace(/-([a-z])/g,(n,a)=>a.toUpperCase());if(r!==""){t[o]=r}}return t},styleElement(s,e){for(const t in e){s.style[t]=e[t]}},debounce(s,e,t){let i;return function(...r){const o=()=>{i=null;if(!t)s.apply(this,r)};const n=t&&!i;clearTimeout(i);i=setTimeout(o,e);if(n)s.apply(this,r)}},getScrollbarWidth(){const s=document.createElement("div");s.style.visibility="hidden";s.style.width="100px";s.style.msOverflowStyle="scrollbar";document.body.appendChild(s);const e=s.offsetWidth;s.style.overflow="scroll";const t=document.createElement("div");t.style.width="100%";s.appendChild(t);const i=t.offsetWidth;s.parentNode.removeChild(s);return e-i},findIntegerFraction(s,e=100){let t=Number.MAX_VALUE;let i=0;let r=0;let o=1;let n=1;for(let a=0;a<e;a++){const l=o/n-s;if(l<0){o++}else if(l>0){n++}else{return new Qu(o,n)}const u=Math.abs(o/n-s);if(u<t){t=u;i=o;r=n}}return new Qu(i,r)},toFixed(s,e=2){const t=s.toFixed(e);return parseFloat(t)},capitalize(s){return s.charAt(0).toUpperCase()+s.slice(1)},flipObject(s){const e={};for(const t in s){e[s[t]]=t}return e},Browser:Fw};yt=pS});var eh,ue,EX,Ca,ge,Br,th,N,oe,SX,FX,OX;var xe=_(()=>{Di();Zn();xo();ti();Sw();Aw();({Base64:eh}=q);({Color:ue}=q);({ColorMatrix:EX}=q.Math);({EventEmitter:Ca}=q);ge=q.Utils;({RenderType:Br}=q);({ImageFormat:th}=q);N=q;({Vector2:oe}=q.Math);({Rectangle:SX}=q.Math);({Range:FX}=q.Math);OX=typeof window!=="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):jn()});var an,Rs;var ih=_(()=>{xe();an=class{constructor(e,t,i=false){this._ui=e;this._options=t;this._categoriesById={};this._filtersByIdentifier={identity:N.Operations.FilterOperation.Filters.IdentityFilter};this._categories=yt.wrapFiltersInCategories(Wi.DEFAULTS.FILTERS.slice(0),an.CATEGORY_ITEMS_PROPERTY);this._customAssetsAllowed=i||e.getEditor().getSDK()._l.areCustomAssetsAllowed();if(this._customAssetsAllowed&&this._options.categories){this._options.categories=yt.wrapFiltersInCategories(this._options.categories,an.CATEGORY_ITEMS_PROPERTY)}this._initCategories()}instantiateFilterWithIdentifier(e){const t={value:this._ui._options.crossOrigin,cors:true};const i=this.getFilterByIdentifier(e);if(!i){return Promise.reject(new Error(`Unknown filter with identifier \`${e}\`!`))}if(!(i.prototype instanceof N.Operations.FilterOperation.Filter)){const{lutImage:r,resolution:o,horizontalTileCount:n,verticalTileCount:a}=i;let{lightColor:l,darkColor:u}=i;if(l&&u){l=ue.fromHex(l);u=ue.fromHex(u);return Promise.resolve(new N.Operations.FilterOperation.Filters.DuoToneFilter({lightColor:l,darkColor:u}))}let c;if(this._ui.getPreloader){c=this._ui.getPreloader().getAsset(r)}let h;if(c){h=Promise.resolve(c)}else{h=ut.loadImage(this._ui.getAssetPath(r),t)}return h.then(()=>{return ut.loadImage(this._ui.getAssetPath(r),t).then(m=>{return new N.Operations.FilterOperation.Filters.ThreeDLUTFilter({image:m,resolution:o,horizontalTileCount:n,verticalTileCount:a})})})}return Promise.resolve(new i)}_initCategories(){if(this._customAssetsAllowed&&this._options.categories){if(this._options.replaceCategories){this._categories=yt.wrapFiltersInCategories(this._options.categories,an.CATEGORY_ITEMS_PROPERTY)}else{this._categories=yt.mergeCategories(this._categories,this._options.categories,an.CATEGORY_ITEMS_PROPERTY)}}if(this._customAssetsAllowed&&this._options.availableFilters){const t=[];this._categories.forEach(i=>{const r=i.filters.filter(o=>this._options.availableFilters.indexOf(o.identifier)!==-1);if(r.length>0){t.push({identifier:i.identifier,defaultName:i.defaultName,filters:r})}});this._categories=t}const e={identifier:"all",defaultName:"All",visible:false,filters:this._categories.length<=0?[]:this._categories.map(t=>t.filters).reduce((t,i)=>t.concat(i))};this._categories.unshift(e);this._categoriesById.all=e;this._categories.forEach(t=>{this._categoriesById[t.identifier]=t});e.filters.forEach(t=>{this._filtersByIdentifier[t.identifier]=t})}getFiltersForCategory(e){if(!this._categoriesById[e]){throw new Error(`Unknown filter category '${e}'`)}return this._categoriesById[e].filters}getItemsByCategory(e){return this.getFiltersForCategory(e)}getFilterByIdentifier(e){return this._filtersByIdentifier[e]}getCategories(){return this._categories}getCategoryByIdentifier(e){return this._categoriesById[e]}};Rs=an;I(Rs,"CATEGORY_ITEMS_PROPERTY","filters")});var Da;var Iw=_(()=>{Di();Da=class extends X{};Da.prototype.availableOptions={fontFamily:{type:p.STRING,required:true},variations:{type:p.ARRAY,required:true}}});var hS,Es;var rh=_(()=>{Di();hS={100:"Extra Light",200:"Light",300:"Book",400:"Regular",500:"Medium",600:"Semibold",700:"Bold",800:"Black",900:"Extra Black",bold:"Bold",normal:"Regular"};Es=class extends X{getLabel(){let e=hS[this._options.fontWeight];switch(this._options.fontStyle){case"italic":e+=" Italic";break}return e}};Es.prototype.availableOptions={identifier:{type:p.STRING,required:true},fontFamily:{type:p.STRING,required:true},fontWeight:{type:p.ALL,default:400},fontStyle:{type:p.STRING,default:"normal"},textMetrics:{type:p.OBJECT,default:null},provider:{type:p.STRING,available:["google","file"]},filePath:{type:p.STRING},default:{type:p.BOOLEAN,default:false},font:{type:p.OBJECT}}});var at;var Mr=_(()=>{xe();Iw();rh();ti();lm();at=class{constructor(e,t){this._ui=e;this._options=t;this._fonts=[];this._variationsByIdentifier={};this._fontsByFontFamily={};this._initFonts()}_initFonts(){const{fonts:e,replaceFonts:t,availableVariations:i,isTextDesign:r}=this._options;let o=true;if(true){o=this._ui.getEditor().getSDK()._l.areCustomAssetsAllowed()}if(e&&o){e.forEach(({variations:l},u)=>{if(l){l.forEach((c,h)=>{if(Bi[c.identifier]){const m=fo(c.identifier,true);e[u].variations[h].identifier=m;const{fontFamily:d}=Te.DEFAULTS.FONTS.find(f=>f.variations.some(b=>b.identifier===m));e[u].fontFamily=d}})}})}let n=r?Te.DEFAULTS.TEXT_DESIGN_FONTS:Te.DEFAULTS.FONTS;if(o){if(t){n=e}else{n=n.concat(e||[])}}let a;n=n.map(l=>{const{fontFamily:u}=l;let{variations:c}=l;if(o&&i){c=c.filter(m=>i.indexOf(m.identifier)!==-1)}if(c.length===0)return null;const h=new Da({fontFamily:u});c=c.map(m=>{const d=new Es(m);d.setFontFamily(u);d.setFont(h);if(m.default&&!a){a=d}if(d.getTextMetrics()==null){P.warn(`Missing font metrics for ${d.getIdentifier()}. The SDK will fall back to basic font rendering, which may lead to layout issues. Please provide font metrics for your custom fonts. See https://docs.photoeditorsdk.com/guides/html5/ for more details.`)}this._variationsByIdentifier[d.getIdentifier()]=d;return d});h.setVariations(c);this._fontsByFontFamily[u]=h;return h}).filter(l=>l);if(!a){[a]=n[0].getVariations()}this._defaultVariation=a;this._fonts=n}getFonts(){return this._fonts}getFontByFontFamily(e){return this._fontsByFontFamily[e]}getVariationByIdentifier(e){return this._variationsByIdentifier[fo(e)]}getVariationsByIdentifier(){return{...this._variationsByIdentifier}}getDefaultVariation(){return this._defaultVariation}}});var Xt;var ln=_(()=>{xe();Xt=class{constructor(e,t={}){this._ui=e;this._options=t;this._defaultLayouts=N.Operations.SpriteOperation.TextDesignSprite.Layouts;this._legacyLayouts=N.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts;this._layouts=[];this._init()}_init(){const{availableLayouts:e}=this._options;const t={...this._defaultLayouts,...this._legacyLayouts};this._layouts=Object.keys(t).map(i=>({identifier:t[i].identifier,layout:t[i]}));if(e){e.push(...Object.values(this._legacyLayouts).map(i=>i.identifier));this._layouts=this._layouts.filter(i=>e.indexOf(i.identifier)>=0)}}getLayoutByIdentifier(e){const t=ge.Array.find(this._layouts,i=>i.identifier===e);return t&&t.layout}getLayouts(){return[...this._layouts]}getDefaultLayout(){return this.getLayouts()[0]}}});var fS,gS,ka;var Pw=_(()=>{rh();fS=30;gS="abcdefghijklmnopqrstuvwxzy";ka=class{constructor(e){this._fontVariation=e||new Es({fontFamily:"Times New Roman",fontWeight:"normal",fontStyle:"normal"});this._createRuler()}_createRuler(){this._ruler=document.createElement("div");this._ruler.innerText=gS;document.body.appendChild(this._ruler);this._setRulerStyle()}_setRulerStyle(){this._ruler.style.cssText=`
      position: absolute;
      top: -9999px;
      left: -9999px;
      opacity: 0;
      display: inline-block;
      font: ${this._fontVariation.getFontStyle()} ${this._fontVariation.getFontWeight()} ${fS}px ${this._fontVariation.getFontFamily()};
    `}setFontVariation(e){this._fontVariation=e;this._setRulerStyle()}getWidth(){return!this._ruler?-1:this._ruler.offsetWidth}dispose(){if(this._ruler){this._ruler.parentNode.removeChild(this._ruler);this._ruler=null}}}});var Bw,_S,yS,rc;var Mw=_(()=>{Pw();Bw=typeof window!=="undefined"&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):jn();_S=50;yS=5e3;rc=class{constructor(e){this._fontVariation=e;this._defaultFontRuler=new ka;this._customFontRuler=new ka(this._fontVariation)}observe(){const e=Bw();return new Promise((t,i)=>{const r=window.setInterval(()=>{const o=this._defaultFontRuler.getWidth()!==this._customFontRuler.getWidth();if(o){window.clearInterval(r);return t()}if(Bw()-e>=yS){const n=new Error(`Failed to load font ${this._fontVariation.getFontFamily()}.`);n.font=this._fontVariation;return i(n)}},_S)})}dispose(){this._defaultFontRuler.dispose();this._customFontRuler.dispose()}}});var un;var sh=_(()=>{Di();Mw();un=class{constructor(e){this._ui=e;this._fonts=[];this._observers=[]}add(e){this._fonts.push(e)}load(){if(this._fonts.length===0){return Promise.resolve()}this._observers=[];this._fonts.forEach(e=>{this._observers.push(new rc(e))});return R.executePromises(this._observers.map(e=>e.observe()))}dispose(){this._observers.forEach(e=>e.dispose())}}});var sc;var Lw=_(()=>{sh();sc=class extends un{load(){return Promise.resolve()}}});var bS,oc;var zw=_(()=>{sh();bS={italic:"i"};oc=class extends un{load(){if(this._fonts.length){this._addStylesheetTag()}return super.load()}_addStylesheetTag(){const e=this._getFamiliesString();const t=document.createElement("link");t.rel="stylesheet";t.href=`https://fonts.googleapis.com/css?family=${e}`;const i=document.getElementsByTagName("head")[0];i.appendChild(t)}_getFamiliesString(){const e={};this._fonts.forEach(i=>{const r=i.getFontFamily();const o=i.getFontStyle();const n=i.getFontWeight();e[r]=e[r]||[];if(typeof n!=="undefined"){e[r].push(`${n}${bS[o]||""}`)}else{e[r].push(400)}});const t=[];for(const i in e){const r=e[i];const o=r.length?`:${r.join(",")}`:"";const n=i.replace(" ","+")+o;t.push(n)}return t.join("|")}}});var Lr;var nc=_(()=>{Lw();zw();Lr=class{constructor(e,t){this._ui=e;this._fonts=t;this._loadedFonts=[]}setFonts(e){this._fonts=e}needsToLoad(){for(let e=0;e<this._fonts.length;e++){let t;this._fonts[e].getVariations().forEach(i=>{t=t||i.getProvider()});if(!t)continue;return true}}fontLoaded(e){const t=e.getFontFamily();return this._loadedFonts.indexOf(t)!==-1}setFontLoaded(e){if(!this.fontLoaded(e)){const t=e.getFontFamily();this._loadedFonts.push(t)}}load(){const e=this._fonts;const t={google:new oc(this._ui),file:new sc(this._ui)};const i=()=>{for(const o in t){const n=t[o];n.dispose()}};e.filter(o=>!this.fontLoaded(o)).forEach(o=>{o.getVariations().forEach(n=>{const a=n.getProvider();if(!a)return;const l=t[a];l.add(n)})});const r=[];for(const o in t){r.push(t[o].load())}return Promise.all(r).then(()=>{i();e.forEach(o=>{this.setFontLoaded(o)})}).catch(o=>{i();throw o})}}});var ac;var Uw=_(()=>{xe();ac=class{constructor(e,t){this._ui=e;this._options=t;this._brushes=[];this._brushesById={};this._addBrushes(Te.DEFAULTS.BRUSHES);const{brushes:i,replaceBrushes:r,availableBrushes:o}=this._options;if(this._options.brushes){this._addBrushes(i,r)}if(o){this._brushes=this._brushes.filter(n=>o.indexOf(n.identifier)!==-1)}}_addBrushes(e,t){if(t){this._brushes=[];this._brushesById={}}e.forEach(i=>{this._brushes.push(i);this._brushesById[i.identifier]=i})}getBrushByIdentifier(e){return this._brushesById[e]}getBrushes(){return this._brushes}getFirstBrush(){return this._brushes[0]}}});var Nw,Gw;var Ww=_(()=>{Nw=class{constructor(){this._assetsByGroupId={}}addAsset(e,t,i=false){if(!this._assetsByGroupId[e]){this._assetsByGroupId[e]=[t]}else if(i){this._assetsByGroupId[e].unshift(t)}else{this._assetsByGroupId[e].push(t)}}setAssets(e,t){this._assetsByGroupId[e]=t}getAssets(e){this._assetsByGroupId[e]=this._assetsByGroupId[e]||[];return this._assetsByGroupId[e]}};Gw=Nw});var oh,zr;var lc=_(()=>{xe();Di();Ww();Zn();Co();oh="imgly_sticker_custom";zr=class{constructor(e,t,i){this._ui=e;this._options=t;this._dynamicAssetsLibrary=i||this._ui.getEditor().getDynamicAssetsLibrary()||new Gw;this._categoriesById={};this._categories=[];this._stickersById={};this._customStickerCanvas=R.createCanvas();this.reload()}reload(){this._categoriesById={};this._categories=[];this._stickersById={};const e=this._ui.getEditor().getSDK()._l.areCustomAssetsAllowed();this._addCategories(Wi.DEFAULTS.STICKER_CATEGORIES);const{categories:t,replaceCategories:i}=this._options;if(e&&this._options.categories){this._addCategories(t,i)}else{this._updateCategoriesMap();this._updateAllCategory()}if(e){const r=this._dynamicAssetsLibrary.getAssets("sticker");if(r.length>0){const o=this._createCustomStickerCategory(r);this._addCategories([o],false,true)}}}loadExternal(e){const t=new Nt(e);return t.load().then(i=>{this._addCategories(i.categories,this._options.replaceCategories)})}_addCategories(e,t=false,i=false){if(t){this._categories=e.slice(0)}else if(i){this._categories=this._mergeCategories(e,this._categories)}else{this._categories=this._mergeCategories(this._categories,e)}this._updateCategoriesMap();this._updateAllCategory()}_mergeCategories(e,t){e=yt.cloneCategories(e,"stickers");for(const i of t){let r=false;for(const o of e){if(i.identifier===o.identifier){for(const n of i.stickers){let a=false;for(const l of o.stickers){if(n.identifier===l.identifier){Object.assign(l,n);a=true;break}}if(!a){o.stickers.push(n)}}r=true;break}}if(!r){e.push(i)}}return e}_updateCategoriesMap(){this._categoriesById={};this._categories.forEach(e=>{this._categoriesById[e.identifier]=e});this._categories.forEach(e=>{e.stickers.forEach(t=>{this._stickersById[t.identifier]=t})});if(typeof this._options.availableStickers!=="undefined"&&this._options.availableStickers!==null){this._categories.forEach(e=>{if(e.identifier!==oh){e.stickers=e.stickers.filter(t=>this._options.availableStickers.indexOf(t.identifier)!==-1)}});this._categories=this._categories.filter(e=>e.stickers.length>0)}this._updateAllCategory()}_updateAllCategory(){this._allCategory={identifier:"all",defaultName:"All",stickers:this._categories.map(e=>e.stickers).reduce((e,t)=>e.concat(t),[])};this._categoriesById.all=this._allCategory}renderStickerThumbnailFromImage(e){const t=this._customStickerCanvas;const i=t.getContext("2d");i.save();const r=62;const o=r/e.width;const n=o*e.height;t.width=r;t.height=r;i.clearRect(0,0,e.width,e.height);i.translate(0,.5*(t.height-n));i.scale(o,o);i.drawImage(e,0,0);const a=t.toDataURL("image/png");i.restore();return{data:a,width:r,height:n}}addCustomStickerFromImage(e,t,i="none"){const r=g=>{const C=this._ui.getEditor().getSDK();const v=C.getRenderer();const x=new oe(g.width,g.height);const B=this._ui.getEditor().getMaxMegapixels()*1e6;let w=v.getMaxDimensions();const D=x.x*x.y>B;const j=w!==null&&(x.x>w||x.y>w);if(D){const J=g.width/g.height;const te=g.height/g.width;w=new oe(Math.sqrt(B*J),Math.sqrt(B*te)).floor().max()}const W=x.clone();if(D||j){if(x.x/x.y>1){W.x=w;W.y=w/x.x*x.y}else{W.x=w/x.y*x.x;W.y=w}}return W};const o=(g,C)=>{const v=g.x/g.y;if(v>1){return new oe(C,C/v)}return new oe(C*v,C)};const n=e.src.substring(0,14)==="data:image/svg";const a=this._ui.getEditor().getSDK();e=a.correctExifOrientation(e);const l=o(new oe(e.width,e.height),2048);const u=n?l:r(e);const c=this._customStickerCanvas;const h=c.getContext("2d");h.save();const m=this.renderStickerThumbnailFromImage(e);if(n){if(e.width>e.height){c.width=2048;c.height=2048/e.width*e.height}else{c.height=2048;c.width=2048/e.height*e.width}e.width=c.width;e.height=c.height}else{c.width=u.x;c.height=u.y;h.scale(u.x/e.width,u.y/e.height)}h.drawImage(e,0,0,e.width,e.height);const d=c.toDataURL();h.restore();const f={identifier:R.generateUUID(),defaultName:t||"",tintMode:i,images:{mediaThumb:{uris:[m.data],rawData:true,width:m.width,height:m.height},mediaBase:{uris:n?[d,e.src]:[d],rawData:true,isSVG:n,width:u.x,height:u.y}}};const b=this._dynamicAssetsLibrary;b.addAsset("sticker",f,true);const y=b.getAssets("sticker");if(y.length===1){const g=this._createCustomStickerCategory(y);this._addCategories([g],false,true)}else{this.getCategory(oh).stickers=y;this._updateAllCategory()}this._updateCategoriesMap()}_createCustomStickerCategory(e){return{identifier:oh,defaultName:"Custom",metaData:{backgroundImage:e[e.length-1].images.mediaBase.uris[0],rawData:true},stickers:e}}getStickersForCategory(e){if(!this._categoriesById[e]){throw new Error(`Unknown sticker category '${e}'`)}return this._categoriesById[e].stickers}getStickerByIdentifier(e){return this._stickersById[e]}getCategories(e=false){if(e){return[this._allCategory].concat(this._categories)}return this._categories}getCategory(e){return this._categoriesById[e]}static getURLForSticker(e,t="base"){const{images:i}=e;const r=t==="base"?i.mediaBase||i.mediaThumb:i.mediaThumb;const o=r.uris||[r.uri];if(true){if(!yt.Browser.getIEVersion()){const a=o.filter(l=>/\.svg$/i.test(l));return a.length?a[0]:o[0]}}const n=o.filter(a=>!/\.svg$/i.test(a));return n.length?n[0]:o[0]}}});var Vw,nh,Fs;var ah=_(()=>{xe();nc();Uw();ih();Mr();lc();Vw=Ur(nl());if(typeof N.Operations.SpriteOperation!=="undefined"){nh=N.Operations.SpriteOperation.BrushSprite}Fs=class{constructor(e,t){this._editor=e;this._ui=this._editor.getUI();this._data=t;this._filterManager=new Rs(this._ui,this._getOptions("filter"));this._stickerManager=new zr(this._ui,this._getOptions("sticker"));this._brushManager=new ac(this._ui,this._getOptions("brush"));this._fontManager=new at(this._ui,this._getOptions("text"))}_getOptions(e){const{controls:t}=this._editor;let i={};if(t&&t.get(e)){i=t.get(e).defaultOptions}const r=this._editor.getOptions();return ge.deepDefaults({},r.editor.controlsOptions[e]||{},i)}deserialize(){return this._validateVersion().then(()=>this._deserializeInputImage()).then(()=>this._deserializeOperations())}_validateVersion(){if(this._data.version!==this.constructor.version){return Promise.reject(new Error(`Invalid version ${this._data.version}, expected ${this.constructor.version}`))}return Promise.resolve()}_deserializeInputImage(){return new Promise((e,t)=>{const{data:i,type:r}=this._data.inputImage;if(i&&r){const o=new window.Image;o.addEventListener("load",()=>{this._editor.setImage(o);e()});o.src=`data:${r};base64,${i}`}else{e()}})}async _deserializeOperations(){const{operations:e}=this._data;return(0,Vw.default)(e,async t=>this._deserializeOperation(t))}_deserializeOperation(e){switch(e.type){case"crop":return this._deserializeCropOperation(e);case"orientation":return this._deserializeOrientationOperation(e);case"filter":return this._deserializeFilterOperation(e);case"adjustments":return this._deserializeAdjustmentsOperation(e);case"sprite":return this._deserializeSpriteOperation(e);case"focus":return this._deserializeFocusOperation(e)}}_deserializeCropOperation(e){const{options:t}=e;let{rotation:i}=t;const r=oe.fromObject(t.start);const o=oe.fromObject(t.end);if(i>Math.PI){i-=Math.PI*2}const n={start:r,end:o};if(typeof i!=="undefined"){n.rotation=i}const a=this._editor.operations.getOrCreate("transform");this._editor.broadcastTransform(a,n);a.set(n);return Promise.resolve(a)}_deserializeOrientationOperation(e){const{options:t}=e;const i=this._editor.operations.getOrCreate("orientation");if(!i)return Promise.resolve();i.set(t);return Promise.resolve(i)}_deserializeFilterOperation(e){const{options:t}=e;if(!this._filterManager.getFilterByIdentifier(t.name)){P.warn("Deserializer",`Unknown filter \`${t.name}\``);return Promise.resolve()}return this._filterManager.instantiateFilterWithIdentifier(t.name).then(i=>{const r=this._editor.operations.getOrCreate("filter");r.set({identifier:t.name,filter:i,intensity:t.intensity});return r})}_deserializeAdjustmentsOperation(e){const{AdjustmentsOperation:t}=N.Operations;const{options:i}=e;const r=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"];const o={};r.forEach(n=>{if(typeof i[n]==="undefined")return;const{minValue:a,midValue:l,maxValue:u}=t.prototype.availableOptions[n];let c=i[n];c=c<0?l+(l-a)*c:l+(u-l)*c;o[n]=c});return Promise.resolve(this._editor.operations.getOrCreate("adjustments",o))}_deserializeSpriteOperation(e){const{options:t}=e;const i=this._editor.operations.getOrCreate("sprite");if(!i)return Promise.resolve();const r=t.sprites.map(o=>{return this._deserializeSprite(i,o)}).filter(o=>o);return Promise.all(r).then(o=>{i.setSprites(o.filter(n=>n));return i})}_deserializeSprite(e,t){switch(t.type){case"sticker":return this._deserializeSticker(e,t);case"text":return this._deserializeText(e,t);case"brush":return this._deserializeBrush(e,t);case"textdesign":return this._deserializeTextDesign&&this._deserializeTextDesign(e,t)}}_deserializeSticker(e,t){const{SpriteOperation:i}=N.Operations;const{options:r}=t;const o=this._stickerManager.getStickerByIdentifier(r.name);const n=this._stickerManager.getURLForSticker(o);if(!o){P.warn("Deserializer",`Unknown sticker '${r.name}'. Skipping sprite.`);return Promise.resolve()}return new Promise((a,l)=>{const u=new window.Image;u.addEventListener("load",()=>{const c=i.StickerSprite.prototype.availableOptions.adjustments.structure;const{rotation:h,flipHorizontally:m,flipVertically:d}=r;const f={identifier:r.name,image:u,position:oe.fromObject(r.position),dimensions:oe.fromObject(r.dimensions),rotation:h,flipHorizontally:m,flipVertically:d,adjustments:{}};if(typeof r.adjustments!=="undefined"){["brightness","contrast","saturation"].forEach(b=>{if(typeof r.adjustments[b]!=="undefined"){f.adjustments[b]=r.adjustments[b]+c[b].default}})}a(e.createSticker(f))});u.crossOrigin=this._editor.getCrossOrigin();u.src=this._editor.getUI().getAssetPath(n)})}_deserializeText(e,t){const{options:i}=t;const{fontSize:r,lineHeight:o,fontFamily:n,fontWeight:a,alignment:l,rotation:u,maxWidth:c,color:h,backgroundColor:m}=i;const d=new Lr(this._ui);let f=this._fontManager.getFontByFontFamily(n);if(!f)f=this._fontManager.getDefaultFont();d.setFonts([f]);return d.load().then(()=>{const b=e.createText({fontSize:r,lineHeight:o,fontFamily:n,fontWeight:a,alignment:l,rotation:u,maxWidth:c,text:i.text,color:ue.fromArray(h),backgroundColor:ue.fromArray(m),position:oe.fromObject(i.position)});b._edited=true;return b})}_deserializeBrush(e,t){const{options:i}=t;const{paths:r}=i;const o=e.createBrush();r.forEach(n=>{this._deserializeBrushPath(o,n)});return Promise.resolve(o)}_deserializeBrushPath(e,t){const{points:i}=t;const r=this._createBrushForPath(t);const o=e.createPath(r);o.setClosed(true);i.forEach(n=>{o.addControlPoint(oe.fromObject(n))})}_createBrushForPath(e){const{color:t,size:i}=e;const r=ue.fromArray(t);const o={color:r,size:i};const n=this._brushManager.getFirstBrush();if(n.prototype&&n.prototype instanceof nh){const u=n;return new u(o)}const a={...n};delete a.image;class l extends nh{}l.identifier=n.identifier;return new l({...a,...o})}_deserializeFocusOperation(e){const{options:t}=e.options;switch(e.options.type){case"radial":{const{position:i,radius:r,gradientRadius:o,blurRadius:n}=t;return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:oe.fromObject(i),radius:r,gradientRadius:o,blurRadius:n}))}case"linear":{const{start:i,end:r,size:o,gradientSize:n,blurRadius:a}=t;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:oe.fromObject(i),end:oe.fromObject(r),size:o,gradientSize:n,blurRadius:a}))}}}_getInputDimensionsForOperation(e){let t=false;let i=this._editor.getInputDimensions();this._editor.operations.getStack().forEach(r=>{if(r===e)t=true;if(t)return;i=r.getNewDimensions(i)});return i}};Fs.version="1.0.0"});var cn,Os;var lh=_(()=>{xe();cn=Math.PI*2;Os=class{constructor(e){this._editor=e;this._serializeOperations=this._serializeOperations.bind(this)}serialize(e={}){this._options={...e,image:true};const t={version:this.constructor.version};return this._serializeInputImage(t).then(this._serializeOperations)}_serializeInputImage(e){const t=this._editor.getImage();const{width:i,height:r}=t;if(!this._options.image){e.inputImage={width:i,height:r};return Promise.resolve(e)}const o=ge.createCanvas();o.width=t.width;o.height=t.height;const n=o.getContext("2d");n.drawImage(t,0,0);const a=o.toDataURL(th.PNG);e.inputImage={type:th.PNG,data:a.replace(/^data:image\/(.*?);base64,/,""),width:i,height:r};return Promise.resolve(e)}_serializeOperations(e){const t=[];const i=this._editor.operations.getStack();i.forEach(r=>{const o=this._serializeOperation(r,t);if(o){t.push(o)}});e.operations=t.filter(r=>r);return Promise.resolve(e)}_serializeOperation(e,t){switch(e.constructor.identifier){case"transform":return this._serializeTransformOperation(e);case"orientation":return this._serializeOrientationOperation(e);case"filter":return this._serializeFilterOperation(e);case"adjustments":return this._serializeAdjustmentsOperation(e);case"sprite":return this._serializeSpriteOperation(e,t);case"radial-focus":return this._serializeRadialFocusOperation(e);case"mirrored-focus":return this._serializeLinearFocusOperation(e);default:P.warn(`Unable to serialize operation of type ${e.constructor.identifier}`)}}_serializeTransformOperation(e){const t=e.serializeOptions(["start","end","rotation"],true);t.rotation=(t.rotation+cn)%cn;return{type:"crop",options:t}}_serializeOrientationOperation(e){return{type:"orientation",options:e.serializeOptions(["flipVertically","flipHorizontally","rotation"],true)}}_serializeFilterOperation(e){if(e.getIdentifier()==="identity")return null;return{type:"filter",options:{intensity:e.getIntensity(),name:e.getIdentifier()}}}_serializeAdjustmentsOperation(e){const{availableOptions:t}=e;const i=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"];const r={};i.forEach(o=>{const n=t[o];const a=e.getOption(o);const{minValue:l,midValue:u,maxValue:c}=n;r[o]=a<=u?(a-l)/(u-l)-1:(a-u)/(c-u)});return{type:"adjustments",options:r}}_serializeSpriteOperation(e,t){const i=t.filter(n=>n.type==="sprite");let r;let o=true;if(i.length){r=i.pop();o=false}else{r={type:"sprite",options:{sprites:[]}}}e.getSprites().forEach(n=>{let a=null;if(n instanceof e.constructor.StickerSprite){a=this._serializeSticker(e,n)}else if(n instanceof e.constructor.TextSprite){a=this._serializeText(e,n)}else if(n instanceof e.constructor.BrushSprite){a=this._serializeBrush(e,n)}else if(n instanceof e.constructor.TextDesignSprite){a=this._serializeTextDesign&&this._serializeTextDesign(e,n)}if(a){r.options.sprites.push(a)}});if(o){return r}}_serializeSticker(e,t){const i=t.getAdjustments();const r=t.serializeOptions(["identifier","position","dimensions","flipVertically","flipHorizontally","rotation"],true);r.name=r.identifier;delete r.identifier;r.rotation=(r.rotation+cn)%cn;const o=i.availableOptions;r.adjustments={brightness:i.getBrightness()-o.brightness.default,saturation:i.getSaturation()-o.saturation.default,contrast:i.getContrast()-o.contrast.default};return{type:"sticker",options:r}}_serializeText(e,t){const i=t.serializeOptions(["fontSize","lineHeight","fontFamily","fontWeight","alignment","color","backgroundColor","position","rotation","text","maxWidth"],true);i.rotation=(i.rotation+cn)%cn;return{type:"text",options:i}}_serializeBrush(e,t){return{type:"brush",options:{paths:t.getPaths().map(i=>this._serializePath(i))}}}_serializePath(e){const t=e.getBrush().serializeOptions(["color","size"],true);t.points=e.getControlPoints().map(i=>i.getPosition().toObject());return t}_serializeRadialFocusOperation(e){return{type:"focus",options:{type:"radial",options:e.serializeOptions(["position","radius","gradientRadius","blurRadius"],true)}}}_serializeLinearFocusOperation(e){return{type:"focus",options:{type:"linear",options:e.serializeOptions(["start","end","blurRadius","size","gradientSize"],true)}}}_getInputDimensionsForOperation(e){let t=false;let i=this._editor.getInputDimensions();this._editor.operations.getStack().forEach(r=>{if(r===e)t=true;if(t)return;i=r.getNewDimensions(i)});return i}};Os.version="1.0.0"});var jw={};Me(jw,{default:()=>uc});var uc;var Hw=_(()=>{ah();lh();uc=class{constructor(e){this._editor=e}serialize(...e){const t=new Os(this._editor);return t.serialize(...e)}deserialize(e){const t=new Fs(this._editor,e);return t.deserialize()}};uc.version="1.0.0"});var As;var uh=_(()=>{xe();ah();As=class extends Fs{_deserializeOperation(e){if(e.type==="selective-blur"){return this._deserializeSelectiveBlurOperation(e)}return super._deserializeOperation(e)}_deserializeCropOperation(e){const{options:t}=e;let{rotation:i}=t;const r=oe.fromObject(t.start);const o=oe.fromObject(t.end);const n=t.dimensions?oe.fromObject(t.dimensions):null;if(o.x-r.x<=0||o.y-r.y<=0){throw new Error(`A crop should not result in negative or zero dimensions - start: ${r} - end: ${o}`)}if(i>Math.PI){i-=Math.PI*2}const a={start:r,end:o};if(typeof i!=="undefined")a.rotation=i;const l=this._editor.operations.getOrCreate("transform");if(!l)return Promise.resolve();this._editor.broadcastTransform(l,a);l.set(a);if(n){const u=o.clone().subtract(r);const c=l.getInputDimensions(false).multiply(u);l.setTextureScale(n.x/c.x)}return Promise.resolve(l)}};As.version="1.0.1"});var qw,Is;var ch=_(()=>{lh();qw=Math.PI*2;Is=class extends Os{_serializeTransformOperation(e){const t=e.serializeOptions(["start","end","rotation","textureScale"],true);t.rotation=(t.rotation+qw)%qw;if(t.textureScale!==1){t.dimensions=e.getNewDimensions(e.getInputDimensions(false))}delete t.textureScale;return{type:"crop",options:t}}};Is.version="1.0.1"});var Kw={};Me(Kw,{default:()=>cc});var cc;var Xw=_(()=>{uh();ch();cc=class{constructor(e){this._editor=e}serialize(...e){const t=new Is(this._editor);return t.serialize(...e)}deserialize(e){const t=new As(this._editor,e);return t.deserialize()}};cc.version="1.0.1"});var mn,Ta;var Yw=_(()=>{xo();xe();({OptionType:mn}=N);Ta=class extends N.Configurable{constructor(e,t={}){super(t);this._loaded=false;this._loading=false;this._ui=e;this._frame=N.Utils.deepClone(this._options)}load(){if(this._loaded)return Promise.resolve();if(this._loading)return Promise.reject(new Error("Called Frame#load while it's already loading"));this._loading=true;const{imageGroups:e}=this._frame;const t=[];["top","left","right","bottom"].forEach(i=>{if(!(i in e))return;const r=e[i];["start","mid","end"].forEach(o=>{if(!(o in r))return;t.push(this._loadPart(i,o))})});return Promise.all(t).then(()=>{this._loaded=true;this._loading=false}).catch(i=>{this._loaded=false;this._loading=false})}_loadPart(e,t){const{imageGroups:i}=this._frame;const r=i[e][t];let o=r;if(typeof r!=="string"&&"image"in r){o=r.image}return ut.load(this._ui.getAssetPath(o)).then(n=>{if(typeof r!=="string"){this._frame.imageGroups[e][t].image=n}else{this._frame.imageGroups[e][t]=n}return n})}getFrame(){return this._frame}};Ta.prototype.availableOptions={identifier:{type:mn.STRING,required:true},defaultName:{type:mn.STRING},thumbnail:{type:mn.STRING},tintable:{type:mn.BOOLEAN,default:false},layoutMode:{type:mn.STRING,default:"horizontal-inside",available:["horizontal-inside","vertical-inside"]},imageGroups:{type:mn.OBJECT,required:true}}});var mc;var Jw=_(()=>{xe();mc=class{constructor(e,t){this._ui=e;this._options=t;this._categoriesById={};this._categories=[];this._framesById={};this._addCategories(Wi.DEFAULTS.FRAME_CATEGORIES);this._customAssetsAllowed=e.getEditor().getSDK()._l.areCustomAssetsAllowed();const{categories:i,replaceCategories:r}=this._options;if(this._customAssetsAllowed&&this._options.categories){this._addCategories(i,r)}else{this._updateAllCategory()}}_addCategories(e,t=false){if(t){this._categories=e.slice(0)}else{this._categories=yt.mergeCategories(this._categories,e,"frames")}this._categoriesById={};this._categories.forEach(r=>{this._categoriesById[r.identifier]=r});const{availableFrames:i}=this._options;if(this._customAssetsAllowed&&i){this._categories.forEach(r=>{r.frames=r.frames.filter(o=>i.indexOf(o.identifier)!==-1)})}this._categories.forEach(r=>{r.frames.forEach(o=>{this._framesById[o.identifier]=o})});this._updateAllCategory()}_updateAllCategory(){this._allCategory={identifier:"all",defaultName:"All",frames:this._categories.map(e=>e.frames).reduce((e,t)=>e.concat(t),[])};this._categoriesById.all=this._allCategory}getFramesForCategory(e){if(!this._categoriesById[e]){throw new Error(`Unknown frame category '${e}'`)}return this._categoriesById[e].frames}getFrameByIdentifier(e){return this._framesById[e]}getCategories(){return this._categories}getCategory(e){return this._categoriesById[e]}}});var dc;var $w=_(()=>{xe();dc=class{constructor(e,t){this._ui=e;this._options=t;this._overlays=Wi.DEFAULTS.OVERLAYS.slice(0);this._overlaysByIdentifier={};const i=e.getEditor().getSDK()._l.areCustomAssetsAllowed();if(i&&t.overlays){if(t.replaceOverlays){this._overlays=t.overlays}else{this._overlays=this._overlays.concat(t.overlays)}}if(i&&t.availableOverlays){this._overlays=this._overlays.filter(r=>t.availableOverlays.indexOf(r.identifier)!==-1)}this._overlays.forEach(r=>{this._overlaysByIdentifier[r.identifier]=r})}getOverlays(){return this._overlays}getOverlayByIdentifier(e){return this._overlaysByIdentifier[e]}}});var Zi,dn;var pc=_(()=>{xe();({OverlayFilter:Zi}=N.Engine.Filters);dn={[Zi.BLEND_MODES.NORMAL]:"normal",[Zi.BLEND_MODES.OVERLAY]:"overlay",[Zi.BLEND_MODES.HARD_LIGHT]:"hard light",[Zi.BLEND_MODES.SOFT_LIGHT]:"soft light",[Zi.BLEND_MODES.MULTIPLY]:"multiply",[Zi.BLEND_MODES.DARKEN]:"darken",[Zi.BLEND_MODES.LIGHTEN]:"lighten",[Zi.BLEND_MODES.SCREEN]:"screen",[Zi.BLEND_MODES.COLOR_BURN]:"color burn"}});var xS,Ps;var mh=_(()=>{xe();nc();Yw();xo();Jw();$w();lc();uh();pc();xS=ge.flipObject(dn);Ps=class extends As{constructor(...e){super(...e);this._frameManager=new mc(this._ui,this._getOptions("frame"));const t=this._getOptions("overlay");if(t){this._overlayManager=new dc(this._ui,t)}}_deserializeSprite(e,t){if(t.type==="frame"){return this._deserializeFrame(e,t)}if(t.type==="overlay"){return this._deserializeOverlay(e,t)}return super._deserializeSprite(e,t)}_deserializeOperation(e){if(e.type==="transform"){return this._deserializeTransformOperation(e)}return super._deserializeOperation(e)}_deserializeOrientationOperation(e){if(this._data.meta&&this._data.meta.platform!=="html5"){return super._deserializeOrientationOperation(e)}const{rotation:t,flipHorizontally:i,flipVertically:r}=e.options;let o=t===90&&!i&&!r;o|=t===90&&i&&r;o|=t===270&&!i&&!r;o|=t===270&&i&&r;if(o){e.options.flipHorizontally=!e.options.flipHorizontally;e.options.flipVertically=!e.options.flipVertically}return super._deserializeOrientationOperation(e)}_deserializeTransformOperation(e){return super._deserializeCropOperation(e).then(t=>{if(!t)return;const i=ge.Array.find(this._data.operations,r=>r.type==="orientation");if(i){const{options:r}=i;let{rotation:o,flipHorizontally:n,flipVertically:a}=r;if(o===90||o===270){if(!n&&a||n&&!a){n=!n;a=!a}}t.rotate(r.rotation);if(n){t.flip("horizontal");t.setRotation(t.getRotation()*-1)}if(a){t.flip("vertical");t.setRotation(t.getRotation()*-1)}}return t})}_deserializeFrame(e,t){const{identifier:i}=t.options;const r=this._frameManager.getFrameByIdentifier(i);if(!r){P.warn("Deserializer",`Unknown frame \`${i}\`. Skipping frame.`);return Promise.resolve()}const o=new Ta(this._ui,r);return o.load().then(()=>{this._editor.operations.getOrCreate("frame",{frame:o.getFrame()})})}_deserializeOverlay(e,t){const{blendMode:i,intensity:r,identifier:o}=t.options;const n=this._overlayManager.getOverlayByIdentifier(o);if(!n){P.warn("Deserializer",`Unknown overlay \`${o}\`. Skipping overlay.`);return Promise.resolve()}const a=this._editor.getUI().getAssetPath(n.image);return ut.load(a).then(l=>{this._editor.operations.getOrCreate("overlay",{alpha:r,identifier:o,blendMode:parseInt(xS[i||n.blendMode],10),image:l})})}_createBrushForPath(e){const t=super._createBrushForPath(e);if(typeof e.hardness!=="undefined"&&t.hasOption("hardness")){t.setHardness(e.hardness)}return t}_deserializeSticker(e,t){const{SpriteOperation:i}=N.Operations;const{options:r}=t;const o=this._stickerManager.getStickerByIdentifier(r.identifier);const n=zr.getURLForSticker(o,"base");if(!o){P.warn("Deserializer",`Unknown sticker \`${r.identifier}\`. Skipping sprite.`);return Promise.resolve()}const a=e.getInputDimensions(false);return new Promise((l,u)=>{const c=new window.Image;c.addEventListener("load",()=>{const h=i.StickerSprite.prototype.availableOptions.adjustments.structure;const{rotation:m,flipHorizontally:d,flipVertically:f}=r;const b={identifier:r.identifier,image:c,position:oe.fromObject(r.position),dimensions:oe.fromObject(r.dimensions).multiply(a.min()),rotation:m,flipHorizontally:d,flipVertically:f,adjustments:{}};if(typeof r.adjustments!=="undefined"){["brightness","contrast","saturation"].forEach(y=>{if(typeof r.adjustments[y]!=="undefined"){b.adjustments[y]=r.adjustments[y]+h[y].default}})}if(typeof r.tintColor!=="undefined"&&typeof o.tintMode!=="undefined"){b.tintColor=ue.fromArray(r.tintColor);b.tintMode=o.tintMode}l(e.createSticker(b))});c.crossOrigin=this._editor.getCrossOrigin();c.src=this._editor.getUI().getAssetPath(n)})}_deserializeFilterOperation(e){const{options:t}=e;if(!this._filterManager.getFilterByIdentifier(t.identifier)){P.warn("Deserializer",`Unknown filter \`${t.identifier}\``);return Promise.resolve()}return this._filterManager.instantiateFilterWithIdentifier(t.identifier).then(i=>{const r=this._editor.operations.getOrCreate("filter");if(!r)return;r.set({identifier:t.identifier,filter:i,intensity:t.intensity});return r})}_deserializeFocusOperation(e){const{options:t,type:i}=e.options;if(i!=="radial")return super._deserializeFocusOperation(e);const r=this._editor.getImage();const o=r.width/r.height;const{start:n,end:a,gradientRadius:l,blurRadius:u}=t;const c=oe.fromObject(a).subtract(oe.fromObject(n)).multiply(o,1).len();return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:oe.fromObject(n),radius:c,gradientRadius:l,blurRadius:u}))}_deserializeText(e,t){const{options:i}=t;const{fontSize:r,lineHeight:o,fontIdentifier:n,alignment:a,rotation:l,maxWidth:u,color:c,backgroundColor:h}=i;const m=new Lr(this._ui);let d=this._fontManager.getVariationByIdentifier(n);if(!d){d=this._fontManager.getDefaultFont()}else{m.setFonts([d.getFont()])}return m.load().then(()=>{const f=e.getInputDimensions(false);const b=u*f.min()/f.x;const y=e.createText({fontSize:r,lineHeight:o,fontFamily:d.getFontFamily(),fontWeight:d.getFontWeight(),fontIdentifier:d.getIdentifier(),alignment:a,rotation:l,maxWidth:b,text:i.text,color:ue.fromArray(c),backgroundColor:ue.fromArray(h),position:oe.fromObject(i.position)});y._edited=true;return y})}};Ps.version="2.0.0"});var Bs;var dh=_(()=>{ch();pc();Bs=class extends Is{_serializeSticker(e,t){const i=e.getInputDimensions(false);const r=super._serializeSticker(e,t);if(t.getTintMode()!=="none"){r.options.tintColor=t.serializeOption("tintColor",true)}r.options.dimensions=t.getDimensions().clone().divide(i.min()).toObject();r.options.identifier=r.options.name;delete r.options.name;return r}_serializePath(e){const t=super._serializePath(e);const i=e.getBrush();if(i.hasOption("hardness")){t.hardness=i.getOption("hardness")}return t}_serializeOperation(e,t){if(e.constructor.identifier==="frame"){this._serializeFrameOperation(e,t);return null}if(e.constructor.identifier==="overlay"){this._serializeOverlayOperation(e,t);return null}return super._serializeOperation(e,t)}_serializeFrameOperation(e,t){const i=t.filter(o=>o.type==="sprite");let r;if(i.length){r=i.pop()}else{r={type:"sprite",options:{sprites:[]}};t.push(r)}r.options.sprites.push({type:"frame",options:this._getFrameOptions(e)})}_serializeOverlayOperation(e,t){if(!e.getIdentifier())return;const i=t.filter(o=>o.type==="sprite");let r;if(i.length){r=i.pop()}else{r={type:"sprite",options:{sprites:[]}};t.push(r)}r.options.sprites.push({type:"overlay",options:{identifier:e.getIdentifier(),intensity:e.getAlpha(),blendMode:dn[e.getBlendMode()]}})}_getFrameOptions(e){return{identifier:e.getFrame().identifier}}_serializeOrientationOperation(e){const t=super._serializeOrientationOperation(e);if(t.options.rotation===90||t.options.rotation===270){t.options.flipHorizontally=!t.options.flipHorizontally;t.options.flipVertically=!t.options.flipVertically}return t}_serializeTransformOperation(e){const{operations:t}=this._editor;if(t.exists("orientation")){e=e.clone();const r=t.get("orientation");e.rotate(-r.getRotation());if(r.getFlipVertically()){e.flip("vertical");e.setRotation(e.getRotation()*-1)}if(r.getFlipHorizontally()){e.flip("horizontal");e.setRotation(e.getRotation()*-1)}}const i=super._serializeTransformOperation(e);i.type="transform";return i}_serializeText(e,t){const i=super._serializeText(e,t);const r=e.getInputDimensions(false);i.options.fontIdentifier=t.getFontIdentifier();i.options.maxWidth=i.options.maxWidth*r.x/r.min();delete i.options.fontFamily;return i}_serializeFilterOperation(e){const t=super._serializeFilterOperation(e);if(!t)return null;t.options.identifier=t.options.name;delete t.options.name;return t}_serializeRadialFocusOperation(e){const t=super._serializeRadialFocusOperation(e);const i=t.options.options;i.start=i.position;delete i.position;i.end={x:i.start.x+i.radius,y:i.start.y};delete i.radius;return t}};Bs.version="2.0.0"});var Zw={};Me(Zw,{default:()=>hc});var hc;var Qw=_(()=>{mh();dh();hc=class{constructor(e){this._editor=e}serialize(...e){const t=new Bs(this._editor);return t.serialize(...e)}deserialize(e){const t=new Ps(this._editor,e);return t.deserialize()}};hc.version="2.0.0"});var ph,Ms;var hh=_(()=>{xe();xo();Mr();lc();ln();mh();if(typeof N.Operations.SpriteOperation!=="undefined"){ph=N.Operations.SpriteOperation.BrushSprite.Brush}Ms=class extends Ps{_deserializeSticker(e,t){const{SpriteOperation:i}=N.Operations;const{options:r}=t;const o=this._stickerManager.getStickerByIdentifier(r.identifier);if(!o){P.warn("Deserializer",`Unknown sticker \`${r.identifier}\`. Skipping sprite.`);return Promise.resolve()}const{mediaBase:n}=o.images;const a=zr.getURLForSticker(o,"base");const l=n.rawData?n.uris[0]:this._editor.getUI().getAssetPath(a);const u=e.getInputDimensions(false);return ut.load(l).then(c=>{const h=i.StickerSprite.prototype.availableOptions.adjustments.structure;const{rotation:m,flipHorizontally:d,flipVertically:f}=r;const b={identifier:r.identifier,image:c,position:oe.fromObject(r.position),dimensions:oe.fromObject(r.dimensions).multiply(u.min()),rotation:m||0,flipHorizontally:d,flipVertically:f,resizeMode:o.resizeMode||"keepAspect",adjustments:{}};if(typeof r.adjustments!=="undefined"){["brightness","contrast","saturation"].forEach(y=>{if(typeof r.adjustments[y]!=="undefined"){b.adjustments[y]=r.adjustments[y]+h[y].default}})}if(typeof r.tintMode!=="undefined"&&typeof r.tintColor!=="undefined"){b.tintColor=ue.fromArray(r.tintColor.rgba);b.tintMode=r.tintMode}else if(typeof r.tintColor!=="undefined"&&typeof o.tintMode!=="undefined"){b.tintColor=ue.fromArray(r.tintColor.rgba);b.tintMode=o.tintMode}if(typeof r.alpha!=="undefined"){b.alpha=r.alpha}return e.createSticker(b)})}_deserializeTransformOperation(e){return super._deserializeTransformOperation(e).then(t=>{if(!t)return;t._ratio=null;return t})}_deserializeInputImage(){let{data:e,type:t,uri:i}=this._data.image;if(e&&t){i=`data:${t};base64,${e}`}if(i){return ut.load(i).then(r=>{this._editor.setImage(r)})}return Promise.resolve()}_deserializeAdjustmentsOperation(e){const{AdjustmentsOperation:t}=N.Operations;return super._deserializeAdjustmentsOperation(e).then(i=>{if(!i)return null;const{options:r}=e;const o=["gamma","whites","blacks","temperature"];const n={};o.forEach(a=>{if(typeof r[a]==="undefined")return;const{minValue:l,midValue:u,maxValue:c}=t.prototype.availableOptions[a];let h=r[a];h=h<0?u+(u-l)*h:u+(c-u)*h;n[a]=h});i.set(n);return i})}_deserializeFocusOperation(e){const{options:t}=e.options;switch(e.options.type){case"radial":return super._deserializeFocusOperation(e);case"linear":{const{start:i,end:r,blurRadius:o}=t;return Promise.resolve(this._editor.operations.getOrCreate("linear-focus",{controlPoint1:oe.fromObject(i),controlPoint2:oe.fromObject(r),blurRadius:o}))}case"mirrored":{const{start:i,end:r,size:o,gradientSize:n,blurRadius:a}=t;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:oe.fromObject(i),end:oe.fromObject(r),size:o,gradientSize:n,blurRadius:a}))}case"gaussian":{const{blurRadius:i}=t;return Promise.resolve(this._editor.operations.getOrCreate("blur",{blurRadius:i}))}}}_deserializeText(e,t){const{options:i}=t;const{fontSize:r,lineHeight:o,fontIdentifier:n,alignment:a,rotation:l,maxWidth:u,color:c,backgroundColor:h}=i;const m=this._ui.getFontLoader();let d=this._fontManager.getVariationByIdentifier(n);if(!d){d=this._fontManager.getDefaultVariation()}else{m.setFonts([d.getFont()])}return m.load().then(()=>{const f=e.getInputDimensions(false);const b=u*f.min()/f.x;const y=e.createText({fontSize:r,lineHeight:o,fontFamily:d.getFontFamily(),fontWeight:d.getFontWeight(),fontIdentifier:d.getIdentifier(),textMetrics:d.getTextMetrics(),alignment:a,rotation:l,maxWidth:b,text:i.text,color:ue.fromArray(c.rgba),backgroundColor:ue.fromArray(h.rgba),position:oe.fromObject(i.position)});y._edited=true;return y})}_createBrushForPath(e){const{identifier:t,color:i,size:r,hardness:o}=e.brush;const n=ue.fromArray(i.rgba);const a={color:n,size:r};if(typeof o!=="undefined"){a.hardness=o}let l=this._brushManager.getBrushByIdentifier(t);if(!l){l=this._brushManager.getFirstBrush()}if(l.prototype&&l.prototype instanceof ph){const h=l;return new h(a)}const u={...l};delete u.image;class c extends ph{}c.identifier=l.identifier;return new c({...u,...a})}_deserializeFrame(e,t){return super._deserializeFrame(e,t).then(()=>{const i=this._editor.operations.get("frame");const{size:r,alpha:o,tintColor:n}=t.options;const a={};if(typeof r!=="undefined"){a.scale=r}if(typeof o!=="undefined"){a.alpha=o}if(typeof n!=="undefined"){a.tintColor=ue.fromArray(n.rgba)}i.set(a)})}_deserializeTextDesign(e,t){const{options:i}=t;const{position:r,rotation:o,flipHorizontally:n,flipVertically:a,text:l,color:u,width:c,seed:h,inverted:m}=i;let{identifier:d}=i;if(d===N.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier){d=N.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier}else if(d===N.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier){d=N.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier}const f=new Xt(this._ui,this._getOptions("textdesign"));const b=new at(this._ui,{fonts:Te.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:true});const{AssetManager:y}=e.constructor.TextDesignSprite;const g=this._ui.getFontLoader();const C=f.getLayoutByIdentifier(d);const v=new C;g.setFonts(b.getFonts());y.setFonts({...y.getFonts(),...b.getVariationsByIdentifier()});return g.load().then(()=>{const x=v.getImagePaths().map(B=>({path:B,fullPath:this._ui.getAssetPath(B),image:null}));return y.loadImages(x).then(()=>{v.onImagesLoaded();return e.createTextDesign({position:r,rotation:o,flipHorizontally:n,flipVertically:a,text:l,color:ue.fromArray(u.rgba),width:c,seed:h,inverted:m,layout:v})})})}};Ms.version="3.0.0"});var Ls;var fh=_(()=>{Di();Ls=class extends X{};Ls.prototype.availableOptions={identifier:{type:p.STRING,required:true},defaultName:{type:p.STRING,required:true},ratio:{type:p.ALL,required:false,default:null},selected:{type:p.BOOLEAN,required:false},dimensions:{type:p.VECTOR2,required:false},lockDimensions:{type:p.BOOLEAN,required:false,default:null},forceDimensions:{type:p.BOOLEAN,required:false,default:null}}});var zs;var gh=_(()=>{xe();fh();dh();zs=class extends Bs{serialize(e={}){return super.serialize(e).then(t=>{t.meta={platform:"html5",version:this._editor.getSDK().version,createdAt:ge.ISODateString(new Date)};t.image=t.inputImage;delete t.inputImage;return t})}_serializeSticker(e,t){const i=super._serializeSticker(e,t);i.options.alpha=t.getAlpha();if(i.options.tintColor){i.options.tintColor={rgba:i.options.tintColor}}return i}_serializeText(e,t){const i=super._serializeText(e,t);i.options.color={rgba:i.options.color};i.options.backgroundColor={rgba:i.options.backgroundColor};i.options.flipHorizontally=false;i.options.flipVertically=false;delete i.options.fontWeight;return i}_serializePath(e){const t=super._serializePath(e);delete t.hardness;delete t.size;delete t.color;const i=e.getBrush();t.brush=i.serializeOptions(["identifier","size","color"],true);if(typeof t.brush.identifier==="undefined"){delete t.brush.identifier}t.brush.color={rgba:t.brush.color};const r=i.getOption("hardness");if(r!=="undefined"){t.brush.hardness=r}return t}_serializeFrameOperation(e,t){super._serializeFrameOperation(e,t);const i=t.filter(o=>o.type==="sprite");let r;if(i.length){r=i.pop();const o=r.options.sprites.filter(l=>l.type==="frame")[0];const n=e.getTintColor();if(!n.equals(new ue(1,1,1,0))){o.options.tintColor={rgba:e.serializeOption("tintColor",true)}}const a=e.serializeOptions(["scale","alpha"],true);o.options={...o.options,...a};o.options.size=o.options.scale;delete o.options.scale}}_serializeTransformOperation(e){const t=super._serializeTransformOperation(e);if(e._ratio){let i;if(e._ratio instanceof Ls){i=e._ratio.getIdentifier()}else{i=e._ratio.identifier}t.options.meta={identifier:i}}delete t.options.scale;return t}_serializeAdjustmentsOperation(e){const t=super._serializeAdjustmentsOperation(e);const i=["gamma","whites","blacks","temperature"];const{availableOptions:r}=e;const o={};i.forEach(n=>{const a=r[n];const l=e.getOption(n);const{minValue:u,midValue:c,maxValue:h}=a;o[n]=l<=c?(l-u)/(c-u)-1:(l-c)/(h-c)});t.options={...t.options,...o};return t}_serializeOperation(e,t){switch(e.constructor.identifier){case"mirrored-focus":return this._serializeMirroredFocusOperation(e);case"linear-focus":return this._serializeLinearFocusOperation(e);case"blur":return this._serializeBlurOperation(e);default:return super._serializeOperation(e,t)}}_serializeMirroredFocusOperation(e){return{type:"focus",options:{type:"mirrored",options:e.serializeOptions(["start","end","blurRadius","size","gradientSize"],true)}}}_serializeLinearFocusOperation(e){const t=e.serializeOptions(["controlPoint1","controlPoint2","blurRadius"],true);t.start=t.controlPoint1;delete t.controlPoint1;t.end=t.controlPoint2;delete t.controlPoint2;return{type:"focus",options:{type:"linear",options:t}}}_serializeBlurOperation(e){return{type:"focus",options:{type:"gaussian",options:e.serializeOptions(["blurRadius"],true)}}}};zs.version="3.0.0"});var eC={};Me(eC,{default:()=>fc});var fc;var tC=_(()=>{hh();gh();fc=class{constructor(e){this._editor=e}serialize(...e){const t=new zs(this._editor);return t.serialize(...e)}deserialize(e){const t=new Ms(this._editor,e);return t.deserialize()}};fc.version="3.0.0"});var Us;var _h=_(()=>{xe();Mr();ln();hh();Us=class extends Ms{_deserializeTextDesign(e,t){const{options:i}=t;const{position:r,rotation:o,flipHorizontally:n,flipVertically:a,text:l,color:u,width:c,seed:h,inverted:m}=i;let{identifier:d}=i;if(d===N.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier){d=N.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier}else if(d===N.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier){d=N.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier}const f=new Xt(this._ui,this._getOptions("textdesign"));const b=new at(this._ui,{fonts:Te.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:true});const{AssetManager:y}=e.constructor.TextDesignSprite;const g=this._ui.getFontLoader();const C=f.getLayoutByIdentifier(d);const v=new C;g.setFonts(b.getFonts());y.setFonts({...y.getFonts(),...b.getVariationsByIdentifier()});return g.load().then(()=>{const x=v.getImagePaths().map(B=>({path:B,fullPath:this._ui.getAssetPath(B),image:null}));return y.loadImages(x).then(()=>{v.onImagesLoaded();return e.createTextDesign({position:r,rotation:o,flipHorizontally:n,flipVertically:a,text:l,color:ue.fromArray(u.rgba),width:c,seed:h,inverted:m,layout:v})})})}};Us.version="3.1.0"});var Ns;var yh=_(()=>{xe();gh();Ns=class extends zs{_serializeTextDesign(e,t){const i=t.serializeOptions(["position","rotation","flipHorizontally","flipVertically","text","color","width","seed","inverted"],true);i.color={rgba:i.color};const r=t.getLayout();if(r){i.identifier=r.constructor.identifier}return{type:"textdesign",options:i}}};Ns.version="3.1.0"});var iC={};Me(iC,{default:()=>gc});var gc;var rC=_(()=>{_h();yh();gc=class{constructor(e){this._editor=e}serialize(...e){const t=new Ns(this._editor);return t.serialize(...e)}deserialize(e){const t=new Us(this._editor,e);return t.deserialize()}};gc.version="3.1.0"});var Gs;var bh=_(()=>{xe();Mr();ln();_h();Gs=class extends Us{_deserializeTextDesign(e,t){const{options:i}=t;const{position:r,rotation:o,flipHorizontally:n,flipVertically:a,text:l,color:u,width:c,seed:h,inverted:m}=i;let{identifier:d}=i;if(d===N.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignBlocksLight.identifier){d=N.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignBlocksLightV310.identifier}else if(d===N.Operations.SpriteOperation.TextDesignSprite.Layouts.TextDesignSunshine.identifier){d=N.Operations.SpriteOperation.TextDesignSprite.LegacyLayouts.TextDesignSunshineV310.identifier}const f="padding"in i?i.padding/c:-1;const b=new Xt(this._ui,this._getOptions("textdesign"));const y=new at(this._ui,{fonts:Te.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:true});const{AssetManager:g}=e.constructor.TextDesignSprite;const C=this._ui.getFontLoader();const v=b.getLayoutByIdentifier(d);const x=new v;C.setFonts(y.getFonts());g.setFonts({...g.getFonts(),...y.getVariationsByIdentifier()});return C.load().then(()=>{const B=x.getImagePaths().map(w=>({path:w,fullPath:this._ui.getAssetPath(w),image:null}));return g.loadImages(B).then(()=>{x.onImagesLoaded();return e.createTextDesign({position:r,rotation:o,flipHorizontally:n,flipVertically:a,text:l,color:ue.fromArray(u.rgba),width:c,seed:h,inverted:m,layout:x,padding:f})})})}};Gs.version="3.2.0"});var Ws;var xh=_(()=>{yh();Ws=class extends Ns{_serializeTextDesign(e,t){const i=t.serializeOptions(["position","rotation","flipHorizontally","flipVertically","text","color","width","seed","inverted","padding"],true);i.color={rgba:i.color};const r=t.getLayout();if(r){i.identifier=r.constructor.identifier}i.padding*=i.width;return{type:"textdesign",options:i}}};Ws.version="3.2.0"});var sC={};Me(sC,{default:()=>_c});var _c;var oC=_(()=>{bh();xh();_c=class{constructor(e){this._editor=e}serialize(...e){const t=new Ws(this._editor);return t.serialize(...e)}deserialize(e){const t=new Gs(this._editor,e);return t.deserialize()}};_c.version="3.2.0"});var Vs;var vh=_(()=>{bh();Vs=class extends Gs{_deserializeOperation(e){return super._deserializeOperation(e)}_deserializeOrientationOperation(e){const{options:t}=e;const i=this._editor.operations.getOrCreate("orientation");if(!i)return Promise.resolve();i.set(t);return Promise.resolve(i)}};Vs.version="3.4.0"});var js;var wh=_(()=>{pc();xh();js=class extends Ws{_serializeOperation(e,t){switch(e.constructor.identifier){case"artfilter":return this._serializeStyle(e);default:return super._serializeOperation(e,t)}}_serializeOrientationOperation(e){return{type:"orientation",options:e.serializeOptions(["flipVertically","flipHorizontally","rotation"],true)}}_serializeStyle(e){const{identifier:t,intensity:i,blendMode:r}=e.getOptions();const{tileEdgeLength:o,overlappingFactor:n}=e.getStyleTransferModel().getOptions();return{type:"artFilter",options:{identifier:t,intensity:i,blendMode:dn[r],tileEdgeLength:o,overlappingFactor:n}}}};js.version="3.4.0"});var nC={};Me(nC,{default:()=>yc});var yc;var aC=_(()=>{vh();wh();yc=class{constructor(e){this._editor=e}serialize(...e){const t=new js(this._editor);return t.serialize(...e)}deserialize(e){const t=new Vs(this._editor,e);return t.deserialize()}};yc.version="3.4.0"});var Hs;var Ch=_(()=>{xe();Mr();ln();vh();Hs=class extends Vs{_deserializeTextDesign(e,t){const{options:i}=t;const{position:r,rotation:o,flipHorizontally:n,flipVertically:a,text:l,color:u,width:c,seed:h,inverted:m,identifier:d}=i;const f="padding"in i?i.padding/c:-1;const b=new Xt(this._ui,this._getOptions("textdesign"));const y=new at(this._ui,{fonts:Te.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:true});const{AssetManager:g}=e.constructor.TextDesignSprite;const C=this._ui.getFontLoader();const v=b.getLayoutByIdentifier(d);const x=new v;C.setFonts(y.getFonts());g.setFonts({...g.getFonts(),...y.getVariationsByIdentifier()});return C.load().then(()=>{const B=x.getImagePaths().map(w=>({path:w,fullPath:this._ui.getAssetPath(w),image:null}));return g.loadImages(B).then(()=>{x.onImagesLoaded();return e.createTextDesign({position:r,rotation:o,flipHorizontally:n,flipVertically:a,text:l,color:ue.fromArray(u.rgba),width:c,seed:h,inverted:m,layout:x,padding:f})})})}};Hs.version="3.5.0"});var qs;var Dh=_(()=>{wh();qs=class extends js{};qs.version="3.5.0"});var lC={};Me(lC,{default:()=>bc});var bc;var uC=_(()=>{Ch();Dh();bc=class{constructor(e){this._editor=e}serialize(...e){const t=new qs(this._editor);return t.serialize(...e)}deserialize(e){const t=new Hs(this._editor,e);return t.deserialize()}};bc.version="3.5.0"});var Ks;var kh=_(()=>{xe();Ch();Ks=class extends Hs{_deserializeAdjustmentsOperation(e){const{AdjustmentsOperation:t}=N.Operations;return super._deserializeAdjustmentsOperation(e).then(i=>{if(!i)return null;const{options:r}=e;const o="sharpness";const n={};if(typeof r[o]==="undefined")return;const{minValue:a,midValue:l,maxValue:u}=t.prototype.availableOptions[o];let c=r[o];c=c<0?l+(l-a)*c:l+(u-l)*c;n[o]=c;i.set(n);return i})}};Ks.version="3.6.0"});var Xs;var Th=_(()=>{Dh();Xs=class extends qs{_serializeAdjustmentsOperation(e){const t=super._serializeAdjustmentsOperation(e);const i="sharpness";const{availableOptions:r}=e;const o={};const n=r[i];const a=e.getOption(i);const{minValue:l,midValue:u,maxValue:c}=n;o[i]=a<=u?(a-l)/(u-l)-1:(a-u)/(c-u);t.options={...t.options,...o};return t}};Xs.version="3.6.0"});var cC={};Me(cC,{default:()=>xc});var xc;var mC=_(()=>{kh();Th();xc=class{constructor(e){this._editor=e}serialize(...e){const t=new Xs(this._editor);return t.serialize(...e)}deserialize(e){const t=new Ks(this._editor,e);return t.deserialize()}};xc.version="3.6.0"});var Ys;var Rh=_(()=>{Di();kh();Ys=class extends Ks{deserialize(){return this._validateVersion().then(()=>this._deserializeAssetLibrary()).then(()=>this._deserializeInputImage()).then(()=>this._deserializeOperations())}_deserializeAssetLibrary(){return new Promise((e,t)=>{const i=this._data;if(!i.assetLibrary){e();return}const{assets:r}=i.assetLibrary;const o=[];for(const n in r){o.push(this._deserializeCustomAssets(n,r[n]))}return Promise.all(o).then(()=>{e()}).catch(n=>{console.error(n);t(n)})})}_deserializeCustomAssets(e,t){switch(e){case"stickers":return this._deserializeCustomStickerAssets(t);default:return Promise.reject(new Error(`Unknown asset type: ${e}`))}}_deserializeCustomStickerAssets(e){let t="none";const i=this._editor.getOptions().editor;if(i&&i.controlsOptions&&i.controlsOptions.sticker){t=i.controlsOptions.sticker.customStickerTintMode||"none"}const r=e.map(o=>{return new Promise((n,a)=>{const{identifier:l,raster:u}=o;const c=o.svg!==void 0;let h=`data:${u.type};base64,${u.data}`;let m=new ft;m.onload=()=>{const d=this._editor.getSDK();m=d.correctExifOrientation(m);if(m.toDataURL){h=m.toDataURL()}let f={data:"",width:1,height:1};if(true){f=this._stickerManager.renderStickerThumbnailFromImage(m)}const b={identifier:l,defaultName:o.name||"",tintMode:t,images:{mediaBase:{uris:[h],rawData:true,isSVG:c,width:m.width,height:m.height},mediaThumb:{uris:[f.data],rawData:true,width:f.width,height:f.height}}};if(c){const y=`data:image/svg+xml;base64,${o.svg.data}`;b.images.mediaBase.uris.push(y)}n(b)};m.onerror=()=>{a(new Error(`Invalid base64 data: ${h}`))};m.src=h})});return Promise.all(r).then(o=>{const n=this._editor.getDynamicAssetsLibrary();n.setAssets("sticker",o);this._stickerManager.reload()})}};Ys.version="3.7.0"});var Js;var Eh=_(()=>{Th();Js=class extends Xs{serialize(e={}){return super.serialize(e).then(t=>{return this._serializeAssetLibrary(t).then(i=>{return i})})}_serializeAssetLibrary(e){if(!this._editor.getDynamicAssetsLibrary){return Promise.resolve(e)}const t=this._editor.getDynamicAssetsLibrary();const i=this._serializeCustomStickerAssets(e,t);if(i.length===0){return Promise.resolve(e)}e.assetLibrary={assets:{stickers:i}};return Promise.resolve(e)}_serializeCustomStickerAssets(e,t){const i=t.getAssets("sticker");if(i.length===0){return[]}const r=e.operations.filter(a=>{return a.type==="sprite"}).flatMap(a=>a.options.sprites).filter(a=>a.type==="sticker").map(a=>a.options.identifier);const o={};r.forEach(a=>{o[a]=true});const n=i.filter(a=>{return o[a.identifier]});return n.map(a=>{const{identifier:l,defaultName:u,images:c}=a;const h=c.mediaBase.uris[0];const{isSVG:m}=c.mediaBase;const d=/^data:(image\/(jpeg|png));base64,(.*)$/g;const f=d.exec(h);const b=f[1];const y=f[3];const g={identifier:l,name:u,raster:{type:b,data:y}};if(u){g.name=u}if(m){g.svg={data:c.mediaBase.uris[1].replace(/^data:image\/svg\+xml;base64,/g,"")}}return g})}};Js.version="3.7.0"});var dC={};Me(dC,{default:()=>vc});var vc;var pC=_(()=>{Rh();Eh();vc=class{constructor(e){this._editor=e}serialize(...e){const t=new Js(this._editor);return t.serialize(...e)}deserialize(e){const t=new Ys(this._editor,e);return t.deserialize()}};vc.version="3.7.0"});var $s;var Sh=_(()=>{Rh();$s=class extends Ys{};$s.version="3.8.0"});var Zs;var Fh=_(()=>{Eh();Zs=class extends Js{_serializeSticker(e,t){const i=super._serializeSticker(e,t);i.options.tintMode=t.getTintMode();return i}};Zs.version="3.8.0"});var hC={};Me(hC,{default:()=>wc});var wc;var fC=_(()=>{Sh();Fh();wc=class{constructor(e){this._editor=e}serialize(...e){const t=new Zs(this._editor);return t.serialize(...e)}deserialize(e){const t=new $s(this._editor,e);return t.deserialize()}};wc.version="3.8.0"});var Qs;var Oh=_(()=>{xe();Sh();Qs=class extends $s{_deserializeTransformOperation(e){return super._deserializeCropOperation(e).then(t=>{if(!t)return;const i=ge.Array.find(this._data.operations,r=>r.type==="orientation");if(i){const{options:r}=i;t.rotate(r.rotation);if(r.flipHorizontally){t.flip("horizontal");t.setRotation(t.getRotation()*-1)}if(r.flipVertically){t.flip("vertical");t.setRotation(t.getRotation()*-1)}}t._ratio=null;return t})}_deserializeText(e,t){const{options:i}=t;const{fontSize:r,lineHeight:o,fontIdentifier:n,alignment:a,rotation:l,maxWidth:u,color:c,backgroundColor:h}=i;const m=this._ui.getFontLoader();let d=this._fontManager.getVariationByIdentifier(n);if(!d){d=this._fontManager.getDefaultVariation()}else{m.setFonts([d.getFont()])}return m.load().then(()=>{const f=e.getInputDimensions(false);const b=f.min();const y=f.x;const g=f.y;const C=u*b/y;const v=r*b/g;const x=e.createText({fontSize:v,lineHeight:o,fontFamily:d.getFontFamily(),fontWeight:d.getFontWeight(),fontIdentifier:d.getIdentifier(),textMetrics:d.getTextMetrics(),alignment:a,rotation:l,maxWidth:C,text:i.text,color:ue.fromArray(c.rgba),backgroundColor:ue.fromArray(h.rgba),position:oe.fromObject(i.position)});x._edited=true;return x})}};Qs.version="3.9.0"});var gC,eo;var Ah=_(()=>{fh();Fh();gC=Math.PI*2;eo=class extends Zs{_serializeTransformOperation(e){const{operations:t}=this._editor;if(t.exists("orientation")){e=e.clone();const o=t.get("orientation");if(o.getFlipVertically()){e.flip("vertical");e.setRotation(e.getRotation()*-1)}if(o.getFlipHorizontally()){e.flip("horizontal");e.setRotation(e.getRotation()*-1)}e.rotate(-o.getRotation())}const i=e.serializeOptions(["start","end","rotation","textureScale"],true);i.rotation=(i.rotation+gC)%gC;if(i.textureScale!==1){i.dimensions=e.getNewDimensions(e.getInputDimensions(false))}delete i.textureScale;const r={type:"transform",options:i};if(e._ratio){let o;if(e._ratio instanceof Ls){o=e._ratio.getIdentifier()}else{o=e._ratio.identifier}r.options.meta={identifier:o}}delete r.options.scale;return r}_serializeText(e,t){const i=e.getInputDimensions(false);const r=super._serializeText(e,t);r.options.fontSize=r.options.fontSize*i.y/i.min();return r}};eo.version="3.9.0"});var _C={};Me(_C,{default:()=>Cc});var Cc;var yC=_(()=>{Oh();Ah();Cc=class{constructor(e){this._editor=e}serialize(...e){const t=new eo(this._editor);return t.serialize(...e)}deserialize(e){const t=new Qs(this._editor,e);return t.deserialize()}};Cc.version="3.9.0"});var Ra;var bC=_(()=>{Oh();Ra=class extends Qs{};Ra.version="3.12.0"});var Ea;var xC=_(()=>{Ah();Ea=class extends eo{_serializeCustomStickerAssets(e,t){const i=t.getAssets("sticker");if(i.length===0){return[]}const r=e.operations.filter(a=>{return a.type==="sprite"}).flatMap(a=>a.options.sprites).filter(a=>a.type==="sticker").map(a=>a.options.identifier);const o={};r.forEach(a=>{o[a]=true});const n=i.filter(a=>{return o[a.identifier]});return n.map(a=>{const{identifier:l,defaultName:u,images:c}=a;const h=c.mediaBase.uris[0];const{isSVG:m}=c.mediaBase;const d=/^data:(image\/(jpeg|png|gif));base64,(.*)$/g;const f=d.exec(h);const b=f[1];const y=f[3];const g={identifier:l,name:u,raster:{type:b,data:y}};if(u){g.name=u}if(m){g.svg={data:c.mediaBase.uris[1].replace(/^data:image\/svg\+xml;base64,/g,"")}}return g})}};Ea.version="3.12.0"});var vC={};Me(vC,{default:()=>Dc});var Dc;var wC=_(()=>{bC();xC();Dc=class{constructor(e){this._editor=e}serialize(...e){const t=new Ea(this._editor);return t.serialize(...e)}deserialize(e){const t=new Ra(this._editor,e);return t.deserialize()}};Dc.version="3.12.0"});var IC="An invariant failed, however the error is obfuscated because this is an production build.";var Sa=[];Object.freeze(Sa);var Kh={};Object.freeze(Kh);var PC={};function ro(){if(typeof window!=="undefined"){return window}if(typeof global!=="undefined"){return global}if(typeof self!=="undefined"){return self}return PC}function Et(){return++U.mobxGuid}function De(s){rr(false,s);throw"X"}function rr(s,e){if(!s)throw new Error("[mobx] "+(e||IC))}var Xh=[];function ki(s,e){if(true)return false;if(e){return ki("'"+s+"', use '"+e+"' instead.")}if(Xh.indexOf(s)!==-1)return false;Xh.push(s);console.error("[mobx] Deprecated: "+s);return true}function Ac(s){var e=false;return function(){if(e)return;e=true;return s.apply(this,arguments)}}var Yh=function(){};function BC(s){var e=[];s.forEach(function(t){if(e.indexOf(t)===-1)e.push(t)});return e}function Ic(s){return s!==null&&typeof s==="object"}function so(s){if(s===null||typeof s!=="object")return false;var e=Object.getPrototypeOf(s);return e===Object.prototype||e===null}function MC(s){if(oo(s)||Ai(s)){return s}else if(Array.isArray(s)){return new Map(s)}else if(so(s)){var e=new Map;for(var t in s){e.set(t,s[t])}return e}else{return De("Cannot convert to map from '"+s+"'")}}function LC(s,e){for(var t=0;t<e.length;t++){Ti(s,e[t],s[e[t]])}}function Ti(s,e,t){Object.defineProperty(s,e,{enumerable:false,writable:true,configurable:true,value:t})}function pn(s,e,t){Object.defineProperty(s,e,{enumerable:false,writable:false,configurable:true,value:t})}function zC(s,e){if(false)De("Cannot make property '"+e+"' observable, it is not configurable and writable in the target object")}function sr(s,e){var t="isMobX"+s;e.prototype[t]=true;return function(i){return Ic(i)&&i[t]===true}}function UC(s,e){return typeof s==="number"&&typeof e==="number"&&isNaN(s)&&isNaN(e)}function oo(s){if(ro().Map!==void 0&&s instanceof ro().Map)return true;return false}function hn(s){return s instanceof Set}function Ri(s){var e=[];while(true){var t=s.next();if(t.done)break;e.push(t.value)}return e}function Jh(){return typeof Symbol==="function"&&Symbol.toPrimitive||"@@toPrimitive"}function $h(s){return s===null?null:typeof s==="object"?""+s:s}function Zh(s,e){var t=s.next();while(!t.done){e(t.value);t=s.next()}}function Qh(){return typeof Symbol==="function"&&Symbol.iterator||"@@iterator"}function Pc(s,e){pn(s,Qh(),e)}function fn(s){s[Qh()]=NC;return s}function Bc(){return typeof Symbol==="function"&&Symbol.toStringTag||"@@toStringTag"}function NC(){return this}var Fa=function(){function s(e){if(e===void 0){e="Atom@"+Et()}this.name=e;this.isPendingUnobservation=false;this.isBeingObserved=false;this.observers=[];this.observersIndexes={};this.diffValue=0;this.lastAccessedBy=0;this.lowestObserverState=fe.NOT_TRACKING}s.prototype.onBecomeUnobserved=function(){};s.prototype.onBecomeObserved=function(){};s.prototype.reportObserved=function(){return gf(this)};s.prototype.reportChanged=function(){Si();mD(this);Fi()};s.prototype.toString=function(){return this.name};return s}();var Mc=sr("Atom",Fa);function ef(s,e,t){if(e===void 0){e=Yh}if(t===void 0){t=Yh}var i=new Fa(s);DD(i,e);Cf(i,t);return i}function tf(s,e){return s===e}function GC(s,e){return Zc(s,e)}function WC(s,e){return Zc(s,e,1)}function VC(s,e){return UC(s,e)||tf(s,e)}var Oa={identity:tf,structural:GC,default:VC,shallow:WC};var Lc=function(s,e){Lc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)if(i.hasOwnProperty(r))t[r]=i[r]};return Lc(s,e)};function rf(s,e){Lc(s,e);function t(){this.constructor=s}s.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Le=function(){Le=Object.assign||function s(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o))e[o]=t[o]}return e};return Le.apply(this,arguments)};function zc(s,e){var t=typeof Symbol==="function"&&s[Symbol.iterator];if(!t)return s;var i=t.call(s),r,o=[],n;try{while((e===void 0||e-- >0)&&!(r=i.next()).done)o.push(r.value)}catch(a){n={error:a}}finally{try{if(r&&!r.done&&(t=i["return"]))t.call(i)}finally{if(n)throw n.error}}return o}function Uc(){for(var s=[],e=0;e<arguments.length;e++)s=s.concat(zc(arguments[e]));return s}var jC={};var HC={};function qC(s,e){var t=e?jC:HC;return t[s]||(t[s]={configurable:true,enumerable:e,get:function(){Nr(this);return this[s]},set:function(i){Nr(this);this[s]=i}})}function Nr(s){if(s.__mobxDidRunLazyInitializers===true)return;var e=s.__mobxDecorators;if(e){Ti(s,"__mobxDidRunLazyInitializers",true);for(var t in e){var i=e[t];i.propertyCreator(s,i.prop,i.descriptor,i.decoratorTarget,i.decoratorArguments)}}}function sf(s,e){return function t(){var i;var r=function o(n,a,l,u){if(u===true){e(n,a,l,n,i);return null}if(false)De("This function is a decorator, but it wasn't invoked like a decorator");if(!Object.prototype.hasOwnProperty.call(n,"__mobxDecorators")){var c=n.__mobxDecorators;Ti(n,"__mobxDecorators",Le({},c))}n.__mobxDecorators[a]={prop:a,propertyCreator:e,descriptor:l,decoratorTarget:n,decoratorArguments:i};return qC(a,s)};if(KC(arguments)){i=Sa;return r.apply(null,arguments)}else{i=Array.prototype.slice.call(arguments);return r}}}function KC(s){return(s.length===2||s.length===3)&&typeof s[1]==="string"||s.length===4&&s[3]===true}function gn(s,e,t){if(Wa(s))return s;if(Array.isArray(s))return Qe.array(s,{name:t});if(so(s))return Qe.object(s,void 0,{name:t});if(oo(s))return Qe.map(s,{name:t});if(hn(s))return Qe.set(s,{name:t});return s}function XC(s,e,t){if(s===void 0||s===null)return s;if(mo(s)||co(s)||Ai(s)||ur(s))return s;if(Array.isArray(s))return Qe.array(s,{name:t,deep:false});if(so(s))return Qe.object(s,void 0,{name:t,deep:false});if(oo(s))return Qe.map(s,{name:t,deep:false});if(hn(s))return Qe.set(s,{name:t,deep:false});return De(false)}function Aa(s){return s}function YC(s,e,t){if(false)throw"observable.struct should not be used with observable values";if(Zc(s,e))return e;return s}function Ia(s){rr(s);var e=sf(true,function(i,r,o,n,a){if(false){rr(!o||!o.get,'@observable cannot be used on getter (property "'+r+'"), use @computed instead.')}var l=o?o.initializer?o.initializer.call(i):o.value:void 0;GD(i,r,l,s)});var t=typeof process!=="undefined"&&process.env&&false?function i(){if(arguments.length<2)return De("Incorrect decorator invocation. @observable decorator doesn't expect any arguments");return e.apply(null,arguments)}:e;t.enhancer=s;return t}var of={deep:true,name:void 0,defaultDecorator:void 0};var JC={deep:false,name:void 0,defaultDecorator:void 0};Object.freeze(of);Object.freeze(JC);function no(s){if(s===null||s===void 0)return of;if(typeof s==="string")return{name:s,deep:true};if(false){if(typeof s!=="object")return De("expected options object");Object.keys(s).forEach(assertValidOption)}return s}function Pa(s){return s.defaultDecorator?s.defaultDecorator.enhancer:s.deep===false?Aa:gn}var Nc=Ia(gn);var $C=Ia(XC);var nf=Ia(Aa);var ZC=Ia(YC);function QC(s,e,t){if(typeof arguments[1]==="string"){return Nc.apply(null,arguments)}if(Wa(s))return s;var i=so(s)?Qe.object(s,e,t):Array.isArray(s)?Qe.array(s,e):oo(s)?Qe.map(s,e):hn(s)?Qe.set(s,e):s;if(i!==s)return i;De(false)}var af={box:function(s,e){if(arguments.length>2)Ei("box");var t=no(e);return new nr(s,Pa(t),t.name,true,t.equals)},shallowBox:function(s,e){if(arguments.length>2)Ei("shallowBox");ki("observable.shallowBox","observable.box(value, { deep: false })");return Qe.box(s,{name:e,deep:false})},array:function(s,e){if(arguments.length>2)Ei("array");var t=no(e);return new ui(s,Pa(t),t.name)},shallowArray:function(s,e){if(arguments.length>2)Ei("shallowArray");ki("observable.shallowArray","observable.array(values, { deep: false })");return Qe.array(s,{name:e,deep:false})},map:function(s,e){if(arguments.length>2)Ei("map");var t=no(e);return new Va(s,Pa(t),t.name)},shallowMap:function(s,e){if(arguments.length>2)Ei("shallowMap");ki("observable.shallowMap","observable.map(values, { deep: false })");return Qe.map(s,{name:e,deep:false})},set:function(s,e){if(arguments.length>2)Ei("set");var t=no(e);return new Ha(s,Pa(t),t.name)},object:function(s,e,t){if(typeof arguments[1]==="string")Ei("object");var i=no(t);return kD({},s,e,i)},shallowObject:function(s,e){if(typeof arguments[1]==="string")Ei("shallowObject");ki("observable.shallowObject","observable.object(values, {}, { deep: false })");return Qe.object(s,{},{name:e,deep:false})},ref:nf,shallow:$C,deep:Nc,struct:ZC};var Qe=QC;Object.keys(af).forEach(function(s){return Qe[s]=af[s]});function Ei(s){De("Expected one or two arguments to observable."+s+". Did you accidentally try to use observable."+s+" as decorator?")}var Ba=sf(false,function(s,e,t,i,r){if(false){rr(t&&t.get,"Trying to declare a computed value for unspecified getter '"+e+"'")}var o=t.get,n=t.set;var a=r[0]||{};WD(s,e,Le({get:o,set:n},a))});var eD=Ba({equals:Oa.structural});var tD=function s(e,t,i){if(typeof t==="string"){return Ba.apply(null,arguments)}if(e!==null&&typeof e==="object"&&arguments.length===1){return Ba.apply(null,arguments)}if(false){rr(typeof e==="function","First argument to `computed` should be an expression.");rr(arguments.length<3,"Computed takes one or two arguments if used as function")}var r=typeof t==="object"?t:{};r.get=e;r.set=typeof t==="function"?t:r.set;r.name=r.name||e.name||"";return new ar(r)};tD.struct=eD;var fe;(function(s){s[s["NOT_TRACKING"]=-1]="NOT_TRACKING";s[s["UP_TO_DATE"]=0]="UP_TO_DATE";s[s["POSSIBLY_STALE"]=1]="POSSIBLY_STALE";s[s["STALE"]=2]="STALE"})(fe||(fe={}));var Yt;(function(s){s[s["NONE"]=0]="NONE";s[s["LOG"]=1]="LOG";s[s["BREAK"]=2]="BREAK"})(Yt||(Yt={}));var Ma=function(){function s(e){this.cause=e}return s}();function _n(s){return s instanceof Ma}function Gc(s){switch(s.dependenciesState){case fe.UP_TO_DATE:return false;case fe.NOT_TRACKING:case fe.STALE:return true;case fe.POSSIBLY_STALE:{var e=Vc(true);var t=lo();var i=s.observing,r=i.length;for(var o=0;o<r;o++){var n=i[o];if(za(n)){if(U.disableErrorBoundaries){n.get()}else{try{n.get()}catch(a){or(t);yn(e);return true}}if(s.dependenciesState===fe.STALE){or(t);yn(e);return true}}}cf(s);or(t);yn(e);return false}}}function ao(s){var e=s.observers.length>0;if(U.computationDepth>0&&e)De(false);if(!U.allowStateChanges&&(e||U.enforceActions==="strict"))De(false)}function iD(s){if(false){console.warn("[mobx] Observable "+s.name+" being read outside a reactive context")}}function lf(s,e,t){var i=Vc(true);cf(s);s.newObserving=new Array(s.observing.length+100);s.unboundDepsCount=0;s.runId=++U.runId;var r=U.trackingDerivation;U.trackingDerivation=s;var o;if(U.disableErrorBoundaries===true){o=e.call(t)}else{try{o=e.call(t)}catch(n){o=new Ma(n)}}U.trackingDerivation=r;sD(s);if(s.observing.length===0){rD(s)}yn(i);return o}function rD(s){if(true)return;if(U.reactionRequiresObservable||s.requiresObservable){console.warn("[mobx] Derivation "+s.name+" is created/updated without reading any observable value")}}function sD(s){var e=s.observing;var t=s.observing=s.newObserving;var i=fe.UP_TO_DATE;var r=0,o=s.unboundDepsCount;for(var n=0;n<o;n++){var a=t[n];if(a.diffValue===0){a.diffValue=1;if(r!==n)t[r]=a;r++}if(a.dependenciesState>i){i=a.dependenciesState}}t.length=r;s.newObserving=null;o=e.length;while(o--){var a=e[o];if(a.diffValue===0){hf(a,s)}a.diffValue=0}while(r--){var a=t[r];if(a.diffValue===1){a.diffValue=0;cD(a,s)}}if(i!==fe.UP_TO_DATE){s.dependenciesState=i;s.onBecomeStale()}}function Wc(s){var e=s.observing;s.observing=[];var t=e.length;while(t--)hf(e[t],s);s.dependenciesState=fe.NOT_TRACKING}function uf(s){var e=lo();var t=s();or(e);return t}function lo(){var s=U.trackingDerivation;U.trackingDerivation=null;return s}function or(s){U.trackingDerivation=s}function Vc(s){var e=U.allowStateReads;U.allowStateReads=s;return e}function yn(s){U.allowStateReads=s}function cf(s){if(s.dependenciesState===fe.UP_TO_DATE)return;s.dependenciesState=fe.UP_TO_DATE;var e=s.observing;var t=e.length;while(t--)e[t].lowestObserverState=fe.UP_TO_DATE}var La=0;var oD=1;var mf=Object.getOwnPropertyDescriptor(function(){},"name");var DS=mf&&mf.configurable;function Gr(s,e){if(false){rr(typeof e==="function","`action` can only be invoked on functions");if(typeof s!=="string"||!s)De("actions should have valid names, got: '"+s+"'")}var t=function(){return df(s,e,this,arguments)};if(false){if(DS){Object.defineProperty(t,"name",{value:s})}}t.isMobxAction=true;return t}function df(s,e,t,i){var r=nD(s,t,i);try{return e.apply(t,i)}catch(o){r.error=o;throw o}finally{aD(r)}}function nD(s,e,t){var i=et()&&!!s;var r=0;if(i){r=Date.now();var o=t&&t.length||0;var n=new Array(o);if(o>0)for(var a=0;a<o;a++)n[a]=t[a];Jt({type:"action",name:s,object:e,arguments:n})}var l=lo();Si();var u=bn(true);var c=Vc(true);var h={prevDerivation:l,prevAllowStateChanges:u,prevAllowStateReads:c,notifySpy:i,startTime:r,actionId:oD++,parentActionId:La};La=h.actionId;return h}function aD(s){if(La!==s.actionId){De("invalid action stack. did you forget to finish an action?")}La=s.parentActionId;if(s.error!==void 0){U.suppressReactionErrors=true}xn(s.prevAllowStateChanges);yn(s.prevAllowStateReads);Fi();or(s.prevDerivation);if(s.notifySpy){$t({time:Date.now()-s.startTime})}U.suppressReactionErrors=false}function kS(s,e){var t=bn(s);var i;try{i=e()}finally{xn(t)}return i}function bn(s){var e=U.allowStateChanges;U.allowStateChanges=s;return e}function xn(s){U.allowStateChanges=s}var nr=function(s){rf(e,s);function e(t,i,r,o,n){if(r===void 0){r="ObservableValue@"+Et()}if(o===void 0){o=true}if(n===void 0){n=Oa.default}var a=s.call(this,r)||this;a.enhancer=i;a.name=r;a.equals=n;a.hasUnreportedChange=false;a.value=i(t,void 0,r);if(o&&et()){Wr({type:"create",name:a.name,newValue:""+a.value})}return a}e.prototype.dehanceValue=function(t){if(this.dehancer!==void 0)return this.dehancer(t);return t};e.prototype.set=function(t){var i=this.value;t=this.prepareNewValue(t);if(t!==U.UNCHANGED){var r=et();if(r){Jt({type:"update",name:this.name,newValue:t,oldValue:i})}this.setNewValue(t);if(r)$t()}};e.prototype.prepareNewValue=function(t){ao(this);if(ai(this)){var i=li(this,{object:this,type:"update",newValue:t});if(!i)return U.UNCHANGED;t=i.newValue}t=this.enhancer(t,this.value,this.name);return this.equals(this.value,t)?U.UNCHANGED:t};e.prototype.setNewValue=function(t){var i=this.value;this.value=t;this.reportChanged();if(Zt(this)){Qt(this,{type:"update",object:this,newValue:t,oldValue:i})}};e.prototype.get=function(){this.reportObserved();return this.dehanceValue(this.value)};e.prototype.intercept=function(t){return vn(this,t)};e.prototype.observe=function(t,i){if(i)t({object:this,type:"update",newValue:this.value,oldValue:void 0});return wn(this,t)};e.prototype.toJSON=function(){return this.get()};e.prototype.toString=function(){return this.name+"["+this.value+"]"};e.prototype.valueOf=function(){return $h(this.get())};return e}(Fa);nr.prototype[Jh()]=nr.prototype.valueOf;var lD=sr("ObservableValue",nr);var ar=function(){function s(e){this.dependenciesState=fe.NOT_TRACKING;this.observing=[];this.newObserving=null;this.isBeingObserved=false;this.isPendingUnobservation=false;this.observers=[];this.observersIndexes={};this.diffValue=0;this.runId=0;this.lastAccessedBy=0;this.lowestObserverState=fe.UP_TO_DATE;this.unboundDepsCount=0;this.__mapid="#"+Et();this.value=new Ma(null);this.isComputing=false;this.isRunningSetter=false;this.isTracing=Yt.NONE;rr(e.get,"missing option for computed: get");this.derivation=e.get;this.name=e.name||"ComputedValue@"+Et();if(e.set)this.setter=Gr(this.name+"-setter",e.set);this.equals=e.equals||(e.compareStructural||e.struct?Oa.structural:Oa.default);this.scope=e.context;this.requiresReaction=!!e.requiresReaction;this.keepAlive=!!e.keepAlive}s.prototype.onBecomeStale=function(){pD(this)};s.prototype.onBecomeUnobserved=function(){};s.prototype.onBecomeObserved=function(){};s.prototype.get=function(){if(this.isComputing)De("Cycle detected in computation "+this.name+": "+this.derivation);if(U.inBatch===0&&this.observers.length===0&&!this.keepAlive){if(Gc(this)){this.warnAboutUntrackedRead();Si();this.value=this.computeValue(false);Fi()}}else{gf(this);if(Gc(this)){if(this.trackAndCompute())dD(this)}}var e=this.value;if(_n(e))throw e.cause;return e};s.prototype.peek=function(){var e=this.computeValue(false);if(_n(e))throw e.cause;return e};s.prototype.set=function(e){if(this.setter){rr(!this.isRunningSetter,"The setter of computed value '"+this.name+"' is trying to update itself. Did you intend to update an _observable_ value, instead of the computed property?");this.isRunningSetter=true;try{this.setter.call(this.scope,e)}finally{this.isRunningSetter=false}}else rr(false,false)};s.prototype.trackAndCompute=function(){if(et()){Wr({object:this.scope,type:"compute",name:this.name})}var e=this.value;var t=this.dependenciesState===fe.NOT_TRACKING;var i=this.computeValue(true);var r=t||_n(e)||_n(i)||!this.equals(e,i);if(r){this.value=i}return r};s.prototype.computeValue=function(e){this.isComputing=true;U.computationDepth++;var t;if(e){t=lf(this,this.derivation,this.scope)}else{if(U.disableErrorBoundaries===true){t=this.derivation.call(this.scope)}else{try{t=this.derivation.call(this.scope)}catch(i){t=new Ma(i)}}}U.computationDepth--;this.isComputing=false;return t};s.prototype.suspend=function(){if(!this.keepAlive){Wc(this);this.value=void 0}};s.prototype.observe=function(e,t){var i=this;var r=true;var o=void 0;return vD(function(){var n=i.get();if(!r||t){var a=lo();e({type:"update",object:i,newValue:n,oldValue:o});or(a)}r=false;o=n})};s.prototype.warnAboutUntrackedRead=function(){if(true)return;if(this.requiresReaction===true){De("[mobx] Computed value "+this.name+" is read outside a reactive context")}if(this.isTracing!==Yt.NONE){console.log("[mobx.trace] '"+this.name+"' is being read outside a reactive context. Doing a full recompute")}if(U.computedRequiresReaction){console.warn("[mobx] Computed value "+this.name+" is being read outside a reactive context. Doing a full recompute")}};s.prototype.toJSON=function(){return this.get()};s.prototype.toString=function(){return this.name+"["+this.derivation.toString()+"]"};s.prototype.valueOf=function(){return $h(this.get())};return s}();ar.prototype[Jh()]=ar.prototype.valueOf;var za=sr("ComputedValue",ar);var Ua=function(){function s(){this.version=5;this.UNCHANGED={};this.trackingDerivation=null;this.computationDepth=0;this.runId=0;this.mobxGuid=0;this.inBatch=0;this.pendingUnobservations=[];this.pendingReactions=[];this.isRunningReactions=false;this.allowStateChanges=true;this.allowStateReads=true;this.enforceActions=false;this.spyListeners=[];this.globalReactionErrorHandlers=[];this.computedRequiresReaction=false;this.reactionRequiresObservable=false;this.observableRequiresReaction=false;this.computedConfigurable=false;this.disableErrorBoundaries=false;this.suppressReactionErrors=false}return s}();var Na=true;var pf=false;var U=function(){var s=ro();if(s.__mobxInstanceCount>0&&!s.__mobxGlobals)Na=false;if(s.__mobxGlobals&&s.__mobxGlobals.version!==new Ua().version)Na=false;if(!Na){setTimeout(function(){if(!pf){De("There are multiple, different versions of MobX active. Make sure MobX is loaded only once or use `configure({ isolateGlobalState: true })`")}},1);return new Ua}else if(s.__mobxGlobals){s.__mobxInstanceCount+=1;if(!s.__mobxGlobals.UNCHANGED)s.__mobxGlobals.UNCHANGED={};return s.__mobxGlobals}else{s.__mobxInstanceCount=1;return s.__mobxGlobals=new Ua}}();function uD(){if(U.pendingReactions.length||U.inBatch||U.isRunningReactions)De("isolateGlobalState should be called before MobX is running any reactions");pf=true;if(Na){if(--ro().__mobxInstanceCount===0)ro().__mobxGlobals=void 0;U=new Ua}}function cD(s,e){var t=s.observers.length;if(t){s.observersIndexes[e.__mapid]=t}s.observers[t]=e;if(s.lowestObserverState>e.dependenciesState)s.lowestObserverState=e.dependenciesState}function hf(s,e){if(s.observers.length===1){s.observers.length=0;ff(s)}else{var t=s.observers;var i=s.observersIndexes;var r=t.pop();if(r!==e){var o=i[e.__mapid]||0;if(o){i[r.__mapid]=o}else{delete i[r.__mapid]}t[o]=r}delete i[e.__mapid]}}function ff(s){if(s.isPendingUnobservation===false){s.isPendingUnobservation=true;U.pendingUnobservations.push(s)}}function Si(){U.inBatch++}function Fi(){if(--U.inBatch===0){xf();var s=U.pendingUnobservations;for(var e=0;e<s.length;e++){var t=s[e];t.isPendingUnobservation=false;if(t.observers.length===0){if(t.isBeingObserved){t.isBeingObserved=false;t.onBecomeUnobserved()}if(t instanceof ar){t.suspend()}}}U.pendingUnobservations=[]}}function gf(s){iD(s);var e=U.trackingDerivation;if(e!==null){if(e.runId!==s.lastAccessedBy){s.lastAccessedBy=e.runId;e.newObserving[e.unboundDepsCount++]=s;if(!s.isBeingObserved){s.isBeingObserved=true;s.onBecomeObserved()}}return true}else if(s.observers.length===0&&U.inBatch>0){ff(s)}return false}function mD(s){if(s.lowestObserverState===fe.STALE)return;s.lowestObserverState=fe.STALE;var e=s.observers;var t=e.length;while(t--){var i=e[t];if(i.dependenciesState===fe.UP_TO_DATE){if(i.isTracing!==Yt.NONE){_f(i,s)}i.onBecomeStale()}i.dependenciesState=fe.STALE}}function dD(s){if(s.lowestObserverState===fe.STALE)return;s.lowestObserverState=fe.STALE;var e=s.observers;var t=e.length;while(t--){var i=e[t];if(i.dependenciesState===fe.POSSIBLY_STALE)i.dependenciesState=fe.STALE;else if(i.dependenciesState===fe.UP_TO_DATE)s.lowestObserverState=fe.UP_TO_DATE}}function pD(s){if(s.lowestObserverState!==fe.UP_TO_DATE)return;s.lowestObserverState=fe.POSSIBLY_STALE;var e=s.observers;var t=e.length;while(t--){var i=e[t];if(i.dependenciesState===fe.UP_TO_DATE){i.dependenciesState=fe.POSSIBLY_STALE;if(i.isTracing!==Yt.NONE){_f(i,s)}i.onBecomeStale()}}}function _f(s,e){console.log("[mobx.trace] '"+s.name+"' is invalidated due to a change in: '"+e.name+"'");if(s.isTracing===Yt.BREAK){var t=[];yf(TD(s),t,1);new Function("debugger;\n/*\nTracing '"+s.name+"'\n\nYou are entering this break point because derivation '"+s.name+"' is being traced and '"+e.name+"' is now forcing it to update.\nJust follow the stacktrace you should now see in the devtools to see precisely what piece of your code is causing this update\nThe stackframe you are looking for is at least ~6-8 stack-frames up.\n\n"+(s instanceof ar?s.derivation.toString().replace(/[*]\//g,"/"):"")+"\n\nThe dependencies for this derivation are:\n\n"+t.join("\n")+"\n*/\n    ")()}}function yf(s,e,t){if(e.length>=1e3){e.push("(and many more)");return}e.push(""+new Array(t).join("	")+s.name);if(s.dependencies)s.dependencies.forEach(function(i){return yf(i,e,t+1)})}var jc=function(){function s(e,t,i,r){if(e===void 0){e="Reaction@"+Et()}if(r===void 0){r=false}this.name=e;this.onInvalidate=t;this.errorHandler=i;this.requiresObservable=r;this.observing=[];this.newObserving=[];this.dependenciesState=fe.NOT_TRACKING;this.diffValue=0;this.runId=0;this.unboundDepsCount=0;this.__mapid="#"+Et();this.isDisposed=false;this._isScheduled=false;this._isTrackPending=false;this._isRunning=false;this.isTracing=Yt.NONE}s.prototype.onBecomeStale=function(){this.schedule()};s.prototype.schedule=function(){if(!this._isScheduled){this._isScheduled=true;U.pendingReactions.push(this);xf()}};s.prototype.isScheduled=function(){return this._isScheduled};s.prototype.runReaction=function(){if(!this.isDisposed){Si();this._isScheduled=false;if(Gc(this)){this._isTrackPending=true;try{this.onInvalidate();if(this._isTrackPending&&et()){Wr({name:this.name,type:"scheduled-reaction"})}}catch(e){this.reportExceptionInDerivation(e)}}Fi()}};s.prototype.track=function(e){Si();var t=et();var i;if(t){i=Date.now();Jt({name:this.name,type:"reaction"})}this._isRunning=true;var r=lf(this,e,void 0);this._isRunning=false;this._isTrackPending=false;if(this.isDisposed){Wc(this)}if(_n(r))this.reportExceptionInDerivation(r.cause);if(t){$t({time:Date.now()-i})}Fi()};s.prototype.reportExceptionInDerivation=function(e){var t=this;if(this.errorHandler){this.errorHandler(e,this);return}if(U.disableErrorBoundaries)throw e;var i="[mobx] Encountered an uncaught exception that was thrown by a reaction or observer component, in: '"+this+"'";if(U.suppressReactionErrors){console.warn("[mobx] (error in reaction '"+this.name+"' suppressed, fix error of causing action below)")}else{console.error(i,e)}if(et()){Wr({type:"error",name:this.name,message:i,error:""+e})}U.globalReactionErrorHandlers.forEach(function(r){return r(e,t)})};s.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=true;if(!this._isRunning){Si();Wc(this);Fi()}}};s.prototype.getDisposer=function(){var e=this.dispose.bind(this);e.$mobx=this;return e};s.prototype.toString=function(){return"Reaction["+this.name+"]"};s.prototype.trace=function(e){if(e===void 0){e=false}OD(this,e)};return s}();var bf=100;var Hc=function(s){return s()};function xf(){if(U.inBatch>0||U.isRunningReactions)return;Hc(hD)}function hD(){U.isRunningReactions=true;var s=U.pendingReactions;var e=0;while(s.length>0){if(++e===bf){console.error("Reaction doesn't converge to a stable state after "+bf+" iterations."+(" Probably there is a cycle in the reactive function: "+s[0]));s.splice(0)}var t=s.splice(0);for(var i=0,r=t.length;i<r;i++)t[i].runReaction()}U.isRunningReactions=false}var Ga=sr("Reaction",jc);function fD(s){var e=Hc;Hc=function(t){return s(function(){return e(t)})}}function et(){return!!U.spyListeners.length}function Wr(s){if(!U.spyListeners.length)return;var e=U.spyListeners;for(var t=0,i=e.length;t<i;t++)e[t](s)}function Jt(s){var e=Le(Le({},s),{spyReportStart:true});Wr(e)}var gD={spyReportEnd:true};function $t(s){if(s)Wr(Le(Le({},s),{spyReportEnd:true}));else Wr(gD)}function _D(s){U.spyListeners.push(s);return Ac(function(){U.spyListeners=U.spyListeners.filter(function(e){return e!==s})})}function yD(){De(false)}function vf(s){return function(e,t,i){if(i){if(false){return De("@action cannot be used with getters")}if(i.value){return{value:Gr(s,i.value),enumerable:false,configurable:true,writable:true}}var r=i.initializer;return{enumerable:false,configurable:true,writable:true,initializer:function(){return Gr(s,r.call(this))}}}return bD(s).apply(this,arguments)}}function bD(s){return function(e,t,i){Object.defineProperty(e,t,{configurable:true,enumerable:false,get:function(){return void 0},set:function(r){Ti(this,t,wf(s,r))}})}}function xD(s,e,t,i){if(i===true){qc(s,e,t.value);return null}if(t){return{configurable:true,enumerable:false,get:function(){qc(this,e,t.value||t.initializer.call(this));return this[e]},set:yD}}return{enumerable:false,configurable:true,set:function(r){qc(this,e,r)},get:function(){return void 0}}}var wf=function s(e,t,i,r){if(arguments.length===1&&typeof e==="function")return Gr(e.name||"<unnamed action>",e);if(arguments.length===2&&typeof t==="function")return Gr(e,t);if(arguments.length===1&&typeof e==="string")return vf(e);if(r===true){e[t]=Gr(e.name||t,i.value)}else{return vf(t).apply(null,arguments)}};wf.bound=xD;function TS(s,e){var t=typeof s==="string"?s:s.name||"<unnamed action>";var i=typeof s==="function"?s:e;if(false){rr(typeof i==="function"&&i.length===0,"`runInAction` expects a function without arguments");if(typeof t!=="string"||!t)De("actions should have valid names, got: '"+t+"'")}return df(t,i,this,void 0)}function qc(s,e,t){Ti(s,e,Gr(e,t.bind(s)))}function vD(s,e){if(e===void 0){e=Kh}if(false){rr(typeof s==="function","Autorun expects a function as first argument");rr(isAction(s)===false,"Autorun does not accept actions since actions are untrackable")}var t=e&&e.name||s.name||"Autorun@"+Et();var i=!e.scheduler&&!e.delay;var r;if(i){r=new jc(t,function(){this.track(a)},e.onError,e.requiresObservable)}else{var o=CD(e);var n=false;r=new jc(t,function(){if(!n){n=true;o(function(){n=false;if(!r.isDisposed)r.track(a)})}},e.onError,e.requiresObservable)}function a(){s(r)}r.schedule();return r.getDisposer()}var wD=function(s){return s()};function CD(s){return s.scheduler?s.scheduler:s.delay?function(e){return setTimeout(e,s.delay)}:wD}function DD(s,e,t){return Df("onBecomeObserved",s,e,t)}function Cf(s,e,t){return Df("onBecomeUnobserved",s,e,t)}function Df(s,e,t,i){var r=typeof i==="function"?cr(e,t):cr(e);var o=typeof i==="function"?i:t;var n=r[s];if(typeof n!=="function")return De(false);r[s]=function(){n.call(this);o.call(this)};return function(){r[s]=n}}function RS(s){var e=s.enforceActions,t=s.computedRequiresReaction,i=s.computedConfigurable,r=s.disableErrorBoundaries,o=s.arrayBuffer,n=s.reactionScheduler,a=s.reactionRequiresObservable,l=s.observableRequiresReaction;if(s.isolateGlobalState===true){uD()}if(e!==void 0){if(typeof e==="boolean"||e==="strict")ki(`Deprecated value for 'enforceActions', use 'false' => '"never"', 'true' => '"observed"', '"strict"' => "'always'" instead`);var u=void 0;switch(e){case true:case"observed":u=true;break;case false:case"never":u=false;break;case"strict":case"always":u="strict";break;default:De("Invalid value for 'enforceActions': '"+e+"', expected 'never', 'always' or 'observed'")}U.enforceActions=u;U.allowStateChanges=u===true||u==="strict"?false:true}if(t!==void 0){U.computedRequiresReaction=!!t}if(a!==void 0){U.reactionRequiresObservable=!!a}if(l!==void 0){U.observableRequiresReaction=!!l;U.allowStateReads=!U.observableRequiresReaction}if(i!==void 0){U.computedConfigurable=!!i}if(r!==void 0){if(r===true)console.warn("WARNING: Debug feature only. MobX will NOT recover from errors if this is on.");U.disableErrorBoundaries=!!r}if(typeof o==="number"){Jc(o)}if(n){fD(n)}}function kD(s,e,t,i){if(false){rr(arguments.length>=2&&arguments.length<=4,"'extendObservable' expected 2-4 arguments");rr(typeof s==="object","'extendObservable' expects an object as first argument");rr(!Ai(s),"'extendObservable' should not be used on maps, use map.merge instead");rr(!Wa(e),"Extending an object with another observable (object) is not supported. Please construct an explicit propertymap, using `toJS` if need. See issue #540");if(t){for(var r in t)if(!(r in e))De("Trying to declare a decorator for unspecified property '"+r+"'")}}i=no(i);var o=i.defaultDecorator||(i.deep===false?nf:Nc);Nr(s);$c(s,i.name,o.enhancer);Si();try{var n=Object.getOwnPropertyNames(e);for(var a=0,l=n.length;a<l;a++){var r=n[a];var u=Object.getOwnPropertyDescriptor(e,r);if(false){if(isComputed(u.value))De("Passing a 'computed' as initial property value is no longer supported by extendObservable. Use a getter or decorator instead")}var c=t&&r in t?t[r]:u.get?Ba:o;if(false)return De("Not a valid decorator for '"+r+"', got: "+c);var h=c(s,r,u,true);if(h)Object.defineProperty(s,r,h)}}finally{Fi()}return s}function TD(s,e){return kf(cr(s,e))}function kf(s){var e={name:s.name};if(s.observing&&s.observing.length>0)e.dependencies=BC(s.observing).map(kf);return e}function RD(){this.message="FLOW_CANCELLED"}RD.prototype=Object.create(Error.prototype);function ED(s,e){if(s===null||s===void 0)return false;if(e!==void 0){if(false)return De("isObservable(object, propertyName) is not supported for arrays and maps. Use map.has or array.length instead.");if(mo(s)){var t=s.$mobx;return t.values&&!!t.values[e]}return false}return mo(s)||!!s.$mobx||Mc(s)||Ga(s)||za(s)}function Wa(s){if(arguments.length!==1)De(false);return ED(s)}function SD(s){if(mo(s)){return s.$mobx.getKeys()}if(Ai(s)){return Ri(s.keys())}if(ur(s)){return Ri(s.keys())}if(co(s)){return s.map(function(e,t){return t})}return De(false)}var FD={detectCycles:true,exportMapsAsObjects:true,recurseEverything:false};function uo(s,e,t,i){if(i.detectCycles)s.set(e,t);return t}function lr(s,e,t){if(!e.recurseEverything&&!Wa(s))return s;if(typeof s!=="object")return s;if(s===null)return null;if(s instanceof Date)return s;if(lD(s))return lr(s.get(),e,t);if(Wa(s))SD(s);var i=e.detectCycles===true;if(i&&s!==null&&t.has(s)){return t.get(s)}if(co(s)||Array.isArray(s)){var r=uo(t,s,[],e);var o=s.map(function(f){return lr(f,e,t)});r.length=o.length;for(var n=0,a=o.length;n<a;n++)r[n]=o[n];return r}if(ur(s)||Object.getPrototypeOf(s)===Set.prototype){if(e.exportMapsAsObjects===false){var l=uo(t,s,new Set,e);s.forEach(function(f){l.add(lr(f,e,t))});return l}else{var u=uo(t,s,[],e);s.forEach(function(f){u.push(lr(f,e,t))});return u}}if(Ai(s)||Object.getPrototypeOf(s)===Map.prototype){if(e.exportMapsAsObjects===false){var c=uo(t,s,new Map,e);s.forEach(function(f,b){c.set(b,lr(f,e,t))});return c}else{var h=uo(t,s,{},e);s.forEach(function(f,b){h[b]=lr(f,e,t)});return h}}var m=uo(t,s,{},e);for(var d in s){m[d]=lr(s[d],e,t)}return m}function Kc(s,e){if(typeof e==="boolean")e={detectCycles:e};if(!e)e=FD;e.detectCycles=e.detectCycles===void 0?e.recurseEverything===true:e.detectCycles===true;var t;if(e.detectCycles)t=new Map;return lr(s,e,t)}function OD(){var s=[];for(var e=0;e<arguments.length;e++){s[e]=arguments[e]}var t=false;if(typeof s[s.length-1]==="boolean")t=s.pop();var i=AD(s);if(!i){return De(false)}if(i.isTracing===Yt.NONE){console.log("[mobx.trace] '"+i.name+"' tracing enabled")}i.isTracing=t?Yt.BREAK:Yt.LOG}function AD(s){switch(s.length){case 0:return U.trackingDerivation;case 1:return cr(s[0]);case 2:return cr(s[0],s[1])}}function Oi(s,e){if(e===void 0){e=void 0}Si();try{return s.apply(e)}finally{Fi()}}function ai(s){return s.interceptors!==void 0&&s.interceptors.length>0}function vn(s,e){var t=s.interceptors||(s.interceptors=[]);t.push(e);return Ac(function(){var i=t.indexOf(e);if(i!==-1)t.splice(i,1)})}function li(s,e){var t=lo();try{var i=s.interceptors;if(i)for(var r=0,o=i.length;r<o;r++){e=i[r](e);rr(!e||e.type,"Intercept handlers should return nothing or a change object");if(!e)break}return e}finally{or(t)}}function Zt(s){return s.changeListeners!==void 0&&s.changeListeners.length>0}function wn(s,e){var t=s.changeListeners||(s.changeListeners=[]);t.push(e);return Ac(function(){var i=t.indexOf(e);if(i!==-1)t.splice(i,1)})}function Qt(s,e){var t=lo();var i=s.changeListeners;if(!i)return;i=i.slice();for(var r=0,o=i.length;r<o;r++){i[r](e)}or(t)}var ID=1e4;var PD=function(){var s=false;var e={};Object.defineProperty(e,"0",{set:function(){s=true}});Object.create(e)["0"]=1;return s===false}();var Xc=0;var Yc=function(){function s(){}return s}();function BD(s,e){if(typeof Object["setPrototypeOf"]!=="undefined"){Object["setPrototypeOf"](s.prototype,e)}else if(typeof s.prototype.__proto__!=="undefined"){s.prototype.__proto__=e}else{s["prototype"]=e}}BD(Yc,Array.prototype);if(Object.isFrozen(Array)){["constructor","push","shift","concat","pop","unshift","replace","find","findIndex","splice","reverse","sort"].forEach(function(s){Object.defineProperty(Yc.prototype,s,{configurable:true,writable:true,value:Array.prototype[s]})})}var Tf=function(){function s(e,t,i,r){this.array=i;this.owned=r;this.values=[];this.lastKnownLength=0;this.atom=new Fa(e||"ObservableArray@"+Et());this.enhancer=function(o,n){return t(o,n,e+"[..]")}}s.prototype.dehanceValue=function(e){if(this.dehancer!==void 0)return this.dehancer(e);return e};s.prototype.dehanceValues=function(e){if(this.dehancer!==void 0&&e.length>0)return e.map(this.dehancer);return e};s.prototype.intercept=function(e){return vn(this,e)};s.prototype.observe=function(e,t){if(t===void 0){t=false}if(t){e({object:this.array,type:"splice",index:0,added:this.values.slice(),addedCount:this.values.length,removed:[],removedCount:0})}return wn(this,e)};s.prototype.getArrayLength=function(){this.atom.reportObserved();return this.values.length};s.prototype.setArrayLength=function(e){if(typeof e!=="number"||e<0)throw new Error("[mobx.array] Out of range: "+e);var t=this.values.length;if(e===t)return;else if(e>t){var i=new Array(e-t);for(var r=0;r<e-t;r++)i[r]=void 0;this.spliceWithArray(t,0,i)}else this.spliceWithArray(e,t-e)};s.prototype.updateArrayLength=function(e,t){if(e!==this.lastKnownLength)throw new Error("[mobx] Modification exception: the internal structure of an observable array was changed. Did you use peek() to change it?");this.lastKnownLength+=t;if(t>0&&e+t+1>Xc)Jc(e+t+1)};s.prototype.spliceWithArray=function(e,t,i){var r=this;ao(this.atom);var o=this.values.length;if(e===void 0)e=0;else if(e>o)e=o;else if(e<0)e=Math.max(0,o+e);if(arguments.length===1)t=o-e;else if(t===void 0||t===null)t=0;else t=Math.max(0,Math.min(t,o-e));if(i===void 0)i=Sa;if(ai(this)){var n=li(this,{object:this.array,type:"splice",index:e,removedCount:t,added:i});if(!n)return Sa;t=n.removedCount;i=n.added}i=i.length===0?i:i.map(function(u){return r.enhancer(u,void 0)});var a=i.length-t;this.updateArrayLength(o,a);var l=this.spliceItemsIntoValues(e,t,i);if(t!==0||i.length!==0)this.notifyArraySplice(e,i,l);return this.dehanceValues(l)};s.prototype.spliceItemsIntoValues=function(e,t,i){var r;if(i.length<ID){return(r=this.values).splice.apply(r,Uc([e,t],i))}else{var o=this.values.slice(e,e+t);this.values=this.values.slice(0,e).concat(i,this.values.slice(e+t));return o}};s.prototype.notifyArrayChildUpdate=function(e,t,i){var r=!this.owned&&et();var o=Zt(this);var n=o||r?{object:this.array,type:"update",index:e,newValue:t,oldValue:i}:null;if(r)Jt(Le(Le({},n),{name:this.atom.name}));this.atom.reportChanged();if(o)Qt(this,n);if(r)$t()};s.prototype.notifyArraySplice=function(e,t,i){var r=!this.owned&&et();var o=Zt(this);var n=o||r?{object:this.array,type:"splice",index:e,removed:i,added:t,removedCount:i.length,addedCount:t.length}:null;if(r)Jt(Le(Le({},n),{name:this.atom.name}));this.atom.reportChanged();if(o)Qt(this,n);if(r)$t()};return s}();var ui=function(s){rf(e,s);function e(t,i,r,o){if(r===void 0){r="ObservableArray@"+Et()}if(o===void 0){o=false}var n=s.call(this)||this;var a=new Tf(r,i,n,o);pn(n,"$mobx",a);if(t&&t.length){var l=bn(true);n.spliceWithArray(0,0,t);xn(l)}if(PD){Object.defineProperty(a.array,"0",MD)}return n}e.prototype.intercept=function(t){return this.$mobx.intercept(t)};e.prototype.observe=function(t,i){if(i===void 0){i=false}return this.$mobx.observe(t,i)};e.prototype.clear=function(){return this.splice(0)};e.prototype.concat=function(){var t=[];for(var i=0;i<arguments.length;i++){t[i]=arguments[i]}this.$mobx.atom.reportObserved();return Array.prototype.concat.apply(this.peek(),t.map(function(r){return co(r)?r.peek():r}))};e.prototype.replace=function(t){return this.$mobx.spliceWithArray(0,this.$mobx.values.length,t)};e.prototype.toJS=function(){return this.slice()};e.prototype.toJSON=function(){return this.toJS()};e.prototype.peek=function(){this.$mobx.atom.reportObserved();return this.$mobx.dehanceValues(this.$mobx.values)};e.prototype.find=function(t,i,r){if(r===void 0){r=0}if(arguments.length===3)ki("The array.find fromIndex argument to find will not be supported anymore in the next major");var o=this.findIndex.apply(this,arguments);return o===-1?void 0:this.get(o)};e.prototype.findIndex=function(t,i,r){if(r===void 0){r=0}if(arguments.length===3)ki("The array.findIndex fromIndex argument to find will not be supported anymore in the next major");var o=this.peek(),n=o.length;for(var a=r;a<n;a++)if(t.call(i,o[a],a,this))return a;return-1};e.prototype.splice=function(t,i){var r=[];for(var o=2;o<arguments.length;o++){r[o-2]=arguments[o]}switch(arguments.length){case 0:return[];case 1:return this.$mobx.spliceWithArray(t);case 2:return this.$mobx.spliceWithArray(t,i)}return this.$mobx.spliceWithArray(t,i,r)};e.prototype.spliceWithArray=function(t,i,r){return this.$mobx.spliceWithArray(t,i,r)};e.prototype.push=function(){var t=[];for(var i=0;i<arguments.length;i++){t[i]=arguments[i]}var r=this.$mobx;r.spliceWithArray(r.values.length,0,t);return r.values.length};e.prototype.pop=function(){return this.splice(Math.max(this.$mobx.values.length-1,0),1)[0]};e.prototype.shift=function(){return this.splice(0,1)[0]};e.prototype.unshift=function(){var t=[];for(var i=0;i<arguments.length;i++){t[i]=arguments[i]}var r=this.$mobx;r.spliceWithArray(0,0,t);return r.values.length};e.prototype.reverse=function(){var t=this.slice();return t.reverse.apply(t,arguments)};e.prototype.sort=function(t){var i=this.slice();return i.sort.apply(i,arguments)};e.prototype.remove=function(t){var i=this.$mobx.dehanceValues(this.$mobx.values).indexOf(t);if(i>-1){this.splice(i,1);return true}return false};e.prototype.move=function(t,i){ki("observableArray.move is deprecated, use .slice() & .replace() instead");function r(a){if(a<0){throw new Error("[mobx.array] Index out of bounds: "+a+" is negative")}var l=this.$mobx.values.length;if(a>=l){throw new Error("[mobx.array] Index out of bounds: "+a+" is not smaller than "+l)}}r.call(this,t);r.call(this,i);if(t===i){return}var o=this.$mobx.values;var n;if(t<i){n=Uc(o.slice(0,t),o.slice(t+1,i+1),[o[t]],o.slice(i+1))}else{n=Uc(o.slice(0,i),[o[t]],o.slice(i,t),o.slice(t+1))}this.replace(n)};e.prototype.get=function(t){var i=this.$mobx;if(i){if(t<i.values.length){i.atom.reportObserved();return i.dehanceValue(i.values[t])}console.warn("[mobx.array] Attempt to read an array index ("+t+") that is out of bounds ("+i.values.length+"). Please check length first. Out of bound indices will not be tracked by MobX")}return void 0};e.prototype.set=function(t,i){var r=this.$mobx;var o=r.values;if(t<o.length){ao(r.atom);var n=o[t];if(ai(r)){var a=li(r,{type:"update",object:this,index:t,newValue:i});if(!a)return;i=a.newValue}i=r.enhancer(i,n);var l=i!==n;if(l){o[t]=i;r.notifyArrayChildUpdate(t,i,n)}}else if(t===o.length){r.spliceWithArray(t,0,[i])}else{throw new Error("[mobx.array] Index out of bounds, "+t+" is larger than "+o.length)}};return e}(Yc);Pc(ui.prototype,function(){this.$mobx.atom.reportObserved();var s=this;var e=0;return fn({next:function(){return e<s.length?{value:s[e++],done:false}:{done:true,value:void 0}}})});Object.defineProperty(ui.prototype,"length",{enumerable:false,configurable:true,get:function(){return this.$mobx.getArrayLength()},set:function(s){this.$mobx.setArrayLength(s)}});Ti(ui.prototype,Bc(),"Array");["indexOf","join","lastIndexOf","slice","toString","toLocaleString"].forEach(function(s){var e=Array.prototype[s];rr(typeof e==="function","Base function not defined on Array prototype: '"+s+"'");Ti(ui.prototype,s,function(){return e.apply(this.peek(),arguments)})});["every","filter","forEach","map","some"].forEach(function(s){var e=Array.prototype[s];rr(typeof e==="function","Base function not defined on Array prototype: '"+s+"'");Ti(ui.prototype,s,function(t,i){var r=this;var o=this.$mobx;o.atom.reportObserved();var n=o.dehanceValues(o.values);return n[s](function(a,l){return t.call(i,a,l,r)},i)})});["reduce","reduceRight"].forEach(function(s){Ti(ui.prototype,s,function(){var e=this;var t=this.$mobx;t.atom.reportObserved();var i=arguments[0];arguments[0]=function(r,o,n){o=t.dehanceValue(o);return i(r,o,n,e)};return t.values[s].apply(t.values,arguments)})});LC(ui.prototype,["constructor","intercept","observe","clear","concat","get","replace","toJS","toJSON","peek","find","findIndex","splice","spliceWithArray","push","pop","set","shift","unshift","reverse","sort","remove","move","toString","toLocaleString"]);var MD=Rf(0);function Rf(s){return{enumerable:false,configurable:false,get:function(){return this.get(s)},set:function(e){this.set(s,e)}}}function LD(s){Object.defineProperty(ui.prototype,""+s,Rf(s))}function Jc(s){for(var e=Xc;e<s;e++)LD(e);Xc=s}Jc(1e3);var zD=sr("ObservableArrayAdministration",Tf);function co(s){return Ic(s)&&zD(s.$mobx)}var UD={};var Va=function(){function s(e,t,i){if(t===void 0){t=gn}if(i===void 0){i="ObservableMap@"+Et()}this.enhancer=t;this.name=i;this.$mobx=UD;this._keysAtom=ef(this.name+".keys()");if(typeof Map!=="function"){throw new Error("mobx.map requires Map polyfill for the current browser. Check babel-polyfill or core-js/es6/map.js")}this._data=new Map;this._hasMap=new Map;this.merge(e)}s.prototype._has=function(e){return this._data.has(e)};s.prototype.has=function(e){var t=this;if(!U.trackingDerivation)return this._has(e);var i=this._hasMap.get(e);if(!i){var r=i=new nr(this._has(e),Aa,this.name+"."+ja(e)+"?",false);this._hasMap.set(e,r);Cf(r,function(){return t._hasMap.delete(e)})}return i.get()};s.prototype.set=function(e,t){var i=this._has(e);if(ai(this)){var r=li(this,{type:i?"update":"add",object:this,newValue:t,name:e});if(!r)return this;t=r.newValue}if(i){this._updateValue(e,t)}else{this._addValue(e,t)}return this};s.prototype.delete=function(e){var t=this;ao(this._keysAtom);if(ai(this)){var i=li(this,{type:"delete",object:this,name:e});if(!i)return false}if(this._has(e)){var r=et();var o=Zt(this);var i=o||r?{type:"delete",object:this,oldValue:this._data.get(e).value,name:e}:null;if(r)Jt(Le(Le({},i),{name:this.name,key:e}));Oi(function(){t._keysAtom.reportChanged();t._updateHasMapEntry(e,false);var a=t._data.get(e);a.setNewValue(void 0);t._data.delete(e)});if(o)Qt(this,i);if(r)$t();return true}return false};s.prototype._updateHasMapEntry=function(e,t){var i=this._hasMap.get(e);if(i){i.setNewValue(t)}};s.prototype._updateValue=function(e,t){var i=this._data.get(e);t=i.prepareNewValue(t);if(t!==U.UNCHANGED){var r=et();var o=Zt(this);var n=o||r?{type:"update",object:this,oldValue:i.value,name:e,newValue:t}:null;if(r)Jt(Le(Le({},n),{name:this.name,key:e}));i.setNewValue(t);if(o)Qt(this,n);if(r)$t()}};s.prototype._addValue=function(e,t){var i=this;ao(this._keysAtom);Oi(function(){var a=new nr(t,i.enhancer,i.name+"."+ja(e),false);i._data.set(e,a);t=a.value;i._updateHasMapEntry(e,true);i._keysAtom.reportChanged()});var r=et();var o=Zt(this);var n=o||r?{type:"add",object:this,name:e,newValue:t}:null;if(r)Jt(Le(Le({},n),{name:this.name,key:e}));if(o)Qt(this,n);if(r)$t()};s.prototype.get=function(e){if(this.has(e))return this.dehanceValue(this._data.get(e).get());return this.dehanceValue(void 0)};s.prototype.dehanceValue=function(e){if(this.dehancer!==void 0){return this.dehancer(e)}return e};s.prototype.keys=function(){this._keysAtom.reportObserved();return this._data.keys()};s.prototype.values=function(){var e=this;var t=this.keys();return fn({next:function(){var i=t.next(),r=i.done,o=i.value;return{done:r,value:r?void 0:e.get(o)}}})};s.prototype.entries=function(){var e=this;var t=this.keys();return fn({next:function(){var i=t.next(),r=i.done,o=i.value;return{done:r,value:r?void 0:[o,e.get(o)]}}})};s.prototype.forEach=function(e,t){var i=this;this._keysAtom.reportObserved();this._data.forEach(function(r,o){return e.call(t,i.get(o),o,i)})};s.prototype.merge=function(e){var t=this;if(Ai(e)){e=e.toJS()}Oi(function(){var i=bn(true);try{if(so(e))Object.keys(e).forEach(function(r){return t.set(r,e[r])});else if(Array.isArray(e))e.forEach(function(r){var o=zc(r,2),n=o[0],a=o[1];return t.set(n,a)});else if(oo(e)){if(e.constructor!==Map)De("Cannot initialize from classes that inherit from Map: "+e.constructor.name);else e.forEach(function(r,o){return t.set(o,r)})}else if(e!==null&&e!==void 0)De("Cannot initialize map from "+e)}finally{xn(i)}});return this};s.prototype.clear=function(){var e=this;Oi(function(){uf(function(){e._data.forEach(function(t,i){return e.delete(i)})})})};s.prototype.replace=function(e){var t=this;Oi(function(){var i=MC(e);var r=new Map;var o=false;Zh(t._data.keys(),function(c){if(!i.has(c)){var h=t.delete(c);if(h){o=true}else{var m=t._data.get(c);r.set(c,m)}}});Zh(i.entries(),function(c){var h=zc(c,2),m=h[0],d=h[1];var f=t._data.has(m);t.set(m,d);if(t._data.has(m)){var b=t._data.get(m);r.set(m,b);if(!f){o=true}}});if(!o){if(t._data.size!==r.size){t._keysAtom.reportChanged()}else{var n=t._data.keys();var a=r.keys();var l=n.next();var u=a.next();while(!l.done){if(l.value!==u.value){t._keysAtom.reportChanged();break}l=n.next();u=a.next()}}}t._data=r});return this};Object.defineProperty(s.prototype,"size",{get:function(){this._keysAtom.reportObserved();return this._data.size},enumerable:true,configurable:true});s.prototype.toPOJO=function(){var e=this;var t={};this.forEach(function(i,r){return t[typeof r==="symbol"?r:ja(r)]=e.get(r)});return t};s.prototype.toJS=function(){return new Map(this)};s.prototype.toJSON=function(){return this.toPOJO()};s.prototype.toString=function(){var e=this;return this.name+"[{ "+Ri(this.keys()).map(function(t){return ja(t)+": "+(""+e.get(t))}).join(", ")+" }]"};s.prototype.observe=function(e,t){false;return wn(this,e)};s.prototype.intercept=function(e){return vn(this,e)};return s}();function ja(s){if(s&&s.toString)return s.toString();else return new String(s).toString()}Pc(Va.prototype,function(){return this.entries()});pn(Va.prototype,Bc(),"Map");var Ai=sr("ObservableMap",Va);var ND={};var Ha=function(){function s(e,t,i){if(t===void 0){t=gn}if(i===void 0){i="ObservableSet@"+Et()}this.name=i;this.$mobx=ND;this._data=new Set;this._atom=ef(this.name);if(typeof Set!=="function"){throw new Error("mobx.set requires Set polyfill for the current browser. Check babel-polyfill or core-js/es6/set.js")}this.enhancer=function(r,o){return t(r,o,i)};if(e){this.replace(e)}}s.prototype.dehanceValue=function(e){if(this.dehancer!==void 0){return this.dehancer(e)}return e};s.prototype.clear=function(){var e=this;Oi(function(){uf(function(){e._data.forEach(function(t){e.delete(t)})})})};s.prototype.forEach=function(e,t){var i=this;this._atom.reportObserved();this._data.forEach(function(r){e.call(t,r,r,i)})};Object.defineProperty(s.prototype,"size",{get:function(){this._atom.reportObserved();return this._data.size},enumerable:true,configurable:true});s.prototype.add=function(e){var t=this;ao(this._atom);if(ai(this)){var i=li(this,{type:"add",object:this,newValue:e});if(!i)return this}if(!this.has(e)){Oi(function(){t._data.add(t.enhancer(e,void 0));t._atom.reportChanged()});var r=et();var o=Zt(this);var i=o||r?{type:"add",object:this,newValue:e}:null;if(r&&false)Jt(i);if(o)Qt(this,i);if(r&&false)$t()}return this};s.prototype.delete=function(e){var t=this;if(ai(this)){var i=li(this,{type:"delete",object:this,oldValue:e});if(!i)return false}if(this.has(e)){var r=et();var o=Zt(this);var i=o||r?{type:"delete",object:this,oldValue:e}:null;if(r&&false)Jt(Le(Le({},i),{name:this.name}));Oi(function(){t._atom.reportChanged();t._data.delete(e)});if(o)Qt(this,i);if(r&&false)$t();return true}return false};s.prototype.has=function(e){this._atom.reportObserved();return this._data.has(this.dehanceValue(e))};s.prototype.entries=function(){var e=0;var t=Ri(this.keys());var i=Ri(this.values());return fn({next:function(){var r=e;e+=1;return r<i.length?{value:[t[r],i[r]],done:false}:{done:true}}})};s.prototype.keys=function(){return this.values()};s.prototype.values=function(){this._atom.reportObserved();var e=this;var t=0;var i;if(this._data.values!==void 0){i=Ri(this._data.values())}else{i=[];this._data.forEach(function(r){return i.push(r)})}return fn({next:function(){return t<i.length?{value:e.dehanceValue(i[t++]),done:false}:{done:true}}})};s.prototype.replace=function(e){var t=this;if(ur(e)){e=e.toJS()}Oi(function(){var i=bn(true);try{if(Array.isArray(e)){t.clear();e.forEach(function(r){return t.add(r)})}else if(hn(e)){t.clear();e.forEach(function(r){return t.add(r)})}else if(e!==null&&e!==void 0){De("Cannot initialize set from "+e)}}finally{xn(i)}});return this};s.prototype.observe=function(e,t){false;return wn(this,e)};s.prototype.intercept=function(e){return vn(this,e)};s.prototype.toJS=function(){return new Set(this)};s.prototype.toString=function(){return this.name+"[ "+Ri(this.keys()).join(", ")+" ]"};return s}();Pc(Ha.prototype,function(){return this.values()});pn(Ha.prototype,Bc(),"Set");var ur=sr("ObservableSet",Ha);var Ef=function(){function s(e,t,i){this.target=e;this.name=t;this.defaultEnhancer=i;this.values={}}s.prototype.read=function(e,t){if(this.target!==e){this.illegalAccess(e,t);if(!this.values[t])return void 0}return this.values[t].get()};s.prototype.write=function(e,t,i){var r=this.target;if(r!==e){this.illegalAccess(e,t)}var o=this.values[t];if(o instanceof ar){o.set(i);return}if(ai(this)){var n=li(this,{type:"update",object:r,name:t,newValue:i});if(!n)return;i=n.newValue}i=o.prepareNewValue(i);if(i!==U.UNCHANGED){var a=Zt(this);var l=et();var n=a||l?{type:"update",object:r,oldValue:o.value,name:t,newValue:i}:null;if(l)Jt(Le(Le({},n),{name:this.name,key:t}));o.setNewValue(i);if(a)Qt(this,n);if(l)$t()}};s.prototype.remove=function(e){if(!this.values[e])return;var t=this.target;if(ai(this)){var i=li(this,{object:t,name:e,type:"remove"});if(!i)return}try{Si();var r=Zt(this);var o=et();var n=this.values[e].get();if(this.keys)this.keys.remove(e);delete this.values[e];delete this.target[e];var i=r||o?{type:"remove",object:t,oldValue:n,name:e}:null;if(o)Jt(Le(Le({},i),{name:this.name,key:e}));if(r)Qt(this,i);if(o)$t()}finally{Fi()}};s.prototype.illegalAccess=function(e,t){console.warn("Property '"+t+"' of '"+e+"' was accessed through the prototype chain. Use 'decorate' instead to declare the prop or access it statically through it's owner")};s.prototype.observe=function(e,t){false;return wn(this,e)};s.prototype.intercept=function(e){return vn(this,e)};s.prototype.getKeys=function(){var e=this;if(this.keys===void 0){this.keys=new ui(Object.keys(this.values).filter(function(t){return e.values[t]instanceof nr}),Aa,"keys("+this.name+")",true)}return this.keys.slice()};return s}();function $c(s,e,t){if(e===void 0){e=""}if(t===void 0){t=gn}var i=s.$mobx;if(i)return i;false;if(!so(s))e=(s.constructor.name||"ObservableObject")+"@"+Et();if(!e)e="ObservableObject@"+Et();i=new Ef(s,e,t);pn(s,"$mobx",i);return i}function GD(s,e,t,i){var r=$c(s);zC(s,e);if(ai(r)){var o=li(r,{object:s,name:e,type:"add",newValue:t});if(!o)return;t=o.newValue}var n=r.values[e]=new nr(t,i,r.name+"."+e,false);t=n.value;Object.defineProperty(s,e,VD(e));if(r.keys)r.keys.push(e);HD(r,s,e,t)}function WD(s,e,t){var i=$c(s);t.name=i.name+"."+e;t.context=s;i.values[e]=new ar(t);Object.defineProperty(s,e,jD(e))}var Sf=Object.create(null);var Ff=Object.create(null);function VD(s){return Sf[s]||(Sf[s]={configurable:true,enumerable:true,get:function(){return this.$mobx.read(this,s)},set:function(e){this.$mobx.write(this,s,e)}})}function Of(s){var e=s.$mobx;if(!e){Nr(s);return s.$mobx}return e}function jD(s){return Ff[s]||(Ff[s]={configurable:U.computedConfigurable,enumerable:false,get:function(){return Of(this).read(this,s)},set:function(e){Of(this).write(this,s,e)}})}function HD(s,e,t,i){var r=Zt(s);var o=et();var n=r||o?{type:"add",object:e,name:t,newValue:i}:null;if(o)Jt(Le(Le({},n),{name:s.name,key:t}));if(r)Qt(s,n);if(o)$t()}var qD=sr("ObservableObjectAdministration",Ef);function mo(s){if(Ic(s)){Nr(s);return qD(s.$mobx)}return false}function cr(s,e){if(typeof s==="object"&&s!==null){if(co(s)){if(e!==void 0)De(false);return s.$mobx.atom}if(ur(s)){return s.$mobx}if(Ai(s)){var t=s;if(e===void 0)return t._keysAtom;var i=t._data.get(e)||t._hasMap.get(e);if(!i)De(false);return i}Nr(s);if(e&&!s.$mobx)s[e];if(mo(s)){if(!e)return De(false);var i=s.$mobx.values[e];if(!i)De(false);return i}if(Mc(s)||za(s)||Ga(s)){return s}}else if(typeof s==="function"){if(Ga(s.$mobx)){return s.$mobx}}return De(false)}function Af(s,e){if(!s)De("Expecting some object");if(e!==void 0)return Af(cr(s,e));if(Mc(s)||za(s)||Ga(s))return s;if(Ai(s)||ur(s))return s;Nr(s);if(s.$mobx)return s.$mobx;De(false)}function KD(s,e){var t;if(e!==void 0)t=cr(s,e);else if(mo(s)||Ai(s)||ur(s))t=Af(s);else t=cr(s);return t.name}var If=Object.prototype.toString;function Zc(s,e,t){if(t===void 0){t=-1}return Qc(s,e,t)}function Qc(s,e,t,i,r){if(s===e)return s!==0||1/s===1/e;if(s==null||e==null)return false;if(s!==s)return e!==e;var o=typeof s;if(o!=="function"&&o!=="object"&&typeof e!="object")return false;s=Pf(s);e=Pf(e);var n=If.call(s);if(n!==If.call(e))return false;switch(n){case"[object RegExp]":case"[object String]":return""+s===""+e;case"[object Number]":if(+s!==+s)return+e!==+e;return+s===0?1/+s===1/e:+s===+e;case"[object Date]":case"[object Boolean]":return+s===+e;case"[object Symbol]":return typeof Symbol!=="undefined"&&Symbol.valueOf.call(s)===Symbol.valueOf.call(e)}var a=n==="[object Array]";if(!a){if(typeof s!="object"||typeof e!="object")return false;var l=s.constructor,u=e.constructor;if(l!==u&&!(typeof l==="function"&&l instanceof l&&typeof u==="function"&&u instanceof u)&&("constructor"in s&&"constructor"in e)){return false}}if(t===0){return false}else if(t<0){t=-1}i=i||[];r=r||[];var c=i.length;while(c--){if(i[c]===s)return r[c]===e}i.push(s);r.push(e);if(a){c=s.length;if(c!==e.length)return false;while(c--){if(!Qc(s[c],e[c],t-1,i,r))return false}}else{var h=Object.keys(s);var m=void 0;c=h.length;if(Object.keys(e).length!==c)return false;while(c--){m=h[c];if(!(XD(e,m)&&Qc(s[m],e[m],t-1,i,r)))return false}}i.pop();r.pop();return true}function Pf(s){if(co(s))return s.peek();if(oo(s)||Ai(s))return Ri(s.entries());if(hn(s)||ur(s))return Ri(s.entries());return s}function XD(s,e){return Object.prototype.hasOwnProperty.call(s,e)}try{"production"}catch(s){em=ro();if(typeof process==="undefined")em.process={};em.process.env={}}var em;(function(){function s(){}if(s.name!=="testCodeMinification"&&false){var e=["process","env","NODE_ENV"].join(".");console.warn("[mobx] you are running a minified build, but '"+e+"' was not set to 'production' in your bundler. This results in an unnecessarily large and slow bundle")}})();var YD="$mobx";if(typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__==="object"){__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:_D,extras:{getDebugName:KD},$mobx:YD})}if(false){ES=false;Object.defineProperty(module.exports,"default",{enumerable:false,get:function(){if(!ES){ES=true;console.warn(`The MobX package does not have a default export. Use 'import { thing } from "mobx"' (recommended) or 'import * as mobx from "mobx"' instead."`)}return void 0}});["extras","Atom","BaseAtom","asFlat","asMap","asReference","asStructure","autorunAsync","createTranformer","expr","isModifierDescriptor","isStrictModeEnabled","map","useStrict","whyRun"].forEach(function(s){Object.defineProperty(module.exports,s,{enumerable:false,get:function(){De("'"+s+"' is no longer part of the public MobX api. Please consult the changelog to find out where this functionality went")},set:function(){}})})}var ES;function FS(s){return!Object.prototype.hasOwnProperty.call(s,"name")}function OS(s){return!Object.prototype.hasOwnProperty.call(s,"name")}var Ye;(function(h){h["UNDO"]="undo";h["REDO"]="redo";h["DELETE"]="delete";h["BRING_TO_FRONT"]="bringtofront";h["EDIT"]="edit";h["DUPLICATE"]="duplicate";h["ADD"]="add";h["FLIP"]="flip";h["INVERT"]="invert";h["CLOSE"]="close";h["EXPORT"]="export"})(Ye||(Ye={}));var Ne;(function(m){m["LIBRARY"]="library";m["TRANSFORM"]="transform";m["FILTER"]="filter";m["ADJUSTMENT"]="adjustment";m["FOCUS"]="focus";m["STICKER"]="sticker";m["TEXT"]="text";m["TEXT_DESIGN"]="textdesign";m["OVERLAY"]="overlay";m["FRAME"]="frame";m["BRUSH"]="brush";m["CUSTOM"]="customTool"})(Ne||(Ne={}));var ci;(function(t){t["TEXT"]="text";t["CARD"]="card"})(ci||(ci={}));var Bf;(function(i){i["LARGE"]="large";i["MEDIUM"]="medium";i["SMALL"]="small"})(Bf||(Bf={}));var Mf;(function(r){r["ERROR"]="error";r["WARNING"]="warning";r["INFO"]="info";r["TEXT_EDIT"]="textEdit"})(Mf||(Mf={}));var Lf=class{constructor(){this.enabled=true;this.threshold=20;this.snapToHorizontalCenter=true;this.snapToVerticalCenter=true;this.snapToLeft=.1;this.snapToRight=.1;this.snapToTop=.1;this.snapToBottom=.1}};var zf=class{constructor(){this.enabled=true;this.threshold=20;this.angles=[0,45,90,135,180,225,270,315]}};var JD=class{constructor(){this.position=new Lf;this.rotation=new zf}};var tm;(function(o){o["CENTER"]="center";o["TOP_LEFT"]="top-left";o["TOP_RIGHT"]="top-right";o["BOTTOM_LEFT"]="bottom-left";o["BOTTOM_RIGHT"]="bottom-right"})(tm||(tm={}));var $D=class{constructor(){this.watermarkURI="";this.alignment=tm.TOP_RIGHT;this.inset=.05;this.size=.2}};var Uf;(function(e){e["OBJECT"]="object"})(Uf||(Uf={}));var ZD=class{};var Ii;(function(r){r["IMAGE"]="image";r["DATA_URL"]="data-url";r["BLOB"]="blob";r["MSBLOB"]="ms-blob"})(Ii||(Ii={}));var Vr;(function(t){t["PNG"]="image/png";t["JPEG"]="image/jpeg"})(Vr||(Vr={}));var Nf;(function(l){l["BMP"]="image/bmp";l["GIF"]="image/gif";l["ICO"]="image/x-icon";l["JPEG"]="image/jpeg";l["PNG"]="image/png";l["SVG"]="image/svg+xml";l["TIFF"]="image/tiff";l["WEBP"]="image/webp"})(Nf||(Nf={}));var QD=class{constructor(){this.order="default";this.language="en";this.theme="dark";this.assetBaseUrl="assets/";this.assetResolver={};this.displayResizeWarning=false;this.displayCloseWarning=true;this.displayCanvasRendererWarning=true;this.displayToolControlBarTitle=true;this.displaySerializationModal=true;this.forceCrop=false;this.enableZoom=true;this.scaleImageToFit=true;this.restrictZoomOutToDefault=true;this.defaultTool=Ne.FILTER}};Ne.FILTER,Ne.FOCUS,Ne.ADJUSTMENT,Ne.LIBRARY,Ne.OVERLAY,Ne.STICKER,Ne.TEXT,Ne.TEXT_DESIGN,Ne.FRAME,Ne.BRUSH,Ne.TRANSFORM,Ne.CUSTOM;var st;(function(m){m["BRIGHTNESS"]="brightness";m["CONTRAST"]="contrast";m["SATURATION"]="saturation";m["CLARITY"]="clarity";m["SHADOWS"]="shadows";m["HIGHLIGHTS"]="highlights";m["EXPOSURE"]="exposure";m["GAMMA"]="gamma";m["BLACKS"]="blacks";m["WHITES"]="whites";m["TEMPERATURE"]="temperature";m["SHARPNESS"]="sharpness"})(st||(st={}));var qS=Object.values(st).reduce((s,e)=>{s[e]=true;return s},{});var po;(function(r){r["RemoveAdjustmentButton"]="removeAdjustmentButton";r["Expandable"]="expandable";r["Separator"]="separator";r["Items"]="items"})(po||(po={}));var ek=class{constructor(){this.categories=[];this.flattenCategories=false;this.advancedUIToolControlBarOrder=[{type:po.Expandable,children:[po.RemoveAdjustmentButton,po.Separator]},po.Items]}};var tk=class{};var jr;(function(o){o["RemoveFilterButton"]="removeFilterButton";o["FilterIntensitySlider"]="filterIntensitySlider";o["Expandable"]="expandable";o["Separator"]="separator";o["Items"]="items"})(jr||(jr={}));var im;(function(e){e["FilterIntensity"]="filterIntensity"})(im||(im={}));var ik=class{constructor(){this.categories=[];this.flattenCategories=false;this.categoryHeaderType=ci.CARD;this.enablePreviewThumbnails=false;this.advancedUIToolControlBarOrder=[{type:jr.Expandable,children:[jr.RemoveFilterButton,jr.FilterIntensitySlider,jr.Separator]},jr.Items];this.basicUIToolControlBarTabsOrder=[im.FilterIntensity]}};function Gf(s){return s.lightColor!==void 0}function Wf(s){return s.lutURI!==void 0}var z;(function(k){k["Desert"]="imgly_duotone_desert";k["Peach"]="imgly_duotone_peach";k["Clash"]="imgly_duotone_clash";k["Plum"]="imgly_duotone_plum";k["Breezy"]="imgly_duotone_breezy";k["DeepBlue"]="imgly_duotone_deepblue";k["Frog"]="imgly_duotone_frog";k["Sunset"]="imgly_duotone_sunset";k["AD1920"]="imgly_lut_ad1920";k["Greyed"]="imgly_lut_bw";k["Dusty"]="imgly_lut_x400";k["Litho"]="imgly_lut_litho";k["Sepia"]="imgly_lut_sepiahigh";k["Weathered"]="imgly_lut_plate";k["HardStuff"]="imgly_lut_sin";k["Polaroid"]="imgly_lut_blues";k["Sunny70s"]="imgly_lut_front";k["Oldtimer"]="imgly_lut_texas";k["Inferno"]="imgly_lut_celsius";k["Snappy"]="imgly_lut_cool";k["Chestnut"]="imgly_lut_chest";k["Softy"]="imgly_lut_winter";k["Pebble"]="imgly_lut_kdynamic";k["Moss"]="imgly_lut_fall";k["Lemon"]="imgly_lut_lenin";k["GreenGap"]="imgly_lut_pola669";k["Colla"]="imgly_lut_elder";k["Solanus"]="imgly_lut_orchid";k["Kalmen"]="imgly_lut_bleached";k["Joran"]="imgly_lut_bleachedblue";k["Levante"]="imgly_lut_breeze";k["Zephyr"]="imgly_lut_blueshadows";k["Golden"]="imgly_lut_sunset";k["LowFire"]="imgly_lut_eighties";k["Sunrise"]="imgly_lut_evening";k["FlatBlack"]="imgly_lut_k2";k["Pumpkin"]="imgly_lut_nogreen";k["Ancient"]="imgly_lut_ancient";k["Candy"]="imgly_lut_cottoncandy";k["Classic"]="imgly_lut_classic";k["Colorful"]="imgly_lut_colorful";k["Creamy"]="imgly_lut_creamy";k["Fixie"]="imgly_lut_fixie";k["Food"]="imgly_lut_food";k["Fridge"]="imgly_lut_fridge";k["Glam"]="imgly_lut_glam";k["Gobblin"]="imgly_lut_gobblin";k["Hicon"]="imgly_lut_highcontrast";k["HighCarb"]="imgly_lut_highcarb";k["K1"]="imgly_lut_k1";k["K6"]="imgly_lut_k6";k["Keen"]="imgly_lut_keen";k["Lomo"]="imgly_lut_lomo";k["Lomo100"]="imgly_lut_lomo100";k["Lucid"]="imgly_lut_lucid";k["Mellow"]="imgly_lut_mellow";k["Neat"]="imgly_lut_neat";k["Pale"]="imgly_lut_pale";k["Pitched"]="imgly_lut_pitched";k["PolaSX"]="imgly_lut_polasx";k["Pro400"]="imgly_lut_pro400";k["Quozi"]="imgly_lut_quozi";k["Settled"]="imgly_lut_settled";k["Seventies"]="imgly_lut_seventies";k["Soft"]="imgly_lut_soft";k["Steel"]="imgly_lut_steel";k["Summer"]="imgly_lut_summer";k["Tender"]="imgly_lut_tender";k["Twilight"]="imgly_lut_twilight"})(z||(z={}));var mi;(function(a){a["DuoTone"]="imgly_filter_category_duotone";a["BW"]="imgly_filter_category_bw";a["Vintage"]="imgly_filter_category_vintage";a["Smooth"]="imgly_filter_category_smooth";a["Cold"]="imgly_filter_category_cold";a["Warm"]="imgly_filter_category_warm";a["Legacy"]="imgly_filter_category_legacy"})(mi||(mi={}));var Hr;(function(o){o["RemoveFocusButton"]="removeFocusButton";o["FocusIntensitySlider"]="focusIntensitySlider";o["Expandable"]="expandable";o["Separator"]="separator";o["Items"]="items"})(Hr||(Hr={}));var rm;(function(e){e["FocusIntensity"]="focusIntensity"})(rm||(rm={}));var rk=class{constructor(){this.items=[];this.advancedUIToolControlBarOrder=[{type:Hr.Expandable,children:[Hr.RemoveFocusButton,Hr.FocusIntensitySlider,Hr.Separator]},Hr.Items];this.basicUIToolControlBarTabsOrder=[rm.FocusIntensity]}};var qr;(function(r){r["RADIAL"]="radial";r["LINEAR"]="linear";r["MIRRORED"]="mirrored";r["GAUSSIAN"]="gaussian"})(qr||(qr={}));var Pi;(function(a){a["RemoveFrameButton"]="removeFrameButton";a["FrameOpacitySlider"]="frameOpacitySlider";a["FrameSizeSlider"]="frameSizeSlider";a["FrameColorList"]="frameColorList";a["Separator"]="separator";a["Items"]="items";a["Expandable"]="expandable"})(Pi||(Pi={}));var Cn;(function(i){i["FrameSize"]="frameSize";i["FrameOpacity"]="frameOpacity";i["FrameColor"]="frameColor"})(Cn||(Cn={}));var sk=class{constructor(){this.items=[];this.advancedUIToolControlBarOrder=[{type:Pi.Expandable,children:[Pi.RemoveFrameButton,Pi.FrameOpacitySlider,Pi.FrameSizeSlider,Pi.FrameColorList,Pi.Separator]},Pi.Items];this.basicUIToolControlBarTabsOrder=[Cn.FrameOpacity,Cn.FrameSize,Cn.FrameColor]}};var sm=class{constructor(e){this.name=e.name;this.coverImageUrl=e.coverImageUrl}loadCoverImage(e="anonymous"){return new Promise((t,i)=>{const r=new Image;r.addEventListener("load",()=>{t(r)});r.addEventListener("error",()=>{i(new Error(`Failed to load image at ${this.coverImage}`))});r.crossOrigin=e;r.src=this.coverImageUrl;this.coverImage=r})}};var om=class{constructor(e){this.title=e.title;this.category=e.category||e.title;this.thumbUrl=e.thumbUrl;this.rawUrl=e.rawUrl;this.authorName=e.authorName;this.authorAvatar=e.authorAvatar}loadThumbImage(e="anonymous"){return new Promise((t,i)=>{const r=new Image;r.addEventListener("load",()=>{t(r)});r.addEventListener("error",()=>{i(new Error(`Failed to load image at ${this.thumbUrl}`))});r.crossOrigin=e;r.src=this.thumbUrl;this.thumbImage=r})}getThumbImage(){return this.thumbUrl}};var qa=class{getData(e){return new Promise((t,i)=>{const r=new XMLHttpRequest;r.open("GET",e,true);r.responseType="json";r.onload=()=>{const{status:o}=r;if(o===200){t(r.response)}else{i(new Error(`HTTP Status ${o}`))}};r.send()})}};var nm=class{loadJSON(e){const t=new qa;return t.getData(e)}getCategories(){return Promise.resolve([])}searchImages(e){return Promise.resolve([])}};var am=class extends nm{loadData(){if(this.data){return Promise.resolve(this.data)}return this.loadJSON("https://img.ly/static/libraries/unsplash/metadata.json").then(e=>{if(typeof e==="string"){e=JSON.parse(e)}this.data=e;return e})}getCategories(){return this.loadData().then(e=>{return e.categories.map(t=>{return new sm({name:t.name,coverImageUrl:t.coverImage})})})}searchImages(e){return this.loadData().then(t=>{return t.images.filter(i=>{const r=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").split(/\s+/);for(let o=0;o<r.length;o+=1){const n=r[o];const a=new RegExp(n,"i");if(!a.test(i.title)){return false}}return true}).map(i=>{return new om(i)})})}};var Kr;(function(o){o["UploadImageButton"]="uploadImageButton";o["OpenWebcamButton"]="openWebcamButton";o["SearchFieldInput"]="searchFieldInput";o["Separator"]="separator";o["Items"]="items"})(Kr||(Kr={}));var ok=class{constructor(){this.enableWebcam=false;this.enableUpload=false;this.provider=am;this.flattenCategories=false;this.categoryHeaderType=ci.CARD;this.advancedUIToolControlBarOrder=[Kr.SearchFieldInput,Kr.UploadImageButton,Kr.OpenWebcamButton,Kr.Separator,Kr.Items]}};var mr;(function(n){n["RemoveOverlayButton"]="removeOverlayButton";n["OverlayOpacitySlider"]="overlayOpacitySlider";n["OverlayBlendModeCarousel"]="overlayBlendModeCarousel";n["Expandable"]="expandable";n["Separator"]="separator";n["Items"]="items"})(mr||(mr={}));var Ka;(function(t){t["OverlayOpacity"]="overlayOpacity";t["OverlayBlendMode"]="overlayBlendMode"})(Ka||(Ka={}));var nk=class{constructor(){this.items=[];this.advancedUIToolControlBarOrder=[{type:mr.Expandable,children:[mr.RemoveOverlayButton,mr.OverlayBlendModeCarousel,mr.OverlayOpacitySlider,mr.Separator]},mr.Items];this.basicUIToolControlBarTabsOrder=[Ka.OverlayBlendMode,Ka.OverlayOpacity]}};var re;(function(u){u["NORMAL"]="normal";u["OVERLAY"]="overlay";u["SOFT_LIGHT"]="softLight";u["HARD_LIGHT"]="hardLight";u["MULTIPLY"]="multiply";u["DARKEN"]="darken";u["COLOR_BURN"]="colorBurn";u["SCREEN"]="screen";u["LIGHTEN"]="lighten"})(re||(re={}));var Ve;(function(g){g["Bokeh"]="imgly_overlay_bokeh";g["Chop"]="imgly_overlay_chop";g["Clouds"]="imgly_overlay_clouds";g["Golden"]="imgly_overlay_golden";g["Grain"]="imgly_overlay_grain";g["Hearts"]="imgly_overlay_hearts";g["LightLeak1"]="imgly_overlay_lightleak1";g["LightLeak2"]="imgly_overlay_lightleak2";g["Metal"]="imgly_overlay_metal";g["Mosaic"]="imgly_overlay_mosaic";g["Painting"]="imgly_overlay_painting";g["Paper"]="imgly_overlay_paper";g["Rain"]="imgly_overlay_rain";g["Vintage"]="imgly_overlay_vintage";g["Wall1"]="imgly_overlay_wall1";g["Wall2"]="imgly_overlay_wall2";g["Wood"]="imgly_overlay_wood"})(Ve||(Ve={}));var Xr;(function(o){o["UploadStickerButton"]="uploadStickerButton";o["StickerOpacitySlider"]="stickerOpacitySlider";o["StickerColorList"]="stickerColorList";o["Separator"]="separator";o["Items"]="items"})(Xr||(Xr={}));var Xa;(function(t){t["StickerColor"]="stickerColor";t["StickerOpacity"]="stickerOpacity"})(Xa||(Xa={}));var ak=class{constructor(){this.categories=[];this.canvasActions=[Ye.BRING_TO_FRONT,Ye.FLIP,Ye.DUPLICATE,Ye.DELETE];this.flattenCategories=false;this.categoryHeaderType=ci.CARD;this.enableCustomUpload=true;this.customStickerResizeMode="keepAspect";this.customStickerTintMode="none";this.advancedUIToolControlBarOrder=[Xr.UploadStickerButton,Xr.StickerOpacitySlider,Xr.StickerColorList,Xr.Separator,Xr.Items];this.basicUIToolControlBarTabsOrder=[Xa.StickerColor,Xa.StickerOpacity]}};var Mt;(function(u){u["NewTextButton"]="newTextButton";u["FontFamilyDropdown"]="fontFamilyDropdown";u["FontSizeInput"]="fontSizeInput";u["TextAligmentList"]="textAlignmentList";u["Separator"]="separator";u["Inline"]="inline";u["TextColorList"]="textColorList";u["BackgroundColorList"]="backgroundColorList";u["LineSpacingSlider"]="lineSpacingSlider"})(Mt||(Mt={}));var Yr;(function(o){o["FontSize"]="fontSize";o["TextAligment"]="textAlignment";o["TextColor"]="textColor";o["BackgroundColor"]="backgroundColor";o["LineSpacing"]="lineSpacing"})(Yr||(Yr={}));var lk=class{constructor(){this.fonts=[];this.canvasActions=[Ye.EDIT,Ye.BRING_TO_FRONT,Ye.DUPLICATE,Ye.DELETE];this.allowEmojis=false;this.disableAutoScaling=false;this.addDefaultTextOnEnter=true;this.advancedUIToolControlBarOrder=[Mt.NewTextButton,Mt.FontFamilyDropdown,{type:Mt.Inline,children:[Mt.FontSizeInput,Mt.TextAligmentList]},Mt.Separator,Mt.TextColorList,Mt.BackgroundColorList,Mt.Separator,Mt.LineSpacingSlider];this.basicUIToolControlBarTabsOrder=[Yr.FontSize,Yr.TextAligment,Yr.TextColor,Yr.BackgroundColor,Yr.LineSpacing]}};function Vf(s){return s.provider===void 0||s.provider==="file"}function jf(s){return s.provider==="google"}var dr;(function(n){n["RemoveBrushButton"]="removeBrushButton";n["BrushColorList"]="brushColorList";n["BrushSizeSlider"]="brushSizeSlider";n["BrushHardnessSlider"]="brushHardnessSlider";n["Expandable"]="expandable";n["Separator"]="separator"})(dr||(dr={}));var Dn;(function(i){i["BrushSize"]="brushSize";i["BrushHardness"]="brushHardness";i["BrushColor"]="brushColor"})(Dn||(Dn={}));var uk=class{constructor(){this.defaultSize=.05;this.defaultHardness=.5;this.advancedUIToolControlBarOrder=[{type:dr.Expandable,children:[dr.RemoveBrushButton,dr.Separator]},dr.BrushHardnessSlider,dr.BrushSizeSlider,dr.BrushColorList];this.basicUIToolControlBarTabsOrder=[Dn.BrushColor,Dn.BrushSize,Dn.BrushHardness]}};var Jr;(function(o){o["NewTextDesignButton"]="newTextDesignButton";o["ShuffleLayoutButton"]="shuffleLayoutButton";o["TextDesignColorList"]="textDesignColorList";o["Separator"]="separator";o["Items"]="items"})(Jr||(Jr={}));var ck=class{constructor(){this.items=[];this.canvasActions=[Ye.EDIT,Ye.BRING_TO_FRONT,Ye.INVERT,Ye.DUPLICATE,Ye.DELETE];this.allowEmojis=false;this.addDefaultTextOnEnter=true;this.advancedUIToolControlBarOrder=[Jr.NewTextDesignButton,Jr.ShuffleLayoutButton,Jr.TextDesignColorList,Jr.Separator,Jr.Items]}};var $r;(function(o){o["ResetTransformButton"]="resetTransformButton";o["KeepResolutionCheckbox"]="keepResolutionCheckbox";o["CropSizeInput"]="cropSizeInput";o["Separator"]="separator";o["Items"]="items"})($r||($r={}));var kn;(function(i){i["CropSize"]="cropSize";i["FlipRotate"]="flipRotate";i["Resolution"]="resolution"})(kn||(kn={}));var mk=class{constructor(){this.categories=[];this.enableRotation=true;this.enableFlip=true;this.flattenCategories=false;this.categoryHeaderType=ci.TEXT;this.advancedUIToolControlBarOrder=[$r.ResetTransformButton,$r.KeepResolutionCheckbox,$r.CropSizeInput,$r.Separator,$r.Items];this.basicUIToolControlBarTabsOrder=[kn.CropSize,kn.FlipRotate,kn.Resolution]}};var Hf;(function(x){x["CommonCategory"]="imgly_transforms_common";x["FacebookCategory"]="imgly_transforms_facebook";x["TwitterCategory"]="imgly_transforms_twitter";x["InstagramCategory"]="imgly_transforms_instagram";x["Custom"]="imgly_transform_common_custom";x["Square"]="imgly_transform_common_square";x["ThreeByFour"]="imgly_transform_common_3";x["FourByThree"]="imgly_transform_common_4";x["NineBySixteen"]="imgly_transform_common_9";x["SixteenByNine"]="imgly_transform_common_16";x["FacebookPost"]="imgly_transform_facebook_post";x["FacebookProfile"]="imgly_transform_facebook_profile";x["FacebookTitle"]="imgly_transform_facebook_title";x["InstagramLandscape"]="imgly_transform_instagram_landscape";x["InstagramPortrait"]="imgly_transform_instagram_portrait";x["InstagramSquare"]="imgly_transform_instagram_square";x["InstagramStory"]="imgly_transform_instagram_story";x["TwitterPost"]="imgly_transform_twitter_post";x["TwitterProfile"]="imgly_transform_twitter_profile";x["TwitterTitle"]="imgly_transform_twitter_title"})(Hf||(Hf={}));var qf;(function(m){m["EXPORT"]="export";m["CLOSE"]="close";m["HISTORY_UNDO"]="historyUndo";m["HISTORY_REDO"]="historyRedo";m["HISTORY_CHANGE"]="historyChange";m["EDITOR_READY"]="editorReady";m["ERROR_IMAGE_LOADING"]="errorImageLoading";m["IMAGE_LOAD"]="imageLoad";m["TOOL_ENTER"]="toolEnter";m["STICKER_UPLOAD_ADD"]="stickerUploadAdd";m["ERROR_WEBGL_CONTEXT_LOST"]="errorWebGLContextLost";m["CROP_DIMENSIONS_CHANGE"]="cropDimensionsChange"})(qf||(qf={}));var ho=class{constructor(){this.events={}}addListener(e,t){const i=this.events[e]||(this.events[e]=[]);i.push(t);return this}removeListener(e,t){const i=this.events[e];if(!i){return this}const r=i.lastIndexOf(t);if(r===-1){return this}i.splice(r,1);return this}removeAllListeners(e){this.events[e]=void 0;return this}on(e,t){return this.addListener(e,t)}off(e,t){return this.removeListener(e,t)}emit(e,...t){const i=this.events[e];if(!i||!i.length){return false}i.slice(0).forEach(r=>r.apply(null,t));return true}};ei();var Tn=()=>{return typeof window!=="undefined"&&window.navigator&&window.navigator.userAgent||""};var Kf=(s=Tn())=>{return s.indexOf("Edge")!==-1};var Ya=(s=Tn())=>{return!!s.match(/msie|trident/i)};var bI=(s=Tn())=>{return!!s.match(/windows/i)};var xI=(s=Tn())=>{return s.indexOf("Safari")!==-1&&s.indexOf("Chrome")===-1};var vI=(s=Tn())=>{return!!s.match(/iP(hone|od|ad)|AppleWebKit/)};var wI=()=>{if(typeof document==="undefined"){return false}const s=document.createElement("canvas");const e=s.getContext("webgl")||s.getContext("experimental-webgl");const t=e&&e instanceof WebGLRenderingContext;ke(s);return t};function Ja(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const e=Math.random()*16|0;const t=s==="x"?e:e&3|8;return t.toString(16)})}var Re=class{static fromSize(e){return new Re(e.width,e.height)}static distance(e,t){const i=t.x-e.x;const r=t.y-e.y;return Math.sqrt(i*i+r*r)}static dot(e,t){return e.x*t.x+e.y*t.y}static lerp(e,t,i){const r=Math.min(Math.max(i,0),1);return new Re(e.x*r+t.x*(1-r),e.y*r+t.y*(1-r))}static lerpUnclamped(e,t,i){return new Re(e.x*i+t.x*(1-i),e.y*i+t.y*(1-i))}static proportionalFit(e,t){const i=e.x/e.y;const r=t.x/t.y;if(i>r){return t.multiply(e.y/t.y)}else{return t.multiply(e.x/t.x)}}get magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}get normalized(){const e=this.magnitude;return new Re(this.x/e,this.y/e)}get floored(){return new Re(Math.floor(this.x),Math.floor(this.y))}get rounded(){return new Re(Math.round(this.x),Math.round(this.y))}get min(){return Math.min(this.x,this.y)}get max(){return Math.max(this.x,this.y)}get abs(){return new Re(Math.abs(this.x),Math.abs(this.y))}get swapped(){return new Re(this.y,this.x)}constructor(e,t){if(typeof e==="number"){this.x=e;this.y=t}else{this.x=e.x;this.y=e.y}}clone(){return new Re(this.x,this.y)}add(e,t){if(typeof e==="number"){return new Re(this.x+e,this.y+t)}else{return new Re(this.x+e.x,this.y+e.y)}}subtract(e,t){if(typeof e==="number"){return new Re(this.x-e,this.y-t)}else{return new Re(this.x-e.x,this.y-e.y)}}multiply(e,t){if(typeof e==="number"){return new Re(this.x*e,this.y*(t===void 0?e:t))}else{return new Re(this.x*e.x,this.y*e.y)}}divide(e,t){if(typeof e==="number"){return new Re(this.x/e,this.y/(t===void 0?e:t))}else{return new Re(this.x/e.x,this.y/e.y)}}equals(e){return this.x===e.x&&this.y===e.y}clamp(e,t){const i=Math.max(e.x,Math.min(t.x,this.x));const r=Math.max(e.y,Math.min(t.y,this.y));return new Re(i,r)}};var ne=Re;ne.ZERO=new Re(0,0);ne.ONE=new Re(1,1);ne.UP=new Re(0,1);ne.DOWN=new Re(0,-1);ne.RIGHT=new Re(1,0);ne.LEFT=new Re(-1,0);var $a;(function(S){S[S["EditorContainer"]=0]="EditorContainer";S[S["ToolControlBar"]=1]="ToolControlBar";S[S["ToolControlBarExpandableControls"]=2]="ToolControlBarExpandableControls";S[S["CanvasContainer"]=3]="CanvasContainer";S[S["Canvas"]=4]="Canvas";S[S["MainBarButtonClose"]=5]="MainBarButtonClose";S[S["MainBarButtonExport"]=6]="MainBarButtonExport";S[S["MainBarButtonUndo"]=7]="MainBarButtonUndo";S[S["MainBarButtonRedo"]=8]="MainBarButtonRedo";S[S["MainBarButtonZoom"]=9]="MainBarButtonZoom";S[S["Tooltip"]=10]="Tooltip";S[S["Cursor"]=11]="Cursor";S[S["CursorContainer"]=12]="CursorContainer";S[S["NummericInput"]=13]="NummericInput";S[S["BrushSize"]=14]="BrushSize";S[S["BrushHardness"]=15]="BrushHardness";S[S["Dialog"]=16]="Dialog";S[S["DialogBody"]=17]="DialogBody";S[S["CardContainer"]=18]="CardContainer";S[S["CategoryItemsContainer"]=19]="CategoryItemsContainer";S[S["ToolbarItem"]=20]="ToolbarItem";S[S["ColorList"]=21]="ColorList";S[S["NoResult"]=22]="NoResult";S[S["CardLabel"]=23]="CardLabel";S[S["CardAvatar"]=24]="CardAvatar";S[S["Dropdown"]=25]="Dropdown";S[S["DropdownList"]=26]="DropdownList";S[S["TextAlignment"]=27]="TextAlignment";S[S["Sprite"]=28]="Sprite";S[S["SpriteTopLeft"]=29]="SpriteTopLeft";S[S["SpriteTopRight"]=30]="SpriteTopRight";S[S["SpriteBottomLeft"]=31]="SpriteBottomLeft";S[S["SpriteBottomRight"]=32]="SpriteBottomRight";S[S["Knob"]=33]="Knob";S[S["TextWidth"]=34]="TextWidth";S[S["ToolbarWrapper"]=35]="ToolbarWrapper";S[S["MainCanvasActionBar"]=36]="MainCanvasActionBar";S[S["SpriteActions"]=37]="SpriteActions";S[S["CarouselSlider"]=38]="CarouselSlider";S[S["CropMask"]=39]="CropMask";S[S["FlipRotateControls"]=40]="FlipRotateControls";S[S["RotateSlider"]=41]="RotateSlider";S[S["CropTopRight"]=42]="CropTopRight";S[S["CropTopLeft"]=43]="CropTopLeft";S[S["CropBottomRight"]=44]="CropBottomRight";S[S["CropBottomLeft"]=45]="CropBottomLeft";S[S["Watermark"]=46]="Watermark";S[S["Toolbar"]=47]="Toolbar";S[S["CanvasBar"]=48]="CanvasBar";S[S["Checkbox"]=49]="Checkbox";S[S["Focus"]=50]="Focus";S[S["SnappingLine"]=51]="SnappingLine";S[S["LibraryUploadButton"]=52]="LibraryUploadButton";S[S["LibraryWebcamButton"]=53]="LibraryWebcamButton";S[S["ZoomLevel"]=54]="ZoomLevel";S[S["BasicToolControlBar"]=55]="BasicToolControlBar"})($a||($a={}));var Xf={};for(const s in $a){const e=$a[s];if(typeof e==="string"){Xf[e]=e}}var RI=Xf;var Yf;var EI=Boolean(typeof window!=="undefined"&&((Yf=window.Cypress)==null?void 0:Yf.env("pesdk")));lm();var Jf={};Me(Jf,{isMobile:()=>um});function um(){if(typeof navigator==="undefined"){return false}const s=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(s)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(s.substr(0,4))}var FI=s=>{s.preventDefault();s.stopPropagation()};var $f=(...s)=>{};var MI=typeof window!=="undefined"?window.performance.now.bind(window.performance):$f();var Rn=class{constructor(e){this.text=e;this.lastOffsetWidth=-1;const t="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;";this.element=document.createElement("div");this.element.setAttribute("aria-hidden","true");this.element.appendChild(document.createTextNode(e));this.collapsible=document.createElement("span");this.expandable=document.createElement("span");this.collapsibleInner=document.createElement("span");this.expandableInner=document.createElement("span");this.collapsible.style.cssText=t;this.expandable.style.cssText=t;this.expandableInner.style.cssText=t;this.collapsibleInner.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;";this.collapsible.appendChild(this.collapsibleInner);this.expandable.appendChild(this.expandableInner);this.element.appendChild(this.collapsible);this.element.appendChild(this.expandable)}getElement(){return this.element}setFont(e){this.element.style.cssText=`max-width:none;
      min-width:20px;
      min-height:20px;
      display:inline-block;
      overflow:hidden;
      position:absolute;
      width:auto;
      margin:0;
      padding:0;
      top:-999px;
      white-space:nowrap;
      font-synthesis:none;
      font:${e};`}getWidth(){return this.element.offsetWidth}setWidth(e){this.element.style.width=`${e}px`}onResize(e){const t=()=>{this.onScroll(e)};this.collapsible.addEventListener("scroll",t);this.expandable.addEventListener("scroll",t);this.reset()}reset(){const e=this.getWidth();const t=e+100;this.expandableInner.style.width=`${t}px`;this.expandable.scrollLeft=t;this.collapsible.scrollLeft=this.collapsible.scrollWidth+100;if(this.lastOffsetWidth!==e){this.lastOffsetWidth=e;return true}return false}onScroll(e){if(this.reset()&&this.element.parentNode!==null){e(this.lastOffsetWidth)}}};var Ae=class{static getUserAgent(){return window.navigator.userAgent}static getNavigatorVendor(){return window.navigator.vendor}static hasWebKitFallbackBug(){if(Ae.HAS_WEBKIT_FALLBACK_BUG===null){const e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(Ae.getUserAgent());Ae.HAS_WEBKIT_FALLBACK_BUG=!!e&&(parseInt(e[1],10)<536||parseInt(e[1],10)===536&&parseInt(e[2],10)<=11)}return Ae.HAS_WEBKIT_FALLBACK_BUG}static hasSafari10Bug(){if(Ae.HAS_SAFARI_10_BUG===null){if(Ae.supportsNativeFontLoading()&&/Apple/.test(Ae.getNavigatorVendor())){const e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(Ae.getUserAgent());Ae.HAS_SAFARI_10_BUG=!!e&&parseInt(e[1],10)<603}else{Ae.HAS_SAFARI_10_BUG=false}}return Ae.HAS_SAFARI_10_BUG}static supportsNativeFontLoading(){if(Ae.SUPPORTS_NATIVE_FONT_LOADING===null){Ae.SUPPORTS_NATIVE_FONT_LOADING=!!document["fonts"]}return Ae.SUPPORTS_NATIVE_FONT_LOADING}static supportsStretch(){if(Ae.SUPPORTS_STRETCH===null){const e=document.createElement("div");try{e.style.font="condensend 100px sans-serif"}catch(t){Ae.SUPPORTS_STRETCH=false}Ae.SUPPORTS_STRETCH=e.style.font!==""}return Ae.SUPPORTS_STRETCH}constructor(e){this.font={fontFamily:"normal",fontStyle:"normal",fontWeight:"normal",fontStretch:"normal",...e}}load(e,t){const i="BESbswy";let r=null;const o=t||Ae.DEFAULT_TIMEOUT;const n=this.getTime();return new Promise((a,l)=>{if(Ae.supportsNativeFontLoading()&&!Ae.hasSafari10Bug()){const u=new Promise((h,m)=>{const d=()=>{const f=this.getTime();if(f-n>=o){m(new Error(""+o+"ms timeout exceeded"))}else{document["fonts"].load(this.getStyle(`"${this.font.fontFamily}"`),i).then(b=>{if(b.length>=1){h()}else{setTimeout(d,25)}},l)}};d()});const c=new Promise((h,m)=>{r=setTimeout(()=>{m(new Error(`${o} ms timeout exceeded`))},o)});Promise.race([c,u]).then(()=>{clearTimeout(r);a(this)},l)}else{const u=new Rn(i);const c=new Rn(i);const h=new Rn(i);let m=-1;let d=-1;let f=-1;let b=-1;let y=-1;let g=-1;const C=document.createElement("div");const v=()=>{if(C.parentNode!==null){C.parentNode.removeChild(C)}};const x=()=>{if(m!==-1&&d!==-1||m!==-1&&f!==-1||d!==-1&&f!==-1){if(m===d||m===f||d===f){if(Ae.hasWebKitFallbackBug()){if(m===b&&d===b&&f===b||m===y&&d===y&&f===y||m===g&&d===g&&f===g){return}}v();clearTimeout(r);a(this)}}};C.dir="ltr";u.setFont(this.getStyle("sans-serif"));c.setFont(this.getStyle("serif"));h.setFont(this.getStyle("monospace"));C.appendChild(u.getElement());C.appendChild(c.getElement());C.appendChild(h.getElement());document.body.appendChild(C);b=u.getWidth();y=c.getWidth();g=h.getWidth();const B=()=>{const w=this.getTime();if(w-n>=o){v();l(new Error(`${o} ms timeout exceeded`))}else{const D=document.hidden;if(D===true||D===void 0){m=u.getWidth();d=c.getWidth();f=h.getWidth();x()}r=setTimeout(B,50)}};B();u.onResize(w=>{m=w;x()});u.setFont(this.getStyle(`"${this.font.fontFamily}",sans-serif`));c.onResize(w=>{d=w;x()});c.setFont(this.getStyle(`"${this.font.fontFamily}",serif`));h.onResize(w=>{f=w;x()});h.setFont(this.getStyle(`"${this.font.fontFamily}",monospace`))}})}getStyle(e){return[this.font.fontStyle,this.font.fontWeight,Ae.supportsStretch()?this.font.fontStretch:"","100px",e].join(" ")}getTime(){return new Date().getTime()}};var pr=Ae;pr.HAS_WEBKIT_FALLBACK_BUG=null;pr.HAS_SAFARI_10_BUG=null;pr.SUPPORTS_STRETCH=null;pr.SUPPORTS_NATIVE_FONT_LOADING=null;pr.DEFAULT_TIMEOUT=6e4;var Mi;(function(t){t["BEGAN_IMAGE_DOWNSCALING"]="beganImageDownscaling";t["IMAGE_DOWNSCALED"]="imageDownscaled"})(Mi||(Mi={}));var En=class extends ho{constructor(e,t){super();this.image=e;this.options=t}needsResize(){const e=this.resizedDimensions();return e.x<this.image.width||e.y<this.image.height}resizedDimensions(){const{options:e}=this;const t={width:this.image.width,height:this.image.height};let i=ne.fromSize(t);let r=ne.fromSize(t);const{maxMegaPixels:o}=e;if(o){const l=(um()?o.mobile:o.desktop)*1e6;const u=t.width/t.height;const c=t.height/t.width;const h=new ne(Math.floor(Math.sqrt(l*u)),Math.floor(Math.sqrt(l*c)));if(h.x<=t.width&&h.y<=t.height){i=h}}const n=e.maxDimensions;if(n){if(n.height<t.height||n.width<t.width){r=new ne(n.width,n.height)}}const a=new ne(Math.min(i.x,r.x),Math.min(i.y,r.y));return ne.proportionalFit(a,ne.fromSize(t)).floored}downscaleIfNecessary(){const e=this.resizedDimensions();const t=e.x<this.image.width||e.y<this.image.height;if(!t){return this.image}this.emit(Mi.BEGAN_IMAGE_DOWNSCALING,this.image);const i=document.createElement("canvas");i.width=e.x;i.height=e.y;const r=i.getContext("2d");const{image:o}=this;r.imageSmoothingQuality="high";r.drawImage(o,0,0,o.width,o.height,0,0,e.x,e.y);this.emit(Mi.IMAGE_DOWNSCALED,{width:e.x,height:e.y});return i}downscaleImageIfNecessary(){const e=this.image;const t=this.resizedDimensions();const i=t.x<this.image.width||t.y<this.image.height;if(!i){return e}this.emit(Mi.BEGAN_IMAGE_DOWNSCALING,e);const r=new Image;r.width=t.x;r.height=t.y;r.src=e.src;this.emit(Mi.IMAGE_DOWNSCALED,{width:t.x,height:t.y});return r}};var dk=s=>s.key==="Enter";var pk=s=>s.key==="Escape";var KI=s=>e=>{if(dk(e))s(e)};var XI=s=>e=>{if(pk(e))s(e)};function hk(s,e){let t=0;for(let i=s.length-1;i>=0;i--){const r=s[i];if(r==="."){s.splice(i,1)}else if(r===".."){s.splice(i,1);t++}else if(t){s.splice(i,1);t--}}if(e){for(;t--;t){s.unshift("..")}}return s}function fk(s){return s.charAt(0)==="/"}function gk(s){const e=fk(s);const t=s.substr(-1)==="/";s=hk(s.split("/").filter(Boolean),!e).join("/");if(!s&&!e){s="."}if(s&&t){s+="/"}return(e?"/":"")+s}var Sn=(...s)=>{return gk(s.join("/"))};var vk=Ur(Qf());var ZI=(s,e,[t,i],r=0)=>{const o=s[e];if(o){if(o<t){console.error(`${e} must be greater than or equal to ${t}`);return t}if(o>i){console.error(`${e} must be less than or equal to ${i}`);return i}}return o||r};var QI=(s,e,t=[1,1,1,1])=>{const i=s[e];let r=true;if(i){i.forEach(o=>{if(o<0){console.error(`${o} in ${e} must be greater than or equal to 0`);r=false}if(o>1){console.error(`${o} in ${e} must be less than or equal to 1`);r=false}})}if(!r)return t;return i||t};var tP=s=>s*.08;var iP=s=>s*.03;var eg=(s,e)=>{const t=s.indexOf(e);if(t===-1||!s.length)return void 0;if(t===s.length-1)return s[0];return s[t+1]};var tg=(s,e)=>{const t=s.indexOf(e);if(t===-1||!s.length)return void 0;if(t===0)return s[s.length-1];return s[t-1]};var Fn={};var cm=({src:s,crossOrigin:e,key:t,resolve:i,reject:r})=>{Fn[t]=s;const o=new Image;o.onload=()=>{if(Fn[t]===s){i(o);delete Fn[t]}};o.onerror=n=>{if(Fn[t]===s){r(n);delete Fn[t]}};o.crossOrigin=e;o.src=s};var wk=class extends Error{constructor(e){super(e);this.name="AssetNotFoundError"}};var aP=()=>Math.max(window.devicePixelRatio||1,1);var Ck=new RegExp(/\uD83D\uDC68\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D\uD83D\uDC68|\uD83D\uDC69\u200D\u2764\uFE0F\u200D\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|\uD83D\uDC68\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFE])|\uD83D\uDC68\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83D\uDC68\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83D\uDC68\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83D\uDC68\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D\uD83D\uDC68(?:\uD83C[\uDFFC-\uDFFF])|\uD83D\uDC69(?:\u200D\uD83D\uDC69\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83C\uDFFF\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFE])|\uD83C\uDFFE\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB-\uDFFD\uDFFF])|\uD83C\uDFFD\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB\uDFFC\uDFFE\uDFFF])|\uD83C\uDFFC\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFB\uDFFD-\uDFFF])|\uD83C\uDFFB\u200D\uD83E\uDD1D\u200D(?:\uD83D[\uDC68\uDC69])(?:\uD83C[\uDFFC-\uDFFF]))|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68\u200D(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67]))|\uD83D\uDC68\u200D\u2764\uFE0F\u200D\uD83D\uDC68|\uD83D\uDC69\u200D\u2764\uFE0F\u200D(?:\uD83D[\uDC68\uDC69])|\uD83E\uDDD1\u200D\uD83E\uDD1D\u200D\uD83E\uDDD1|\uD83D\uDC69\u200D\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC68(?:\u200D(?:\uD83D\uDC66\u200D\uD83D\uDC66|(?:\uD83D[\uDC67-\uDC69])\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]\uFE0F)|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83C\uDFF3\uFE0F\u200D\u26A7|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC70\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642])\uFE0F|(?:\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF]))\u200D[\u2695\u2696\u2708]\uFE0F|\uD83D\uDC69\u200D(?:\uD83D[\uDC67\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|\uD83E\uDDD1(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83D\uDC3B\u200D\u2744|\uD83C\uDFF4\u200D\u2620|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E-\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD35\uDD37-\uDD39\uDD3C-\uDD3E\uDDB8\uDDB9\uDDCD-\uDDCF\uDDD6-\uDDDF])\u200D[\u2640\u2642])\uFE0F|\uD83E\uDDD1\u200D[\u2695\u2696\u2708]\uFE0F|(?:\uD83D[\uDC68\uDC69])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|\u200D[\u2695\u2696\u2708]\uFE0F)|\uD83D\uDC15\u200D\uD83E\uDDBA|\uD83D\uDC08\u200D\u2B1B|\uD83E\uDDD1\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF84\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83C[\uDF3E\uDF73\uDF7C\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDC66\uDC67\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDAF-\uDDB3\uDDBC\uDDBD])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|(?:[\u270A\u270B]|\uD83C[\uDF85\uDFC3\uDFC7]|\uD83D[\uDC43\uDC4A-\uDC4C\uDC4F\uDC50\uDC66-\uDC69\uDC6B-\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD7A\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD0C\uDD0F\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDD77\uDDB5\uDDB6\uDDB8\uDDB9\uDDBB\uDDCD-\uDDCF\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u26F9\u270C\u270D]|\uD83C[\uDFC2\uDFC4\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC46-\uDC49\uDC4D\uDC4E\uDD74\uDD75\uDD90])(?:\uFE0F|\uD83C[\uDFFB-\uDFFF])|(?:[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9\u23EA\u23ED-\u23EF\u23F1-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2642\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26A7\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7\u26F8\u26FA\u26FD\u2702\u2708\u2709\u270F\u2712\u2714\u2716\u271D\u2721\u2733\u2734\u2744\u2747\u2753\u2757\u2763\u2764\u27A1\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDD70\uDD71\uDD7E\uDD7F\uDE02\uDE1A\uDE2F\uDE37\uDF0D-\uDF0F\uDF15\uDF1C\uDF21\uDF24-\uDF2C\uDF36\uDF78\uDF7D\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E\uDF9F\uDFA7\uDFAC-\uDFAE\uDFC6\uDFCD\uDFCE\uDFD4-\uDFE0\uDFED\uDFF3\uDFF5\uDFF7]|\uD83D[\uDC08\uDC15\uDC1F\uDC26\uDC3F\uDC41\uDC53\uDC6A\uDC7D\uDCA3\uDCB0\uDCB3\uDCBB\uDCBF\uDCCB\uDCDA\uDCDF\uDCE4-\uDCE6\uDCEA-\uDCED\uDCF7\uDCF9-\uDCFB\uDCFD\uDD08\uDD0D\uDD12\uDD13\uDD49\uDD4A\uDD50-\uDD67\uDD6F\uDD70\uDD73\uDD76-\uDD79\uDD87\uDD8A-\uDD8D\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA\uDE10\uDE87\uDE8D\uDE91\uDE94\uDE98\uDEAD\uDEB2\uDEB9\uDEBA\uDEBC\uDECB\uDECD-\uDECF\uDEE0-\uDEE5\uDEE9\uDEF0\uDEF3])\uFE0F|[\u23E9-\u23F3\u23F8-\u23FA\u25FB-\u25FE\u2614\u2615\u267F\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26C8\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2705\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDED5-\uDED7\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEFC\uDFE0-\uDFEB]|\uD83E[\uDD0C-\uDD3A\uDD3C-\uDD45\uDD47-\uDD78\uDD7A-\uDDCB\uDDCD-\uDDFF\uDE70-\uDE74\uDE78-\uDE7A\uDE80-\uDE86\uDE90-\uDEA8\uDEB0-\uDEB6\uDEC0-\uDEC2\uDED0-\uDED6]/g);var SP=s=>s.replace(Ck,"");var On=s=>{try{new URL(s);return true}catch(e){return false}};var AP=s=>{return s instanceof HTMLImageElement};var Dk=[{identifier:"basics",name:"Basics",items:[{identifier:st.BRIGHTNESS},{identifier:st.CONTRAST},{identifier:st.SATURATION},{identifier:st.GAMMA}]},{identifier:"refinements",name:"Refinements",items:[{identifier:st.CLARITY},{identifier:st.SHADOWS},{identifier:st.HIGHLIGHTS},{identifier:st.EXPOSURE},{identifier:st.BLACKS},{identifier:st.WHITES},{identifier:st.TEMPERATURE},{identifier:st.SHARPNESS}]}];var Qa=Dk;var kk=[{identifier:mi.DuoTone,name:"DuoTone",thumbnailURI:"./categories/duotone.jpg",items:[{identifier:z.Desert,name:"Desert",thumbnailURI:"./items/imgly_duotone_desert.jpg",lightColor:"#e1de9a",darkColor:"#cb2129",defaultIntensity:.5},{identifier:z.Peach,name:"Peach",thumbnailURI:"./items/imgly_duotone_peach.jpg",lightColor:"#e9abb8",darkColor:"#0040ff",defaultIntensity:.5},{identifier:z.Clash,name:"Clash",thumbnailURI:"./items/imgly_duotone_clash.jpg",lightColor:"#f41a0f",darkColor:"#23007c",defaultIntensity:.5},{identifier:z.Plum,name:"Plum",thumbnailURI:"./items/imgly_duotone_plum.jpg",lightColor:"#74d7ff",darkColor:"#23007c",defaultIntensity:.5},{identifier:z.Breezy,name:"Breezy",thumbnailURI:"./items/imgly_duotone_breezy.jpg",lightColor:"#68fdff",darkColor:"#c20000",defaultIntensity:.5},{identifier:z.DeepBlue,name:"Deep Blue",thumbnailURI:"./items/imgly_duotone_deepblue.jpg",lightColor:"#2de9eb",darkColor:"#58007c",defaultIntensity:.5},{identifier:z.Frog,name:"Frog",thumbnailURI:"./items/imgly_duotone_frog.jpg",lightColor:"#5bff60",darkColor:"#7f23a9",defaultIntensity:.5},{identifier:z.Sunset,name:"Sunset",thumbnailURI:"./items/imgly_duotone_sunset.jpg",lightColor:"#f8ea46",darkColor:"#c400be",defaultIntensity:.5}]},{identifier:mi.BW,name:"B & W",thumbnailURI:"./categories/b&w.jpg",items:[{identifier:z.AD1920,name:"1920 A.D.",thumbnailURI:"./items/imgly_lut_ad1920.jpg",lutURI:"./items/imgly_lut_ad1920_5_5_128.png",defaultIntensity:1},{identifier:z.Greyed,name:"Greyed",thumbnailURI:"./items/imgly_lut_bw.jpg",lutURI:"./items/imgly_lut_bw_5_5_128.png",defaultIntensity:1},{identifier:z.Dusty,name:"Dusty",thumbnailURI:"./items/imgly_lut_x400.jpg",lutURI:"./items/imgly_lut_dusty_5_5_128.png",defaultIntensity:1},{identifier:z.Litho,name:"Litho",thumbnailURI:"./items/imgly_lut_litho.jpg",lutURI:"./items/imgly_lut_litho_5_5_128.png",defaultIntensity:1},{identifier:z.Sepia,name:"Sepia",thumbnailURI:"./items/imgly_lut_sepiahigh.jpg",lutURI:"./items/imgly_lut_sepia_5_5_128.png",defaultIntensity:1},{identifier:z.Weathered,name:"Weathered",thumbnailURI:"./items/imgly_lut_plate.jpg",lutURI:"./items/imgly_lut_weathered_5_5_128.png",defaultIntensity:1},{identifier:z.HardStuff,name:"Hard Stuff",thumbnailURI:"./items/imgly_lut_sin.jpg",lutURI:"./items/imgly_lut_hard_stuff_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8}]},{identifier:mi.Vintage,name:"Vintage",thumbnailURI:"./categories/vintage.jpg",items:[{identifier:z.Polaroid,name:"Polaroid",thumbnailURI:"./items/imgly_lut_blues.jpg",lutURI:"./items/imgly_lut_polaroid_5_5_128.png",defaultIntensity:1},{identifier:z.Sunny70s,name:"Sunny 70s",thumbnailURI:"./items/imgly_lut_front.jpg",lutURI:"./items/imgly_lut_sunny_70s_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:z.Oldtimer,name:"Oldtimer",thumbnailURI:"./items/imgly_lut_texas.jpg",lutURI:"./items/imgly_lut_oldtimer_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:z.Inferno,name:"Inferno",thumbnailURI:"./items/imgly_lut_celsius.jpg",lutURI:"./items/imgly_lut_inferno_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:z.Snappy,name:"Snappy",thumbnailURI:"./items/imgly_lut_cool.jpg",lutURI:"./items/imgly_lut_snappy_5_5_128.png",defaultIntensity:1}]},{identifier:mi.Smooth,name:"Smooth",thumbnailURI:"./categories/smooth.jpg",items:[{identifier:z.Chestnut,name:"Chestnut",thumbnailURI:"./items/imgly_lut_chest.jpg",lutURI:"./items/imgly_lut_chestnut_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:z.Softy,name:"Softy",thumbnailURI:"./items/imgly_lut_winter.jpg",lutURI:"./items/imgly_lut_softly_5_5_128.png",defaultIntensity:1},{identifier:z.Pebble,name:"Pebble",thumbnailURI:"./items/imgly_lut_kdynamic.jpg",lutURI:"./items/imgly_lut_pebble_5_5_128.png",defaultIntensity:1},{identifier:z.Moss,name:"Moss",thumbnailURI:"./items/imgly_lut_fall.jpg",lutURI:"./items/imgly_lut_moss_5_5_128.png",defaultIntensity:1},{identifier:z.Lemon,name:"Lemon",thumbnailURI:"./items/imgly_lut_lenin.jpg",lutURI:"./items/imgly_lut_lemon_5_5_128.png",defaultIntensity:1},{identifier:z.GreenGap,name:"Green Gap",thumbnailURI:"./items/imgly_lut_pola669.jpg",lutURI:"./items/imgly_lut_green_gap_5_5_128.png",defaultIntensity:1}]},{identifier:mi.Cold,name:"Cold",thumbnailURI:"./categories/cold.jpg",items:[{identifier:z.Colla,name:"Colla",thumbnailURI:"./items/imgly_lut_elder.jpg",lutURI:"./items/imgly_lut_colla_5_5_128.png",defaultIntensity:1},{identifier:z.Solanus,name:"Solanus",thumbnailURI:"./items/imgly_lut_orchid.jpg",lutURI:"./items/imgly_lut_solanus_5_5_128.png",defaultIntensity:1},{identifier:z.Kalmen,name:"Kalmen",thumbnailURI:"./items/imgly_lut_bleached.jpg",lutURI:"./items/imgly_lut_kalmen_5_5_128.png",defaultIntensity:1},{identifier:z.Joran,name:"Joran",thumbnailURI:"./items/imgly_lut_bleachedblue.jpg",lutURI:"./items/imgly_lut_joran_5_5_128.png",defaultIntensity:1},{identifier:z.Levante,name:"Levante",thumbnailURI:"./items/imgly_lut_breeze.jpg",lutURI:"./items/imgly_lut_levante_5_5_128.png",defaultIntensity:1},{identifier:z.Zephyr,name:"Zephyr",thumbnailURI:"./items/imgly_lut_blueshadows.jpg",lutURI:"./items/imgly_lut_zephyr_5_5_128.png",defaultIntensity:1}]},{identifier:mi.Warm,name:"Warm",thumbnailURI:"./categories/warm.jpg",items:[{identifier:z.Golden,name:"Golden",thumbnailURI:"./items/imgly_lut_sunset.jpg",lutURI:"./items/imgly_lut_golden_5_5_128.png",defaultIntensity:1},{identifier:z.LowFire,name:"Low Fire",thumbnailURI:"./items/imgly_lut_eighties.jpg",lutURI:"./items/imgly_lut_low_fire_5_5_128.png",defaultIntensity:1},{identifier:z.Sunrise,name:"Sunrise",thumbnailURI:"./items/imgly_lut_evening.jpg",lutURI:"./items/imgly_lut_sunrise_5_5_128.png",defaultIntensity:1},{identifier:z.FlatBlack,name:"Flat Black",thumbnailURI:"./items/imgly_lut_k2.jpg",lutURI:"./items/imgly_lut_flat_black_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:z.Pumpkin,name:"Pumpkin",thumbnailURI:"./items/imgly_lut_nogreen.jpg",lutURI:"./items/imgly_lut_pumpkin_5_5_128.png",defaultIntensity:1}]},{identifier:mi.Legacy,name:"Legacy",thumbnailURI:"./categories/legacy.jpg",items:[{identifier:z.Ancient,name:"Ancient",thumbnailURI:"./items/imgly_lut_ancient.jpg",lutURI:"./items/imgly_lut_ancient_5_5_128.png",defaultIntensity:1},{identifier:z.Candy,name:"Candy",thumbnailURI:"./items/imgly_lut_cottoncandy.jpg",lutURI:"./items/imgly_lut_cottoncandy_5_5_128.png",defaultIntensity:1},{identifier:z.Classic,name:"Classic",thumbnailURI:"./items/imgly_lut_classic.jpg",lutURI:"./items/imgly_lut_classic_5_5_128.png",defaultIntensity:1},{identifier:z.Colorful,name:"Colorful",thumbnailURI:"./items/imgly_lut_colorful.jpg",lutURI:"./items/imgly_lut_colorful_5_5_128.png",defaultIntensity:1},{identifier:z.Creamy,name:"Creamy",thumbnailURI:"./items/imgly_lut_creamy.jpg",lutURI:"./items/imgly_lut_creamy_5_5_128.png",defaultIntensity:1},{identifier:z.Fixie,name:"Fixie",thumbnailURI:"./items/imgly_lut_fixie.jpg",lutURI:"./items/imgly_lut_fixie_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:z.Food,name:"Food",thumbnailURI:"./items/imgly_lut_food.jpg",lutURI:"./items/imgly_lut_food_5_5_128.png",defaultIntensity:1},{identifier:z.Fridge,name:"Fridge",thumbnailURI:"./items/imgly_lut_fridge.jpg",lutURI:"./items/imgly_lut_fridge_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:z.Glam,name:"Glam",thumbnailURI:"./items/imgly_lut_glam.jpg",lutURI:"./items/imgly_lut_glam_5_5_128.png",defaultIntensity:1},{identifier:z.Gobblin,name:"Gobblin",thumbnailURI:"./items/imgly_lut_gobblin.jpg",lutURI:"./items/imgly_lut_gobblin_5_5_128.png",defaultIntensity:1},{identifier:z.Hicon,name:"Hicon",thumbnailURI:"./items/imgly_lut_highcontrast.jpg",lutURI:"./items/imgly_lut_highcontrast_5_5_128.png",defaultIntensity:1},{identifier:z.HighCarb,name:"High Carb",thumbnailURI:"./items/imgly_lut_highcarb.jpg",lutURI:"./items/imgly_lut_highcarb_5_5_128.png",defaultIntensity:1},{identifier:z.K1,name:"K1",thumbnailURI:"./items/imgly_lut_k1.jpg",lutURI:"./items/imgly_lut_k1_5_5_128.png",defaultIntensity:1},{identifier:z.K6,name:"K6",thumbnailURI:"./items/imgly_lut_k6.jpg",lutURI:"./items/imgly_lut_k6_5_5_128.png",defaultIntensity:1},{identifier:z.Keen,name:"Keen",thumbnailURI:"./items/imgly_lut_keen.jpg",lutURI:"./items/imgly_lut_keen_5_5_128.png",defaultIntensity:1},{identifier:z.Lomo,name:"Lomo",thumbnailURI:"./items/imgly_lut_lomo.jpg",lutURI:"./items/imgly_lut_lomo_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:z.Lomo100,name:"Lomo 100",thumbnailURI:"./items/imgly_lut_lomo100.jpg",lutURI:"./items/imgly_lut_lomo100_5_5_128.png",defaultIntensity:1},{identifier:z.Lucid,name:"Lucid",thumbnailURI:"./items/imgly_lut_lucid.jpg",lutURI:"./items/imgly_lut_lucid_5_5_128.png",defaultIntensity:1},{identifier:z.Mellow,name:"Mellow",thumbnailURI:"./items/imgly_lut_mellow.jpg",lutURI:"./items/imgly_lut_mellow_8_8_512.png",defaultIntensity:1,horizontalTileCount:8,verticalTileCount:8},{identifier:z.Neat,name:"Neat",thumbnailURI:"./items/imgly_lut_neat.jpg",lutURI:"./items/imgly_lut_neat_5_5_128.png",defaultIntensity:1},{identifier:z.Pale,name:"Pale",thumbnailURI:"./items/imgly_lut_pale.jpg",lutURI:"./items/imgly_lut_pale_5_5_128.png",defaultIntensity:1},{identifier:z.Pitched,name:"Pitched",thumbnailURI:"./items/imgly_lut_pitched.jpg",lutURI:"./items/imgly_lut_pitched_5_5_128.png",defaultIntensity:1},{identifier:z.PolaSX,name:"Pola SX",thumbnailURI:"./items/imgly_lut_polasx.jpg",lutURI:"./items/imgly_lut_polasx_5_5_128.png",defaultIntensity:1},{identifier:z.Pro400,name:"Pro 400",thumbnailURI:"./items/imgly_lut_pro400.jpg",lutURI:"./items/imgly_lut_pro400_5_5_128.png",defaultIntensity:1},{identifier:z.Quozi,name:"Quozi",thumbnailURI:"./items/imgly_lut_quozi.jpg",lutURI:"./items/imgly_lut_quozi_5_5_128.png",defaultIntensity:1},{identifier:z.Settled,name:"Settled",thumbnailURI:"./items/imgly_lut_settled.jpg",lutURI:"./items/imgly_lut_settled_5_5_128.png",defaultIntensity:1},{identifier:z.Seventies,name:"Seventies",thumbnailURI:"./items/imgly_lut_seventies.jpg",lutURI:"./items/imgly_lut_seventies_5_5_128.png",defaultIntensity:1},{identifier:z.Soft,name:"Soft",thumbnailURI:"./items/imgly_lut_soft.jpg",lutURI:"./items/imgly_lut_soft_5_5_128.png",defaultIntensity:1},{identifier:z.Steel,name:"Steel",thumbnailURI:"./items/imgly_lut_steel.jpg",lutURI:"./items/imgly_lut_steel_5_5_128.png",defaultIntensity:1},{identifier:z.Summer,name:"Summer",thumbnailURI:"./items/imgly_lut_summer.jpg",lutURI:"./items/imgly_lut_summer_5_5_128.png",defaultIntensity:1},{identifier:z.Tender,name:"Tender",thumbnailURI:"./items/imgly_lut_tender.jpg",lutURI:"./items/imgly_lut_tender_5_5_128.png",defaultIntensity:1},{identifier:z.Twilight,name:"Twilight",thumbnailURI:"./items/imgly_lut_twilight.jpg",lutURI:"./items/imgly_lut_twilight_5_5_128.png",defaultIntensity:1}]}];var el=kk;var Tk=[{identifier:qr.RADIAL,thumbnailURI:"./items/radial.png"},{identifier:qr.MIRRORED,thumbnailURI:"./items/mirrored.png"},{identifier:qr.LINEAR,thumbnailURI:"./items/linear.png"},{identifier:qr.GAUSSIAN,thumbnailURI:"./items/gaussian.png"}];var mm=Tk;var Rk=[{identifier:"imgly_font_open_sans_bold",fontFamily:"Open Sans",fontWeight:"bold",fontURI:"./fonts/imgly_font_open_sans_bold.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2189,descender:-600}},{identifier:"imgly_font_aleo_bold",fontFamily:"Aleo",fontWeight:"bold",fontURI:"./fonts/imgly_font_aleo_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:805,descender:-195}},{identifier:"imgly_font_amaticsc",fontFamily:"Amatic SC",fontWeight:"normal",fontURI:"./fonts/imgly_font_amaticsc.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1016,descender:-245}},{identifier:"imgly_font_archivo_black",fontFamily:"Archivo",fontWeight:"normal",fontURI:"./fonts/imgly_font_archivo_black.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:878,descender:-210}},{identifier:"imgly_font_bungee_inline",fontFamily:"Bungee Inline",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_bungee_inline.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:860,descender:-140}},{identifier:"imgly_font_fira_sans_regular",fontFamily:"Fira Sans",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_fira_sans_regular.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:935,descender:-265}},{identifier:"imgly_font_campton_bold",fontFamily:"Campton Book",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_campton_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:770,descender:-294}},{identifier:"imgly_font_carter_one",fontFamily:"Carter One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_carter_one.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2264,descender:-890}},{identifier:"imgly_font_codystar",fontFamily:"Codystar",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_codystar.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:953,descender:-255}},{identifier:"imgly_font_galano_grotesque_bold",fontFamily:"Galano Grotesque",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_galano_grotesque_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}},{identifier:"imgly_font_krona_one",fontFamily:"Krona One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_krona_one.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2030,descender:-530}},{identifier:"imgly_font_kumar_one_outline",fontFamily:"Kumar One Outline",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_kumar_one_outline.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1137,descender:-642}},{identifier:"imgly_font_lobster",fontFamily:"Lobster",fontWeight:"normal",fontURI:"./fonts/imgly_font_lobster.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1e3,descender:-250}},{identifier:"imgly_font_molle",fontFamily:"Molle",fontWeight:"normal",fontStyle:"italic",fontURI:"./fonts/imgly_font_molle.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1852,descender:-701}},{identifier:"imgly_font_monoton",fontFamily:"Monoton",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_monoton.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2366,descender:-822}},{identifier:"imgly_font_nixie_one",fontFamily:"Nixie One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_nixie_one.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:926,descender:-210}},{identifier:"imgly_font_notable",fontFamily:"Notable",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_notable.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1143,descender:-157}},{identifier:"imgly_font_ostrich_sans_black",fontFamily:"Ostrich",fontWeight:800,fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_black.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_ostrich_sans_bold",fontFamily:"Ostrich",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:950,descender:-250}},{identifier:"imgly_font_oswald_semi_bold",fontFamily:"Oswald SemiBold",googleFamily:"Oswald",fontWeight:600,fontStyle:"normal",fontURI:"./fonts/imgly_font_oswald_semi_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1193,descender:-289}},{identifier:"imgly_font_palanquin_dark_semi_bold",fontFamily:"Palanquin Dark SemiBold",googleFamily:"Palanquin Dark",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_palanquin_dark_semi_bold.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1320,descender:-491}},{identifier:"imgly_font_poppins",fontFamily:"Poppins",fontWeight:"bold",fontStyle:"normal",fontURI:"./fonts/imgly_font_poppins.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1050,descender:-350}},{identifier:"imgly_font_permanent_marker",fontFamily:"Permanent Marker",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_permanent_marker.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:1136,descender:-325}},{identifier:"imgly_font_roboto_black_italic",fontFamily:"Roboto Black",fontWeight:"bold",fontStyle:"italic",googleFamily:"Roboto",fontURI:"./fonts/imgly_font_roboto_black_italic.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light_italic",fontFamily:"Roboto Light",googleFamily:"Roboto",fontWeight:300,fontStyle:"italic",fontURI:"./fonts/imgly_font_roboto_light_italic.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_sancreek",fontFamily:"Sancreek",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_sancreek.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2104,descender:-738}},{identifier:"imgly_font_stint_ultra_expanded",fontFamily:"Stint Ultra Expanded",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_stint_ultra_expanded.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1853,descender:-483}},{identifier:"imgly_font_trash_hand",fontFamily:"Trash Hand",fontWeight:"normal",fontURI:"./fonts/imgly_font_trash_hand.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:759,descender:-304}},{identifier:"imgly_font_vt323",fontFamily:"VT323",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_vt323.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:800,descender:-200}},{identifier:"imgly_font_yeseva_one",fontFamily:"Yeseva One",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_yeseva_one.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:915,descender:-240}},{identifier:"imgly_font_abril_fatface_regular",fontFamily:"Abril Fatface",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_abril_fatface_regular.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:1058,descender:-291}},{identifier:"imgly_font_amberlight",fontFamily:"Amberlight",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_amberlight.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:750,descender:-250}},{identifier:"imgly_font_montserrat_light",fontFamily:"Montserrat Light",googleFamily:"Montserrat",fontWeight:300,fontStyle:"normal",fontURI:"./fonts/imgly_font_montserrat_light.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:968,descender:-251}},{identifier:"imgly_font_handycheera_regular",fontFamily:"Handycheera",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_handycheera_regular.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2199,descender:-808}},{identifier:"imgly_font_ostrich_sans_heavy",fontFamily:"Ostrich",fontWeight:900,fontStyle:"normal",fontURI:"./fonts/imgly_font_ostrich_sans_heavy.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:674,descender:0}},{identifier:"imgly_font_petit_formal_script",fontFamily:"Petit Formal Script",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_petit_formal_script.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2033,descender:-527}},{identifier:"imgly_font_rasa_500",fontFamily:"Rasa",fontWeight:500,fontStyle:"normal",fontURI:"./fonts/imgly_font_rasa_500.woff",format:"woff",textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_rasa_regular",fontFamily:"Rasa",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_rasa_regular.woff",format:"woff",textMetrics:{unitsPerEm:2750,ascender:2300,descender:-1050}},{identifier:"imgly_font_roboto_black",fontFamily:"Roboto Black",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_roboto_black.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_roboto_light",fontFamily:"Roboto Light",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_roboto_light.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:1900,descender:-500}},{identifier:"imgly_font_sue_ellen_francisco",fontFamily:"Sue Ellen Francisco",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_sue_ellen_francisco.woff",format:"woff",textMetrics:{unitsPerEm:1024,ascender:1362,descender:-634}},{identifier:"imgly_font_ultra",fontFamily:"Ultra",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_ultra.woff",format:"woff",textMetrics:{unitsPerEm:2048,ascender:2066,descender:-561}},{identifier:"imgly_font_wolesbro",fontFamily:"Wolesbro",fontWeight:"normal",fontStyle:"normal",fontURI:"./fonts/imgly_font_wolesbro.woff",format:"woff",textMetrics:{unitsPerEm:1e3,ascender:925,descender:-575}}];var tl=Rk;var ig=["imgly_font_open_sans_bold","imgly_font_aleo_bold","imgly_font_amaticsc","imgly_font_archivo_black","imgly_font_bungee_inline","imgly_font_campton_bold","imgly_font_carter_one","imgly_font_codystar","imgly_font_fira_sans_regular","imgly_font_galano_grotesque_bold","imgly_font_krona_one","imgly_font_kumar_one_outline","imgly_font_lobster","imgly_font_molle","imgly_font_monoton","imgly_font_nixie_one","imgly_font_notable","imgly_font_ostrich_sans_black","imgly_font_ostrich_sans_bold","imgly_font_oswald_semi_bold","imgly_font_palanquin_dark_semi_bold","imgly_font_poppins","imgly_font_permanent_marker","imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_sancreek","imgly_font_stint_ultra_expanded","imgly_font_trash_hand","imgly_font_vt323","imgly_font_yeseva_one"];var rg=["imgly_font_abril_fatface_regular","imgly_font_amberlight","imgly_font_bungee_inline","imgly_font_campton_bold","imgly_font_galano_grotesque_bold","imgly_font_handycheera_regular","imgly_font_montserrat_light","imgly_font_ostrich_sans_black","imgly_font_ostrich_sans_bold","imgly_font_ostrich_sans_heavy","imgly_font_permanent_marker","imgly_font_petit_formal_script","imgly_font_rasa_500","imgly_font_rasa_regular","imgly_font_roboto_black","imgly_font_roboto_light","imgly_font_roboto_black_italic","imgly_font_roboto_light_italic","imgly_font_sue_ellen_francisco","imgly_font_ultra","imgly_font_wolesbro"];var Ek=[{identifier:"imgly_frame_dia",name:"Dia",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"./items/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"./items/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"./items/imgly_frame_dia/imgly_frame_dia_left.png",end:"./items/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"./items/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"./items/imgly_frame_dia/imgly_frame_dia_right.png",end:"./items/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"./items/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",name:"Art Decor",tintable:true,layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"./items/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"./items/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",name:"Black Passepartout",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"./items/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",name:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"./items/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",name:"Low Poly",layoutMode:"horizontal-inside",thumbnailURI:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"./items/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}}];var il=Ek;var Sk=[{identifier:Ve.Golden,name:"Golden",defaultBlendMode:re.LIGHTEN,overlayURI:"./items/imgly_overlay_golden.jpg",thumbnailURI:"./items/imgly_overlay_golden_thumb.jpg"},{identifier:Ve.LightLeak1,name:"Lightleak",defaultBlendMode:re.SCREEN,overlayURI:"./items/imgly_overlay_lightleak1.jpg",thumbnailURI:"./items/imgly_overlay_lightleak1_thumb.jpg"},{identifier:Ve.Rain,name:"Rain",defaultBlendMode:re.OVERLAY,overlayURI:"./items/imgly_overlay_rain.jpg",thumbnailURI:"./items/imgly_overlay_rain_thumb.jpg"},{identifier:Ve.Mosaic,name:"Mosaic",defaultBlendMode:re.MULTIPLY,overlayURI:"./items/imgly_overlay_mosaic.jpg",thumbnailURI:"./items/imgly_overlay_mosaic_thumb.jpg"},{identifier:Ve.Vintage,name:"Vintage",defaultBlendMode:re.OVERLAY,overlayURI:"./items/imgly_overlay_vintage.jpg",thumbnailURI:"./items/imgly_overlay_vintage_thumb.jpg"},{identifier:Ve.Paper,name:"Paper",defaultBlendMode:re.MULTIPLY,overlayURI:"./items/imgly_overlay_paper.jpg",thumbnailURI:"./items/imgly_overlay_paper_thumb.jpg"},{identifier:Ve.Bokeh,name:"Bokeh",defaultBlendMode:re.LIGHTEN,overlayURI:"./items/imgly_overlay_bokeh.jpg",thumbnailURI:"./items/imgly_overlay_bokeh_thumb.jpg"},{identifier:Ve.Hearts,name:"Hearts",defaultBlendMode:re.SCREEN,overlayURI:"./items/imgly_overlay_hearts.jpg",thumbnailURI:"./items/imgly_overlay_hearts_thumb.jpg"},{identifier:Ve.LightLeak2,name:"Lightleak 2",defaultBlendMode:re.LIGHTEN,overlayURI:"./items/imgly_overlay_lightleak2.jpg",thumbnailURI:"./items/imgly_overlay_lightleak2_thumb.jpg"},{identifier:Ve.Wood,name:"Wood",defaultBlendMode:re.MULTIPLY,overlayURI:"./items/imgly_overlay_wood.jpg",thumbnailURI:"./items/imgly_overlay_wood_thumb.jpg"},{identifier:Ve.Chop,name:"Chop",defaultBlendMode:re.MULTIPLY,overlayURI:"./items/imgly_overlay_chop.jpg",thumbnailURI:"./items/imgly_overlay_chop_thumb.jpg"},{identifier:Ve.Metal,name:"Metal",defaultBlendMode:re.OVERLAY,overlayURI:"./items/imgly_overlay_metal.jpg",thumbnailURI:"./items/imgly_overlay_metal_thumb.jpg"},{identifier:Ve.Painting,name:"Painting",defaultBlendMode:re.OVERLAY,overlayURI:"./items/imgly_overlay_painting.jpg",thumbnailURI:"./items/imgly_overlay_painting_thumb.jpg"},{identifier:Ve.Grain,name:"Grain",defaultBlendMode:re.OVERLAY,overlayURI:"./items/imgly_overlay_grain.jpg",thumbnailURI:"./items/imgly_overlay_grain_thumb.jpg"},{identifier:Ve.Clouds,name:"Clouds",defaultBlendMode:re.SOFT_LIGHT,overlayURI:"./items/imgly_overlay_clouds.jpg",thumbnailURI:"./items/imgly_overlay_clouds_thumb.jpg"},{identifier:Ve.Wall1,name:"Wall",defaultBlendMode:re.LIGHTEN,overlayURI:"./items/imgly_overlay_wall1.jpg",thumbnailURI:"./items/imgly_overlay_wall1_thumb.jpg"},{identifier:Ve.Wall2,name:"Wall 2",defaultBlendMode:re.OVERLAY,overlayURI:"./items/imgly_overlay_wall2.jpg",thumbnailURI:"./items/imgly_overlay_wall2_thumb.jpg"}];var rl=Sk;var Fk=[{identifier:"imgly_sticker_emoticons",name:"Emoticons",thumbnailURI:"./categories/emoticons.png",items:[{identifier:"imgly_sticker_emoticons_grin",stickerURI:"./emoticons/imgly_sticker_emoticons_grin.svg",tintMode:"none",name:"Grin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_laugh",stickerURI:"./emoticons/imgly_sticker_emoticons_laugh.svg",tintMode:"none",name:"Laugh",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_smile",stickerURI:"./emoticons/imgly_sticker_emoticons_smile.svg",tintMode:"none",name:"Smile",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wink",stickerURI:"./emoticons/imgly_sticker_emoticons_wink.svg",tintMode:"none",name:"Wink",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_tongue_out_wink",stickerURI:"./emoticons/imgly_sticker_emoticons_tongue_out_wink.svg",tintMode:"none",name:"Tongue out wink",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_angel",stickerURI:"./emoticons/imgly_sticker_emoticons_angel.svg",tintMode:"none",name:"Angel",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_kisses",stickerURI:"./emoticons/imgly_sticker_emoticons_kisses.svg",tintMode:"none",name:"Kisses",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_loving",stickerURI:"./emoticons/imgly_sticker_emoticons_loving.svg",tintMode:"none",name:"Loving",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_kiss",stickerURI:"./emoticons/imgly_sticker_emoticons_kiss.svg",tintMode:"none",name:"Kiss",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wave",stickerURI:"./emoticons/imgly_sticker_emoticons_wave.svg",tintMode:"none",name:"Wave",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_nerd",stickerURI:"./emoticons/imgly_sticker_emoticons_nerd.svg",tintMode:"none",name:"Nerd",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_cool",stickerURI:"./emoticons/imgly_sticker_emoticons_cool.svg",tintMode:"none",name:"Cool",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_blush",stickerURI:"./emoticons/imgly_sticker_emoticons_blush.svg",tintMode:"none",name:"Blush",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_duckface",stickerURI:"./emoticons/imgly_sticker_emoticons_duckface.svg",tintMode:"none",name:"Duckface",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_furious",stickerURI:"./emoticons/imgly_sticker_emoticons_furious.svg",tintMode:"none",name:"Furious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_angry",stickerURI:"./emoticons/imgly_sticker_emoticons_angry.svg",tintMode:"none",name:"Angry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_steaming_furious",stickerURI:"./emoticons/imgly_sticker_emoticons_steaming_furious.svg",tintMode:"none",name:"Steaming Furious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sad",stickerURI:"./emoticons/imgly_sticker_emoticons_sad.svg",tintMode:"none",name:"Sad",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_anxious",stickerURI:"./emoticons/imgly_sticker_emoticons_anxious.svg",tintMode:"none",name:"Anxious",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_cry",stickerURI:"./emoticons/imgly_sticker_emoticons_cry.svg",tintMode:"none",name:"Cry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sobbing",stickerURI:"./emoticons/imgly_sticker_emoticons_sobbing.svg",tintMode:"none",name:"Sobbing",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_loud_cry",stickerURI:"./emoticons/imgly_sticker_emoticons_loud_cry.svg",tintMode:"none",name:"Loud Cry",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wide_grin",stickerURI:"./emoticons/imgly_sticker_emoticons_wide_grin.svg",tintMode:"none",name:"Wide grin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_impatient",stickerURI:"./emoticons/imgly_sticker_emoticons_impatient.svg",tintMode:"none",name:"Impatient",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_tired",stickerURI:"./emoticons/imgly_sticker_emoticons_tired.svg",tintMode:"none",name:"Tired",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_asleep",stickerURI:"./emoticons/imgly_sticker_emoticons_asleep.svg",tintMode:"none",name:"Asleep",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sleepy",stickerURI:"./emoticons/imgly_sticker_emoticons_sleepy.svg",tintMode:"none",name:"Sleepy",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_deceased",stickerURI:"./emoticons/imgly_sticker_emoticons_deceased.svg",tintMode:"none",name:"Deceased",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_attention",stickerURI:"./emoticons/imgly_sticker_emoticons_attention.svg",tintMode:"none",name:"Attention",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_question",stickerURI:"./emoticons/imgly_sticker_emoticons_question.svg",tintMode:"none",name:"Question",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",stickerURI:"./emoticons/imgly_sticker_emoticons_not_speaking_to_you.svg",tintMode:"none",name:"Not speaking to you",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sick",stickerURI:"./emoticons/imgly_sticker_emoticons_sick.svg",tintMode:"none",name:"Sick",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_pumpkin",stickerURI:"./emoticons/imgly_sticker_emoticons_pumpkin.svg",tintMode:"none",name:"Pumpkin",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_boxer",stickerURI:"./emoticons/imgly_sticker_emoticons_boxer.svg",tintMode:"none",name:"Boxer",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_idea",stickerURI:"./emoticons/imgly_sticker_emoticons_idea.svg",tintMode:"none",name:"Idea",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_smoking",stickerURI:"./emoticons/imgly_sticker_emoticons_smoking.svg",tintMode:"none",name:"Smoking",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_beer",stickerURI:"./emoticons/imgly_sticker_emoticons_beer.svg",tintMode:"none",name:"Beer",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_skateboard",stickerURI:"./emoticons/imgly_sticker_emoticons_skateboard.svg",tintMode:"none",name:"Skateboard",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_guitar",stickerURI:"./emoticons/imgly_sticker_emoticons_guitar.svg",tintMode:"none",name:"Guitar",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_music",stickerURI:"./emoticons/imgly_sticker_emoticons_music.svg",tintMode:"none",name:"Music",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_sunbathing",stickerURI:"./emoticons/imgly_sticker_emoticons_sunbathing.svg",tintMode:"none",name:"Sunbathing",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_hippie",stickerURI:"./emoticons/imgly_sticker_emoticons_hippie.svg",tintMode:"none",name:"Hippie",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_humourous",stickerURI:"./emoticons/imgly_sticker_emoticons_humourous.svg",tintMode:"none",name:"Humourous",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_hitman",stickerURI:"./emoticons/imgly_sticker_emoticons_hitman.svg",tintMode:"none",name:"Hitman",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_harry_potter",stickerURI:"./emoticons/imgly_sticker_emoticons_harry_potter.svg",tintMode:"none",name:"Harry Potter",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_business",stickerURI:"./emoticons/imgly_sticker_emoticons_business.svg",tintMode:"none",name:"Business",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_batman",stickerURI:"./emoticons/imgly_sticker_emoticons_batman.svg",tintMode:"none",name:"Batman",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_skull",stickerURI:"./emoticons/imgly_sticker_emoticons_skull.svg",tintMode:"none",name:"Skull",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_ninja",stickerURI:"./emoticons/imgly_sticker_emoticons_ninja.svg",tintMode:"none",name:"Ninja",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_masked",stickerURI:"./emoticons/imgly_sticker_emoticons_masked.svg",tintMode:"none",name:"Masked",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_alien",stickerURI:"./emoticons/imgly_sticker_emoticons_alien.svg",tintMode:"none",name:"Alien",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_wrestler",stickerURI:"./emoticons/imgly_sticker_emoticons_wrestler.svg",tintMode:"none",name:"Wrestler",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_devil",stickerURI:"./emoticons/imgly_sticker_emoticons_devil.svg",tintMode:"none",name:"Devil",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_star",stickerURI:"./emoticons/imgly_sticker_emoticons_star.svg",tintMode:"none",name:"Star",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_baby_chicken",stickerURI:"./emoticons/imgly_sticker_emoticons_baby_chicken.svg",tintMode:"none",name:"Baby Chicken",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_rabbit",stickerURI:"./emoticons/imgly_sticker_emoticons_rabbit.svg",tintMode:"none",name:"Rabbit",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_pig",stickerURI:"./emoticons/imgly_sticker_emoticons_pig.svg",tintMode:"none",name:"Pig",resizeMode:"keepAspect"},{identifier:"imgly_sticker_emoticons_chicken",stickerURI:"./emoticons/imgly_sticker_emoticons_chicken.svg",tintMode:"none",name:"Chicken",resizeMode:"keepAspect"}]},{identifier:"imgly_sticker_shapes",name:"Shapes",thumbnailURI:"./categories/shapes.png",items:[{identifier:"imgly_sticker_shapes_badge_01",stickerURI:"./shapes/imgly_sticker_shapes_badge_01.svg",tintMode:"solid",name:"Shape Badge 01",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_04",stickerURI:"./shapes/imgly_sticker_shapes_badge_04.svg",tintMode:"solid",name:"Shape Badge 04",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_12",stickerURI:"./shapes/imgly_sticker_shapes_badge_12.svg",tintMode:"solid",name:"Shape Badge 12",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_06",stickerURI:"./shapes/imgly_sticker_shapes_badge_06.svg",tintMode:"solid",name:"Shape Badge 06",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_13",stickerURI:"./shapes/imgly_sticker_shapes_badge_13.svg",tintMode:"solid",name:"Shape Badge 13",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_36",stickerURI:"./shapes/imgly_sticker_shapes_badge_36.svg",tintMode:"solid",name:"Shape Badge 36",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_08",stickerURI:"./shapes/imgly_sticker_shapes_badge_08.svg",tintMode:"solid",name:"Shape Badge 08",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_11",stickerURI:"./shapes/imgly_sticker_shapes_badge_11.svg",tintMode:"solid",name:"Shape Badge 11",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_35",stickerURI:"./shapes/imgly_sticker_shapes_badge_35.svg",tintMode:"solid",name:"Shape Badge 35",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_28",stickerURI:"./shapes/imgly_sticker_shapes_badge_28.svg",tintMode:"solid",name:"Shape Badge 28",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_32",stickerURI:"./shapes/imgly_sticker_shapes_badge_32.svg",tintMode:"solid",name:"Shape Badge 32",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_15",stickerURI:"./shapes/imgly_sticker_shapes_badge_15.svg",tintMode:"solid",name:"Shape Badge 15",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_20",stickerURI:"./shapes/imgly_sticker_shapes_badge_20.svg",tintMode:"solid",name:"Shape Badge 20",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_18",stickerURI:"./shapes/imgly_sticker_shapes_badge_18.svg",tintMode:"solid",name:"Shape Badge 18",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_badge_19",stickerURI:"./shapes/imgly_sticker_shapes_badge_19.svg",tintMode:"solid",name:"Shape Badge 19",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_arrow_02",stickerURI:"./shapes/imgly_sticker_shapes_arrow_02.svg",tintMode:"solid",name:"Shape Arrow 02",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_arrow_03",stickerURI:"./shapes/imgly_sticker_shapes_arrow_03.svg",tintMode:"solid",name:"Shape Arrow 03",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_01",stickerURI:"./shapes/imgly_sticker_shapes_spray_01.svg",tintMode:"solid",name:"Shape Spray 01",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_04",stickerURI:"./shapes/imgly_sticker_shapes_spray_04.svg",tintMode:"solid",name:"Shape Spray 04",resizeMode:"keepAspect"},{identifier:"imgly_sticker_shapes_spray_03",stickerURI:"./shapes/imgly_sticker_shapes_spray_03.svg",tintMode:"solid",name:"Shape Spray 03",resizeMode:"keepAspect"}]}];var sl=Fk;var Ok=[{thumbnailURI:"./items/dark/imgly_text_design_icon_thislayoutisgreat.png",identifier:"imgly_text_design_blocks",name:"Blocks"},{thumbnailURI:"./items/dark/imgly_text_design_icon_fatandfast.png",identifier:"imgly_text_design_rotated",name:"Rotated"},{thumbnailURI:"./items/dark/imgly_text_design_icon_summerfeeling.png",identifier:"imgly_text_design_blocks_light",name:"Blocks Light"},{thumbnailURI:"./items/dark/imgly_text_design_icon_typewithstyle.png",identifier:"imgly_text_design_equal_width",name:"Equal Width"},{thumbnailURI:"./items/dark/imgly_text_design_icon_inthebox.png",identifier:"imgly_text_design_masked",name:"Masked"},{thumbnailURI:"./items/dark/imgly_text_design_icon_bluefriday.png",identifier:"imgly_text_design_celebrate",name:"Celebrate"},{thumbnailURI:"./items/dark/imgly_text_design_icon_decorative.png",identifier:"imgly_text_design_sunshine",name:"Sunshine"},{thumbnailURI:"./items/dark/imgly_text_design_icon_specialdeals.png",identifier:"imgly_text_design_masked_badge",name:"Masked Badge"},{thumbnailURI:"./items/dark/imgly_text_design_icon_doublelines.png",identifier:"imgly_text_design_blocks_condensed",name:"Blocks Condensed"},{thumbnailURI:"./items/dark/imgly_text_design_icon_celebrate.png",identifier:"imgly_text_design_celebrate_simple",name:"Celebrate Simple"},{thumbnailURI:"./items/dark/imgly_text_design_icon_beerandburger.png",identifier:"imgly_text_design_equal_width_fat",name:"Equal Width Fat"},{thumbnailURI:"./items/dark/imgly_text_design_icon_watercolor.png",identifier:"imgly_text_design_watercolor",name:"Watercolor"},{thumbnailURI:"./items/dark/imgly_text_design_icon_particle.png",identifier:"imgly_text_design_particles",name:"Particles"},{thumbnailURI:"./items/dark/imgly_text_design_icon_yeah.png",identifier:"imgly_text_design_masked_speech_bubble",name:"Masked Speech Bubble"},{thumbnailURI:"./items/dark/imgly_text_design_icon_thisisadream.png",identifier:"imgly_text_design_masked_speech_bubble_comic",name:"Masked Speech Bubble Comic"},{thumbnailURI:"./items/dark/imgly_text_design_icon_fatface.png",identifier:"imgly_text_design_multiline",name:"Multiline"}];var sg=Ok;var Ak=[{thumbnailURI:"./items/light/imgly_text_design_icon_thislayoutisgreat.png",identifier:"imgly_text_design_blocks",name:"Blocks"},{thumbnailURI:"./items/light/imgly_text_design_icon_fatandfast.png",identifier:"imgly_text_design_rotated",name:"Rotated"},{thumbnailURI:"./items/light/imgly_text_design_icon_summerfeeling.png",identifier:"imgly_text_design_blocks_light",name:"Blocks Light"},{thumbnailURI:"./items/light/imgly_text_design_icon_typewithstyle.png",identifier:"imgly_text_design_equal_width",name:"Equal Width"},{thumbnailURI:"./items/light/imgly_text_design_icon_inthebox.png",identifier:"imgly_text_design_masked",name:"Masked"},{thumbnailURI:"./items/light/imgly_text_design_icon_bluefriday.png",identifier:"imgly_text_design_celebrate",name:"Celebrate"},{thumbnailURI:"./items/light/imgly_text_design_icon_decorative.png",identifier:"imgly_text_design_sunshine",name:"Sunshine"},{thumbnailURI:"./items/light/imgly_text_design_icon_specialdeals.png",identifier:"imgly_text_design_masked_badge",name:"Masked Badge"},{thumbnailURI:"./items/light/imgly_text_design_icon_doublelines.png",identifier:"imgly_text_design_blocks_condensed",name:"Blocks Condensed"},{thumbnailURI:"./items/light/imgly_text_design_icon_celebrate.png",identifier:"imgly_text_design_celebrate_simple",name:"Celebrate Simple"},{thumbnailURI:"./items/light/imgly_text_design_icon_beerandburger.png",identifier:"imgly_text_design_equal_width_fat",name:"Equal Width Fat"},{thumbnailURI:"./items/light/imgly_text_design_icon_watercolor.png",identifier:"imgly_text_design_watercolor",name:"Watercolor"},{thumbnailURI:"./items/light/imgly_text_design_icon_particle.png",identifier:"imgly_text_design_particles",name:"Particles"},{thumbnailURI:"./items/light/imgly_text_design_icon_yeah.png",identifier:"imgly_text_design_masked_speech_bubble",name:"Masked Speech Bubble"},{thumbnailURI:"./items/light/imgly_text_design_icon_thisisadream.png",identifier:"imgly_text_design_masked_speech_bubble_comic",name:"Masked Speech Bubble Comic"},{thumbnailURI:"./items/light/imgly_text_design_icon_fatface.png",identifier:"imgly_text_design_multiline",name:"Multiline"}];var og=Ak;var Ik=[{identifier:"imgly_transforms_common",name:"Common",items:[{identifier:"imgly_transform_common_custom",name:"Custom",thumbnailURI:"",ratio:"*"},{identifier:"imgly_transform_common_square",name:"Square",thumbnailURI:"",ratio:1},{identifier:"imgly_transform_common_4",name:"4:3",thumbnailURI:"",ratio:4/3},{identifier:"imgly_transform_common_16",name:"16:9",thumbnailURI:"",ratio:16/9},{identifier:"imgly_transform_common_3",name:"3:4",thumbnailURI:"",ratio:3/4},{identifier:"imgly_transform_common_9",name:"9:16",thumbnailURI:"",ratio:9/16}]},{identifier:"imgly_transforms_facebook",name:"Facebook",items:[{identifier:"imgly_transform_facebook_profile",name:"Profile",thumbnailURI:"",dimensions:{x:300,y:300},forceDimensions:true,lockDimensions:true},{identifier:"imgly_transform_facebook_title",name:"Title",thumbnailURI:"",dimensions:{x:1200,y:627},forceDimensions:true,lockDimensions:true},{identifier:"imgly_transform_facebook_post",name:"Post",thumbnailURI:"",dimensions:{x:940,y:788},forceDimensions:true,lockDimensions:true}]},{identifier:"imgly_transforms_instagram",name:"Instagram",items:[{identifier:"imgly_transform_instagram_landscape",name:"Landscape",thumbnailURI:"",dimensions:{x:1080,y:566},forceDimensions:true,lockDimensions:true},{identifier:"imgly_transform_instagram_portrait",name:"Portrait",thumbnailURI:"",dimensions:{x:1080,y:1350},forceDimensions:true,lockDimensions:true},{identifier:"imgly_transform_instagram_square",name:"Square",thumbnailURI:"",dimensions:{x:1080,y:1080},forceDimensions:true,lockDimensions:true},{identifier:"imgly_transform_instagram_story",name:"Story",thumbnailURI:"",dimensions:{x:1080,y:1920},forceDimensions:true,lockDimensions:true}]},{identifier:"imgly_transforms_twitter",name:"Twitter",items:[{identifier:"imgly_transform_twitter_post",name:"Post",thumbnailURI:"",dimensions:{x:1024,y:512},forceDimensions:true,lockDimensions:true},{identifier:"imgly_transform_twitter_profile",name:"Profile",thumbnailURI:"",dimensions:{x:400,y:400},forceDimensions:true,lockDimensions:true},{identifier:"imgly_transform_twitter_title",name:"Title",thumbnailURI:"",dimensions:{x:1500,y:500},forceDimensions:true,lockDimensions:true}]}];var ol=Ik;var _g=Ur(nl());var Nk={italic:"i"};var An=class{constructor(e){this.assetManager=e;this.injectedFonts={};this.loadedFonts={};this.isFontLoaded=e=>{return this.loadedFonts[e]!==void 0};this.getGoogleFamiliesString=e=>{const t=e.reduce((i,r)=>{const{fontFamily:o,fontStyle:n,fontWeight:a=400}=r;i[o]=(i[o]||[]).concat(`${a}${Nk[n]||""}`);return i},{});return Object.keys(t).map(i=>{const r=t[i].length?`:${t[i].join(",")}`:"";const o=i.replace(" ","+")+r;return o}).join("|")}}static createFontFacesCSS(e,t){return e.map(i=>{const r=t(i.fontURI);return`@font-face {
        font-family: "${i.fontFamily}";
        src: url('${r}') format('${i.format||"woff"}');
        font-weight: ${i.fontWeight||"normal"};
        font-style: ${i.fontStyle||"normal"};
      }`})}getFontWithId(e){const t=this.assetManager.getFontAsset(e);if(!t){throw new Error("The requested font does not exist as an asset.")}return t}injectAllFonts(){const e=this.assetManager.getFontAssets();this.injectFonts(e)}async loadAllFonts(){const e=this.assetManager.getFontAssets();return this.loadFonts(e)}async loadFontsWithIdentifiers(e){const t=e.map(i=>this.getFontWithId(i));return this.loadFonts(t)}async loadFonts(e){this.injectFonts(e);return(0,_g.default)(e,t=>this.loadFont(t,false),{stopOnError:false}).then(()=>void 0)}async loadFont(e,t=true){return new Promise((i,r)=>{if(this.isFontLoaded(e.identifier)){i()}if(t){this.injectFonts([e])}const o=new pr(e);o.load().then(()=>{this.loadedFonts[e.identifier]=e;i()}).catch(n=>{r(e.identifier)})})}async loadFontWithIdentifier(e,t=true){const i=this.assetManager.getFontAsset(e);if(!i){throw new Error(`The requested font asset with identifier ${e} does not exist!`)}return this.loadFont(i,t)}injectFonts(e,t=this.assetManager.getPathForCategory("font")){const i=e.filter(jf);const r=e.filter(Vf);if(i.length>0){this.addGoogleFontLinks(i)}if(r.length>0){this.addWebFontCSS(r,t)}}addGoogleFontLinks(e){const t=e.filter(n=>!this.injectedFonts[n.identifier]);if(t.length===0){return}const i=this.getGoogleFamiliesString(t);const r=document.createElement("link");r.rel="stylesheet";r.href=`https://fonts.googleapis.com/css?family=${i}`;const o=document.getElementsByTagName("head")[0];o.appendChild(r);e.forEach(n=>{this.injectedFonts[n.identifier]=n})}addWebFontCSS(e,t){const i=e.filter(a=>!this.injectedFonts[a.identifier]);if(i.length===0){return}const r=An.createFontFacesCSS(i,t);const o=`
      /* Injected by PhotoEditorSDK */
      ${r.join("\n")}
    `;const n=document.createElement("style");n.innerHTML=o;document.head.appendChild(n);e.forEach(a=>{this.injectedFonts[a.identifier]=a})}};var dm=class{constructor(e,t=false,i){this.assetResolver=i;this.basePath="assets/";this.areCustomAssetsAllowed=false;this.getAssets=e=>{switch(e){case"overlay":return this.overlayAssets;case"filter":return this.filterCategories;case"font":return this.fontAssets;case"focus":return this.focusAssets;case"adjustment":return this.adjustmentCategories;case"sticker":return this.stickerCategories;case"textdesign":return this.textDesignAssets;case"frame":return this.frameAssets;case"transform":return this.transformCategories;default:return[]}return[]};this.getPath=(e,t)=>{const{assetResolver:i={}}=this;const r=t&&i.item?i.item(t,e):t;if(r==null?void 0:r.match(/data:image/g)){return r}if((r==null?void 0:r.match(/(ftp|http|https):\/\//))&&On(r)){return r}if(!r&&On(e)){return e}const o=r?Sn(e,r):Sn(e);let n;if(this.basePath.match(/(ftp|http|https):\/\//)){const{length:a}=this.basePath;if(this.basePath[a-1]!=="/"){this.basePath=`${this.basePath}/`}n=this.basePath+o}else{n=Sn(this.basePath,o)}return i.path?i.path(n,e,r):n};this.getPathForCategory=e=>{return(...t)=>this.getPath(e,...t)};this.addCustomStickerAsset=(e,t,i)=>{e.forEach(r=>{const{thumbnailURI:o,name:n,stickerURI:a,identifier:l,tintMode:u,resizeMode:c}=r;const h=this.stickerCategories.find(d=>d.identifier===t);const m={identifier:l,name:n,thumbnailURI:o,stickerURI:a,tintMode:u,resizeMode:c};if(h){h.items.push(m);h.thumbnailURI=o}else{const d={identifier:t,name:i,thumbnailURI:o,items:[m]};this.stickerCategories=[d,...this.stickerCategories]}});this.stickerAssets=this.stickerCategories.reduce(this.allOptions,[])};this.getItemPath=(e,t,i)=>{const r=e.find(o=>o.identifier===t);return r?r[i]||r.path||"":""};this.isNonExistingFont=e=>!tl.find(t=>t.identifier===e.identifier)&&!Bi[e.identifier];this.replaceDeprecatedFont=e=>{if(Bi[e.identifier]){return tl.find(t=>t.identifier===fo(e.identifier,true))}return e};var h,m;if(e==null?void 0:e.basePath)this.basePath=e.basePath;this.areCustomAssetsAllowed=t;const r=el.reduce(this.allOptions,[]);if(e&&e.filter){this.filterCategories=this.configuredCategory(el,e.filter,r)}else{this.filterCategories=el}this.lutFilterAssets=this.filterCategories.reduce(this.allOptions,[]).filter(d=>Wf(d));this.duoToneFilterAssets=this.filterCategories.reduce(this.allOptions,[]).filter(d=>Gf(d));const o=Qa.reduce(this.allOptions,[]);if(e&&e.adjustment){this.adjustmentCategories=this.configuredCategory(Qa,e.adjustment,o)}else{this.adjustmentCategories=Qa}this.fontAssets=tl.reduce(this.allOptions,[]);let n=ig.map(d=>this.getFontAsset(d));if(((m=(h=e==null?void 0:e.text)==null?void 0:h.fonts)==null?void 0:m.length)>0){n=e.text.fonts.map(f=>{if(this.isNonExistingFont(f))return f;const b=this.replaceDeprecatedFont(f);return this.getFontAsset(b.identifier)});const d=e.text.fonts.filter(this.isNonExistingFont);this.fontAssets=e.text.fonts?[...this.fontAssets,...d]:this.fontAssets}this.textToolFontAssets=n;const a=e&&e.focus&&e.focus.items&&e.focus.items.length?e.focus.items.map(d=>mm.find(f=>f.identifier===d.identifier)):mm;this.focusAssets=a;if(e&&e.overlay&&e.overlay.items){this.overlayAssets=this.configuredItem(e.overlay.items,rl,rl)}else{this.overlayAssets=rl}if(e&&e.frame&&e.frame.items){this.frameAssets=this.configuredItem(e.frame.items,il,il)}else{this.frameAssets=il}const l=sl.reduce(this.allOptions,[]);if(e&&e.sticker){this.stickerCategories=this.configuredCategory(sl,e.sticker,l)}else{this.stickerCategories=sl}this.stickerAssets=this.stickerCategories.reduce(this.allOptions,[]);let u=sg;if(e&&e.theme==="light"){u=og}this.textDesignAssets=e&&e.textdesign&&e.textdesign.items&&e.textdesign.items.length?e.textdesign.items.map(d=>u.find(f=>f.identifier===d.identifier)):u;this.textDesignToolFontAssets=rg.map(d=>this.getFontAsset(d));const c=ol.reduce(this.allOptions,[]);if(e&&e.transform){this.transformCategories=this.configuredCategory(ol,e.transform,c,Ne.TRANSFORM)}else{this.transformCategories=ol}this.transformAssets=this.transformCategories.reduce(this.allOptions,[]);this.fontManager=new An(this)}getFontManager(){return this.fontManager}getAssetSource(e,t){switch(e){case"filter":const i=this.getLUTFilterAsset(t);if(i){return this.getPath(e,this.getItemPath(this.lutFilterAssets,t,"lutURI"))}break;case"overlay":return this.getPath(e,this.getItemPath(this.overlayAssets,t,"overlayURI"));case"font":return this.getPath(e,this.getItemPath(this.fontAssets,t,"fontURI"));case"sticker":const r=this.stickerAssets.find(o=>o.identifier===t);if(r){if(r.stickerURI.substr(0,10)==="data:image"){return r.stickerURI}if(t.includes("imgly_sticker")&&r.stickerURI.includes(".svg")&&Ya()){const o=this.getPath(e,this.getItemPath(this.stickerAssets,t,"stickerURI"));const n=o.split("/");n.splice(n.length-1,0,"base");n[n.length-1]=n[n.length-1].replace(".svg",".png");return n.join("/")}return this.getPath(e,this.getItemPath(this.stickerAssets,t,"stickerURI"))}throw new Error("Cannot resolve this type of sticker asset yet");case"textdesign":return this.getPath(Sn(e,"engine"),t);case"frame":return this.getPath(e,t);default:break}throw new Error("Cannot resolve this type of asset yet")}getDuotoneFilterAsset(e){return this.duoToneFilterAssets.filter(t=>t.identifier===e)[0]}getLUTFilterAsset(e){return this.lutFilterAssets.filter(t=>t.identifier===e)[0]}getOverlayAsset(e){return this.overlayAssets.filter(t=>t.identifier===e)[0]}getStickerAsset(e){return this.stickerAssets.filter(t=>t.identifier===e)[0]}getFontAsset(e){return this.fontAssets.filter(t=>t.identifier===e)[0]}getTextDesignAssets(e){return this.textDesignAssets.filter(t=>t.identifier===e)[0]}getFrameAsset(e){return this.frameAssets.filter(t=>t.identifier===e)[0]}getFontAssets(){return this.fontAssets}getFontAssetsForText(){return this.textToolFontAssets}getFontAssetsForTextDesign(){return this.textDesignToolFontAssets}getFrameAssets(){return this.frameAssets}allOptions(e,t){if(Object.prototype.hasOwnProperty.call(t,"items")){return[...e,...t.items]}return[...e,t]}configuredCategory(e,t,i,r){if(t.categories&&t.categories.length){return t.categories.reduce((o,n)=>{const a=e.find(l=>l.identifier===n.identifier);if(a){o.push({...a,...n,items:this.configuredItem(n.items,i,a.items,r).filter(Boolean)})}else if(this.areCustomAssetsAllowed||r===Ne.TRANSFORM){o.push({...n,items:this.configuredItem(n.items,i,n.items,r).filter(Boolean)})}return o},[])}return e}configuredItem(e,t,i,r){if(e&&e.length){return e.reduce((o,n)=>{const a=t.find(l=>l.identifier===n.identifier);if(a){o.push({...a,...n})}else if(this.areCustomAssetsAllowed||r===Ne.TRANSFORM){o.push(n)}return o},[]).filter(Boolean)}return i}};var pm=class{static contains(e,t){return t.x>=e.minX&&t.x<=e.maxX&&t.y>=e.minY&&t.y<=e.maxY}constructor(e,t,i,r){if(typeof e==="number"){if(typeof t==="number"&&i!==void 0&&r!==void 0){this.origin={x:e,y:t};this.size={width:i||0,height:r||0}}else{throw new Error("Invalid arguments passed to Rect. Expected (number, number, number, number)")}}else{this.origin=e;if(typeof t==="number"){throw new Error("Invalid arguments passed to Rect. Expected (Float2, Size)")}this.size=t}}get minX(){return this.origin.x}get minY(){return this.origin.y}get midX(){return this.origin.x+.5*this.size.width}get midY(){return this.origin.y+.5*this.size.height}get maxX(){return this.origin.x+this.size.width}get maxY(){return this.origin.y+this.size.height}get width(){return this.size.width}get height(){return this.size.height}};var Ge=pm;Ge.ZERO=new pm({x:0,y:0},{width:0,height:0});var Li=class{constructor(e,t,i,r,o,n){this.a=e;this.b=t;this.c=i;this.d=r;this.tx=o;this.ty=n}static fromScale(e,t){return new Li(e,0,0,t,0,0)}static fromRotation(e){const t=Math.cos(e);const i=Math.sin(e);return new Li(t,-i,i,t,0,0)}static fromRotationDeg(e){const t=Math.PI*e/180;return this.fromRotation(t)}static fromTranslation(e,t){return new Li(1,0,0,1,e,t)}static fromTRS(e,t,i,r,o){const n=Math.cos(i);const a=Math.sin(i);return new Li(r*n,-o*a,r*a,o*n,e,t)}static multiply(e,t){const i=e.a*t.a+e.b*t.c;const r=e.a*t.b+e.b*t.d;const o=e.c*t.a+e.d*t.c;const n=e.c*t.b+e.d*t.d;const a=e.a*t.tx+e.b*t.ty+e.tx;const l=e.c*t.tx+e.d*t.ty+e.ty;return new Li(i,r,o,n,a,l)}static transformPoint(e,t){return{x:e.a*t.x+e.b*t.y+e.tx,y:e.c*t.x+e.d*t.y+e.ty}}static getInverted(e){const t=e.a*e.d-e.b*e.c;if(t===0){return e}const i=1/t;const r=i*e.d;const o=-i*e.b;const n=-i*e.c;const a=i*e.a;const l=i*(e.b*e.ty-e.d*e.tx);const u=i*(e.c*e.tx-e.a*e.ty);return new Li(r,o,n,a,l,u)}};var ee=Li;ee.IDENTITY=Li.fromScale(1,1);function yg(s){return typeof s==="number"}var hm=s=>s<0;var fm=s=>hm(s)?-s:s;var al=s=>s*(Math.PI/180);var Gk=s=>s*(180/Math.PI);var Lt;(function(r){r[r["Top"]=0]="Top";r[r["Right"]=90]="Right";r[r["Bottom"]=180]="Bottom";r[r["Left"]=270]="Left"})(Lt||(Lt={}));var ll={[0]:al(0),[90]:al(90),[180]:al(180),[270]:al(270)};var bg=Object.values(ll);var gm=s=>{let e=Math.round(Gk(fm(s)));if(hm(s)){if(e===270){e=90}else if(e===90){e=270}}return ll[e%360]};var TB=s=>s===0?s:360-fm(s);var RB=s=>eg(bg,gm(s));var EB=s=>tg(bg,gm(s));var SB=s=>{const e=gm(s);return e===ll[270]||e===ll[90]};var We=class{static get IDENTITY(){return new We({x:0,y:0})}constructor(e,t={x:1,y:1},i=0){this.position=e;this.scale=t;this.rotation=i}};ei();var V={};Me(V,{absoluteToRelativePoint:()=>Yk,absoluteToRelativeSize:()=>Kk,getBaseLocalToWorldMatrix:()=>ul,getLocalToParentMatrix:()=>vg,getLocalToWorldMatrix:()=>go,getPointInWorldSpace:()=>bm,getRotationBetweenCoordinateSpaces:()=>Jk,getScalarInWorldSpace:()=>jk,getSizeInOutputSpace:()=>Hk,getSizeInWorldSpace:()=>wg,pointFromSpaceToSpace:()=>In,rectTransformToAffineTransform:()=>_m,relativeToAbsolutePoint:()=>Xk,relativeToAbsoluteSize:()=>qk,scalarFromSpaceToSpace:()=>ym,sizeFromSpaceToSpace:()=>Vk});function xg(s){return s.x!==void 0}function _m(s){return ee.fromTRS(s.position.x,s.position.y,s.rotation,s.scale.x,s.scale.y)}function Wk(s){if(s.getBaseLocalToParentMatrix){return s.getBaseLocalToParentMatrix()}return _m(s.getTransform())}function ul(s){const e=s.getParent();const t=Wk(s);if(e===void 0){return t}const i=ul(e);return ee.multiply(i,t)}function vg(s){if(s.getLocalToParentMatrix){return s.getLocalToParentMatrix()}return _m(s.getTransform())}function go(s){const e=s.getParent();const t=vg(s);if(e===void 0){return t}const i=go(e);return ee.multiply(i,t)}function In(s,e,t,i=false){const r=e.type==="output"&&i?ul(e):go(e);const o=t.type==="output"&&i?ul(t):go(t);const n=ee.getInverted(o);return ee.transformPoint(n,ee.transformPoint(r,s))}function ym(s,e,t){const i=new ne(s,0);const r=new ne(In(i,e,t));const o=new ne(In(ne.ZERO,e,t));return ne.distance(o,r)}function Vk(s,e,t){const i=xg(s)?s.x:s.width;const r=xg(s)?s.y:s.height;const o=ym(i,e,t);const n=ym(r,e,t);return{width:o,height:n}}function bm(s,e){const t=go(e);return ee.transformPoint(t,s)}function jk(s,e){const t=new ne(s,0);const i=new ne(bm(t,e));const r=new ne(bm(ne.ZERO,e));return ne.distance(i,r)}function wg(s){const e=go(s);const t=s.getBounds();const i={x:t.width,y:0};const r={x:0,y:t.height};const o=new ne(ee.transformPoint(e,ne.ZERO));const n=new ne(ee.transformPoint(e,i));const a=new ne(ee.transformPoint(e,r));const l=ne.distance(o,n);const u=ne.distance(o,a);return{width:l,height:u}}function Hk(s,e){const t=wg(s);const i=e.getTransform().scale;const r={x:1/i.x,y:1/i.y};const o={width:t.width*r.x,height:t.height*r.y};return o}function qk(s,e){const t=e.getBounds();return{width:s.width*t.width,height:s.height*t.height}}function Kk(s,e){const t=e.getBounds();return{width:s.width/t.width,height:s.height/t.height}}function Xk(s,e,t=true){const i=e.getBounds();return{x:s.x*i.width+(t?0:i.minX),y:s.y*i.height+(t?0:i.minY)}}function Yk(s,e,t=true){const i=e.getBounds();return{x:(s.x-(t?0:i.minX))/i.width,y:(s.y-(t?0:i.minY))/i.height}}function Jk(s,e){const t={x:1,y:0};const i=In(t,s,e,true);const r=In(ne.ZERO,s,e,true);return Math.atan2(i.y-r.y,i.x-r.x)}function Cg(s){return typeof s!=="string"&&!Array.isArray(s)&&s.a===void 0}function Dg(s){return typeof s!=="string"&&Array.isArray(s)&&s.length===3}function kg(s){return typeof s!=="string"&&!Array.isArray(s)&&s.a!==void 0}function Tg(s){return typeof s!=="string"&&Array.isArray(s)&&s.length===4}function Rg(s){return typeof s==="string"}var Pn;(function(i){i["BEGAN_IMAGE_DOWNSCALING"]="beganImageDownscaling";i["IMAGE_DOWNSCALED"]="imageDownscaled";i["WEBGL_CONTEXT_LOST"]="context-lost"})(Pn||(Pn={}));var xm=class{constructor(e,t){this.engine=t;this.transform=We.IDENTITY;this.canvasPivot={x:0,y:0};this.previewQuality=1;this.canvas=e}get quality(){return this.previewQuality}setQuality(e){this.previewQuality=Math.min(Math.max(e,.01),1)}getTransform(){return this.transform}setTransform(e){this.transform=e}getPosition(){return this.transform.position}setPosition(e,t){let i;if(typeof e==="number"){i={x:e,y:t===void 0?e:t}}else{i=e}const{scale:r}=this.transform;const{rotation:o}=this.transform;this.setTransform(new We(i,r,o))}getScale(){return this.transform.scale}setScale(e,t){let i;if(typeof e!=="number"){i=e}else{i={x:e,y:t===void 0?e:t}}const{position:r}=this.transform;const{rotation:o}=this.transform;this.setTransform(new We(r,i,o))}getRotation(){return this.transform.rotation}setRotation(e){const{position:t}=this.transform;const{scale:i}=this.transform;this.setTransform(new We(t,i,e))}getCanvasPivot(){return this.canvasPivot}setCanvasPivot(e,t){if(typeof e==="number"){this.canvasPivot={x:e,y:typeof t===void 0?e:t}}else{this.canvasPivot=e}}getCanvasBounds(){const e=this.canvasPivot;const{width:t,height:i}=this.canvas;return new Ge(-e.x*t,-e.y*i,t,i)}};function cl(s){return s.getTransform!==void 0}function Eg(s){return s.getContainer!==void 0}var vm=s=>{return 2*Math.PI-s};var $k=s=>{return-s};var WM=({rotation:s,outputRotation:e=0,flipHorizontally:t,flipVertically:i})=>{let r=s;if(t){r=vm(r)}if(i){r=$k(r)}return r+e};xe();Co();ih();Mr();ln();xe();var Ss=class{static downloadDataURL(e,t="photoeditorsdk-export"){const i=this.createBlobURLFromDataURL(e);const r=this.getExtensionFromDataURL(e);const o=document.createElement("a");o.download=`${t}.${r}`;o.href=i;document.body.appendChild(o);o.click();document.body.removeChild(o)}static downloadMSBlob(e,t="photoeditorsdk-export"){if(navigator.msSaveBlob){navigator.msSaveBlob(e,`${t}.png`)}}static getExtensionFromDataURL(e){const t=e.split(",")[0].split(":")[1].split(";")[0];return t.split("/").pop()}static createBlobURLFromDataURL(e){if(!window.Blob||!window.URL||!ArrayBuffer||!Uint8Array){return e}const t=eh.decode(e.split(",")[1]);const i=e.split(",")[0].split(":")[1].split(";")[0];const r=new ArrayBuffer(t.length);const o=new Uint8Array(r);for(let a=0;a<t.length;a++){o[a]=t[a]}const n=new window.Blob([r],{type:i});return window.URL.createObjectURL(n)}};xe();var ec=class{constructor(e,t,i){this._sdk=e;this._options=t;this._download=i}export(){const e=this._getRenderType();return this._sdk.export(e,this._options.format,this._options.quality).then(t=>{if(this._download){this._downloadData(e,t)}return t})}_downloadData(e,t){switch(e){case Br.DATAURL:Ss.downloadDataURL(t,this._options.fileBasename);break;case Br.MSBLOB:Ss.downloadMSBlob(t,this._options.fileBasename);break}}_getRenderType(){const e=this._options;if(e.type!==Br.IMAGE||!this._download){return e.type}if(yt.supportsMSBlob()){return Br.MSBLOB}return Br.DATAURL}};Mr();ei();xe();xe();var tc=class{constructor(e,t,i){this._editor=e;this._sdk=t;this._mediator=i;this._available=this._sdk.getOperations();this._map={};this._stack=this._sdk.getOperationsStack();this._preferredOrder=this._editor.getOptions().editor.operationsOrder;this._fixStack()}exists(e){return!!this._map[e]}add(e){const{identifier:t}=e.constructor;e.on("update",()=>{this._mediator.emit(Te.EVENTS.OPERATION_UPDATED,e)});const i=this._preferredOrder.indexOf(t);if(i===-1){throw new Error(`EditorOperations#add: \`${t}\` does not appear in \`operationsOrder\``)}this._stack.set(i,e);this._map[t]=e;this._mediator.emit(Te.EVENTS.OPERATION_CREATED,e)}remove(e,t=true){const i=typeof e==="object"?e.constructor.identifier:e;const r=this._stack.getStack();e=this.get(i);delete this._map[i];const o=r.map(n=>n.constructor.identifier).indexOf(i);if(o!==-1){this._stack.removeAt(o);for(let n=o+1;n<r.length;n++){const a=r[n];if(!a)continue;a.setDirty(true)}if(t){this._mediator.emit(Te.EVENTS.OPERATION_REMOVED,e)}}}get(e){return this._map[e]}getOrCreate(e,t={}){if(this._map[e]){const o=this._map[e];o.set(t,false);return o}const i=this._available[e];const r=new i(this._sdk,t);this.add(r);return r}getStack(){return this._stack}reset(){this._map={}}_fixStack(){const e=this._stack.getStack().slice();this._stack.clear();e.forEach(t=>{this.add(t)})}};xe();var ic=class{constructor(e,t,i){this._image=e;this._maxPixels=t;this._maxDimensions=i}needsResize(){const e=new oe(this._image.width,this._image.height);const t=e.x*e.y;const i=t>this._maxPixels;const r=this._maxDimensions!==null&&(e.x>this._maxDimensions||e.y>this._maxDimensions);return i||r}resize(){let e=null;let t=null;const i=this._maxDimensions;return new Promise((r,o)=>{window.setTimeout(()=>{const n=new oe(this._image.width,this._image.height);const a=n.clone();if(a.x*a.y>this._maxPixels){a.copy(this._getDimensionsByMaxPixels());e="maxMegaPixels"}if(i!==null&&(a.x>i||a.y>i)){const l=Math.min(i/a.x,i/a.y);a.multiply(l);e="maxDimensions"}a.floor();t=this._createResizedImageCanvas(a);r({canvas:t,dimensions:a,reason:e})},1e3)})}_createResizedImageCanvas(e,t=e){const i=this._image;const r=document.createElement("canvas");r.width=e.x;r.height=e.y;const o=e.clone().subtract(t).divide(2);const n=r.getContext("2d");n.drawImage(i,0,0,i.width,i.height,o.x,o.y,t.x,t.y);return r}_getDimensionsByMaxPixels(){const e=this._image;const t=this._maxPixels;const i=e.width/e.height;const r=e.height/e.width;return new oe(Math.sqrt(t*i),Math.sqrt(t*r)).floor()}};var CC=class extends Ca{constructor(e,t,i,r=false){super();this._ui=e;this._options=t;this._mediator=i;this._shallow=r;if(!r){this._initSDK();this.operations=new tc(this,this._sdk,this._mediator)}}_initFonts(){const e=ge.defaults(this._options.editor.controlsOptions.text,{additionalFonts:[],replaceFonts:false,availableVariations:null});this._fontManager=new at(this._ui,e);const t=this._fontManager.getFonts();const i=this._ui.getFontLoader();i.setFonts(t);i.load()}setImage(e=this._options.editor.image,t=true){if(t){this.reset()}let i=null;i=this._sdk.parseExif(e);this._setImage(e,i)}_initSDK(){const{logLevel:e,displayWelcomeMessage:t,debug:i,license:r,crossOrigin:o,watermark:n}=this._options;const{smoothDownscaling:a,smoothUpscaling:l,preferredRenderer:u,pixelRatio:c,transparent:h,clearColor:m}=this._options.editor;let d;if(Array.isArray(m)){d=ue.fromArray(m)}else if(typeof m==="string"){d=ue.fromHex(m)}else if(m instanceof ue){d=m.clone()}const f={logLevel:e,debug:i,displayWelcomeMessage:t,pixelRatio:c,smoothDownscaling:a,smoothUpscaling:l,transparent:h,crossOrigin:o,clearColor:d,license:r,watermark:n};this._sdk=new N(u,f)}getMaxMegapixels(){const{maxMegaPixels:e}=this._options.editor;return e}getCrossOrigin(){return ge.getCrossOriginValue(this._options.crossOrigin||"anonymous")}getOutputDimensions(e=false){return this._sdk.getOutputDimensions(e)}getOutputTextureDimensions(e=false){return this._sdk.getOutputTextureDimensions(e)}getFinalDimensions(e=false){return this._sdk.getFinalDimensions(e)}_setImage(e=this._options.editor.image,t=null){this._sdk.setAllOperationsToDirty();this._options.editor.image=e;this._sdk.setImage(e,t)}_ensureImageIsResized(){const e=this._sdk.getImage();const t=this._sdk.getRenderer();const i=this.getMaxMegapixels();const r=i?i*1e6:null;const o=t.getMaxDimensions();const n=new ic(e,r,o);if(!this._resizedImage&&n.needsResize()){return n.resize().then(({canvas:a,dimensions:l,reason:u})=>{this._resizedImage=a;this._sdk.setImage(a);return a})}return Promise.resolve(e)}export(e=false){if(this._watermarkOperation){this._watermarkOperation.setEnabled(false)}this._sdk.setAllOperationsToDirty();return this._ensureImageIsResized().then(t=>{const i=this._options.editor.export;const r=new ec(this._sdk,i,e);return r.export().then(o=>{this.emit("export",o);this._mediator.emit(Te.EVENTS.EXPORT,o,this);if(this._watermarkOperation){this._watermarkOperation.setEnabled(true);this._sdk.render()}this._sdk.setAllOperationsToDirty();return o})})}broadcastTransform(e,t){const i=new N.Operations.TransformOperation.TransformChange(e,t);const r=["sprite","selective-blur","radial-focus","mirrored-focus","linear-focus","blur"];r.forEach(o=>{const n=this.operations.get(o);if(!n){return}n.transform(i)})}broadcastFlip(e){const t=["mirrored-focus","radial-focus","linear-focus","sprite","selective-blur"];t.forEach(i=>{const r=this.operations.get(i);if(!r){return}r.flip(e)})}broadcastRotate(e){const t=["transform","mirrored-focus","linear-focus","radial-focus","sprite","selective-blur"];t.forEach(i=>{const r=this.operations.get(i);if(!r){return}r.rotate(e)})}_initSerializers(){this._serializers={"1.0.0":(Hw(),jw).default,"1.0.1":(Xw(),Kw).default,"2.0.0":(Qw(),Zw).default,"3.0.0":(tC(),eC).default,"3.1.0":(rC(),iC).default,"3.2.0":(oC(),sC).default,"3.4.0":(aC(),nC).default,"3.5.0":(uC(),lC).default,"3.6.0":(mC(),cC).default,"3.7.0":(pC(),dC).default,"3.8.0":(fC(),hC).default,"3.9.0":(yC(),_C).default,"3.12.0":(wC(),vC).default}}serialize(e={},t="3.12.0"){const i=this._serializers[t];if(!i){return Promise.reject(new Error(`No serializer for version ${t} found.`))}const r=new i(this);return r.serialize(e)}deserialize(e){const t=this._serializers[e.version];if(!t){return Promise.reject(new Error(`No serializer for version ${e.version} found.`))}const i=new t(this);return i.deserialize(e)}save(e=false,t=false){const i=this._options.editor.save;return this.serialize({image:t}).then(r=>{const o=JSON.stringify(r,null,2);if(e){const n=`data:text/json;charset=utf-8;base64,${window.encodeURI(window.btoa(o))}`;Ss.downloadDataURL(n,i.fileBasename)}return o})}reset(){this._sdk.reset();this.operations.reset()}dispose(){this.stop();if(this._resizedImage){ke(this._resizedImage)}this._sdk.dispose()}getRenderer(){return this._sdk.getRenderer()}getSDK(){return this._sdk}getInputDimensions(){return this._sdk.getInputDimensions()}getImage(){return this._sdk.getImage()}getOptions(){return this._options}getUI(){return this._ui}getMediator(){return this._mediator}};var DC=CC;nc();var Qi=class extends Ca{constructor(e={}){super();this._mediator=new Ca;this._fontLoader=new Lr(this);this._options=e;this._initOptions();this._initEvents();this._disposed=false;this._isReady=false;this._editor=new DC(this,this._options,this._mediator);if(this._options.editor.image){this._editor.setImage(this._options.editor.image)}this._mediator.once(Te.EVENTS.EDITOR_READY,()=>{this._isReady=true});P.setLevel(this._options.logLevel)}export(...e){return this._editor.export(...e)}serialize(...e){return this._editor.serialize(...e)}deserialize(e){return this._editor.deserialize(e)}getEditor(){return this._editor}isReady(){return this._isReady}onReady(e){if(!this._isReady){this._mediator.once(Te.EVENTS.EDITOR_READY,e)}else{e()}}createFilter(e){const t=new Rs(this,this._getOptions("filter"));return t.instantiateFilterWithIdentifier(e)}getTextDesignLayoutByID(e){const t=new Xt(this,this._getOptions("textDesign"));return new(t.getLayoutByIdentifier(e))}getTextDesignAssetManager(){return N.Operations.SpriteOperation.TextDesignSprite.AssetManager}getTextDesignFontManager(){const e=new at(this,{fonts:Te.DEFAULTS.TEXT_DESIGN_FONTS,replaceFonts:true,isTextDesign:true});return e}_getOptions(e){const t=this.getEditor();const{controls:i}=t;let r={};if(i&&i.get(e)){r=i.get(e).defaultOptions}const o=t.getOptions();return ge.deepDefaults({},o.editor.controlsOptions[e]||{},r)}_initOptions(){this._options=ge.defaults(this._options,{language:"en",logLevel:"warn",crossOrigin:"anonymous",editor:{},assets:{},responsive:false,preloader:true,autoRun:true});this._options.editor=ge.defaults(this._options.editor||{},{enableZoom:true,enableDrag:true,enableExport:true,enableKeyboardControls:true,enablePositionSnapping:true,enableRotationSnapping:true,enableSave:false,enableLoad:false,pixelRatio:Math.max(typeof window!=="undefined"&&window.devicePixelRatio||1,1),preferredRenderer:"webgl",transparent:true,clearColor:[0,0,0,0],displayResizeMessage:true,maxMegaPixels:{},displayCloseButton:false,undoMode:"global",defaultControl:"filter",forceCrop:false,snappingOptions:{},tools:["transform","filter","adjustments","focus","text","textdesign","sticker","brush","frame","overlay","library","artfilter"],controlsOrder:[["library"],["artfilter","transform","filter","adjustments","focus"],["text","textdesign","sticker","brush","frame","overlay"]],operationsOrder:["exif-orientation","artfilter","orientation","transform","filter","adjustments","radial-focus","mirrored-focus","linear-focus","blur","selective-blur","overlay","sprite","frame"],controlsOptions:{focus:{highQualityCanvasBlur:false}}});this._options.editor.snappingOptions=ge.defaults(this._options.editor.snappingOptions,{position:{},rotation:{}});this._options.editor.snappingOptions.position=ge.defaults(this._options.editor.snappingOptions.position,{padding:{},threshold:20});this._options.editor.snappingOptions.position.padding=ge.defaults(this._options.editor.snappingOptions.position.padding,{left:.1,right:.1,top:.1,bottom:.1});this._options.editor.snappingOptions.rotation=ge.defaults(this._options.editor.snappingOptions.rotation,{angles:[0,45,90,135,180,225,270,315],threshold:20});this._options.editor.controlsOptions.focus=ge.defaults(this._options.editor.controlsOptions.focus,{highQualityCanvasBlur:false});this._options.editor.maxMegaPixels=ge.defaults(this._options.editor.maxMegaPixels,{mobile:5,desktop:10});this._options.editor.export=ge.defaults(this._options.editor.export||{},{format:"image/png",type:Br.IMAGE,download:true,fileBasename:"photoeditorsdk-export",quality:.8});this._options.editor.save=ge.defaults(this._options.editor.save||{},{format:"text/json",download:true,fileBasename:"photoeditorsdk-save"});this._options.extensions=ge.defaults(this._options.extensions||{},{languages:{},operations:[],controls:[]});this._options.assets=ge.defaults(this._options.assets||{},{baseUrl:"assets",resolver:null});if(!(this._options.editor.image instanceof window.Image)){const e=new window.Image;if(this._options.editor.image){e.src=this._options.editor.image;this._options.editor.image=e}}}_initEvents(){this._mediator.pipeEvents(this)}_disposeEvents(){this._mediator.unpipeEvents(this)}setImage(e){this._editor.setImage(e)}getAssetPath(e,t=false,i=false){let{baseUrl:r,resolver:o}=this._options.assets;let n=`${r}/${e}`;o=o||(c=>{return c});if(e.match(/(ftp|http|https):\/\//)){n=e}const a=e.replace(/assets\//,"").split("/");const l=a[0];let u={};switch(l){case"art-filters":u={identifier:a[1],type:a[2].split(".")[0]};return o("art-filter",u);case"filters":u={identifier:a[1].replace(/\.png$/g,"")};return o("filter",u);case"fonts":u={identifier:a[1].replace(/\.(woff|otf|ttf)$/g,"")};return o("font",u);case"frames":u={identifier:a[1],filename:a[2]};return o("frame",u);case"overlays":u={identifier:a[1].replace(/\.(png|jpg|jpeg)$/g,"")};return o("overlay",u);case"stickers":{const c=a[3].endsWith(".svg");const h=a[3]==="thumbs";u={category:a[1],identifier:(c?a[3]:a[4]).replace(/\.(png|svg)$/g,""),variant:c?"svg":h?"thumb":"base"};return o("sticker",u)}case"text-design":u={type:a[1]==="fonts"?"font":"image",identifier:a[2].replace(/\.(png|otf|ttf|woff2?)$/g,"")};return o("text-design",u)}if(typeof o!=="undefined"&&o!==null){n=o(n)}return n}getFontLoader(){return this._fontLoader}dispose(){if(this._disposed){throw new Error("This instance of PhotoEditorSDK is already disposed.")}this._disposed=true;this._disposeEvents()}render(e){return this.deserialize(e).then(()=>this.export())}};Qi.prototype.identifier="engine-wrapper";Qi.Constants=Te;Qi.Events=Te.EVENTS;Qi.Utils=yt;Qi.JSONLoader=Nt;Qi.SDK=N;var Ih=class extends ho{constructor(e){super();this.config=e}getOutputDimensions(){const e=this.getOutputContainer();if(!e){return{width:0,height:0}}return e.getResolution()}getSmallerOutputSide(){const e=this.getOutputContainer();if(!e){return 0}const t=e.getResolution();return Math.min(t.width,t.height)}convertPointFromPreviewIntoOutputSpace(e,t){const i=ee.getInverted(V.rectTransformToAffineTransform(t));return ee.transformPoint(i,e)}convertPointFromPreviewIntoWorldSpace(e,t,i){const r=ee.getInverted(V.rectTransformToAffineTransform(t));const o=i?this.getOutputContainer().getBaseLocalToParentMatrix():this.getOutputContainer().getLocalToParentMatrix();const n=ee.multiply(o,r);return ee.transformPoint(n,e)}convertPointFromPreviewIntoFlippedPreviewSpace(e){const t=this.getOutputContainer().getFlipTransformMatrix();return ee.transformPoint(t,e)}convertPointFromWorldIntoPreviewSpace(e,t){const i=V.rectTransformToAffineTransform(t);const r=ee.getInverted(this.getOutputContainer().getLocalToParentMatrix());const o=ee.multiply(i,r);return ee.transformPoint(o,e)}convertPointFromOutputIntoPreviewSpace(e,t){const i=V.rectTransformToAffineTransform(t);return ee.transformPoint(i,e)}getContainersAtPreviewPoint(e,t){const i=new Array;const r=this.convertPointFromPreviewIntoWorldSpace(e,t);const o=this.getRootContainers();for(const n of o){this.accumulateContainersAtWorldPointInHierarchy(r,n,i)}return i}isPreviewPointInContainer(e,t,i){const r=this.convertPointFromPreviewIntoWorldSpace(e,i);return this.isWorldPointInContainer(r,t)}isWorldPointInContainer(e,t){const i=V.getLocalToWorldMatrix(t);const r=ee.getInverted(i);const o=ee.transformPoint(r,e);return Ge.contains(t.getBounds(),o)}accumulateContainersAtWorldPointInHierarchy(e,t,i){if(this.isWorldPointInContainer(e,t)){i.push(t)}const r=t.getChildren();for(const o of r){if(cl(o)){this.accumulateContainersAtWorldPointInHierarchy(e,o,i)}}}};var Ke=class{constructor(e){this.engine=e;this.id=Ja()}getID(){return this.id}getContainer(){return this.engine.getRootContainers()[0]}getIndexInParent(){const{rootOperations:e}=this.engine;for(let t=0;t<e.length;t+=1){if(e[t].getID()===this.id){return t}}return-1}setIndexInParent(e){this.engine.moveIndex(this,e)}isValid(){return this.getIndexInParent()!==-1}};var Ph=class extends Ke{constructor(e,t,i){super(t);this.operation=i;this.type="adjustments";this.setProperties(e)}getProperties(){const e=this.operation.getOptions();const t=e.gamma-1;return{brightness:e.brightness||0,saturation:e.saturation||0,contrast:e.contrast||0,gamma:(t<0?2*t:t)||0,clarity:e.clarity||0,exposure:e.exposure||0,shadows:e.shadows*.5||0,highlights:e.highlights||0,whites:e.whites||0,blacks:e.blacks||0,temperature:e.temperature||0,sharpness:e.sharpness||0}}setProperties(e){if(e.gamma!==void 0){e.gamma=1+(e.gamma<0?.5*e.gamma:e.gamma)}if(e.shadows){e.shadows=e.shadows*2}this.operation.set(e)}getOperation(){return this.operation}getTypeIdentifier(){return"adjustments"}};var Rt=s=>{if(kg(s)){return new N.Color(s.r,s.g,s.b,s.a)}if(Tg(s)){return new N.Color(s[0],s[1],s[2],s[3])}if(Cg(s)){return new N.Color(s.r,s.g,s.b,1)}if(Dg(s)){return new N.Color(s[0],s[1],s[2],1)}if(Rg(s)){const[e,t,i]=s.match(/[0-9A-fa-f]{1,2}/g);return new N.Color(parseInt(e,16)/255,parseInt(t,16)/255,parseInt(i,16)/255,1)}throw new Error("Invalid color type")};var pe=class{get x(){return this._x}get y(){return this._y}constructor(e=0,t=0){this._x=e;this._y=t}set(e,t){this._x=e;this._y=t;return this}clone(){return new pe(this._x,this._y)}copy(e){this._x=e.x;this._y=e.y;return this}clamped(e=this,t=this){let i=typeof e==="number"?{x:e,y:e}:e;let r=typeof t==="number"?{x:t,y:t}:t;this._x=Math.max(i.x,this._x);this._y=Math.max(i.y,this._y);this._x=Math.min(r.x,this._x);this._y=Math.min(r.y,this._y);return this}divide(e,t){if(typeof e==="number"||e===null){this._x/=e;this._y/=typeof t==="undefined"?e:t}else{this._x/=e.x;this._y/=e.y}return this}subtract(e,t){if(typeof e==="number"||e===null){this._x-=e;this._y-=typeof t==="undefined"?e:t}else{this._x-=e.x;this._y-=e.y}return this}multiply(e,t){if(typeof e==="number"||e===null){this._x*=e;this._y*=typeof t==="undefined"?e:t}else{this._x*=e.x;this._y*=e.y}return this}add(e,t){if(typeof e==="number"||e===null){this._x+=e;this._y+=typeof t==="undefined"?e:t}else{this._x+=e.x;this._y+=e.y}return this}dot(e,t){if(typeof e==="number"||e===null){return this._x*e+this._y*(typeof t==="undefined"?e:t)}else{return this._x*e.x+this._y*e.y}}equals(e,t){if(typeof e==="number"||e===null){return e===this._x&&t===this._y}else{return e.x===this._x&&e.y===this._y}}flip(){let e=this._x;this._x=this._y;this._y=e;return this}round(){this._x=Math.round(this._x);this._y=Math.round(this._y);return this}ceil(){this._x=Math.ceil(this._x);this._y=Math.ceil(this._y);return this}floor(){this._x=this._x|0;this._y=this._y|0;return this}abs(){this._x=Math.abs(this._x);this._y=Math.abs(this._y);return this}len(){return Math.sqrt(this._x*this._x+this._y*this._y)}min(){return Math.min(this._x,this._y)}max(){return Math.max(this._x,this._y)}toObject(){return{x:this._x,y:this._y}}toString(){return`Vector2({ x: ${this._x}, y: ${this._y} })`}roundDecimal(e){this._x=parseFloat(this._x.toFixed(e));this._y=parseFloat(this._y.toFixed(e));return this}asArray(e=false){if(e){return[this._y,this._x]}return[this._x,this._y]}static fromObject(e){return new pe(e.x,e.y)}static fromSize(e){return new pe(e.width,e.height)}static get NULL(){return new pe(0,0)}};var Bt=class{constructor(e){this.engine=e;this.id=Ja();this.transform=We.IDENTITY;this.bounds=Ge.ZERO}getID(){return this.id}getParent(){const e=this.engine.getRootContainers();if(e.length===0||this.id===e[0].id){return void 0}return e[0]}getIndexInParent(){const{rootOperations:e}=this.engine;for(let t=0;t<e.length;t+=1){if(e[t].getID()===this.id){return t}}return-1}setIndexInParent(e){this.engine.moveIndex(this,e)}getChildren(){const e=this.engine.getRootContainers();if(e.length>0&&(this.id===e[0].id||this.id===this.engine.getOutputContainer().id)){return this.engine.rootOperations}return[]}getBounds(){return this.bounds}setPivotOnSelfAndSprite(e,t,i){if(typeof t==="number"){this.setPivotInternal(t,i);e.setPivot(new pe(t,i))}else{this.setPivotInternal(t);e.setPivot(pe.fromObject(t))}}setPivot(e,t){this.setPivotInternal(e,t)}getPivot(){const e=this.getBounds();return{x:-e.minX/e.width,y:-e.minY/e.height}}getTransform(){return this.transform}setTransform(e){this.transform=e}updateTransform(){this.setTransform(this.transform)}getPosition(){return this.transform.position}setPosition(e,t){let i;if(typeof e==="number"){i={x:e,y:t===void 0?e:t}}else{i=e}const{scale:r}=this.transform;const{rotation:o}=this.transform;this.setTransform(new We(i,r,o))}getScale(){return this.transform.scale}setScale(e,t){let i;if(typeof e!=="number"){i=e}else{i={x:e,y:t===void 0?e:t}}const{position:r,rotation:o}=this.transform;this.setTransform(new We(r,i,o))}getRotation(){return this.transform.rotation}setRotation(e){const{position:t,scale:i}=this.transform;this.setTransform(new We(t,i,e))}getSizeInWorldSpace(){return V.getSizeInWorldSpace(this)}getSizeInOutputSpace(){return V.getSizeInOutputSpace(this,this.engine.getOutputContainer())}setSizeInWorldSpace(e){const t=this.getBounds();this.setScale(e.width/t.width,e.height/t.height)}setSizeInOutputSpace(e){const t=this.engine.getOutputContainer().getScale();this.setSizeInWorldSpace({width:e.width/t.x,height:e.height/t.y})}isValid(){return this.getIndexInParent()!==-1}setPivotInternal(e,t){const i=this.getBounds();if(typeof e==="number"){this.setBoundsFromSize(i.width,i.height,{x:e,y:t})}else{this.setBoundsFromSize(i.width,i.height,e)}}setBoundsFromSize(e,t,i=this.getPivot()){this.bounds=new Ge(-i.x*e,-i.y*t,e,t)}};var Bh=class extends Bt{constructor(e,t){super(t);this.type="drawing";this.drawing=e;this.operation=t.createSpriteOperation();this.sprite=this.operation.createBrush({});this.operation.addSprite(this.sprite);this.radialBrush=this.sprite._createRadialBrush();const i=t.getRootContainers()[0];const r=i.getBounds();this.bounds=new Ge(0,0,r.width,r.height);this.setTransform(We.IDENTITY);this.operation.setDirty(true);this.setData(e)}beginStroke(e){if(this.currentStroke){throw new Error("A brush stroke has already been started but not finished.")}if(e.id!=="imgly_brush_radial"){throw new Error("This adapter does not support any brush faces other than the radial img.ly brush.")}this.currentBrush=e;this.currentStroke={brush:e,path:{controlPoints:[]}};this.radialBrush.setColor(Rt(e.color));this.radialBrush.setHardness(e.hardness);this.radialBrush.setSize(e.size);this.currentPath=this.sprite.createPath(this.radialBrush.clone())}addPointToCurrentStroke(e,t=true){if(!this.currentStroke||!this.currentBrush||!this.currentPath){throw new Error('A brush stroke has to first be started with a call to "beginStroke(brush:Brush)"')}if(this.currentStroke.path.controlPoints.length){const l=this.currentStroke.path.controlPoints;const u=l[l.length-1];const c=this.currentBrush.size/10;const h=Math.sqrt(e.x-u.x**2+(e.y-u.y**2));if(h<c){return}}const i=this.engine.getOutputContainer();const r=this.engine.getRootContainers()[0];const o=V.pointFromSpaceToSpace(e,r,i,true);const n=V.absoluteToRelativePoint(o,i,false);const a=i.getBounds();this.currentPath.addControlPoint(pe.fromObject(n));this.currentStroke.path.controlPoints.push(e);if(t){this.sprite.render(pe.fromObject({x:a.width,y:a.height}))}}endStroke(){if(!this.currentStroke||!this.currentPath||!this.currentBrush){return}if(this.currentStroke.path.controlPoints.length){this.drawing.strokes.push(this.currentStroke)}this.currentStroke=void 0;this.currentBrush=void 0;this.currentPath.setClosed(true);const e=this.engine.getOutputContainer().getBounds();this.sprite.render(pe.fromObject({x:e.width,y:e.height}));this.currentPath=void 0}setData(e){this.drawing={...this.drawing,...e};if(this.drawing.strokes){this.drawing.strokes=[]}this.sprite.clearPersistCanvas();this.sprite.clearCanvas();this.sprite.setPaths([]);this.drawStrokes(e.strokes)}getData(){return this.drawing}updateData(){this.setData(this.getData())}getOperation(){return this.operation}drawStrokes(e){e.forEach(t=>{this.beginStroke(t.brush);t.path.controlPoints.forEach(i=>{this.addPointToCurrentStroke(i,true)});this.endStroke()})}};var Mh=class extends Ke{constructor(e,t,i,r){super(r);this.filterOperation=t;this.type="duotone-filter";t.set({intensity:i.colorIntensity});t.set({filter:e});r.pesdk.setAllOperationsToDirty()}getProperties(){const e=this.filterOperation.getOptions();return{colorIntensity:e.intensity}}setProperties(e){const t=this.filterOperation.getOptions();let i=t.intensity;if(e.colorIntensity!==void 0){i=Math.min(Math.max(e.colorIntensity,0),1)}this.filterOperation.set({intensity:i})}getOperation(){return this.filterOperation}getTypeIdentifier(){return"filter"}};var Lh=class{constructor(e,t){this.engine=t;this.loaded=false;this.loading=false;this.asset={...e}}async load(){if(this.loaded){return Promise.resolve()}if(this.loading){return Promise.reject(new Error("Called Frame#load while it's already loading"))}this.loading=true;const{imageGroups:e}=this.asset;const t=[];["top","left","right","bottom"].forEach(i=>{if(!e[i]){return}const r=e[i];["start","mid","end"].forEach(o=>{if(!(o in r)){return}t.push(this.loadPart(i,o))})});return Promise.all(t).then(()=>{this.loaded=true;this.loading=false}).catch(()=>{this.loaded=false;this.loading=false})}getFrame(){return{...this.asset,defaultName:this.asset.name,thumbnail:this.asset.thumbnailURI}}getIdentifier(){return this.asset.identifier}getDefaultName(){return this.asset.name}getThumbnail(){return this.asset.thumbnailURI}getTintable(){return this.asset.tintable||false}getLayoutMode(){return this.asset.layoutMode}getImageGroups(){return this.asset.imageGroups}async loadPart(e,t){return new Promise((i,r)=>{const{imageGroups:o}=this.asset;const n=o[e][t];let a=n;if(typeof n!=="string"&&"image"in n){a=n.image}const l=new Image;l.addEventListener("load",()=>{if(typeof n!=="string"){this.asset.imageGroups[e][t].image=l}else{this.asset.imageGroups[e][t]=l}i(l)});l.addEventListener("error",()=>{r(new Error(`Failed to load image at ${l.src}`))});l.crossOrigin=this.engine.configuration.crossOrigin||"anonymus";l.src=this.engine.assetProvider.getAssetSource("frame",a)})}};var zh=class extends Ke{constructor(e,t,i){super(i);this.frameOperation=e;this.type="frame";this.setProperties(t);i.pesdk.setAllOperationsToDirty()}setProperties(e){this.props={...this.props,...e};if(typeof e.opacity==="number"){this.frameOperation.set({alpha:e.opacity})}if(e.tintColor){this.frameOperation.set({tintColor:Rt(e.tintColor)})}if(e.width){const t=this.engine.getOutputContainer().getBounds();const i=Math.min(t.width,t.height);const r=e.width/i;this.frameOperation.set({scale:r})}this.frameOperation.setDirty(true)}getProperties(){return this.props}getOperation(){return this.frameOperation}getTypeIdentifier(){return"frame"}};var Uh=class extends Ke{constructor(e,t,i){super(t);this.blurOperation=i;this.type="gaussian-blur";this.setProperties(e)}getProperties(){const e=this.engine.getOutputContainer();const t=e.getBounds();const i=Math.min(t.size.width,t.size.height);const r=V.scalarFromSpaceToSpace(this.blurOperation.getOptions().blurRadius*i,e,this.getContainer());return{blurRadius:r}}setProperties(e){if(e.blurRadius!==void 0){const t=this.engine.pesdk.getOutputDimensions();const i=Math.min(t.x,t.y);const r=this.getContainer();const o=this.engine.getOutputContainer();const n=V.scalarFromSpaceToSpace(e.blurRadius,r,o);const a=n/i;this.blurOperation.set({blurRadius:a})}}getOperation(){return this.blurOperation}getTypeIdentifier(){return"blur"}};var kc=class extends Bt{constructor(e,t){super(t);this.data=e;this.type="image";this.dispose=()=>{var e;if(((e=this.data)==null?void 0:e.image)instanceof HTMLCanvasElement){ke(this.data.image)}};const i=t.configuration.downscaleOptions;if(!i){this.downscaleOptions={maxDimensions:{width:t.maxTextureDimension,height:t.maxTextureDimension}}}else{const{maxDimensions:o}=i;this.downscaleOptions={maxMegaPixels:i.maxMegaPixels,maxDimensions:{width:Math.min(t.maxTextureDimension,o?o.width:Number.MAX_VALUE),height:Math.min(t.maxTextureDimension,o?o.height:Number.MAX_VALUE)}}}this.setData(e);const{image:r}=this.data;this.bounds=new Ge(ne.ZERO,{width:r.width,height:r.height})}setData(e){this.data={...this.data,...e};if(e.image){let{image:t}=e;let i;if(t instanceof HTMLImageElement){i=this.engine.pesdk.parseExif(t);if(i){const o=i.getTags();if(o&&o.Orientation){const n=o.Orientation!==1&&o.Orientation!==2;const a=[2,4,5,7].indexOf(o.Orientation)!==-1;if(n||a){if(Ya()||Kf()||!CSS.supports("image-orientation","from-image")){const l=this.engine.pesdk.createOperation("exif-orientation",{},false);l.setTags(o);t=l.applyTo(t)}i.setOrientation(1);o.Orientation=1}}}}const r=new En(t,this.downscaleOptions);r.on(Mi.IMAGE_DOWNSCALED,({width:o,height:n})=>{this.engine.emit(Pn.IMAGE_DOWNSCALED,{width:o,height:n})});r.on(Mi.BEGAN_IMAGE_DOWNSCALING,()=>{this.engine.emit(Pn.BEGAN_IMAGE_DOWNSCALING)});t=r.downscaleIfNecessary();this.data.image=t;this.engine.pesdk.setImage(t,i);this.setBoundsFromSize(t.width,t.height)}}getData(){return this.data}setPivot(e,t){throw new Error("This container does not support modifying the pivot")}getOperation(){throw new Error("This container has no associated operation")}};var Nh=class extends Ke{constructor(e,t,i){super(t);this.props=e;this.blurOperation=i;this.type="linear-blur";this.setProperties(e)}getProperties(){return this.props}setProperties(e){this.props={...this.props,...e};const t=this.blurOperation.getOptions();const i=this.engine.getOutputContainer();const r=i.getBounds();const o=this.getContainer();const n=i.getBaseLocalToParentMatrix();const a=V.getBaseLocalToWorldMatrix(o);const l=ee.multiply(ee.getInverted(n),a);const u=Math.min(r.size.width,r.size.height);if(e.blurRadius!==void 0){const c=V.scalarFromSpaceToSpace(e.blurRadius,o,i);t.blurRadius=c/u}if(e.start!==void 0){const c=ee.transformPoint(l,e.start);const h=V.absoluteToRelativePoint(c,i,false);t.controlPoint1=h}if(e.end!==void 0){const c=ee.transformPoint(l,e.end);const h=V.absoluteToRelativePoint(c,i,false);t.controlPoint2=h}this.blurOperation.set(t)}updateProperties(){const e=this.getProperties();this.setProperties(e)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"linear-focus"}};var Gh=class extends Ke{constructor(e,t,i,r){super(r);this.filter=e;this.filterOperation=t;this.props=i;this.type="lut-filter";t.set({intensity:i.intensity});t.set({filter:e});r.pesdk.setAllOperationsToDirty()}getProperties(){const e=this.filterOperation.getOptions();return{intensity:e.intensity,lutImage:this.props.lutImage,horizontalTileCount:this.props.horizontalTileCount,verticalTileCount:this.props.verticalTileCount}}setProperties(e){const t=this.filterOperation.getOptions();const i=typeof e.intensity==="number"?e.intensity:t.intensity;this.filterOperation.set({intensity:i})}getOperation(){return this.filterOperation}getTypeIdentifier(){return"filter"}};var Wh=class extends Ke{constructor(e,t,i){super(t);this.props=e;this.blurOperation=i;this.type="mirrored-blur";this.setProperties(e)}getProperties(){return this.props}setProperties(e){this.props={...this.props,...e};const t=this.blurOperation.getOptions();const i=this.engine.getOutputContainer();const r=i.getBounds();const o=this.getContainer();const n=i.getBaseLocalToParentMatrix();const a=V.getBaseLocalToWorldMatrix(o);const l=ee.multiply(ee.getInverted(n),a);const u=Math.min(r.size.width,r.size.height);if(e.blurRadius!==void 0){const c=V.scalarFromSpaceToSpace(e.blurRadius,o,i);t.blurRadius=c/u}if(e.gradientSize!==void 0){const c=V.scalarFromSpaceToSpace(e.gradientSize,o,i);const h=c/u;t.gradientSize=h}if(e.clearAreaWidth!==void 0){const c=V.scalarFromSpaceToSpace(e.clearAreaWidth,o,i);const h=c/u;t.size=h*.5}if(e.mirrorAxisOrigin!==void 0){const c=ee.transformPoint(l,e.mirrorAxisOrigin);const h=V.absoluteToRelativePoint(c,i,false);t.start=h}if(e.mirrorAxisDirection!==void 0){const c=ee.transformPoint(l,e.mirrorAxisDirection);const h=V.absoluteToRelativePoint(c,i,false);t.end=h}this.blurOperation.set(t)}updateProperties(){const e=this.getProperties();this.setProperties(e)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"mirrored-focus"}};var Tc=class extends Bt{constructor(e,t,i,r){super(r);this.settings=e;this.operation=t;this.flipOperation=i;this.type="output";this.flipTransform=ee.IDENTITY;this.blockTransformUpdate=false;this.transformUpdateWhileBlock=false;this.bounds=new Ge({x:0,y:0},this.settings.resolution);this.setData(e)}pauseChildrenUpdates(){this.transformUpdateWhileBlock=false;this.blockTransformUpdate=true}resumeChildrenUpdates(){this.blockTransformUpdate=false;if(this.transformUpdateWhileBlock){this.updateChildrenContainers()}}setData(e){this.settings={...this.settings,...e};if(e.resolution){this.setBoundsFromSize(e.resolution.width,e.resolution.height);this.setTransform(this.transform);this.operation.set({outputResolution:new pe(e.resolution.width,e.resolution.height)})}if(e.flipHorizontally!==void 0){const t=e.flipHorizontally;this.updateFlipTransform();this.flipOperation.set({flipHorizontally:t})}if(e.flipVertically!==void 0){const t=e.flipVertically;this.updateFlipTransform();this.flipOperation.set({flipVertically:t})}this.operation.setDirty(true);this.flipOperation.setDirty(true)}getData(){return this.settings}setResolution(e){this.setData({resolution:e})}getResolution(){return this.getData().resolution}setTransform(e){if(this.transform.rotation!==e.rotation||this.transform.position!==e.position||this.transform.scale!==e.scale){this.transform=e;const t=this.flipTransform;this.flipTransform=ee.IDENTITY;const i=this.engine.getRootContainers()[0];const r=V.pointFromSpaceToSpace({x:0,y:0},i,this);const o=-e.rotation;const n=pe.fromObject(r).clone().subtract(pe.fromObject(this.getBounds().origin));this.operation.set({pivot:new pe(0,0),position:n,scale:new pe(1/e.scale.x,1/e.scale.y),rotation:o});this.flipTransform=t;this.operation.setDirty(true);this.updateChildrenContainers()}}rotate(e,t){const i=this.getPivot();const r=this.getBounds();const o={x:r.midX,y:r.midY};const n=V.getPointInWorldSpace(o,this);this.setPivot(.5,.5);this.setPosition(n);this.setRotation(e);this.setResolution(t);const a={x:-t.width*(.5-i.x),y:-t.height*(.5-i.y)};const l=V.getPointInWorldSpace(a,this);this.setPivot(i);this.setPosition(l);this.updateChildrenContainers()}setPivot(e,t){super.setPivotInternal(e,t);this.setTransform(this.transform)}getTransform(){return this.transform}getBaseLocalToParentMatrix(){return V.rectTransformToAffineTransform(this.getTransform())}getLocalToParentMatrix(){const e=V.rectTransformToAffineTransform(this.getTransform());return ee.multiply(e,this.flipTransform)}getFlipTransformMatrix(){return this.flipTransform}isValid(){return true}getOperation(){return this.operation}updateFlipTransform(){const{flipHorizontally:e,flipVertically:t}=this.settings;if(!e&&!t){this.flipTransform=ee.IDENTITY}else{const i=this.getPivot();const r=this.getBounds();const o=e?-1:1;const n=e?-2*(i.x-.5)*r.width:0;const a=t?-1:1;const l=t?-2*(i.y-.5)*r.height:0;this.flipTransform=new ee(o,0,0,a,n,l)}}updateChildrenContainers(){if(this.blockTransformUpdate){this.transformUpdateWhileBlock=true;return}this.engine.rootOperations.forEach(e=>{if(cl(e)){e.updateTransform();if("updateData"in e){e.updateData()}}else if("updateProperties"in e){e.updateProperties()}})}};var Rc=class extends Ke{constructor(e,t,i){super(i);this.overlayOperation=e;this.type="overlay";const r=t.blendMode||i.mapBlendMode(e.getBlendMode());e.set({blendMode:i.reverseMapBlendMode(r)});e.set({image:t.image});i.pesdk.setAllOperationsToDirty()}getProperties(){const e=this.overlayOperation.getOptions();return{image:e.image,blendMode:this.engine.mapBlendMode(e.blendMode),opacity:e.alpha}}setProperties(e){const t=this.overlayOperation.getOptions();if(typeof e.opacity==="number"){t.alpha=e.opacity}if(e.blendMode!==void 0){t.blendMode=this.engine.reverseMapBlendMode(e.blendMode)}this.overlayOperation.set(t);this.overlayOperation.setDirty(true)}getOperation(){return this.overlayOperation}getTypeIdentifier(){return"overlay"}setFlipHorizontally(e){this.overlayOperation.setFlipHorizontally(e)}setFlipVertically(e){this.overlayOperation.setFlipVertically(e)}getFlipHorizontally(){return this.overlayOperation.getFlipHorizontally()}getFlipVertically(){return this.overlayOperation.getFlipVertically()}};var Vh=class extends Ke{constructor(e,t,i){super(t);this.props=e;this.blurOperation=i;this.type="radial-blur";this.setProperties(e)}getProperties(){return this.props}setProperties(e){this.props={...this.props,...e};const t=this.blurOperation.getOptions();const i=this.engine.getOutputContainer();const r=i.getBounds();const o=this.getContainer();const n=i.getBaseLocalToParentMatrix();const a=V.getBaseLocalToWorldMatrix(o);const l=ee.multiply(ee.getInverted(n),a);const u=Math.min(r.size.width,r.size.height);if(e.blurRadius!==void 0){const c=V.scalarFromSpaceToSpace(e.blurRadius,o,i);t.blurRadius=c/u}if(e.center!==void 0){const c=ee.transformPoint(l,e.center);const h=V.absoluteToRelativePoint(c,i,false);t.position=h}if(e.radius!==void 0){const c=V.scalarFromSpaceToSpace(e.radius,o,i);const h=c/u;t.radius=h}if(e.gradientSize!==void 0){const c=V.scalarFromSpaceToSpace(e.gradientSize,o,i);const h=c/u;t.gradientRadius=h}this.blurOperation.set(t)}updateProperties(){const e=this.getProperties();this.setProperties(e)}getOperation(){return this.blurOperation}getTypeIdentifier(){return"radial-focus"}};var Ec=class extends Bt{constructor(e,t){super(t);this.data=e;this.type="sticker";let i=e.image;const r=this.engine.pesdk.parseExif(e.image);if(r){const n=r.getTags();if(n&&n.Orientation){const a=n.Orientation!==1&&n.Orientation!==2;const l=[2,4,5,7].indexOf(n.Orientation)!==-1;if(a||l){const u=this.engine.pesdk.createOperation("exif-orientation",{},false);u.setTags(n);i=u.applyTo(e.image);r.setOrientation(1);n.Orientation=1}}}const o=new En(i,{maxMegaPixels:{desktop:10,mobile:5}});i=o.downscaleImageIfNecessary();this.operation=t.createSpriteOperation();this.sprite=this.operation.createSticker({identifier:"",image:i,position:new pe(0,0),dimensions:new pe(1,1),rotation:0,smoothDownscaling:false});this.operation.addSprite(this.sprite);this.bounds=new Ge({x:0,y:0},{width:i.width,height:i.height});this.setTransform(We.IDENTITY);this.sprite.setPivot(new pe(0,0));this.operation.setDirty(true);this.setData(e)}setData(e){this.data={...this.data,...e};if(e.id){this.id=e.id}if(yg(e.opacity)&&e.opacity>=0){this.sprite.setAlpha(e.opacity)}if(e.tintColor){this.sprite.setTintColor(Rt(e.tintColor))}if(e.tintMode){this.sprite.setTintMode(e.tintMode)}this.operation.setDirty(true)}getData(){return this.data}updateData(){this.setData(this.getData())}setTransform(e){super.setTransform(e);const t=this.engine.getOutputContainer();const i=this.getParent();const r={width:this.bounds.width*e.scale.x,height:this.bounds.height*e.scale.y};const o=V.sizeFromSpaceToSpace(r,i,t);this.sprite.setDimensions(pe.fromSize(o));const n=V.pointFromSpaceToSpace(e.position,i,t,true);const a=V.absoluteToRelativePoint(n,t,false);this.sprite.setPosition(new pe(a.x,a.y));const l=V.getRotationBetweenCoordinateSpaces(i,t);const u=e.rotation+l;this.sprite.setRotation(u);this.operation.setDirty(true)}setPivot(e,t){this.setPivotOnSelfAndSprite(this.sprite,e,t)}getOperation(){return this.operation}setFlipHorizontally(e){this.sprite.setFlipHorizontally(e)}setFlipVertically(e){this.sprite.setFlipVertically(e)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}};function vS(s,e){if(e){const t=1/e.unitsPerEm*s;const i=e.ascender*t;const r=e.descender*t;return i+Math.abs(r)}return s*1.1}var Sc=class{constructor(e){this.context=e;this.sourceLines=[];this.maxWidth=100}static buildWords(e){const t=[];let i="";const r=e.length;for(let o=0;o<r;o+=1){const n=e[o];i+=n;if(n===" "||n==="-"||o===r-1){t.push(i);i=""}}return t}getLines(){let e=[];let t=[];const i=this.sourceLines.length;for(let r=0;r<i;r+=1){const o=this.sourceLines[r];const n=Sc.buildWords(o);const a=n.length;for(let l=0;l<a;l+=1){const u=n[l];const c=t.concat(u).join("").replace(/\s+$/i,"");const h=this.getWidth(c);if(h>this.maxWidth){if(t.length>0){e.push(t.join(""));t=[u]}const m=u.replace(/\s+$/i,"");if(this.getWidth(m)>this.maxWidth){const d=this.splitWord(u);e=e.concat(d.lines);if(d.rest){t=[d.rest]}}}else{t.push(u)}}e.push(t.join(""));t=[]}return e}splitWord(e){const t={lines:[],rest:null};const i=e.length;let r=[];for(let o=0;o<i;o+=1){const n=e[o];if(this.getWidth(r.concat(n).join(""))>this.maxWidth){if(r.length>0){t.lines.push(r.join(""))}r=[n]}else{r.push(n)}if(o===i-1&&r.length>0){t.rest=r.join("")}}return t}getWidth(e){return this.context.measureText(e).width}setText(e){this.sourceLines=e.split("\n")}setMaxWidth(e){this.maxWidth=e}};function Fc(s,e,t,i,r,o,n){s.font=`${t.fontStyle||"normal"} ${t.fontWeight||"normal"} ${i}px "${t.fontFamily}"`;const a=new Sc(s);a.setText(e);a.setMaxWidth(o);const l=a.getLines().map(m=>{return m.replace(/\s+$/i,"")});const u=vS(i,n);const c=u*r;const h=u/5;return{width:o+h*2,height:l.length*c+h*2}}var er=class extends Bt{constructor(e,t){super(t);this.text=e;this.type="text";if(!er.measureContext){const l=document.createElement("canvas");er.measureContext=l.getContext("2d")}this.operation=t.createSpriteOperation();const i=this.engine.getOutputContainer();const r=this.getParent();const o=i.getBounds();this.sprite=this.operation.createText({text:e.text,position:new pe(0,0),rotation:0,fontSize:V.scalarFromSpaceToSpace(e.fontSize/o.height,r,i),lineHeight:e.lineHeight,fontIdentifier:e.fontIdentifier,alignment:e.alignment,color:Rt(e.textColor),backgroundColor:Rt(e.backgroundColor),maxWidth:V.scalarFromSpaceToSpace(e.width/o.width,r,i)});const n=t.assetProvider.getFontManager().getFontWithId(e.fontIdentifier);this.sprite.setFontFamily(n.fontFamily);this.sprite.setFontWeight(n.fontWeight||"normal");this.sprite.setFontStyle(n.fontStyle||"normal");this.sprite.setFontIdentifier(n.identifier);this.sprite.setTextMetrics(n.textMetrics);this.sprite.setPivot(new pe(0,0));this.operation.addSprite(this.sprite);const a=Fc(er.measureContext,e.text,n,e.fontSize,e.lineHeight,e.width,n.textMetrics);this.bounds=new Ge(0,0,a.width,a.height);this.setTransform(We.IDENTITY);this.operation.setDirty(true)}setData(e){this.text={...this.text,...e};const t=this.engine.assetProvider.getFontManager().getFontWithId(e.fontIdentifier||this.text.fontIdentifier);if(e.fontIdentifier){this.sprite.setFontFamily(t.fontFamily);this.sprite.setFontWeight(t.fontWeight||"normal");this.sprite.setFontStyle(t.fontStyle||"normal");this.sprite.setFontIdentifier(t.identifier);this.sprite.setTextMetrics(t.textMetrics)}if(e.id){this.id=e.id}if(e.text){this.sprite.setText(e.text)}if(e.fontSize){const r=this.engine.getOutputContainer();const o=this.getParent();const n=V.scalarFromSpaceToSpace(e.fontSize,o,r);const a=r.getBounds();this.sprite.setFontSize(n/a.height)}if(e.alignment){this.sprite.setAlignment(e.alignment)}if(e.lineHeight){this.sprite.setLineHeight(e.lineHeight)}if(e.textColor){this.sprite.setColor(Rt(e.textColor))}if(e.backgroundColor){this.sprite.setBackgroundColor(Rt(e.backgroundColor))}if(e.width){const r=this.engine.getOutputContainer();const o=this.getParent();const n=V.scalarFromSpaceToSpace(e.width,o,r);const a=r.getBounds();this.sprite.setMaxWidth(n/a.width)}const i=Fc(er.measureContext,this.text.text,t,this.text.fontSize,this.text.lineHeight,this.text.width,t.textMetrics);this.setBoundsFromSize(i.width,i.height);this.operation.setDirty(true)}getData(){return this.text}updateData(){this.setData(this.getData())}setTransform(e){super.setTransform(e);const t=this.engine.getOutputContainer();const i=this.getParent();const r=V.pointFromSpaceToSpace(e.position,i,t,true);const o=V.absoluteToRelativePoint(r,t,false);this.sprite.setPosition(new pe(o.x,o.y));const n=V.getRotationBetweenCoordinateSpaces(i,t);this.sprite.setRotation(e.rotation+n);this.operation.setDirty(true)}setPivot(e,t){this.setPivotOnSelfAndSprite(this.sprite,e,t)}getOperation(){return this.operation}setFlipHorizontally(e){this.sprite.setRotation(this.getFlippedRotation({flipHorizontally:e}));this.sprite.setFlipHorizontally(e)}setFlipVertically(e){this.sprite.setRotation(this.getFlippedRotation({flipVertically:e}));this.sprite.setFlipVertically(e)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}getFlippedRotation({flipVertically:e,flipHorizontally:t}){const i=e||this.getFlipVertically();const r=t||this.getFlipHorizontally();let o=this.getRotation();if(i||r){o=vm(o)}return o}};var jh=1e3;var to=class extends Bt{constructor(e,t,i){super(i);this.textDesign=e;this.layout=t;this.type="text-design";this.currentLayoutSize=void 0;this.layoutID=t.identifier;this.operation=i.createSpriteOperation();const r=this.engine.getOutputContainer();const o=this.getParent();const n=r.getBounds();const a=Math.min(n.width,n.height);t.seed(e.seed);this.bounds=this.calculateBounds(this.textDesign,this.layout);const l=e.width;this.sprite=this.operation.createTextDesign({text:e.text,layout:t,inverted:e.inverted,color:Rt(e.color),width:V.scalarFromSpaceToSpace(e.width/a,o,r),padding:e.padding/l,seed:e.seed});this.updatePivot();this.operation.addSprite(this.sprite);this.setTransform(We.IDENTITY);this.operation.setDirty(true)}static stringify(e){return JSON.stringify(e,to.serializer())}static serializer(){const e=[];const t=[];const i=(r,o)=>{if(e[0]===o)return"[Circular ~]";return`[Circular ~.${t.slice(0,e.indexOf(o)).join(".")}]`};return function r(o,n){const a=this;if(e.length>0){const l=e.indexOf(a);if(~l){e.splice(l+1);t.splice(l,Infinity,o)}else{e.push(a);t.push(o)}if(~e.indexOf(n)){n=i.call(a,o,n)}}else{e.push(n)}return n}}calculateBounds(e,t,i=true){const r=e.inverted&&i?Math.max(0,2*e.padding):0;const o=e.width/jh;if(this.currentLayoutSize===void 0){t.seed(e.seed);const n=t.generateLayoutData(e.text,jh);this.currentLayoutData=n;this.currentLayoutSize=n.getSize()}return new Ge(0,0,this.currentLayoutSize.width*o+r,this.currentLayoutSize.height*o+r)}findNextUniqueSeed(e,t,i){let r=i;const o=this.currentLayoutData?to.stringify(this.currentLayoutData.getRows()):"";let n;for(let a=0;a<20;a+=1){t.seed(r);n=t.generateLayoutData(e.text,jh);if(o===to.stringify(n.getRows())){r+=1}else{break}}t.seed(r);this.currentLayoutData=n;return r}setData(e){this.textDesign={...this.textDesign,...e};if(e.id){this.id=e.id}if(e.padding!==void 0){const t=this.textDesign.width;this.sprite.setPadding(e.padding/t)}else if(e.width){this.textDesign.padding=this.sprite.getPadding()*this.textDesign.width}if(e.seed!==void 0){if(e.seed<0){e.seed=this.findNextUniqueSeed(this.textDesign,this.layout,Date.now());this.textDesign.seed=e.seed}this.currentLayoutSize=void 0;this.layout.seed(e.seed);this.sprite.setSeed(e.seed);this.sprite.setLayout(this.layout)}if(e.color){this.sprite.setColor(Rt(e.color))}if(e.inverted!==void 0){this.sprite.setInverted(e.inverted)}if(e.text){this.currentLayoutSize=void 0;this.sprite.setText(e.text)}if(e.width){const t=this.engine.getOutputContainer();const i=this.getParent();const r=t.getBounds();const o=Math.min(r.width,r.height);const n=V.scalarFromSpaceToSpace(e.width/o,i,t);this.sprite.setWidth(n)}if(e.padding!==void 0||e.seed!==void 0||e.inverted!==void 0||e.text||e.width){const t=this.calculateBounds(this.textDesign,this.layout);this.setBoundsFromSize(t.width,t.height);this.updatePivot()}this.operation.setDirty(true)}getData(){return this.textDesign}updateData(){this.setData(this.getData())}setTransform(e){super.setTransform(e);const t=this.engine.getOutputContainer();const i=this.getParent();if(e.scale.x!==1||e.scale.y!==1){throw new Error("This engine doesn't support scaling TextDesign containers! You can change the bounds using the width property of the TextDesign data.")}const r=V.pointFromSpaceToSpace(e.position,i,t,true);const o=V.absoluteToRelativePoint(r,t,false);this.sprite.setPosition(new pe(o.x,o.y));const n=V.getRotationBetweenCoordinateSpaces(i,t);this.sprite.setRotation(e.rotation+n);this.operation.setDirty(true)}setPivot(e,t){if(typeof e==="number"){super.setPivot(e,t)}else{super.setPivot(e)}this.updatePivot()}getOperation(){return this.operation}getLayoutID(){return this.layoutID}setFlipHorizontally(e){this.sprite.setFlipHorizontally(e)}setFlipVertically(e){this.sprite.setFlipVertically(e)}getFlipHorizontally(){return this.sprite.getFlipHorizontally()}getFlipVertically(){return this.sprite.getFlipVertically()}updatePivot(){const e=this.textDesign.inverted?Math.max(0,this.textDesign.padding):0;const t=new ne(this.bounds.width-2*e,this.bounds.height-2*e);const i=this.getPivot();const r=new ne(i.x*this.bounds.width,i.y*this.bounds.height);const o=new ne(e,e);const n=r.subtract(o);const a=n.divide(t);this.sprite.setPivot(new pe(a.x,a.y))}};var{BLEND_MODES:Xe}=N.Operations.OverlayOperation;var Oc="imgly_font_open_sans_bold";var kC=class extends Ih{constructor(e){super(e);this.previews=Array();this.rootOperationStack=[];this.deferredRenderQueue=[];this.operationStackOffset=1;this.enforceOperationOrder=()=>{this.refreshFlipIndex();this.refreshFrameIndex()};this.isSpriteTop=e=>{const t=this.rootOperationStack.findIndex(({id:r})=>e===r);let i=1;if(this.rootOperationStack.find(r=>r.type==="frame")){i+=1}return t+i===this.rootOperationStack.length};this.setWatermarkOpacity=e=>{const t=this.sdk.getOperationsStack();const i=t.getByIdentifier("watermark");if(i){i.set({alpha:e})}};var i,r;this.assetProvider=e.assetProvider||new dm;let t;if(((i=e==null?void 0:e.watermark)==null?void 0:i.watermarkURI)&&typeof e.watermark.watermarkURI==="string"&&e.watermark.watermarkURI.slice(0,5)==="data:"){t=e.watermark.watermarkURI}else if(((r=e==null?void 0:e.watermark)==null?void 0:r.watermarkURI)&&typeof e.watermark.watermarkURI==="string"&&e.watermark.watermarkURI.trim()){t=On(e.watermark.watermarkURI)?e.watermark.watermarkURI:this.assetProvider.getPath(e.watermark.watermarkURI)}this.wrapper=new Qi({license:e.license,crossOrigin:e.crossOrigin,assets:{resolver:(o,n)=>{return this.resolveAssetForSDK(o,n)}},editor:{preferredRenderer:e.preferredRenderer,pixelRatio:1,clearColor:Kc(e.backgroundColor)},watermark:{...Kc(e.watermark),watermarkURI:t}});this.editor=this.wrapper.getEditor();this.sdk=this.editor.getSDK();this.sdk.setRenderMode("adapter");this.tempCanvas=document.createElement("canvas");this.sdk.setCanvas(this.tempCanvas);if(e.preferredRenderer==="webgl"){const o=document.createElement("canvas");const n=o.getContext("webgl")||o.getContext("experimental-webgl");this.maxTextureDimension=n.getParameter(n.MAX_TEXTURE_SIZE);ke(o)}else{this.maxTextureDimension=Infinity}}get configuration(){return this.config}get pesdk(){return this.sdk}get rootOperations(){return this.rootOperationStack}dispose(){ke(this.tempCanvas);this.rootContainer.dispose();this.pesdk.dispose();this.wrapper.dispose()}render(e){return new Promise(t=>{const i=()=>{return new Promise(r=>{const{canvas:o}=e;const n=e.getTransform();const a=this.outputContainer.getPivot();const l=e.getCanvasBounds();const u=e.quality;const{tempCanvas:c}=this;this.sdk.setTextureQuality(u);const h=this.sdk.getOutputDimensions();c.width=h.x;c.height=h.y;this.sdk.getRenderer().resizeTo(new pe(c.width,c.height));return this.sdk.render(true).then(()=>{const m=o.getContext("2d");m.clearRect(0,0,o.width,o.height);m.save();m.translate(-l.minX,-l.minY);m.translate(n.position.x,n.position.y);m.rotate(n.rotation);m.scale(n.scale.x,n.scale.y);m.translate(-a.x*c.width,-a.y*c.height);m.scale(1/e.quality,1/e.quality);m.drawImage(c,0,0);m.restore();t();this.deferredRenderQueue.shift();if(this.deferredRenderQueue.length){this.sdk.setAllOperationsToDirty();Promise.resolve(this.deferredRenderQueue[0]().then(r))}else{r()}})})};this.deferredRenderQueue.push(i);if(this.deferredRenderQueue.length===1){i()}})}createPreview(e){const t=new xm(e,this);this.previews.push(t);return t}async export(e=Ii.IMAGE,t=Vr.PNG,i=1,r=true){return new Promise(o=>{const n=()=>{return new Promise(a=>{return this.sdk.export(this.mapToRenderType(e),this.mapToImageFormat(t),i,r).then(l=>{o(l);this.deferredRenderQueue.shift();if(this.deferredRenderQueue.length){Promise.resolve(this.deferredRenderQueue[0]().then(a))}else{a()}})})};this.deferredRenderQueue.push(n);if(this.deferredRenderQueue.length===1){n()}})}getRootContainers(){return[this.rootContainer]}getOutputContainer(){return this.outputContainer}findContainerByID(e){if(e===this.rootContainer.getID()){return this.rootContainer}return this.rootOperationStack.find(t=>t.getID()===e)}findEffectByID(e){return this.rootOperationStack.find(t=>t.getID()===e)}addImage(e,t,i){if(this.rootContainer){throw new Error("A background image already exists - did you mean to use addSticker?")}const r=new kc(e,this);this.rootContainer=r;if(!this.outputContainer){const{width:o,height:n}=r.getBounds();const a={resolution:{width:o,height:n},flipHorizontally:false,flipVertically:false};const l=this.sdk.createOperation("output",{},false);const u=this.sdk.createOperation("flip",{},false);this.insertIntoOperationsStack(l,this.operationStackOffset-1);this.insertIntoOperationsStack(u,this.operationStackOffset);this.outputContainer=new Tc(a,l,u,this)}return r}addSticker(e,t,i){if(!t){throw new Error("This engine does not support adding stickers as root elements.")}this.ensureContainerIsRoot(t);const r=new Ec(e,this);this.addToStackAtIndex(r,i);return r}addStickerFromAssets(e,t,i){if(!t){throw new Error("This engine does not support adding stickers as root elements.")}this.ensureContainerIsRoot(t);return new Promise((r,o)=>{const n=new Image;n.onload=()=>{const a={image:n,opacity:1};const l=new Ec(a,this);this.addToStackAtIndex(l,i);r(l)};n.onerror=a=>{o(a)};n.crossOrigin=this.config.crossOrigin||null;n.src=this.assetProvider.getAssetSource("sticker",e)})}addText(e,t,i){if(!t){throw new Error("This engine does not support adding text as root elements.")}const r=this.assetProvider.getFontManager();if(!r.isFontLoaded(e.fontIdentifier||Oc)){throw new Error("Adding text synchronously only works if the required font is already loded! Consider using the asynchronous addTextWithFontLoading function instead!")}this.ensureContainerIsRoot(t);const o={text:"",fontIdentifier:Oc,fontSize:20,lineHeight:1,alignment:"center",textColor:[1,1,1],backgroundColor:[0,0,0,0],width:100,...e};const n=new er(o,this);this.addToStackAtIndex(n,i);return n}addTextWithFontLoading(e,t,i){if(!t){throw new Error("This engine does not support adding text as root elements.")}const r=this.assetProvider.getFontManager();const o=e.fontIdentifier||Oc;return new Promise((n,a)=>{r.loadFontWithIdentifier(o).then(()=>{this.ensureContainerIsRoot(t);const l={text:"",fontIdentifier:Oc,fontSize:20,lineHeight:1,alignment:"center",textColor:[1,1,1],backgroundColor:[0,0,0,0],width:100,...e};const u=new er(l,this);this.addToStackAtIndex(u,i);n(u)}).catch(a)})}async addTextDesignAsync(e="imgly_text_design_blocks",t,i,r){if(!i){throw new Error("This engine does not support adding TextDesign as a root element.")}const o={seed:Date.now(),padding:0,text:"",color:[0,0,0],inverted:false,width:100,...t};const n=this.wrapper.getTextDesignLayoutByID(e);if(!n){throw new Error(`The layout could not be loaded for the given id: ${e}`)}const a=n.getImagePaths().map(d=>{const f=d.split("/").pop()||"";return{path:d,fullPath:this.assetProvider.getAssetSource("textdesign",f)}});const l=this.wrapper.getTextDesignAssetManager();const u=this.wrapper.getTextDesignFontManager();const c=u.getVariationsByIdentifier();l.setFonts(c);await l.loadImages(a);n.onImagesLoaded();const h=Object.keys(c);const m=this.assetProvider.getFontManager();return m.loadFontsWithIdentifiers(h).then(()=>{this.ensureContainerIsRoot(i);const d=new to(o,n,this);this.addToStackAtIndex(d,r);return Promise.resolve(d)})}addDrawing(e,t,i){if(!t){throw new Error("This engine does not support DrawingContainers as root elements.")}this.ensureContainerIsRoot(t);const r=new Bh(e,this);this.addToStackAtIndex(r,i);return r}addGaussianBlur(e,t,i){this.ensureContainerIsRoot(t);const r=new Uh(e,this,this.sdk.createOperation("blur",{},false));this.addToStackAtIndex(r,i);return r}addRadialBlur(e,t,i){this.ensureContainerIsRoot(t);const r=new Vh(e,this,this.sdk.createOperation("radial-focus",{},false));this.addToStackAtIndex(r,i);return r}addMirroredBlur(e,t,i){this.ensureContainerIsRoot(t);const r=new Wh(e,this,this.sdk.createOperation("mirrored-focus",{},false));this.addToStackAtIndex(r,i);return r}addLinearBlur(e,t,i){this.ensureContainerIsRoot(t);const r=new Nh(e,this,this.sdk.createOperation("linear-focus",{},false));this.addToStackAtIndex(r,i);return r}addDuoToneFilter(e,t,i){throw new Error("Not supported! Use addDuoToneFilterFromAssets instead")}addDuoToneFilterFromAssets(e,t,i){this.ensureContainerIsRoot(t);const r=this.sdk.getOperationsStack();const o=r.getByIdentifier("filter");if(o&&o.getIdentifier()!==e){this.sdk.removeOperation(o)}const n=o||this.sdk.createOperation("filter",{identifier:e},false);return new Promise((a,l)=>{try{const u=this.assetProvider.getDuotoneFilterAsset(e);const c={colorIntensity:u.defaultIntensity||0};const h=new N.Operations.FilterOperation.Filters.DuoToneFilter({intensity:c.colorIntensity,lightColor:N.Color.fromHex(u.lightColor),darkColor:N.Color.fromHex(u.darkColor)});const m=new Mh(h,n,c,this);this.addToStackAtIndex(m,i);a(m)}catch(u){if(u){l(u)}}})}addLUTFilter(e,t,i){throw new Error("Not supported! Use addLUTFilterFromAssets instead")}addLUTFilterFromAssets(e,t,i){this.ensureContainerIsRoot(t);const r=this.sdk.getOperationsStack();const o=r.getByIdentifier("filter");if(o&&o.getIdentifier()!==e){this.sdk.removeOperation(o)}const n=o||this.sdk.createOperation("filter",{identifier:e},false);return this.getLutFilterImage(e).then(a=>{const l=this.assetProvider.getLUTFilterAsset(e);const u={horizontalTileCount:l.horizontalTileCount||5,verticalTileCount:l.verticalTileCount||5,intensity:l.defaultIntensity||1};const c=new N.Operations.FilterOperation.Filters.ThreeDLUTFilter({...u,image:a});const h={...u,lutImage:new Image};const m=new Gh(c,n,h,this);this.addToStackAtIndex(m,i);return m})}getLutFilterImage(e){return new Promise((t,i)=>{cm({src:this.assetProvider.getAssetSource("filter",e),crossOrigin:this.config.crossOrigin||null,key:"filter",resolve:t,reject:i})})}addAdjustments(e,t,i){this.ensureContainerIsRoot(t);const r=new Ph(e,this,this.sdk.createOperation("adjustments",{},false));this.addToStackAtIndex(r,i);return r}addOverlay(e,t,i){this.ensureContainerIsRoot(t);const r=new Rc(this.sdk.createOperation("overlay",{},false),e,this);this.addToStackAtIndex(r,i);return r}addOverlayFromAssets(e,t,i){this.ensureContainerIsRoot(t);return new Promise((r,o)=>{cm({src:this.assetProvider.getAssetSource("overlay",e),crossOrigin:this.config.crossOrigin||null,key:"overlay",resolve:n=>{const a=this.sdk.getOperationsStack();const l=a.getByIdentifier("overlay");if(l&&l.getIdentifier()!==e){a.remove(l)}const u=l||this.sdk.createOperation("overlay",{},false);const c={image:n,opacity:1,blendMode:re.NORMAL};const h=new Rc(u,c,this);this.addToStackAtIndex(h,i);r(h)},reject:o})})}addFrame(e,t,i){throw new Error("Not supported!")}async addFrameFromAssets(e,t,i){this.ensureContainerIsRoot(t);const r=this.assetProvider.getFrameAsset(e);if(!r){throw new Error(`The requested asset does not exist! ${e}`)}const o=new Lh(r,this);await o.load();const n=this.getOutputContainer().getBounds();const a=Math.min(n.width,n.height);const l=this.sdk.createOperation("frame",{},false);l.setFrame(o.getFrame());const u={opacity:1,tintColor:[1,1,1],tintable:false,width:Math.max(1,.1*a),imageGroups:o.getFrame().imageGroups};const c=new zh(l,u,this);this.addToStackAtIndex(c,i);return Promise.resolve(c)}removeEffect(e){if(!e.isValid()){return}const t=e;const i=t.getOperation();this.sdk.removeOperation(i);this.sdk.setAllOperationsToDirty();this.rootOperationStack.splice(e.getIndexInParent(),1)}removeContainer(e){if(!e.isValid()||e.type==="output"){return}const t=e;const i=t.getOperation();this.sdk.removeOperation(i);this.sdk.setAllOperationsToDirty();this.rootOperationStack.splice(e.getIndexInParent(),1)}refreshOutputIndex(){const e=this.sdk.getOperationsStack().getIndexByIdentifier("output");this.moveInOperationsStack(e,this.operationStackOffset-1)}refreshFlipIndex(){const e=this.sdk.getOperationsStack().getIndexByIdentifier("flip");const t=this.sdk.getOperationsStack().getStack().length-1;if(e!==t){this.moveInOperationsStack(e,t)}}refreshFrameIndex(){const e=this.sdk.getOperationsStack().getIndexByIdentifier("frame");const t=this.sdk.getOperationsStack().getStack().length-1;if(e!==-1&&e!==t){this.moveInOperationsStack(e,t)}}mapToRenderType(e){switch(e){case Ii.IMAGE:return N.RenderType.IMAGE;case Ii.DATA_URL:return N.RenderType.DATAURL;case Ii.BLOB:return N.RenderType.BLOB;case Ii.MSBLOB:return N.RenderType.MSBLOB;default:return N.RenderType.IMAGE}}mapToImageFormat(e){switch(e){case Vr.PNG:return N.ImageFormat.PNG;case Vr.JPEG:return N.ImageFormat.JPEG;default:return null}}mapBlendMode(e){switch(e){case Xe.NORMAL:return re.NORMAL;case Xe.OVERLAY:return re.OVERLAY;case Xe.HARD_LIGHT:return re.HARD_LIGHT;case Xe.SOFT_LIGHT:return re.SOFT_LIGHT;case Xe.MULTIPLY:return re.MULTIPLY;case Xe.DARKEN:return re.DARKEN;case Xe.LIGHTEN:return re.LIGHTEN;case Xe.SCREEN:return re.SCREEN;case Xe.COLOR_BURN:return re.COLOR_BURN;default:return re.NORMAL}}reverseMapBlendMode(e){switch(e){case re.NORMAL:return Xe.NORMAL;case re.OVERLAY:return Xe.OVERLAY;case re.HARD_LIGHT:return Xe.HARD_LIGHT;case re.SOFT_LIGHT:return Xe.SOFT_LIGHT;case re.MULTIPLY:return Xe.MULTIPLY;case re.DARKEN:return Xe.DARKEN;case re.LIGHTEN:return Xe.LIGHTEN;case re.SCREEN:return Xe.SCREEN;case re.COLOR_BURN:return Xe.COLOR_BURN;default:return Xe.NORMAL}}createSpriteOperation(){return this.sdk.createOperation("sprite",{},false)}moveIndex(e,t){const i=this.getSiblingIndex(e);if(i===-1){throw new Error("The item to be moved is not part of any stack.")}this.moveInStack(this.rootOperationStack,i,t);const r=this.operationStackOffset;this.moveInOperationsStack(i+r,t+r);this.enforceOperationOrder()}ensureContainerIsRoot(e){const t=e.getID();if(t!==this.rootContainer.getID()){throw new Error("This engine doesn't support adding this effect/container to anything other than the root image container")}}addToStackAtIndex(e,t){if(t&&t<0){throw new Error(`The given index may not be negative: ${t}`)}if(t===void 0){this.rootOperationStack.push(e)}else{this.rootOperationStack.splice(t,0,e)}const i=this.rootOperationStack.length-1;let r=t!==void 0?t:i;r+=this.operationStackOffset;if(Eg(e)){this.insertIntoOperationsStack(e.getOperation(),r)}else{this.insertIntoOperationsStack(e.getOperation(),r)}this.sdk.setAllOperationsToDirty()}insertIntoOperationsStack(e,t){const i=this.sdk.getOperationsStack().getStack();const r=i.length;const o=Math.max(Math.min(t,r),0);for(let n=r-1;n>=o;n-=1){const a=i[n];i[n+1]=a}i[o]=e;this.sdk.setAllOperationsToDirty();this.enforceOperationOrder()}moveInStack(e,t,i){const r=e.length;const o=Math.max(Math.min(t,r-1),0);const n=Math.max(Math.min(i,r-1),0);if(o===n){return}const a=e[o];if(o<n){for(let l=o+1;l<=n;l+=1){e[l-1]=e[l]}}else{for(let l=o-1;l>=n;l-=1){e[l+1]=e[l]}}e[n]=a}moveInOperationsStack(e,t){const i=this.sdk.getOperationsStack().getStack();const r=i.length;const o=Math.min(Math.max(0,e),r-1);const n=Math.min(Math.max(0,t),r-1);if(o===n){return}const a=i[o];if(o<n){for(let l=o+1;l<=n;l+=1){i[l-1]=i[l]}}else{for(let l=o-1;l>=n;l-=1){i[l+1]=i[l]}}i[n]=a;this.sdk.getOperationsStack().setAllToDirty()}getSiblingIndex(e){return e.getIndexInParent()}resolveAssetForSDK(e,t){t=t;switch(e){case"filter":return this.assetProvider.getAssetSource("filter",t.identifier);case"overlay":return this.assetProvider.getAssetSource("overlay",t.identifier);case"font":return this.assetProvider.getAssetSource("font",t.identifier);default:return""}return""}};var TC=class{constructor(e){this.isEmpty=false;this.isValid=false;this.isWhiteLabel=()=>this.isValid&&this.licenseChecker.isWhiteLabel();this.areCustomAssetsAllowed=()=>this.isEmpty||!this.isValid||this.licenseChecker.areCustomAssetsAllowed();if(e&&e.length!==0){this.licenseChecker=new N.LicenseChecker(e);this.isValid=this.licenseChecker.validate()}else if(e===""){this.isEmpty=true}}isToolAllowed(e){if(this.licenseChecker&&this.isValid&&e!==Ne.CUSTOM){return this.licenseChecker.isToolAllowed(e)}return true}};export{we as a,Ur as b,wS as c,ef as d,Qe as e,tD as f,Vc as g,yn as h,kS as i,jc as j,_D as k,wf as l,TS as m,RS as n,TD as o,Kc as p,YD as q,ke as r,Kf as s,Ya as t,bI as u,xI as v,vI as w,wI as x,SP as y,On as z,AP as A,FS as B,OS as C,Ye as D,Ne as E,ci as F,Bf as G,Mf as H,JD as I,tm as J,$D as K,Uf as L,ZD as M,Ii as N,Vr as O,Nf as P,QD as Q,st as R,qS as S,po as T,ek as U,tk as V,jr as W,im as X,ik as Y,Gf as Z,Wf as _,z as $,mi as aa,Hr as ba,rm as ca,rk as da,qr as ea,Pi as fa,Cn as ga,sk as ha,sm as ia,om as ja,nm as ka,Kr as la,ok as ma,mr as na,Ka as oa,nk as pa,re as qa,Ve as ra,Xr as sa,Xa as ta,ak as ua,Mt as va,Yr as wa,lk as xa,Vf as ya,jf as za,dr as Aa,Dn as Ba,uk as Ca,Jr as Da,ck as Ea,$r as Fa,kn as Ga,mk as Ha,Hf as Ia,qf as Ja,ho as Ka,fo as La,Jf as Ma,Ja as Na,FI as Oa,ne as Pa,KI as Qa,XI as Ra,RI as Sa,ZI as Ta,QI as Ua,vk as Va,tP as Wa,iP as Xa,wk as Ya,aP as Za,nl as _a,dm as $a,yg as ab,al as bb,Gk as cb,Lt as db,gm as eb,TB as fb,RB as gb,EB as hb,SB as ib,We as jb,N as kb,V as lb,Cg as mb,Dg as nb,kg as ob,Tg as pb,Pn as qb,vm as rb,WM as sb,Fc as tb,kC as ub,TC as vb};
/*
 * Based on https://github.com/exif-js/exif-js by Jacob Seidelin
 * Licensed under MIT
 * @license
 */
/*
 * Extracted from MinifyJpeg (Copyright (c) 2014 Hiroaki Matoba, MIT License):
 * https://github.com/hMatoba/MinifyJpeg
 * @license
 */
/*
 * http://paulirish.com/2011/requestanimationframe-for-smart-animating/
 * http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating
 * requestAnimationFrame polyfill by Erik Mller. fixes from Paul Irish and Tino Zijdel
 * MIT license
 * @license
 */
/*!
 *  Secure Hash Algorithm (SHA256)
 *  http://www.webtoolkit.info/
 *
 *  Original code by Angel Marin, Paul Johnston.
 */
/*!
 * Copyright (c) 2003-2005  Tom Wu
 * All Rights Reserved.
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS-IS" AND WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS, IMPLIED OR OTHERWISE, INCLUDING WITHOUT LIMITATION, ANY
 * WARRANTY OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.
 *
 * IN NO EVENT SHALL TOM WU BE LIABLE FOR ANY SPECIAL, INCIDENTAL,
 * INDIRECT OR CONSEQUENTIAL DAMAGES OF ANY KIND, OR ANY DAMAGES WHATSOEVER
 * RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER OR NOT ADVISED OF
 * THE POSSIBILITY OF DAMAGE, AND ON ANY THEORY OF LIABILITY, ARISING OUT
 * OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * In addition, the following condition applies:
 *
 * All redistributions must retain an intact copy of this copyright notice
 * and disclaimer.
 */
/*!
StackBlur - a fast almost Gaussian Blur For Canvas

Version:  0.5
Author:   Mario Klingemann
Contact:  mario@quasimondo.com
Website:  http://www.quasimondo.com/StackBlurForCanvas
Twitter:  @quasimondo

In case you find this class useful - especially in commercial projects -
I am not totally unhappy for a small donation to my PayPal account
mario@quasimondo.de

Or support me on flattr:
https://flattr.com/thing/72791/StackBlur-a-fast-almost-Gaussian-Blur-Effect-for-CanvasJavascript

Copyright (c) 2010 Mario Klingemann

Permission is hereby granted, free of charge, to any person
obtaining a copy of this software and associated documentation
files (the "Software"), to deal in the Software without
restriction, including without limitation the rights to use,
copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following
conditions:

The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
@license
*/
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
