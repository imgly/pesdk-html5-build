!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("photoeditorsdk"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["photoeditorsdk","react","react-dom"],e):"object"==typeof exports?exports.PhotoEditorReactUI=e(require("photoeditorsdk"),require("react"),require("react-dom")):t.PhotoEditorReactUI=e(t.PhotoEditorSDK,t.React,t.ReactDOM)}(this,function(t,e,o){return function(t){function e(n){if(o[n])return o[n].exports;var i=o[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var o={};return e.m=t,e.c=o,e.i=function(t){return t},e.d=function(t,e,o){Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var o=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=264)}([function(t,e){"use strict";e.__esModule=!0,e["default"]=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.ImageFormat=e.ColorMatrix=e.now=e.Log=e.cancelAnimationFrame=e.requestAnimationFrame=e.SDK=e.EXIF=e.ReactDOM=e.UniformType=e.OptionType=e.RenderType=e.Base64=e.Color=e.SharedState=e.Constants=e.EventEmitter=e.SDKUtils=e.Vector2=e.ReactBEM=e.BaseComponent=e.Classnames=e.BEM=e.React=e.Utils=e.Promise=void 0;var i=o(36),r=n(i),a=o(59),s=n(a),l=o(263),c=n(l),u=o(77),p=n(u),d=o(67),h=n(d),f=o(71),m=n(f),_=o(97),g=n(_),v=o(201),y=n(v),b=o(176),E=n(b),S=o(200),M=n(S),C=o(203),B=o(74),R=n(B),x=r["default"].Base64,w=r["default"].Color,k=r["default"].Math.ColorMatrix,O=r["default"].EventEmitter,D=r["default"].EXIF,P=r["default"].OptionType,T=r["default"].Promise,A=r["default"].Utils,F=r["default"].RenderType,z=r["default"].ImageFormat,I=r["default"],j=r["default"].UniformType,U=r["default"].Math.Vector2,V="undefined"!=typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):o(89);e.Promise=T,e.Utils=y["default"],e.React=s["default"],e.BEM=h["default"],e.Classnames=p["default"],e.BaseComponent=g["default"],e.ReactBEM=m["default"],e.Vector2=U,e.SDKUtils=A,e.EventEmitter=O,e.Constants=E["default"],e.SharedState=M["default"],e.Color=w,e.Base64=x,e.RenderType=F,e.OptionType=P,e.UniformType=j,e.ReactDOM=c["default"],e.EXIF=D,e.SDK=I,e.requestAnimationFrame=C.requestAnimationFrame,e.cancelAnimationFrame=C.cancelAnimationFrame,e.Log=R["default"],e.now=V,e.ColorMatrix=k,e.ImageFormat=z},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var i=o(209),r=n(i),a=o(208),s=n(a),l=o(32),c=n(l);e["default"]=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+("undefined"==typeof e?"undefined":(0,c["default"])(e)));t.prototype=(0,s["default"])(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(r["default"]?(0,r["default"])(t,e):t.__proto__=e)}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var i=o(32),r=n(i);e["default"]=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==("undefined"==typeof e?"undefined":(0,r["default"])(e))&&"function"!=typeof e?t:e}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var i=o(75),r=n(i);e["default"]=function(t,e,o){return e in t?(0,r["default"])(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(96),d=n(p),h=o(150),f=n(h),m=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._hasBackButton=!0,a._hasDoneButton=!1,a._backButtonClicked=!1,a._bindAll("_onBackClick","_onDoneClick"),a}return(0,c["default"])(e,t),e.prototype._onBackClick=function(t){this._backButtonClicked=!0,this.props.onSwitchControls("back")},e.prototype._onDoneClick=function(t){this.props.onSwitchControls("home")},e.prototype.renderControls=function(){return null},e.prototype.renderOverlayControls=function(){return null},e.prototype.renderWithBEM=function(){var t=this.props.options&&this.props.options.forcedControl,e=this._hasBackButton&&!t?u.ReactBEM.createElement(d["default"],{onClick:this._onBackClick}):null,o=this._hasDoneButton||t?u.ReactBEM.createElement(f["default"],{onClick:this._onDoneClick}):null;return u.ReactBEM.createElement("div",{bem:"$b:controls",ref:"root"},this.renderOverlayControls(),u.ReactBEM.createElement("div",{bem:"e:table"},e,this.renderControls(),o))},e}(u.BaseComponent);e["default"]=m,m.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=function(){function t(){(0,r["default"])(this,t)}return t.prototype.getInitialSharedState=function(){return{}},t.prototype.isAvailable=function(t){return!1},t.getPreloadAssets=function(){return[]},t}();a.topBarControlsComponent=null,a.controlsComponent=null,a.canvasControlsComponent=null,a.identifier=null,a.iconPath=null,a.languageKey=null,a.defaultOptions={},e["default"]=a},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(76),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=function(t){function e(o,n,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,s["default"])(this,e);var a=(0,c["default"])(this,t.call(this));return a.type=o,a.title=n,a.text=i,a.overlay=r,a.data=null,a}return(0,p["default"])(e,t),e.prototype.setData=function(t){this.data=t,this.emit("update")},e.prototype.close=function(){this.emit("close")},e}(d.EventEmitter),f=function(t){function e(){(0,s["default"])(this,e);var o=(0,c["default"])(this,t.call(this));return o._modals=[],o}return(0,p["default"])(e,t),e.prototype.displayLoading=function(t){var e=new h("loading",null,t);return this.addModal(e),e},e.prototype.displayProgress=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=new h("progress",null,t);return o.setData({progress:e}),this.addModal(o),o},e.prototype.displayWarning=function(t,e){var o=new h("warning",t,e);return this.addModal(o),o},e.prototype.displayError=function(t,e){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=new h("error",t,e,o);return this.addModal(n),n},e.prototype.addModal=function(t){var e=this;this._modals.push(t),t.on("close",function(){e.removeModal(t)}),t.on("update",function(){e.emit("update")}),this.emit("update")},e.prototype.removeModal=function(t){var e=this._modals.indexOf(t);this._modals.splice(e,1),this.emit("update")},e.prototype.getModals=function(){return this._modals},(0,r["default"])(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}(d.EventEmitter);e["default"]=f},function(t,e){var o=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=o)},function(t,e,o){var n=o(52)("wks"),i=o(34),r=o(12).Symbol,a="function"==typeof r,s=t.exports=function(t){return n[t]||(n[t]=a&&r[t]||(a?r:i)("Symbol."+t))};s.store=n},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(11),d=n(p),h=25,f=12,m=function(t){function e(){(0,r["default"])(this,e);var o=(0,s["default"])(this,t.call(this));return o._needsStyleFixes=!0,o._isDragging=!1,o._bindAll("_onButtonDragStart","_onButtonDrag","_onButtonDragStop","_onBarDragStart","_onBarDrag","_onBarDragStop","_onListScroll"),o.state={buttonSize:0,buttonPosition:0,buttonVisible:!1},o}return(0,c["default"])(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this.update()},e.prototype.fixStyles=function(){u.Utils.isMobile()||this._updateListSize()},e.prototype._onListScroll=function(){if(!this._isDragging){var t=this._getDirection(),o=void 0,n=void 0,i=void 0;t===e.HORIZONTAL?(o=this._list.scrollWidth-this._list.offsetWidth,n=this._list.scrollLeft,i=this._node.offsetWidth-this.state.buttonSize):t===e.VERTICAL&&(o=this._list.scrollHeight-this._list.offsetHeight,n=this._list.scrollTop,i=this._node.offsetHeight-this.state.buttonSize);var r=n/o;this.setState({buttonPosition:i*r})}},e.prototype._onButtonDragStart=function(t){this._isDragging=!0,this._initialButtonPosition=this.state.buttonPosition||0},e.prototype._onButtonDrag=function(t){var o=this._getDirection(),n=void 0;o===e.HORIZONTAL?n=this._initialButtonPosition+t.x:o===e.VERTICAL&&(n=this._initialButtonPosition+t.y),this._setButtonPosition(n)},e.prototype._onButtonDragStop=function(){this._isDragging=!1},e.prototype._onBarDragStart=function(t){var o=u.Utils.getEventPosition(t);this._initialPosition=o.clone();var n=this._node.getBoundingClientRect(),i=new u.Vector2(n.left,n.top),r=o.clone().subtract(i),a=this._getDirection();a===e.HORIZONTAL?this._setButtonPosition(r.x-this.state.buttonSize/2):a===e.VERTICAL&&this._setButtonPosition(r.y-this.state.buttonSize/2),document.addEventListener("mousemove",this._onBarDrag),document.addEventListener("touchmove",this._onBarDrag),document.addEventListener("mouseup",this._onBarDragStop),document.addEventListener("touchend",this._onBarDragStop)},e.prototype._onBarDrag=function(t){var o=u.Utils.getEventPosition(t),n=this._node.getBoundingClientRect(),i=new u.Vector2(n.left,n.top),r=o.clone().subtract(i),a=this._getDirection();a===e.HORIZONTAL?this._setButtonPosition(r.x-this.state.buttonSize/2):a===e.VERTICAL&&this._setButtonPosition(r.y-this.state.buttonSize/2)},e.prototype._onBarDragStop=function(){document.removeEventListener("mousemove",this._onBarDrag),document.removeEventListener("touchmove",this._onBarDrag),document.removeEventListener("mouseup",this._onBarDragStop),document.removeEventListener("touchend",this._onBarDragStop)},e.prototype._setButtonPosition=function(t){var o=this._getDirection(),n=void 0,i=void 0;o===e.HORIZONTAL?(n=this._node.offsetWidth-this.state.buttonSize,i=this._list.scrollWidth-this._list.offsetWidth):o===e.VERTICAL&&(n=this._node.offsetHeight-this.state.buttonSize,i=this._list.scrollHeight-this._list.offsetHeight),t=Math.max(0,t),t=Math.min(t,n),this.setState({buttonPosition:t});var r=t/n,a=i*r;o===e.HORIZONTAL?this._list.scrollLeft=a:o===e.VERTICAL&&(this._list.scrollTop=a)},e.prototype._updateButtonSize=function(t){var o=0,n=!1,i=void 0,r=void 0,a=this._getDirection();a===e.HORIZONTAL?(i=this._list.clientWidth,r=this._list.scrollWidth):a===e.VERTICAL&&(i=this._list.offsetHeight,r=this._list.scrollHeight),o=i/r*i,n=r>i,this.setState({buttonSize:o,buttonVisible:n},t)},e.prototype._updateListSize=function(){if(this._list){var t=this._getDirection();if(t===e.HORIZONTAL){this._list.style.height="";var o=this._getFullListDimensions();this._listSize=o.y}else if(t===e.VERTICAL){this._list.style.width="";var n=this._getFullListDimensions();this._listSize=n.x}}},e.prototype._getFullListDimensions=function(){var t=this._list.getBoundingClientRect();return new u.Vector2(t.width,t.height)},e.prototype.update=function(){var t=this;if(!u.Utils.isMobile()){var o=this.refs,n=o.root,i=o.list;this._node=n,this._list=i;var r=this._getDirection();this._updateButtonSize(function(){t._listSize||t._updateListSize();var o=t._listSize;t.state.buttonVisible&&(o+=2*h),r===e.HORIZONTAL?(t._list.style.height=o+"px",t._node.style.top=t._listSize-f+"px",t._node.style.width=t._list.offsetWidth+"px"):r===e.VERTICAL&&(t._list.style.width=o+"px",t._node.style.left=t._listSize-f+"px",t._node.style.height=t._list.offsetHeight+"px")}),this._list.addEventListener("scroll",this._onListScroll)}},e.prototype._getDirection=function(){return this.props.direction||"horizontal"},e.prototype._getButtonStyle=function(){var t=this._getDirection();return"horizontal"===t?{left:this.state.buttonPosition,width:this.state.buttonSize}:{top:this.state.buttonPosition,height:this.state.buttonSize}},e.prototype.getList=function(){return this.refs.list},e.prototype.getRoot=function(){return this.refs.root},e.prototype.renderWithBEM=function(){if(u.Utils.isMobile())return this.props.children;var t=this._getButtonStyle(),e={display:this.state.buttonVisible?"block":"none"},o=u.React.cloneElement(this.props.children,{ref:"list"});return u.ReactBEM.createElement("div",null,o,u.ReactBEM.createElement("div",{bem:"$b:scrollbar m:"+(this.props.direction||"horizontal")+" m:"+(this.state.buttonVisible?"visible":"invisible"),ref:"root",style:e,onMouseDown:this._onBarDragStart,onTouchStart:this._onBarDragStart},u.ReactBEM.createElement(d["default"],{onStart:this._onButtonDragStart,onDrag:this._onButtonDrag,onStop:this._onButtonDragStop},u.ReactBEM.createElement("div",{bem:"e:bar",style:t,onMouseDown:this._onButtonDown}))))},e}(u.BaseComponent);e["default"]=m,m.HORIZONTAL="horizontal",m.VERTICAL="vertical",m.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onDragStart","_onDragMove","_onDragEnd"),a}return(0,c["default"])(e,t),e.prototype._onDragStart=function(t){if(!this.props.disabled){t.preventDefault(),t.stopPropagation(),this._initialMousePosition=u.Utils.getEventPosition(t),document.addEventListener("mousemove",this._onDragMove),document.addEventListener("touchmove",this._onDragMove),document.addEventListener("mouseup",this._onDragEnd),document.addEventListener("touchend",this._onDragEnd);var e=this.refs.element,o=e.getBoundingClientRect(),n=new u.Vector2(o.left,o.top),i=this._initialMousePosition.clone().subtract(n);this.props.onStart&&this.props.onStart(i,t)}},e.prototype._onDragMove=function(t){t.preventDefault(),t.stopPropagation();var e=u.Utils.getEventPosition(t);if(e){var o=e.clone().subtract(this._initialMousePosition);this.props.onDrag&&this.props.onDrag(o,t)}},e.prototype._onDragEnd=function(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),this._onDragMove(t),document.removeEventListener("mousemove",this._onDragMove),document.removeEventListener("touchmove",this._onDragMove),document.removeEventListener("mouseup",this._onDragEnd),document.removeEventListener("touchend",this._onDragEnd),this.props.onStop&&this.props.onStop(t)},e.prototype.render=function(){if(!this.props.children||this.props.children instanceof Array)throw new Error("DraggableComponent expects exactly one child.");return u.React.cloneElement(this.props.children,{onMouseDown:this._onDragStart,onTouchStart:this._onDragStart,ref:"element"})},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e){var o=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=o)},function(t,e,o){var n=o(15),i=o(80),r=o(55),a=Object.defineProperty;e.f=o(16)?Object.defineProperty:function(t,e,o){if(n(t),e=r(e,!0),n(o),i)try{return a(t,e,o)}catch(s){}if("get"in o||"set"in o)throw TypeError("Accessors not supported!");return"value"in o&&(t[e]=o.value),t}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(25),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=o(11),f=n(h),m=function(t){function e(){(0,s["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var r=(0,c["default"])(this,t.call.apply(t,[this].concat(n)));return r._bindAll("_onKnobDragStart","_onKnobDrag","_onKnobDragStop","_onBarDragStart","_onBarDrag","_onBarDragStop","_onMiddleDotClick"),r.state={value:r.props.value||0,sliderPosition:0,foregroundLeft:0,foregroundWidth:0},r}return(0,p["default"])(e,t),e.prototype.componentDidMount=function(){this._setValue(this.state.value,!1)},e.prototype.componentWillReceiveProps=function(t){t.value!==this.state.value&&this._setValue(t.value,!1)},e.prototype._onMiddleDotClick=function(){this._previousValue=this.state.value;var t=this.props.minValue+(this.props.maxValue-this.props.minValue)/2;this._setValue(t,!0,!0)},e.prototype._onKnobDragStart=function(t){this._previousValue=this.state.value,this._initialSliderPosition=this.state.sliderPosition,this._initialPosition=t},e.prototype._onKnobDrag=function(t){var e=this.refs.bar,o=e.offsetWidth,n=this._initialSliderPosition+t.x;n=Math.max(0,Math.min(n,o));var i=n/o,r=this.props.minValue+(this.props.maxValue-this.props.minValue)*i;this._setValue(r)},e.prototype._onKnobDragStop=function(){this._setValue(this.state.value,!0,!0)},e.prototype._onBarDragStart=function(t){this._previousValue=this.state.value,this._initialPosition=t.clone();var e=this.refs.bar,o=e.offsetWidth,n=t.x/o,i=this.props.minValue+(this.props.maxValue-this.props.minValue)*n;this._setValue(i)},e.prototype._onBarDrag=function(t){var e=this._initialPosition.clone().add(t),o=this.refs.bar,n=o.offsetWidth,i=e.x/n,r=this.props.minValue+(this.props.maxValue-this.props.minValue)*i;r=Math.max(this.props.minValue,Math.min(this.props.maxValue,r)),this._setValue(r)},e.prototype._onBarDragStop=function(){this._setValue(this.state.value,!0,!0)},e.prototype._getKnobStyle=function(){return{left:this.state.sliderPosition}},e.prototype._getForegroundStyle=function(){return{left:this.state.foregroundLeft,width:this.state.foregroundWidth}},e.prototype._displayMiddleDot=function(){return this.props.middleDot!==!1},e.prototype._setValue=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t=Math.round(t);var n=this.props,i=n.minValue,r=n.maxValue,a=(t-i)/(r-i),s=this.refs.bar,l=s.offsetWidth,c=l*a,u=a*l,p=0;this._displayMiddleDot()&&(u=Math.abs(a-.5)*l,p=a<.5?.5*l-u:"50%"),this.setState({value:t,sliderPosition:c,foregroundWidth:u,foregroundLeft:p}),e&&this.props.onChange&&this.props.onChange(t,this._previousValue,o)},e.prototype._buildValue=function(t){return t%1!==0&&(t=t.toFixed(2)),this.props.positiveValuePrefix&&t>=0&&(t=""+this.props.positiveValuePrefix+t),this.props.valueUnit&&(t+=this.props.valueUnit),t},e.prototype.renderWithBEM=function(){var t=null;this._displayMiddleDot()&&(t=d.ReactBEM.createElement("div",{bem:"e:middleDot",onClick:this._onMiddleDotClick}));var e={style:this._getForegroundStyle()},o="$b:slider"+(this.props.style?" m:"+this.props.style:"");return d.ReactBEM.createElement("div",{bem:o},d.ReactBEM.createElement("div",{bem:"$e:bar",ref:"bar"},d.ReactBEM.createElement(f["default"],{onStart:this._onBarDragStart,onDrag:this._onBarDrag,onStop:this._onBarDragStop},d.ReactBEM.createElement("div",null,d.ReactBEM.createElement("div",{bem:"$e:background"}),d.ReactBEM.createElement("div",(0,r["default"])({bem:"$e:foreground"},e)),d.ReactBEM.createElement(f["default"],{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag,onStop:this._onKnobDragStop},d.ReactBEM.createElement("div",{bem:"e:knob b:knob m:slider",style:this._getKnobStyle()})))),t),d.ReactBEM.createElement("div",{bem:"$e:labels"},d.ReactBEM.createElement("div",{bem:"e:label m:lowerBoundary"},this._buildValue(this.props.minValue)),d.ReactBEM.createElement("div",{bem:"e:label m:value"},this.props.label," ",this._buildValue(this.state.value)),d.ReactBEM.createElement("div",{bem:"e:label m:upperBoundary"},this._buildValue(this.props.maxValue))))},e}(d.BaseComponent);e["default"]=m,m.contextTypes=d.BaseComponent.contextTypes},function(t,e,o){var n=o(27);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e,o){t.exports=!o(26)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,o){var n=o(12),i=o(8),r=o(44),a=o(22),s="prototype",l=function(t,e,o){var c,u,p,d=t&l.F,h=t&l.G,f=t&l.S,m=t&l.P,_=t&l.B,g=t&l.W,v=h?i:i[e]||(i[e]={}),y=v[s],b=h?n:f?n[e]:(n[e]||{})[s];h&&(o=e);for(c in o)u=!d&&b&&void 0!==b[c],u&&c in v||(p=u?b[c]:o[c],v[c]=h&&"function"!=typeof b[c]?o[c]:_&&u?r(p,n):g&&b[c]==p?function(t){var e=function(e,o,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,o)}return new t(e,o,n)}return t.apply(this,arguments)};return e[s]=t[s],e}(p):m&&"function"==typeof p?r(Function.call,p):p,m&&((v.virtual||(v.virtual={}))[c]=p,t&l.R&&y&&!y[c]&&a(y,c,p)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},function(t,e){var o={}.hasOwnProperty;t.exports=function(t,e){return o.call(t,e)}},function(t,e,o){var n=o(81),i=o(45);t.exports=function(t){return n(i(t))}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(14),d=n(p),h=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onSliderValueChange"),a.state={value:a.props.value},a}return(0,c["default"])(e,t),e.prototype.componentWillReceiveProps=function(t){t.value!==this.state.value&&(this.state.value=t.value)},e.prototype._onSliderValueChange=function(t){this.props.onChange&&this.props.onChange(t),this.setState({value:t})},e.prototype._renderSlider=function(){var t=u.SDKUtils.defaults(this.props,{style:"",middleDot:!1,minValue:1,maxValue:100,label:"Label",onChange:this._onSliderValueChange,value:this.state.value});return u.ReactBEM.createElement(d["default"],t)},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("div",{bem:"$b:controls e:overlay m:large m:dark"},this._renderSlider())},e}(u.BaseComponent);e["default"]=h,h.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(151),d=n(p),h=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype._renderHeader=function(){return this.context.options.showHeader?u.ReactBEM.createElement(d["default"],null):null},e.prototype._renderScreen=function(){return u.ReactBEM.createElement("div",null)},e.prototype.renderWithBEM=function(){var t="b:screen";return this.context.options.showHeader||(t+=" m:noHeader"),u.ReactBEM.createElement("div",{bem:t,className:this.props.visible?null:"is-hidden"},this._renderHeader(),this._renderScreen())},e}(u.BaseComponent);e["default"]=h,h.propTypes={editor:u.React.PropTypes.any},h.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){var n=o(13),i=o(29);t.exports=o(16)?function(t,e,o){return n.f(t,e,i(1,o))}:function(t,e,o){return t[e]=o,t}},function(t,e){t.exports={}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onCanvasZoomDone"),a}return(0,c["default"])(e,t),e.prototype._performHitTest=function(t){var e=this.refs.container,o=e.getBoundingClientRect(),n=new u.Vector2(o.left,o.top),i=t.subtract(n),r=this.context.editor,a=r.controls.getAvailable();for(var s in a){var l=a[s],c=l.clickAtPosition&&l.clickAtPosition(i,r);if(c)return c.selectedSprite===this.getSharedState("selectedSprite")||(this.props.onSwitchControls(l,c),!0)}return!1},e.prototype._onCanvasZoomDone=function(){this.forceUpdate()},e.prototype._bindEvents=function(){t.prototype._bindEvents.call(this),this.context.mediator.on(u.Constants.EVENTS.ZOOM_DONE,this._onCanvasZoomDone)},e.prototype._unbindEvents=function(){t.prototype._unbindEvents.call(this),this.context.mediator.off(u.Constants.EVENTS.ZOOM_DONE,this._onCanvasZoomDone)},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var i=o(207),r=n(i);e["default"]=r["default"]||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t}},function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,o){var n=o(85),i=o(46);t.exports=Object.keys||function(t){return n(t,i)}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(25),r=n(i),a=o(4),s=n(a),l=o(0),c=n(l),u=o(3),p=n(u),d=o(2),h=n(d),f=o(1),m=o(139),_=n(m),g=o(138),v=n(g),y=o(137),b=n(y),E=o(24),S=n(E),M=f.SDK.Operations.SpriteOperation,C=M.Sticker,B=M.Text,R=M.Brush,x=function(t){function e(){var o;(0,c["default"])(this,e);for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];var a=(0,p["default"])(this,t.call.apply(t,[this].concat(i)));return a._bindAll("_onCanvasClick","_onSpriteDragStart","_onSpriteDragStop","_onOperationUpdated","_onOperationRemoved","_onSpriteFlip","_onSpriteTakeToFront","_onSpriteRemove"),a._canvasClickDisabled=!1,a._events=(o={},(0,s["default"])(o,f.Constants.EVENTS.OPERATION_UPDATED,a._onOperationUpdated),(0,s["default"])(o,f.Constants.EVENTS.OPERATION_REMOVED,a._onOperationRemoved),o),a}return(0,h["default"])(e,t),e.prototype._onOperationRemoved=function(t){var e=this.getSharedState("selectedSprite");if(t===this.getSharedState("operation")&&e){var o=this.context.editor,n=o.operations.getOrCreate("sprite",{sprites:[e],enabled:!1});this.setSharedState({operation:n,operationExistedBefore:!1,initialOptions:{}})}},e.prototype._onOperationUpdated=function(t){var e=this.getSharedState("selectedSprite");if(t===this.getSharedState("operation")&&e){var o=t.getSprites();o.indexOf(e)===-1&&o.push(e),this.forceUpdate()}},e.prototype._onItemBlur=function(){},e.prototype._onCanvasClick=function(t){if(!this._canvasClickDisabled){var e=this._performHitTest(f.Utils.getEventPosition(t));e||(this.getSharedState("selectedSprite")&&this._onItemBlur(),this.props.onSwitchControls("home"))}},e.prototype._onSpriteFlip=function(t){var e=this.getSharedState("selectedSprite");switch(t){case"h":e.setFlipHorizontally(!e.getFlipHorizontally());break;case"v":e.setFlipVertically(!e.getFlipVertically())}},e.prototype._onSpriteTakeToFront=function(t){var e=this.getSharedState("operation");e.takeSpriteToFront(this.getSharedState("selectedSprite")),this.forceSharedUpdate()},e.prototype._onSpriteRemove=function(){var t=this.getSharedState("operation"),e=this.getSharedState("selectedSprite");t.removeSprite(e),e.dispose(),this.setSharedState({selectedSprite:null})},e.prototype._onSpriteDragStart=function(){this._canvasClickDisabled=!0},e.prototype._onSpriteDragStop=function(){var t=this;setTimeout(function(){t._canvasClickDisabled=!1},100)},e.prototype._getContainerStyle=function(){var t=this.context.editor,e=t.getCanvasDimensions(),o=t.getOutputDimensions(),n=e.clone().divide(2).subtract(o.clone().divide(2)),i=n.x,r=n.y;return{left:i,top:r,width:o.x,height:o.y}},e.prototype._getContainerProps=function(){return{}},e.prototype._getInnerContainerProps=function(){return{style:this._getContainerStyle(),onClick:this._onCanvasClick}},e.prototype._renderSpriteItems=function(){var t=this,e=this.getSharedState("operation"),o=e.getSprites(),n=this.getSharedState("selectedSprite");return o.map(function(o){var i=o===n,r=null;return o instanceof B?r=_["default"]:o instanceof C?r=v["default"]:o instanceof R&&(r=b["default"]),f.ReactBEM.createElement(r,{operation:e,sharedState:t.props.sharedState,sprite:o,selected:i,onDragStart:t._onSpriteDragStart,onDragStop:t._onSpriteDragStop,onRemove:t._onSpriteRemove.bind(t,o),options:t.props.options,ref:"sprite-"+o.getId()})})},e.prototype._renderOverlayControls=function(){return null},e.prototype.renderWithBEM=function(){return f.ReactBEM.createElement("div",(0,r["default"])({bem:"$b:canvasControls e:container m:full",ref:"container"},this._getContainerProps()),f.ReactBEM.createElement("div",(0,r["default"])({bem:"b:canvasControls e:innerContainer",ref:"innerContainer"},this._getInnerContainerProps()),f.ReactBEM.createElement("div",{bem:"$b:spritesCanvasControls",ref:"container"},this._renderSpriteItems(),this._renderOverlayControls())))},e}(S["default"]);e["default"]=x,x.contextTypes=S["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.renderContent=function(){return this.props.children},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("div",{bem:"$b:topBar e:row"},u.ReactBEM.createElement("div",{bem:"e:cell"},this.renderContent()))},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var i=o(211),r=n(i),a=o(210),s=n(a),l="function"==typeof s["default"]&&"symbol"==typeof r["default"]?function(t){return typeof t}:function(t){return t&&"function"==typeof s["default"]&&t.constructor===s["default"]&&t!==s["default"].prototype?"symbol":typeof t};e["default"]="function"==typeof s["default"]&&"symbol"===l(r["default"])?function(t){return"undefined"==typeof t?"undefined":l(t)}:function(t){return t&&"function"==typeof s["default"]&&t.constructor===s["default"]&&t!==s["default"].prototype?"symbol":"undefined"==typeof t?"undefined":l(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e){var o=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++o+n).toString(36))}},function(t,e,o){"use strict";var n=o(242)(!0);o(82)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,o=this._i;return o>=e.length?{value:void 0,done:!0}:(t=n(e,o),this._i+=t.length,{value:t,done:!1})})},function(e,o){e.exports=t},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(4),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=o(102),f=n(h),m=function(t){function e(){(0,s["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,c["default"])(this,t.call.apply(t,[this].concat(n)));return a._value=a.props.initialValue.clone(),a._bindAll("_onButtonClick","_onValueChange","_onColorPickerOpen","_onColorPickerClose"),a._events=(0,r["default"])({},d.Constants.EVENTS.COLORPICKER_OPEN,a._onColorPickerOpen),a.state={overlayVisible:!1},a._transparentPatternCanvas=d.Utils.createTransparentPatternCanvas(),a}return(0,p["default"])(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this._renderColor();
},e.prototype.componentDidUpdate=function(){this._renderColor()},e.prototype._onColorPickerOpen=function(t){t!==this&&this.setState({overlayVisible:!1})},e.prototype._onColorPickerClose=function(){this.setState({overlayVisible:!1})},e.prototype._onButtonClick=function(t){t.preventDefault(),t.stopPropagation(),this.state.overlayVisible||this._emitEvent(d.Constants.EVENTS.COLORPICKER_OPEN,this),this.setState({overlayVisible:!this.state.overlayVisible})},e.prototype._onValueChange=function(t){this._value=t,this._renderColor(),this.forceUpdate(),this.props.onChange&&this.props.onChange(t)},e.prototype._renderColor=function(){var t=this.refs.canvas,e=t.getContext("2d");t.width=t.offsetWidth,t.height=t.offsetHeight;var o=e.createPattern(this._transparentPatternCanvas,"repeat");e.fillStyle=o,e.fillRect(0,0,t.width,t.height),e.fillStyle=this._value.toRGBA(),e.fillRect(0,0,t.width,t.height)},e.prototype.renderWithBEM=function(){var t=null;this.state.overlayVisible&&(t=d.ReactBEM.createElement(f["default"],{initialValue:this._value,onChange:this._onValueChange,onClose:this._onColorPickerClose,alpha:this.props.alpha}));var e=this.state.overlayVisible?"is-active":null;return d.ReactBEM.createElement("bem",{specifier:"$b:controls"},d.ReactBEM.createElement("div",{bem:"$b:colorPicker",className:e,onClick:this._onButtonClick},d.ReactBEM.createElement("canvas",{bem:"e:preview",ref:"canvas"}),d.ReactBEM.createElement("div",{bem:"e:label"},this.props.label||this._t("generic.color")),t))},e}(d.BaseComponent);e["default"]=m,m.contextTypes=d.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onItemDragStart","_onItemDragStop","_onItemDrag","_onSpriteUpdate"),a}return(0,c["default"])(e,t),e.prototype._getAbsoluteSpritePosition=function(){var t=this.context.editor,e=t.getOutputDimensions();return this.props.sprite.getPosition().clone().multiply(e)},e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this.props.sprite.on("update",this._onSpriteUpdate)},e.prototype.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this),this.props.sprite.off("update",this._onSpriteUpdate)},e.prototype.componentWillReceiveProps=function(t){this.props.sprite.off("update",this._onSpriteUpdate),t.sprite.on("update",this._onSpriteUpdate)},e.prototype._onSpriteUpdate=function(){this.forceUpdate()},e.prototype._onItemDragStart=function(){var t=this.props.sprite;this._initialPosition=t.getPosition(),this.props.onDragStart&&this.props.onDragStart()},e.prototype._onItemDrag=function(t){var e=this.props.sprite,o=this.context.editor,n=o.getOutputDimensions(),i=this._initialPosition.clone().add(t.divide(n));e.setPosition(i)},e.prototype._onItemDragStop=function(){this.props.onDragStop&&this.props.onDragStop()},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onClick"),a}return(0,c["default"])(e,t),e.prototype._onClick=function(t){this.props.onClick&&this.props.onClick()},e.prototype._renderContent=function(){return null},e.prototype.renderWithBEM=function(){var t="$e:row m:"+this._modifier;return this.props.totalRows&&(t+=" m:row-"+this.props.totalRows),u.ReactBEM.createElement("bem",{specifier:"b:splashScreen"},u.ReactBEM.createElement("div",{bem:t},this._renderContent()))},e}(u.BaseComponent);e["default"]=p,p.propTypes={onClick:u.React.PropTypes.func},p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(184),d=n(p),h=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onNewFile"),a}return(0,c["default"])(e,t),e.prototype.componentDidMount=function(){this._fileLoader=new d["default"](this.refs.fileInput),this._fileLoader.on("file",this._onNewFile)},e.prototype.componentWillUnmount=function(){this._fileLoader.off("file",this._onNewFile),this._fileLoader.dispose(),this._fileLoader=null},e.prototype._onNewFile=function(t){this.props.onNewFile&&this.props.onNewFile(t)},e.prototype.open=function(){this._fileLoader.open()},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("input",{type:"file",bem:"b:hiddenFileInput",ref:"fileInput"})},e}(u.BaseComponent);e["default"]=h,h.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.renderWithBEM=function(){var t="$e:button";this.props.style&&(t+=" m:"+this.props.style),this.props.icon&&(t+=" m:withIcon");var e=null;return this.props.icon&&(e=u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath(this.props.icon,!0)})),u.ReactBEM.createElement("bem",{specifier:"$b:topBar"},u.ReactBEM.createElement("div",{bem:t,onClick:this.props.onClick},e,u.ReactBEM.createElement("div",{bem:"e:label"},this.props.label||"Button")))},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(1),s=function(){function t(e){(0,r["default"])(this,t),this._options=e,this._categoriesById={},this._categories=[{name:"retro",filters:[a.SDK.Filters.CelsiusFilter,a.SDK.Filters.ChestFilter,a.SDK.Filters.FixieFilter,a.SDK.Filters.LeninFilter,a.SDK.Filters.PolaFilter,a.SDK.Filters.Pola669Filter,a.SDK.Filters.K1Filter,a.SDK.Filters.K2Filter,a.SDK.Filters.K6Filter,a.SDK.Filters.KDynamicFilter]},{name:"bw",filters:[a.SDK.Filters.BWFilter,a.SDK.Filters.BWHardFilter,a.SDK.Filters.X400Filter]},{name:"summer",filters:[a.SDK.Filters.FrontFilter,a.SDK.Filters.MellowFilter,a.SDK.Filters.SemiredFilter,a.SDK.Filters.SunnyFilter,a.SDK.Filters.TexasFilter]},{name:"winter",filters:[a.SDK.Filters.MetalFilter,a.SDK.Filters.A15Filter,a.SDK.Filters.BreezeFilter,a.SDK.Filters.FridgeFilter,a.SDK.Filters.OrchidFilter,a.SDK.Filters.QuoziFilter]},{name:"special",filters:[a.SDK.Filters.FoodFilter,a.SDK.Filters.GlamFilter,a.SDK.Filters.LomoFilter,a.SDK.Filters.GobblinFilter]}],this._initCategories()}return t.prototype._initCategories=function(){var t=this;this._options.categories&&(this._options.replaceCategories?this._categories=this._options.categories:this._categories=a.Utils.mergeCategories(this._categories,this._options.categories,"filters")),this._options.selectableFilters&&!function(){var e=[];t._categories.forEach(function(o){var n=o.filters.filter(function(e){return t._options.selectableFilters.indexOf(e.identifier)!==-1});n.length>0&&e.push({name:o.name,filters:n})}),t._categories=e}();var e={name:"all",filters:this._categories.map(function(t){return t.filters}).reduce(function(t,e){return t.concat(e)})};this._categories.unshift(e),this._categories.forEach(function(e){t._categoriesById[e.name]=e})},t.prototype.getFiltersForCategory=function(t){if(!this._categoriesById[t])throw new Error("Unknown filter category '"+t+"'");return this._categoriesById[t].filters},t.prototype.getCategories=function(){return this._categories},t}();e["default"]=s},function(t,e){var o={}.toString;t.exports=function(t){return o.call(t).slice(8,-1)}},function(t,e,o){var n=o(223);t.exports=function(t,e,o){if(n(t),void 0===e)return t;switch(o){case 1:return function(o){return t.call(e,o)};case 2:return function(o,n){return t.call(e,o,n)};case 3:return function(o,n,i){return t.call(e,o,n,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e){t.exports=!0},function(t,e,o){var n=o(15),i=o(238),r=o(46),a=o(51)("IE_PROTO"),s=function(){},l="prototype",c=function(){var t,e=o(79)("iframe"),n=r.length,i="<",a=">";for(e.style.display="none",o(228).appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write(i+"script"+a+"document.F=Object"+i+"/script"+a),t.close(),c=t.F;n--;)delete c[l][r[n]];return c()};t.exports=Object.create||function(t,e){var o;return null!==t?(s[l]=n(t),o=new s,s[l]=null,o[a]=t):o=c(),void 0===e?o:i(o,e)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,o){var n=o(13).f,i=o(18),r=o(9)("toStringTag");t.exports=function(t,e,o){t&&!i(t=o?t:t.prototype,r)&&n(t,r,{configurable:!0,value:e})}},function(t,e,o){var n=o(52)("keys"),i=o(34);t.exports=function(t){return n[t]||(n[t]=i(t))}},function(t,e,o){var n=o(12),i="__core-js_shared__",r=n[i]||(n[i]={});t.exports=function(t){return r[t]||(r[t]={})}},function(t,e){var o=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:o)(t)}},function(t,e,o){var n=o(45);t.exports=function(t){return Object(n(t))}},function(t,e,o){var n=o(27);t.exports=function(t,e){if(!n(t))return t;var o,i;if(e&&"function"==typeof(o=t.toString)&&!n(i=o.call(t)))return i;if("function"==typeof(o=t.valueOf)&&!n(i=o.call(t)))return i;if(!e&&"function"==typeof(o=t.toString)&&!n(i=o.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e,o){var n=o(12),i=o(8),r=o(47),a=o(57),s=o(13).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=r?{}:n.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,o){e.f=o(9)},function(t,e,o){o(247);for(var n=o(12),i=o(22),r=o(23),a=o(9)("toStringTag"),s=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],l=0;l<5;l++){var c=s[l],u=n[c],p=u&&u.prototype;p&&!p[a]&&i(p,a,c),r[c]=r.Array}},function(t,o){t.exports=e},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(105);Object.defineProperty(e,"adjustments",{enumerable:!0,get:function(){return n(i)["default"]}});var r=o(115);Object.defineProperty(e,"crop",{enumerable:!0,get:function(){return n(r)["default"]}});var a=o(117);Object.defineProperty(e,"filter",{enumerable:!0,get:function(){return n(a)["default"]}});var s=o(119);Object.defineProperty(e,"focus",{enumerable:!0,get:function(){return n(s)["default"]}});var l=o(107);Object.defineProperty(e,"border",{enumerable:!0,get:function(){return n(l)["default"]}});var c=o(140);Object.defineProperty(e,"sticker",{enumerable:!0,get:function(){return n(c)["default"]}});var u=o(146);Object.defineProperty(e,"text",{enumerable:!0,get:function(){return n(u)["default"]}});var p=o(110);Object.defineProperty(e,"brush",{enumerable:!0,get:function(){return n(p)["default"]}});var d=o(134);Object.defineProperty(e,"selectiveBlur",{enumerable:!0,get:function(){return n(d)["default"]}})},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(36),s=n(a),l=o(260),c=n(l),u=5e3,p=s["default"].Promise,d=function(){function t(e){(0,r["default"])(this,t),this._url=e,this._parsedUrl=c["default"].parse(this._url,!0)}return t.prototype._isJSONPRequest=function(){var t=this._parsedUrl.query;for(var e in t){var o=t[e];if("?"===o)return!0}return!1},t.prototype.load=function(){return this._isJSONPRequest()?this._loadJSONP():this._loadJSON()},t.prototype._loadJSON=function(){var t=this;return new p(function(e,o){var n=void 0;window.XDomainRequest?(n=new window.XDomainRequest,n.onload=function(){var t=JSON.parse(n.responseText);e(t)},n.onerror=function(t){o(t)}):window.XMLHttpRequest&&(n=new XMLHttpRequest,n.onreadystatechange=function(t){if(4===n.readyState)if(200===n.status){var i=JSON.parse(n.responseText);e(i)}else o(new Error("HTTP Status "+n.status))}),n.open("GET",t._url,!0),n.send()})},t.prototype._loadJSONP=function(){var t=this,e=!1,o=!1,n="pesdk"+Math.round(99999999999999*Math.random());return new p(function(i,r){var a=t._createJSONPNode(n);window[n]=function(n){t._removeJSONPNode(a),e||(o=!0,i(n))},window.setTimeout(function(){o||(t._removeJSONPNode(a),e=!0,r(new Error("Timeout of 5 seconds exceeded.")))},u)})},t.prototype._createJSONPNode=function(t){var e=this._buildJSONPUrl(t),o=document.querySelector("head"),n=document.createElement("script");return n.src=e,o.appendChild(n),n},t.prototype._removeJSONPNode=function(t){t.parentNode.removeChild(t)},t.prototype._buildJSONPUrl=function(t){var e=this._parsedUrl.query,o=null;for(var n in e)if("?"===e[n]){o=n;break}return delete this._parsedUrl.search,e[o]=t,c["default"].format(this._parsedUrl)},t}();e["default"]=d},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(99),d=n(p),h=function(t){function e(){(0,r["default"])(this,e);var o=(0,s["default"])(this,t.call(this));return o._bindAll("_onButtonClick"),o.state={overlayVisible:!1},o}return(0,c["default"])(e,t),e.prototype._onButtonClick=function(t){t.preventDefault(),t.stopPropagation(),this.setState({overlayVisible:!this.state.overlayVisible})},e.prototype.renderWithBEM=function(){var t=null;this.state.overlayVisible&&(t=u.ReactBEM.createElement(d["default"],{items:this.props.items,selectedItem:this.props.selectedItem,onChange:this.props.onChange}));var e=this.state.overlayVisible?"is-active":null;return u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"$e:categoryDropdown",className:e,onClick:this._onButtonClick},u.ReactBEM.createElement("img",{bem:"e:icon",src:this.props.selectedItem.icon}),u.ReactBEM.createElement("div",{bem:"e:label"},this.props.selectedItem.label),t))},e}(u.BaseComponent);e["default"]=h,h.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(5),d=n(p),h=o(10),f=n(h),m=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._hasBackButton=!1,a}return(0,c["default"])(e,t),e.prototype._onItemClick=function(t){this.props.onSwitchControls(t)},e.prototype._renderListItems=function(){var t=this,e=this.context.editor,o=[],n=function(o){var n=e.controls.get(o);return u.ReactBEM.createElement("li",{bem:"e:item",key:n.identifier,"data-identifier":n.identifier,onClick:t._onItemClick.bind(t,n)},u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"$e:button m:withLabel"},u.ReactBEM.createElement("img",{bem:"e:icon",src:t._getAssetPath(n.iconPath,!0)}),u.ReactBEM.createElement("div",{bem:"e:label"},t._t(n.languageKey)))))},i=this.context.options.editor.controlsOrder;i.forEach(function(t){if(Array.isArray(t))!function(){var i=t,r=[];i.forEach(function(t){e.controls.isEnabled(t)&&r.push(n(t))}),r.length&&o.push(r)}();else{var i=t;if(!e.controls.isEnabled(i))return;o.push(n(i))}});var r=[];return o.forEach(function(t){r=r.concat(t),t!==o[o.length-1]&&r.push(u.ReactBEM.createElement("li",{bem:"e:separator"}))}),r},e.prototype.renderControls=function(){var t=this._renderListItems();return u.ReactBEM.createElement("div",{bem:"e:cell m:list"},u.ReactBEM.createElement(f["default"],null,u.ReactBEM.createElement("ul",{bem:"$e:list"},t)))},e}(d["default"]);e["default"]=m,m.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this._renderCanvas()},e.prototype.componentDidUpdate=function(){this._renderCanvas()},e.prototype._renderCanvas=function(){var t=this.refs.canvas,e=this.context.editor,o=e.getSDK(),n=o.getPixelRatio();t.width=t.offsetWidth*n,t.height=t.offsetHeight*n,t.style.width=t.offsetWidth+"px",t.style.height=t.offsetHeight+"px";var i=t.getContext("2d");i.fillStyle="red",i.clearRect(0,0,t.width,t.height),i.font=(this.props.fontStyle||"")+" "+(this.props.fontWeight||"")+" "+24*n+"px "+this.props.fontFamily,i.textBaseline="middle",i.textAlign="center",i.fillStyle="white",i.fillText("Abc",t.width/2,t.height/2)},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("canvas",{bem:"b:fontFamily e:canvas",ref:"canvas"})},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onClick"),a}return(0,c["default"])(e,t),e.prototype._onClick=function(){this.props.onClick&&this.props.onClick(this.props.searchSuggestion)},e.prototype.renderWithBEM=function(){var t=this.props.searchSuggestion,e={backgroundImage:"url("+t.coverImage+")"};return u.ReactBEM.createElement("bem",{specifier:"b:photoRoll e:libraryList"},u.ReactBEM.createElement("li",{bem:"e:item",style:e,onClick:this._onClick},u.ReactBEM.createElement("div",{bem:"e:overlay"}),u.ReactBEM.createElement("div",{bem:"e:name"},t.query)))},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(7),d=n(p),h=o(161),f=n(h),m=o(10),_=n(m),g=240,v=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._needsStyleFixes=!0,a._totalPhotosHeight=0,a.state={loading:!1,photos:[]},a}return(0,c["default"])(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this._loadPhotos()},e.prototype.componentDidUpdate=function(){this.refs.scrollbar&&this.refs.scrollbar.update()},e.prototype._onPhotoClicked=function(t){this.props.onPhotoClicked&&this.props.onPhotoClicked(t)},e.prototype._getHeadline=function(){return this.props.library.name},e.prototype.fixStyles=function(){if(u.Utils.Browser.isIElte(11)){var t=this.refs.cell,e=this.refs.scrollbar.getList();if(!t||!e)return;var o=t.offsetHeight;e.style.height=o+"px"}this.refs.scrollbar&&this.refs.scrollbar.update()},e.prototype._renderColumns=function(){for(var t=this,e=this.state.photos,o=3,n=[],i=[],r=0;r<o;r++)i.push([]),n.push(0);return e.forEach(function(e){for(var r=e.dimensions,a=null,s=1/0,l=0;l<o;l++)n[l]<s&&(a=l,s=n[l]);i[a].push(u.ReactBEM.createElement(f["default"],{photo:e.obj,onClick:t._onPhotoClicked.bind(t,e.obj)})),n[a]+=r.y}),i},e.prototype._renderPhotos=function(){var t=this._renderColumns();return u.ReactBEM.createElement("div",{bem:"$b:photoRoll e:row m:fullHeight"},u.ReactBEM.createElement("div",{bem:"e:cell",ref:"cell"},u.ReactBEM.createElement(_["default"],{direction:"vertical",ref:"scrollbar"},u.ReactBEM.createElement("div",{bem:"e:container",ref:"container"},u.ReactBEM.createElement("div",{bem:"e:innerContainer"},u.ReactBEM.createElement("div",{bem:"e:headline"},this._getHeadline()),u.ReactBEM.createElement("bem",{specifier:"e:photoList"},t.map(function(t){return u.ReactBEM.createElement("ul",{bem:"$e:list"},t)})))))))},e.prototype._loadPhotos=function(){var t=this;this._totalPhotosHeight=0;var e=d["default"].instance.displayProgress(this._t("loading.loading")),o=this.context.options.photoRoll.provider,n=new o;n.getPhotosForLibrary(this.props.library).then(function(o){return t._preloadPhotos(o,e)}).then(function(o){t.setState({photos:o,loading:!1}),e.close()})["catch"](function(o){console.log(o),e.close(),d["default"].instance.displayError(t._t("errors.photoRollLoadFail.title"),t._t("errors.photoRollLoadFail.text",{error:o.message}))})},e.prototype._preloadPhotos=function(t,e){var o=this,n=t.length,i=0;return Promise.all(t.map(function(t){return o._preloadPhoto(t).then(function(r){var a=new u.Vector2(r.width,r.height);return a.multiply(g/r.width),o._totalPhotosHeight+=a.y,i++,e.setData({progress:i/n}),{obj:t,dimensions:a}})}))},e.prototype._preloadPhoto=function(t){return new Promise(function(e,o){var n=new window.Image;n.addEventListener("load",function(){e(n)}),n.addEventListener("error",function(){e(n)}),n.src=t.urls.thumb})},e.prototype.renderWithBEM=function(){return this.state.loading?u.ReactBEM.createElement("div",null):this._renderPhotos()},e}(u.BaseComponent);e["default"]=v,v.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(76),s=n(a),l="__",c="--",u="pesdk-react-",p=function(){function t(e,o,n){(0,r["default"])(this,t),this._parent=e,this._type=o,this._name=n}return t.prototype.element=function(e){return new t(this,"element",e)},t.prototype.modifier=function(e){return new t(this,"modifier",e)},(0,s["default"])(t,[{key:"str",get:function(){var t=this._parent?this._parent.str:"";switch(this._type){case"block":t+=""+u+this._name;break;case"element":t+=""+l+this._name;break;case"modifier":t+=""+c+this._name}return t}}]),t}();e["default"]={block:function(t){return new p(null,"block",t)}}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(182),d=n(p),h=o(189),f=n(h),m=o(180),_=n(m),g=o(177),v=n(g),y=o(178),b=n(y),E=o(181),S=n(E),M=o(179),C=n(M),B=function(t){function e(o,n,i){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];(0,r["default"])(this,e);var l=(0,s["default"])(this,t.call(this));return l._ui=o,l._options=n,l._mediator=i,l._ready=!1,l._padding=[0,0,0,0],a||(l._initSDK(),l._onZoom=l._onZoom.bind(l),l._onUndo=l._onUndo.bind(l),l.operations=new _["default"](l,l._sdk,l._mediator),l.history=new C["default"](l,l._sdk,l._mediator),l.history.on("undo",l._onUndo),l.zoom=new S["default"](l,l._sdk,l._mediator),l.zoom.on("set",l._onZoom),l._initSerializers()),l.controls=new v["default"](l,l._sdk,l._mediator),l.features=new b["default"](l,l._sdk,l._mediator),l._running=!1,l._renderRequested=!0,l._renderCallbacks=[],l._animationFrameRequest=null,l.render=l.render.bind(l),l._tick=l._tick.bind(l),l}return(0,c["default"])(e,t),e.prototype.setImage=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._options.editor.image,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this._sdk.getRenderer(),i=new u.Vector2(e.width,e.height),r=1e6*this.getMaxMegapixels(),a=n.getMaxDimensions();o&&this.reset();var s=new f["default"](e,r,a),l=null,c=function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t._setImage(e,l,o),t._initWatermark(),t._ready=!0,t.emit("ready")};s.needsResize()?(this.emit("resize"),l=this._sdk.parseExif(e),s.resize().then(function(e){var o=e.canvas,n=e.dimensions,i=e.reason;o.src="data:image/jpeg;base64,",t.emit("resized",{dimensions:n,reason:i}),c(o,n,i)})):c(e)},e.prototype._initWatermark=function(){this._options.editor.watermarkImage&&(this._watermarkOperation=this.operations.getOrCreate("watermark",{image:this._options.editor.watermarkImage}))},e.prototype._initSDK=function(){var t=this._options,e=t.logLevel,o=t.displayWelcomeMessage,n=t.debug,i=this._options.editor,r=i.smoothDownscaling,a=i.smoothUpscaling,s=i.preferredRenderer,l=i.pixelRatio,c={logLevel:e,debug:n,displayWelcomeMessage:o,pixelRatio:l,smoothDownscaling:r,smoothUpscaling:a,transparent:!0};this._sdk=new u.SDK(s,c)},e.prototype._onZoom=function(t){var e=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.fixOffset(),this.render(function(){e._mediator.emit(u.Constants.EVENTS.ZOOM_DONE),o&&o()})},e.prototype._onUndo=function(){this.render()},e.prototype.getRotation=function(){return this._sdk.getRotation()},e.prototype.setRotation=function(t){this._sdk.setRotation(t)},e.prototype.getSpriteScale=function(){return this._sdk.getSpriteScale()},e.prototype.setSpriteScale=function(t){this._sdk.setSpriteScale(t)},e.prototype.isToolEnabled=function(t){return this._options.editor.tools.indexOf(t)!==-1},e.prototype.getMaxMegapixels=function(){var t=this._options.editor.maxMegaPixels;return u.Utils.isMobile()?t.mobile:t.desktop},e.prototype.getOutputDimensions=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sdk.getOutputDimensions(t)},e.prototype.getOutputTextureDimensions=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sdk.getOutputTextureDimensions(t)},e.prototype.getFinalDimensions=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sdk.getFinalDimensions(t)},e.prototype.getCanvasDimensions=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this._sdk.getCanvas(),o=new u.Vector2(e.offsetWidth,e.offsetHeight);return t&&o.subtract(this._padding[1]+this._padding[3],this._padding[0]+this._padding[2]),o},e.prototype._setImage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._options.editor.image,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._sdk.setAllOperationsToDirty(),this._options.editor.image=t,this._sdk.setImage(t,e,o),this.zoom.set("auto"),this.emit("new-image")},e.prototype["export"]=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._watermarkOperation&&this._watermarkOperation.setEnabled(!1),this._sdk.setAllOperationsToDirty();var o=this._options.editor["export"],n=new d["default"](this._sdk,o,e);return n["export"]().then(function(e){return t.emit("export",e),t._mediator.emit(u.Constants.EVENTS.EXPORT,e,t),t._watermarkOperation&&(t._watermarkOperation.setEnabled(!0),t._sdk.render()),t._sdk.setAllOperationsToDirty(),e})},e.prototype._initSerializers=function(){this._serializers={"1.0.0":o(196)["default"],"1.0.1":o(198)["default"]}},e.prototype.serialize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"1.0.1",o=this._serializers[e];if(!o)return u.Promise.reject(new Error("No serializer for version "+e+" found."));var n=new o(this);return n.serialize(t)},e.prototype.deserialize=function(t){var e=this._serializers[t.version];if(!e)return u.Promise.reject(new Error("No serializer for version "+t.version+" found."));var o=new e(this);return o.deserialize(t)},e.prototype._applyOffset=function(){var t=this._offset.clone();t.x-=this._padding[1]/2,t.x+=this._padding[3]/2,t.y-=this._padding[2]/2,t.y+=this._padding[0]/2,this._sdk.setOffset(t)},e.prototype.start=function(){this.zoom.set("auto"),this._animationFrameRequest=(0,u.requestAnimationFrame)(this._tick)},e.prototype.stop=function(){this._running=!1,this._animationFrameRequest&&((0,u.cancelAnimationFrame)(this._animationFrameRequest),this._renderCallbacks=[])},e.prototype.render=function(t){this._renderRequested=!0,t&&this._renderCallbacks.push(t)},e.prototype.setOffset=function(t){this._offset=this._clampOffset(t)},e.prototype.getOffset=function(){return this._offset},e.prototype.fixOffset=function(){this.setOffset(this._sdk.getOffset())},e.prototype._clampOffset=function(t){var e=this._sdk.getRenderer(),o=new u.Vector2(e.getWidth(),e.getHeight()),n=this._sdk.getOutputDimensions(!1),i=o.clone().subtract(n).divide(2).clamp(null,new u.Vector2(0,0)),r=n.clone().subtract(o).divide(2).clamp(new u.Vector2(0,0),null),a=t.clone().clamp(i,r).round();return a},e.prototype._tick=function(){var t=this;this._renderRequested?!function(){var e=t._renderCallbacks.slice(0);t._renderCallbacks=[],t._render().then(function(){e.forEach(function(t){return t()}),t._animationFrameRequest=(0,u.requestAnimationFrame)(t._tick)})["catch"](function(t){u.Log.printError(t)}),t._renderRequested=!1}():this._animationFrameRequest=(0,u.requestAnimationFrame)(this._tick)},e.prototype._render=function(){var t=this;return this._ready?(this._applyOffset(),this._sdk.render().then(function(){t._lastOutputBounds=t._sdk.getSprite().getBounds()})["catch"](function(e){t.emit("render-error",e)})):u.Promise.resolve()},e.prototype.reset=function(){this._sdk.reset(),this.history.reset(),this.operations.reset()},e.prototype.dispose=function(){this.stop(),this._sdk.dispose()},e.prototype.isReady=function(){return this._ready},e.prototype.getRenderer=function(){return this._sdk.getRenderer()},e.prototype.getSDK=function(){return this._sdk},e.prototype.getInputDimensions=function(){return this._sdk.getInputDimensions()},e.prototype.getPadding=function(){return this._padding},e.prototype.setPadding=function(t){t?this._padding=t:this._padding=[0,0,0,0]},e.prototype.getImage=function(){return this._options.editor.image},e.prototype.getOptions=function(){return this._options},e.prototype.getUI=function(){return this._ui},e.prototype.broadcastCrop=function(t,e){var o=this,n=["sprite","selective-blur"];n.forEach(function(n){var i=o.operations.get(n);i&&i.crop(t,e)})},e.prototype.broadcastFlip=function(t){var e=this,o=["linear-focus","radial-focus","sprite","selective-blur"];o.forEach(function(o){var n=e.operations.get(o);n&&n.flip(t)})},e.prototype.broadcastRotate=function(t){var e=this,o=["crop","linear-focus","radial-focus","sprite","selective-blur"];o.forEach(function(o){var n=e.operations.get(o);n&&n.rotate(t)})},e}(u.EventEmitter);e["default"]=B},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=u.SDK.OptionType,d=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e}(u.SDK.Configurable);e["default"]=d,d.prototype.availableOptions={name:{type:p.STRING,required:!0},fontWeight:{type:p.ALL,"default":400},fontFamily:{type:p.STRING,required:!0},fontStyle:{type:p.STRING,"default":"normal"},provider:{type:p.STRING,available:["google"]},"default":{type:p.BOOLEAN,"default":!1}}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(1),s=function(){function t(e){(0,r["default"])(this,t),this._options=e,this._categoriesById={},this._categories=[],this._initCategories()}return t.prototype._initCategories=function(){var t=this,e=this._options,o=e.replaceCategories,n=e.categories,i=a.Constants.DEFAULTS.STICKER_CATEGORIES;
n?o?this._categories=n.slice(0):this._categories=a.Utils.mergeCategories(i,n,"stickers"):this._categories=i.slice(0);var r={name:"all",stickers:this._categories.map(function(t){return t.stickers}).reduce(function(t,e){return t.concat(e)})};this._categories.unshift(r),this._categoriesById={},this._categories.forEach(function(e){t._categoriesById[e.name]=e})},t.prototype.getStickersForCategory=function(t){if(!this._categoriesById[t])throw new Error("Unknown sticker category '"+t+"'");return this._categoriesById[t].stickers},t.prototype.getCategories=function(){return this._categories},t}();e["default"]=s},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function i(t){for(var e=[],o=0;o<t.length;o++)t[o]instanceof Array?e=e.concat(i(t[o])):e.push(t[o]);return e}Object.defineProperty(e,"__esModule",{value:!0});var r=o(213),a=n(r),s=o(32),l=n(s),c=o(59),u=n(c),p=o(77),d=n(p),h=o(67),f=n(h),m={b:"block",e:"element",m:"modifier"},_={_parseBemSpecifier:function(t){if(!t)return[];var e=t.split(" "),o=e.map(function(t){var e=t.match(/^(\$)?([bem]):(.*)$/i);if(!e)throw new Error("Invalid BEM specifier: "+t);var o="undefined"!=typeof e[1],n=m[e[2]],i=e[3];return{type:n,name:i,pass:o}});return o},_getBemInfoForNode:function(t){var e="bem"===t.type,o=e?t.props.specifier:t.props.bem;if(e&&!o)throw new Error("<bem> elements should always have a `specifier` property");var n=this._parseBemSpecifier(o);return e&&n.forEach(function(t){t.pass=!0}),{data:n,isBemNode:e}},createElement:function(t,e){for(var o=arguments.length,n=Array(o>2?o-2:0),i=2;i<o;i++)n[i-2]=arguments[i];return e=e||{},n=n.filter(function(t){return null!==t&&"undefined"!=typeof t}),{type:t,props:e,children:n}},_isNodeBEMable:function(t){return null!==t&&"object"===("undefined"==typeof t?"undefined":(0,l["default"])(t))&&!u["default"].isValidElement(t)},_applyBEMClasses:function(t){var e=this;if(!this._isNodeBEMable(t))return t;var o=t.props.className?[t.props.className]:[],n=this._getBemInfoForNode(t),r=t.props.__bemObject,a=t.props.__bemObject;n.data.forEach(function(t){if("block"===t.type)r=f["default"].block(t.name),t.pass&&(a=f["default"].block(t.name)),o.push(r.str);else if("element"===t.type){if(!r)throw new Error("Tried to create an element, but no parent block has been found.");r=r.element(t.name),t.pass&&(a=a.element(t.name)),o.push(r.str)}else if("modifier"===t.type){if(!r)throw new Error("Tried to create a modifier, but no parent block has been found.");t.pass&&(a=a.modifier(t.name)),o.push(r.modifier(t.name).str)}});var s=(0,d["default"])(o);return s&&(t.props.className=s),t.children=i(t.children),t.children.forEach(function(t){e._isNodeBEMable(t)&&(t.props.__bemObject=a)}),t.children=t.children.map(function(t){return e._applyBEMClasses(t)}),t.children=i(t.children),delete t.props.__bemObject,delete t.props.bem,n.isBemNode&&(t=t.children instanceof Array&&1===t.children.length?t.children[0]:t.children),t},_transformToReact:function(t){var e=this;return this._isNodeBEMable(t)?(t.children=t.children.map(function(t){return e._transformToReact(t)}),u["default"].createElement.apply(u["default"],[t.type,t.props].concat((0,a["default"])(t.children)))):t},transform:function(t){return t=this._applyBEMClasses(t),t instanceof Array?t:t=this._transformToReact(t)}};e["default"]=_},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(1),s=o(42),l=n(s),c=o(70),u=n(c),p=function(){function t(e,o){(0,r["default"])(this,t),this._editor=e,this._data=o,this._filterManager=new l["default"](this._editor._options),this._stickerManager=new u["default"](this._editor._options)}return t.prototype.deserialize=function(){var t=this;return this._validateVersion().then(function(){return t._deserializeInputImage()}).then(function(){return t._deserializeOperations()}).then(function(){return t._editor.zoom.set("auto")})},t.prototype._validateVersion=function(){return"1.0.0"!==this._data.version?Promise.reject(new Error("Invalid version "+this._data.version+", expected 1.0.0")):Promise.resolve()},t.prototype._deserializeInputImage=function(){var t=this;return new Promise(function(e,o){var n=t._data.inputImage,i=n.data,r=n.type;i&&r?!function(){var o=new window.Image;o.addEventListener("load",function(){t._editor.setImage(o),e()}),o.src="data:"+r+";base64,"+i}():e()})},t.prototype._deserializeOperations=function(){var t=this,e=this._data.operations.map(function(e){switch(e.type){case"crop":return t._deserializeCropOperation(e);case"orientation":return t._deserializeOrientationOperation(e);case"filter":return t._deserializeFilterOperation(e);case"adjustments":return t._deserializeAdjustmentsOperation(e);case"sprite":return t._deserializeSpriteOperation(e);case"focus":return t._deserializeFocusOperation(e);case"border":return t._deserializeBorderOperation(e)}});return Promise.all(e)},t.prototype._deserializeCropOperation=function(t){var e=t.options,o=e.scale,n=e.rotation,i=a.Vector2.fromObject(e.start),r=a.Vector2.fromObject(e.end);return n>Math.PI&&(n-=2*Math.PI),this._editor.operations.getOrCreate("crop",{start:i,end:r,scale:o,rotation:n}),Promise.resolve()},t.prototype._deserializeOrientationOperation=function(t){var e=t.options;this._editor.operations.getOrCreate("orientation",e)},t.prototype._deserializeFilterOperation=function(t){for(var e=t.options,o=this._filterManager.getFiltersForCategory("all"),n=void 0,i=0;i<o.length;i++){var r=o[i];if(r.identifier===e.name){n=r;break}}if(!n)throw new Error("Unknown filter '"+e.name+"'");this._editor.operations.getOrCreate("filter",{filter:new n,intensity:e.intensity})},t.prototype._deserializeAdjustmentsOperation=function(t){var e=a.SDK.Operations.AdjustmentsOperation,o=t.options,n={};for(var i in o){var r=o[i],s=e.prototype.availableOptions[i]["default"];n[i]=r+s}this._editor.operations.getOrCreate("adjustments",n)},t.prototype._deserializeSpriteOperation=function(t){var e=this,o=t.options,n=this._editor.operations.getOrCreate("sprite"),i=o.sprites.map(function(t){switch(t.type){case"sticker":return e._deserializeSticker(n,t);case"text":return e._deserializeText(n,t);case"brush":return e._deserializeBrush(n,t)}}).filter(function(t){return!!t});return Promise.all(i).then(function(t){n.setSprites(t)})},t.prototype._deserializeSticker=function(t,e){for(var o=this,n=a.SDK.Operations.SpriteOperation,i=e.options,r=this._stickerManager.getStickersForCategory("all"),s=void 0,l=0;l<r.length;l++)r[l].name!==i.name||(s=r[l]);if(!s)throw new Error("Unknown sticker '"+i.name+"'");return new Promise(function(e,r){var l=new window.Image;l.addEventListener("load",function(){var o=n.Sticker.prototype.availableOptions.adjustments.structure,r=i.rotation,s=i.flipHorizontally,c=i.flipVertically;e(t.createSticker({image:l,position:a.Vector2.fromObject(i.position),dimensions:a.Vector2.fromObject(i.dimensions),rotation:r,flipHorizontally:s,flipVertically:c,adjustments:{brightness:i.adjustments.brightness+o.brightness["default"],saturation:i.adjustments.saturation+o.saturation["default"],contrast:i.adjustments.contrast+o.contrast["default"]}}))}),l.src=o._editor.getUI().getAssetPath(s.images.mediaBase.uri)})},t.prototype._deserializeText=function(t,e){var o=e.options,n=o.fontSize,i=o.lineHeight,r=o.fontFamily,s=o.fontWeight,l=o.alignment,c=o.rotation,u=o.maxWidth,p=o.color,d=o.backgroundColor;return Promise.resolve(t.createText({fontSize:n,lineHeight:i,fontFamily:r,fontWeight:s,alignment:l,rotation:c,maxWidth:u,text:o.text,color:a.Color.fromArray(p),backgroundColor:a.Color.fromArray(d),position:a.Vector2.fromObject(o.position)}))},t.prototype._deserializeBrush=function(t,e){var o=e.options,n=o.paths,i=t.createBrush();return n.forEach(function(t){var e=t.color,o=t.size,n=t.points,r=new a.Color(e[0],e[1],e[2],e[3]),s=i.createPath(o,1,r);n.forEach(function(t){s.addControlPoint(a.Vector2.fromObject(t))})}),Promise.resolve(i)},t.prototype._deserializeFocusOperation=function(t){var e=t.options.options;switch(t.options.type){case"radial":var o=e.position,n=e.radius,i=e.gradientRadius,r=e.blurRadius;this._editor.operations.getOrCreate("radial-focus",{position:a.Vector2.fromObject(o),radius:n,gradientRadius:i,blurRadius:r});break;case"linear":var s=e.start,l=e.end,c=e.size,u=e.gradientSize,p=e.blurRadius;this._editor.operations.getOrCreate("linear-focus",{start:a.Vector2.fromObject(s),end:a.Vector2.fromObject(l),size:c,gradientSize:u,blurRadius:p})}},t.prototype._deserializeBorderOperation=function(t){var e=t.options,o=e.color,n=e.size;this._editor.operations.getOrCreate("border",{color:a.Color.fromArray(o),thickness:n})},t.prototype._getInputDimensionsForOperation=function(t){var e=!1,o=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(function(n){n===t&&(e=!0),e||(o=n.getNewDimensions(o))}),o},t}();e["default"]=p},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(1),s=2*Math.PI,l=function(){function t(e){(0,r["default"])(this,t),this._editor=e,this._serializeOperations=this._serializeOperations.bind(this)}return t.prototype.serialize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._options=a.SDKUtils.defaults(t,{image:!0});var e={version:"1.0.0"};return this._serializeInputImage(e).then(this._serializeOperations)},t.prototype._serializeInputImage=function(t){var e=this._editor.getImage();if(!this._options.image)return t.inputImage={width:e.width,height:e.height},Promise.resolve(t);var o=new a.SDK("webgl",{image:e});return o["export"](a.RenderType.DATA_URL,a.ImageFormat.PNG).then(function(o){var n=e.width,i=e.height;return t.inputImage={type:a.ImageFormat.PNG,data:o.replace(/^data:image\/(.*?);base64,/,""),width:n,height:i},t})},t.prototype._serializeOperations=function(t){var e=this,o=[],n=this._editor.operations.getStack();return n.forEach(function(t){o.push(e._serializeOperation(t))}),t.operations=o,Promise.resolve(t)},t.prototype._serializeOperation=function(t){switch(t.constructor.identifier){case"crop":return this._serializeCropOperation(t);case"orientation":return this._serializeOrientationOperation(t);case"filter":return this._serializeFilterOperation(t);case"adjustments":return this._serializeAdjustmentsOperation(t);case"sprite":return this._serializeSpriteOperation(t);case"radial-focus":return this._serializeRadialFocusOperation(t);case"linear-focus":return this._serializeLinearFocusOperation(t);case"border":return this._serializeBorderOperation(t);default:throw new Error("Unable to serialize operation of type "+t.constructor.identifier)}},t.prototype._serializeCropOperation=function(t){var e=t.serializeOptions(["start","end","rotation","scale"],!0);return e.rotation=(e.rotation+s)%s,{type:"crop",options:e}},t.prototype._serializeOrientationOperation=function(t){return{type:"orientation",options:t.serializeOptions(["flipVertically","flipHorizontally","rotation"],!0)}},t.prototype._serializeFilterOperation=function(t){return{type:"filter",options:{intensity:t.getIntensity(),name:t.getFilter().constructor.identifier}}},t.prototype._serializeAdjustmentsOperation=function(t){var e=t.availableOptions,o={};for(var n in e){var i=e[n],r=t.getOption(n);r!==i["default"]&&(o[n]=r-i["default"])}return{type:"adjustments",options:o}},t.prototype._serializeSpriteOperation=function(t){var e=this,o=t.getSprites().map(function(o){return o instanceof t.constructor.Sticker?e._serializeSticker(t,o):o instanceof t.constructor.Text?e._serializeText(t,o):o instanceof t.constructor.Brush?e._serializeBrush(t,o):void 0});return{type:"sprite",options:{sprites:o}}},t.prototype._serializeSticker=function(t,e){var o=e.getAdjustments(),n=e.serializeOptions(["name","position","dimensions","flipVertically","flipHorizontally","rotation"],!0);n.rotation=(n.rotation+s)%s;var i=o.availableOptions;return n.adjustments={brightness:o.getBrightness()-i.brightness["default"],saturation:o.getSaturation()-i.saturation["default"],contrast:o.getContrast()-i.contrast["default"]},{type:"sticker",options:n}},t.prototype._serializeText=function(t,e){var o=e.serializeOptions(["fontSize","lineHeight","fontFamily","fontWeight","alignment","color","backgroundColor","position","rotation","text","maxWidth"],!0);return o.rotation=(o.rotation+s)%s,{type:"text",options:o}},t.prototype._serializeBrush=function(t,e){var o=this;return{type:"brush",options:{paths:e.getPaths().map(function(t){return o._serializePath(t)})}}},t.prototype._serializePath=function(t){var e=t.serializeOptions(["color","thickness"],!0);return e.size=e.thickness,delete e.thickness,e.points=t.getControlPoints().map(function(t){return t.getPosition().toObject()}),e},t.prototype._serializeRadialFocusOperation=function(t){return{type:"focus",options:{type:"radial",options:t.serializeOptions(["position","radius","gradientRadius","blurRadius"],!0)}}},t.prototype._serializeLinearFocusOperation=function(t){return{type:"focus",options:{type:"linear",options:t.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}},t.prototype._serializeBorderOperation=function(t){var e=t.serializeOptions(["color","thickness"],!0);return e.size=e.thickness,delete e.thickness,{type:"border",options:e}},t.prototype._getInputDimensionsForOperation=function(t){var e=!1,o=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(function(n){n===t&&(e=!0),e||(o=n.getNewDimensions(o))}),o},t}();e["default"]=l},function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var o="warn",n=[{type:"trace",background:"#EEEEEE",color:"#AAAAAA"},{type:"info",background:"#BDE5F8",color:"#00529B"},{type:"warn",background:"#FEEFB3",color:"#9F6000"},{type:"error",background:"#FFBABA",color:"#D8000C"},{type:"log",background:"#EEEEEE",color:"#1f4f6b"}],i=n.map(function(t){return t.type}),r={};r.setLevel=function(t){o=t},r.canLog=function(t){if(null===o)return!1;var e=i.indexOf(t),n=i.indexOf(o);return!(e<n)},r.hasColorfulOutput=function(){return(!t||t&&t.browser)&&"undefined"!=typeof navigator&&navigator.userAgent.match(/Gecko|WebKit/i)&&!navigator.userAgent.match(/Trident/)},r.printError=function(t){var e=t.stack.split("\n");e.forEach(function(t){r.error("Error",t)})},n.forEach(function(t){var e=t.type,o=t.background,n=t.color;r[e]=function(t){if(r.canLog(e)){for(var i=arguments.length,a=Array(i>1?i-1:0),s=1;s<i;s++)a[s-1]=arguments[s];var l=a.map(function(t){return"string"==typeof t?t:t.toString()}).join(" ");return r.hasColorfulOutput()?void console.log("%c  %c PhotoEditorSDK %c  %c "+t+" %c  "+l+"  %c  ","background: #43ADEB; padding: 5px 0","background: #2B2B2B; color: white; padding: 5px 0","background: #43ADEB; padding: 5px 0","background: "+o+"; color: "+n+"; padding: 5px 0; font-weight: bold","background: #2B2B2B; color: white; padding: 5px 0","background: #43ADEB; padding: 5px 0"):console.log("PhotoEditorSDK | "+t+" | "+l)}}}),e["default"]=r}).call(e,o(90))},function(t,e,o){t.exports={"default":o(219),__esModule:!0}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var i=o(75),r=n(i);e["default"]=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,r["default"])(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}()},function(t,e,o){var n,i;/*!
  Copyright (c) 2016 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";function o(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];if(n){var i=typeof n;if("string"===i||"number"===i)t.push(n);else if(Array.isArray(n))t.push(o.apply(null,n));else if("object"===i)for(var a in n)r.call(n,a)&&n[a]&&t.push(a)}}return t.join(" ")}var r={}.hasOwnProperty;"undefined"!=typeof t&&t.exports?t.exports=o:(n=[],i=function(){return o}.apply(e,n),!(void 0!==i&&(t.exports=i)))}()},function(t,e,o){var n=o(43),i=o(9)("toStringTag"),r="Arguments"==n(function(){return arguments}()),a=function(t,e){try{return t[e]}catch(o){}};t.exports=function(t){var e,o,s;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(o=a(e=Object(t),i))?o:r?n(e):"Object"==(s=n(e))&&"function"==typeof e.callee?"Arguments":s}},function(t,e,o){var n=o(27),i=o(12).document,r=n(i)&&n(i.createElement);t.exports=function(t){return r?i.createElement(t):{}}},function(t,e,o){t.exports=!o(16)&&!o(26)(function(){return 7!=Object.defineProperty(o(79)("div"),"a",{get:function(){return 7}}).a})},function(t,e,o){var n=o(43);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e,o){"use strict";var n=o(47),i=o(17),r=o(86),a=o(22),s=o(18),l=o(23),c=o(232),u=o(50),p=o(240),d=o(9)("iterator"),h=!([].keys&&"next"in[].keys()),f="@@iterator",m="keys",_="values",g=function(){return this};t.exports=function(t,e,o,v,y,b,E){c(o,e,v);var S,M,C,B=function(t){if(!h&&t in k)return k[t];switch(t){case m:return function(){return new o(this,t)};case _:return function(){return new o(this,t)}}return function(){return new o(this,t)}},R=e+" Iterator",x=y==_,w=!1,k=t.prototype,O=k[d]||k[f]||y&&k[y],D=O||B(y),P=y?x?B("entries"):D:void 0,T="Array"==e?k.entries||O:O;if(T&&(C=p(T.call(new t)),C!==Object.prototype&&(u(C,R,!0),n||s(C,d)||a(C,d,g))),x&&O&&O.name!==_&&(w=!0,D=function(){return O.call(this)}),n&&!E||!h&&!w&&k[d]||a(k,d,D),l[e]=D,l[R]=g,y)if(S={values:x?D:B(_),keys:b?D:B(m),entries:P},E)for(M in S)M in k||r(k,M,S[M]);else i(i.P+i.F*(h||w),e,S);return S}},function(t,e,o){var n=o(33),i=o(29),r=o(19),a=o(55),s=o(18),l=o(80),c=Object.getOwnPropertyDescriptor;e.f=o(16)?c:function(t,e){if(t=r(t),e=a(e,!0),l)try{return c(t,e)}catch(o){}if(s(t,e))return i(!n.f.call(t,e),t[e])}},function(t,e,o){var n=o(85),i=o(46).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,i)}},function(t,e,o){var n=o(18),i=o(19),r=o(225)(!1),a=o(51)("IE_PROTO");t.exports=function(t,e){var o,s=i(t),l=0,c=[];for(o in s)o!=a&&n(s,o)&&c.push(o);for(;e.length>l;)n(s,o=e[l++])&&(~r(c,o)||c.push(o));return c}},function(t,e,o){t.exports=o(22)},function(t,e,o){var n=o(53),i=Math.min;t.exports=function(t){return t>0?i(n(t),9007199254740991):0}},function(t,e,o){var n=o(78),i=o(9)("iterator"),r=o(23);t.exports=o(8).getIteratorMethod=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||r[n(t)]}},function(t,e,o){(function(e){(function(){var o,n,i;"undefined"!=typeof performance&&null!==performance&&performance.now?t.exports=function(){return performance.now()}:"undefined"!=typeof e&&null!==e&&e.hrtime?(t.exports=function(){return(o()-i)/1e6},n=e.hrtime,o=function(){var t;return t=n(),1e9*t[0]+t[1]},i=o()):Date.now?(t.exports=function(){return Date.now()-i},i=Date.now()):(t.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)}).call(e,o(90))},function(t,e){function o(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(t){if(u===setTimeout)return setTimeout(t,0);if((u===o||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function r(t){if(p===clearTimeout)return clearTimeout(t);if((p===n||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(t);try{return p(t)}catch(e){try{return p.call(null,t)}catch(e){return p.call(this,t)}}}function a(){m&&h&&(m=!1,h.length?f=h.concat(f):_=-1,f.length&&s())}function s(){if(!m){var t=i(a);m=!0;for(var e=f.length;e;){for(h=f,f=[];++_<e;)h&&h[_].run();_=-1,e=f.length}h=null,m=!1,r(t)}}function l(t,e){this.fun=t,this.array=e}function c(){}var u,p,d=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:o}catch(t){u=o}try{p="function"==typeof clearTimeout?clearTimeout:n}catch(t){p=n}}();var h,f=[],m=!1,_=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)e[o-1]=arguments[o];f.push(new l(t,e)),1!==f.length||m||i(s)},l.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(t,e){var o;o=function(){return this}();try{o=o||Function("return this")()||(0,eval)("this")}catch(n){"object"==typeof window&&(o=window)}t.exports=o},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(4),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=o(159),f=n(h),m=o(170),_=n(m),g=o(164),v=n(g),y=o(174),b=n(y),E=o(158),S=n(E),M=o(21),C=n(M),B=o(152),R=n(B),x=o(7),w=n(x),k=function(t){function e(){(0,s["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,c["default"])(this,t.call.apply(t,[this].concat(n)));a._screens={loading:f["default"],splash:_["default"],photoRoll:v["default"],webcam:b["default"],editor:S["default"],empty:C["default"]};var l=void 0;return a.props.options.preloader&&(l="loading"),a._screenAfterLoading,a.props.options.editor.image?a._screenAfterLoading="editor":a._screenAfterLoading="splash",l||(l=a._screenAfterLoading),a._previousScreensStack=[],a.state={activeScreen:a._screens[l],activeScreenName:l,screens:(0,r["default"])({},l,a._screens[l])},a}return(0,p["default"])(e,t),e.prototype.hasPreviousScreen=function(){return!!this._previousScreensStack.length},e.prototype.getPreviousScreen=function(){var t=this._previousScreensStack;return t[t.length-1]},e.prototype.switchToScreen=function(t){var e=this,o=null;if("back"===t){if(o=this._previousScreensStack.pop(),!o)throw new Error("Unable to switch to previous screen - no previous screen found.")}else{if("post-loading"===t&&(t=this._screenAfterLoading),o=this._screens[t],!o)throw new Error("Unknown screen `"+t+"`");this._previousScreensStack.push(this.state.activeScreen)}return this.state.screens[t]||(this.state.screens[t]=o),"editor"!==this.state.activeScreenName&&delete this.state.screens[this.state.activeScreenName],new d.Promise(function(n){e.setState({activeScreen:o,activeScreenName:t},function(){n()})})},e.prototype.setImage=function(t,e){var o=this,n=this.props.options;n.editor.image=t;var i=!this.refs.editorScreen;this.switchToScreen("editor").then(function(){i||o.refs.editorScreen.setImage(t,e)})},e.prototype["export"]=function(){if(this.state.activeScreen!==this._screens.editor)return d.Promise.reject(new Error("Unable to export: Active screen is not the editor screen."));if(this.state.screens.editor){var t;return(t=this.refs.editorScreen)["export"].apply(t,arguments)}},e.prototype.getEditor=function(){return this.state.activeScreen!==this._screens.editor?d.Promise.reject(new Error("Unable to get editor: Active screen is not the editor screen.")):this.state.screens.editor?this.refs.editorScreen.getEditor():void 0},e.prototype.serialize=function(){var t;return this.state.screens.editor?(t=this.refs.editorScreen).serialize.apply(t,arguments):d.Promise.reject(new Error("Editor screen unavailable"))},e.prototype.deserialize=function(t){return this.state.screens.editor?this.refs.editorScreen.deserialize(t):d.Promise.reject(new Error("Editor screen unavailable"))},e.prototype.getChildContext=function(){return{ui:this.props.ui,options:this.props.options,mediator:this.props.mediator}},e.prototype._renderScreens=function(){var t=[];for(var e in this.state.screens){var o=this.state.screens[e],n=this.state.activeScreen===o;t.push(d.ReactBEM.createElement(o,{ref:e+"Screen",app:this,visible:n}))}return t},e.prototype.render=function(){return d.ReactBEM.transform(d.ReactBEM.createElement("div",{bem:"b:editor"},d.ReactBEM.createElement(R["default"],{modalManager:w["default"].instance}),this._renderScreens()))},e}(d.React.Component);e["default"]=k,k.childContextTypes={ui:d.React.PropTypes.object.isRequired,mediator:d.React.PropTypes.object.isRequired,options:d.React.PropTypes.object.isRequired},k.propTypes={ui:d.React.PropTypes.object.isRequired,mediator:d.React.PropTypes.object.isRequired,options:d.React.PropTypes.object.isRequired}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(193);Object.defineProperty(e,"Provider",{enumerable:!0,get:function(){return n(i)["default"]}});var r=o(191);Object.defineProperty(e,"Library",{enumerable:!0,get:function(){return n(r)["default"]}});var a=o(194);Object.defineProperty(e,"SearchSuggestion",{enumerable:!0,get:function(){return n(a)["default"]}});var s=o(192);Object.defineProperty(e,"Photo",{enumerable:!0,get:function(){return n(s)["default"]}})},function(t,e){t.exports={controls:{overview:{filters:"Filter",adjustments:"Korrekturen",crop:"Zuschneiden",blur:"Weichzeichnen",border:"Rahmen",sticker:"Sticker",text:"Text",brush:"Malen","selective-blur":"Sel. Unschrfe"},border:{color:"Farbe",thickness:"Dicke"},text:{foreground:"Vordergrund",background:"Hintergrund",size:"Gre",font:"Schriftart",alignment:"Ausrichtung",takeToFront:"Nach oben"},adjustments:{brightness:"Helligkeit",contrast:"Kontrast",saturation:"Sttigung",gamma:"Gamma",exposure:"Belichtung",shadows:"Schatten",highlights:"Lichter",clarity:"Klarheit"},crop:{custom:"Manuell",square:"Quadratisch","4-3":"4:3","16-9":"16:9",rotation:"Drehung"},focus:{radial:"Kreisfrmig",linear:"Linear",blurRadius:"Radius"},selectiveBlur:{blurRadius:"Radius",thickness:"Dicke"},filters:{intensity:"Intensitt",categories:{all:"Alle",retro:"Retro",bw:"Schwarz & Wei",summer:"Sommer",winter:"Winter",special:"Spezial"}},sticker:{brightness:"Helligkeit",contrast:"Kontrast",saturation:"Sttigung",blur:"Weichzeichnen",flip:"Spiegeln","flip-v":"Spiegeln (V)","flip-h":"Spiegeln (H)",takeToFront:"Nach oben",categories:{all:"Alle",glasses:"Brillen",hats:"Hte",beards:"Brte",misc:"Gemischt"}},brush:{thickness:"Dicke",color:"Farbe"}},webcam:{headline:"Mache ein Foto!"},editor:{headline:"Foto editieren","new":"Neu",backgroundImage:"Hintergrundbild",undo:"Rckgngig","export":"Speichern"},splash:{upload:{button:"Lade ein Foto hoch",description:"Klicke hier, um ein Foto von deinem Rechner hochzuladen oder lade es per Drag-and-Drop hoch"},webcam:{headline:"Webcam",description:"Klicke hier, um ein Foto mit deiner Webcam zu machen"},photoRoll:{headline:"Kostenloses Bildmaterial",description:"Suche dir eines von tausenden Stock Photos aus."}},photoRoll:{search:{placeholder:"Nach Fotos suchen",noSearchResults:'Entschuldigung, aber wir konnten fr <strong>"${query}"</strong> leider keine Ergebnisse finden.',results:{headline:'Suchergebnisse fr "${query}"'}}},generic:{back:"Zurck",cancel:"Abbrechen",color:"Farbe"},loading:{resizing:"Bild wird bearbeitet...",exporting:"Exportiere...",loading:"Lade..."},warnings:{imageResized_maxMegaPixels:{title:"Bild verkleinert",text:"Da dein Bild die maximale Gre von ${maxMegaPixels} Megapixeln berschreitet, wurde es auf ${width}x${height} Pixel verkleinert."},imageResized_maxDimensions:{title:"Bild verkleinert",text:"Aufgrund von Hardware-Beschrnkungen wurde das Bild auf ${width}x${height} Pixel verkleinert."}},errors:{imageLoadFail:{title:"Bild konnte nicht geladen werden",text:"Beim Laden des Bildes unter ${path} ist ein Fehler aufgetreten."},webcamUnavailable:{title:"Webcam nicht verfgbar",text:"Webcam-Bild kann nicht dargestellt werden. (Fehler: ${error})"},webcamNotSupported:{title:"Webcam nicht untersttzt",text:"Dein Browser untersttzt das Webcam-Feature leider noch nicht."},renderingError:{title:"Rendering-Fehler",text:"Beim Rendern des Bildes ist ein Fehler aufgetreten."},context_lost:{title:"Es ist ein Fehler aufgetreten",text:"Dein Browser hat zu lange gebraucht, um das Bild zu generieren. Bitte versuche es noch einmal."},context_lost_limit:{title:"Es ist ein Fehler aufgetreten",text:"Bild-Generierung ist mehrmals fehlgeschlagen."},loadingStickersFailed:{title:"Laden der Sticker fehlgeschlagen"},photoRollLoadFail:{title:"Laden der Photo Roll fehlgeschlagen",text:"Die Photo Roll konnte nicht geladen werden: ${error}"}}}},function(t,e){t.exports={controls:{overview:{filters:"Filters",adjustments:"Adjust",crop:"Crop",focus:"Focus",border:"Border",sticker:"Sticker",text:"Text",brush:"Brush","selective-blur":"Selective Blur"},border:{color:"Color",thickness:"Thickness"},text:{foreground:"Foreground",background:"Background",size:"Size",font:"Font",alignment:"Alignment",takeToFront:"To Front"},adjustments:{brightness:"Brightness",contrast:"Contrast",saturation:"Saturation",exposure:"Exposure",gamma:"Gamma",shadows:"Shadows",highlights:"Highlights",clarity:"Clarity"},crop:{custom:"Custom",square:"Square","4-3":"4:3","16-9":"16:9",rotation:"Rotation"},focus:{radial:"Radial",linear:"Linear",blurRadius:"Blur radius"},selectiveBlur:{blurRadius:"Blur radius",thickness:"Thickness"},filters:{intensity:"Intensity",categories:{all:"All",retro:"Retro",bw:"Black & White",summer:"Summer",winter:"Winter",special:"Special"}},sticker:{brightness:"Brightness",contrast:"Contrast",saturation:"Saturation",blur:"Blur",flip:"Flip","flip-v":"Flip (V)","flip-h":"Flip (H)",takeToFront:"To Front",categories:{all:"All",glasses:"Glasses",hats:"Hats",beards:"Beards",misc:"Misc"}},brush:{thickness:"Thickness",color:"Color"}},webcam:{headline:"Take a photo!"},editor:{headline:"Edit Photo","new":"New",backgroundImage:"Background Image",undo:"Undo","export":"Export"},splash:{upload:{button:"Upload your image",description:"Upload a picture from your library or just drag and drop"},webcam:{headline:"Webcam",description:"Take a picture with your webcam or phone"},photoRoll:{headline:"Free stock footage",description:"Select from thousands of Free Stock Photos"}},photoRoll:{search:{placeholder:"Search for photos",noSearchResults:'Sorry, but we couldn\'t find any photos for <strong>"${query}"</strong>.',results:{headline:'Search results for "${query}"'}}},generic:{back:"Back",cancel:"Cancel",color:"Color"},loading:{resizing:"Resizing...",exporting:"Exporting...",loading:"Loading..."},warnings:{imageResized_maxMegaPixels:{title:"Image resized",text:"Your image exceeds the maximum size of ${maxMegaPixels} megapixels and has therefore been resized to ${width}x${height} pixels."},imageResized_maxDimensions:{title:"Image resized",text:"Due to hardware limitations your image has been resized to ${width}x${height} pixels."}},errors:{imageLoadFail:{title:"Failed to load image",text:"Failed to load the image at ${path}"},webcamUnavailable:{title:"Webcam unavailable",text:"Unable to display webcam image (Error: ${error})"},webcamNotSupported:{title:"Webcam not supported",text:"The webcam feature is not supported by your browser."},renderingError:{title:"Error while rendering",text:"An error has occurred while rendering the image."},context_lost:{title:"An error has occurred",text:"Your browser took too long to render the image. Please try applying less operations."},context_lost_limit:{title:"An error has occurred",text:"Your browser failed multiple times while rendering the image."},loadingStickersFailed:{title:"Failed to load stickers"},photoRollLoadFail:{title:"Failed to load Photo Roll",text:"Failed to load photos for the photo roll: ${error}"}}}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"e:cell m:largeButton"},u.ReactBEM.createElement("div",{bem:"$e:largeButton",onClick:this.props.onClick},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/back.png",!0)}))))},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(59),p=n(u),d=o(71),h=n(d),f=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._events={},a._needsStyleFixes=!1,a._bindAll("_onSharedStateUpdate","fixStyles"),a}return(0,c["default"])(e,t),e.prototype.fixStyles=function(){},e.prototype.componentDidMount=function(){this._bindEvents(),this.props.sharedState&&this.props.sharedState.on("update",this._onSharedStateUpdate),this._needsStyleFixes&&(this.fixStyles(),this.context.options.responsive&&window.addEventListener("resize",this.fixStyles))},e.prototype.componentWillUnmount=function(){this._unbindEvents(),this.props.sharedState&&this.props.sharedState.off("update",this._onSharedStateUpdate),this.context.options.responsive&&this._needsStyleFixes&&window.removeEventListener("resize",this.fixStyles)},e.prototype.componentWillReceiveProps=function(t){t.sharedState&&(this.props.sharedState&&this.props.sharedState.off("update",this._onSharedStateUpdate),t.sharedState.on("update",this._onSharedStateUpdate))},e.prototype._bindAll=function(){for(var t=this,e=arguments.length,o=Array(e),n=0;n<e;n++)o[n]=arguments[n];o.forEach(function(e){if("function"!=typeof t[e])throw new Error("_bindAll: "+t.constructor.name+"."+e+" is not a function.");t[e]=t[e].bind(t)})},e.prototype._t=function(t,e){return this.context.ui.translate(t,e)},e.prototype._getAssetPath=function(){var t;return(t=this.context.ui).getAssetPath.apply(t,arguments)},e.prototype._onSharedStateUpdate=function(t,e){this.sharedStateDidChange(e),this.shouldSharedComponentUpdate(t,e)&&this.forceUpdate()},e.prototype.shouldSharedComponentUpdate=function(t,e){return!0},e.prototype.sharedStateDidChange=function(t){},e.prototype.setSharedState=function(t,e){this.props.sharedState.set(t,e)},e.prototype.getSharedState=function(t){return this.props.sharedState.get(t)},e.prototype.forceSharedUpdate=function(){this.props.sharedState.broadcastUpdate()},e.prototype._bindEvents=function(){for(var t in this._events){var e=this._events[t];this.context.mediator.on(t,e)}},e.prototype._unbindEvents=function(){for(var t in this._events){var e=this._events[t];this.context.mediator.off(t,e)}},e.prototype._emitEvent=function(t){for(var e,o=arguments.length,n=Array(o>1?o-1:0),i=1;i<o;i++)n[i-1]=arguments[i];(e=this.context.mediator).emit.apply(e,[t].concat(n))},e.prototype.renderWithBEM=function(){return h["default"].createElement("div")},e.prototype.render=function(){return h["default"].transform(this.renderWithBEM())},e}(p["default"].Component);e["default"]=f,f.contextTypes={editor:p["default"].PropTypes.object,ui:p["default"].PropTypes.object,options:p["default"].PropTypes.object,mediator:p["default"].PropTypes.object,editorScreen:p["default"].PropTypes.object},f.propTypes={sharedState:p["default"].PropTypes.any}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.renderWithBEM=function(){var t="b:button";return this.props.uppercase&&(t+=" m:uppercase"),u.ReactBEM.createElement("button",{bem:t,className:this.props.className,onClick:this.props.onClick},this.props.children)},e}(u.BaseComponent);e["default"]=p,p.propTypes={onClick:u.React.PropTypes.func,children:u.React.PropTypes.any.isRequired,className:u.React.PropTypes.string},p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype._onItemClick=function(t){this.props.onChange&&this.props.onChange(t)},e.prototype._renderListItems=function(){var t=this;return this.props.items.map(function(e){var o=e.name===t.props.selectedItem.name;return u.ReactBEM.createElement("li",{bem:"$e:item",className:o?" is-active":"",onClick:t._onItemClick.bind(t,e)},u.ReactBEM.createElement("img",{bem:"e:icon",src:e.icon}),u.ReactBEM.createElement("div",{bem:"e:label"},e.label))})},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("div",{bem:"$b:categoryDropdown $e:overlay"},u.ReactBEM.createElement("ul",{bem:"$e:list"},this._renderListItems()))},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(11),d=n(p),h=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onKnobDrag","_onKnobDragStart"),a._value=a.props.initialValue.clone(),a._transparentPatternCanvas=u.Utils.createTransparentPatternCanvas(),a}return(0,c["default"])(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this._renderCanvas()},e.prototype.shouldComponentUpdate=function(t){var e=t.initialValue;return e!==this._value&&(this._value=e.clone(),this._renderCanvas(),!0)},e.prototype._onKnobDragStart=function(t,e){e.target===this.refs.knob?this._initialAlpha=this._value.a:this._setAlphaFromPosition(t)},e.prototype._onKnobDrag=function(t,e){var o=this.refs.canvas,n=o.offsetWidth,i=t.x/n;this._setAlpha(this._initialAlpha+i)},e.prototype._getKnobStyle=function(){return{left:(100*this._value.a).toFixed(2)+"%",top:"50%"}},e.prototype._setAlpha=function(t){this._value.a=t,this._value.a=Math.min(1,Math.max(0,this._value.a)),this.forceUpdate(),this.props.onChange&&this.props.onChange(this._value)},e.prototype._setAlphaFromPosition=function(t){var e=this.refs.canvas;this._initialAlpha=t.x/e.offsetWidth,this._setAlpha(this._initialAlpha)},e.prototype._renderCanvas=function(){var t=this.refs.canvas,e=t.getContext("2d");t.width=t.offsetWidth,t.height=t.offsetHeight;var o=e.createPattern(this._transparentPatternCanvas,"repeat");e.fillStyle=o,e.fillRect(0,0,t.width,t.height);var n=e.createLinearGradient(0,0,t.width,t.height),i=this._value.clone();i.a=0,n.addColorStop(0,i.toRGBA()),n.addColorStop(1,this._value.toHex()),e.fillStyle=n,e.fillRect(0,0,t.width,t.height)},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("div",{bem:"$b:colorPicker $e:alpha"},u.ReactBEM.createElement(d["default"],{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},u.ReactBEM.createElement("div",null,u.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),u.ReactBEM.createElement("div",{bem:"e:knob $b:knob m:transparent",ref:"knob",style:this._getKnobStyle()}))))},e}(u.BaseComponent);e["default"]=h,h.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(11),d=n(p),h=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));a._bindAll("_onKnobDrag","_onKnobDragStart"),a._value=a.props.initialValue.clone();var l=a._value.toHSV(),c=l[0],u=l[1],p=l[2];return a._hsvColor={h:c,s:u,v:p},a}return(0,c["default"])(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this._renderCanvas()},e.prototype.shouldComponentUpdate=function(t){var e=t.initialValue;if(e!==this._value){this._value=e.clone();var o=this._value.toHSV(),n=o[0],i=o[1],r=o[2];return this._hsvColor={h:n,s:i,v:r},this._renderCanvas(),!0}return!1},e.prototype._onKnobDragStart=function(t,e){e.target===this.refs.knob?this._initialHue=this._hsvColor.h:this._setValueFromPosition(t)},e.prototype._onKnobDrag=function(t,e){var o=this.refs.canvas,n=o.offsetHeight,i=t.y/n;this._setHue(this._initialHue+i)},e.prototype._getKnobStyle=function(){return{left:"50%",top:(100*this._hsvColor.h).toFixed(2)+"%"}},e.prototype._setHue=function(t){var e=this._hsvColor,o=e.s,n=e.v;t=Math.min(1,Math.max(0,t)),o=Math.max(.01,Math.min(o,.99)),n=Math.max(.01,Math.min(n,.99)),this._value=u.Color.fromHSV(t,o,n,this._value.a),this._hsvColor={h:t,s:o,v:n},this.forceUpdate(),this.props.onChange&&this.props.onChange(this._value)},e.prototype._setValueFromPosition=function(t){var e=this.refs.canvas;this._initialHue=t.y/e.offsetHeight,this._setHue(this._initialHue)},e.prototype._renderCanvas=function(){var t=this.refs.canvas,e=t.getContext("2d");t.width=t.offsetWidth,t.height=t.offsetHeight;for(var o=0;o<t.height;o++){var n=o/t.height,i=u.Color.fromHSV(n,1,1);e.strokeStyle=i.toRGBA(),e.beginPath(),e.moveTo(0,o),e.lineTo(t.width,o),e.stroke()}},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("div",{bem:"$b:colorPicker $e:hue"},u.ReactBEM.createElement(d["default"],{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},u.ReactBEM.createElement("div",null,u.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),u.ReactBEM.createElement("div",{bem:"e:knob $b:knob m:transparent",ref:"knob",style:this._getKnobStyle()}))))},e}(u.BaseComponent);e["default"]=h,h.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(100),d=n(p),h=o(103),f=n(h),m=o(101),_=n(m),g=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));a._value=a.props.initialValue.clone();var l=a._value.toHSV(),c=l[0],u=l[1],p=l[2];return a._hsv={h:c,s:u,v:p},a._bindAll("_onElementClick","_onColorChange","_onDocumentClick"),a}return(0,c["default"])(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),document.addEventListener("click",this._onDocumentClick)},e.prototype.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this),document.removeEventListener("click",this._onDocumentClick)},e.prototype._onDocumentClick=function(t){for(var e=t.target;e;e=e.parentNode)if(e===this.refs.root)return;this.props.onClose&&this.props.onClose()},e.prototype._onElementClick=function(t){t.stopPropagation()},e.prototype._onColorChange=function(t){this._value=t,this.props.onChange&&this.props.onChange(t)},e.prototype.renderWithBEM=function(){var t=void 0;return this.props.alpha!==!1&&(t=u.ReactBEM.createElement(d["default"],{initialValue:this._value,onChange:this._onColorChange})),u.ReactBEM.createElement("div",{bem:"$b:colorPicker $e:overlay",onClick:this._onElementClick,ref:"root"},t,u.ReactBEM.createElement("div",{bem:"e:bottom"},u.ReactBEM.createElement(f["default"],{initialValue:this._value,onChange:this._onColorChange}),u.ReactBEM.createElement(_["default"],{initialValue:this._value,onChange:this._onColorChange})))},e}(u.BaseComponent);e["default"]=g,g.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(11),d=n(p),h=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));a._bindAll("_onKnobDrag","_onKnobDragStart"),a._value=a.props.initialValue.clone();var l=a._value.toHSV(),c=l[0],u=l[1],p=l[2];return a._hsvColor={h:c,s:u,v:p},a}return(0,c["default"])(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this._renderCanvas()},e.prototype.shouldComponentUpdate=function(t){var e=t.initialValue;if(e!==this._value){this._value=e.clone();var o=this._value.toHSV(),n=o[0],i=o[1],r=o[2];return this._hsvColor={h:n,s:i,v:r},this._renderCanvas(),!0}return!1},e.prototype._onKnobDragStart=function(t,e){e.target===this.refs.knob?(this._initialValue=this._hsvColor.v,this._initialSaturation=this._hsvColor.s):this._setValuesFromPosition(t)},e.prototype._onKnobDrag=function(t,e){var o=this.refs.canvas,n=o.offsetWidth,i=o.offsetHeight,r=t.x/n,a=t.y/i*-1,s=this._hsvColor.h;this._setHSV(s,this._initialSaturation+r,this._initialValue+a)},e.prototype._getKnobStyle=function(){var t=this._hsvColor,e=t.s,o=t.v;return{left:(100*e).toFixed(2)+"%",top:(100*(1-o)).toFixed(2)+"%"}},e.prototype._setHSV=function(t,e,o){e=Math.max(.01,Math.min(e,.99)),o=Math.max(.01,Math.min(o,.99)),this._value=u.Color.fromHSV(t,e,o,this._value.a),this._hsvColor={h:t,s:e,v:o},this.forceUpdate(),this.props.onChange&&this.props.onChange(this._value)},e.prototype._setValuesFromPosition=function(t){var e=this.refs.canvas;this._initialSaturation=t.x/e.offsetWidth,this._initialValue=1-t.y/e.offsetHeight;var o=this._hsvColor.h;this._setHSV(o,this._initialSaturation,this._initialValue)},e.prototype._renderCanvas=function(){var t=this.refs.canvas,e=t.getContext("2d");t.width=t.offsetWidth,t.height=t.offsetHeight;for(var o=e.getImageData(0,0,t.width,t.height),n=0;n<t.height;n++)for(var i=(t.height-n)/t.height,r=0;r<t.width;r++){var a=r/t.width,s=u.Color.fromHSV(this._hsvColor.h,a,i),l=s.r,c=s.g,p=s.b,d=s.a,h=4*(n*t.width+r);o.data[h]=255*l,o.data[h+1]=255*c,o.data[h+2]=255*p,o.data[h+3]=255*d}e.putImageData(o,0,0)},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("div",{bem:"$b:colorPicker $e:saturation"},u.ReactBEM.createElement(d["default"],{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},u.ReactBEM.createElement("div",null,u.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),u.ReactBEM.createElement("div",{bem:"e:knob $b:knob m:transparent",ref:"knob",style:this._getKnobStyle()}))))},e}(u.BaseComponent);e["default"]=h,h.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(5),d=n(p),h=o(10),f=n(h),m=o(20),_=n(m),g=o(126),v=(n(g),[{identifier:"brightness",isAvailable:function(t){return t.isToolEnabled("brightness")},defaultValue:0,valueMultiplier:100,valueOffset:0},{identifier:"saturation",isAvailable:function(t){return t.isToolEnabled("saturation")},defaultValue:1,valueMultiplier:100,valueOffset:-100},{identifier:"contrast",isAvailable:function(t){return t.isToolEnabled("contrast")},defaultValue:1,valueMultiplier:100,valueOffset:-100},{identifier:"gamma",isAvailable:function(t){return t.isToolEnabled("gamma")},defaultValue:1,valueMultiplier:100,valueOffset:-100},{identifier:"clarity",isAvailable:function(t){return t.isToolEnabled("clarity")},defaultValue:0,
valueMultiplier:100,valueOffset:0},{identifier:"exposure",isAvailable:function(t){return t.isToolEnabled("exposure")},defaultValue:0,valueMultiplier:100,valueOffset:0},{identifier:"shadows",isAvailable:function(t){return t.isToolEnabled("shadows")},defaultValue:1,valueMultiplier:100,valueOffset:-100},{identifier:"highlights",isAvailable:function(t){return t.isToolEnabled("highlights")},defaultValue:1,valueMultiplier:100,valueOffset:0}]),y=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));a._bindAll("_onSliderValueChange");var l=a.context.editor;return a._operation=l.operations.getOrCreate("adjustments"),a.state={selectedControls:null},a}return(0,c["default"])(e,t),e.prototype._onBackClick=function(e){var o=this.context.editor,n=this.getSharedState("operationExistedBefore"),i=this.getSharedState("initialOptions");this._operation.optionsEqual(i)||o.history.add(this._operation,i,n);var r=this._operation.getDefaultOptions();this._operation.optionsEqual(r)&&o.operations.remove(this._operation),t.prototype._onBackClick.call(this,e)},e.prototype._onSliderValueChange=function(t){var e=this.state.selectedControls,o=e.identifier,n=e.valueMultiplier,i=e.valueOffset;t=(t-i)/n,this._operation.setOption(o,t);var r=this.context.editor;r.render()},e.prototype._onButtonClick=function(t,e){this.setState({selectedControls:t})},e.prototype._buildSliderProps=function(t){var e=t.identifier,o=t.defaultValue,n=t.valueMultiplier,i=t.valueOffset,r=-1*n,a=1*n,s=this._operation?this._operation.getOption(e):o;return s*=n,s+=i,{minValue:r,maxValue:a,value:s,valueUnit:"%",positiveValuePrefix:"+",label:this._t("controls.adjustments."+e),middleDot:!0,onChange:this._onSliderValueChange}},e.prototype.renderOverlayControls=function(){var t=this.state.selectedControls;if(t){var e=this._buildSliderProps(t);return u.ReactBEM.createElement(_["default"],e)}},e.prototype._renderListItems=function(){var t=this;return v.filter(function(e){return e.isAvailable(t.context.editor)}).map(function(e){var o=t.state.selectedControls===e,n=o?"is-active":null,i=void 0;return u.ReactBEM.createElement("li",{bem:"e:item",key:e.identifier,"data-identifier":e.identifier},u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",onClick:t._onButtonClick.bind(t,e),className:n},u.ReactBEM.createElement("img",{bem:"e:icon",src:t._getAssetPath("controls/adjustments/"+e.identifier+".png",!0)}),u.ReactBEM.createElement("div",{bem:"e:label"},t._t("controls.adjustments."+e.identifier)),i)))})},e.prototype.renderControls=function(){var t=this._renderListItems();return u.ReactBEM.createElement("div",{bem:"e:cell m:list"},u.ReactBEM.createElement(f["default"],null,u.ReactBEM.createElement("ul",{bem:"$e:list"},t)))},e}(d["default"]);e["default"]=y,y.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(6),p=n(u),d=o(104),h=n(d),f=["brightness","clarity","contrast","exposure","highlights","saturation","shadows","gamma"],m=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.onEnter=function(t){var e=this.context.editor,o=e.operations.exists("adjustments"),n=e.operations.getOrCreate("adjustments"),i=n.serializeOptions();this.setSharedState({operation:n,operationExistedBefore:o,initialOptions:i})},e.isAvailable=function(t){return f.filter(function(e){return t.isToolEnabled(e)}).length>0},e.getPreloadAssets=function(t){return f.filter(function(e){return t.isToolEnabled(e)}).map(function(t){return"controls/adjustments/"+t+".png"})},e}(p["default"]);m.controlsComponent=h["default"],m.identifier="adjustments",m.iconPath="controls/overview/adjustments.png",m.languageKey="controls.overview.adjustments",m.defaultOptions={},e["default"]=m},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(5),d=n(p),h=o(14),f=n(h),m=o(37),_=n(m),g=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._hasDoneButton=!0,a._operation=a.getSharedState("operation"),a._bindAll("_onThicknessUpdate","_onColorUpdate"),a}return(0,c["default"])(e,t),e.prototype._onThicknessUpdate=function(t){var e=this.context.editor,o=this.getSharedState("inputDimensions");this._operation.setThickness(t/o.min()),e.render()},e.prototype._onBackClick=function(e){var o=this.context.editor;this.getSharedState("operationExistedBefore")?this._operation.set(this.getSharedState("initialOptions")):o.operations.remove(this._operation),o.zoom.undo(),o.features.enable("zoom","drag"),o.render(),t.prototype._onBackClick.call(this,e)},e.prototype._onColorUpdate=function(t){this._operation.setColor(t);var e=this.context.editor;e.render()},e.prototype.renderControls=function(){var t=this.getSharedState("inputDimensions"),e=0,o=.5*t.min(),n=this._operation.getThickness()*t.min();return[u.ReactBEM.createElement("div",{bem:"e:cell m:slider"},u.ReactBEM.createElement(f["default"],{style:"large",minValue:e,maxValue:o,valueUnit:"px",middleDot:!1,label:this._t("controls.border.thickness"),onChange:this._onThicknessUpdate,value:n})),u.ReactBEM.createElement("div",{bem:"e:cell m:colorPicker"},u.ReactBEM.createElement(_["default"],{initialValue:this._operation.getColor().clone(),onChange:this._onColorUpdate}))]},e}(d["default"]);e["default"]=g,g.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(6),p=n(u),d=o(106),h=n(d),f=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.onEnter=function(t){var e=this.context.editor,o=e.operations.exists("border"),n=e.operations.getOrCreate("border",{thickness:.05}),i=n.serializeOptions(["color","thickness"]);this.setSharedState({operation:n,operationExistedBefore:o,initialOptions:i,inputDimensions:n.getInputDimensions()}),e.zoom.set("auto",function(){e.features.disable("zoom","drag")})},e.onExit=function(){var t=this.context.editor,e=this.getSharedState("operation");t.history.add(e,this.getSharedState("initialOptions"),this.getSharedState("operationExistedBefore")),e.setEnabled(!0),t.zoom.undo(),t.features.enable("zoom","drag"),t.render()},e.isAvailable=function(t){return t.isToolEnabled("border")},e}(p["default"]);f.controlsComponent=h["default"],f.identifier="border",f.iconPath="controls/overview/border.png",f.languageKey="controls.overview.border",f.defaultOptions={},e["default"]=f},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(4),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=o(30),f=n(h),m=function(t){function e(){(0,s["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,c["default"])(this,t.call.apply(t,[this].concat(n)));return a._windowResized=!1,a._drawing=!1,a._bindAll("_onMouseEnter","_onMouseLeave","_onMouseDown","_onMouseMove","_onMouseUp","_onMouseMoveOnCanvas","_onWindowResize"),a._lastDrawPosition=null,a._events=d.SDKUtils.extend(a._events,(0,r["default"])({},d.Constants.EVENTS.WINDOW_RESIZE,a._onWindowResize)),a.state={cursorVisible:!1,cursorPosition:new d.Vector2},a}return(0,p["default"])(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this._updateContainerRect()},e.prototype.componentDidUpdate=function(){this._windowResized&&(this._updateContainerRect(),this._windowResized=!1)},e.prototype._onWindowResize=function(){this._windowResized=!0},e.prototype._onOperationRemoved=function(t){},e.prototype._onOperationUpdated=function(t){t===this.getSharedState("operation")&&this.forceUpdate()},e.prototype._onMouseDown=function(t){t.preventDefault(),this._optionsBeforeDraw=this.getSharedState("operation").serializeOptions(),delete this._optionsBeforeDraw.enabled,this._operationExistedBeforeDraw=this.getSharedState("operationExistedBefore"),this.setSharedState({operationExistedBefore:!0},!1);var e=this.context.editor.getOutputDimensions(),o=this._getCursorPosition(t),n=this.getSharedState("brush"),i=this.getSharedState("thickness")/e.min(),r=this.getSharedState("color"),a=this.getSharedState("hardness");this._drawing=!0,this._currentPath=n.createPath(i,a,r),this._currentPath.addControlPoint(o.clone().divide(e)),document.addEventListener("mousemove",this._onMouseMove),document.addEventListener("touchmove",this._onMouseMove),document.addEventListener("mouseup",this._onMouseUp),document.addEventListener("touchend",this._onMouseUp)},e.prototype._onMouseUp=function(){this._currentPath.setClosed(!0);var t=this.context.editor,e=t.getOutputTextureDimensions();this.getSharedState("brush").render(e),this._currentPath=null,this._drawing=!1,t.history.add(this.getSharedState("operation"),this._optionsBeforeDraw,this._operationExistedBeforeDraw),document.removeEventListener("mousemove",this._onMouseMove),document.removeEventListener("touchmove",this._onMouseMove),document.removeEventListener("mouseup",this._onMouseUp),document.removeEventListener("touchend",this._onMouseUp)},e.prototype._onMouseEnter=function(t){var e=this._getCursorPosition(t);this.setState({cursorVisible:!0,cursorPosition:e}),this._onMouseMove(t)},e.prototype._onMouseLeave=function(){this.setState({cursorVisible:!1})},e.prototype._onMouseMove=function(t){var e=this.context.editor,o=e.getOutputDimensions(),n=e.getOutputTextureDimensions(),i=e.zoom.get(),r=this._getCursorPosition(t);this.setState({cursorPosition:r});var a=void 0;if(this._lastDrawPosition){var s=this.getSharedState("thickness"),l=this._lastDrawPosition.clone().subtract(r).abs().len()/i;a=l>=s/10}else a=!0;this._drawing&&a&&(this._currentPath.addControlPoint(r.clone().divide(o)),this.getSharedState("brush").render(n),this._lastDrawPosition=r.clone())},e.prototype._onMouseMoveOnCanvas=function(t){var e=this._getCursorPosition(t);this.setState({cursorPosition:e})},e.prototype._getCursorStyle=function(){var t=this.getSharedState("thickness"),e=this.getSharedState("color"),o=this.state.cursorPosition;return{left:o.x,top:o.y,width:t,height:t,background:e.toRGBA(),marginLeft:t*-.5,marginTop:t*-.5}},e.prototype._updateContainerRect=function(){this._containerBoundingRect=this.refs.innerContainer.getBoundingClientRect()},e.prototype._getCursorPosition=function(t){var e=d.Utils.getEventPosition(t),o=this._containerBoundingRect;return e.subtract(o.left,o.top)},e.prototype._getContainerProps=function(){var e=t.prototype._getContainerProps.call(this);return e.onMouseDown=e.onTouchStart=this._onMouseDown,e},e.prototype._getInnerContainerProps=function(){var e=t.prototype._getInnerContainerProps.call(this);return delete e.onClick,e.onMouseEnter=this._onMouseEnter,e.onMouseLeave=this._onMouseLeave,e.onMouseMove=this._onMouseMoveOnCanvas,e},e.prototype._renderOverlayControls=function(){var t=this.state.cursorVisible?"is-visible":null;return d.ReactBEM.createElement("div",{bem:"$b:brushCanvasControls"},d.ReactBEM.createElement("div",{bem:"e:cursor",className:t,style:this._getCursorStyle()}))},e}(f["default"]);e["default"]=m,m.contextTypes=f["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(4),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=o(5),f=n(h),m=o(14),_=n(m),g=o(10),v=n(g),y=o(37),b=n(y),E=o(111),S=n(E),M=function(t){function e(){var o;(0,s["default"])(this,e);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var l=(0,c["default"])(this,t.call.apply(t,[this].concat(i)));return l._hasDoneButton=!1,l._brushOptions={thickness:l.getSharedState("thickness"),color:l.getSharedState("color").clone()},l._hasPresets=l.props.options.thicknessPresets&&l.props.options.thicknessPresets.length>0,l._hasSlider=!l._hasPresets,l._bindAll("_onThicknessUpdated","_onColorUpdated","_onOperationUpdated","_onOperationRemoved"),l.state={thicknessControlsEnabled:!1},l._events=(o={},(0,r["default"])(o,d.Constants.EVENTS.OPERATION_UPDATED,l._onOperationUpdated),(0,r["default"])(o,d.Constants.EVENTS.OPERATION_REMOVED,l._onOperationRemoved),o),l}return(0,p["default"])(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this);var e=this.context.editor;e.zoom.set("auto"),e.features.disable("zoom","drag")},e.prototype._onThicknessClick=function(t){this._onThicknessUpdated(t),this.forceUpdate()},e.prototype._onOperationRemoved=function(t){if(t===this.getSharedState("operation")&&!this._backButtonClicked){var e=this.context.editor,o=e.operations.getOrCreate("sprite"),n=o.createBrush();o.addSprite(n),this.setSharedState({operation:o,brush:n,operationExistedBefore:!1,initialOptions:{}}),e.render()}},e.prototype._onOperationUpdated=function(t){var e=this;t===this.getSharedState("operation")&&!function(){var o=e.getSharedState("brush");if(o){var n=t.getSprites().filter(function(t){return t.getId()===o.getId()})[0];e.setSharedState({brush:n})}t.setEnabled(!0),e.context.editor.render(function(){t.setEnabled(!1),e.context.editor.render()})}()},e.prototype._onThicknessUpdated=function(t){this.setSharedState({thickness:t}),this._brushOptions.thickness=t},e.prototype._onColorUpdated=function(t){this.setSharedState({color:t}),this._brushOptions.color=t.clone()},e.prototype._renderThicknessItems=function(){var t=this,e=this.props.options.thicknessPresets,o=Math.max.apply(null,e);return e.map(function(e){var n=t.getSharedState("thickness")===e;return d.ReactBEM.createElement(S["default"],{thickness:e,maxThickness:o,active:n,key:e,onClick:t._onThicknessClick.bind(t,e)})})},e.prototype.renderControls=function(){var t=this.context.editor,e=t.zoom.get(),o=[];if(this._hasSlider){var n=t.getFinalDimensions(),i=1,r=Math.round(n.clone().multiply(e).min()/2),a=this._brushOptions.thickness;o.push(d.ReactBEM.createElement("div",{bem:"e:cell m:slider"},d.ReactBEM.createElement(_["default"],{style:"large",minValue:i,maxValue:r,valueUnit:"px",middleDot:!1,label:this._t("controls.brush.thickness"),onChange:this._onThicknessUpdated,value:a})))}else this._hasPresets&&o.push(d.ReactBEM.createElement("div",{bem:"e:cell m:list"},d.ReactBEM.createElement(v["default"],null,d.ReactBEM.createElement("ul",{bem:"$e:list"},this._renderThicknessItems()))));return o.push(d.ReactBEM.createElement("div",{bem:"e:cell m:colorPicker"},d.ReactBEM.createElement(b["default"],{initialValue:this._brushOptions.color.clone(),onChange:this._onColorUpdated}))),o},e}(f["default"]);e["default"]=M,M.contextTypes=f["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(6),d=n(p),h=o(109),f=n(h),m=o(108),_=n(m),g=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.onExit=function(){var t=this.context.editor,e=this.getSharedState("operation");e.setEnabled(!0),t.zoom.undo(),t.features.enable("zoom","drag"),t.render()},e.onEnter=function(t,e){var o=this.context.editor;o.zoom.set("auto",function(){r.setEnabled(!1),o.render()});var n=o.getOutputDimensions(),i=o.operations.exists("sprite"),r=o.operations.getOrCreate("sprite"),a=r.createBrush(),s=r.serializeOptions();r.addSprite(a);var l=.05*n.min();e.thicknessPresets&&e.thicknessPresets.length>0&&(l=e.thicknessPresets[0]);var c=new u.Color(1,0,0,1),p=1;this.setSharedState({operationExistedBefore:i,operation:r,brush:a,initialOptions:s,thickness:l,color:c,hardness:p})},e.isAvailable=function(t){return t.isToolEnabled("brush")},e.getPreloadAssets=function(){return["controls/brush/thickness.png"]},e}(d["default"]);g.controlsComponent=f["default"],g.canvasControlsComponent=_["default"],g.identifier="brush",g.iconPath="controls/overview/brush.png",g.languageKey="controls.overview.brush",g.defaultOptions={thicknessPresets:[]},e["default"]=g},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this._renderCanvas()},e.prototype.componentDidUpdate=function(){this._renderCanvas()},e.prototype._renderCanvas=function(){var t=this.refs.canvas,e=t.getContext("2d");t.width=t.offsetWidth,t.height=t.offsetHeight;var o=this.props,n=o.maxThickness,i=o.thickness,r=t.width*(i/n),a=r/2;e.fillStyle="white",e.beginPath(),e.arc(t.width/2,t.height/2,a,0,2*Math.PI),e.fill()},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("bem",{specifier:"$b:controls $e:list"},u.ReactBEM.createElement("li",{bem:"e:item",onClick:this.props.onClick},u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:this.props.active?"is-active":null},u.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),u.ReactBEM.createElement("div",{bem:"e:label"},this.props.thickness)))))},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(11),d=n(p),h=o(24),f=n(h),m=new u.Vector2(50,50),_=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._needsStyleFixes=!0,a._bindAll("_onCenterDragStart","_onCenterDrag"),a.state={dimensions:a.getSharedState("initialDimensions")},a}return(0,c["default"])(e,t),e.prototype.fixStyles=function(){if(u.Utils.Browser.isIElte(11)){var t=this.context.editor,e=this.refs.container,o=t.getCanvasDimensions(!1),n=o.y;e.style.height=n+"px"}},e.prototype.sharedStateDidChange=function(t){t!==this.getSharedState("ratio")&&this._updateDimensions()},e.prototype._updateDimensions=function(){var t=this.getSharedState("operation"),e=this.getSharedState("ratio")||{ratio:"*"},o=void 0;if(e.dimensions)o=e.dimensions.clone();else{var n=t.getInputDimensions(),i=this.getSharedState("start"),r=this.getSharedState("end"),a=r.clone().subtract(i);o=a.multiply(n).floor()}this.setState({dimensions:o})},e.prototype._onCenterDragStart=function(){var t=this.getSharedState("start"),e=this.getSharedState("end");this._initialValues={start:t.clone(),end:e.clone(),size:e.clone().subtract(t)}},e.prototype._onCenterDrag=function(t){var e=this.context.editor,o=this._initialValues,n=o.start,i=o.size,r=e.getOutputDimensions(),a=t.clone().divide(r),s=new u.Vector2(0,0),l=new u.Vector2(1,1).subtract(i),c=n.clone().add(a).clamp(s,l),p=c.clone().add(i);this.setSharedState({start:c,end:p})},e.prototype._onKnobDragStart=function(t){this._currentDragOption=t,this._initialValues={start:this.getSharedState("start").clone(),end:this.getSharedState("end").clone()}},e.prototype._onKnobDrag=function(t,e){var o=this.context.editor,n=o.getOutputDimensions(),i=this.getSharedState("ratio")||{ratio:"*"},r=i.ratio,a=this._initialValues.end.clone().subtract(this._initialValues.start).multiply(n),s=void 0;if("start"===t?(a.subtract(e),s=this._initialValues.end.clone().multiply(n)):"end"===t&&(a.add(e),s=new u.Vector2(1,1).subtract(this._initialValues.start).multiply(n)),a.x=Math.min(Math.max(m.x,a.x),s.x),"*"!==r&&(a.y=a.x/r),a.y=Math.min(Math.max(m.y,a.y),s.y),"*"!==r&&(a.x=a.y*r),"start"===t){var l=this._initialValues.end.clone().subtract(a.clone().divide(n));this.setSharedState({start:l},!1),this._updateDimensions()}else if("end"===t){var c=this._initialValues.start.clone().add(a.clone().divide(n));this.setSharedState({end:c},!1),this._updateDimensions()}},e.prototype._calculateDimensions=function(){var t=this.context.editor,e=this.getSharedState("start"),o=this.getSharedState("end");return o.clone().subtract(e).multiply(t.getInputDimensions()).round()},e.prototype._getAreaStyles=function(){var t=this.context.editor,e=t.getOutputDimensions(),o=t.getCanvasDimensions(),n=this.getSharedState("start").clone().multiply(e).floor(),i=this.getSharedState("end").clone().multiply(e).ceil(),r=i.clone().subtract(n),a=o.clone().subtract(e).divide(2).floor(),s=t.getPadding();return n.add(a).add(0,s[0]),{topLeft:this._getDimensionsStyles(n.x,n.y),topCenter:this._getDimensionsStyles(r.x,n.y),centerLeft:this._getDimensionsStyles(n.x,r.y),center:this._getDimensionsStyles(r.x,r.y)}},e.prototype._getDimensionsStyles=function(t,e){return{width:Math.max(1,t),height:Math.max(1,e)}},e.prototype.renderWithBEM=function(){var t=this.state.dimensions,e=this._getAreaStyles();return u.ReactBEM.createElement("div",{bem:"b:canvasControls e:container m:full",ref:"container"},u.ReactBEM.createElement("div",{bem:"$b:cropCanvasControls"},u.ReactBEM.createElement("div",{bem:"e:row"},u.ReactBEM.createElement("div",{bem:"e:cell m:dark",style:e.topLeft},""),u.ReactBEM.createElement("div",{bem:"e:cell m:dark",style:e.topCenter},""),u.ReactBEM.createElement("div",{bem:"e:cell m:dark"})),u.ReactBEM.createElement("div",{bem:"e:row"},u.ReactBEM.createElement("div",{bem:"e:cell m:dark",style:e.centerLeft},""),u.ReactBEM.createElement(d["default"],{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},u.ReactBEM.createElement("div",{bem:"e:cell m:bordered",style:e.center},u.ReactBEM.createElement(d["default"],{onStart:this._onKnobDragStart.bind(this,"start"),onDrag:this._onKnobDrag.bind(this,"start")},u.ReactBEM.createElement("div",{bem:"e:knob m:topLeft $b:knob"},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-down.png",!0)}))),u.ReactBEM.createElement("div",{bem:"e:dimensions"},t.x+"x"+t.y),u.ReactBEM.createElement(d["default"],{onStart:this._onKnobDragStart.bind(this,"end"),onDrag:this._onKnobDrag.bind(this,"end")},u.ReactBEM.createElement("div",{bem:"e:knob m:bottomRight $b:knob"},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-down.png",!0)}))))),u.ReactBEM.createElement("div",{bem:"e:cell m:dark"},"")),u.ReactBEM.createElement("div",{bem:"e:row"},u.ReactBEM.createElement("div",{bem:"e:cell m:dark"},""),u.ReactBEM.createElement("div",{bem:"e:cell m:dark"},""),u.ReactBEM.createElement("div",{bem:"e:cell m:dark"},""))))},e}(f["default"]);e["default"]=_,_.contextTypes=f["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(5),d=n(p),h=o(10),f=n(h),m=o(20),_=n(m),g=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._hasDoneButton=!0,a._bindAll("_selectRatio","_onRotationChange"),a.state={ratio:null},a._ratios=a.constructor.getRatios(a.props.options),a._selectInitialRatio(!a.getSharedState("cropOperationExistedBefore")),a}return(0,c["default"])(e,t),e.getRatios=function(t){var e=t.ratios,o=t.replaceRatios,n=t.selectableRatios;e=e||[];var i=void 0;return i=u.Constants.DEFAULTS.CROP_RATIOS,i=o?e:i.concat(e),n&&n.length&&(i=u.Utils.select(i,n,function(t){return t.name})),i},e.prototype.shouldSharedComponentUpdate=function(t,e){return t.ratio!==e.ratio},e.prototype._onRotationChange=function(t){var e=this.context.editor;t=t*Math.PI/180,e.setRotation(t),this._updateSpriteScale(),e.render(),this.setSharedState({rotation:t})},e.prototype._updateSpriteScale=function(){var t=this.context.editor,e=this._getRotatedSpriteDimensions(),o=t.getOutputDimensions(!1),n=o.clone().multiply(.5);n.subtract(e.clone().divide(2)),n.abs();var i=1;i=n.y>n.x?2*n.y/o.y+1:2*n.x/o.x+1,t.setSpriteScale(i)},e.prototype._getRotatedSpriteDimensions=function(){var t=this.context.editor,e=t.getRotation(),o=t.getOutputDimensions(!1);return new u.Vector2(Math.abs(o.x*Math.cos(e))+Math.abs(o.y*Math.sin(e)),Math.abs(o.x*Math.sin(e))+Math.abs(o.y*Math.cos(e)))},e.prototype._onBackClick=function(e){var o=this.context.editor,n=this.getSharedState("operation");this.getSharedState("cropOperationExistedBefore")?(n.set(this.getSharedState("initialCropOptions")),n.setEnabled(!0,!1)):o.operations.remove(n),o.setPadding(!1),o.setRotation(0),o.setSpriteScale(1),o.features.enable("zoom","drag"),o.zoom.undo(),t.prototype._onBackClick.call(this,e)},e.prototype._onDoneClick=function(e){var o=this.context.editor,n=this.getSharedState("ratio"),i=this.getSharedState("start").clone(),r=this.getSharedState("end").clone(),a={rotation:o.getRotation(),scale:o.getSpriteScale(),start:i,end:r,dimensions:n.dimensions||null,enabled:!0},s=o.operations.get("crop"),l=o.operations.get("orientation");o.broadcastCrop(s,a),s.set(a),o.setPadding(!1),o.setRotation(0),o.setSpriteScale(1);var c=[],u=this.getSharedState("initialCropOptions"),p=this.getSharedState("cropOperationExistedBefore");s.optionsEqual(u)?p||o.operations.remove(s):c.push({operation:s,options:u,existent:p,undo:function(t,e){o.broadcastCrop(t,e)}});var d=this.getSharedState("initialOrientationOptions"),h=this.getSharedState("orientationOperationExistedBefore");l.optionsEqual(d)?h||o.operations.remove(l):c.push({operation:l,options:d,existent:h,undo:function(t,e){t.getRotation()!==e.rotation&&o.broadcastRotate(e.rotation-t.getRotation());var n=e.rotation,i=90===n||270===n;t.getFlipVertically()!==e.flipVertically?o.broadcastFlip(i?"horizontal":"vertical"):t.getFlipHorizontally()!==e.flipHorizontally&&o.broadcastFlip(i?"vertical":"horizontal")}}),c.length&&o.history.add(c),o.features.enable("zoom","drag"),o.zoom.set("auto"),t.prototype._onDoneClick.call(this,e)},e.prototype._selectInitialRatio=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=this.getSharedState("operation"),o=null,n=e._ratio;if(n){var i=this._ratios.filter(function(t){return t===n});o=i[0]}if(!o){var r=this._ratios.filter(function(t){return t.selected});o=r.pop()}return o||(o=this._ratios[0]),this._selectRatio(o,t,!1)},e.prototype._selectRatio=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.getSharedState("operation");e&&this._setDefaultOptionsForRatio(t,o),n._ratio=t,this.setSharedState({ratio:t},o)},e.prototype._setDefaultOptionsForRatio=function(t){var e=t.ratio,o=(t.name,arguments.length>1&&void 0!==arguments[1]&&arguments[1]),n=this.context.editor,i=new u.Vector2,r=new u.Vector2;if("*"===e)i=new u.Vector2(0,0),r=new u.Vector2(1,1);else{var a=n.getOutputDimensions(),s=a.x/a.y;if(s<=e){var l=1/a.y*(a.x/e);i.set(0,(1-l)/2),r.set(1,1-i.y)}else{var c=1/a.x*(e*a.y);i.set((1-c)/2,0),r.set(1-i.x,1)}}this.setSharedState({start:i,end:r},o)},e.prototype.renderOverlayControls=function(){var t=180*this.getSharedState("rotation")/Math.PI;return u.ReactBEM.createElement(_["default"],{value:t,minValue:-45,middleDot:!0,maxValue:45,valueUnit:"",label:this._t("controls.crop.rotation"),onChange:this._onRotationChange})},e.prototype.renderControls=function(){var t=this,e=this._ratios.map(function(e){return u.ReactBEM.createElement("li",{bem:"e:item",key:e.name},u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:t.getSharedState("ratio")===e?"is-active":null,onClick:t._selectRatio.bind(t,e)},u.ReactBEM.createElement("img",{bem:"e:icon",src:t._getAssetPath("controls/crop/"+e.name+".png",!0)}),u.ReactBEM.createElement("div",{bem:"e:label"},t._t("controls.crop."+e.name)))))});return u.ReactBEM.createElement("div",{bem:"e:cell m:list"},u.ReactBEM.createElement(f["default"],null,u.ReactBEM.createElement("ul",{bem:"$e:list"},e)))},e}(d["default"]);e["default"]=g,g.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(4),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=o(31),f=n(h),m=function(t){function e(){return(0,s["default"])(this,e),(0,c["default"])(this,t.apply(this,arguments))}return(0,p["default"])(e,t),e.prototype._onRotateClick=function(t){var e=void 0;"cw"===t?e=90:"ccw"===t&&(e=-90);var o=this.context.editor,n=this.getSharedState("orientationOperation"),i=(n.getRotation()+e)%360,r=this.getSharedState("start"),a=this.getSharedState("end"),s=r.clone();"cw"===t?(r.set(1-a.y,s.x),a.set(1-s.y,a.x)):"ccw"===t&&(r.set(s.y,1-a.x),a.set(a.y,1-s.x)),n.set({rotation:i}),this.setSharedState({orientationRotation:i,start:r,end:a}),o.broadcastRotate(e),o.zoom.set("auto")},e.prototype._onFlipClick=function(t){var e,o=this.context.editor,n=this.getSharedState("orientationOperation"),i=!this.getSharedState("flip"+t),a=this.getSharedState("rotation")*-1;this.setSharedState((e={},(0,r["default"])(e,"flip"+t,i),(0,r["default"])(e,"rotation",a),e)),o.setRotation(a),n.flip(t);var s=this.getSharedState("start"),l=this.getSharedState("end"),c=s.clone();"horizontal"===t?(s.set(1-l.x,s.y),l.set(1-c.x,l.y)):"vertical"===t&&(s.set(s.x,1-l.y),l.set(l.x,1-c.y)),this.setSharedState({start:s,end:l}),o.broadcastFlip(t),o.render()},e.prototype.shouldSharedComponentUpdate=function(t,e){return!1},e.prototype.renderContent=function(){return d.ReactBEM.createElement("bem",{specifier:"$b:topBar"},d.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this._onFlipClick.bind(this,"vertical")},d.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/crop/flip-v.png",!0)})),d.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this._onFlipClick.bind(this,"horizontal")},d.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/crop/flip-h.png",!0)})),d.ReactBEM.createElement("div",{bem:"e:space"}),d.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this._onRotateClick.bind(this,"ccw")},d.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/crop/rotate-ccw.png",!0)})),d.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this._onRotateClick.bind(this,"cw")},d.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/crop/rotate-cw.png",!0)})))},e}(f["default"]);e["default"]=m,m.contextTypes=f["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(6),d=n(p),h=o(113),f=n(h),m=o(112),_=n(m),g=o(114),v=n(g),y=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.onEnter=function(t){var e=this.context.editor,o=e.operations.exists("crop"),n=e.operations.getOrCreate("crop");n.setEnabled(!1,!1);var i=e.operations.exists("orientation"),r=e.operations.getOrCreate("orientation"),a={end:new u.Vector2(1,1),rotation:0,start:new u.Vector2(0,0),scale:1},s=n.getInputDimensions(),l=n.getNewDimensions(s),c=a;o&&(c=n.serializeOptions(),delete c.enabled),e.broadcastCrop(n,a),n.set(a,o);var p=r.serializeOptions();delete p.enabled,e.setSpriteScale(c.scale),e.setRotation(c.rotation),e.setPadding([10,0,68,0]),e.zoom.set("auto",function(){
e.features.disable("zoom","drag")},!1),this.setSharedState({initialCropOptions:c,initialOrientationOptions:p,operation:n,orientationOperation:r,orientationOperationExistedBefore:i,cropOperationExistedBefore:o,start:u.Vector2.fromObject(c.start),end:u.Vector2.fromObject(c.end),rotation:c.rotation,orientationRotation:r.getRotation(),flipVertically:r.getFlipVertically(),flipHorizontally:r.getFlipHorizontally(),initialDimensions:l})},e.isAvailable=function(t){return t.isToolEnabled("crop")},e.getPreloadAssets=function(t){var e=t.getOptions(),o=u.SDKUtils.defaults(e.editor.controlsOptions.crop,this.defaultOptions),n=["controls/crop/rotate-ccw.png","controls/crop/rotate-cw.png","controls/crop/flip-h.png","controls/crop/flip-v.png"],i=f["default"].getRatios(o);return i.forEach(function(t){var e=t.name;n.push("controls/crop/"+e+".png")}),n},e}(d["default"]);y.topBarControlsComponent=v["default"],y.controlsComponent=f["default"],y.canvasControlsComponent=_["default"],y.identifier="crop",y.iconPath="controls/overview/crop.png",y.languageKey="controls.overview.crop",y.defaultOptions={},e["default"]=y},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(4),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=o(5),f=n(h),m=o(10),_=n(m),g=o(62),v=n(g),y=o(20),b=n(y),E=o(42),S=n(E),M=function(t){function e(){(0,s["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,c["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onItemClick","_onOperationUpdated","_onSliderValueChange","_onCategoryChange"),a._operation=a.getSharedState("operation"),a._events=(0,r["default"])({},d.Constants.EVENTS.OPERATION_UPDATED,a._onOperationUpdated),a._initFilterManager(),a.state={category:"all"},a}return(0,p["default"])(e,t),e.prototype._initFilterManager=function(){this._filterManager=new S["default"](this.props.options)},e.prototype._onSliderValueChange=function(t){this._operation.setIntensity(t/100);var e=this.context.editor;e.render()},e.prototype._onCategoryChange=function(t){var e=this;this.setState({category:t.name},function(){e.refs.scrollbar.update()})},e.prototype._onOperationUpdated=function(t){t===this._operation&&this.forceUpdate()},e.prototype._onItemClick=function(t,e){this._operation.set({filter:new t({intensity:1}),intensity:1});var o=this.context.editor;o.render(),this.forceUpdate()},e.prototype._onBackClick=function(e){var o=this.getSharedState("initialOptions"),n=this._operation.getFilter(),i=this._operation.getIntensity();if(n.constructor!==o.filter.constructor||i!==o.intensity){var r=this.context.editor;r.history.add(this._operation,o,this.getSharedState("operationExistedBefore"))}if(n.constructor.isIdentity){var a=this.context.editor;a.operations.remove(this._operation)}t.prototype._onBackClick.call(this,e)},e.prototype.renderOverlayControls=function(){var t=this._operation.getFilter();if(t.isIdentity)return null;var e=this._operation.getIntensity();return d.ReactBEM.createElement(b["default"],{minValue:0,maxValue:100,value:100*e,valueUnit:"%",positiveValuePrefix:"+",label:this._t("controls.filters.intensity"),onChange:this._onSliderValueChange})},e.prototype._renderListItems=function(){var t=this,e=this._operation.getFilter(),o=this._filterManager.getFiltersForCategory(this.state.category);return[d.SDK.Filters.IdentityFilter].concat(o).map(function(o){var n=o.identifier;return d.ReactBEM.createElement("li",{bem:"e:item",key:n,onClick:t._onItemClick.bind(t,o)},d.ReactBEM.createElement("bem",{specifier:"$b:controls"},d.ReactBEM.createElement("div",{bem:"$e:button m:withInlineLabel"},d.ReactBEM.createElement("img",{bem:"e:icon",src:t._getAssetPath("controls/filters/"+n+".png",!0)}),d.ReactBEM.createElement("div",{bem:"$e:inlineLabel",className:e instanceof o?"is-active":null},d.ReactBEM.createElement("div",{bem:"e:label"},o.displayName)))))})},e.prototype._renderCategoryDropdown=function(){var t=this,e=this._filterManager.getCategories(),o=!this.props.options.hideCategories&&e.length>1;if(!o)return null;var n=e.map(function(e){return{name:e.name,label:t._t("controls.filters.categories."+e.name),icon:t._getAssetPath("controls/filters/categories/"+e.name+".png",!0)}}),i={name:this.state.category,label:this._t("controls.filters.categories."+this.state.category),icon:this._getAssetPath("controls/filters/categories/"+this.state.category+".png",!0)};return d.ReactBEM.createElement("div",{bem:"e:cell m:categoryDropdown"},d.ReactBEM.createElement(v["default"],{items:n,selectedItem:i,onChange:this._onCategoryChange}))},e.prototype.renderControls=function(){var t=this._renderListItems(),e=this._renderCategoryDropdown();return[e,d.ReactBEM.createElement("div",{bem:"e:cell m:list"},d.ReactBEM.createElement(_["default"],{ref:"scrollbar"},d.ReactBEM.createElement("ul",{bem:"$e:list"},t)))]},e}(f["default"]);e["default"]=M,M.contextTypes=f["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(6),d=n(p),h=o(116),f=n(h),m=o(42),_=n(m),g=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.onEnter=function(t){var e=this.context.editor,o=e.operations.exists("filter"),n=e.operations.getOrCreate("filter"),i=n.serializeOptions(["filter","intensity"]);this.setSharedState({operation:n,operationExistedBefore:o,initialOptions:i})},e.isAvailable=function(t){return t.isToolEnabled(this.identifier)},e.getPreloadAssets=function(t){var e=t.getOptions(),o=u.SDKUtils.defaults(e.editor.controlsOptions.filter,this.defaultOptions),n=new _["default"](o),i=[],r=n.getCategories();return r.forEach(function(t){i.push("controls/filters/categories/"+t.name+".png");var e=n.getFiltersForCategory(t.name);e.forEach(function(t){i.push("controls/filters/"+t.identifier+".png")})}),i},e}(d["default"]);g.controlsComponent=f["default"],g.identifier="filter",g.iconPath="controls/overview/filters.png",g.languageKey="controls.overview.filters",g.defaultOptions={categories:[],replaceCategories:!1,selectableFilters:null,hideCategories:!1},e["default"]=g},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(5),d=n(p),h=o(10),f=n(h),m=o(123),_=n(m),g=o(120),v=n(g),y=[_["default"],v["default"]],b=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype._onButtonClick=function(t,e){this.context.editorScreen.switchToControls(t)},e.prototype._renderListItems=function(){var t=this;return y.filter(function(e){return e.isAvailable(t.context.editor)}).map(function(e){return u.ReactBEM.createElement("li",{bem:"e:item",key:e.identifier},u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",onClick:t._onButtonClick.bind(t,e)},u.ReactBEM.createElement("img",{bem:"e:icon",src:t._getAssetPath(e.iconPath,!0)}),u.ReactBEM.createElement("div",{bem:"e:label"},t._t(e.languageKey)))))})},e.prototype.renderControls=function(){var t=this._renderListItems();return u.ReactBEM.createElement("div",{bem:"e:cell m:list"},u.ReactBEM.createElement(f["default"],null,u.ReactBEM.createElement("ul",{bem:"$e:list"},t)))},e}(d["default"]);e["default"]=b,b.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(6),p=n(u),d=o(118),h=n(d),f=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.isAvailable=function(t){return t.isToolEnabled("radial-focus")||t.isToolEnabled("linear-focus")},e.onExit=function(){var t=this.context.editor;t.features.enable("zoom","drag")},e.getPreloadAssets=function(t){var e=[];return t.isToolEnabled("radial-focus")&&e.push("controls/focus/radial.png"),t.isToolEnabled("linear-focus")&&e.push("controls/focus/linear.png"),e},e}(p["default"]);f.controlsComponent=h["default"],f.identifier="focus",f.iconPath="controls/overview/focus.png",f.languageKey="controls.overview.focus",f.defaultOptions={},e["default"]=f},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(6),d=n(p),h=o(122),f=n(h),m=o(121),_=n(m),g=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.onEnter=function(t){var e=this.context.editor,o=e.operations.exists("linear-focus"),n=new u.Vector2(.49,.5),i=new u.Vector2(.51,.5),r=e.operations.getOrCreate("linear-focus",{start:n,end:i}),a=r.getInputDimensions(),s=r.serializeOptions(["start","end","size","gradientSize","blurRadius"]);this.setSharedState({operation:r,operationExistedBefore:o,initialOptions:s,inputDimensions:a})},e.isAvailable=function(t){return t.isToolEnabled("linear-focus")},e}(d["default"]);g.controlsComponent=f["default"],g.canvasControlsComponent=_["default"],g.identifier="linear-focus",g.iconPath="controls/focus/linear.png",g.languageKey="controls.focus.linear",g.defaultOptions={},e["default"]=g},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(11),d=n(p),h=o(24),f=n(h),m=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onCenterDragStart","_onCenterDrag","_onKnobDragStart","_onKnobDrag"),a.state={areaPosition:new u.Vector2,areaDimensions:new u.Vector2,knobPosition:new u.Vector2},a._operation=a.getSharedState("operation"),a}return(0,c["default"])(e,t),e.prototype._onCanvasZoomDone=function(){this._setStylesFromOptions()},e.prototype.sharedStateDidChange=function(t){t.operation&&(this._operation=t.operation),this._setStylesFromOptions()},e.prototype.componentDidMount=function(){var e=this;t.prototype.componentDidMount.call(this);var o=this.context.editor;o.zoom.set("auto",function(){o.features.disable("zoom","drag"),e._setStylesFromOptions()})},e.prototype._onCenterDragStart=function(){this._initialStart=this._operation.getStart(),this._initialEnd=this._operation.getEnd(),this._initialDist=this._initialEnd.clone().subtract(this._initialStart)},e.prototype._onCenterDrag=function(t){var e=this.context.editor,o=e.getOutputDimensions(),n=t.clone().divide(o),i=this._initialStart.clone().add(n).clamp(new u.Vector2(0,0),new u.Vector2(1,1).subtract(this._initialDist)),r=i.clone().add(this._initialDist);this._operation.set({start:i,end:r}),e.render(),this._setStylesFromOptions(),this.forceUpdate()},e.prototype._onKnobDragStart=function(t){this._initialKnobPosition=this.state.knobPosition.clone()},e.prototype._onKnobDrag=function(t){var e=this.context.editor,o=e.getOutputDimensions(),n=this._initialKnobPosition.clone().add(t).clamp(new u.Vector2(0,0),o),i=n.clone().subtract(this.state.areaPosition),r=this.state.areaPosition.clone().add(-i.y,i.x).divide(o),a=this.state.areaPosition.clone().add(i.y,-i.x).divide(o),s=2*i.len();this._operation.set({start:r,end:a,size:s/o.min(),gradientSize:s/o.min()}),this.setState({knobPosition:n,areaDimensions:new u.Vector2(this.state.areaDimensions.x,s)}),e.render()},e.prototype._getAreaStyle=function(){var t=this.state.knobPosition.clone().subtract(this.state.areaPosition),e=Math.atan2(t.x,t.y)*(180/Math.PI),o="rotate("+(-e).toFixed(2)+"deg)";return{width:this.state.areaDimensions.x,height:this.state.areaDimensions.y,left:this.state.areaPosition.x,top:this.state.areaPosition.y,marginLeft:this.state.areaDimensions.x*-.5,marginTop:this.state.areaDimensions.y*-.5,transform:o,MozTransform:o,msTransform:o,WebkitTransform:o}},e.prototype._getKnobStyle=function(){return{left:this.state.knobPosition.x,top:this.state.knobPosition.y}},e.prototype._setStylesFromOptions=function(){var t=this.context.editor,e=t.getOutputDimensions(),o=this._operation.getStart().clone().multiply(e),n=this._operation.getEnd().clone().multiply(e),i=this._operation.getSize()*e.min(),r=n.clone().subtract(o),a=o.clone().add(r.clone().divide(2)),s=new u.Vector2(2*e.len(),i),l=r.len(),c=r.clone().divide(l).divide(2);this.setState({areaDimensions:s,areaPosition:a.clone(),knobPosition:a.clone().add(-i*c.y,i*c.x)})},e.prototype._getContainerStyle=function(){var t=this.context.editor.getSDK().getSprite().getBounds(),e=t.x,o=t.y,n=t.width,i=t.height;return{left:e,top:o,width:n,height:i}},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("div",{bem:"b:canvasControls e:container m:full",ref:"container",style:this._getContainerStyle()},u.ReactBEM.createElement("div",{bem:"$b:linearFocusCanvasControls"},u.ReactBEM.createElement(d["default"],{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},u.ReactBEM.createElement("div",{bem:"e:area",style:this._getAreaStyle()})),u.ReactBEM.createElement(d["default"],{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},u.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getKnobStyle()}))))},e}(f["default"]);e["default"]=m,m.contextTypes=f["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(4),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=o(5),f=n(h),m=o(14),_=n(m),g=function(t){function e(){(0,s["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,c["default"])(this,t.call.apply(t,[this].concat(n)));return a._hasDoneButton=!0,a._operation=a.getSharedState("operation"),a._bindAll("_onBackClick","_onDoneClick","_onBlurRadiusChange","_onOperationRemoved"),a._events=(0,r["default"])({},d.Constants.EVENTS.OPERATION_REMOVED,a._onOperationRemoved),a}return(0,p["default"])(e,t),e.prototype._onOperationRemoved=function(t){if(t===this._operation&&!this._backButtonClicked){var e=this.context.editor,o=e.operations.getOrCreate("linear-focus");this._operation=o,this.setSharedState({operation:o,operationExistedBefore:!1,initialOptions:{}})}},e.prototype._onBackClick=function(e){this._backButtonClicked=!0;var o=this.context.editor;this.getSharedState("operationExistedBefore")?this._operation.set(this.getSharedState("initialOptions")):o.operations.remove(this._operation),o.zoom.undo(),o.features.enable("zoom","drag"),t.prototype._onBackClick.call(this,e)},e.prototype._onDoneClick=function(e){var o=this.context.editor,n=this.getSharedState("operationExistedBefore"),i=this.getSharedState("initialOptions"),r=!this._operation.optionsEqual(i);!r&&n||o.history.add(this._operation,this.getSharedState("initialOptions"),this.getSharedState("operationExistedBefore")),o.zoom.undo(),o.features.enable("zoom","drag"),t.prototype._onDoneClick.call(this,e)},e.prototype._onBlurRadiusChange=function(t){var e=this.getSharedState("inputDimensions");this._operation.setBlurRadius(t/e.min());var o=this.context.editor;o.render()},e.prototype.renderControls=function(){var t=this.getSharedState("inputDimensions"),e=t.min(),o=this._operation.getBlurRadius()*e;return d.ReactBEM.createElement("div",{bem:"e:cell m:slider"},d.ReactBEM.createElement(_["default"],{style:"large",minValue:0,maxValue:Math.min(180,Math.round(.1*e)),valueUnit:"px",middleDot:!1,label:this._t("controls.focus.blurRadius"),onChange:this._onBlurRadiusChange,value:o}))},e}(f["default"]);e["default"]=g,g.contextTypes=f["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(6),p=n(u),d=o(125),h=n(d),f=o(124),m=n(f),_=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.onEnter=function(t){var e=this.context.editor,o=e.operations.exists("radial-focus"),n=e.operations.getOrCreate("radial-focus"),i=n.serializeOptions(["position","radius","gradientRadius","blurRadius"]),r=n.getInputDimensions();this.setSharedState({operation:n,operationExistedBefore:o,initialOptions:i,inputDimensions:r})},e.isAvailable=function(t){return t.isToolEnabled("radial-focus")},e}(p["default"]);_.controlsComponent=h["default"],_.canvasControlsComponent=m["default"],_.identifier="radial-focus",_.iconPath="controls/focus/radial.png",_.languageKey="controls.focus.radial",_.defaultOptions={},e["default"]=_},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(11),d=n(p),h=o(24),f=n(h),m=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onCenterDragStart","_onCenterDrag","_onKnobDragStart","_onKnobDrag"),a.state={areaPosition:new u.Vector2,areaDimensions:new u.Vector2,knobPosition:new u.Vector2},a._knobChangedManually=!1,a._operation=a.getSharedState("operation"),a}return(0,c["default"])(e,t),e.prototype._onCanvasZoomDone=function(){this._setStylesFromOptions()},e.prototype.sharedStateDidChange=function(t){t.operation&&(this._operation=t.operation),this._setStylesFromOptions()},e.prototype.componentDidMount=function(){var e=this;t.prototype.componentDidMount.call(this);var o=this.context.editor;o.zoom.set("auto",function(){o.features.disable("zoom","drag"),e._setStylesFromOptions()})},e.prototype._onCenterDragStart=function(){this._initialPosition=this._operation.getPosition(),this._initialKnobPosition=this.state.knobPosition.clone()},e.prototype._onCenterDrag=function(t){var e=this.context.editor,o=e.getOutputDimensions(),n=t.clone().divide(o),i=this._initialPosition.clone().add(n),r=this._initialKnobPosition.clone().add(t);this._operation.set({position:i}),this.state.knobPosition=r,e.render(),this._setStylesFromOptions()},e.prototype._onKnobDragStart=function(t){this._knobChangedManually=!0,this._initialKnobPosition=this.state.knobPosition.clone()},e.prototype._onKnobDrag=function(t){var e=this.context.editor,o=e.getOutputDimensions(),n=this._initialKnobPosition.clone().add(t).clamp(new u.Vector2(0,0),o),i=this._operation.getPosition().clone().multiply(o),r=n.clone().subtract(i).abs().len(),a=r/2;this.setState({knobPosition:n,areaDimensions:new u.Vector2(2*r,2*r)}),this._operation.set({radius:r/o.min(),gradientRadius:a/o.min()}),e.render()},e.prototype._getAreaStyle=function(){return{width:this.state.areaDimensions.x,height:this.state.areaDimensions.y,left:this.state.areaPosition.x,top:this.state.areaPosition.y,marginLeft:this.state.areaDimensions.x*-.5,marginTop:this.state.areaDimensions.y*-.5}},e.prototype._getKnobStyle=function(){return{left:this.state.knobPosition.x,top:this.state.knobPosition.y}},e.prototype._setStylesFromOptions=function(){var t=this.context.editor,e=t.getOutputDimensions(),o=this._operation.getPosition().clone().multiply(e),n=this._operation.getRadius()*e.min(),i=2*n,r=new u.Vector2(i,i),a={areaDimensions:r,areaPosition:o};this._knobChangedManually||(a.knobPosition=o.clone().add(n,0)),this.setState(a)},e.prototype._getContainerStyle=function(){var t=this.context.editor,e=t.getSDK().getSprite().getBounds(),o=e.x,n=e.y,i=e.width,r=e.height;return{left:o,top:n,width:i,height:r}},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("div",{bem:"b:canvasControls e:container m:full",ref:"container",style:this._getContainerStyle()},u.ReactBEM.createElement("div",{bem:"$b:radialFocusCanvasControls"},u.ReactBEM.createElement(d["default"],{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},u.ReactBEM.createElement("div",{bem:"e:area",style:this._getAreaStyle()})),u.ReactBEM.createElement(d["default"],{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},u.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getKnobStyle()}))))},e}(f["default"]);e["default"]=m,m.contextTypes=f["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(4),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=o(5),f=n(h),m=o(14),_=n(m),g=function(t){function e(){(0,s["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,c["default"])(this,t.call.apply(t,[this].concat(n)));return a._hasDoneButton=!0,a._operation=a.getSharedState("operation"),a._bindAll("_onBackClick","_onDoneClick","_onBlurRadiusChange","_onOperationRemoved"),a._events=(0,r["default"])({},d.Constants.EVENTS.OPERATION_REMOVED,a._onOperationRemoved),a}return(0,p["default"])(e,t),e.prototype._onOperationRemoved=function(t){if(t===this._operation&&!this._backButtonClicked){var e=this.context.editor,o=e.operations.getOrCreate("radial-focus");this._operation=o,this.setSharedState({operation:o,operationExistedBefore:!1,initialOptions:{}})}},e.prototype._onBackClick=function(e){this._backButtonClicked=!0;var o=this.context.editor;this.getSharedState("operationExistedBefore")?this._operation.set(this.getSharedState("initialOptions")):o.operations.remove(this._operation),o.render(),o.zoom.undo(),o.features.enable("zoom","drag"),t.prototype._onBackClick.call(this,e)},e.prototype._onDoneClick=function(e){var o=this.context.editor,n=this.getSharedState("operationExistedBefore"),i=this.getSharedState("initialOptions"),r=!this._operation.optionsEqual(i);!r&&n||o.history.add(this._operation,this.getSharedState("initialOptions"),this.getSharedState("operationExistedBefore")),o.zoom.undo(),o.features.enable("zoom","drag"),t.prototype._onDoneClick.call(this,e)},e.prototype._onBlurRadiusChange=function(t){var e=this.getSharedState("inputDimensions");this._operation.setBlurRadius(t/e.min());var o=this.context.editor;o.render()},e.prototype.renderControls=function(){var t=this.getSharedState("inputDimensions"),e=t.min(),o=this._operation.getBlurRadius()*e;return d.ReactBEM.createElement("div",{bem:"e:cell m:slider"},d.ReactBEM.createElement(_["default"],{style:"large",minValue:0,maxValue:Math.min(180,Math.round(.1*e)),valueUnit:"px",middleDot:!1,label:this._t("controls.focus.blurRadius"),onChange:this._onBlurRadiusChange,value:o}))},e}(f["default"]);e["default"]=g,g.contextTypes=f["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(25),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=function(t){function e(){(0,s["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var r=(0,c["default"])(this,t.call.apply(t,[this].concat(n)));return r.state={value:r.props.value||0,sliderPosition:0,foregroundLeft:0,foregroundWidth:0},r}return(0,p["default"])(e,t),e.prototype.componentDidMount=function(){this._setValue(this.state.value,!1)},e.prototype.componentWillReceiveProps=function(t){t.value!==this.state.value&&this._setValue(t.value,!1)},e.prototype._getKnobStyle=function(){return{left:this.state.sliderPosition}},e.prototype._getForegroundStyle=function(){return{left:this.state.foregroundLeft,width:this.state.foregroundWidth}},e.prototype._displayMiddleDot=function(){return this.props.middleDot!==!1},e.prototype._setValue=function(t){!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t=Math.round(t);var e=this.props,o=e.minValue,n=e.maxValue,i=(t-o)/(n-o),r=this.refs.bar,a=r.offsetWidth,s=a*i,l=i*a,c=0;this._displayMiddleDot()&&(l=Math.abs(i-.5)*a,c=i<.5?.5*a-l:"50%"),this.setState({value:t,sliderPosition:s,foregroundWidth:l,foregroundLeft:c})},e.prototype.renderWithBEM=function(){var t={style:this._getForegroundStyle()};return d.ReactBEM.createElement("div",{bem:"$b:miniSlider"},d.ReactBEM.createElement("div",{bem:"$e:bar",ref:"bar"},d.ReactBEM.createElement("div",{bem:"$e:background"}),d.ReactBEM.createElement("div",(0,r["default"])({bem:"$e:foreground"},t)),d.ReactBEM.createElement("div",{bem:"e:knob",style:this._getKnobStyle()})))},e}(d.BaseComponent);e["default"]=h,h.contextTypes=d.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(6),p=n(u),d=o(131),h=n(d),f=o(63),m=n(f),_=o(128),g=n(_),v=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e}(p["default"]);v.topBarControlsComponent=h["default"],v.controlsComponent=m["default"],v.canvasControlsComponent=g["default"],e["default"]=v},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(24),d=n(p),h=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onClick"),a}return(0,c["default"])(e,t),e.prototype._onClick=function(t){this._performHitTest(u.Utils.getEventPosition(t))},e.prototype._getContainerStyle=function(){if(!this.context.editor.isReady())return{left:0,top:0,width:1,height:1};var t=this.context.editor.getSDK().getSprite().getBounds(),e=t.x,o=t.y,n=t.width,i=t.height;return{left:e,top:o,width:n,height:i}},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("div",{bem:"$b:canvasControls e:container m:full",ref:"container"},u.ReactBEM.createElement("div",{bem:"$b:canvasControls e:innerContainer",ref:"innerContainer",style:this._getContainerStyle(),onClick:this._onClick,onTouchStart:this._onClick}))},e}(d["default"]);e["default"]=h,h.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(7),d=n(p),h=o(41),f=n(h),m=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onButtonClick"),a}return(0,c["default"])(e,t),e.prototype._onButtonClick=function(){var t=this,e=this.context,o=e.options,n=e.editor,i=e.editorScreen,r=o.editor["export"];i.switchToControls("home",null,function(){var e=d["default"].instance.displayLoading(t._t("loading.exporting"));setTimeout(function(){n["export"](r.download).then(function(){e.close()})},100)})},e.prototype.renderWithBEM=function(){var t=this.context.options;return t.editor["export"].showButton?u.ReactBEM.createElement(f["default"],{style:"blue",label:this._t("editor.export"),icon:"editor/export.png",onClick:this._onButtonClick}):null},e}(u.BaseComponent);e["default"]=m,m.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(41),d=n(p),h=o(40),f=n(h),m=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onNewFile","_onButtonClick"),a}return(0,c["default"])(e,t),e.prototype._onNewFile=function(t){var e=this.context.editor;e.reset(),e.setImage(t),e.zoom.set("auto")},e.prototype._onButtonClick=function(){var t=this.context.options,e=t.enableWebcam===!1||u.Utils.isMobile(),o=!!t.photoRoll.provider;e&&!o?this.refs.upload.open():o?this.props.app.switchToScreen("photoRoll"):this.props.app.switchToScreen("splash")},e.prototype.renderWithBEM=function(){var t=this.context.options,e=null;return e=t.photoRoll.provider?this._t("editor.backgroundImage"):this._t("editor.new"),u.ReactBEM.createElement("div",null,u.ReactBEM.createElement(f["default"],{onNewFile:this._onNewFile,ref:"upload"}),u.ReactBEM.createElement(d["default"],{label:e,icon:"editor/new.png",onClick:this._onButtonClick}))},e}(u.BaseComponent);e["default"]=m,m.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(31),d=n(p),h=o(130),f=n(h),m=o(129),_=n(m),g=o(132),v=n(g),y=o(133),b=n(y),E=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.renderContent=function(){var t=null;this.context.options.enableUpload&&(t=u.ReactBEM.createElement(f["default"],{app:this.props.app}));var e=null;return this.context.options.editor.enableZoom&&(e=u.ReactBEM.createElement(b["default"],null)),u.ReactBEM.createElement("bem",{specifier:"$b:topBar"},u.ReactBEM.createElement("div",{bem:"e:left"},t),u.ReactBEM.createElement("div",{bem:"e:right"},u.ReactBEM.createElement(v["default"],null),u.ReactBEM.createElement(_["default"],null)),e)},e}(d["default"]);e["default"]=E,E.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(4),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=o(41),f=n(h),m=function(t){function e(){var o;(0,s["default"])(this,e);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var l=(0,c["default"])(this,t.call.apply(t,[this].concat(i)));return l._bindAll("_onButtonClick","_onHistoryUpdated","_onFeaturesUpdated"),l._events=(o={},(0,r["default"])(o,d.Constants.EVENTS.HISTORY_UPDATED,l._onHistoryUpdated),(0,r["default"])(o,d.Constants.EVENTS.FEATURES_UPDATED,l._onFeaturesUpdated),o),l}return(0,p["default"])(e,t),e.prototype._onFeaturesUpdated=function(){this.forceUpdate()},e.prototype._onHistoryUpdated=function(){this.forceUpdate()},e.prototype._onButtonClick=function(){var t=this.context.editor;t.history.undo()},e.prototype.renderWithBEM=function(){var t=this.context.editor;return t.history.isAvailable()?d.ReactBEM.createElement(f["default"],{label:this._t("editor.undo"),icon:"editor/undo.png",onClick:this._onButtonClick}):null},e}(d.BaseComponent);e["default"]=m,m.contextTypes=d.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(4),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=function(t){function e(){var o;(0,s["default"])(this,e);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var l=(0,c["default"])(this,t.call.apply(t,[this].concat(i)));return l._bindAll("_onZoomOutClick","_onZoomInClick","_onZoomDone","_onFeaturesUpdated"),l._events=(o={},(0,r["default"])(o,d.Constants.EVENTS.ZOOM_DONE,l._onZoomDone),(0,r["default"])(o,d.Constants.EVENTS.FEATURES_UPDATED,l._onFeaturesUpdated),o),l}return(0,p["default"])(e,t),e.prototype._onFeaturesUpdated=function(){this.forceUpdate()},e.prototype._onZoomDone=function(){this.forceUpdate()},e.prototype._onZoomOutClick=function(t){var e=this.context.editor;e.features.isEnabled("zoom")&&e.zoom.zoomOut()},e.prototype._onZoomInClick=function(t){var e=this.context.editor;e.features.isEnabled("zoom")&&e.zoom.zoomIn()},e.prototype.renderWithBEM=function(){var t=this.context.editor,e=t.zoom.get(),o=t.features.isEnabled("zoom");return d.ReactBEM.createElement("bem",{specifier:"b:editorScreen"
},d.ReactBEM.createElement("div",{bem:"$e:zoom"},d.ReactBEM.createElement("div",{bem:"$e:button m:zoomOut",onClick:this._onZoomOutClick,className:o?null:"is-disabled"},d.ReactBEM.createElement("img",{bem:"e:image",src:this._getAssetPath("controls/minus.png",!0)})),d.ReactBEM.createElement("div",{bem:"e:label"},"Zoom",d.ReactBEM.createElement("br",null),Math.round(100*e),"%"),d.ReactBEM.createElement("div",{bem:"$e:button m:zoomIn",onClick:this._onZoomInClick,className:o?null:"is-disabled"},d.ReactBEM.createElement("img",{bem:"e:image",src:this._getAssetPath("controls/plus.png",!0)}))))},e}(d.BaseComponent);e["default"]=h,h.contextTypes=d.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(6),p=n(u),d=o(136),h=n(d),f=o(135),m=n(f),_=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.onExit=function(){var t=this.context.editor,e=this.getSharedState("operation");0===e.getPaths().length&&t.operations.remove(e),t.zoom.undo(),t.features.enable("zoom","drag"),t.render()},e.onEnter=function(t,e){var o=this.context.editor;o.zoom.set("auto",function(){o.render()});var n=o.getOutputDimensions(),i=o.operations.exists("selective-blur"),r=o.operations.getOrCreate("selective-blur"),a=r.serializeOptions(),s=r.getBrush(),l=.1*n.min(),c=1,u=r.getInputDimensions();this.setSharedState({operationExistedBefore:i,operation:r,brush:s,initialOptions:a,thickness:l,hardness:c,inputDimensions:u})},e.isAvailable=function(t){return t.isToolEnabled("selective-blur")},e}(p["default"]);_.controlsComponent=h["default"],_.canvasControlsComponent=m["default"],_.identifier="selective-blur",_.iconPath="controls/overview/selective-blur.png",_.languageKey="controls.overview.selective-blur",_.defaultOptions={},e["default"]=_},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(4),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=o(30),f=n(h),m=function(t){function e(){(0,s["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,c["default"])(this,t.call.apply(t,[this].concat(n)));return a._windowResized=!1,a._drawing=!1,a._bindAll("_onMouseEnter","_onMouseLeave","_onMouseDown","_onMouseMove","_onMouseUp","_onMouseMoveOnCanvas","_onWindowResize"),a._lastDrawPosition=null,a._events=d.SDKUtils.extend(a._events,(0,r["default"])({},d.Constants.EVENTS.WINDOW_RESIZE,a._onWindowResize)),a.state={cursorVisible:!1,cursorPosition:new d.Vector2},a}return(0,p["default"])(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this._updateContainerRect()},e.prototype.componentDidUpdate=function(){this._windowResized&&(this._updateContainerRect(),this._windowResized=!1)},e.prototype._onWindowResize=function(){this._windowResized=!0},e.prototype._onOperationRemoved=function(t){},e.prototype._onOperationUpdated=function(t){t===this.getSharedState("operation")&&this.forceUpdate()},e.prototype._onMouseDown=function(t){t.preventDefault();var e=this.getSharedState("operation");this._optionsBeforeDraw=e.serializeOptions(),delete this._optionsBeforeDraw.enabled,this._operationExistedBeforeDraw=this.getSharedState("operationExistedBefore"),this.setSharedState({operationExistedBefore:!0},!1);var o=this.context.editor.getOutputDimensions(),n=this._getCursorPosition(t),i=this.getSharedState("thickness")/o.min(),r=this.getSharedState("hardness");this._drawing=!0,this._currentPath=e.createPath(i,r),this._currentPath.addControlPoint(n.clone().divide(o)),document.addEventListener("mousemove",this._onMouseMove),document.addEventListener("touchmove",this._onMouseMove),document.addEventListener("mouseup",this._onMouseUp),document.addEventListener("touchend",this._onMouseUp)},e.prototype._onMouseUp=function(){this._currentPath.setClosed(!0);var t=this.context.editor;t.render(),this._currentPath=null,this._drawing=!1,t.history.add(this.getSharedState("operation"),this._optionsBeforeDraw,this._operationExistedBeforeDraw),document.removeEventListener("mousemove",this._onMouseMove),document.removeEventListener("touchmove",this._onMouseMove),document.removeEventListener("mouseup",this._onMouseUp),document.removeEventListener("touchend",this._onMouseUp)},e.prototype._onMouseEnter=function(t){var e=this._getCursorPosition(t);this.setState({cursorVisible:!0,cursorPosition:e}),this._onMouseMove(t)},e.prototype._onMouseLeave=function(){this.setState({cursorVisible:!1})},e.prototype._onMouseMove=function(t){var e=this.context.editor,o=e.getOutputDimensions(),n=e.zoom.get(),i=this._getCursorPosition(t);this.setState({cursorPosition:i});var r=void 0;if(this._lastDrawPosition){var a=this.getSharedState("thickness"),s=this._lastDrawPosition.clone().subtract(i).abs().len()/n;r=s>=a/10}else r=!0;this._drawing&&r&&(this._currentPath.addControlPoint(i.clone().divide(o)),this._lastDrawPosition=i.clone(),e.render())},e.prototype._onMouseMoveOnCanvas=function(t){var e=this._getCursorPosition(t);this.setState({cursorPosition:e})},e.prototype._getCursorStyle=function(){var t=this.getSharedState("thickness"),e=this.state.cursorPosition;return{left:e.x,top:e.y,width:t,height:t,marginLeft:t*-.5,marginTop:t*-.5}},e.prototype._updateContainerRect=function(){this._containerBoundingRect=this.refs.innerContainer.getBoundingClientRect()},e.prototype._getCursorPosition=function(t){var e=d.Utils.getEventPosition(t),o=this._containerBoundingRect;return e.subtract(o.left,o.top)},e.prototype._getContainerProps=function(){var e=t.prototype._getContainerProps.call(this);return e.onMouseDown=e.onTouchStart=this._onMouseDown,e},e.prototype._getInnerContainerProps=function(){var e=t.prototype._getInnerContainerProps.call(this);return delete e.onClick,e.onMouseEnter=this._onMouseEnter,e.onMouseLeave=this._onMouseLeave,e.onMouseMove=this._onMouseMoveOnCanvas,e},e.prototype._renderSpriteItems=function(){return null},e.prototype._renderOverlayControls=function(){var t=this.state.cursorVisible?"is-visible":null;return d.ReactBEM.createElement("div",{bem:"$b:selectiveBlurCanvasControls"},d.ReactBEM.createElement("div",{bem:"e:cursor",className:t,style:this._getCursorStyle()}))},e}(f["default"]);e["default"]=m,m.contextTypes=f["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(4),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=o(5),f=n(h),m=o(14),_=n(m),g=o(20),v=n(g),y=function(t){function e(){var o;(0,s["default"])(this,e);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var l=(0,c["default"])(this,t.call.apply(t,[this].concat(i)));return l._hasDoneButton=!1,l._brushThickness=l.getSharedState("thickness"),l._bindAll("_onOperationUpdated","_onOperationRemoved","_onThicknessUpdated","_onBlurRadiusChange"),l.state={thicknessControlsEnabled:!1},l._events=(o={},(0,r["default"])(o,d.Constants.EVENTS.OPERATION_UPDATED,l._onOperationUpdated),(0,r["default"])(o,d.Constants.EVENTS.OPERATION_REMOVED,l._onOperationRemoved),o),l}return(0,p["default"])(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this);var e=this.context.editor;e.zoom.set("auto"),e.features.disable("zoom","drag")},e.prototype._onOperationRemoved=function(t){if(t===this.getSharedState("operation")&&!this._backButtonClicked){var e=this.context.editor,o=e.operations.getOrCreate("selective-blur"),n=o.getBrush();this.setSharedState({operation:o,brush:n,operationExistedBefore:!1,initialOptions:{}}),e.render()}},e.prototype._onOperationUpdated=function(t){if(t===this.getSharedState("operation")){var e=this.context.editor;e.render(),this.forceUpdate()}},e.prototype._onThicknessUpdated=function(t){this.setSharedState({thickness:t}),this._brushThickness=t},e.prototype._onBlurRadiusChange=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.getSharedState("inputDimensions");this.getSharedState("operation").setBlurRadius(t/n.min());var i=this.context.editor;i.render(),o&&i.history.add(this.getSharedState("operation"),{blurRadius:e/n.min()},!0)},e.prototype.renderOverlayControls=function(){var t=this.getSharedState("inputDimensions"),e=t.min(),o=this.getSharedState("operation").getBlurRadius()*e;return d.ReactBEM.createElement(v["default"],{minValue:0,maxValue:Math.min(180,Math.round(.1*e)),value:o,valueUnit:"px",label:this._t("controls.selectiveBlur.blurRadius"),onChange:this._onBlurRadiusChange})},e.prototype.renderControls=function(){var t=this.context.editor,e=t.zoom.get(),o=[],n=t.getFinalDimensions(),i=1,r=Math.round(n.clone().multiply(e).min()/2),a=this._brushThickness;return o.push(d.ReactBEM.createElement("div",{bem:"e:cell m:slider"},d.ReactBEM.createElement(_["default"],{style:"large",minValue:i,maxValue:r,valueUnit:"px",middleDot:!1,label:this._t("controls.brush.thickness"),onChange:this._onThicknessUpdated,value:a}))),o},e}(f["default"]);e["default"]=y,y.contextTypes=f["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(38),d=n(p),h=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this);var e=this.props.sprite.getCanvas();this._appendCanvas(e)},e.prototype.componentWillReceiveProps=function(t){if(t.sprite!==this.props.sprite){var e=this.props.sprite.getCanvas();e.parentNode.removeChild(e);var o=t.sprite.getCanvas();this._appendCanvas(o)}},e.prototype._appendCanvas=function(t){var e=this.context.editor,o=e.getOutputDimensions();t.style.width=o.x+"px",t.style.height=o.y+"px",this.refs.brush.appendChild(t)},e.prototype._isSelected=function(){return this.getSharedState("brush")===this.props.sprite},e.prototype.renderWithBEM=function(){var t=this._isSelected()?"is-selected":null;return u.ReactBEM.createElement("bem",{specifier:"b:spritesCanvasControls"},u.ReactBEM.createElement("div",{bem:"$e:item e:container m:full",ref:"container"},u.ReactBEM.createElement("div",{bem:"$e:brush",className:t,ref:"brush"})))},e}(d["default"]);e["default"]=h,h.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(11),d=n(p),h=o(38),f=n(h),m=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onRotateKnobDragStart","_onRotateKnobDrag","_onRotateKnobDragStop"),a._id=u.SDKUtils.getUUID(),a}return(0,c["default"])(e,t),e.prototype._onKnobDragStart=function(t,e,o){var n=this.props.sprite;switch(t){case"bottom":this._initialPosition=this._getBottomDragKnobPosition();break;case"top":this._initialPosition=this._getTopDragKnobPosition()}this._initialDimensions=n.getDimensions().clone(),this.props.onDragStart&&this.props.onDragStart()},e.prototype._onKnobDrag=function(t,e,o){var n=this.props.sprite,i=this._getAbsoluteSpritePosition(),r=this._initialPosition.clone().add(e),a=r.clone().subtract(i),s=this._initialPosition.clone().subtract(i);if(this.props.options.fixedRatio){var l=this._getStickerDimensions().divide(2).abs(),c=this._initialPosition.clone().subtract(i),p=void 0;switch(t){case"bottom":p=Math.atan2(a.y,a.x)-Math.atan2(l.y,l.x);break;case"top":p=Math.atan2(a.y,a.x)-Math.atan2(-l.y,-l.x)}var d=this._initialDimensions.clone().multiply(a.len()/c.len());n.set({dimensions:d,rotation:p})}else{var h=this.context.editor.zoom.get(),f=n.getRotation(),m=Math.cos(f*-1),_=Math.sin(f*-1),g=new u.Vector2(a.x*m-a.y*_,a.x*_+a.y*m),v=new u.Vector2(s.x*m-s.y*_,s.x*_+s.y*m),y=void 0;switch(t){case"bottom":y=g.clone().subtract(v);break;case"top":y=v.clone().subtract(g)}var b=this._initialDimensions.clone().add(y.clone().divide(h).multiply(2));n.set({dimensions:b})}},e.prototype._onKnobDragStop=function(){this.props.onDragStop&&this.props.onDragStop()},e.prototype._onRotateKnobDragStart=function(t,e){this._initialPosition=this._getRotateKnobPosition(),this.props.onDragStart&&this.props.onDragStart()},e.prototype._onRotateKnobDragStop=function(){this.props.onDragStop&&this.props.onDragStop()},e.prototype._onRotateKnobDrag=function(t,e){var o=this.props.sprite,n=this._getAbsoluteSpritePosition(),i=this._initialPosition.clone().add(t),r=this._getStickerDimensions().divide(2),a=i.clone().subtract(n),s=void 0;s=Math.atan2(a.y,a.x)-Math.atan2(-r.y,r.x),o.set({rotation:s})},e.prototype._getBottomDragKnobStyle=function(){var t=this._getBottomDragKnobPosition();return{left:t.x,top:t.y}},e.prototype._getTopDragKnobStyle=function(){var t=this._getTopDragKnobPosition();return{left:t.x,top:t.y}},e.prototype._getRotateKnobStyle=function(){var t=this._getRotateKnobPosition();return{left:t.x,top:t.y}},e.prototype._getStickerStyle=function(){var t=this.props.sprite,e=this._getStickerDimensions().abs(),o=this._getAbsoluteSpritePosition().subtract(e.clone().divide(2)),n=180*t.getRotation()/Math.PI,i="rotate("+n.toFixed(2)+"deg)",r=t.getDimensions(),a=t.getFlipVertically();r.y<0&&(a=!a),a&&(i+=" scaleY(-1)");var s=t.getFlipHorizontally();return r.x<0&&(s=!s),s&&(i+=" scaleX(-1)"),{top:o.y,left:o.x,width:e.x,height:e.y,WebkitTransform:i,msTransform:i,MozTransform:i,OTransform:i}},e.prototype._getStickerDimensions=function(){var t=this.props.sprite,e=this.context.editor;return t.getDimensions().clone().multiply(e.zoom.get())},e.prototype._getRotateKnobPosition=function(){var t=this.props.sprite,e=this._getAbsoluteSpritePosition(),o=t.getRotation(),n=Math.sin(o||0),i=Math.cos(o||0),r=this._getStickerDimensions().divide(2);return e.clone().add(r.x*i+r.y*n,r.x*n-r.y*i)},e.prototype._getBottomDragKnobPosition=function(){var t=this.props.sprite,e=this._getAbsoluteSpritePosition(),o=t.getRotation(),n=Math.sin(o||0),i=Math.cos(o||0),r=this._getStickerDimensions().divide(2);return e.clone().add(r.x*i-r.y*n,r.x*n+r.y*i)},e.prototype._getTopDragKnobPosition=function(){var t=this.props.sprite,e=this._getAbsoluteSpritePosition(),o=t.getRotation(),n=Math.sin(o||0),i=Math.cos(o||0),r=this._getStickerDimensions(t).divide(2);return e.clone().subtract(r.x*i-r.y*n,r.x*n+r.y*i)},e.prototype._renderKnobs=function(){var t=[];return this.props.selected&&(t=[u.ReactBEM.createElement(d["default"],{onStart:this._onKnobDragStart.bind(this,"bottom"),onStop:this._onKnobDragStop.bind(this,"bottom"),onDrag:this._onKnobDrag.bind(this,"bottom")},u.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getBottomDragKnobStyle()},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-down.png",!0)}))),u.ReactBEM.createElement(d["default"],{onStart:this._onKnobDragStart.bind(this,"top"),onStop:this._onKnobDragStop.bind(this,"top"),onDrag:this._onKnobDrag.bind(this,"top")},u.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getTopDragKnobStyle()},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-down.png",!0)})))],this.props.options.fixedRatio||t.push(u.ReactBEM.createElement(d["default"],{onStart:this._onRotateKnobDragStart,onStop:this._onRotateKnobDragStop,onDrag:this._onRotateKnobDrag},u.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getRotateKnobStyle()},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/rotate.png",!0)}))))),t},e.prototype._renderSVGFilter=function(){var t=this.props.sprite,e=t.getAdjustments(),o=e.getBrightness(),n=e.getSaturation(),i=e.getContrast(),r="<filter id='pesdk-sticker-"+this._id+"-filter'>\n        <feComponentTransfer>\n          <feFuncR type='linear' intercept='"+o+"' />\n          <feFuncG type='linear' intercept='"+o+"' />\n          <feFuncB type='linear' intercept='"+o+"' />\n        </feComponentTransfer>\n        <feColorMatrix type='saturate' values='"+n+"' />\n        <feComponentTransfer>\n          <feFuncR type='linear' slope='"+i+"' intercept='"+(-(.5*i)+.5)+"' />\n          <feFuncG type='linear' slope='"+i+"' intercept='"+(-(.5*i)+.5)+"' />\n          <feFuncB type='linear' slope='"+i+"' intercept='"+(-(.5*i)+.5)+"' />\n        </feComponentTransfer>\n      </filter>";return u.ReactBEM.createElement("svg",{width:"0",height:"0","color-interpolation-filters":"sRGB",is:"svg"},u.ReactBEM.createElement("defs",{key:Math.random(),dangerouslySetInnerHTML:{__html:r}}))},e.prototype._renderItem=function(){var t=this.props.sprite,e=this._getStickerStyle(),o=this.props.selected?"is-selected":null,n={filter:'url("#pesdk-sticker-'+this._id+'-filter")'};return u.ReactBEM.createElement(d["default"],{onStart:this._onItemDragStart,onStop:this._onItemDragStop,onDrag:this._onItemDrag,disabled:!this.props.selected},u.ReactBEM.createElement("div",{bem:"$e:sticker",style:e,className:o},u.ReactBEM.createElement("svg",{width:e.width,height:e.height,"color-interpolation-filters":"sRGB",is:"svg"},u.ReactBEM.createElement("image",{xlinkHref:t.getImage().src,width:e.width,height:e.height,style:n}))))},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("bem",{specifier:"b:spritesCanvasControls"},u.ReactBEM.createElement("div",{bem:"$e:item e:container"},this._renderSVGFilter(),this._renderItem(),this._renderKnobs()))},e}(f["default"]);e["default"]=m,m.contextTypes=f["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(11),d=n(p),h=o(38),f=n(h),m=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onTextChange","_onItemDoubleClick","_onItemTouchStart","_onItemTouchEnd","_onResizeKnobDragStart","_onResizeKnobDrag","_onResizeKnobDragStop","_onRotationKnobDragStart","_onRotationKnobDrag","_onRotationKnobDragStop"),a.state={editMode:!1},a}return(0,c["default"])(e,t),e.prototype._onTextChange=function(t){var e=this.props.sprite;e.setText(t.target.value)},e.prototype._onItemDoubleClick=function(){this.enterEditMode()},e.prototype.enterEditMode=function(){var t=this,e=this.props.sprite;e._edited||(e.setText(""),this.refs.textarea.value="",e._edited=!0,this.forceUpdate()),this.setState({editMode:!0},function(){t.refs.textarea.focus(),t.refs.textarea.select()})},e.prototype._onItemTouchStart=function(t){this._initialTouchPosition=u.Utils.getEventPosition(t),this._tapStartAt=(0,u.now)()},e.prototype._onItemTouchEnd=function(){(0,u.now)()-this._tapStartAt<=100&&("undefined"!=typeof this._lastTapAt&&(0,u.now)()-this._lastTapAt<=300&&this._onItemDoubleClick(),this._lastTapAt=(0,u.now)())},e.prototype._onRotationKnobDragStart=function(t,e){this._dragging=!0,this._initialPosition=this._getRotationKnobPosition(),this.props.onDragStart&&this.props.onDragStart()},e.prototype._onRotationKnobDrag=function(t,e){var o=this.props.sprite,n=this.context.editor,i=this._getAbsoluteSpritePosition(),r=this._initialPosition.clone().add(t),a=r.clone().subtract(i),s=o.getBoundingBox(n.getSDK(),n.getOutputDimensions()),l=Math.atan2(a.y,a.x)-Math.atan2(s.y,s.x/2);o.setRotation(l)},e.prototype._onRotationKnobDragStop=function(t){this.props.onDragStop&&this.props.onDragStop()},e.prototype._onResizeKnobDragStart=function(t,e){this._initialPosition=this._getResizeKnobPosition(),this.props.onDragStart&&this.props.onDragStart()},e.prototype._onResizeKnobDrag=function(t,e){var o=this.props.sprite,n=o.getRotation(),i=this.context.editor,r=i.getOutputDimensions(),a=Math.cos(n),s=Math.sin(n),l=this._initialPosition.clone().add(t),c=this._getAbsoluteSpritePosition(),u=l.clone().subtract(c),p=Math.max((u.x*a+u.y*s)/r.x*2,.1);o.setMaxWidth(p)},e.prototype._onResizeKnobDragStop=function(t){this.props.onDragStop&&this.props.onDragStop()},e.prototype._getRotationKnobStyle=function(){var t=this._getRotationKnobPosition();return{left:t.x,top:t.y}},e.prototype._getResizeKnobStyle=function(){var t=this._getResizeKnobPosition();return{left:t.x,top:t.y}},e.prototype._getTextStyle=function(){var t=this.context.editor,e=this.props.sprite,o=t.getSDK(),n=t.getOutputDimensions(),i=e.getDOMStyle(o,n),r=this._getAbsoluteSpritePosition(),a=e.getBoundingBox(o,n);return i.height=Math.min(a.y,n.y-r.y),i},e.prototype._getItemContainerStyle=function(){var t=this.context.editor,e=t.getOutputDimensions(),o=this.props.sprite,n=o.getPosition().clone().multiply(e),i=180*o.getRotation()/Math.PI,r="rotateZ("+i.toFixed(2)+"deg)",a="50% 0",s=o.getMaxWidth()*e.x;return{width:s,left:n.x,top:n.y,marginLeft:s*-.5,transform:r,MozTransform:r,msTransform:r,WebkitTransform:r,transformOrigin:a,MozTransformOrigin:a,msTransformOrigin:a,WebkitTransformOrigin:a}},e.prototype._getRotationKnobPosition=function(){var t=this.props.sprite,e=this.context.editor,o=Math.sin(t.getRotation()),n=Math.cos(t.getRotation()),i=e.getOutputDimensions(),r=t.getBoundingBox(e.getSDK(),i),a=r.clone().divide(2),s=t.getPosition().clone().multiply(i).add(a.x*n-r.y*o,a.x*o+r.y*n);return s},e.prototype._getResizeKnobPosition=function(){var t=this.props.sprite,e=this.context.editor,o=Math.sin(t.getRotation()),n=Math.cos(t.getRotation()),i=e.getOutputDimensions(),r=t.getBoundingBox(e.getSDK(),i),a=r.clone().divide(2),s=t.getPosition().clone().multiply(i).add(a.x*n,a.x*o);return s},e.prototype._renderKnobs=function(){var t=[];return this.props.selected&&!this.state.editMode&&(t=[u.ReactBEM.createElement(d["default"],{onStart:this._onRotationKnobDragStart,onDrag:this._onRotationKnobDrag,onStop:this._onRotationKnobDragStop},u.ReactBEM.createElement("div",{bem:"e:knob m:rotate $b:knob",style:this._getRotationKnobStyle()},u.ReactBEM.createElement("img",{bem:"e:icon m:larger",src:this._getAssetPath("controls/knobs/rotate.png",!0)}))),u.ReactBEM.createElement(d["default"],{onStart:this._onResizeKnobDragStart,onDrag:this._onResizeKnobDrag,onStop:this._onResizeKnobDragStop},u.ReactBEM.createElement("div",{bem:"e:knob m:resize $b:knob",style:this._getResizeKnobStyle()},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-up.png",!0)})))]),t},e.prototype._renderItem=function(){var t=this.props.sprite,e=[];return e=[u.ReactBEM.createElement("textarea",{bem:"e:content",ref:"textarea",style:this._getTextStyle(),defaultValue:t.getText(),disabled:!this.state.editMode,onChange:this._onTextChange})],this.state.editMode||e.push(u.ReactBEM.createElement("div",{bem:"e:disabledOverlay",onDoubleClick:this._onItemDoubleClick,onTouchStart:this._onItemTouchStart,onTouchEnd:this._onItemTouchEnd})),u.ReactBEM.createElement(d["default"],{onStart:this._onItemDragStart,onStop:this._onItemDragStop,onDrag:this._onItemDrag,disabled:!this.props.selected||this.props.selected&&this.state.editMode},u.ReactBEM.createElement("div",{bem:"$e:text",style:this._getItemContainerStyle(),className:this.props.selected?"is-selected":null},e))},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("bem",{specifier:"b:spritesCanvasControls"},u.ReactBEM.createElement("div",{bem:"$e:item e:container"},this._renderItem(),this._renderKnobs()))},e}(f["default"]);e["default"]=m,m.contextTypes=f["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(6),d=n(p),h=o(142),f=n(h),m=o(141),_=n(m),g=u.SDK.Operations.SpriteOperation.Sticker,v=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.onExit=function(){var t=this.context.editor,e=this.getSharedState("operation");t.history.add(e,this.getSharedState("initialOptions"),this.getSharedState("operationExistedBefore")),e.setEnabled(!0),t.zoom.undo(),t.features.enable("zoom","drag"),t.render()},e.onEnter=function(t){var e=this.context.editor,o=e.operations.exists("sprite"),n=e.operations.getOrCreate("sprite"),i=n.getSprites(),r=n.getSpritesOfType(g),a=n.serializeOptions();n.setEnabled(!1),e.zoom.set("auto"),this.setSharedState({operationExistedBefore:o,operation:n,sprites:i,stickers:r,initialOptions:a})},e.clickAtPosition=function(t,e){if(!e.operations.exists("sprite"))return!1;var o=e.operations.getOrCreate("sprite"),n=o.getSpritesAtPosition(t,e.getOutputTextureDimensions()).filter(function(t){return t instanceof g});return!!n.length&&{selectedSprite:n[0]}},e.isAvailable=function(t){return t.isToolEnabled("sticker")},e}(d["default"]);v.controlsComponent=f["default"],v.canvasControlsComponent=_["default"],v.identifier="sticker",v.iconPath="controls/overview/sticker.png",v.languageKey="controls.overview.sticker",v.defaultOptions={categories:[],replaceCategories:!1,selectableStickers:null,tooltips:!1,hideCategories:!1,fixedRatio:!0,smoothDownscaling:!1},e["default"]=v},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(30),d=n(p),h=o(143),f=n(h),m=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype._renderOverlayControls=function(){if(this.getSharedState("selectedSprite"))return u.ReactBEM.createElement(f["default"],{onFlip:this._onSpriteFlip,onTakeToFront:this._onSpriteTakeToFront,onRemove:this._onSpriteRemove})},e}(d["default"]);e["default"]=m,m.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(25),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=o(5),f=n(h),m=o(10),_=n(m),g=o(62),v=n(g),y=o(7),b=n(y),E=o(70),S=n(E),M=o(144),C=n(M),B=function(t){function e(){(0,s["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var r=(0,c["default"])(this,t.call.apply(t,[this].concat(n)));return r._bindAll("_onStickerMouseLeave","_renderTooltipCanvas","_onCategoryChange"),r._operation=r.getSharedState("operation"),r._sprites=r.getSharedState("sprites"),r._stickers=r.getSharedState("stickers"),r._initStickerManager(),r.state={category:"all"},r}return(0,p["default"])(e,t),e.prototype._onCategoryChange=function(t){var e=this;this.setState({category:t.name},function(){e.refs.scrollbar.update()})},e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this.props.options.stickersJSONPath&&this._loadExternalStickers();var e=this.context.editor;e.zoom.set("auto",function(){e.features.disable("zoom","drag")})},e.prototype._loadExternalStickers=function(){var t=this,e=null,o=setTimeout(function(){e=b["default"].instance.displayLoading(t._t("loading.loading"))},100),n=function(){o&&(clearTimeout(o),o=null),e&&e.close()};this._availableStickers=[],this.forceUpdate();var i=this.props.options.stickersJSONPath;d.Utils.getJSONP(i).then(function(e){n(),"1.0"===e.version?t._initStickers([{name:"all",label:"All",stickers:e.stickers}]):"1.1"===e.version&&t._initStickers(e.categories),t.forceUpdate(function(){t.refs.scrollbar.update()})})["catch"](function(e){n();var o=b["default"].instance.displayError(t._t("errors.loadingStickersFailed.title"),e.message);o.on("close",function(){t.props.onBack()})})},e.prototype._renderTooltipCanvas=function(){var t=this,e=this.state.hoveredSticker,o=new window.Image;o.addEventListener("load",function(){if(t.state.tooltipVisible&&t.state.hoveredSticker===e){var n=t.refs.tooltipCanvas;n.width=n.offsetWidth,n.height=n.offsetHeight;var i=n.getContext("2d"),r=Math.min(n.width/o.width,n.height/o.height),a=new d.Vector2(o.width,o.height).multiply(r),s=new d.Vector2(n.width,n.height).divide(2).subtract(a.clone().divide(2));i.drawImage(o,0,0,o.width,o.height,s.x,s.y,a.x,a.y)}});var n=this._getAssetPath((e.images.mediaMedium||e.images.mediaBase).uri);o.src=n},e.prototype._initStickerManager=function(){this._stickerManager=new S["default"](this.props.options)},e.prototype._onBackClick=function(t){this._backButtonClicked=!0,this.props.onSwitchControls("home")},e.prototype._onStickerClick=function(t){var e=this,o=this._getAssetPath(t.images.mediaBase.uri),n=new window.Image,i=void 0,r=setTimeout(function(){i=b["default"].instance.displayLoading(e._t("loading.loading"))},100);n.addEventListener("load",function(){i&&i.close(),r&&(clearTimeout(r),r=null);var o=e.context.editor,a=e._calculateInitialStickerScale(t,n),s=e._operation.createSticker({name:t.name,image:n,position:new d.Vector2(.5,.5),dimensions:new d.Vector2(n.width,n.height).multiply(a),rotation:0,smoothDownscaling:e.props.options.smoothDownscaling});e._operation.addSprite(s),e._stickers.push(s),o.render(function(){e.setSharedState({selectedSprite:s,sprites:e._sprites,stickers:e._stickers})})}),n.addEventListener("error",function(){i&&i.close(),r&&(clearTimeout(r),r=null),b["default"].instance.displayError(e._t("errors.imageLoadFail.title"),e._t("errors.imageLoadFail.text",{path:n.src}))}),n.crossOrigin="Anonymous",n.src=o},e.prototype._calculateInitialStickerScale=function(t,e){var o=this.getSharedState("operation"),n=o.getInputDimensions().multiply(.9),i=new d.Vector2(e.width,e.height),r=i.clone().subtract(n);return r.x<=0&&r.y<=0?1:r.x>r.y?n.x/i.x:n.y/i.y},e.prototype._onStickerMouseEnter=function(t,e){var o=this;this.setState({tooltipVisible:!0,hoveredSticker:t,hoveredStickerElement:e.currentTarget},function(){o._renderTooltipCanvas(),o._updateTooltipPosition()})},e.prototype._updateTooltipPosition=function(){var t=this.state.hoveredStickerElement,e=this.refs.root,o=t.getBoundingClientRect(),n=e.getBoundingClientRect();this.setState({tooltipPosition:o.left-n.left})},e.prototype._onStickerMouseLeave=function(){this.setState({tooltipVisible:!1,hoveredSticker:null})},e.prototype._renderListItems=function(){var t=this,e=this._stickerManager.getStickersForCategory(this.state.category);return e.map(function(e,o){var n=t.props.options,i=n.tooltips?{onMouseEnter:t._onStickerMouseEnter.bind(t,e),onMouseLeave:t._onStickerMouseLeave}:null;return d.ReactBEM.createElement(C["default"],(0,r["default"])({sticker:e,onClick:t._onStickerClick.bind(t,e)},i))})},e.prototype._renderTooltip=function(){var t=this.props.options.tooltips&&this.state.tooltipVisible,e={left:this.state.tooltipPosition};return t?d.ReactBEM.createElement("div",{bem:"e:cell m:empty"},d.ReactBEM.createElement("div",{bem:"$b:stickersControls $e:tooltip",style:e},d.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"tooltipCanvas"}))):null},e.prototype._renderCategoryDropdown=function(){var t=this,e=this._stickerManager.getCategories(),o=!this.props.options.hideCategories&&e.length>1;if(!o)return null;var n=e.map(function(e){return{name:e.name,label:t._t("controls.sticker.categories."+e.name),icon:t._getAssetPath("controls/stickers/categories/"+e.name+".png",!0)}}),i={name:this.state.category,label:this._t("controls.sticker.categories."+this.state.category),icon:this._getAssetPath("controls/stickers/categories/"+this.state.category+".png",!0)};return d.ReactBEM.createElement("div",{bem:"e:cell m:categoryDropdown"},d.ReactBEM.createElement(v["default"],{items:n,selectedItem:i,onChange:this._onCategoryChange}))},e.prototype.renderControls=function(){var t=this._renderListItems(),e=this._renderTooltip(),o=this._renderCategoryDropdown();return[e,o,d.ReactBEM.createElement("div",{bem:"e:cell m:list"},d.ReactBEM.createElement(_["default"],{
ref:"scrollbar"},d.ReactBEM.createElement("ul",{bem:"$e:list"},t)))]},e}(f["default"]);e["default"]=B,B.contextTypes=f["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype._onFlipClick=function(t,e){e.preventDefault(),e.stopPropagation(),this.props.onFlip&&this.props.onFlip(t)},e.prototype._onTakeToFrontClick=function(t){t.preventDefault(),t.stopPropagation(),this.props.onTakeToFront&&this.props.onTakeToFront()},e.prototype._onRemoveClick=function(t){t.preventDefault(),t.stopPropagation(),this.props.onRemove&&this.props.onRemove()},e.prototype._renderItems=function(){return[u.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onFlipClick.bind(this,"h")},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/flip-h.png",!0)})),u.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onFlipClick.bind(this,"v")},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/flip-v.png",!0)})),u.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onTakeToFrontClick.bind(this)},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/take-to-front.png",!0)})),u.ReactBEM.createElement("div",{bem:"$e:separator"}),u.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onRemoveClick.bind(this)},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/remove.png",!0)}))]},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("div",{bem:"$b:spritesControlsOverlay"},this._renderItems())},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a.state={sticker:a.props.sticker},a}return(0,c["default"])(e,t),e.prototype.componentDidMount=function(){this._renderSticker()},e.prototype.componentWillReceiveProps=function(t){var e=this;this.props.sticker!==t.sticker&&this.setState({sticker:t.sticker},function(){e._renderSticker()})},e.prototype._renderSticker=function(){var t=this.context.editor,e=t.getSDK(),o=this.props.sticker,n=this._getAssetPath(o.images.mediaThumb.uri),i=this.refs["canvas-"+o.name],r=e.getPixelRatio();i.width=i.offsetWidth*r,i.height=i.offsetHeight*r,i.style.width=i.offsetWidth+"px",i.style.height=i.offsetHeight+"px";var a=i.getContext("2d"),s=new window.Image;s.addEventListener("load",function(){var t=Math.min(i.width/s.width,i.height/s.height),e=new u.Vector2(s.width,s.height).multiply(t),o=new u.Vector2(i.width,i.height).divide(2).subtract(e.clone().divide(2));a.drawImage(s,0,0,s.width,s.height,o.x,o.y,e.x,e.y)}),s.src=n},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("li",{bem:"$b:stickersControls $e:item",key:this.props.sticker.name,onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},u.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas-"+this.props.sticker.name}))},e}(u.BaseComponent);e["default"]=p},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(64),d=n(p),h=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype._onListItemClick=function(t,e){this.props.onChange&&this.props.onChange(t)},e.prototype._renderListItems=function(){var t=this,e=this.props.fonts;return e.map(function(e,o){var n=t.props,i=n.fontFamily,r=n.fontWeight,a=n.fontStyle,s=e.optionsEqual({fontFamily:i,fontWeight:r,fontStyle:a}),l=s?"is-active":null;return u.ReactBEM.createElement("li",{bem:"e:item",key:o,className:l,onClick:t._onListItemClick.bind(t,e)},u.ReactBEM.createElement(d["default"],{fontFamily:e.getFontFamily(),fontWeight:e.getFontWeight(),fontStyle:e.getFontStyle()}),u.ReactBEM.createElement("div",{bem:"e:label"},e.getFontFamily()))})},e.prototype.renderWithBEM=function(){var t=this._renderListItems();return u.ReactBEM.createElement("div",{bem:"$b:controls e:overlay m:dark"},u.ReactBEM.createElement("ul",{bem:"$b:fontFamily e:list"},t))},e}(u.BaseComponent);e["default"]=h,h.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(6),d=n(p),h=o(147),f=n(h),m=o(148),_=n(m),g=o(190),v=n(g),y=u.SDK.Operations.SpriteOperation.Text,b=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.onExit=function(){var t=this.context.editor,e=this.getSharedState("operation");t.history.add(e,this.getSharedState("initialOptions"),this.getSharedState("operationExistedBefore")),e.setEnabled(!0),t.zoom.undo(),t.features.enable("zoom","drag"),t.render()},e.onEnter=function(t,e){var o=this.context.editor,n=o.operations.exists("sprite"),i=o.operations.getOrCreate("sprite"),r=i.getSprites(),a=i.serializeOptions(),s=new v["default"](e),l=s.getDefaultFont();this.setSharedState({operationExistedBefore:n,operation:i,sprites:r,initialOptions:a,fontManager:s,defaultFont:l,fonts:s.getFonts()}),i.setEnabled(!1),o.render()},e.clickAtPosition=function(t,e){if(!e.operations.exists("sprite"))return!1;var o=e.operations.getOrCreate("sprite"),n=o.getSpritesAtPosition(t,e.getOutputTextureDimensions()).filter(function(t){return t instanceof y});return!!n.length&&{selectedSprite:n[0]}},e.isAvailable=function(t){return t.isToolEnabled("text")},e.getPreloadAssets=function(t){return["controls/text/align_left.png","controls/text/align_right.png","controls/text/align_center.png","controls/text/minus.png","controls/text/plus.png"]},e}(d["default"]);b.controlsComponent=_["default"],b.canvasControlsComponent=f["default"],b.identifier="text",b.iconPath="controls/overview/text.png",b.languageKey="controls.overview.text",b.defaultOptions={additionalFonts:[],replaceFonts:!1,selectableFonts:null,defaultText:null},e["default"]=b},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(30),d=n(p),h=o(149),f=n(h),m=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onTextEdit"),a}return(0,c["default"])(e,t),e.prototype._onItemBlur=function(){var t=this.getSharedState("selectedSprite");t&&""===t.getText()&&(t.setText(u.Constants.DEFAULTS.TEXT),t._edited=!1)},e.prototype._onSpriteRemove=function(){t.prototype._onSpriteRemove.call(this),this.props.onSwitchControls("home")},e.prototype._onTextEdit=function(){var t=this.getSharedState("selectedSprite");this.refs["sprite-"+t.getId()].enterEditMode()},e.prototype._renderOverlayControls=function(){if(this.getSharedState("selectedSprite"))return u.ReactBEM.createElement(f["default"],{onTakeToFront:this._onSpriteTakeToFront,onRemove:this._onSpriteRemove,onEdit:this._onTextEdit})},e}(d["default"]);e["default"]=m,m.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(5),d=n(p),h=o(10),f=n(h),m=o(37),_=n(m),g=o(20),v=n(g),y=o(64),b=n(y),E=o(145),S=n(E),M=o(185),C=n(M),B=o(7),R=n(B),x=["left","center","right"],w=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));a._bindAll("_onFontSizeChange","_onFontChange","_onAlignmentClick","_onTakeToFrontClick","_onForegroundColorChange","_onBackgroundColorChange"),a._operation=a.getSharedState("operation"),a._fontLoader=new C["default"](a.getSharedState("fonts")),a.state={mode:null,loading:!0};var l=a.context.editor;return l.render(),a._fonts=a.getSharedState("fonts"),a}return(0,c["default"])(e,t),e.prototype.componentDidMount=function(){var e=this;t.prototype.componentDidMount.call(this);var o=this.context.editor;o.zoom.set("auto",function(){o.features.disable("zoom","drag")});var n=function(){e._createText(),e.setState({loading:!1})};this._fontLoader.needsToLoad()?this._loadFonts().then(n.bind(this)):n()},e.prototype._loadFonts=function(){var t=R["default"].instance.displayLoading(this._t("loading.loading"));return this._fontLoader.load().then(function(){t.close()})},e.prototype._createText=function(){var t=this.context.editor,e=this.getSharedState("selectedSprite"),o=this.getSharedState("operation"),n=this.getSharedState("defaultFont"),i=this.props.options,r=t.getOutputDimensions();if(!e){var a=t.getSDK(),s=a.getRenderer(),l=s.getMaxTextureSize(),c=o.createText({text:i.defaultText||u.Constants.DEFAULTS.TEXT,position:new u.Vector2(.5,.5),maxWidth:.5,maxHeight:l?l/r.y:3,fontSize:.08,fontFamily:n.getFontFamily(),fontWeight:n.getFontWeight(),fontStyle:n.getFontStyle(),alignment:"center"});o.addSprite(c),this.setSharedState({selectedSprite:c})}},e.prototype._onBackClick=function(t){var e=this.context.editor;e.render(),this._backButtonClicked=!0,this.props.onSwitchControls("home")},e.prototype.sharedStateDidChange=function(t){"selectedSprite"in t&&this.forceUpdate()},e.prototype._onFontSizeChange=function(t){var e=this.context.editor.getOutputDimensions(),o=this.getSharedState("selectedSprite");o.setFontSize(t/e.y),this.forceUpdate()},e.prototype._onFontChange=function(t){var e=this.getSharedState("selectedSprite");e.setFontFamily(t.getFontFamily()),e.setFontWeight(t.getFontWeight()),e.setFontStyle(t.getFontStyle()),this.forceUpdate()},e.prototype._onAlignmentClick=function(t){var e=this.getSharedState("selectedSprite"),o=e.getAlignment(),n=x.indexOf(o),i=(n+1)%x.length,r=x[i];e.setAlignment(r),this.forceSharedUpdate()},e.prototype._onTakeToFrontClick=function(t){var e=this.getSharedState("operation");e.takeSpriteToFront(this.getSharedState("selectedSprite")),this.forceSharedUpdate()},e.prototype._onForegroundColorChange=function(t){var e=this.getSharedState("selectedSprite");e.setColor(t)},e.prototype._onBackgroundColorChange=function(t){var e=this.getSharedState("selectedSprite");e.setBackgroundColor(t)},e.prototype._switchToMode=function(t){t===this.state.mode&&(t=null),this.setState({mode:t})},e.prototype.renderOverlayControls=function(){switch(this.state.mode){case"size":return this._renderFontSizeOverlayControl();case"font":return this._renderFontFamilyOverlayControl();default:return null}},e.prototype._renderFontSizeOverlayControl=function(){var t=this.getSharedState("selectedSprite");if(t){var e=this.context.editor,o=e.getOutputDimensions(),n=Math.round(o.y),i=Math.round(t.getFontSize()*o.y);return u.ReactBEM.createElement(v["default"],{value:i,maxValue:n,label:this._t("controls.text.size"),onChange:this._onFontSizeChange})}},e.prototype._renderSizeItem=function(){var t=this.getSharedState("selectedSprite");if(t){var e=this.context.editor.getOutputDimensions(),o=t.getFontSize(),n="size"===this.state.mode?"is-active":null;return u.ReactBEM.createElement("li",{bem:"e:item",key:"size"},u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:n,"data-identifier":"fontSize",onClick:this._switchToMode.bind(this,"size")},u.ReactBEM.createElement("div",{bem:"b:fontSize e:text"},Math.round(o*e.y)),u.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.text.size")))))}},e.prototype._renderFontFamilyOverlayControl=function(){var t=this.getSharedState("selectedSprite");if(t)return u.ReactBEM.createElement(S["default"],{fontFamily:t.getFontFamily(),fontWeight:t.getFontWeight(),fontStyle:t.getFontStyle(),fonts:this._fonts,onChange:this._onFontChange})},e.prototype._renderFontItem=function(){var t=this.getSharedState("selectedSprite");if(t){var e="font"===this.state.mode?"is-active":null;return u.ReactBEM.createElement("li",{bem:"e:item",key:"font"},u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:e,"data-identifier":"font",onClick:this._switchToMode.bind(this,"font")},u.ReactBEM.createElement(b["default"],{fontFamily:t.getFontFamily(),fontWeight:t.getFontWeight(),fontStyle:t.getFontStyle()}),u.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.text.font")))))}},e.prototype._renderAlignmentItem=function(){var t=this.getSharedState("selectedSprite");if(t){var e=t.getAlignment();return u.ReactBEM.createElement("li",{bem:"e:item",key:"alignment"},u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",onClick:this._onAlignmentClick,"data-identifier":"alignment"},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/text/align_"+e+".png",!0)}),u.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.text.alignment")))))}},e.prototype._renderTakeToFrontItem=function(){return u.ReactBEM.createElement("li",{bem:"e:item",key:"takeToFront"},u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",onClick:this._onTakeToFrontClick},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/take_to_front.png",!0)}),u.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.text.takeToFront")))))},e.prototype.renderControls=function(){if(this.state.loading)return u.ReactBEM.createElement("div",null);var t=[this._renderSizeItem(),this._renderFontItem(),this._renderAlignmentItem()],e=this.getSharedState("selectedSprite"),o=e.getColor().clone(),n=e.getBackgroundColor().clone();return[u.ReactBEM.createElement("div",{bem:"e:cell m:list"},u.ReactBEM.createElement(f["default"],{ref:"scrollbar"},u.ReactBEM.createElement("ul",{bem:"$e:list"},t))),u.ReactBEM.createElement("div",{bem:"e:cell m:colorPicker"},u.ReactBEM.createElement(_["default"],{initialValue:o,label:this._t("controls.text.foreground"),onChange:this._onForegroundColorChange})),u.ReactBEM.createElement("div",{bem:"e:cell m:colorPicker"},u.ReactBEM.createElement(_["default"],{initialValue:n,label:this._t("controls.text.background"),onChange:this._onBackgroundColorChange}))]},e}(d["default"]);e["default"]=w,w.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype._onEditClick=function(t){t.preventDefault(),t.stopPropagation(),this.props.onEdit&&this.props.onEdit()},e.prototype._onTakeToFrontClick=function(t){t.preventDefault(),t.stopPropagation(),this.props.onTakeToFront&&this.props.onTakeToFront()},e.prototype._onRemoveClick=function(t){t.preventDefault(),t.stopPropagation(),this.props.onRemove&&this.props.onRemove()},e.prototype._renderItems=function(){var t=[u.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onTakeToFrontClick.bind(this)},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/take-to-front.png",!0)}))];return u.Utils.isMobile()&&(t=t.concat([u.ReactBEM.createElement("div",{bem:"$e:separator"}),u.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onEditClick.bind(this)},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/edit.png",!0)}))])),t=t.concat([u.ReactBEM.createElement("div",{bem:"$e:separator"}),u.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onRemoveClick.bind(this)},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/remove.png",!0)}))])},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("div",{bem:"$b:spritesControlsOverlay"},this._renderItems())},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("bem",{specifier:"$b:controls"},u.ReactBEM.createElement("div",{bem:"e:cell m:largeButton"},u.ReactBEM.createElement("div",{bem:"$e:largeButton",onClick:this.props.onClick},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/tick.png",!0)}))))},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onCloseClick"),a}return(0,c["default"])(e,t),e.prototype._onCloseClick=function(){this.context.mediator.emit(u.Constants.EVENTS.CLOSE)},e.prototype.renderWithBEM=function(){var t=void 0;return this.context.options.showCloseButton&&(t=u.ReactBEM.createElement("div",{bem:"$e:close",onClick:this._onCloseClick},u.ReactBEM.createElement("img",{bem:"e:image",src:this._getAssetPath("close.png",!0)}))),u.ReactBEM.createElement("div",{bem:"$b:header"},u.ReactBEM.createElement("div",{bem:"e:label"},this.context.options.title),t)},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(154),d=n(p),h=o(156),f=n(h),m=o(153),_=n(m),g=o(155),v=n(g),y=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._modalManager=a.props.modalManager,a._bindAll("_onModalManagerUpdate"),a}return(0,c["default"])(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this),this._modalManager.on("update",this._onModalManagerUpdate)},e.prototype.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this),this._modalManager.off("update",this._onModalManagerUpdate)},e.prototype._onModalManagerUpdate=function(){this.forceUpdate()},e.prototype._onModalClosed=function(t){this._modalManager.removeModal(t)},e.prototype._renderModals=function(){var t=this,e=this._modalManager.getModals();return e.map(function(e){var o=void 0;switch(e.type){case"loading":o=d["default"];break;case"warning":o=f["default"];break;case"error":o=_["default"];break;case"progress":o=v["default"]}return u.ReactBEM.createElement(o,{modal:e,onClose:t._onModalClosed.bind(t,e)})})},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("div",null,this._renderModals())},e}(u.BaseComponent);e["default"]=y,y.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onClose"),a}return(0,c["default"])(e,t),e.prototype._onClose=function(){this.props.modal.close()},e.prototype.renderWithBEM=function(){var t=this.props.modal,e=u.ReactBEM.createElement("div",{bem:"e:modal m:error"},u.ReactBEM.createElement("div",{bem:"e:title"},t.title),u.ReactBEM.createElement("div",{bem:"e:text"},t.text),u.ReactBEM.createElement("div",{bem:"e:button b:button m:inline",onClick:this._onClose},"OK")),o=t.overlay?u.ReactBEM.createElement("div",{bem:"e:overlay"},e):e;return u.ReactBEM.createElement("bem",{specifier:"$b:modals"},o)},e}(u.BaseComponent);e["default"]=p,p.propTypes={modal:u.React.PropTypes.object},p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.renderWithBEM=function(){var t=this.props.modal;return u.ReactBEM.createElement("bem",{specifier:"$b:modals"},u.ReactBEM.createElement("div",{bem:"e:overlay"},u.ReactBEM.createElement("div",{bem:"e:modal m:loading"},u.ReactBEM.createElement("div",{bem:"e:text"},t.text))))},e}(u.BaseComponent);e["default"]=p,p.propTypes={modal:u.React.PropTypes.object},p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.renderWithBEM=function(){var t=this.props.modal,e=t.data.progress,o={width:(100*(e||0)).toFixed(2)+"%"};return u.ReactBEM.createElement("bem",{specifier:"$b:modals"},u.ReactBEM.createElement("div",{bem:"e:overlay"},u.ReactBEM.createElement("div",{bem:"e:modal m:loading"},u.ReactBEM.createElement("div",{bem:"e:text"},t.text),u.ReactBEM.createElement("bem",{specifier:"b:loadingModal"},u.ReactBEM.createElement("div",{bem:"$e:progressBar"},u.ReactBEM.createElement("div",{bem:"e:progress",style:o}))))))},e}(u.BaseComponent);e["default"]=p,p.propTypes={modal:u.React.PropTypes.object},p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.renderWithBEM=function(){var t=this.props.modal;return u.ReactBEM.createElement("bem",{specifier:"$b:modals"},u.ReactBEM.createElement("div",{bem:"e:modal m:warning"},u.ReactBEM.createElement("div",{bem:"e:title"},t.title),u.ReactBEM.createElement("div",{bem:"e:text"},t.text),u.ReactBEM.createElement("div",{bem:"e:button b:button m:inline",onClick:this.props.onClose},"OK")))},e}(u.BaseComponent);e["default"]=p,p.propTypes={modal:u.React.PropTypes.object},p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(4),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=function(t){function e(){var o;(0,s["default"])(this,e);for(var n=arguments.length,i=Array(n),a=0;a<n;a++)i[a]=arguments[a];var l=(0,c["default"])(this,t.call.apply(t,[this].concat(i)));return l._bindAll("_onDragStart","_onDragMove","_onDragEnd","_onWindowResize","_onFeaturesUpdated","_onZoomChange"),l._events=(o={},(0,r["default"])(o,d.Constants.EVENTS.WINDOW_RESIZE,l._onWindowResize),(0,r["default"])(o,d.Constants.EVENTS.FEATURES_UPDATED,l._onFeaturesUpdated),o),l._initialRenderDone=!1,l.state={canvasPosition:new d.Vector2,canvasOffset:new d.Vector2},l}return(0,p["default"])(e,t),e.prototype._onWindowResize=function(){var t=this.context.editor,e=t.getSDK();e.resizeTo(this._getContainerDimensions()),t.zoom.set("auto")},e.prototype._onFeaturesUpdated=function(t){t.indexOf("drag")!==-1&&this.forceUpdate()},e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this);var e=this.context.editor,o=e.getRenderer(),n=this.refs,i=n.canvasCell,r=n.canvas,a=i.offsetWidth,s=i.offsetHeight;o.setCanvas(r),o.resizeTo(new d.Vector2(a,s),!0),e.zoom.on("set",this._onZoomChange)},e.prototype.componentWillUnmount=function(){var t=this.context.editor;t.zoom.off("set",this._onZoomChange)},e.prototype._onZoomChange=function(){this.forceUpdate()},e.prototype._onDragStart=function(t){var e=this.context.editor;e.features.isEnabled("drag")&&(t.preventDefault(),this._dragStartPosition=d.Utils.getEventPosition(t.nativeEvent),this._dragInitialOffset=e.getOffset().clone(),document.addEventListener("mousemove",this._onDragMove),document.addEventListener("touchmove",this._onDragMove),document.addEventListener("mouseup",this._onDragEnd),document.addEventListener("touchend",this._onDragEnd))},e.prototype._onDragMove=function(t){var e=d.Utils.getEventPosition(t),o=e.clone().subtract(this._dragStartPosition),n=this._dragInitialOffset.clone().add(o),i=this.context.editor,r=i.getOffset().clone();i.setOffset(n),i.getOffset().equals(r)||i.render()},e.prototype._onDragEnd=function(t){document.removeEventListener("mousemove",this._onDragMove),document.removeEventListener("touchmove",this._onDragMove),document.removeEventListener("mouseup",this._onDragEnd),document.removeEventListener("touchend",this._onDragEnd)},e.prototype._getContainerDimensions=function(){var t=this.refs.canvasCell;return new d.Vector2(t.offsetWidth,t.offsetHeight)},e.prototype._getDraggableStyle=function(){return{top:this.state.canvasPosition.y+this.state.canvasOffset.y,left:this.state.canvasPosition.x+this.state.canvasOffset.x}},e.prototype.renderWithBEM=function(){var t=null,e=null;this.props.largeControls?e=this.props.children:t=this.props.children;var o=this.context.editor,n=o.isReady()&&o.zoom.get()>o.zoom.getDefault(),i=o.features.isEnabled("drag")&&n;return d.ReactBEM.createElement("div",{bem:"$b:canvas e:container e:row"},d.ReactBEM.createElement("div",{bem:"e:container e:cell",ref:"canvasCell"},d.ReactBEM.createElement("div",{bem:"e:innerContainer",className:i?"is-draggable":null,onTouchStart:this._onDragStart,onMouseDown:this._onDragStart,style:this._getDraggableStyle()},d.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),t),e))},e}(d.BaseComponent);e["default"]=h,h.contextTypes=d.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(63),d=n(p),h=o(21),f=n(h),m=o(157),_=n(m),g=o(7),v=n(g),y=o(127),b=n(y),E=o(68),S=n(E),M=500,C=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._overviewControls=d["default"],a._bindAll("switchToControls","_startEditor","_onWindowResize","_onWindowResizeDone","_onImageResize","_onNewImage","_onRenderError"),a._previousControlsStack=[],a.state={zoom:null,controls:b["default"],dragEnabled:!0,sharedState:new u.SharedState},a._editor=new S["default"](a.context.ui,a.context.options,a.context.mediator),a._editor.on("new-image",a._onNewImage),a._editor.on("ready",a._startEditor),a._editor.on("resize",a._onImageResize),a._editor.on("render-error",a._onRenderError),a._forceControls=a.context.options.editor.forceControls,a._forceControlIndex=0,a}return(0,c["default"])(e,t),e.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this);var e=this.context.options.editor.image;this.setImage(e),this._editor.render(),this._switchToNextForceControl();var o=this.context.options;o.responsive&&window.addEventListener("resize",this._onWindowResize)},e.prototype.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this),this._editor.dispose();var e=this.context.options;e.responsive&&window.removeEventListener("resize",this._onWindowResize)},e.prototype._startEditor=function(){this._editor.start()},e.prototype._switchToNextForceControl=function(){if(this._forceControlIndex<this._forceControls.length){var t=this._forceControls[this._forceControlIndex],e=t.control,o=t.options,n=this._editor.controls.getAvailable(),i=n[e],r=u.SDKUtils.defaults({forcedControl:!0},o);if(!i)throw new Error("Force controls: Could not find control with identifier `"+e+"`");this.switchToControls(i,{},null,r),this._forceControlIndex++}},e.prototype._onRenderError=function(t){v["default"].instance.displayError(this._t("errors.renderingError.title"),this._t("errors.renderingError.text"),!0),u.Log.error(this.constructor.name,"An error occurred while rendering: "+t.message),u.Log.printError(t)},e.prototype._onNewImage=function(){this.switchToControls(b["default"])},e.prototype._onImageResize=function(){var t=this,e=v["default"].instance.displayLoading(this._t("loading.resizing"));this._editor.once("resized",function(o){var n=o.dimensions,i=o.reason;e.close(),t.context.options.editor.displayResizeMessage&&v["default"].instance.displayWarning(t._t("warnings.imageResized_"+i+".title"),t._t("warnings.imageResized_"+i+".text",{maxMegaPixels:t._editor.getMaxMegapixels(),width:n.x,height:n.y}))})},e.prototype._onWindowResize=function(){this._resizeTimeout&&(window.clearTimeout(this._resizeTimeout),this._resizeTimeout=null),this._resizeTimeout=window.setTimeout(this._onWindowResizeDone,M)},e.prototype._onWindowResizeDone=function(){this._emitEvent(u.Constants.EVENTS.WINDOW_RESIZE)},e.prototype.switchToControls=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments[3],i=null;if("back"===t)i=this._previousControlsStack.pop();else if("home"===t){if(this._forceControlIndex<this._forceControls.length)return this._switchToNextForceControl();i=b["default"],this._previousControlsStack=[]}else i=t,this._previousControlsStack.push(this.state.controls);var r=this.state.controls!==i;this.state.controls.onExit&&this.state.controls.onExit.call(this.refs.controls),this.state.sharedState.clear(),this.state.sharedState.set(e,!1);var a=u.SDKUtils.defaults(n||this.context.options.editor.controlsOptions[i.identifier],i.defaultOptions);return i.onEnter&&i.onEnter.call(this.refs.controls,this.state.sharedState,a),r?void this.setState({controls:i,controlsOptions:a},o):o&&o()},e.prototype.getZoom=function(){return this.state.zoom},e.prototype["export"]=function(){for(var t=this,e=arguments.length,o=Array(e),n=0;n<e;n++)o[n]=arguments[n];return new Promise(function(e,n){t.switchToControls("home",{},function(){var i;(i=t._editor)["export"].apply(i,o).then(e)["catch"](n)})})},e.prototype.getEditor=function(){return this._editor},e.prototype.serialize=function(){var t;return(t=this._editor).serialize.apply(t,arguments)},e.prototype.deserialize=function(t){return this._editor.deserialize(t)},e.prototype._showUndoButton=function(){return this._editor.history.isAvailable()},e.prototype.getChildContext=function(){return{editor:this._editor,ui:this.context.ui,options:this.context.options,editorScreen:this,mediator:this.context.mediator}},e.prototype.setImage=function(t,e){this._editor.setImage(t,e)},e.prototype._renderScreen=function(){var t=this.state.controls.controlsComponent,e=this.state.controls.canvasControlsComponent;e||(e=b["default"].canvasControlsComponent);
var o=this.state.controls.topBarControlsComponent;o||(o=b["default"].topBarControlsComponent);var n=void 0,i=void 0,r=void 0;o&&this.context.options.showTopBar&&(r=u.ReactBEM.createElement(o,{sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,ref:"topBarControls"})),t&&(n=u.ReactBEM.createElement(t,{onSwitchControls:this.switchToControls,sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,key:this.state.controls.identifier+"-controls",ref:"controls"})),e&&(i=u.ReactBEM.createElement(e,{onSwitchControls:this.switchToControls,sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,key:this.state.controls.identifier+"-canvasControls",ref:"canvasControls"}));var a="$b:editorScreen";return this.context.options.showHeader||(a+=" m:noHeader"),u.ReactBEM.createElement("div",{bem:a},r,u.ReactBEM.createElement(_["default"],{ref:"canvas",largeControls:this.state.controls.largeCanvasControls},i),u.ReactBEM.createElement("div",{bem:"$b:controls $e:container e:row"},u.ReactBEM.createElement("div",{bem:"e:cell"},n)))},e}(f["default"]);e["default"]=C,C.childContextTypes={ui:u.React.PropTypes.object.isRequired,editor:u.React.PropTypes.object.isRequired,mediator:u.React.PropTypes.object.isRequired,options:u.React.PropTypes.object.isRequired,editorScreen:u.React.PropTypes.object.isRequired},C.contextTypes=f["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(195),d=n(p),h=o(21),f=n(h),m=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a.state={progress:0},a._preloader=new d["default"](a.context.ui,a.context.options,a.context.mediator),a._preloader.on("progress",function(t){a.state.progress=t}),a._preloader.on("done",function(){a.props.app.switchToScreen("post-loading")}),a}return(0,c["default"])(e,t),e.prototype.componentDidMount=function(){var e=this;t.prototype.componentDidMount.call(this);var o=window,n=o.devicePixelRatio;this._canvas=this.refs.canvas,this._canvas.width=this._canvas.offsetWidth*n,this._canvas.height=this._canvas.offsetHeight*n,this._context=this._canvas.getContext("2d"),this._preloaderImage=new window.Image,this._preloaderImage.addEventListener("load",function(){e._preloader.load(),(0,u.requestAnimationFrame)(e._tick)}),this._preloaderImage.src=this.context.ui.getAssetPath("preloader.png",!0),this._running=!0,this._tick=this._tick.bind(this)},e.prototype.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this),this._running=!1},e.prototype._tick=function(){this._renderLoadingIndicator(),this._running&&(0,u.requestAnimationFrame)(this._tick)},e.prototype._renderLoadingIndicator=function(){var t=this._canvas,e=t.width,o=t.height,n=this._context;n.clearRect(0,0,e,o),n.save(),n.beginPath(),n.moveTo(e/2,o/2),n.arc(e/2,o/2,e/2,.5*-Math.PI,2*Math.PI*this.state.progress-.5*Math.PI,!1),n.lineTo(e/2,o/2),n.clip(),n.drawImage(this._preloaderImage,0,0,this._preloaderImage.width,this._preloaderImage.height,0,0,e,o),n.restore(),n.save(),n.globalAlpha=.05,n.drawImage(this._preloaderImage,0,0,this._preloaderImage.width,this._preloaderImage.height,0,0,e,o),n.restore()},e.prototype._renderScreen=function(){return u.ReactBEM.createElement("div",{bem:"$b:loadingScreen"},u.ReactBEM.createElement("div",{bem:"e:container"},u.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"})))},e}(f["default"]);e["default"]=m,m.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onClick"),a}return(0,c["default"])(e,t),e.prototype._onClick=function(){this.props.onClick&&this.props.onClick(this.props.library)},e.prototype.renderWithBEM=function(){var t=this.props.library,e={backgroundImage:"url("+t.coverImage+")"};return u.ReactBEM.createElement("bem",{specifier:"b:photoRoll e:libraryList"},u.ReactBEM.createElement("li",{bem:"e:item",style:e,onClick:this._onClick},u.ReactBEM.createElement("div",{bem:"e:overlay"}),u.ReactBEM.createElement("div",{bem:"e:name"},t.name)))},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.renderWithBEM=function(){var t=this.props.photo;return u.ReactBEM.createElement("bem",{specifier:"b:photoRoll e:photoList"},u.ReactBEM.createElement("li",{bem:"$e:item",onClick:this.props.onClick},u.ReactBEM.createElement("div",{bem:"e:overlay"}),u.ReactBEM.createElement("div",{bem:"e:title"},t.title),u.ReactBEM.createElement("img",{bem:"e:image",src:t.urls.thumb})))},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(65),d=n(p),h=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));a._bindAll("_onSearchSuggestionClick");var l=a.context.options.photoRoll.provider;return a._provider=new l,a.state={searchSuggestions:[]},a}return(0,c["default"])(e,t),e.prototype._onSearchSuggestionClick=function(t){this.props.onSearchSuggestionClicked&&this.props.onSearchSuggestionClicked(t)},e.prototype.componentDidMount=function(){var e=this;t.prototype.componentDidMount.call(this),this._provider.getSearchSuggestions().then(function(t){e.setState({searchSuggestions:t})})},e.prototype._renderMessage=function(){return{__html:this._t("photoRoll.search.noSearchResults",{query:this.props.query})}},e.prototype._renderSearchSuggestions=function(){var t=this;if(!this.state.searchSuggestions.length)return null;var e=this.state.searchSuggestions.map(function(e){return u.ReactBEM.createElement(d["default"],{onClick:t._onSearchSuggestionClick,searchSuggestion:e})});return u.ReactBEM.createElement("div",null,u.ReactBEM.createElement("div",{bem:"e:headline"},"Search suggestions"),u.ReactBEM.createElement("ul",{bem:"$e:libraryList"},e))},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("div",{bem:"$b:photoRoll e:row m:fullHeight"},u.ReactBEM.createElement("div",{bem:"e:cell"},u.ReactBEM.createElement("div",{bem:"e:container"},u.ReactBEM.createElement("div",{bem:"e:innerContainer"},u.ReactBEM.createElement("div",{bem:"e:noSearchResults",dangerouslySetInnerHTML:this._renderMessage()}),this._renderSearchSuggestions()))))},e}(u.BaseComponent);e["default"]=h,h.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(212),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=o(7),f=n(h),m=o(160),_=n(m),g=o(65),v=n(g),y=function(t){function e(){(0,s["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var r=(0,c["default"])(this,t.call.apply(t,[this].concat(n)));r._needsStyleFixes=!0,r.state={loading:!0,libraries:[],searchSuggestions:[]},r._bindAll("_onLibraryClick","_onSearchSuggestionClick");var a=r.context.options.photoRoll.provider;return r._provider=new a,r}return(0,p["default"])(e,t),e.prototype.fixStyles=function(){if(d.Utils.Browser.isIElte(11)){var t=this.refs,e=t.cell,o=t.container;if(!e||!o)return;var n=e.offsetHeight;o.style.height=n+"px"}},e.prototype.componentDidMount=function(){var e=this;t.prototype.componentDidMount.call(this);var o=f["default"].instance.displayLoading(this._t("loading.loading"));this._load().then(function(t){var n=(0,r["default"])(t,2),i=n[0],a=n[1];o.close(),1===i.length?e._onLibraryClick(i[0],!0):e.setState({loading:!1,libraries:i,searchSuggestions:a})})},e.prototype._onLibraryClick=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.props.onLibraryClicked&&this.props.onLibraryClicked(t,e)},e.prototype._onSearchSuggestionClick=function(t){this.props.onSearchSuggestionClicked&&this.props.onSearchSuggestionClicked(t)},e.prototype._load=function(){var t=[this._provider.getLibraries(),this._provider.getSearchSuggestions()];return d.Promise.all(t)},e.prototype._renderLibraries=function(){var t=this,e=this.state.libraries.map(function(e){return d.ReactBEM.createElement(_["default"],{onClick:t._onLibraryClick,library:e})});return d.ReactBEM.createElement("li",{bem:"e:item"},d.ReactBEM.createElement("bem",{specifier:"b:photoRoll"},d.ReactBEM.createElement("div",{bem:"e:headline"},"Browse libraries"),d.ReactBEM.createElement("ul",{bem:"$e:libraryList"},e)))},e.prototype._renderSearchSuggestions=function(){var t=this;if(!this.state.searchSuggestions.length)return null;var e=this.state.searchSuggestions.map(function(e){return d.ReactBEM.createElement(v["default"],{onClick:t._onSearchSuggestionClick,searchSuggestion:e})});return d.ReactBEM.createElement("li",{bem:"e:item"},d.ReactBEM.createElement("bem",{specifier:"b:photoRoll"},d.ReactBEM.createElement("div",{bem:"e:headline"},"Search suggestions"),d.ReactBEM.createElement("ul",{bem:"$e:libraryList"},e)))},e.prototype._renderContent=function(){return d.ReactBEM.createElement("div",{bem:"$b:photoRoll e:row m:fullHeight"},d.ReactBEM.createElement("div",{bem:"e:cell",ref:"cell"},d.ReactBEM.createElement("div",{bem:"e:container",ref:"container"},d.ReactBEM.createElement("div",{bem:"e:innerContainer"},d.ReactBEM.createElement("ul",{bem:"$e:groupList"},this._renderLibraries(),this._renderSearchSuggestions())))))},e.prototype.renderWithBEM=function(){return this.state.loading?d.ReactBEM.createElement("div",null):this._renderContent()},e}(d.BaseComponent);e["default"]=y,y.contextTypes=d.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(21),d=n(p),h=o(167),f=n(h),m=o(163),_=n(m),g=o(66),v=n(g),y=o(165),b=n(y),E=o(7),S=n(E),M=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a.state={section:"overview",sectionsHistory:[]},a._bindAll("_onLibraryClicked","_onSearchSuggestionClicked","_onPhotoClicked","_onFileUpload","_onWebcamClick","_onBackClicked","_onSearch"),a}return(0,c["default"])(e,t),e.prototype.hasPreviousSection=function(){return!!this.state.sectionsHistory.length},e.prototype.switchToSection=function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if("back"===t){if(!this.hasPreviousSection())return e?this.props.app.switchToScreen("back"):this.switchToSection("overview");t=this.state.sectionsHistory.pop()}else this.state.section!==t&&o&&this.state.sectionsHistory.push(this.state.section);this.setState({section:t})},e.prototype._onLibraryClicked=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.state.library=t,this.switchToSection("library",!0,!e)},e.prototype._onSearchSuggestionClicked=function(t){this.state.searchQuery=t.query,this.switchToSection("search")},e.prototype._onPhotoClicked=function(t){var e=this,o=S["default"].instance.displayLoading(this._t("loading.loading")),n=new window.Image;n.addEventListener("load",function(){o.close(),e.props.app.setImage(n,!0)}),n.addEventListener("error",function(){o.close(),S["default"].instance.displayError(e._t("errors.imageLoadFail.title"),e._t("errors.imageLoadFail.text",{path:n.src}))}),n.crossOrigin="Anonymous",n.src=t.urls.raw},e.prototype._onBackClicked=function(){this.switchToSection("back")},e.prototype._onSearch=function(t){return t.trim().length?(this.state.searchQuery=t,void this.switchToSection("search")):(this.state.searchQuery=null,this.switchToSection("back",!1))},e.prototype._onWebcamClick=function(){this.props.app.switchToScreen("webcam")},e.prototype._onFileUpload=function(t){this.props.app.setImage(t)},e.prototype._isBackButtonVisible=function(){return 0!==this.state.sectionsHistory.length||this.props.app.hasPreviousScreen()},e.prototype._renderContent=function(){switch(this.state.section){case"search":return u.ReactBEM.createElement(b["default"],{query:this.state.searchQuery,onPhotoClicked:this._onPhotoClicked,onSearchSuggestionClicked:this._onSearchSuggestionClicked});case"library":return u.ReactBEM.createElement(v["default"],{library:this.state.library,onPhotoClicked:this._onPhotoClicked});case"overview":return u.ReactBEM.createElement(_["default"],{onLibraryClicked:this._onLibraryClicked,onSearchSuggestionClicked:this._onSearchSuggestionClicked})}},e.prototype._renderScreen=function(){var t=this._renderContent();return u.ReactBEM.createElement("div",{bem:"$b:photoRollScreen"},u.ReactBEM.createElement(f["default"],{onBackClicked:this._onBackClicked,onSearch:this._onSearch,searchQuery:this.state.searchQuery,onFileUpload:this._onFileUpload,onWebcamClick:this._onWebcamClick,backButton:this._isBackButtonVisible(),backButtonLabel:this._t("generic.back"),ref:"topBarControls"}),t)},e}(d["default"]);e["default"]=M,M.childContextTypes={ui:u.React.PropTypes.object.isRequired,editor:u.React.PropTypes.object.isRequired,mediator:u.React.PropTypes.object.isRequired,options:u.React.PropTypes.object.isRequired,editorScreen:u.React.PropTypes.object.isRequired},M.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(66),d=n(p),h=o(162),f=n(h),m=o(7),_=n(m),g=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.componentWillReceiveProps=function(t){t.query!==this.props.query&&this._loadPhotos(t.query)},e.prototype._getHeadline=function(){return this._t("photoRoll.search.results.headline",{query:this.props.query})},e.prototype._loadPhotos=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.query;this._totalPhotosHeight=0;var o=_["default"].instance.displayProgress(this._t("loading.loading")),n=this.context.options.photoRoll.provider,i=new n;i.searchPhotos(e).then(function(e){return t._preloadPhotos(e,o)}).then(function(e){t.setState({photos:e,loading:!1}),o.close()})},e.prototype._renderNotFound=function(){return u.ReactBEM.createElement(f["default"],{query:this.props.query,onSearchSuggestionClicked:this.props.onSearchSuggestionClicked})},e.prototype.renderWithBEM=function(){return this.state.loading?u.ReactBEM.createElement("div",null):0===this.state.photos.length?this._renderNotFound():this._renderPhotos()},e}(d["default"]);e["default"]=g,g.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("bem",{specifier:"$b:topBar"},u.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this.props.onClick},u.ReactBEM.createElement("img",{bem:"e:icon",src:this.props.icon})))},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(31),d=n(p),h=o(166),f=n(h),m=o(40),_=n(m),g=o(168),v=n(g),y=o(175),b=n(y),E=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onUploadButtonClicked","_onWebcamButtonClicked","_onBackClicked","_onSearchValueChange","_onNewFile"),a._onSearchValueChange=u.Utils.debounce(a._onSearchValueChange,250),a}return(0,c["default"])(e,t),e.prototype._onBackClicked=function(){this.props.onBackClicked&&this.props.onBackClicked()},e.prototype._onSearchValueChange=function(t){this.props.onSearch&&this.props.onSearch(t)},e.prototype._onUploadButtonClicked=function(){this.refs.upload.open()},e.prototype._onWebcamButtonClicked=function(){this.props.onWebcamClick&&this.props.onWebcamClick()},e.prototype._onNewFile=function(t){this.props.onFileUpload&&this.props.onFileUpload(t)},e.prototype._isWebcamAvailable=function(){return!u.Utils.isMobile()&&this.context.options.enableWebcam!==!1},e.prototype._renderRightButtons=function(){var t=this.context.options,e=[];return t.enableUpload&&e.push(u.ReactBEM.createElement(f["default"],{icon:this._getAssetPath("photo-roll/upload.png",!0),onClick:this._onUploadButtonClicked})),this._isWebcamAvailable()&&e.push(u.ReactBEM.createElement(f["default"],{icon:this._getAssetPath("photo-roll/webcam.png",!0),onClick:this._onWebcamButtonClicked})),e},e.prototype.renderWithBEM=function(){var t=void 0;return this.props.backButton&&(t=u.ReactBEM.createElement(b["default"],{label:this.props.backButtonLabel,onClick:this._onBackClicked})),u.ReactBEM.createElement("div",{bem:"$b:topBar e:row"},u.ReactBEM.createElement("div",{bem:"e:cell"},u.ReactBEM.createElement("div",{bem:"e:table"},u.ReactBEM.createElement("div",{bem:"e:cell m:left"},t),u.ReactBEM.createElement("div",{bem:"e:cell m:fullWidth"},u.ReactBEM.createElement(v["default"],{searchQuery:this.props.searchQuery,onChange:this._onSearchValueChange}),u.ReactBEM.createElement(_["default"],{onNewFile:this._onNewFile,ref:"upload"})),u.ReactBEM.createElement("div",{bem:"e:cell m:right"},this._renderRightButtons()))))},e}(d["default"]);e["default"]=E,E.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._bindAll("_onFocus","_onBlur","_onChange","_onBarClick"),a.state={active:!1,placeholder:a._t("photoRoll.search.placeholder"),value:a.props.searchQuery||""},a}return(0,c["default"])(e,t),e.prototype.componentWillReceiveProps=function(t){t.searchQuery||this.state.value?this.state.active=!0:this.state.active=!1,this.setState({value:t.searchQuery||""})},e.prototype.componentDidUpdate=function(){this.refs.input.value=this.state.value},e.prototype.componentDidMount=function(){var e=this;t.prototype.componentDidMount.call(this),this._hiddenInputDummy=document.createElement("div");var o=u.Utils.getStyleObject(this.refs.input),n=["font","lineHeight","textAlign","textIndent","textTransform","textDecoration","textRendering","textShadow","textOverflow","wordSpacing","letterSpacing","whiteSpace"];n.forEach(function(t){e._hiddenInputDummy.style[t]=o[t]}),this._hiddenInputDummy.style.position="absolute",this._hiddenInputDummy.style.top="-9999px",this._hiddenInputDummy.style.left="-9999px",this.refs.root.appendChild(this._hiddenInputDummy),this._updateInputWidth()},e.prototype._updateInputWidth=function(){var t=this;this._hiddenInputDummy.innerHTML=this.state.value||this.state.placeholder,setTimeout(function(){t.setState({inputWidth:t._hiddenInputDummy.offsetWidth+5})},0)},e.prototype._onBarClick=function(){this.refs.input.focus()},e.prototype._onFocus=function(){this.setState({active:!0})},e.prototype._onBlur=function(){""!==this.state.value||this.props.searchQuery||this.setState({active:!1})},e.prototype._onChange=function(t){this.state.value=t.target.value,this.forceUpdate(),this.props.onChange&&this.props.onChange(this.state.value)},e.prototype.renderWithBEM=function(){var t="$e:searchBar",e="photo-roll/search-light.png";this.state.active&&(t+=" m:active",e="photo-roll/search-dark.png"),e=this._getAssetPath(e,!0);var o={width:this.state.inputWidth+"px"};return u.ReactBEM.createElement("bem",{specifier:"$b:photoRollScreen"},u.ReactBEM.createElement("div",{bem:t,ref:"root",onClick:this._onBarClick},u.ReactBEM.createElement("div",{bem:"e:content"},u.ReactBEM.createElement("div",{bem:"$e:icon"},u.ReactBEM.createElement("img",{src:e,bem:"e:image"})),u.ReactBEM.createElement("div",{bem:"e:inputContainer"},u.ReactBEM.createElement("input",{bem:"e:input",ref:"input",placeholder:this.state.placeholder,onBlur:this._onBlur,onFocus:this._onFocus,onChange:this._onChange,defaultValue:this.state.value,style:o})))))},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(39),d=n(p),h=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._needsStyleFixes=!0,a._modifier="photoRoll",a}return(0,c["default"])(e,t),e.prototype.fixStyles=function(){if(u.Utils.Browser.isIElte(11)){var t=this.refs,e=t.cell,o=t.overlay,n=e.offsetHeight;o.style.height=n+"px"}},e.prototype._renderContent=function(){var t={backgroundImage:"url("+this._getAssetPath("splash/photo-roll.png",!0,!0)+")"};return u.ReactBEM.createElement("div",{bem:"e:contentWrapper"},u.ReactBEM.createElement("div",{bem:"e:contentRow"},u.ReactBEM.createElement("div",{bem:"e:contentCell",onClick:this._onClick,style:t,ref:"cell"},u.ReactBEM.createElement("div",{bem:"e:overlay",ref:"overlay"}),u.ReactBEM.createElement("div",{bem:"e:headline"},this._t("splash.photoRoll.headline")),u.ReactBEM.createElement("div",{bem:"e:description"},this._t("splash.photoRoll.description")))))},e}(d["default"]);e["default"]=h,h.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(21),d=n(p),h=o(171),f=n(h),m=o(172),_=n(m),g=o(169),v=n(g),y=function(t){function e(){(0,r["default"])(this,e);var o=(0,s["default"])(this,t.call(this));return o._bindAll("_onWebcamClick","_onPhotoRollClick","_onImage"),o}return(0,c["default"])(e,t),e.prototype._onPhotoRollClick=function(){this.props.app.switchToScreen("photoRoll")},e.prototype._onWebcamClick=function(){this.props.app.switchToScreen("webcam")},e.prototype._onImage=function(t){this.props.app.setImage(t)},e.prototype._isWebcamAvailable=function(){return!u.Utils.isMobile()&&this.context.options.enableWebcam!==!1},e.prototype._isPhotoRollAvailable=function(){return!!this.context.options.photoRoll.provider},e.prototype._renderScreen=function(){var t=[],e=0,o=this.context.options.enableUpload;o&&e++;var n=this._isWebcamAvailable();n&&e++;var i=this._isPhotoRollAvailable();return i&&e++,o&&t.push(u.ReactBEM.createElement(f["default"],{onImage:this._onImage,totalRows:e})),n&&t.push(u.ReactBEM.createElement(_["default"],{onClick:this._onWebcamClick,totalRows:e})),i&&t.push(u.ReactBEM.createElement(v["default"],{onClick:this._onPhotoRollClick,totalRows:e})),u.ReactBEM.createElement("div",{bem:"$b:splashScreen"},u.ReactBEM.createElement("div",{bem:"e:container"},t))},e}(d["default"]);e["default"]=y,y.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(25),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(1),h=o(39),f=n(h),m=o(98),_=n(m),g=o(40),v=n(g),y=function(t){function e(){(0,s["default"])(this,e);var o=(0,c["default"])(this,t.call(this));return o._modifier="upload",o._bindAll("_onImage","_onDragEnter","_onDragOver","_onDragLeave","_onDrop"),o._dragCounter=0,o.state={dragAreaHovered:!1},o}return(0,p["default"])(e,t),e.prototype._onDragEnter=function(t){t.preventDefault(),this._dragCounter++,this.setState({dragAreaHovered:!0})},e.prototype._onDragOver=function(t){t.preventDefault()},e.prototype._onDragLeave=function(t){t.preventDefault(),this._dragCounter--,0===this._dragCounter&&this.setState({dragAreaHovered:!1})},e.prototype._onDrop=function(t){var e=this;t.stopPropagation(),t.preventDefault(),t=t.nativeEvent,t.returnValue=!1,this.setState({dragAreaHovered:!1},function(){t.dataTransfer&&e._handleFile(t.dataTransfer.files[0])})},e.prototype._onClick=function(t){this.refs.upload.open()},e.prototype._handleFile=function(t){var e=this,o=new window.FileReader;o.onload=function(){return function(t){var o=t.target.result,n=new window.Image;n.addEventListener("load",function(){e._onImage(n)}),n.src=o}}(t),o.readAsDataURL(t)},e.prototype._onImage=function(t){this.props.onImage&&this.props.onImage(t)},e.prototype._renderContent=function(){var t={onDragEnter:this._onDragEnter,onDragOver:this._onDragOver,onDragLeave:this._onDragLeave,onDrop:this._onDrop};this.state.dragAreaHovered&&(t.className="is-hovered");var e="e:contentCell";return this.context.options.enableWebcam===!1&&null===this.context.options.photoRoll.provider||(e+=" m:withBorder"),d.ReactBEM.createElement("div",{bem:"e:contentWrapper"},d.ReactBEM.createElement("div",{bem:"e:contentRow"},d.ReactBEM.createElement("div",(0,r["default"])({bem:e,onClick:this._onClick},t),d.ReactBEM.createElement(v["default"],{ref:"upload",onNewFile:this._onImage}),d.ReactBEM.createElement(_["default"],{bem:"e:button",uppercase:!0},this._t("splash.upload.button")),d.ReactBEM.createElement("div",{bem:"e:description"},this._t("splash.upload.description")))))},e}(f["default"]);e["default"]=y,y.propTypes={onImage:d.React.PropTypes.func.isRequired},y.contextTypes=f["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(39),d=n(p),h=function(t){function e(){(0,r["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var a=(0,s["default"])(this,t.call.apply(t,[this].concat(n)));return a._needsStyleFixes=!0,a._modifier="webcam",a}return(0,c["default"])(e,t),e.prototype.fixStyles=function(){if(u.Utils.Browser.isIElte(11)){var t=this.refs,e=t.cell,o=t.overlay,n=e.offsetHeight;o.style.height=n+"px"}},e.prototype._renderContent=function(){var t={backgroundImage:"url("+this._getAssetPath("splash/webcam.png",!0,!0)+")"};return u.ReactBEM.createElement("div",{bem:"e:contentWrapper"},u.ReactBEM.createElement("div",{bem:"e:contentRow"},u.ReactBEM.createElement("div",{bem:"e:contentCell",onClick:this._onClick,style:t,ref:"cell"},u.ReactBEM.createElement("div",{bem:"e:overlay",ref:"overlay"}),u.ReactBEM.createElement("div",{bem:"e:headline"},this._t("splash.webcam.headline")),u.ReactBEM.createElement("div",{bem:"e:description"},this._t("splash.webcam.description")))))},e}(d["default"]);e["default"]=h,h.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(7),d=n(p),h=function(t){function e(){(0,r["default"])(this,e);var o=(0,s["default"])(this,t.call(this));return o._bindAll("_onWebcamReady"),o.state={webcamReady:!1},o}return(0,c["default"])(e,t),e.prototype.shouldComponentUpdate=function(t,e){return!1},e.prototype.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this);var e=this.refs.video;if(this._stream){var o=this._stream.getTracks()[0];o&&o.stop(),this._stream.stop&&this._stream.stop()}e.pause()},e.prototype.componentDidMount=function(){this._resizeVideo(),this._initVideoStream()},e.prototype._onWebcamReady=function(){this.props.onReady&&this.props.onReady(),this.setState({webcamReady:!0})},e.prototype.makePhoto=function(){if(!this.state.webcamReady)return u.Promise.reject(new Error("UserMedia stream not ready"));var t=this.refs.video;return new u.Promise(function(e,o){var n=document.createElement("canvas");n.width=t.videoWidth,n.height=t.videoHeight;var i=n.getContext("2d");i.drawImage(t,0,0);var r=new window.Image;r.addEventListener("load",function(){e(r)}),r.src=n.toDataURL("image/png")})},e.prototype._resizeVideo=function(){var t=this.refs,e=t.video,o=t.container,n=u.Utils.getInnerDimensionsForElement(o);e.width=n.x,e.height=n.y},e.prototype._initVideoStream=function(){var t=this,e=this.refs.video,o=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;if(!o){var n=d["default"].instance.displayError(this._t("errors.webcamNotSupported.title"),this._t("errors.webcamNotSupported.text"));return void n.on("close",function(){return t.props.onBack()})}o.call(navigator,{video:!0},function(o){t._stream=o,e.onloadedmetadata=t._onWebcamReady,e.src=window.URL.createObjectURL(o)},function(e){console.error&&console.error(e);var o=d["default"].instance.displayError(t._t("errors.webcamUnavailable.title"),t._t("errors.webcamUnavailable.text",{error:e.name}),!0);o.on("close",function(){return t.props.onBack()})})},e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("div",{bem:"$b:webcam",ref:"container"},u.ReactBEM.createElement("video",{bem:"e:video",ref:"video",autoPlay:!0}))},e}(u.BaseComponent);e["default"]=h,h.propTypes={onReady:u.React.PropTypes.func},h.contextTypes=u.BaseComponent.contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(21),d=n(p),h=o(31),f=n(h),m=o(173),_=n(m),g=function(t){function e(){(0,r["default"])(this,e);var o=(0,s["default"])(this,t.call(this));return o._bindAll("_onCancel","_onWebcamReady","_onShutterClicked"),o.state={webcamReady:!1},o}return(0,c["default"])(e,t),e.prototype._onWebcamReady=function(){this.setState({webcamReady:!0})},e.prototype._onCancel=function(){this.props.app.switchToScreen("back")},e.prototype._onShutterClicked=function(){var t=this,e=this.refs.webcam;e.makePhoto().then(function(e){t.props.app.setImage(e)})["catch"](function(t){console.error&&console.error(t)})},e.prototype._renderScreen=function(){return u.ReactBEM.createElement("div",{bem:"$b:webcamScreen"},u.ReactBEM.createElement(f["default"],{label:this._t("webcam.headline")},u.ReactBEM.createElement("bem",{specifier:"$b:topBar"},u.ReactBEM.createElement("div",{bem:"e:cancelButton",onClick:this._onCancel},this._t("generic.cancel")),u.ReactBEM.createElement("div",{bem:"e:label"},this._t("webcam.headline")))),u.ReactBEM.createElement("div",{bem:"$b:canvas e:container e:row"},u.ReactBEM.createElement("div",{bem:"e:container e:cell"},u.ReactBEM.createElement(_["default"],{ref:"webcam",onReady:this._onWebcamReady,onBack:this._onCancel}))),u.ReactBEM.createElement("div",{bem:"$b:controls $e:container e:row"},u.ReactBEM.createElement("div",{bem:"e:cell"},u.ReactBEM.createElement("bem",{specifier:"b:webcamScreen"
},u.ReactBEM.createElement("div",{bem:"$e:shutterButton",onClick:this._onShutterClicked,className:!!this.state.webcamReady&&"is-active"},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/webcam/shutter.png",!0)}))))))},e}(d["default"]);e["default"]=g,g.contextTypes=d["default"].contextTypes},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.renderWithBEM=function(){return u.ReactBEM.createElement("bem",{specifier:"$b:topBar"},u.ReactBEM.createElement("div",{bem:"$e:backButton",onClick:this.props.onClick},u.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("top-bar/back.png",!0)}),u.ReactBEM.createElement("div",{bem:"e:label"},this.props.label)))},e}(u.BaseComponent);e["default"]=p,p.contextTypes=u.BaseComponent.contextTypes},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={EVENTS:{RENDER:"render",EXPORT:"export",CLOSE:"close",ZOOM_DONE:"zoom:done",OPERATION_CREATED:"operation:created",OPERATION_UPDATED:"operation:updated",OPERATION_REMOVED:"operation:removed",FEATURES_DISABLED:"editor:features:disabled",FEATURES_ENABLED:"editor:features:enabled",FEATURES_UPDATED:"editor:features:updated",COLORPICKER_OPEN:"colorpicker:open",HISTORY_UPDATED:"history:update",HISTORY_UNDO:"history:undo",WINDOW_RESIZE:"window:resize",CONTROLS_SWITCHED:"controls:switched"},DEFAULTS:{TEXT:"Double-click to edit",CROP_RATIOS:[{name:"custom",ratio:"*",selected:!0},{name:"square",ratio:1},{name:"4-3",ratio:1.33},{name:"16-9",ratio:1.77}],FONTS:[{name:"helvetica",fontFamily:"Helvetica",fontWeight:"normal"},{name:"verdana",fontFamily:"Verdana",fontWeight:"normal"},{name:"timesnewroman",fontFamily:"Times New Roman",fontWeight:"normal"},{name:"impact",fontFamily:"Impact",fontWeight:"normal","default":!0}],STICKER_CATEGORIES:[{name:"glasses",label:"Glasses",stickers:[{name:"glasses-nerd",label:"Nerd glasses",images:{mediaThumb:{uri:"stickers/thumb/glasses-nerd.png",width:100,height:100},mediaBase:{uri:"stickers/base/glasses-nerd.png",width:221,height:91}}},{name:"glasses-normal",label:"Normal glasses",images:{mediaThumb:{uri:"stickers/thumb/glasses-normal.png",width:100,height:100},mediaBase:{uri:"stickers/base/glasses-normal.png",width:249,height:87}}},{name:"glasses-shutter-green",label:"Green shutter glasses",images:{mediaThumb:{uri:"stickers/thumb/glasses-shutter-green.png",width:100,height:100},mediaBase:{uri:"stickers/base/glasses-shutter-green.png",width:235,height:89}}},{name:"glasses-shutter-yellow",label:"Yellow shutter glasses",images:{mediaThumb:{uri:"stickers/thumb/glasses-shutter-yellow.png",width:100,height:100},mediaBase:{uri:"stickers/base/glasses-shutter-yellow.png",width:236,height:89}}},{name:"glasses-sun",label:"Sun glasses",images:{mediaThumb:{uri:"stickers/thumb/glasses-sun.png",width:100,height:100},mediaBase:{uri:"stickers/base/glasses-sun.png",width:250,height:87}}}]},{name:"hats",label:"Hats",stickers:[{name:"hat-cap",label:"Cap",images:{mediaThumb:{uri:"stickers/thumb/hat-cap.png",width:100,height:100},mediaBase:{uri:"stickers/base/hat-cap.png",width:237,height:189}}},{name:"hat-cylinder",label:"Cylinder",images:{mediaThumb:{uri:"stickers/thumb/hat-cylinder.png",width:100,height:100},mediaBase:{uri:"stickers/base/hat-cylinder.png",width:225,height:176}}},{name:"hat-party",label:"Party hat",images:{mediaThumb:{uri:"stickers/thumb/hat-party.png",width:100,height:100},mediaBase:{uri:"stickers/base/hat-party.png",width:140,height:226}}},{name:"hat-sheriff",label:"Sheriff hat",images:{mediaThumb:{uri:"stickers/thumb/hat-sheriff.png",width:100,height:100},mediaBase:{uri:"stickers/base/hat-sheriff.png",width:251,height:129}}}]},{name:"beards",label:"Beards",stickers:[{name:"mustache-long",label:"Long mustache",images:{mediaThumb:{uri:"stickers/thumb/mustache-long.png",width:100,height:100},mediaBase:{uri:"stickers/base/mustache-long.png",width:199,height:182}}},{name:"mustache1",label:"Brown mustache",images:{mediaThumb:{uri:"stickers/thumb/mustache1.png",width:100,height:100},mediaBase:{uri:"stickers/base/mustache1.png",width:238,height:106}}},{name:"mustache2",label:"Black mustache",images:{mediaThumb:{uri:"stickers/thumb/mustache2.png",width:100,height:100},mediaBase:{uri:"stickers/base/mustache2.png",width:250,height:82}}},{name:"mustache3",label:"Brown mustache",images:{mediaThumb:{uri:"stickers/thumb/mustache3.png",width:100,height:100},mediaBase:{uri:"stickers/base/mustache3.png",width:250,height:94}}}]},{name:"misc",label:"Misc",stickers:[{name:"heart",label:"Heart",images:{mediaThumb:{uri:"stickers/thumb/heart.png",width:100,height:100},mediaBase:{uri:"stickers/base/heart.png",width:185,height:174}}},{name:"pipe",label:"Pipe",images:{mediaThumb:{uri:"stickers/thumb/pipe.png",width:100,height:100},mediaBase:{uri:"stickers/base/pipe.png",width:240,height:112}}},{name:"snowflake",label:"Snow flake",images:{mediaThumb:{uri:"stickers/thumb/snowflake.png",width:100,height:100},mediaBase:{uri:"stickers/base/snowflake.png",width:204,height:171}}},{name:"star",label:"Star",images:{mediaThumb:{uri:"stickers/thumb/star.png",width:100,height:100},mediaBase:{uri:"stickers/base/star.png",width:201,height:191}}}]}]}}},function(t,e,o){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e["default"]=t,e}function i(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var r=o(0),a=i(r),s=o(60),l=n(s),c=o(1),u=function(){function t(e,o,n){(0,a["default"])(this,t),this._editor=e,this._sdk=o,this._mediator=n,this._options=this._editor.getOptions(),this._available=c.SDKUtils.extend({},l,this._options.extensions.controls)}return t.prototype.isEnabled=function(t){var e=this.get(t);return e?e.isAvailable&&e.isAvailable(this._editor):(c.Log.info("EditorControls#isEnabled: Unknown control: "+t),!1)},t.prototype.get=function(t){return this._available[t]},t.prototype.getAvailable=function(){return this._available},t}();e["default"]=u},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(1),s=function(){function t(e,o,n){(0,r["default"])(this,t),this._editor=e,this._sdk=o,this._mediator=n,this._options=this._editor.getOptions(),this._features={drag:this._options.editor.enableDrag,zoom:this._options.editor.enableZoom}}return t.prototype.isEnabled=function(t){var e=t.charAt(0).toUpperCase()+t.slice(1),o=this._options.editor["enable"+e];return this._features[t]&&o},t.prototype.enable=function(){for(var t=this,e=arguments.length,o=Array(e),n=0;n<e;n++)o[n]=arguments[n];o.forEach(function(e){t._features[e]=!0}),this._mediator.emit(a.Constants.EVENTS.FEATURES_ENABLED,o),this._mediator.emit(a.Constants.EVENTS.FEATURES_UPDATED,o)},t.prototype.disable=function(){for(var t=this,e=arguments.length,o=Array(e),n=0;n<e;n++)o[n]=arguments[n];o.forEach(function(e){t._features[e]=!1}),this._mediator.emit(a.Constants.EVENTS.FEATURES_DISABLED,o),this._mediator.emit(a.Constants.EVENTS.FEATURES_UPDATED,o)},t}();e["default"]=s},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(o,n,i){(0,r["default"])(this,e);var a=(0,s["default"])(this,t.call(this));return a._editor=o,a._sdk=n,a._mediator=i,a._history=[],a}return(0,c["default"])(e,t),e.prototype.isAvailable=function(){return 0!==this._history.length},e.prototype.add=function(t,e,o){var n=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=void 0;if(t instanceof Array){var a=t;this._history.push(a),a.forEach(function(t){n._mediator.emit(u.Constants.EVENTS.HISTORY_UPDATED,t.operation)}),r=a}else r={operation:t,options:e,existent:o,undo:i},this._history.push(r),this._mediator.emit(u.Constants.EVENTS.HISTORY_UPDATED,t);return r},e.prototype.undo=function(){var t=this,e=this._editor.operations,o=this._history.pop();if(o){var n=[].concat(o);n.forEach(function(o){var n=o.operation,i=o.existent,r=o.options,a=o.undo;i?(n=e.getOrCreate(n.constructor.identifier),n.set(r),t._mediator.emit(u.Constants.EVENTS.OPERATION_UPDATED,n)):e.remove(n),"function"==typeof a&&a(n,r),t._mediator.emit(u.Constants.EVENTS.HISTORY_UPDATED,n),t._mediator.emit(u.Constants.EVENTS.HISTORY_UNDO,n)}),this.emit("undo")}},e.prototype.reset=function(){this._history=[]},e}(u.EventEmitter);e["default"]=p},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(1),s=function(){function t(e,o,n){(0,r["default"])(this,t),this._editor=e,this._sdk=o,this._mediator=n,this._available=this._sdk.getOperations(),this._map={},this._stack=this._sdk.getOperationsStack(),this._preferredOrder=this._editor.getOptions().editor.operationsOrder,this._fixStack()}return t.prototype.exists=function(t){return!!this._map[t]},t.prototype.add=function(t){var e=this,o=t.constructor.identifier;t.on("updated",function(){e._mediator.emit(a.Constants.EVENTS.OPERATION_UPDATED,t)});var n=this._preferredOrder.indexOf(o);if(n===-1)throw new Error("EditorOperations#add: `"+o+"` does not appear in `preferredOperationOrder`");this._stack.set(n,t),this._map[o]=t,this._mediator.emit(a.Constants.EVENTS.OPERATION_CREATED,t)},t.prototype.remove=function(t){var e=t.constructor.identifier,o=this._stack.getStack();this._map[e]===t&&delete this._map[e];var n=o.indexOf(t);if(n!==-1){this._stack.removeAt(n);for(var i=n+1;i<o.length;i++){var r=o[i];r&&r.setDirty(!0)}this._mediator.emit(a.Constants.EVENTS.OPERATION_REMOVED,t)}},t.prototype.get=function(t){return this._map[t]},t.prototype.getOrCreate=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._map[t]){var o=this._map[t];return o}var n=this._available[t],i=new n(this._sdk,e);return this.add(i),i},t.prototype.getStack=function(){return this._stack},t.prototype.reset=function(){this._map={}},t.prototype._fixStack=function(){var t=this,e=this._stack.getStack().slice();this._stack.clear(),e.forEach(function(e){t.add(e)})},t}();e["default"]=s},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=300,d=function(t){function e(o,n,i){(0,r["default"])(this,e);var a=(0,s["default"])(this,t.call(this));return a._editor=o,a._sdk=n,a._mediator=i,a._isDefaultZoom=!1,a._zoom=a._sdk.getZoom(),a._options=a._editor.getOptions(),a._zoomLevels=[1,2,3,4,5,6.25,8.33,12.5,16.66,25,33.33,50,66.66,100,200,300,400,500,600,700,800,1200,1600,3200].map(function(t){return t/100}),a}return(0,c["default"])(e,t),e.prototype.zoomIn=function(){var t=this._getClosestZoomLevel(this._zoom+.001,1);return t?void this.set(t):this._zoomLevels[this._zoomLevels.length-1]},e.prototype.zoomOut=function(){var t=this._getClosestZoomLevel(this._zoom-.001,-1);return t?void this.set(t):this._zoomLevels[0]},e.prototype._getClosestZoomLevel=function(t,e){return e===-1?this._zoomLevels.filter(function(e){return e<t}).pop():1===e?this._zoomLevels.filter(function(e){return e>t})[0]:void 0},e.prototype.undo=function(){this._previousZoom&&(this.set(this._previousZoom),this._previousZoom=null)},e.prototype.set=function(t,e){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this._editor.isReady()){this._previousZoom=this._zoom;var n=t,i=this.getDefault();"auto"===t||n===i?(n=i,t="auto",this._isDefaultZoom=!0):this._isDefaultZoom=!1;var r=Math.max(1,2*i),a=o?this.getMinimum():0;n=Math.max(a,Math.min(r,n)),this._zoom=n,this._sdk.setZoom(this._zoom),this._sdk.setTextureQuality(Math.min(this._zoom,1)),this.emit("set",this._zoom,e)}},e.prototype.getDefault=function(){var t=this._editor.getFinalDimensions(!1),e=this._editor.getCanvasDimensions(),o=u.SDKUtils.resizeVectorToFit(t,e);return o.divide(t).x},e.prototype.getMinimum=function(){var t=this._editor.getFinalDimensions(),e=u.SDKUtils.resizeVectorToFit(t,new u.Vector2(p,p));return e.divide(t).x},e.prototype.isDefault=function(){return this._isDefaultZoom},e.prototype.get=function(){return this._zoom},e}(u.EventEmitter);e["default"]=d},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(1),s=o(183),l=n(s),c=function(){function t(e,o,n){(0,r["default"])(this,t),this._sdk=e,this._options=o,this._download=n}return t.prototype["export"]=function(){var t=this,e=this._getRenderType();return this._sdk["export"](e,this._options.format,this._options.quality).then(function(o){return t._download&&t._downloadData(e,o),o})},t.prototype._downloadData=function(t,e){switch(t){case a.RenderType.DATAURL:l["default"].downloadDataURL(e,this._options.fileBasename);break;case a.RenderType.MSBLOB:l["default"].downloadMSBlob(e,this._options.fileBasename)}},t.prototype._getRenderType=function(){var t=this._options;return t.type===a.RenderType.IMAGE&&this._download?a.Utils.supportsMSBlob()?a.RenderType.MSBLOB:a.RenderType.DATAURL:t.type},t}();e["default"]=c},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(1),s=function(){function t(){(0,r["default"])(this,t)}return t.downloadDataURL=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"photoeditorsdk-export",o=this.createBlobURLFromDataURL(t),n=this.getExtensionFromDataURL(t),i=document.createElement("a");i.download=e+"."+n,i.href=o,document.body.appendChild(i),i.click(),document.body.removeChild(i)},t.downloadMSBlob=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"photoeditorsdk-export";navigator.msSaveBlob(t,e+".png")},t.getExtensionFromDataURL=function(t){var e=t.split(",")[0].split(":")[1].split(";")[0];return e.split("/").pop()},t.createBlobURLFromDataURL=function(t){if(!(window.Blob&&window.URL&&ArrayBuffer&&Uint8Array))return t;for(var e=a.Base64.decode(t.split(",")[1]),o=t.split(",")[0].split(":")[1].split(";")[0],n=new ArrayBuffer(e.length),i=new Uint8Array(n),r=0;r<e.length;r++)i[r]=e[r];var s=new window.Blob([n],{type:o});return window.URL.createObjectURL(s)},t}();e["default"]=s},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=function(t){function e(o){(0,r["default"])(this,e);var n=(0,s["default"])(this,t.call(this));return n._input=o,n._onFileChange=n._onFileChange.bind(n),n._input.addEventListener("change",n._onFileChange),n}return(0,c["default"])(e,t),e.prototype.open=function(){this._input.value=null,this._input.click()},e.prototype._handleFile=function(t){var e=this,o=new window.FileReader;o.onload=function(){return function(t){var o=t.target.result,n=new window.Image;n.addEventListener("load",function(){e.emit("file",n)}),n.src=o}}(t),o.readAsDataURL(t)},e.prototype._onFileChange=function(){var t=this._input.files;t.length&&this._handleFile(t[0])},e.prototype.dispose=function(){this._input.removeEventListener("change",this._onFileChange)},e}(u.EventEmitter);e["default"]=p},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(187),s=n(a),l=function(){function t(e){(0,r["default"])(this,t),this._fonts=e}return t.prototype.needsToLoad=function(){for(var t=0;t<this._fonts.length;t++){var e=this._fonts[t].getProvider();if(e)return!0}},t.prototype.load=function(){var t={google:new s["default"]};this._fonts.forEach(function(e){var o=e.getProvider();if(o){var n=t[o];n.add(e)}});var e=[];for(var o in t)e.push(t[o].load());return Promise.all(e)},t}();e["default"]=l},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=function(){function t(){(0,r["default"])(this,t),this._fonts=[]}return t.prototype.add=function(t){this._fonts.push(t)},t.prototype.load=function(){},t}();e["default"]=a},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(186),p=n(u),d=o(188),h=n(d),f="undefined"!=typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):o(89),m={italic:"i"},_=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.load=function(){return 0===this._fonts.length?Promise.resolve():(this._defaultFontRuler=new h["default"],this._customFontRuler=new h["default"],this._addStylesheetTag(),this._customFontRuler.setFont(this._fonts[0]),this._waitForLoadPromise())},e.prototype._waitForLoadPromise=function(t){var e=this;return this._startedAt=f(),new Promise(function(t,o){e._waitForLoad(function(e){return e?o(e):void t()})})},e.prototype._waitForLoad=function(t){var e=this,o=function n(){var o=e._checkWidthChanged();return o?(e.dispose(),t()):f()-e._startedAt>=5e3?(e.dispose(),t(new Error("Font loading timed out."))):void setTimeout(n,50)};o()},e.prototype._checkWidthChanged=function(){return this._defaultFontRuler.getWidth()!==this._customFontRuler.getWidth()},e.prototype._addStylesheetTag=function(){var t=this._getFamiliesString(),e=document.createElement("link");e.rel="stylesheet",e.href="https://fonts.googleapis.com/css?family="+t;var o=document.getElementsByTagName("head")[0];o.appendChild(e)},e.prototype._getFamiliesString=function(){var t={};this._fonts.forEach(function(e){var o=e.getFontFamily(),n=e.getFontStyle(),i=e.getFontWeight();t[o]=t[o]||[],"undefined"!=typeof i?t[o].push(""+i+(m[n]||"")):t[o].push(400)});var e=[];for(var o in t){var n=t[o],i=n.length?":"+n.join(","):"",r=o.replace(" ","+")+i;e.push(r)}return e.join("|")},e.prototype.dispose=function(){this._defaultFontRuler&&this._defaultFontRuler.dispose(),this._customFontRuler&&this._customFontRuler.dispose()},e}(p["default"]);e["default"]=_},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(69),s=n(a),l=30,c="abcdefghijklmnopqrstuvwxzy",u=function(){function t(){(0,r["default"])(this,t),this._font=new s["default"]({fontFamily:"Times New Roman",fontWeight:"normal",fontStyle:"normal"}),this._createRuler()}return t.prototype._createRuler=function(){this._ruler=document.createElement("div"),this._ruler.innerText=c,document.body.appendChild(this._ruler),this._setRulerStyle()},t.prototype._setRulerStyle=function(){this._ruler.style.cssText="\n      position: absolute;\n      top: -9999;\n      left: -9999;\n      display: inline-block;\n      font: "+this._font.getFontStyle()+" "+this._font.getFontWeight()+" "+l+"px "+this._font.getFontFamily()+";\n    "},t.prototype.setFont=function(t){this._font=t,this._setRulerStyle()},t.prototype.getWidth=function(){return this._ruler.offsetWidth},t.prototype.dispose=function(){this._ruler.parentNode.removeChild(this._ruler)},t}();e["default"]=u},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(1),s=function(){function t(e,o,n){(0,r["default"])(this,t),this._image=e,this._maxPixels=o,this._maxDimensions=n}return t.prototype.needsResize=function(){var t=new a.Vector2(this._image.width,this._image.height),e=t.x*t.y,o=e>this._maxPixels,n=null!==this._maxDimensions&&(t.x>this._maxDimensions||t.y>this._maxDimensions);return o||n},t.prototype.resize=function(){var t=this,e=null,o=null,n=this._maxDimensions;return new a.Promise(function(i,r){window.setTimeout(function(){var r=new a.Vector2(t._image.width,t._image.height),s=r.clone();if(s.x*s.y>t._maxPixels&&(s.copy(t._getDimensionsByMaxPixels()),e="maxMegaPixels"),null!==n&&(s.x>n||s.y>n)){var l=Math.min(n/s.x,n/s.y);s.multiply(l),e="maxDimensions"}s.floor(),o=t._createResizedImageCanvas(s),i({canvas:o,dimensions:s,reason:e})},1e3)})},t.prototype._createResizedImageCanvas=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,o=this._image,n=document.createElement("canvas");n.width=t.x,n.height=t.y;var i=t.clone().subtract(e).divide(2),r=n.getContext("2d");return r.drawImage(o,0,0,o.width,o.height,i.x,i.y,e.x,e.y),n},t.prototype._getDimensionsByMaxPixels=function(){var t=this._image,e=this._maxPixels,o=t.width/t.height,n=t.height/t.width;return new a.Vector2(Math.sqrt(e*o),Math.sqrt(e*n)).floor()},t}();e["default"]=s},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(1),s=o(69),l=n(s),c=function(){function t(e){(0,r["default"])(this,t),this._options=e,this._fonts=[],this._initFonts()}return t.prototype._initFonts=function(){var t=this._options,e=t.additionalFonts,o=t.replaceFonts,n=t.selectableFonts;e=e||[];var i=a.Constants.DEFAULTS.FONTS;i=o?e:i.concat(e),n&&n.length&&(i=a.Utils.select(i,n,function(t){return t.name})),i=i.map(function(t){return new l["default"](t)});var r=null;i.forEach(function(t){!r&&t["default"]&&(r=t)}),r||(r=i[0]),this._defaultFont=r,this._fonts=i},t.prototype.getFonts=function(){return this._fonts},t.prototype.getDefaultFont=function(){return this._defaultFont},t}();e["default"]=c},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=function s(t){(0,r["default"])(this,s),this.name=t.name,this.coverImage=t.coverImage};e["default"]=a},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=function s(t,e){(0,r["default"])(this,s),this.library=t,this.title=e.title,this.urls=e.urls};e["default"]=a},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(1),s=function(){function t(){(0,r["default"])(this,t)}return t.prototype.getLibraries=function(){return a.Log.warn(this.constructor.name,"`getLibraries` is abstract and not implemented."),a.Promise.resolve([])},t.prototype.getSearchSuggestions=function(){return a.Log.warn(this.constructor.name,"`getSearchSuggestions` is abstract and not implemented."),a.Promise.resolve([])},t.prototype.getPhotosForLibrary=function(t){return a.Log.warn(this.constructor.name,"`getPhotosForLibrary` is abstract and not implemented."),a.Promise.resolve([])},t.prototype.searchPhotos=function(t){return a.Log.warn(this.constructor.name,"`searchPhotos` is abstract and not implemented."),a.Promise.resolve([])},t}();e["default"]=s},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=function s(t){(0,r["default"])(this,s),this.query=t.query,this.name=this.query,this.coverImage=t.coverImage};e["default"]=a},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(68),d=n(p),h=5e3,f=function(t){function e(o,n,i){(0,r["default"])(this,e);var a=(0,s["default"])(this,t.call(this));return a._ui=o,a._options=n,a._mediator=i,a._editor=new d["default"](o,n,i,(!0)),a._assets=["controls/back.png","controls/minus.png","controls/plus.png","controls/tick.png","controls/webcam/shutter.png","controls/knobs/remove.png","controls/knobs/resize-diagonal-down.png","controls/knobs/resize-diagonal-up.png","controls/knobs/rotate.png","editor/export.png","editor/new.png","editor/undo.png","splash/photo-roll.png","splash/webcam.png","top-bar/back.png","close.png"],a._appendControlsAssets(),a}return(0,c["default"])(e,t),e.prototype._appendControlsAssets=function(){var t=this._editor.controls.getAvailable();for(var e in t){var o=t[e];this._editor.controls.isEnabled(e)&&(this._assets=this._assets.concat(o.getPreloadAssets(this._editor)),this._assets.push(o.iconPath))}},e.prototype.load=function(){var t=this,e=this._assets.slice(),o=e.length,n=0,i=function(){n++,t.emit("progress",n/o),n===o&&t.emit("done")},r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"timed out";u.Log.warn("Preloader",t+" "+e+"."),i()},a=function(t){return window.setTimeout(function(){r(t)},h)};e.forEach(function(e){var o=t._ui.getAssetPath(e,!0),n=new window.Image,s=a(o);n.addEventListener("load",function(){window.clearTimeout(s),i()}),n.addEventListener("error",function(){window.clearTimeout(s),r(o,"was not found")}),n.src=o})},e}(u.EventEmitter);e["default"]=f},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(73),s=n(a),l=o(72),c=n(l),u=function(){function t(e){(0,r["default"])(this,t),this._editor=e}return t.prototype.serialize=function(){var t=new s["default"](this._editor);return t.serialize.apply(t,arguments)},t.prototype.deserialize=function(t){var e=new c["default"](this._editor,t);return e.deserialize()},t}();e["default"]=u,u.version="1.0.0"},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(72),d=n(p),h=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype._validateVersion=function(){return"1.0.1"!==this._data.version?Promise.reject(new Error("Invalid version "+this._data.version+", expected 1.0.1")):Promise.resolve()},e.prototype._deserializeOperations=function(){var t=this,e=this._data.operations.map(function(e){switch(e.type){case"crop":return t._deserializeCropOperation(e);case"orientation":return t._deserializeOrientationOperation(e);case"filter":return t._deserializeFilterOperation(e);case"adjustments":return t._deserializeAdjustmentsOperation(e);case"sprite":return t._deserializeSpriteOperation(e);case"focus":return t._deserializeFocusOperation(e);case"border":return t._deserializeBorderOperation(e);case"selective-blur":return t._deserializeSelectiveBlurOperation(e)}});return Promise.all(e)},e.prototype._deserializeSelectiveBlurOperation=function(t){var e=t.options,o=e.blurRadius,n=e.paths,i=this._editor.operations.getOrCreate("selective-blur",{blurRadius:o});return n.forEach(function(t){var e=t.size,o=t.points,n=i.createPath(e);o.forEach(function(t){n.addControlPoint(u.Vector2.fromObject(t))})}),Promise.resolve()},e.prototype._deserializeCropOperation=function(t){var e=t.options,o=e.scale,n=e.rotation,i=u.Vector2.fromObject(e.start),r=u.Vector2.fromObject(e.end),a=e.dimensions?u.Vector2.fromObject(e.dimensions):null;return n>Math.PI&&(n-=2*Math.PI),this._editor.operations.getOrCreate("crop",{start:i,end:r,scale:o,rotation:n,dimensions:a}),Promise.resolve()},e}(d["default"]);e["default"]=h},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(199),s=n(a),l=o(197),c=n(l),u=function(){function t(e){(0,r["default"])(this,t),this._editor=e}return t.prototype.serialize=function(){var t=new s["default"](this._editor);return t.serialize.apply(t,arguments)},t.prototype.deserialize=function(t){var e=new c["default"](this._editor,t);return e.deserialize()},t}();e["default"]=u,u.version="1.0.1"},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(0),r=n(i),a=o(3),s=n(a),l=o(2),c=n(l),u=o(1),p=o(73),d=n(p),h=2*Math.PI,f=function(t){function e(){return(0,r["default"])(this,e),(0,s["default"])(this,t.apply(this,arguments))}return(0,c["default"])(e,t),e.prototype.serialize=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._options=u.SDKUtils.defaults(t,{image:!0});var e={version:"1.0.1"};return this._serializeInputImage(e).then(this._serializeOperations)},e.prototype._serializeOperation=function(t){switch(t.constructor.identifier){case"crop":return this._serializeCropOperation(t);case"orientation":return this._serializeOrientationOperation(t);case"filter":return this._serializeFilterOperation(t);case"adjustments":return this._serializeAdjustmentsOperation(t);case"sprite":return this._serializeSpriteOperation(t);case"radial-focus":return this._serializeRadialFocusOperation(t);case"linear-focus":return this._serializeLinearFocusOperation(t);case"border":return this._serializeBorderOperation(t);case"selective-blur":return this._serializeSelectiveBlurOperation(t);default:throw new Error("Unable to serialize operation of type "+t.constructor.identifier)}},e.prototype._serializeCropOperation=function(t){var e=t.serializeOptions(["start","end","rotation","scale","dimensions"],!0);return e.rotation=(e.rotation+h)%h,null===e.dimensions&&delete e.dimensions,{type:"crop",options:e}},e.prototype._serializeSelectiveBlurOperation=function(t){var e=this,o=t.getPaths().map(function(t){return e._serializePath(t)}),n=t.getBlurRadius();return{type:"selective-blur",options:{paths:o,blurRadius:n}}},e}(d["default"]);e["default"]=f},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(32),r=n(i),a=o(0),s=n(a),l=o(3),c=n(l),u=o(2),p=n(u),d=o(36),h=n(d),f=h["default"].EventEmitter,m=h["default"].Utils,_=function(t){function e(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,s["default"])(this,e);var n=(0,c["default"])(this,t.call(this));return n._state=o,n}return(0,p["default"])(e,t),e.prototype.set=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];"object"!==("undefined"==typeof t?"undefined":(0,r["default"])(t))&&console&&console.trace("SharedState#set expects an object as first parameter");var o=m.extend({},this._state);this._state=m.extend(this._state,t),e&&this.broadcastUpdate(o,this._state)},e.prototype.get=function(t){return this._state[t]},e.prototype.broadcastUpdate=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.emit("update",t,e)},e.prototype.clear=function(){this._state={}},e}(f);e["default"]=_},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=o(36),r=n(i),a=o(74),s=n(a),l=o(202),c=n(l),u=o(61),p=n(u),d=r["default"].Math.Vector2,h={getInnerDimensionsForElement:function(t){var e=new d(t.offsetWidth,t.offsetHeight),o=window.getComputedStyle(t,null);return e.x-=parseInt(o.getPropertyValue("padding-left"),10),e.x-=parseInt(o.getPropertyValue("padding-right"),10),e.y-=parseInt(o.getPropertyValue("padding-top"),10),e.y-=parseInt(o.getPropertyValue("padding-bottom"),10),e},getEventPosition:function(t){var e=t.clientX,o=t.clientY;if(t.type.indexOf("touch")!==-1){if(!t.touches.length)return;e=t.touches[0].clientX,o=t.touches[0].clientY}return new d(e,o)},createTransparentPatternCanvas:function(){var t=document.createElement("canvas"),e=t.getContext("2d");return t.width=10,t.height=10,e.fillStyle="white",e.fillRect(0,0,t.width,t.height),e.fillStyle="#cccccc",e.fillRect(0,0,t.width/2,t.height/2),e.fillRect(t.width/2,t.height/2,t.width,t.height),t},supportsMSBlob:function(){var t=document.createElement("canvas");return"undefined"!=typeof t.msToBlob;
},translate:function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this.fetch(t,e);if(!n)return s["default"].warn("Utils#translate","Unable to translate `"+e+"`"),e;for(var i in o)n=n.replace("${"+i+"}",o[i]);return n},fetch:function(t,e,o){e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,"");for(var n=e.split("."),i=0;i<n.length;i++){var r=n[i];if(t=t[r],!t)break}return"undefined"!=typeof t&&t},isMobile:function(){var t=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))},select:function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o||(o=function(t){return t});var n=[];return e.forEach(function(e){t.forEach(function(t){var i=o(t);i===e&&n.push(t)})}),n},getJSONP:function(t){var e=new p["default"](t);return e.load()},mergeCategories:function(t,e,o){t=t.slice(0);var n=null;return e.forEach(function(e){t.forEach(function(t){e.name===t.name&&(n=t)}),n?n[o]=n[o].concat(e[o]):t.push(e)}),t},getStyleObject:function(t){var e=window.getComputedStyle(t),o={};for(var n in e){var i=e.getPropertyValue(n),r=n.replace(/\-([a-z])/g,function(t,e){return e.toUpperCase()});""!==i&&(o[r]=i)}return o},debounce:function(t,e,o){var n;return function(){var i=this,r=arguments,a=function(){n=null,o||t.apply(i,r)},s=o&&!n;clearTimeout(n),n=setTimeout(a,e),s&&t.apply(this,r)}},Browser:c["default"]};e["default"]=h},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={getIEVersion:function(){var t=navigator,e=t.userAgent,o=t.appVersion;return o.indexOf("MSIE")!==-1?o.match(/MSIE\s+?([0-9]+)/i)[1]:e.indexOf("Trident")!==-1&&e.match(/rv:([0-9]+)/i)[1]},isIE10:function(){var t=this.getIEVersion();return t!==!1&&10===t},isIE11:function(){var t=this.getIEVersion();return t!==!1&&11===t},isIElte:function(t){var e=this.getIEVersion();return e!==!1&&e<=t}}},function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});for(var o="undefined"==typeof window?t:window,n=o.requestAnimationFrame,i=o.cancelAnimationFrame,r=0,a=["ms","moz","webkit","o"],s=0;s<a.length&&!n;++s)e.requestAnimationFrame=n=o[a[s]+"RequestAnimationFrame"],e.cancelAnimationFrame=i=o[a[s]+"CancelAnimationFrame"]||o[a[s]+"CancelRequestAnimationFrame"];n||(e.requestAnimationFrame=n=function(t,e){var o=(new Date).getTime(),n=Math.max(0,16-(o-r)),i=setTimeout(function(){t(o+n)},n);return r=o+n,i}),i||(e.cancelAnimationFrame=i=function(t){clearTimeout(t)}),e.requestAnimationFrame=n,e.cancelAnimationFrame=i}).call(e,o(91))},function(t,e,o){t.exports={"default":o(214),__esModule:!0}},function(t,e,o){t.exports={"default":o(215),__esModule:!0}},function(t,e,o){t.exports={"default":o(216),__esModule:!0}},function(t,e,o){t.exports={"default":o(217),__esModule:!0}},function(t,e,o){t.exports={"default":o(218),__esModule:!0}},function(t,e,o){t.exports={"default":o(220),__esModule:!0}},function(t,e,o){t.exports={"default":o(221),__esModule:!0}},function(t,e,o){t.exports={"default":o(222),__esModule:!0}},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var i=o(206),r=n(i),a=o(205),s=n(a);e["default"]=function(){function t(t,e){var o=[],n=!0,i=!1,r=void 0;try{for(var a,l=(0,s["default"])(t);!(n=(a=l.next()).done)&&(o.push(a.value),!e||o.length!==e);n=!0);}catch(c){i=!0,r=c}finally{try{!n&&l["return"]&&l["return"]()}finally{if(i)throw r}}return o}return function(e,o){if(Array.isArray(e))return e;if((0,r["default"])(Object(e)))return t(e,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}e.__esModule=!0;var i=o(204),r=n(i);e["default"]=function(t){if(Array.isArray(t)){for(var e=0,o=Array(t.length);e<t.length;e++)o[e]=t[e];return o}return(0,r["default"])(t)}},function(t,e,o){o(35),o(246),t.exports=o(8).Array.from},function(t,e,o){o(58),o(35),t.exports=o(244)},function(t,e,o){o(58),o(35),t.exports=o(245)},function(t,e,o){o(248),t.exports=o(8).Object.assign},function(t,e,o){o(249);var n=o(8).Object;t.exports=function(t,e){return n.create(t,e)}},function(t,e,o){o(250);var n=o(8).Object;t.exports=function(t,e,o){return n.defineProperty(t,e,o)}},function(t,e,o){o(251),t.exports=o(8).Object.setPrototypeOf},function(t,e,o){o(253),o(252),o(254),o(255),t.exports=o(8).Symbol},function(t,e,o){o(35),o(58),t.exports=o(57).f("iterator")},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e){t.exports=function(){}},function(t,e,o){var n=o(19),i=o(87),r=o(243);t.exports=function(t){return function(e,o,a){var s,l=n(e),c=i(l.length),u=r(a,c);if(t&&o!=o){for(;c>u;)if(s=l[u++],s!=s)return!0}else for(;c>u;u++)if((t||u in l)&&l[u]===o)return t||u||0;return!t&&-1}}},function(t,e,o){"use strict";var n=o(13),i=o(29);t.exports=function(t,e,o){e in t?n.f(t,e,i(0,o)):t[e]=o}},function(t,e,o){var n=o(28),i=o(49),r=o(33);t.exports=function(t){var e=n(t),o=i.f;if(o)for(var a,s=o(t),l=r.f,c=0;s.length>c;)l.call(t,a=s[c++])&&e.push(a);return e}},function(t,e,o){t.exports=o(12).document&&document.documentElement},function(t,e,o){var n=o(23),i=o(9)("iterator"),r=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||r[i]===t)}},function(t,e,o){var n=o(43);t.exports=Array.isArray||function(t){return"Array"==n(t)}},function(t,e,o){var n=o(15);t.exports=function(t,e,o,i){try{return i?e(n(o)[0],o[1]):e(o)}catch(r){var a=t["return"];throw void 0!==a&&n(a.call(t)),r}}},function(t,e,o){"use strict";var n=o(48),i=o(29),r=o(50),a={};o(22)(a,o(9)("iterator"),function(){return this}),t.exports=function(t,e,o){t.prototype=n(a,{next:i(1,o)}),r(t,e+" Iterator")}},function(t,e,o){var n=o(9)("iterator"),i=!1;try{var r=[7][n]();r["return"]=function(){i=!0},Array.from(r,function(){throw 2})}catch(a){}t.exports=function(t,e){if(!e&&!i)return!1;var o=!1;try{var r=[7],a=r[n]();a.next=function(){return{done:o=!0}},r[n]=function(){return a},t(r)}catch(s){}return o}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,o){var n=o(28),i=o(19);t.exports=function(t,e){for(var o,r=i(t),a=n(r),s=a.length,l=0;s>l;)if(r[o=a[l++]]===e)return o}},function(t,e,o){var n=o(34)("meta"),i=o(27),r=o(18),a=o(13).f,s=0,l=Object.isExtensible||function(){return!0},c=!o(26)(function(){return l(Object.preventExtensions({}))}),u=function(t){a(t,n,{value:{i:"O"+ ++s,w:{}}})},p=function(t,e){if(!i(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!r(t,n)){if(!l(t))return"F";if(!e)return"E";u(t)}return t[n].i},d=function(t,e){if(!r(t,n)){if(!l(t))return!0;if(!e)return!1;u(t)}return t[n].w},h=function(t){return c&&f.NEED&&l(t)&&!r(t,n)&&u(t),t},f=t.exports={KEY:n,NEED:!1,fastKey:p,getWeak:d,onFreeze:h}},function(t,e,o){"use strict";var n=o(28),i=o(49),r=o(33),a=o(54),s=o(81),l=Object.assign;t.exports=!l||o(26)(function(){var t={},e={},o=Symbol(),n="abcdefghijklmnopqrst";return t[o]=7,n.split("").forEach(function(t){e[t]=t}),7!=l({},t)[o]||Object.keys(l({},e)).join("")!=n})?function(t,e){for(var o=a(t),l=arguments.length,c=1,u=i.f,p=r.f;l>c;)for(var d,h=s(arguments[c++]),f=u?n(h).concat(u(h)):n(h),m=f.length,_=0;m>_;)p.call(h,d=f[_++])&&(o[d]=h[d]);return o}:l},function(t,e,o){var n=o(13),i=o(15),r=o(28);t.exports=o(16)?Object.defineProperties:function(t,e){i(t);for(var o,a=r(e),s=a.length,l=0;s>l;)n.f(t,o=a[l++],e[o]);return t}},function(t,e,o){var n=o(19),i=o(84).f,r={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return i(t)}catch(e){return a.slice()}};t.exports.f=function(t){return a&&"[object Window]"==r.call(t)?s(t):i(n(t))}},function(t,e,o){var n=o(18),i=o(54),r=o(51)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),n(t,r)?t[r]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,o){var n=o(27),i=o(15),r=function(t,e){if(i(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{n=o(44)(Function.call,o(83).f(Object.prototype,"__proto__").set,2),n(t,[]),e=!(t instanceof Array)}catch(i){e=!0}return function(t,o){return r(t,o),e?t.__proto__=o:n(t,o),t}}({},!1):void 0),check:r}},function(t,e,o){var n=o(53),i=o(45);t.exports=function(t){return function(e,o){var r,a,s=String(i(e)),l=n(o),c=s.length;return l<0||l>=c?t?"":void 0:(r=s.charCodeAt(l),r<55296||r>56319||l+1===c||(a=s.charCodeAt(l+1))<56320||a>57343?t?s.charAt(l):r:t?s.slice(l,l+2):(r-55296<<10)+(a-56320)+65536)}}},function(t,e,o){var n=o(53),i=Math.max,r=Math.min;t.exports=function(t,e){return t=n(t),t<0?i(t+e,0):r(t,e)}},function(t,e,o){var n=o(15),i=o(88);t.exports=o(8).getIterator=function(t){var e=i(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return n(e.call(t))}},function(t,e,o){var n=o(78),i=o(9)("iterator"),r=o(23);t.exports=o(8).isIterable=function(t){var e=Object(t);return void 0!==e[i]||"@@iterator"in e||r.hasOwnProperty(n(e))}},function(t,e,o){"use strict";var n=o(44),i=o(17),r=o(54),a=o(231),s=o(229),l=o(87),c=o(226),u=o(88);i(i.S+i.F*!o(233)(function(t){Array.from(t)}),"Array",{from:function(t){var e,o,i,p,d=r(t),h="function"==typeof this?this:Array,f=arguments.length,m=f>1?arguments[1]:void 0,_=void 0!==m,g=0,v=u(d);if(_&&(m=n(m,f>2?arguments[2]:void 0,2)),void 0==v||h==Array&&s(v))for(e=l(d.length),o=new h(e);e>g;g++)c(o,g,_?m(d[g],g):d[g]);else for(p=v.call(d),o=new h;!(i=p.next()).done;g++)c(o,g,_?a(p,m,[i.value,g],!0):i.value);return o.length=g,o}})},function(t,e,o){"use strict";var n=o(224),i=o(234),r=o(23),a=o(19);t.exports=o(82)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,o=this._i++;return!t||o>=t.length?(this._t=void 0,i(1)):"keys"==e?i(0,o):"values"==e?i(0,t[o]):i(0,[o,t[o]])},"values"),r.Arguments=r.Array,n("keys"),n("values"),n("entries")},function(t,e,o){var n=o(17);n(n.S+n.F,"Object",{assign:o(237)})},function(t,e,o){var n=o(17);n(n.S,"Object",{create:o(48)})},function(t,e,o){var n=o(17);n(n.S+n.F*!o(16),"Object",{defineProperty:o(13).f})},function(t,e,o){var n=o(17);n(n.S,"Object",{setPrototypeOf:o(241).set})},function(t,e){},function(t,e,o){"use strict";var n=o(12),i=o(18),r=o(16),a=o(17),s=o(86),l=o(236).KEY,c=o(26),u=o(52),p=o(50),d=o(34),h=o(9),f=o(57),m=o(56),_=o(235),g=o(227),v=o(230),y=o(15),b=o(19),E=o(55),S=o(29),M=o(48),C=o(239),B=o(83),R=o(13),x=o(28),w=B.f,k=R.f,O=C.f,D=n.Symbol,P=n.JSON,T=P&&P.stringify,A="prototype",F=h("_hidden"),z=h("toPrimitive"),I={}.propertyIsEnumerable,j=u("symbol-registry"),U=u("symbols"),V=u("op-symbols"),L=Object[A],W="function"==typeof D,K=n.QObject,N=!K||!K[A]||!K[A].findChild,$=r&&c(function(){return 7!=M(k({},"a",{get:function(){return k(this,"a",{value:7}).a}})).a})?function(t,e,o){var n=w(L,e);n&&delete L[e],k(t,e,o),n&&t!==L&&k(L,e,n)}:k,H=function(t){var e=U[t]=M(D[A]);return e._k=t,e},q=W&&"symbol"==typeof D.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof D},Z=function(t,e,o){return t===L&&Z(V,e,o),y(t),e=E(e,!0),y(o),i(U,e)?(o.enumerable?(i(t,F)&&t[F][e]&&(t[F][e]=!1),o=M(o,{enumerable:S(0,!1)})):(i(t,F)||k(t,F,S(1,{})),t[F][e]=!0),$(t,e,o)):k(t,e,o)},G=function(t,e){y(t);for(var o,n=g(e=b(e)),i=0,r=n.length;r>i;)Z(t,o=n[i++],e[o]);return t},J=function(t,e){return void 0===e?M(t):G(M(t),e)},Q=function(t){var e=I.call(this,t=E(t,!0));return!(this===L&&i(U,t)&&!i(V,t))&&(!(e||!i(this,t)||!i(U,t)||i(this,F)&&this[F][t])||e)},X=function(t,e){if(t=b(t),e=E(e,!0),t!==L||!i(U,e)||i(V,e)){var o=w(t,e);return!o||!i(U,e)||i(t,F)&&t[F][e]||(o.enumerable=!0),o}},Y=function(t){for(var e,o=O(b(t)),n=[],r=0;o.length>r;)i(U,e=o[r++])||e==F||e==l||n.push(e);return n},tt=function(t){for(var e,o=t===L,n=O(o?V:b(t)),r=[],a=0;n.length>a;)!i(U,e=n[a++])||o&&!i(L,e)||r.push(U[e]);return r};W||(D=function(){if(this instanceof D)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(o){this===L&&e.call(V,o),i(this,F)&&i(this[F],t)&&(this[F][t]=!1),$(this,t,S(1,o))};return r&&N&&$(L,t,{configurable:!0,set:e}),H(t)},s(D[A],"toString",function(){return this._k}),B.f=X,R.f=Z,o(84).f=C.f=Y,o(33).f=Q,o(49).f=tt,r&&!o(47)&&s(L,"propertyIsEnumerable",Q,!0),f.f=function(t){return H(h(t))}),a(a.G+a.W+a.F*!W,{Symbol:D});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ot=0;et.length>ot;)h(et[ot++]);for(var et=x(h.store),ot=0;et.length>ot;)m(et[ot++]);a(a.S+a.F*!W,"Symbol",{"for":function(t){return i(j,t+="")?j[t]:j[t]=D(t)},keyFor:function(t){if(q(t))return _(j,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){N=!0},useSimple:function(){N=!1}}),a(a.S+a.F*!W,"Object",{create:J,defineProperty:Z,defineProperties:G,getOwnPropertyDescriptor:X,getOwnPropertyNames:Y,getOwnPropertySymbols:tt}),P&&a(a.S+a.F*(!W||c(function(){var t=D();return"[null]"!=T([t])||"{}"!=T({a:t})||"{}"!=T(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!q(t)){for(var e,o,n=[t],i=1;arguments.length>i;)n.push(arguments[i++]);return e=n[1],"function"==typeof e&&(o=e),!o&&v(e)||(e=function(t,e){if(o&&(e=o.call(this,t,e)),!q(e))return e}),n[1]=e,T.apply(P,n)}}}),D[A][z]||o(22)(D[A],z,D[A].valueOf),p(D,"Symbol"),p(Math,"Math",!0),p(n.JSON,"JSON",!0)},function(t,e,o){o(56)("asyncIterator")},function(t,e,o){o(56)("observable")},function(t,e,o){(function(t,n){var i;!function(r){function a(t){throw new RangeError(P[t])}function s(t,e){for(var o=t.length,n=[];o--;)n[o]=e(t[o]);return n}function l(t,e){var o=t.split("@"),n="";o.length>1&&(n=o[0]+"@",t=o[1]),t=t.replace(D,".");var i=t.split("."),r=s(i,e).join(".");return n+r}function c(t){for(var e,o,n=[],i=0,r=t.length;i<r;)e=t.charCodeAt(i++),e>=55296&&e<=56319&&i<r?(o=t.charCodeAt(i++),56320==(64512&o)?n.push(((1023&e)<<10)+(1023&o)+65536):(n.push(e),i--)):n.push(e);return n}function u(t){return s(t,function(t){var e="";return t>65535&&(t-=65536,e+=F(t>>>10&1023|55296),t=56320|1023&t),e+=F(t)}).join("")}function p(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:E}function d(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function h(t,e,o){var n=0;for(t=o?A(t/B):t>>1,t+=A(t/e);t>T*M>>1;n+=E)t=A(t/T);return A(n+(T+1)*t/(t+C))}function f(t){var e,o,n,i,r,s,l,c,d,f,m=[],_=t.length,g=0,v=x,y=R;for(o=t.lastIndexOf(w),o<0&&(o=0),n=0;n<o;++n)t.charCodeAt(n)>=128&&a("not-basic"),m.push(t.charCodeAt(n));for(i=o>0?o+1:0;i<_;){for(r=g,s=1,l=E;i>=_&&a("invalid-input"),c=p(t.charCodeAt(i++)),(c>=E||c>A((b-g)/s))&&a("overflow"),g+=c*s,d=l<=y?S:l>=y+M?M:l-y,!(c<d);l+=E)f=E-d,s>A(b/f)&&a("overflow"),s*=f;e=m.length+1,y=h(g-r,e,0==r),A(g/e)>b-v&&a("overflow"),v+=A(g/e),g%=e,m.splice(g++,0,v)}return u(m)}function m(t){var e,o,n,i,r,s,l,u,p,f,m,_,g,v,y,C=[];for(t=c(t),_=t.length,e=x,o=0,r=R,s=0;s<_;++s)m=t[s],m<128&&C.push(F(m));for(n=i=C.length,i&&C.push(w);n<_;){for(l=b,s=0;s<_;++s)m=t[s],m>=e&&m<l&&(l=m);for(g=n+1,l-e>A((b-o)/g)&&a("overflow"),o+=(l-e)*g,e=l,s=0;s<_;++s)if(m=t[s],m<e&&++o>b&&a("overflow"),m==e){for(u=o,p=E;f=p<=r?S:p>=r+M?M:p-r,!(u<f);p+=E)y=u-f,v=E-f,C.push(F(d(f+y%v,0))),u=A(y/v);C.push(F(d(u,0))),r=h(o,g,n==i),o=0,++n}++o,++e}return C.join("")}function _(t){return l(t,function(t){return k.test(t)?f(t.slice(4).toLowerCase()):t})}function g(t){return l(t,function(t){return O.test(t)?"xn--"+m(t):t})}var v=("object"==typeof e&&e&&!e.nodeType&&e,"object"==typeof t&&t&&!t.nodeType&&t,"object"==typeof n&&n);v.global!==v&&v.window!==v&&v.self!==v||(r=v);var y,b=2147483647,E=36,S=1,M=26,C=38,B=700,R=72,x=128,w="-",k=/^xn--/,O=/[^\x20-\x7E]/,D=/[\x2E\u3002\uFF0E\uFF61]/g,P={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},T=E-S,A=Math.floor,F=String.fromCharCode;y={version:"1.4.1",ucs2:{decode:c,encode:u},decode:f,encode:m,toASCII:g,toUnicode:_},i=function(){return y}.call(e,o,e,t),!(void 0!==i&&(t.exports=i))}(this)}).call(e,o(262)(t),o(91))},function(t,e){"use strict";function o(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,i,r){e=e||"&",i=i||"=";var a={};if("string"!=typeof t||0===t.length)return a;var s=/\+/g;t=t.split(e);var l=1e3;r&&"number"==typeof r.maxKeys&&(l=r.maxKeys);var c=t.length;l>0&&c>l&&(c=l);for(var u=0;u<c;++u){var p,d,h,f,m=t[u].replace(s,"%20"),_=m.indexOf(i);_>=0?(p=m.substr(0,_),d=m.substr(_+1)):(p=m,d=""),h=decodeURIComponent(p),f=decodeURIComponent(d),o(a,h)?n(a[h])?a[h].push(f):a[h]=[a[h],f]:a[h]=f}return a};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e){"use strict";function o(t,e){if(t.map)return t.map(e);for(var o=[],n=0;n<t.length;n++)o.push(e(t[n],n));return o}var n=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,a,s){return e=e||"&",a=a||"=",null===t&&(t=void 0),"object"==typeof t?o(r(t),function(r){var s=encodeURIComponent(n(r))+a;return i(t[r])?o(t[r],function(t){return s+encodeURIComponent(n(t))}).join(e):s+encodeURIComponent(n(t[r]))}).join(e):s?encodeURIComponent(n(s))+a+encodeURIComponent(n(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},r=Object.keys||function(t){var e=[];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.push(o);return e}},function(t,e,o){"use strict";e.decode=e.parse=o(257),e.encode=e.stringify=o(258)},function(t,e,o){"use strict";function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(t,e,o){if(t&&c.isObject(t)&&t instanceof n)return t;var i=new n;return i.parse(t,e,o),i}function r(t){return c.isString(t)&&(t=i(t)),t instanceof n?t.format():n.prototype.format.call(t)}function a(t,e){return i(t,!1,!0).resolve(e)}function s(t,e){return t?i(t,!1,!0).resolveObject(e):e}var l=o(256),c=o(261);e.parse=i,e.resolve=a,e.resolveObject=s,e.format=r,e.Url=n;var u=/^([a-z0-9.+-]+:)/i,p=/:[0-9]*$/,d=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,h=["<",">",'"',"`"," ","\r","\n","\t"],f=["{","}","|","\\","^","`"].concat(h),m=["'"].concat(f),_=["%","/","?",";","#"].concat(m),g=["/","?","#"],v=255,y=/^[+a-z0-9A-Z_-]{0,63}$/,b=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,E={javascript:!0,"javascript:":!0},S={javascript:!0,"javascript:":!0},M={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},C=o(259);n.prototype.parse=function(t,e,o){if(!c.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var n=t.indexOf("?"),i=n!==-1&&n<t.indexOf("#")?"?":"#",r=t.split(i),a=/\\/g;r[0]=r[0].replace(a,"/"),t=r.join(i);var s=t;if(s=s.trim(),!o&&1===t.split("#").length){var p=d.exec(s);if(p)return this.path=s,this.href=s,this.pathname=p[1],p[2]?(this.search=p[2],e?this.query=C.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var h=u.exec(s);if(h){h=h[0];var f=h.toLowerCase();this.protocol=f,s=s.substr(h.length)}if(o||h||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var B="//"===s.substr(0,2);!B||h&&S[h]||(s=s.substr(2),this.slashes=!0)}if(!S[h]&&(B||h&&!M[h])){for(var R=-1,x=0;x<g.length;x++){var w=s.indexOf(g[x]);w!==-1&&(R===-1||w<R)&&(R=w)}var k,O;O=R===-1?s.lastIndexOf("@"):s.lastIndexOf("@",R),O!==-1&&(k=s.slice(0,O),s=s.slice(O+1),this.auth=decodeURIComponent(k)),R=-1;for(var x=0;x<_.length;x++){var w=s.indexOf(_[x]);w!==-1&&(R===-1||w<R)&&(R=w)}R===-1&&(R=s.length),this.host=s.slice(0,R),s=s.slice(R),this.parseHost(),this.hostname=this.hostname||"";var D="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!D)for(var P=this.hostname.split(/\./),x=0,T=P.length;x<T;x++){var A=P[x];if(A&&!A.match(y)){for(var F="",z=0,I=A.length;z<I;z++)F+=A.charCodeAt(z)>127?"x":A[z];if(!F.match(y)){var j=P.slice(0,x),U=P.slice(x+1),V=A.match(b);V&&(j.push(V[1]),U.unshift(V[2])),U.length&&(s="/"+U.join(".")+s),this.hostname=j.join(".");break}}}this.hostname.length>v?this.hostname="":this.hostname=this.hostname.toLowerCase(),D||(this.hostname=l.toASCII(this.hostname));var L=this.port?":"+this.port:"",W=this.hostname||"";this.host=W+L,this.href+=this.host,D&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!E[f])for(var x=0,T=m.length;x<T;x++){var K=m[x];if(s.indexOf(K)!==-1){var N=encodeURIComponent(K);N===K&&(N=escape(K)),s=s.split(K).join(N)}}var $=s.indexOf("#");$!==-1&&(this.hash=s.substr($),s=s.slice(0,$));var H=s.indexOf("?");if(H!==-1?(this.search=s.substr(H),this.query=s.substr(H+1),e&&(this.query=C.parse(this.query)),s=s.slice(0,H)):e&&(this.search="",this.query={}),s&&(this.pathname=s),M[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var L=this.pathname||"",q=this.search||"";this.path=L+q}return this.href=this.format(),this},n.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",o=this.pathname||"",n=this.hash||"",i=!1,r="";this.host?i=t+this.host:this.hostname&&(i=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&c.isObject(this.query)&&Object.keys(this.query).length&&(r=C.stringify(this.query));var a=this.search||r&&"?"+r||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||M[e])&&i!==!1?(i="//"+(i||""),o&&"/"!==o.charAt(0)&&(o="/"+o)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),o=o.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),a=a.replace("#","%23"),e+i+o+a+n},n.prototype.resolve=function(t){return this.resolveObject(i(t,!1,!0)).format()},n.prototype.resolveObject=function(t){if(c.isString(t)){var e=new n;e.parse(t,!1,!0),t=e}for(var o=new n,i=Object.keys(this),r=0;r<i.length;r++){var a=i[r];o[a]=this[a]}if(o.hash=t.hash,""===t.href)return o.href=o.format(),o;if(t.slashes&&!t.protocol){for(var s=Object.keys(t),l=0;l<s.length;l++){var u=s[l];"protocol"!==u&&(o[u]=t[u])}return M[o.protocol]&&o.hostname&&!o.pathname&&(o.path=o.pathname="/"),o.href=o.format(),o}if(t.protocol&&t.protocol!==o.protocol){if(!M[t.protocol]){for(var p=Object.keys(t),d=0;d<p.length;d++){var h=p[d];o[h]=t[h]}return o.href=o.format(),o}if(o.protocol=t.protocol,t.host||S[t.protocol])o.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),o.pathname=f.join("/")}if(o.search=t.search,o.query=t.query,o.host=t.host||"",o.auth=t.auth,o.hostname=t.hostname||t.host,o.port=t.port,o.pathname||o.search){var m=o.pathname||"",_=o.search||"";o.path=m+_}return o.slashes=o.slashes||t.slashes,o.href=o.format(),o}var g=o.pathname&&"/"===o.pathname.charAt(0),v=t.host||t.pathname&&"/"===t.pathname.charAt(0),y=v||g||o.host&&t.pathname,b=y,E=o.pathname&&o.pathname.split("/")||[],f=t.pathname&&t.pathname.split("/")||[],C=o.protocol&&!M[o.protocol];if(C&&(o.hostname="",o.port=null,o.host&&(""===E[0]?E[0]=o.host:E.unshift(o.host)),o.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),y=y&&(""===f[0]||""===E[0])),v)o.host=t.host||""===t.host?t.host:o.host,o.hostname=t.hostname||""===t.hostname?t.hostname:o.hostname,o.search=t.search,o.query=t.query,E=f;else if(f.length)E||(E=[]),E.pop(),E=E.concat(f),o.search=t.search,o.query=t.query;else if(!c.isNullOrUndefined(t.search)){if(C){o.hostname=o.host=E.shift();var B=!!(o.host&&o.host.indexOf("@")>0)&&o.host.split("@");B&&(o.auth=B.shift(),o.host=o.hostname=B.shift())}return o.search=t.search,o.query=t.query,c.isNull(o.pathname)&&c.isNull(o.search)||(o.path=(o.pathname?o.pathname:"")+(o.search?o.search:"")),o.href=o.format(),o}if(!E.length)return o.pathname=null,o.search?o.path="/"+o.search:o.path=null,o.href=o.format(),o;for(var R=E.slice(-1)[0],x=(o.host||t.host||E.length>1)&&("."===R||".."===R)||""===R,w=0,k=E.length;k>=0;k--)R=E[k],"."===R?E.splice(k,1):".."===R?(E.splice(k,1),w++):w&&(E.splice(k,1),w--);if(!y&&!b)for(;w--;w)E.unshift("..");!y||""===E[0]||E[0]&&"/"===E[0].charAt(0)||E.unshift(""),x&&"/"!==E.join("/").substr(-1)&&E.push("");var O=""===E[0]||E[0]&&"/"===E[0].charAt(0);if(C){o.hostname=o.host=O?"":E.length?E.shift():"";var B=!!(o.host&&o.host.indexOf("@")>0)&&o.host.split("@");B&&(o.auth=B.shift(),o.host=o.hostname=B.shift())}return y=y||o.host&&E.length,y&&!O&&E.unshift(""),E.length?o.pathname=E.join("/"):(o.pathname=null,o.path=null),c.isNull(o.pathname)&&c.isNull(o.search)||(o.path=(o.pathname?o.pathname:"")+(o.search?o.search:"")),o.auth=t.auth||o.auth,o.slashes=o.slashes||t.slashes,o.href=o.format(),o},n.prototype.parseHost=function(){var t=this.host,e=p.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,configurable:!1,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,configurable:!1,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){t.exports=o},function(t,e,o){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e["default"]=t,e}function i(t){return t&&t.__esModule?t:{"default":t}}var r=o(0),a=i(r),s=o(3),l=i(s),c=o(2),u=i(c),p=o(1),d=o(92),h=i(d),f=o(10),m=i(f),_=o(5),g=i(_),v=o(7),y=i(v),b=o(61),E=i(b),S=o(93),M=n(S),C=o(6),B=i(C),R=o(60),x=n(R),w=o(14),k=i(w),O=o(20),D=i(O),P=function(t){function e(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a["default"])(this,e);var n=(0,l["default"])(this,t.call(this));return n._mediator=new p.EventEmitter,n._options=o,n._initOptions(),n._initLanguage(),n._initEvents(),n._disposed=!1,p.Log.setLevel(n._options.logLevel),n.run(),n}return(0,u["default"])(e,t),e.prototype.run=function(){this._registerWebFonts(),this._options.container.style.position="relative",this._render()},e.prototype._render=function(){var t=p.React.createElement(h["default"],{ui:this,mediator:this._mediator,options:this._options});return this._options.renderReturnsComponent?t:void(this._component=p.ReactDOM.render(t,this._options.container))},e.prototype["export"]=function(){var t;return(t=this._component)["export"].apply(t,arguments)},e.prototype.serialize=function(){var t;return(t=this._component).serialize.apply(t,arguments)},e.prototype.deserialize=function(t){return this._component.deserialize(t)},e.prototype.getEditor=function(){return this._component.getEditor()},e.prototype._initOptions=function(){this._options=p.SDKUtils.defaults(this._options,{language:"en",title:"PhotoEditor SDK",logLevel:"warn",preloader:!0,editor:{},assets:{},photoRoll:{},enableUpload:!0,enableWebcam:!0,showCloseButton:!1,showHeader:!0,showTopBar:!0,responsive:!1}),this._options.editor=p.SDKUtils.defaults(this._options.editor||{},{pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1,preferredRenderer:"webgl",enableZoom:!0,enableDrag:!0,smoothDownscaling:!1,smoothUpscaling:!1,displayResizeMessage:!0,maxMegaPixels:{},forceControls:[],watermarkImage:null,tools:["crop","filter","brightness","saturation","contrast","clarity","exposure","shadows","highlights","text","sticker","brush","radial-focus","linear-focus","border"],controlsOrder:["crop",["filter","adjustments"],["text","sticker","brush"],["selectiveBlur","focus","border"]],operationsOrder:["exif-orientation","orientation","crop","filter","adjustments","radial-focus","linear-focus","selective-blur","sprite","border","watermark"],controlsOptions:{}}),this._options.editor.maxMegaPixels=p.SDKUtils.defaults(this._options.editor.maxMegaPixels,{mobile:5,desktop:10}),this._options.editor["export"]=p.SDKUtils.defaults(this._options.editor["export"]||{},{showButton:!0,format:"image/png",type:p.RenderType.IMAGE,download:!0,fileBasename:"photoeditorsdk-export",quality:.8}),this._options.photoRoll=p.SDKUtils.defaults(this._options.photoRoll||{},{provider:null}),this._options.extensions=p.SDKUtils.defaults(this._options.extensions||{},{languages:{},operations:[],controls:[]}),this._options.assets=p.SDKUtils.defaults(this._options.assets||{},{baseUrl:"assets",resolver:null})},e.prototype._registerWebFonts=function(){var t=this.getAssetPath("fonts/montserrat-regular.woff",!0,!0),e=this.getAssetPath("fonts/montserrat-light.woff",!0,!0),o='\n      // Injected by PhotoEditorSDK\n      @font-face {\n        font-family: "__pesdk_Montserrat";\n        src: url(\''+t+"') format('woff');\n        font-weight: normal;\n        font-style: normal;\n      }\n\n      @font-face {\n        font-family: \"__pesdk_Montserrat\";\n        src: url('"+e+"') format('woff');\n        font-weight: 100;\n        font-style: normal;\n      }\n    ";this._webFontsStyle=document.createElement("style"),this._webFontsStyle.innerHTML=o;var n=document.getElementsByTagName("head")[0];n.appendChild(this._webFontsStyle)},e.prototype._initEvents=function(){this._mediator.pipeEvents(this)},e.prototype._disposeEvents=function(){this._mediator.unpipeEvents(this)},e.prototype._initLanguage=function(){this._languages=p.SDKUtils.deepDefaults(this._options.extensions.languages,{de:o(94),en:o(95)}),this._language=this._languages[this._options.language],this._language||p.Log.error(this.constructor.name,"Language `"+this._options.language+"` not found!");
},e.prototype.translate=function(t,e){return p.Utils.translate(this._language,t,e)},e.prototype.setImage=function(t){this._component&&this._component.setImage(t)},e.prototype.getAssetPath=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this._options.assets,i=n.baseUrl,r=n.resolver,a=i+"/"+t;if(e){if(!o){var s="undefined"!=typeof window&&window.devicePixelRatio||1;if(s>1){var l=/\.[\w\?=]+$/;t=t.replace(l,function(t){return"@2x"+t})}}a=i+"/ui/react/"+t}return"undefined"!=typeof r&&null!==r&&(a=r(a)),a},e.prototype.dispose=function(){if(this._disposed)throw new Error("This instance of PhotoEditorSDK is already disposed.");this._disposed=!0,this._webFontsStyle.parentNode.removeChild(this._webFontsStyle),p.ReactDOM.unmountComponentAtNode(this._options.container),this._disposeEvents()},e}(p.EventEmitter);/*!
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */
P.prototype.identifier="react",P.BaseComponent=p.BaseComponent,P.BaseControls=B["default"],P.ControlsComponent=g["default"],P.React=p.React,P.ReactBEM=p.ReactBEM,P.SharedState=p.SharedState,P.Constants=p.Constants,P.Utils=p.Utils,P.ScrollbarComponent=m["default"],P.ModalManager=y["default"],P.JSONLoader=E["default"],P.PhotoRoll=M,P.Controls=x,P.SliderComponent=k["default"],P.SliderOverlayComponent=D["default"];var T=function(t){function e(){(0,a["default"])(this,e);for(var o=arguments.length,n=Array(o),i=0;i<o;i++)n[i]=arguments[i];var r=(0,l["default"])(this,t.call.apply(t,[this].concat(n)));return r._ui=new P(r.props),r}return(0,u["default"])(e,t),e.prototype.render=function(){return this._ui.render()},e}(p.React.Component);P.ReactComponent=T,p.SDK.UI=p.SDK.UI||{},p.SDK.UI.ReactUI=P,t.exports=P}])});