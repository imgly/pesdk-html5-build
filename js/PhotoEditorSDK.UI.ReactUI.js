!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("photoeditorsdk/js/PhotoEditorSDK"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["photoeditorsdk","react","react-dom"],t):"object"==typeof exports?exports.PhotoEditorReactUI=t(require("photoeditorsdk/js/PhotoEditorSDK"),require("react"),require("react-dom")):e.PhotoEditorReactUI=t(e.PhotoEditorSDK,e.React,e.ReactDOM)}("undefined"!=typeof self?self:this,function(e,t,o){return function(e){function t(i){if(o[i])return o[i].exports;var n=o[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var o={};return t.m=e,t.c=o,t.d=function(e,o,i){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=56)}([function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.SharedConstants=t.PropTypes=t.ImageLoader=t.ImageFormat=t.ColorMatrix=t.now=t.Log=t.cancelAnimationFrame=t.requestAnimationFrame=t.SDK=t.EXIF=t.ReactDOM=t.UniformType=t.OptionType=t.RenderType=t.Base64=t.Color=t.SharedState=t.Constants=t.EventEmitter=t.SDKUtils=t.Vector2=t.ReactBEM=t.BaseComponent=t.Classnames=t.BEM=t.React=t.Utils=t.Promise=void 0;var n=o(7),r=i(n),s=o(15),a=i(s),c=o(59),l=i(c),u=o(32),p=i(u),f=o(34),h=i(f),d=o(35),m=i(d),_=o(36),g=i(_),y=o(64),b=i(y),v=o(65),E=i(v),w=o(77),k=i(w),S=o(78),O=i(S),C=o(79),M=o(19),R=i(M),B=o(22),x=i(B),T=o(37),P=i(T),j=r.default.Base64,D=r.default.Color,I=r.default.Math.ColorMatrix,F=r.default.EventEmitter,A=r.default.EXIF,z=r.default.OptionType,N=r.default.Promise,V=r.default.Utils,L=r.default.RenderType,U=r.default.ImageFormat,W=r.default,K=r.default.UniformType,H=r.default.Math.Vector2,$="undefined"!=typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):o(38);t.Promise=N,t.Utils=E.default,t.React=a.default,t.BEM=m.default,t.Classnames=h.default,t.BaseComponent=b.default,t.ReactBEM=g.default,t.Vector2=H,t.SDKUtils=V,t.EventEmitter=F,t.Constants=k.default,t.SharedState=O.default,t.Color=D,t.Base64=j,t.RenderType=L,t.OptionType=z,t.UniformType=K,t.ReactDOM=l.default,t.EXIF=A,t.SDK=W,t.requestAnimationFrame=C.requestAnimationFrame,t.cancelAnimationFrame=C.cancelAnimationFrame,t.Log=R.default,t.now=$,t.ColorMatrix=I,t.ImageFormat=U,t.ImageLoader=x.default,t.PropTypes=p.default,t.SharedConstants=P.default},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),a=o(0),c=function(e){function t(o,r,s){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];i(this,t);var c=n(this,e.call(this));return c.type=o,c.title=r,c.text=s,c.overlay=a,c.data=null,c}return r(t,e),t.prototype.setData=function(e){this.data=e,this.emit("update")},t.prototype.close=function(){this.emit("close")},t}(a.EventEmitter),l=function(e){function t(){i(this,t);var o=n(this,e.call(this));return o._modals=[],o}return r(t,e),t.prototype.displayLoading=function(e){var t=new c("loading",null,e);return this.addModal(t),t},t.prototype.displayProgress=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=new c("progress",null,e);return o.setData({progress:t}),this.addModal(o),o},t.prototype.displayWarning=function(e,t){var o=new c("warning",e,t);return this.addModal(o),o},t.prototype.displayError=function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=new c("error",e,t,o);return this.addModal(i),i},t.prototype.addModal=function(e){var t=this;this._modals.push(e),e.on("close",function(){t.removeModal(e)}),e.on("update",function(){t.emit("update")}),this.emit("update")},t.prototype.removeModal=function(e){var t=this._modals.indexOf(e);this._modals.splice(t,1),this.emit("update")},t.prototype.getModals=function(){return this._modals},s(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}(a.EventEmitter);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(5),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){i(this,t);var o=n(this,e.call(this));return o.constructor.NATIVE_SCROLLBAR_WIDTH||(o.constructor.NATIVE_SCROLLBAR_WIDTH=s.Utils.getScrollbarWidth()),o._needsStyleFixes=!0,o._isDragging=!1,o._bindAll("_onButtonDragStart","_onButtonDrag","_onButtonDragStop","_onBarDragStart","_onBarDrag","_onBarDragStop","_onListScroll"),o.state={buttonSize:0,buttonPosition:0,buttonVisible:!1},o}return r(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.update()},t.prototype.fixStyles=function(){s.Utils.isMobile()||this._updateListSize()},t.prototype._onListScroll=function(){if(!this._isDragging){var e=this._getDirection(),o=void 0,i=void 0,n=void 0;e===t.HORIZONTAL?(o=this._list.scrollWidth-this._list.offsetWidth,i=this._list.scrollLeft,n=this._node.offsetWidth-this.state.buttonSize):e===t.VERTICAL&&(o=this._list.scrollHeight-this._list.offsetHeight,i=this._list.scrollTop,n=this._node.offsetHeight-this.state.buttonSize);var r=i/o;this.setState({buttonPosition:n*r})}},t.prototype._onButtonDragStart=function(e){this._isDragging=!0,this._initialButtonPosition=this.state.buttonPosition||0},t.prototype._onButtonDrag=function(e){var o=this._getDirection(),i=void 0;o===t.HORIZONTAL?i=this._initialButtonPosition+e.x:o===t.VERTICAL&&(i=this._initialButtonPosition+e.y),this._setButtonPosition(i)},t.prototype._onButtonDragStop=function(){this._isDragging=!1},t.prototype._onBarDragStart=function(e){var o=s.Utils.getEventPosition(e);this._initialPosition=o.clone();var i=this._node.getBoundingClientRect(),n=new s.Vector2(i.left,i.top),r=o.clone().subtract(n),a=this._getDirection();a===t.HORIZONTAL?this._setButtonPosition(r.x-this.state.buttonSize/2):a===t.VERTICAL&&this._setButtonPosition(r.y-this.state.buttonSize/2),document.addEventListener("mousemove",this._onBarDrag),document.addEventListener("touchmove",this._onBarDrag),document.addEventListener("mouseup",this._onBarDragStop),document.addEventListener("touchend",this._onBarDragStop)},t.prototype._onBarDrag=function(e){var o=s.Utils.getEventPosition(e),i=this._node.getBoundingClientRect(),n=new s.Vector2(i.left,i.top),r=o.clone().subtract(n),a=this._getDirection();a===t.HORIZONTAL?this._setButtonPosition(r.x-this.state.buttonSize/2):a===t.VERTICAL&&this._setButtonPosition(r.y-this.state.buttonSize/2)},t.prototype._onBarDragStop=function(){document.removeEventListener("mousemove",this._onBarDrag),document.removeEventListener("touchmove",this._onBarDrag),document.removeEventListener("mouseup",this._onBarDragStop),document.removeEventListener("touchend",this._onBarDragStop)},t.prototype._setButtonPosition=function(e){var o=this._getDirection(),i=void 0,n=void 0;o===t.HORIZONTAL?(i=this._node.offsetWidth-this.state.buttonSize,n=this._list.scrollWidth-this._list.offsetWidth):o===t.VERTICAL&&(i=this._node.offsetHeight-this.state.buttonSize,n=this._list.scrollHeight-this._list.offsetHeight),e=Math.max(0,e),e=Math.min(e,i),this.setState({buttonPosition:e});var r=e/i,s=n*r;o===t.HORIZONTAL?this._list.scrollLeft=s:o===t.VERTICAL&&(this._list.scrollTop=s)},t.prototype._updateButtonSize=function(e){var o=0,i=!1,n=void 0,r=void 0,s=this._getDirection();s===t.HORIZONTAL?(n=this._list.clientWidth,r=this._list.scrollWidth):s===t.VERTICAL&&(n=this._list.offsetHeight,r=this._list.scrollHeight),o=n/r*n,i=r>n,this.setState({buttonSize:o,buttonVisible:i},e)},t.prototype._updateListSize=function(){if(this._list){var e=this._getDirection();if(e===t.HORIZONTAL){this._list.style.height="";var o=this._getFullListDimensions();this._listSize=o.y,this._listContentSize=this._list.offsetHeight}else if(e===t.VERTICAL){this._list.style.width="";var i=this._getFullListDimensions();this._listSize=i.x,this._listContentSize=this._list.offsetWidth}}},t.prototype._getFullListDimensions=function(){var e=this._list.getBoundingClientRect();return new s.Vector2(e.width,e.height)},t.prototype.update=function(){var e=this;if(!s.Utils.isMobile()){var o=this.refs,i=o.root,n=o.list;this._node=i,this._list=n;var r=this._getDirection();this._updateButtonSize(function(){e._listSize||e._updateListSize();var o=e._listSize;e.state.buttonVisible&&(o+=e.constructor.NATIVE_SCROLLBAR_WIDTH),r===t.HORIZONTAL?(e._list.style.height=o+"px",e._node.style.top=e._listContentSize-12+"px",e._node.style.width=e._list.offsetWidth+"px"):r===t.VERTICAL&&(e._list.style.width=o+"px",e._node.style.left=e._listContentSize-12+"px",e._node.style.height=e._list.offsetHeight+"px")}),this._list.addEventListener("scroll",this._onListScroll)}},t.prototype._getDirection=function(){return this.props.direction||"horizontal"},t.prototype._getButtonStyle=function(){return"horizontal"===this._getDirection()?{left:this.state.buttonPosition,width:this.state.buttonSize}:{top:this.state.buttonPosition,height:this.state.buttonSize}},t.prototype.getList=function(){return this.refs.list},t.prototype.getRoot=function(){return this.refs.root},t.prototype.renderWithBEM=function(){if(s.Utils.isMobile())return this.props.children;var e=this._getButtonStyle(),t={display:this.state.buttonVisible?"block":"none"},o=s.React.cloneElement(this.props.children,{ref:"list"});return s.ReactBEM.createElement("div",null,o,s.ReactBEM.createElement("div",{bem:"$b:scrollbar m:"+(this.props.direction||"horizontal")+" m:"+(this.state.buttonVisible?"visible":"invisible"),ref:"root",style:t,onMouseDown:this._onBarDragStart,onTouchStart:this._onBarDragStart},s.ReactBEM.createElement(c.default,{onStart:this._onButtonDragStart,onDrag:this._onButtonDrag,onStop:this._onButtonDragStop},s.ReactBEM.createElement("div",{bem:"e:bar",style:e,onMouseDown:this._onButtonDown}))))},t}(s.BaseComponent);t.default=l,l.HORIZONTAL="horizontal",l.VERTICAL="vertical",l.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(104),l=i(c),u=o(105),p=i(u),f=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var a=r(this,e.call.apply(e,[this].concat(i)));return a._hasBackButton=!0,a._hasDoneButton=!1,a._backButtonClicked=!1,a._bindAll("_onBackClick","_onDoneClick"),a}return s(t,e),t.prototype._onBackClick=function(e){this._backButtonClicked=!0,this.props.onSwitchControls("back")},t.prototype._onDoneClick=function(e){this._onBackClick()},t.prototype.renderControls=function(){return null},t.prototype.renderOverlayControls=function(){return null},t.prototype.renderWithBEM=function(){var e=this.props.options&&this.props.options.forcedControl,t=this._hasBackButton&&!e?a.ReactBEM.createElement(l.default,{onClick:this._onBackClick}):null,o=this._hasDoneButton||e?a.ReactBEM.createElement(p.default,{onClick:this._onDoneClick}):null;return a.ReactBEM.createElement("div",{bem:"$b:controls",ref:"root"},this.renderOverlayControls(),a.ReactBEM.createElement("div",{bem:"e:table"},t,this.renderControls(),o))},t}(a.BaseComponent);t.default=f,f.contextTypes=a.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){i(this,e)}return e.prototype.getInitialSharedState=function(){return{}},e.prototype.isAvailable=function(e){return!1},e.getPreloadAssets=function(){return[]},e}();n.topBarControlsComponent=null,n.controlsComponent=null,n.canvasControlsComponent=null,n.identifier=null,n.iconPath=null,n.languageKey=null,n.defaultOptions={},t.default=n},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a._bindAll("_onDragStart","_onDragMove","_onDragEnd"),a}return r(t,e),t.prototype._onDragStart=function(e){if(!this.props.disabled){e.preventDefault(),e.stopPropagation(),this._initialMousePosition=s.Utils.getEventPosition(e),document.addEventListener("mousemove",this._onDragMove),document.addEventListener("touchmove",this._onDragMove),document.addEventListener("mouseup",this._onDragEnd),document.addEventListener("touchend",this._onDragEnd);var t=this.refs.element,o=t.getBoundingClientRect(),i=new s.Vector2(o.left,o.top),n=this._initialMousePosition.clone().subtract(i);this.props.onStart&&this.props.onStart(n,e)}},t.prototype._onDragMove=function(e){e.preventDefault(),e.stopPropagation();var t=s.Utils.getEventPosition(e);if(t){var o=t.clone().subtract(this._initialMousePosition);this.props.onDrag&&this.props.onDrag(o,e)}},t.prototype._onDragEnd=function(e){e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),this._onDragMove(e),document.removeEventListener("mousemove",this._onDragMove),document.removeEventListener("touchmove",this._onDragMove),document.removeEventListener("mouseup",this._onDragEnd),document.removeEventListener("touchend",this._onDragEnd),this.props.onStop&&this.props.onStop(e)},t.prototype.render=function(){if(!this.props.children||this.props.children instanceof Array)throw new Error("DraggableComponent expects exactly one child.");return s.React.cloneElement(this.props.children,{onMouseDown:this._onDragStart,onTouchStart:this._onDragStart,ref:"element"})},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(13),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a._bindAll("_onSliderValueChange"),a.state={value:a.props.value},a}return r(t,e),t.prototype.componentWillReceiveProps=function(e){e.value!==this.state.value&&(this.state.value=e.value)},t.prototype._onSliderValueChange=function(e){this.props.onChange&&this.props.onChange(e),this.setState({value:e})},t.prototype._renderSlider=function(){var e=s.SDKUtils.defaults(this.props,{style:"",middleDot:!1,minValue:1,maxValue:100,label:"Label",onChange:this._onSliderValueChange,value:this.state.value});return s.ReactBEM.createElement(c.default,e)},t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("div",{bem:"$b:controls e:overlay m:slider m:dark"},this._renderSlider())},t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(t,o){t.exports=e},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(82),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype._renderHeader=function(){return this.context.options.showHeader?s.ReactBEM.createElement(c.default,null):null},t.prototype._renderScreen=function(){return s.ReactBEM.createElement("div",null)},t.prototype.renderWithBEM=function(){var e="b:screen";return this.context.options.showHeader||(e+=" m:noHeader"),s.ReactBEM.createElement("div",{bem:e,className:this.props.visible?null:"is-hidden"},this._renderHeader(),this._renderScreen())},t}(s.BaseComponent);t.default=l,l.propTypes={editor:s.PropTypes.any},l.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a._bindAll("_onCanvasZoomDone"),a}return r(t,e),t.prototype._performHitTest=function(e){var t=this.refs.container,o=t.getBoundingClientRect(),i=new s.Vector2(o.left,o.top),n=e.subtract(i),r=this.context.editor,a=r.controls.getAvailable();for(var c in a){var l=a[c],u=l.clickAtPosition&&l.clickAtPosition(n,r);if(u)return u.selectedSprite===this.getSharedState("selectedSprite")||(this.props.onSwitchControls(l,u),!0)}return!1},t.prototype._onCanvasZoomDone=function(){this.forceUpdate()},t.prototype._bindEvents=function(){e.prototype._bindEvents.call(this),this.context.mediator.on(s.Constants.EVENTS.ZOOM_DONE,this._onCanvasZoomDone)},t.prototype._unbindEvents=function(){e.prototype._unbindEvents.call(this),this.context.mediator.off(s.Constants.EVENTS.ZOOM_DONE,this._onCanvasZoomDone)},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t){var o;o=function(){return this}();try{o=o||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(o=window)}e.exports=o},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=o(37),a=i(s),c=o(21),l=i(c),u=function(){function e(t,o){n(this,e),this._ui=t,this._options=o,this._categoriesById={},this._categories=[],this._stickersById={},this._addCategories(a.default.DEFAULTS.STICKER_CATEGORIES);var i=this._options,r=i.categories,s=i.replaceCategories;this._options.categories?this._addCategories(r,s):(this._updateCategoriesMap(),this._updateAllCategory())}return e.prototype.loadExternal=function(e){var t=this;return new l.default(e).load().then(function(e){t._addCategories(e.categories,t._options.replaceCategories)})},e.prototype._addCategories=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._categories=t?e.slice(0):r.Utils.mergeCategories(this._categories,e,"stickers"),this._updateCategoriesMap(),this._updateAllCategory()},e.prototype._updateCategoriesMap=function(){var e=this;this._categoriesById={},this._categories.forEach(function(t){e._categoriesById[t.identifier]=t}),this._categories.forEach(function(t){t.stickers.forEach(function(t){e._stickersById[t.identifier]=t})}),void 0!==this._options.availableStickers&&null!==this._options.availableStickers&&(this._categories.forEach(function(t){t.stickers=t.stickers.filter(function(t){return-1!==e._options.availableStickers.indexOf(t.identifier)})}),this._categories=this._categories.filter(function(e){return e.stickers.length>0})),this._updateAllCategory()},e.prototype._updateAllCategory=function(){this._allCategory={identifier:"all",defaultName:"All",stickers:this._categories.map(function(e){return e.stickers}).reduce(function(e,t){return e.concat(t)},[])},this._categoriesById.all=this._allCategory},e.prototype.getStickersForCategory=function(e){if(!this._categoriesById[e])throw new Error("Unknown sticker category '"+e+"'");return this._categoriesById[e].stickers},e.prototype.getStickerByIdentifier=function(e){return this._stickersById[e]},e.prototype.getCategories=function(){return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?[this._allCategory].concat(this._categories):this._categories},e.prototype.getCategory=function(e){return this._categoriesById[e]},e.getURLForSticker=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"base",o=e.images,i="base"===t?o.mediaBase||o.mediaThumb:o.mediaThumb,n=i.uris||[i.uri];if(void 0===r.Utils.Browser||r.Utils.Browser.getIEVersion()){var s=n.filter(function(e){return!/\.svg$/i.test(e)});return s.length?s[0]:n[0]}var a=n.filter(function(e){return/\.svg$/i.test(e)});return a.length?a[0]:n[0]},e}();t.default=u},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.renderContent=function(){return this.props.children},t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("div",{bem:"$b:topBar e:row"},s.ReactBEM.createElement("div",{bem:"e:cell"},this.renderContent()))},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},a=o(0),c=o(5),l=function(e){return e&&e.__esModule?e:{default:e}}(c),u=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a._bindAll("_onKnobDragStart","_onKnobDrag","_onKnobDragStop","_onBarDragStart","_onBarDrag","_onBarDragStop","_onMiddleDotClick"),a.state={value:a.props.value||0,sliderPosition:0,foregroundLeft:0,foregroundWidth:0},a}return r(t,e),t.prototype.componentDidMount=function(){this._setValue(this.state.value,!1)},t.prototype.componentWillReceiveProps=function(e){e.value!==this.state.value&&this._setValue(e.value,!1)},t.prototype._onMiddleDotClick=function(){this._previousValue=this.state.value;var e=this.props.minValue+(this.props.maxValue-this.props.minValue)/2;this._setValue(e,!0,!0)},t.prototype._onKnobDragStart=function(e){this._previousValue=this.state.value,this._initialSliderPosition=this.state.sliderPosition,this._initialPosition=e},t.prototype._onKnobDrag=function(e){var t=this.refs.bar,o=t.offsetWidth,i=this._initialSliderPosition+e.x;i=Math.max(0,Math.min(i,o));var n=i/o,r=this.props.minValue+(this.props.maxValue-this.props.minValue)*n;this._setValue(r)},t.prototype._onKnobDragStop=function(){this._setValue(this.state.value,!0,!0)},t.prototype._onBarDragStart=function(e){this._previousValue=this.state.value,this._initialPosition=e.clone();var t=this.refs.bar,o=t.offsetWidth,i=e.x/o,n=this.props.minValue+(this.props.maxValue-this.props.minValue)*i;this._setValue(n)},t.prototype._onBarDrag=function(e){var t=this._initialPosition.clone().add(e),o=this.refs.bar,i=o.offsetWidth,n=t.x/i,r=this.props.minValue+(this.props.maxValue-this.props.minValue)*n;r=Math.max(this.props.minValue,Math.min(this.props.maxValue,r)),this._setValue(r)},t.prototype._onBarDragStop=function(){this._setValue(this.state.value,!0,!0)},t.prototype._getKnobStyle=function(){return{left:this.state.sliderPosition}},t.prototype._getForegroundStyle=function(){return{left:this.state.foregroundLeft,width:this.state.foregroundWidth}},t.prototype._displayMiddleDot=function(){return!1!==this.props.middleDot},t.prototype._setValue=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=Math.round(e);var i=this.props,n=i.minValue,r=i.maxValue,s=(e-n)/(r-n),a=this.refs.bar,c=a.offsetWidth,l=c*s,u=s*c,p=0;this._displayMiddleDot()&&(u=Math.abs(s-.5)*c,p=s<.5?.5*c-u:"50%"),this.setState({value:e,sliderPosition:l,foregroundWidth:u,foregroundLeft:p}),t&&this.props.onChange&&this.props.onChange(e,this._previousValue,o)},t.prototype._buildValue=function(e){return e%1!=0&&(e=e.toFixed(2)),this.props.positiveValuePrefix&&e>=0&&(e=""+this.props.positiveValuePrefix+e),this.props.valueUnit&&(e+=this.props.valueUnit),e},t.prototype.renderWithBEM=function(){var e=null;this._displayMiddleDot()&&(e=a.ReactBEM.createElement("div",{bem:"e:middleDot",onClick:this._onMiddleDotClick}));var t={style:this._getForegroundStyle()},o="$b:slider"+(this.props.style?" m:"+this.props.style:"");return a.ReactBEM.createElement("div",{bem:o},a.ReactBEM.createElement("div",{bem:"$e:bar",ref:"bar"},a.ReactBEM.createElement(l.default,{onStart:this._onBarDragStart,onDrag:this._onBarDrag,onStop:this._onBarDragStop},a.ReactBEM.createElement("div",null,a.ReactBEM.createElement("div",{bem:"$e:background"}),a.ReactBEM.createElement("div",s({bem:"$e:foreground"},t)),a.ReactBEM.createElement(l.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag,onStop:this._onKnobDragStop},a.ReactBEM.createElement("div",{bem:"e:knob b:knob m:slider",style:this._getKnobStyle()})))),e),a.ReactBEM.createElement("div",{bem:"$e:labels"},a.ReactBEM.createElement("div",{bem:"e:label m:lowerBoundary"},this._buildValue(this.props.minValue)),a.ReactBEM.createElement("div",{bem:"e:label m:value"},this.props.label," ",this._buildValue(this.state.value)),a.ReactBEM.createElement("div",{bem:"e:label m:upperBoundary"},this._buildValue(this.props.maxValue))))},t}(a.BaseComponent);t.default=u,u.contextTypes=a.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},l=o(0),u=o(138),p=i(u),f=o(139),h=i(f),d=o(140),m=i(d),_=o(9),g=i(_),y=l.SDK.Operations.SpriteOperation,b=y.StickerSprite,v=y.TextSprite,E=y.BrushSprite,w=function(e){function t(){var o;r(this,t);for(var i=arguments.length,a=Array(i),c=0;c<i;c++)a[c]=arguments[c];var u=s(this,e.call.apply(e,[this].concat(a)));return u._bindAll("_onCanvasClick","_onSpriteDragStart","_onSpriteDragStop","_onOperationUpdated","_onOperationRemoved","_onSpriteFlip","_onSpriteTakeToFront","_onSpriteRemove"),u._canvasClickDisabled=!1,u._events=(o={},n(o,l.Constants.EVENTS.OPERATION_UPDATED,u._onOperationUpdated),n(o,l.Constants.EVENTS.OPERATION_REMOVED,u._onOperationRemoved),o),u}return a(t,e),t.prototype._onOperationRemoved=function(e){var t=this.getSharedState("selectedSprite");if(e===this.getSharedState("operation")&&t){var o=this.context.editor,i=o.operations.getOrCreate("sprite",{sprites:[t],enabled:!1});this.setSharedState({operation:i,operationExistedBefore:!1,initialOptions:{}})}},t.prototype._onOperationUpdated=function(e){var t=this.getSharedState("selectedSprite");if(e===this.getSharedState("operation")&&t){var o=e.getSprites();-1===o.indexOf(t)&&o.push(t),this.forceUpdate()}},t.prototype._onItemBlur=function(){},t.prototype._onCanvasClick=function(e){if(!this._canvasClickDisabled){this._performHitTest(l.Utils.getEventPosition(e))||(this.getSharedState("selectedSprite")&&this._onItemBlur(),this.props.onSwitchControls("home"))}},t.prototype._onSpriteFlip=function(e){var t=this.getSharedState("selectedSprite");switch(e){case"h":t.setFlipHorizontally(!t.getFlipHorizontally());break;case"v":t.setFlipVertically(!t.getFlipVertically())}this.context.editor.render()},t.prototype._onSpriteTakeToFront=function(e){this.getSharedState("operation").takeSpriteToFront(this.getSharedState("selectedSprite")),this.forceSharedUpdate(),this.context.editor.render()},t.prototype._onSpriteRemove=function(){var e=this.getSharedState("operation"),t=this.getSharedState("selectedSprite");e.removeSprite(t),t.dispose(),this.setSharedState({selectedSprite:null}),this.context.editor.render()},t.prototype._onSpriteDragStart=function(){this._canvasClickDisabled=!0},t.prototype._onSpriteDragStop=function(){var e=this;setTimeout(function(){e._canvasClickDisabled=!1},100)},t.prototype._getContainerStyle=function(){var e=this.context.editor,t=e.getCanvasDimensions(),o=e.getOutputDimensions(),i=t.clone().divide(2).subtract(o.clone().divide(2));return{left:i.x,top:i.y,width:o.x,height:o.y}},t.prototype._getContainerProps=function(){return{}},t.prototype._getInnerContainerProps=function(){return{style:this._getContainerStyle(),onClick:this._onCanvasClick}},t.prototype._getPropsForSprite=function(e){return{hideContent:!0}},t.prototype._getComponentTypeForSprite=function(e){return e instanceof v?p.default:e instanceof b?h.default:e instanceof E?m.default:void 0},t.prototype._renderSpriteItems=function(){var e=this,t=this.getSharedState("operation"),o=t.getSprites(),i=this.getSharedState("selectedSprite");return o.map(function(o){var n=o===i,r=e._getComponentTypeForSprite(o),s=e._getPropsForSprite(o);return l.ReactBEM.createElement(r,c({operation:t,sharedState:e.props.sharedState,sprite:o,selected:n,onDragStart:e._onSpriteDragStart,onDragStop:e._onSpriteDragStop,onRemove:e._onSpriteRemove.bind(e,o),options:e.props.options,ref:"sprite-"+o.getId()},s))})},t.prototype._renderOverlayControls=function(){return null},t.prototype.renderWithBEM=function(){return l.ReactBEM.createElement("div",c({bem:"$b:canvasControls e:container m:full",ref:"container"},this._getContainerProps()),l.ReactBEM.createElement("div",c({bem:"b:canvasControls e:innerContainer",ref:"innerContainer"},this._getInnerContainerProps()),l.ReactBEM.createElement("div",{bem:"$b:spritesCanvasControls",ref:"container"},this._renderSpriteItems(),this._renderOverlayControls())))},t}(g.default);t.default=w,w.contextTypes=g.default.contextTypes},function(e,o){e.exports=t},function(e,t,o){"use strict";function i(e){return function(){return e}}var n=function(){};n.thatReturns=i,n.thatReturnsFalse=i(!1),n.thatReturnsTrue=i(!0),n.thatReturnsNull=i(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(e){return e},e.exports=n},function(e,t,o){"use strict";function i(e,t,o,i,r,s,a,c){if(n(t),!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[o,i,r,s,a,c],p=0;l=new Error(t.replace(/%s/g,function(){return u[p++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}}var n=function(e){};"production"!=={ENV:'"production"'}.NODE_ENV&&(n=function(e){if(void 0===e)throw new Error("invariant requires an error message argument")}),e.exports=i},function(e,t,o){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var o="warn",i=[{type:"trace",background:"#EEEEEE",color:"#AAAAAA"},{type:"info",background:"#BDE5F8",color:"#00529B"},{type:"warn",background:"#FEEFB3",color:"#9F6000"},{type:"error",background:"#FFBABA",color:"#D8000C"},{type:"log",background:"#EEEEEE",color:"#1f4f6b"}],n=i.map(function(e){return e.type}),r={};r.setLevel=function(e){o=e},r.canLog=function(e){return null!==o&&!(n.indexOf(e)<n.indexOf(o))},r.hasColorfulOutput=function(){return(!e||e&&e.browser)&&"undefined"!=typeof navigator&&navigator.userAgent.match(/Gecko|WebKit/i)&&!navigator.userAgent.match(/Trident/)},r.printError=function(e){e.stack.split("\n").forEach(function(e){r.error("Error",e)})},i.forEach(function(e){var t=e.type,o=e.background,i=e.color;r[t]=function(e){if("undefined"!=typeof console&&r.canLog(t)){for(var n=arguments.length,s=Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];var c=s.map(function(e){return"string"==typeof e?e:e.toString()}).join(" ");if(!r.hasColorfulOutput())return console.log("PhotoEditorSDK | "+e+" | "+c);console.log("%c  %c PhotoEditorSDK %c  %c "+e+" %c  "+c+"  %c  ","background: #2D7BFF; line-height: 20px; padding: 4px 0","background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0","background: "+o+"; color: "+i+"; line-height: 20px; padding: 4px 0; font-weight: bold","background: #2B2B2B; color: white; line-height: 20px; padding: 4px 0","background: #2D7BFF; line-height: 20px; padding: 4px 0")}}}),t.default=r}).call(t,o(20))},function(e,t){function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function n(e){if(u===setTimeout)return setTimeout(e,0);if((u===o||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function r(e){if(p===clearTimeout)return clearTimeout(e);if((p===i||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(e);try{return p(e)}catch(t){try{return p.call(null,e)}catch(t){return p.call(this,e)}}}function s(){m&&h&&(m=!1,h.length?d=h.concat(d):_=-1,d.length&&a())}function a(){if(!m){var e=n(s);m=!0;for(var t=d.length;t;){for(h=d,d=[];++_<t;)h&&h[_].run();_=-1,t=d.length}h=null,m=!1,r(e)}}function c(e,t){this.fun=e,this.array=t}function l(){}var u,p,f=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:o}catch(e){u=o}try{p="function"==typeof clearTimeout?clearTimeout:i}catch(e){p=i}}();var h,d=[],m=!1,_=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];d.push(new c(e,t)),1!==d.length||m||n(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=l,f.addListener=l,f.once=l,f.off=l,f.removeListener=l,f.removeAllListeners=l,f.emit=l,f.prependListener=l,f.prependOnceListener=l,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(e,t,o){"use strict";(function(e){function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=o(67),s=i(r),a=o(70),c=i(a),l="undefined"!=typeof window?window:e,u=function(){function e(t){n(this,e),this._url=t,this._parsedUrl=c.default.parse(this._url,!0)}return e.prototype._isJSONPRequest=function(){var e=this._parsedUrl.query;for(var t in e){if("?"===e[t])return!0}return!1},e.prototype.load=function(){return this._isJSONPRequest()?this._loadJSONP():this._loadJSON()},e.prototype._loadJSON=function(){var e=this;return new s.default(function(t,o){var i=void 0;l.XDomainRequest?(i=new l.XDomainRequest,i.onload=function(){var e=JSON.parse(i.responseText);t(e)},i.onerror=function(e){o(e)},i.open("GET",e._url,!0),i.send()):l.XMLHttpRequest&&(i=new XMLHttpRequest,i.onreadystatechange=function(e){if(4===i.readyState)if(200===i.status){var n=JSON.parse(i.responseText);t(n)}else o(new Error("HTTP Status "+i.status))},i.open("GET",e._url,!0),i.send())})},e.prototype._loadJSONP=function(){var e=this,t=!1,o=!1,i="pesdk"+Math.round(99999999999999*Math.random());return new s.default(function(n,r){var s=e._createJSONPNode(i);l[i]=function(i){e._removeJSONPNode(s),t||(o=!0,n(i))},l.setTimeout(function(){o||(e._removeJSONPNode(s),t=!0,r(new Error("Timeout of 5 seconds exceeded.")))},5e3)})},e.prototype._createJSONPNode=function(e){var t=this._buildJSONPUrl(e),o=document.querySelector("head"),i=document.createElement("script");return i.src=t,o.appendChild(i),i},e.prototype._removeJSONPNode=function(e){e.parentNode.removeChild(e)},e.prototype._buildJSONPUrl=function(e){var t=this._parsedUrl.query,o=null;for(var i in t)if("?"===t[i]){o=i;break}return delete this._parsedUrl.search,t[o]=e,c.default.format(this._parsedUrl)},e}();t.default=u}).call(t,o(10))},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var o=[],i=!0,n=!1,r=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done)&&(o.push(s.value),!t||o.length!==t);i=!0);}catch(e){n=!0,r=e}finally{try{!i&&a.return&&a.return()}finally{if(n)throw r}}return o}return function(t,o){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default={load:function(e){var t=this;return function(){if(e.substr(0,5),!0)return Promise.resolve([e,e])}().then(function(e){var o=i(e,2),n=o[0],r=o[1];return t._createAndLoadImage(n,r)})},_createAndLoadImage:function(e,t){return new Promise(function(e,o){var i=new window.Image;i.addEventListener("load",function(){e(i)}),i.addEventListener("error",function(){o(new Error("Failed to load image at "+t))}),i.crossOrigin="Anonymous",i.src=t})},loadXHR:function(e,t){return new Promise(function(o,i){var n=void 0;window.XDomainRequest?(n=new window.XDomainRequest,t&&n.overrideMimeType(t),n.onload=function(){o(n)},n.onerror=function(e){i(e)}):window.XMLHttpRequest&&(n=new window.XMLHttpRequest,t&&n.overrideMimeType(t),n.onreadystatechange=function(e){4===n.readyState&&(200===n.status?o(n):i(new Error("HTTP Status "+n.status)))}),n.open("GET",e,!0),n.send()})}}},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a._bindAll("_onClick"),a}return r(t,e),t.prototype._onClick=function(e){this.props.onClick&&this.props.onClick()},t.prototype._renderContent=function(){return null},t.prototype.renderWithBEM=function(){var e="$e:row m:"+this._modifier;return this.props.totalRows&&(e+=" m:row-"+this.props.totalRows),s.ReactBEM.createElement("bem",{specifier:"b:splashScreen"},s.ReactBEM.createElement("div",{bem:e},this._renderContent()))},t}(s.BaseComponent);t.default=a,a.propTypes={onClick:s.PropTypes.func},a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(86),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a._bindAll("_onNewFile"),a}return r(t,e),t.prototype.componentDidMount=function(){this._fileLoader=new c.default(this.refs.fileInput),this._fileLoader.on("file",this._onNewFile)},t.prototype.componentWillUnmount=function(){this._fileLoader.off("file",this._onNewFile),this._fileLoader.dispose(),this._fileLoader=null},t.prototype._onNewFile=function(e){this.props.onNewFile&&this.props.onNewFile(e)},t.prototype.open=function(){this._fileLoader.open()},t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("input",{type:"file",accept:"image/*",bem:"b:hiddenFileInput",ref:"fileInput"})},t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.renderWithBEM=function(){var e="$e:button";this.props.style&&(e+=" m:"+this.props.style),this.props.icon&&(e+=" m:withIcon");var t=null;return this.props.icon&&(t=s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath(this.props.icon,!0)})),s.ReactBEM.createElement("bem",{specifier:"$b:topBar"},s.ReactBEM.createElement("div",{bem:e,onClick:this.props.onClick},t,s.ReactBEM.createElement("div",{bem:"e:label"},this.props.label||"Button")))},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),r=function(){function e(t,o){i(this,e),this._ui=t,this._options=o,this._categoriesById={},this._filtersByIdentifier={identity:n.SDK.Operations.FilterOperation.Filters.IdentityFilter},this._categories=n.SharedConstants.DEFAULTS.FILTERS.slice(0),this._initCategories()}return e.prototype.instantiateFilterWithIdentifier=function(e){var t=this,o=this.getFilterByIdentifier(e);if(!o)return Promise.reject(new Error("Unknown filter with identifier `"+e+"`!"));if(o.prototype instanceof n.SDK.Operations.FilterOperation.Filter)return Promise.resolve(new o);var i=o.lutImage,r=o.resolution,s=o.horizontalTileCount,a=o.verticalTileCount,c=void 0;this._ui.getPreloader&&(c=this._ui.getPreloader().getAsset(i));var l=void 0;return l=c?Promise.resolve(c):n.ImageLoader.load(this._ui.getAssetPath(i)),l.then(function(e){return n.ImageLoader.load(t._ui.getAssetPath(i)).then(function(e){return new n.SDK.Operations.FilterOperation.Filters.ThreeDLUTFilter({image:e,resolution:r,horizontalTileCount:s,verticalTileCount:a})})})},e.prototype._initCategories=function(){var e=this;if(this._options.categories&&(this._options.replaceCategories?this._categories=this._options.categories:this._categories=n.Utils.mergeCategories(this._categories,this._options.categories,"filters")),this._options.availableFilters){var t=[];this._categories.forEach(function(o){var i=o.filters.filter(function(t){return-1!==e._options.availableFilters.indexOf(t.identifier)});i.length>0&&t.push({identifier:o.identifier,defaultName:o.defaultName,filters:i})}),this._categories=t}var o={identifier:"all",defaultName:"All",filters:this._categories.map(function(e){return e.filters}).reduce(function(e,t){return e.concat(t)})};this._categories.unshift(o),this._categoriesById.all=o,this._categories.forEach(function(t){e._categoriesById[t.identifier]=t}),o.filters.forEach(function(t){e._filtersByIdentifier[t.identifier]=t})},e.prototype.getFiltersForCategory=function(e){if(!this._categoriesById[e])throw new Error("Unknown filter category '"+e+"'");return this._categoriesById[e].filters},e.prototype.getFilterByIdentifier=function(e){return this._filtersByIdentifier[e]},e.prototype.getCategories=function(){return this._categories},e.prototype.getCategoryByIdentifier=function(e){return this._categoriesById[e]},e}();t.default=r},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a._bindAll("_onItemDragStart","_onItemDragStop","_onItemDrag","_onSpriteUpdate"),a}return r(t,e),t.prototype._getAbsoluteSpritePosition=function(){var e=this.context.editor,t=e.getOutputDimensions();return this.props.sprite.getPosition().clone().multiply(t)},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.props.sprite.on("update",this._onSpriteUpdate)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this.props.sprite.off("update",this._onSpriteUpdate)},t.prototype.componentWillReceiveProps=function(e){this.props.sprite.off("update",this._onSpriteUpdate),e.sprite.on("update",this._onSpriteUpdate)},t.prototype._onSpriteUpdate=function(){this.forceUpdate()},t.prototype._onItemDragStart=function(){var e=this.props.sprite;this._initialPosition=e.getPosition(),this.props.onDragStart&&this.props.onDragStart()},t.prototype._onItemDrag=function(e){var t=this.props.sprite,o=this.context.editor,i=o.getOutputDimensions(),n=this._initialPosition.clone().add(e.divide(i));t.setPosition(n),o.render()},t.prototype._onItemDragStop=function(){this.props.onDragStop&&this.props.onDragStop()},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(146),l=function(e){return e&&e.__esModule?e:{default:e}}(c),u=function(e){function t(){n(this,t);for(var o=arguments.length,s=Array(o),c=0;c<o;c++)s[c]=arguments[c];var l=r(this,e.call.apply(e,[this].concat(s)));return l._value=l.props.initialValue.clone(),l._bindAll("_onButtonClick","_onValueChange","_onColorPickerOpen","_onColorPickerClose"),l._events=i({},a.Constants.EVENTS.COLORPICKER_OPEN,l._onColorPickerOpen),l.state={overlayVisible:!1},l._transparentPatternCanvas=a.Utils.createTransparentPatternCanvas(),l}return s(t,e),t.prototype.componentWillReceiveProps=function(e){e.initialValue!==this.props.initialValue&&(this._value=e.initialValue.clone(),this._renderColor())},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._renderColor()},t.prototype.componentDidUpdate=function(){this._renderColor()},t.prototype._onColorPickerOpen=function(e){e!==this&&this.setState({overlayVisible:!1})},t.prototype._onColorPickerClose=function(){this.setState({overlayVisible:!1})},t.prototype._onButtonClick=function(e){e.preventDefault(),e.stopPropagation(),this.state.overlayVisible||this._emitEvent(a.Constants.EVENTS.COLORPICKER_OPEN,this),this.setState({overlayVisible:!this.state.overlayVisible})},t.prototype._onValueChange=function(e){this._value=e,this._renderColor(),this.forceUpdate(),this.props.onChange&&this.props.onChange(e)},t.prototype._renderColor=function(){var e=this.refs.canvas,t=e.getContext("2d");e.width=e.offsetWidth,e.height=e.offsetHeight;var o=t.createPattern(this._transparentPatternCanvas,"repeat");t.fillStyle=o,t.fillRect(0,0,e.width,e.height),t.fillStyle=this._value.toRGBA(),t.fillRect(0,0,e.width,e.height)},t.prototype.renderWithBEM=function(){var e=null;this.state.overlayVisible&&(e=a.ReactBEM.createElement(l.default,{initialValue:this._value,onChange:this._onValueChange,onClose:this._onColorPickerClose,alpha:this.props.alpha}));var t=this.state.overlayVisible?"is-active":null;return a.ReactBEM.createElement("bem",{specifier:"$b:controls"},a.ReactBEM.createElement("div",{bem:"$b:colorPicker",className:t,onClick:this._onButtonClick},a.ReactBEM.createElement("canvas",{bem:"e:preview",ref:"canvas"}),a.ReactBEM.createElement("div",{bem:"e:label"},this.props.label||this._t("generic.color")),e))},t}(a.BaseComponent);t.default=u,u.contextTypes=a.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=o(167),a=i(s),c=o(170),l=i(c),u=function(){function e(t,o){n(this,e),this._ui=t,this._fonts=o,this._loadedFonts=[]}return e.prototype.setFonts=function(e){this._fonts=e},e.prototype.needsToLoad=function(){for(var e=this,t=0;t<this._fonts.length;t++){var o=function(t){var o=void 0;return e._fonts[t].getVariations().forEach(function(e){o=o||e.getProvider()}),o?{v:!0}:"continue"}(t);switch(o){case"continue":continue;default:if("object"===(void 0===o?"undefined":r(o)))return o.v}}},e.prototype.fontLoaded=function(e){var t=e.getFontFamily();return-1!==this._loadedFonts.indexOf(t)},e.prototype.setFontLoaded=function(e){if(!this.fontLoaded(e)){var t=e.getFontFamily();this._loadedFonts.push(t)}},e.prototype.load=function(){var e=this,t=this._fonts,o={google:new a.default(this._ui),file:new l.default(this._ui)},i=function(){for(var e in o){o[e].dispose()}};t.filter(function(t){return!e.fontLoaded(t)}).forEach(function(e){e.getVariations().forEach(function(e){var t=e.getProvider();if(t){o[t].add(e)}})});var n=[];for(var r in o)n.push(o[r].load());return Promise.all(n).then(function(){i(),t.forEach(function(t){e.setFontLoaded(t)})}).catch(function(e){throw i(),e})},e}();t.default=u},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(53),c=i(a),l=o(55),u=i(l),p=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.prototype._serializeSticker=function(t,o){var i=t.getInputDimensions(!1),n=e.prototype._serializeSticker.call(this,t,o);return"none"!==o.getTintMode()&&(n.options.tintColor=o.serializeOption("tintColor",!0)),n.options.dimensions=o.getDimensions().clone().divide(i.min()).toObject(),n.options.identifier=n.options.name,delete n.options.name,n},t.prototype._serializePath=function(t){var o=e.prototype._serializePath.call(this,t),i=t.getBrush();return i.hasOption("hardness")&&(o.hardness=i.getOption("hardness")),o},t.prototype._serializeOperation=function(t,o){return"frame"===t.constructor.identifier?(this._serializeFrameOperation(t,o),null):"overlay"===t.constructor.identifier?(this._serializeOverlayOperation(t,o),null):e.prototype._serializeOperation.call(this,t,o)},t.prototype._serializeFrameOperation=function(e,t){var o=t.filter(function(e){return"sprite"===e.type}),i=void 0;o.length?i=o.pop():(i={type:"sprite",options:{sprites:[]}},t.push(i)),i.options.sprites.push({type:"frame",options:this._getFrameOptions(e)})},t.prototype._serializeOverlayOperation=function(e,t){if(e.getIdentifier()){var o=t.filter(function(e){return"sprite"===e.type}),i=void 0;o.length?i=o.pop():(i={type:"sprite",options:{sprites:[]}},t.push(i)),i.options.sprites.push({type:"overlay",options:{identifier:e.getIdentifier(),intensity:e.getAlpha(),blendMode:u.default[e.getBlendMode()]}})}},t.prototype._getFrameOptions=function(e){return{identifier:e.getFrame().identifier}},t.prototype._serializeOrientationOperation=function(t){var o=e.prototype._serializeOrientationOperation.call(this,t);return 90!==o.options.rotation&&270!==o.options.rotation||(o.options.flipHorizontally=!o.options.flipHorizontally,o.options.flipVertically=!o.options.flipVertically),o},t.prototype._serializeTransformOperation=function(t){var o=this._editor.operations;if(o.exists("orientation")){t=t.clone();var i=o.get("orientation");t.rotate(-i.getRotation()),i.getFlipVertically()&&(t.flip("vertical"),t.setRotation(-1*t.getRotation())),i.getFlipHorizontally()&&(t.flip("horizontal"),t.setRotation(-1*t.getRotation()))}var n=e.prototype._serializeTransformOperation.call(this,t);return n.type="transform",n},t.prototype._serializeText=function(t,o){var i=e.prototype._serializeText.call(this,t,o),n=t.getInputDimensions(!1);return i.options.fontIdentifier=o.getFontIdentifier(),i.options.maxWidth=i.options.maxWidth*n.x/n.min(),delete i.options.fontFamily,i},t.prototype._serializeFilterOperation=function(t){var o=e.prototype._serializeFilterOperation.call(this,t);return o?(o.options.identifier=o.options.name,delete o.options.name,o):null},t.prototype._serializeRadialFocusOperation=function(t){var o=e.prototype._serializeRadialFocusOperation.call(this,t),i=o.options.options;return i.start=i.position,delete i.position,i.end={x:i.start.x+i.radius,y:i.start.y},delete i.radius,o},t}(c.default);t.default=p,p.version="2.0.0"},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(54),l=i(c),u=o(48),p=i(u),f=o(173),h=i(f),d=o(11),m=i(d),_=o(49),g=i(_),y=o(29),b=i(y),v=o(22),E=i(v),w=o(55),k=i(w),S=a.SDKUtils.flipObject(k.default),O=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var a=r(this,e.call.apply(e,[this].concat(i)));a._frameManager=new p.default(a._ui,a._getOptions("frame"));var c=a._getOptions("overlay");return c&&(a._overlayManager=new h.default(a._ui,c)),a}return s(t,e),t.prototype._deserializeSprite=function(t,o){return"frame"===o.type?this._deserializeFrame(t,o):"overlay"===o.type?this._deserializeOverlay(t,o):e.prototype._deserializeSprite.call(this,t,o)},t.prototype._deserializeOperation=function(t){return"transform"===t.type?this._deserializeTransformOperation(t):e.prototype._deserializeOperation.call(this,t)},t.prototype._deserializeOrientationOperation=function(t){return 90!==t.options.rotation&&270!==t.options.rotation||(t.options.flipHorizontally=!t.options.flipHorizontally,t.options.flipVertically=!t.options.flipVertically),e.prototype._deserializeOrientationOperation.call(this,t)},t.prototype._deserializeTransformOperation=function(t){var o=this;return e.prototype._deserializeCropOperation.call(this,t).then(function(e){if(e){var t=o._data.operations.orientation;if(t){var i=t.options;e.rotate(i.rotation),i.flipHorizontally&&(e.flip("horizontal"),e.setRotation(-1*e.getRotation())),i.flipVertically&&(e.flip("vertical"),e.setRotation(-1*e.getRotation()))}return e}})},t.prototype._deserializeFrame=function(e,t){var o=this,i=t.options.identifier,n=this._frameManager.getFrameByIdentifier(i);if(!n)return a.Log.warn("Deserializer","Unknown frame `"+i+"`. Skipping frame."),Promise.resolve();var r=new g.default(this._ui,n);return r.load().then(function(){o._editor.operations.getOrCreate("frame",{frame:r.getFrame()})})},t.prototype._deserializeOverlay=function(e,t){var o=this,i=t.options,n=i.blendMode,r=i.intensity,s=i.identifier,c=this._overlayManager.getOverlayByIdentifier(s);if(!c)return a.Log.warn("Deserializer","Unknown overlay `"+s+"`. Skipping overlay."),Promise.resolve();var l=this._editor.getUI().getAssetPath(c.image);return E.default.load(l).then(function(e){o._editor.operations.getOrCreate("overlay",{alpha:r,identifier:s,blendMode:parseInt(S[n||c.blendMode],10),image:e})})},t.prototype._createBrushForPath=function(t){var o=e.prototype._createBrushForPath.call(this,t);return void 0!==t.hardness&&o.hasOption("hardness")&&o.setHardness(t.hardness),o},t.prototype._deserializeSticker=function(e,t){var o=this,i=a.SDK.Operations.SpriteOperation,n=t.options,r=this._stickerManager.getStickerByIdentifier(n.identifier),s=m.default.getURLForSticker(r,"base");if(!r)return a.Log.warn("Deserializer","Unknown sticker `"+n.identifier+"`. Skipping sprite."),Promise.resolve();var c=e.getInputDimensions(!1);return new Promise(function(t,l){var u=new window.Image;u.addEventListener("load",function(){var o=i.StickerSprite.prototype.availableOptions.adjustments.structure,s=n.rotation,l=n.flipHorizontally,p=n.flipVertically,f={identifier:n.identifier,image:u,position:a.Vector2.fromObject(n.position),dimensions:a.Vector2.fromObject(n.dimensions).multiply(c.min()),rotation:s,flipHorizontally:l,flipVertically:p,adjustments:{}};void 0!==n.adjustments&&["brightness","contrast","saturation"].forEach(function(e){void 0!==n.adjustments[e]&&(f.adjustments[e]=n.adjustments[e]+o[e].default)}),void 0!==n.tintColor&&void 0!==r.tintMode&&(f.tintColor=a.Color.fromArray(n.tintColor),f.tintMode=r.tintMode),t(e.createSticker(f))}),u.crossOrigin="Anonymous",u.src=o._editor.getUI().getAssetPath(s)})},t.prototype._deserializeFilterOperation=function(e){var t=this,o=e.options;return this._filterManager.getFilterByIdentifier(o.identifier)?this._filterManager.instantiateFilterWithIdentifier(o.identifier).then(function(e){var i=t._editor.operations.getOrCreate("filter");if(i)return i.set({identifier:o.identifier,filter:e,intensity:o.intensity}),i}):(a.Log.warn("Deserializer","Unknown filter `"+o.identifier+"`"),Promise.resolve())},t.prototype._deserializeFocusOperation=function(t){var o=t.options,i=o.options;if("radial"!==o.type)return e.prototype._deserializeFocusOperation.call(this,t);var n=i.start,r=i.end,s=i.gradientRadius,c=i.blurRadius,l=a.Vector2.fromObject(r).subtract(a.Vector2.fromObject(n)).len();return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:a.Vector2.fromObject(n),radius:l,gradientRadius:s,blurRadius:c}))},t.prototype._deserializeText=function(e,t){var o=t.options,i=o.fontSize,n=o.lineHeight,r=o.fontIdentifier,s=o.alignment,c=o.rotation,l=o.maxWidth,u=o.color,p=o.backgroundColor,f=new b.default(this._ui),h=this._fontManager.getVariationByIdentifier(r);return h?f.setFonts([h.getFont()]):h=this._fontManager.getDefaultFont(),f.load().then(function(){var t=e.getInputDimensions(!1),r=l*t.min()/t.x;return e.createText({fontSize:i,lineHeight:n,fontFamily:h.getFontFamily(),fontWeight:h.getFontWeight(),fontIdentifier:h.getIdentifier(),alignment:s,rotation:c,maxWidth:r,text:o.text,color:a.Color.fromArray(u),backgroundColor:a.Color.fromArray(p),position:a.Vector2.fromObject(o.position)})})},t}(l.default);t.default=O,O.version="2.0.0"},function(e,t,o){if("production"!=={ENV:'"production"'}.NODE_ENV){var i="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,n=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===i};e.exports=o(60)(n,!0)}else e.exports=o(63)()},function(e,t,o){"use strict";var i=o(16),n=i;if("production"!=={ENV:'"production"'}.NODE_ENV){var r=function(e){for(var t=arguments.length,o=Array(t>1?t-1:0),i=1;i<t;i++)o[i-1]=arguments[i];var n=0,r="Warning: "+e.replace(/%s/g,function(){return o[n++]});"undefined"!=typeof console&&console.error(r);try{throw new Error(r)}catch(e){}};n=function(e,t){if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(0!==t.indexOf("Failed Composite propType: ")&&!e){for(var o=arguments.length,i=Array(o>2?o-2:0),n=2;n<o;n++)i[n-2]=arguments[n];r.apply(void 0,[t].concat(i))}}}e.exports=n},function(e,t,o){var i,n;/*!
  Copyright (c) 2016 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";function o(){for(var e=[],t=0;t<arguments.length;t++){var i=arguments[t];if(i){var n=typeof i;if("string"===n||"number"===n)e.push(i);else if(Array.isArray(i))e.push(o.apply(null,i));else if("object"===n)for(var s in i)r.call(i,s)&&i[s]&&e.push(s)}}return e.join(" ")}var r={}.hasOwnProperty;void 0!==e&&e.exports?e.exports=o:(i=[],void 0!==(n=function(){return o}.apply(t,i))&&(e.exports=n))}()},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),r=function(){function e(t,o,n){i(this,e),this._parent=t,this._type=o,this._name=n}return e.prototype.element=function(t){return new e(this,"element",t)},e.prototype.modifier=function(t){return new e(this,"modifier",t)},n(e,[{key:"str",get:function(){var e=this._parent?this._parent.str:"";switch(this._type){case"block":e+="pesdk-react-"+this._name;break;case"element":e+="__"+this._name;break;case"modifier":e+="--"+this._name}return e}}]),e}();t.default={block:function(e){return new r(null,"block",e)}}},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}function r(e){for(var t=[],o=0;o<e.length;o++)e[o]instanceof Array?t=t.concat(r(e[o])):t.push(e[o]);return t}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=o(15),c=i(a),l=o(34),u=i(l),p=o(35),f=i(p),h={b:"block",e:"element",m:"modifier"},d={_parseBemSpecifier:function(e){return e?e.split(" ").map(function(e){var t=e.match(/^(\$)?([bem]):(.*)$/i);if(!t)throw new Error("Invalid BEM specifier: "+e);var o=void 0!==t[1];return{type:h[t[2]],name:t[3],pass:o}}):[]},_getBemInfoForNode:function(e){var t="bem"===e.type,o=t?e.props.specifier:e.props.bem;if(t&&!o)throw new Error("<bem> elements should always have a `specifier` property");var i=this._parseBemSpecifier(o);return t&&i.forEach(function(e){e.pass=!0}),{data:i,isBemNode:t}},createElement:function(e,t){for(var o=arguments.length,i=Array(o>2?o-2:0),n=2;n<o;n++)i[n-2]=arguments[n];return t=t||{},i=i.filter(function(e){return null!==e&&void 0!==e}),{type:e,props:t,children:i}},_isNodeBEMable:function(e){return null!==e&&"object"===(void 0===e?"undefined":s(e))&&!c.default.isValidElement(e)},_applyBEMClasses:function(e){var t=this;if(!this._isNodeBEMable(e))return e;var o=e.props.className?[e.props.className]:[],i=this._getBemInfoForNode(e),n=e.props.__bemObject,s=e.props.__bemObject;i.data.forEach(function(e){if("block"===e.type)n=f.default.block(e.name),e.pass&&(s=f.default.block(e.name)),o.push(n.str);else if("element"===e.type){if(!n)throw new Error("Tried to create an element, but no parent block has been found.");n=n.element(e.name),e.pass&&(s=s.element(e.name)),o.push(n.str)}else if("modifier"===e.type){if(!n)throw new Error("Tried to create a modifier, but no parent block has been found.");e.pass&&(s=s.modifier(e.name)),o.push(n.modifier(e.name).str)}});var a=(0,u.default)(o);return a&&(e.props.className=a),e.children=r(e.children),e.children.forEach(function(e){t._isNodeBEMable(e)&&(e.props.__bemObject=s)}),e.children=e.children.map(function(e){return t._applyBEMClasses(e)}),e.children=r(e.children),delete e.props.__bemObject,delete e.props.bem,i.isBemNode&&(e=e.children instanceof Array&&1===e.children.length?e.children[0]:e.children),e},_transformToReact:function(e){var t=this;return this._isNodeBEMable(e)?(e.children=e.children.map(function(e){return t._transformToReact(e)}),c.default.createElement.apply(c.default,[e.type,e.props].concat(n(e.children)))):e},transform:function(e){return(e=this._applyBEMClasses(e))instanceof Array?e:e=this._transformToReact(e)}};t.default=d},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={DEFAULTS:{FILTERS:[{identifier:"imgly_filters_analog",defaultName:"Analog",filters:[{identifier:"imgly_lut_cool",defaultName:"Cool",lutImage:"filters/imgly_lut_cool_5_5_128.png"},{identifier:"imgly_lut_blues",defaultName:"Blues",lutImage:"filters/imgly_lut_blues_5_5_128.png"},{identifier:"imgly_lut_blueshadows",defaultName:"Blue Shadows",lutImage:"filters/imgly_lut_blueshadows_5_5_128.png"},{identifier:"imgly_lut_k6",defaultName:"K6",lutImage:"filters/imgly_lut_k6_5_5_128.png"},{identifier:"imgly_lut_kdynamic",defaultName:"KDynamic",lutImage:"filters/imgly_lut_kdynamic_5_5_128.png"},{identifier:"imgly_lut_lucid",defaultName:"Lucid",lutImage:"filters/imgly_lut_lucid_5_5_128.png"},{identifier:"imgly_lut_pale",defaultName:"Pale",lutImage:"filters/imgly_lut_pale_5_5_128.png"}]},{identifier:"imgly_filters_bw",defaultName:"Black & White",filters:[{identifier:"imgly_lut_sin",defaultName:"Sin",lutImage:"filters/imgly_lut_sin_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_ad1920",defaultName:"1920 A.D.",lutImage:"filters/imgly_lut_ad1920_5_5_128.png"},{identifier:"imgly_lut_bw",defaultName:"B & W",lutImage:"filters/imgly_lut_bw_5_5_128.png"},{identifier:"imgly_lut_litho",defaultName:"Litho",lutImage:"filters/imgly_lut_litho_5_5_128.png"},{identifier:"imgly_lut_plate",defaultName:"Plate",lutImage:"filters/imgly_lut_plate_5_5_128.png"},{identifier:"imgly_lut_x400",defaultName:"X400",lutImage:"filters/imgly_lut_x400_5_5_128.png"}]},{identifier:"imgly_filters_retro",defaultName:"Retro",filters:[{identifier:"imgly_lut_celsius",defaultName:"Celsius",lutImage:"filters/imgly_lut_celsius_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_k2",defaultName:"K2",lutImage:"filters/imgly_lut_k2_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_sepiahigh",defaultName:"Sepia High",lutImage:"filters/imgly_lut_sepiahigh_5_5_128.png"},{identifier:"imgly_lut_ancient",defaultName:"Ancient",lutImage:"filters/imgly_lut_ancient_5_5_128.png"},{identifier:"imgly_lut_classic",defaultName:"Classic",lutImage:"filters/imgly_lut_classic_5_5_128.png"},{identifier:"imgly_lut_eighties",defaultName:"Eighties",lutImage:"filters/imgly_lut_eighties_5_5_128.png"},{identifier:"imgly_lut_elder",defaultName:"Elder",lutImage:"filters/imgly_lut_elder_5_5_128.png"},{identifier:"imgly_lut_glam",defaultName:"Glam",lutImage:"filters/imgly_lut_glam_5_5_128.png"},{identifier:"imgly_lut_gobblin",defaultName:"Gobblin",lutImage:"filters/imgly_lut_gobblin_5_5_128.png"},{identifier:"imgly_lut_orchid",defaultName:"Orchid",lutImage:"filters/imgly_lut_orchid_5_5_128.png"},{identifier:"imgly_lut_seventies",defaultName:"Seventies",lutImage:"filters/imgly_lut_seventies_5_5_128.png"}]},{identifier:"imgly_filters_special",defaultName:"Special",filters:[{identifier:"imgly_lut_fixie",defaultName:"Fixie",lutImage:"filters/imgly_lut_fixie_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_colorful",defaultName:"Colorful",lutImage:"filters/imgly_lut_colorful_5_5_128.png"},{identifier:"imgly_lut_cottoncandy",defaultName:"Cotton Candy",lutImage:"filters/imgly_lut_cottoncandy_5_5_128.png"},{identifier:"imgly_lut_food",defaultName:"Food",lutImage:"filters/imgly_lut_food_5_5_128.png"},{identifier:"imgly_lut_highcontrast",defaultName:"High Contrast",lutImage:"filters/imgly_lut_highcontrast_5_5_128.png"},{identifier:"imgly_lut_k1",defaultName:"K1",lutImage:"filters/imgly_lut_k1_5_5_128.png"},{identifier:"imgly_lut_lomo100",defaultName:"Lomo 100",lutImage:"filters/imgly_lut_lomo100_5_5_128.png"},{identifier:"imgly_lut_neat",defaultName:"Neat",lutImage:"filters/imgly_lut_neat_5_5_128.png"},{identifier:"imgly_lut_nogreen",defaultName:"No Green",lutImage:"filters/imgly_lut_nogreen_5_5_128.png"},{identifier:"imgly_lut_pola669",defaultName:"Pola 669",lutImage:"filters/imgly_lut_pola669_5_5_128.png"},{identifier:"imgly_lut_polasx",defaultName:"Pola SX",lutImage:"filters/imgly_lut_polasx_5_5_128.png"},{identifier:"imgly_lut_pro400",defaultName:"Pro 400",lutImage:"filters/imgly_lut_pro400_5_5_128.png"},{identifier:"imgly_lut_twilight",defaultName:"Twilight",lutImage:"filters/imgly_lut_twilight_5_5_128.png"},{identifier:"imgly_lut_settled",defaultName:"Settled",lutImage:"filters/imgly_lut_settled_5_5_128.png"},{identifier:"imgly_lut_steel",defaultName:"Steel",lutImage:"filters/imgly_lut_steel_5_5_128.png"}]},{identifier:"imgly_filters_summer",defaultName:"Summer",filters:[{identifier:"imgly_lut_texas",defaultName:"Texas",lutImage:"filters/imgly_lut_texas_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_mellow",defaultName:"Mellow",lutImage:"filters/imgly_lut_mellow_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_chest",defaultName:"Chest",lutImage:"filters/imgly_lut_chest_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_creamy",defaultName:"Creamy",lutImage:"filters/imgly_lut_creamy_5_5_128.png"},{identifier:"imgly_lut_evening",defaultName:"Evening",lutImage:"filters/imgly_lut_evening_5_5_128.png"},{identifier:"imgly_lut_fall",defaultName:"Fall",lutImage:"filters/imgly_lut_fall_5_5_128.png"},{identifier:"imgly_lut_front",defaultName:"Front",lutImage:"filters/imgly_lut_front_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_highcarb",defaultName:"High Carb",lutImage:"filters/imgly_lut_highcarb_5_5_128.png"},{identifier:"imgly_lut_keen",defaultName:"Keen",lutImage:"filters/imgly_lut_keen_5_5_128.png"},{identifier:"imgly_lut_pitched",defaultName:"Pitched",lutImage:"filters/imgly_lut_pitched_5_5_128.png"},{identifier:"imgly_lut_soft",defaultName:"Soft",lutImage:"filters/imgly_lut_soft_5_5_128.png"},{identifier:"imgly_lut_summer",defaultName:"Summer",lutImage:"filters/imgly_lut_summer_5_5_128.png"},{identifier:"imgly_lut_sunset",defaultName:"Sunset",lutImage:"filters/imgly_lut_sunset_5_5_128.png"},{identifier:"imgly_lut_tender",defaultName:"Tender",lutImage:"filters/imgly_lut_tender_5_5_128.png"}]},{identifier:"imgly_filters_winter",defaultName:"Winter",filters:[{identifier:"imgly_lut_fridge",defaultName:"Fridge",lutImage:"filters/imgly_lut_fridge_8_8_512.png",resolution:512,horizontalTileCount:8,verticalTileCount:8},{identifier:"imgly_lut_bleached",defaultName:"Bleached",lutImage:"filters/imgly_lut_bleached_5_5_128.png"},{identifier:"imgly_lut_bleachedblue",defaultName:"Bleached Blue",lutImage:"filters/imgly_lut_bleachedblue_5_5_128.png"},{identifier:"imgly_lut_breeze",defaultName:"Breeze",lutImage:"filters/imgly_lut_breeze_5_5_128.png"},{identifier:"imgly_lut_lenin",defaultName:"Lenin",lutImage:"filters/imgly_lut_lenin_5_5_128.png"},{identifier:"imgly_lut_quozi",defaultName:"Quozi",lutImage:"filters/imgly_lut_quozi_5_5_128.png"},{identifier:"imgly_lut_winter",defaultName:"Winter",lutImage:"filters/imgly_lut_winter_5_5_128.png"}]}],OVERLAYS:[{identifier:"imgly_overlay_golden",defaultName:"Golden",image:"overlays/imgly_overlay_golden.jpg",thumbnail:"overlays/imgly_overlay_golden_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_bokeh",defaultName:"Bokeh",image:"overlays/imgly_overlay_bokeh.jpg",thumbnail:"overlays/imgly_overlay_bokeh_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_hearts",defaultName:"Hearts",image:"overlays/imgly_overlay_hearts.jpg",thumbnail:"overlays/imgly_overlay_hearts_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak1",defaultName:"Light Leak",image:"overlays/imgly_overlay_lightleak1.jpg",thumbnail:"overlays/imgly_overlay_lightleak1_thumb.jpg",blendMode:"screen"},{identifier:"imgly_overlay_lightleak2",defaultName:"Light Leak 2",image:"overlays/imgly_overlay_lightleak2.jpg",thumbnail:"overlays/imgly_overlay_lightleak2_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_rain",defaultName:"Rain",image:"overlays/imgly_overlay_rain.jpg",thumbnail:"overlays/imgly_overlay_rain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_wood",defaultName:"Wood",image:"overlays/imgly_overlay_wood.jpg",thumbnail:"overlays/imgly_overlay_wood_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_mosaic",defaultName:"Mosaic",image:"overlays/imgly_overlay_mosaic.jpg",thumbnail:"overlays/imgly_overlay_mosaic_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_chop",defaultName:"Chop",image:"overlays/imgly_overlay_chop.jpg",thumbnail:"overlays/imgly_overlay_chop_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_vintage",defaultName:"Vintage",image:"overlays/imgly_overlay_vintage.jpg",thumbnail:"overlays/imgly_overlay_vintage_thumb.jpg",blendMode:"darken"},{identifier:"imgly_overlay_metal",defaultName:"Metal",image:"overlays/imgly_overlay_metal.jpg",thumbnail:"overlays/imgly_overlay_metal_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_paper",defaultName:"Paper",image:"overlays/imgly_overlay_paper.jpg",thumbnail:"overlays/imgly_overlay_paper_thumb.jpg",blendMode:"multiply"},{identifier:"imgly_overlay_painting",defaultName:"Painting",image:"overlays/imgly_overlay_painting.jpg",thumbnail:"overlays/imgly_overlay_painting_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_grain",defaultName:"Grain",image:"overlays/imgly_overlay_grain.jpg",thumbnail:"overlays/imgly_overlay_grain_thumb.jpg",blendMode:"overlay"},{identifier:"imgly_overlay_clouds",defaultName:"Clouds",image:"overlays/imgly_overlay_clouds.jpg",thumbnail:"overlays/imgly_overlay_clouds_thumb.jpg",blendMode:"softLight"},{identifier:"imgly_overlay_wall1",defaultName:"Wall",image:"overlays/imgly_overlay_wall1.jpg",thumbnail:"overlays/imgly_overlay_wall1_thumb.jpg",blendMode:"lighten"},{identifier:"imgly_overlay_wall2",defaultName:"Wall 2",image:"overlays/imgly_overlay_wall2.jpg",thumbnail:"overlays/imgly_overlay_wall2_thumb.jpg",blendMode:"overlay"}],FRAME_CATEGORIES:[{identifier:"imgly_frame_generic",defaultName:"Generic",metaData:{backgroundImage:"frames/generic.png"},frames:[{identifier:"imgly_frame_dia",defaultName:"Dia",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_dia/imgly_frame_dia_thumb.png",imageGroups:{top:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_top.png",mode:"repeat"}},left:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_left.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_left.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_left.png"},right:{start:"frames/imgly_frame_dia/imgly_frame_dia_top_corner_right.png",mid:"frames/imgly_frame_dia/imgly_frame_dia_right.png",end:"frames/imgly_frame_dia/imgly_frame_dia_bottom_corner_right.png"},bottom:{mid:{image:"frames/imgly_frame_dia/imgly_frame_dia_bottom.png",mode:"repeat"}}}},{identifier:"imgly_frame_art_decor",defaultName:"Art Decor",tintable:!0,layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_art_decor/imgly_frame_art_decor_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_left.png",mid:{image:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom.png",mode:"stretch"},end:"frames/imgly_frame_art_decor/imgly_frame_art_decor_bottom_corner_right.png"}}},{identifier:"imgly_frame_black_passepartout",defaultName:"Black Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_black_passepartout/imgly_frame_black_passepartout_bottom_corner_right.png"}}},{identifier:"imgly_frame_lowpoly_shadow",defaultName:"Low Poly",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_left.png",mid:{image:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom.png",mode:"stretch"},end:"frames/imgly_frame_lowpoly_shadow/imgly_frame_lowpoly_shadow_bottom_corner_right.png"}}},{identifier:"imgly_frame_wood_passepartout",defaultName:"Wood Passepartout",layoutMode:"horizontal-inside",thumbnail:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_thumb.png",imageGroups:{top:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_top_corner_right.png"},left:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_left.png",mode:"stretch"}},right:{mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_right.png",mode:"stretch"}},bottom:{start:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_left.png",mid:{image:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom.png",mode:"stretch"},end:"frames/imgly_frame_wood_passepartout/imgly_frame_wood_passepartout_bottom_corner_right.png"}}}]}],STICKER_CATEGORIES:[{identifier:"imgly_sticker_emoticons",defaultName:"Emoticons",metaData:{backgroundImage:"stickers/emoticons/background.png"},stickers:[{identifier:"imgly_sticker_emoticons_alien",defaultName:"Alien",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_alien.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_alien.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_alien.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_angel",defaultName:"Angel",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angel.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angel.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angel.png"],width:62,height:64}}},{identifier:"imgly_sticker_emoticons_angry",defaultName:"Angry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_angry.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_angry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_angry.png"],width:62,height:62}}},{identifier:"imgly_sticker_emoticons_anxious",defaultName:"Anxious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_anxious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_anxious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_anxious.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_asleep",defaultName:"Asleep",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_asleep.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_asleep.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_asleep.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_attention",defaultName:"Attention",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_attention.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_attention.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_attention.png"],width:62,height:60}}},{identifier:"imgly_sticker_emoticons_baby_chicken",defaultName:"Baby Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_baby_chicken.png"],width:61,height:42},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_baby_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_baby_chicken.png"],width:61,height:42}}},{identifier:"imgly_sticker_emoticons_batman",defaultName:"Batman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_batman.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_batman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_batman.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_beer",defaultName:"Beer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_beer.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_beer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_beer.png"],width:62,height:59}}},{identifier:"imgly_sticker_emoticons_blush",defaultName:"Blush",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_blush.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_blush.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_blush.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_boxer",defaultName:"Boxer",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_boxer.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_boxer.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_boxer.png"],width:62,height:62}}},{identifier:"imgly_sticker_emoticons_business",defaultName:"Business",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_business.png"],width:60,height:63},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_business.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_business.png"],width:60,height:63}}},{identifier:"imgly_sticker_emoticons_chicken",defaultName:"Chicken",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_chicken.png"],width:63,height:55},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_chicken.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_chicken.png"],width:63,height:55}}},{identifier:"imgly_sticker_emoticons_cool",defaultName:"Cool",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cool.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cool.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cool.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_cry",defaultName:"Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_cry.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_cry.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_deceased",defaultName:"Deceased",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_deceased.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_deceased.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_deceased.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_devil",defaultName:"Devil",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_devil.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_devil.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_devil.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_duckface",defaultName:"Duckface",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_duckface.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_duckface.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_duckface.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_furious",defaultName:"Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_furious.png"],width:62,height:61},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_furious.png"],width:62,height:61}}},{identifier:"imgly_sticker_emoticons_grin",defaultName:"Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_grin.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_guitar",defaultName:"Guitar",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_guitar.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_guitar.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_guitar.png"],width:64,height:60}}},{identifier:"imgly_sticker_emoticons_harry_potter",defaultName:"Harry Potter",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_harry_potter.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_harry_potter.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_harry_potter.png"],width:64,height:62}}},{identifier:"imgly_sticker_emoticons_hippie",defaultName:"Hippie",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hippie.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hippie.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hippie.png"],width:62,height:62}}},{identifier:"imgly_sticker_emoticons_hitman",defaultName:"Hitman",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_hitman.png"],width:64,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_hitman.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_hitman.png"],width:64,height:60}}},{identifier:"imgly_sticker_emoticons_humourous",defaultName:"Humourous",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_humourous.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_humourous.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_humourous.png"],width:64,height:64}}},{identifier:"imgly_sticker_emoticons_idea",defaultName:"Idea",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_idea.png"],width:64,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_idea.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_idea.png"],width:64,height:62}}},{identifier:"imgly_sticker_emoticons_impatient",defaultName:"Impatient",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_impatient.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_impatient.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_impatient.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_kiss",defaultName:"Kiss",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kiss.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kiss.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kiss.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_kisses",defaultName:"Kisses",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_kisses.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_kisses.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_kisses.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_laugh",defaultName:"Laugh",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_laugh.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_laugh.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_laugh.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_loud_cry",defaultName:"Loud Cry",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loud_cry.png"],width:64,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loud_cry.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loud_cry.png"],width:64,height:58}}},{identifier:"imgly_sticker_emoticons_loving",defaultName:"Loving",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_loving.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_loving.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_loving.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_masked",defaultName:"Masked",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_masked.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_masked.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_masked.png"],width:62,height:62}}},{identifier:"imgly_sticker_emoticons_music",defaultName:"Music",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_music.png"],width:62,height:54},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_music.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_music.png"],width:62,height:54}}},{identifier:"imgly_sticker_emoticons_nerd",defaultName:"Nerd",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_nerd.png"],width:64,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_nerd.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_nerd.png"],width:64,height:58}}},{identifier:"imgly_sticker_emoticons_ninja",defaultName:"Ninja",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_ninja.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_ninja.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_ninja.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_not_speaking_to_you",defaultName:"Not Speaking To You",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_not_speaking_to_you.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_not_speaking_to_you.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_not_speaking_to_you.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_pig",defaultName:"Pig",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pig.png"],width:63,height:41},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pig.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pig.png"],width:63,height:41}}},{identifier:"imgly_sticker_emoticons_pumpkin",defaultName:"Pumpkin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_pumpkin.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_pumpkin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_pumpkin.png"],width:62,height:60}}},{identifier:"imgly_sticker_emoticons_question",defaultName:"Question",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_question.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_question.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_question.png"],width:62,height:62}}},{identifier:"imgly_sticker_emoticons_rabbit",defaultName:"Rabbit",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_rabbit.png"],width:65,height:47},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_rabbit.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_rabbit.png"],width:65,height:47}}},{identifier:"imgly_sticker_emoticons_sad",defaultName:"Sad",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sad.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sad.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sad.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_sick",defaultName:"Sick",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sick.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sick.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sick.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_skateboard",defaultName:"Skateboard",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skateboard.png"],width:62,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skateboard.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skateboard.png"],width:62,height:64}}},{identifier:"imgly_sticker_emoticons_skull",defaultName:"Skull",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_skull.png"],width:62,height:62},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_skull.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_skull.png"],width:62,height:62}}},{identifier:"imgly_sticker_emoticons_sleepy",defaultName:"Sleepy",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sleepy.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sleepy.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sleepy.png"],width:62,height:60}}},{identifier:"imgly_sticker_emoticons_smile",defaultName:"Smile",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smile.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smile.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smile.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_smoking",defaultName:"Smoking",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_smoking.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_smoking.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_smoking.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_sobbing",defaultName:"Sobbing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sobbing.png"],width:62,height:59},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sobbing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sobbing.png"],width:62,height:59}}},{identifier:"imgly_sticker_emoticons_star",defaultName:"Star",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_star.png"],width:64,height:64},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_star.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_star.png"],width:64,height:64}}},{identifier:"imgly_sticker_emoticons_steaming_furious",defaultName:"Steaming Furious",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_steaming_furious.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_steaming_furious.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_steaming_furious.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_sunbathing",defaultName:"Sunbathing",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_sunbathing.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_sunbathing.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_sunbathing.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_tired",defaultName:"Tired",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tired.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tired.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tired.png"],width:62,height:60}}},{identifier:"imgly_sticker_emoticons_tongue_out_wink",defaultName:"Tongue Out Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_tongue_out_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_tongue_out_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_tongue_out_wink.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_wave",defaultName:"Wave",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wave.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wave.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wave.png"],width:62,height:60}}},{identifier:"imgly_sticker_emoticons_wide_grin",defaultName:"Wide Grin",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wide_grin.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wide_grin.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wide_grin.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_wink",defaultName:"Wink",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wink.png"],width:62,height:58},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wink.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wink.png"],width:62,height:58}}},{identifier:"imgly_sticker_emoticons_wrestler",defaultName:"Wrestler",images:{mediaThumb:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/thumbs/imgly_sticker_emoticons_wrestler.png"],width:62,height:60},mediaBase:{uris:["stickers/emoticons/stickers/imgly_sticker_emoticons_wrestler.svg","stickers/emoticons/stickers/base/imgly_sticker_emoticons_wrestler.png"],width:62,height:60}}}]},{identifier:"imgly_sticker_shapes",defaultName:"Shapes",metaData:{backgroundImage:"stickers/shapes/background.png"},stickers:[{identifier:"imgly_sticker_shapes_arrow_02",defaultName:"Arrow 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_02.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_02.png"],width:2e3,height:1236}}},{identifier:"imgly_sticker_shapes_arrow_03",defaultName:"Arrow 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_arrow_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_arrow_03.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_01",defaultName:"Badge 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_01.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_04",defaultName:"Badge 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_04.png"],width:2e3,height:1589}}},{identifier:"imgly_sticker_shapes_badge_06",defaultName:"Badge 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_06.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_06.png"],width:2e3,height:1733}}},{identifier:"imgly_sticker_shapes_badge_08",defaultName:"Badge 4",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_08.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_08.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_11",defaultName:"Badge 5",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_11.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_11.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_12",defaultName:"Badge 6",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_12.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_12.png"],width:2001,height:1903}}},{identifier:"imgly_sticker_shapes_badge_13",defaultName:"Badge 7",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_13.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_13.png"],width:2e3,height:1718}}},{identifier:"imgly_sticker_shapes_badge_15",defaultName:"Badge 8",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_15.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_15.png"],width:1618,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_18",defaultName:"Badge 9",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_18.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_18.png"],width:1198,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_19",defaultName:"Badge 10",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_19.png"],width:2127,height:481},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_19.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_19.png"],width:2127,height:481}}},{identifier:"imgly_sticker_shapes_badge_20",defaultName:"Badge 11",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_20.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_20.png"],width:2e3,height:1404}}},{identifier:"imgly_sticker_shapes_badge_28",defaultName:"Badge 12",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_28.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_28.png"],width:2e3,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_32",defaultName:"Badge 13",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_32.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_32.png"],width:1960,height:2e3}}},{identifier:"imgly_sticker_shapes_badge_35",defaultName:"Badge 14",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_35.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_35.png"],width:2e3,height:2002}}},{identifier:"imgly_sticker_shapes_badge_36",defaultName:"Badge 15",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_badge_36.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_badge_36.png"],width:2e3,height:1668}}},{identifier:"imgly_sticker_shapes_spray_01",defaultName:"Spray 1",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_01.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_01.png"],width:1912,height:2039}}},{identifier:"imgly_sticker_shapes_spray_03",defaultName:"Spray 2",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_03.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_03.png"],width:1681,height:1779}}},{identifier:"imgly_sticker_shapes_spray_04",defaultName:"Spray 3",tintMode:"solid",images:{mediaThumb:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/thumbs/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248},mediaBase:{uris:["stickers/shapes/stickers/imgly_sticker_shapes_spray_04.svg","stickers/shapes/stickers/base/imgly_sticker_shapes_spray_04.png"],width:1407,height:2248}}}]}]}}},function(e,t,o){(function(t){(function(){var o,i,n;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:void 0!==t&&null!==t&&t.hrtime?(e.exports=function(){return(o()-n)/1e6},i=t.hrtime,o=function(){var e;return e=i(),1e9*e[0]+e[1]},n=o()):Date.now?(e.exports=function(){return Date.now()-n},n=Date.now()):(e.exports=function(){return(new Date).getTime()-n},n=(new Date).getTime())}).call(this)}).call(t,o(20))},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a._bindAll("_onClick"),a}return r(t,e),t.prototype._onClick=function(){this.props.onClick&&this.props.onClick(this.props.searchSuggestion)},t.prototype.renderWithBEM=function(){var e=this.props.searchSuggestion,t={backgroundImage:"url("+e.coverImage+")"};return s.ReactBEM.createElement("bem",{specifier:"b:photoRoll e:libraryList"},s.ReactBEM.createElement("li",{bem:"e:item",style:t,onClick:this._onClick},s.ReactBEM.createElement("div",{bem:"e:overlay"}),s.ReactBEM.createElement("div",{bem:"e:name"},e.query)))},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(1),l=i(c),u=o(97),p=i(u),f=o(2),h=i(f),d=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var a=r(this,e.call.apply(e,[this].concat(i)));return a._needsStyleFixes=!0,a._totalPhotosHeight=0,a.state={loading:!1,photos:[]},a}return s(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._loadPhotos()},t.prototype.componentDidUpdate=function(){this.refs.scrollbar&&this.refs.scrollbar.update()},t.prototype._onPhotoClicked=function(e){this.props.onPhotoClicked&&this.props.onPhotoClicked(e)},t.prototype._getHeadline=function(){return this.props.library.name},t.prototype.fixStyles=function(){if(a.Utils.Browser.isIElte(11)){var e=this.refs.cell,t=this.refs.scrollbar.getList();if(!e||!t)return;var o=e.offsetHeight;t.style.height=o+"px"}this.refs.scrollbar&&this.refs.scrollbar.update()},t.prototype._renderColumns=function(){for(var e=this,t=this.state.photos,o=[],i=[],n=0;n<3;n++)i.push([]),o.push(0);return t.forEach(function(t){for(var n=t.dimensions,r=null,s=1/0,c=0;c<3;c++)o[c]<s&&(r=c,s=o[c]);i[r].push(a.ReactBEM.createElement(p.default,{photo:t.obj,onClick:e._onPhotoClicked.bind(e,t.obj)})),o[r]+=n.y}),i},t.prototype._renderPhotos=function(){var e=this._renderColumns();return a.ReactBEM.createElement("div",{bem:"$b:photoRoll e:row m:fullHeight"},a.ReactBEM.createElement("div",{bem:"e:cell",ref:"cell"},a.ReactBEM.createElement(h.default,{direction:"vertical",ref:"scrollbar"},a.ReactBEM.createElement("div",{bem:"e:container",ref:"container"},a.ReactBEM.createElement("div",{bem:"e:innerContainer"},a.ReactBEM.createElement("div",{bem:"e:headline"},this._getHeadline()),a.ReactBEM.createElement("bem",{specifier:"e:photoList"},e.map(function(e){return a.ReactBEM.createElement("ul",{bem:"$e:list"},e)})))))))},t.prototype._loadPhotos=function(){var e=this;this._totalPhotosHeight=0;var t=l.default.instance.displayProgress(this._t("loading.loading"));(new(0,this.context.options.photoRoll.provider)).getPhotosForLibrary(this.props.library).then(function(o){return e._preloadPhotos(o,t)}).then(function(o){e.setState({photos:o,loading:!1}),t.close()}).catch(function(o){t.close(),l.default.instance.displayError(e._t("errors.photoRollLoadFail.title"),e._t("errors.photoRollLoadFail.text",{error:o.message}))})},t.prototype._preloadPhotos=function(e,t){var o=this,i=e.length,n=0;return Promise.all(e.map(function(e){return o._preloadPhoto(e).then(function(r){var s=new a.Vector2(r.width,r.height);return s.multiply(240/r.width),o._totalPhotosHeight+=s.y,n++,t.setData({progress:n/i}),{obj:e,dimensions:s}})}))},t.prototype._preloadPhoto=function(e){return new Promise(function(t,o){var i=new window.Image;i.addEventListener("load",function(){t(i)}),i.addEventListener("error",function(){t(i)}),i.crossOrigin="Anonymous",i.src=e.urls.thumb})},t.prototype.renderWithBEM=function(){return this.state.loading?a.ReactBEM.createElement("div",null):this._renderPhotos()},t}(a.BaseComponent);t.default=d,d.contextTypes=a.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(3),l=i(c),u=o(2),p=i(u),f=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var a=r(this,e.call.apply(e,[this].concat(i)));return a._hasBackButton=!1,a}return s(t,e),t.prototype._onItemClick=function(e){this.props.onSwitchControls(e)},t.prototype._renderListItems=function(){var e=this,t=this.context.editor,o=[],i=function(o){var i=t.controls.get(o);return a.ReactBEM.createElement("li",{bem:"e:item",key:i.identifier,"data-identifier":i.identifier,onClick:e._onItemClick.bind(e,i)},a.ReactBEM.createElement("bem",{specifier:"$b:controls"},a.ReactBEM.createElement("div",{bem:"$e:button m:withLabel"},a.ReactBEM.createElement("img",{bem:"e:icon",src:e._getAssetPath(i.iconPath,!0)}),a.ReactBEM.createElement("div",{bem:"e:label"},e._t(i.languageKey)))))};this.context.options.editor.controlsOrder.forEach(function(e){if(Array.isArray(e)){var n=e,r=[];n.forEach(function(e){t.controls.isEnabled(e)&&r.push(i(e))}),r.length&&o.push(r)}else{var s=e;if(!t.controls.isEnabled(s))return;o.push(i(s))}});var n=[];return o.forEach(function(e){n=n.concat(e),e!==o[o.length-1]&&n.push(a.ReactBEM.createElement("li",{bem:"e:separator"}))}),n},t.prototype.renderControls=function(){var e=this._renderListItems();return a.ReactBEM.createElement("div",{bem:"e:cell m:list"},a.ReactBEM.createElement(p.default,null,a.ReactBEM.createElement("ul",{bem:"$e:list"},e)))},t}(l.default);t.default=f,f.contextTypes=l.default.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(114),l=i(c),u=o(116),p=i(u),f=o(117),h=i(f),d=o(118),m=i(d),_=o(162),g=i(_),y=o(163),b=i(y),v=o(164),E=i(v),w=function(e){function t(o,i,s){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n(this,t);var c=r(this,e.call(this));return c._ui=o,c._options=i,c._mediator=s,c._ready=!1,c._padding=[0,0,0,0],c._shallow=a,a||(c._initSDK(),c._onZoom=c._onZoom.bind(c),c._onUndo=c._onUndo.bind(c),c.history=new E.default(c,c._sdk,c._mediator),c.history.on("undo",c._onUndo),c.zoom=new b.default(c,c._sdk,c._mediator),c.zoom.on("set",c._onZoom),c._initSerializers()),c.operations=new h.default(c,c._sdk,c._mediator),c.controls=new m.default(c,c._sdk,c._mediator),c.features=new g.default(c,c._sdk,c._mediator),c._running=!1,c._renderRequested=!0,c._renderCallbacks=[],c._animationFrameRequest=null,c.render=c.render.bind(c),c._tick=c._tick.bind(c),c}return s(t,e),t.prototype.setImage=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._options.editor.image,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this._sdk.getRenderer(),n=new a.Vector2(t.naturalWidth,t.naturalHeight),r=1e6*this.getMaxMegapixels(),s=i.getMaxDimensions();o&&this.reset();var c=new p.default(t,r,s),l=null,u=function(t){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;arguments.length>2&&void 0!==arguments[2]&&arguments[2];e._setImage(t,l,o),e._initWatermark(),e._ready=!0,e.emit("ready")};c.needsResize()?(this.emit("resize"),l=this._sdk.parseExif(t),c.resize().then(function(t){var o=t.canvas,i=t.dimensions,n=t.reason;o.src="data:image/jpeg;base64,",e.emit("resized",{dimensions:i,reason:n}),u(o,i,n)})):u(t)},t.prototype._initWatermark=function(){this._options.editor.watermarkImage&&(this._watermarkOperation=this.operations.getOrCreate("watermark",{image:this._options.editor.watermarkImage}))},t.prototype._initSDK=function(){var e=this._options,t=e.logLevel,o=e.displayWelcomeMessage,i=e.debug,n=e.license,r=this._options.editor,s=r.smoothDownscaling,c=r.smoothUpscaling,l=r.preferredRenderer,u=r.pixelRatio,p={logLevel:t,debug:i,displayWelcomeMessage:o,pixelRatio:u,smoothDownscaling:s,smoothUpscaling:c,transparent:!0,license:n};this._sdk=new a.SDK(l,p)},t.prototype._onZoom=function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.fixOffset(),this.render(function(){t._mediator.emit(a.Constants.EVENTS.ZOOM_DONE),o&&o()})},t.prototype._onUndo=function(){this.render()},t.prototype.getRotation=function(){return this._sdk.getRotation()},t.prototype.setRotation=function(e){this._sdk.setRotation(e)},t.prototype.getSpriteScale=function(){return this._sdk.getSpriteScale()},t.prototype.setSpriteScale=function(e){this._sdk.setSpriteScale(e)},t.prototype.isToolAllowed=function(e){return!!this._shallow||this._sdk._l.isToolAllowed(e)},t.prototype.isToolEnabled=function(e){return-1!==this._options.editor.tools.indexOf(e)},t.prototype.getMaxMegapixels=function(){var e=this._options.editor.maxMegaPixels;return a.Utils.isMobile()?e.mobile:e.desktop},t.prototype.getOutputDimensions=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sdk.getOutputDimensions(e)},t.prototype.getOutputTextureDimensions=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sdk.getOutputTextureDimensions(e)},t.prototype.getFinalDimensions=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._sdk.getFinalDimensions(e)},t.prototype.getCanvasDimensions=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this._sdk.getCanvas(),o=new a.Vector2(t.offsetWidth,t.offsetHeight);return e&&o.subtract(this._padding[1]+this._padding[3],this._padding[0]+this._padding[2]),o},t.prototype._setImage=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._options.editor.image,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._sdk.setAllOperationsToDirty(),this._options.editor.image=e,this._sdk.setImage(e,t,o),this.zoom.set("auto"),this.emit("new-image")},t.prototype.export=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._watermarkOperation&&this._watermarkOperation.setEnabled(!1),this._sdk.setAllOperationsToDirty();var o=this._options.editor.export;return new l.default(this._sdk,o,t).export().then(function(t){return e.emit("export",t),e._mediator.emit(a.Constants.EVENTS.EXPORT,t,e),e._watermarkOperation&&(e._watermarkOperation.setEnabled(!0),e._sdk.render()),e._sdk.setAllOperationsToDirty(),t})},t.prototype._initSerializers=function(){this._serializers={"1.0.0":o(165).default,"1.0.1":o(171).default,"2.0.0":o(172).default,"2.0.1":o(174).default,"3.0.0":o(177).default}},t.prototype.serialize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"3.0.0",o=this._serializers[t];return o?new o(this).serialize(e):a.Promise.reject(new Error("No serializer for version "+t+" found."))},t.prototype.deserialize=function(e){var t=this,o=this._serializers[e.version];return o?new o(this).deserialize(e).then(function(){t.zoom.set("auto")}):a.Promise.reject(new Error("No serializer for version "+e.version+" found."))},t.prototype._applyOffset=function(){var e=this._offset.clone();e.x-=this._padding[1]/2,e.x+=this._padding[3]/2,e.y-=this._padding[2]/2,e.y+=this._padding[0]/2,this._sdk.setOffset(e)},t.prototype.start=function(){this.zoom.set("auto"),this._animationFrameRequest=(0,a.requestAnimationFrame)(this._tick)},t.prototype.stop=function(){this._running=!1,this._animationFrameRequest&&((0,a.cancelAnimationFrame)(this._animationFrameRequest),this._renderCallbacks=[])},t.prototype.render=function(e){this._renderRequested=!0,e&&this._renderCallbacks.push(e)},t.prototype.setOffset=function(e){this._offset=this._clampOffset(e)},t.prototype.getOffset=function(){return this._offset},t.prototype.fixOffset=function(){this.setOffset(this._sdk.getOffset())},t.prototype._clampOffset=function(e){var t=this._sdk.getRenderer(),o=new a.Vector2(t.getWidth(),t.getHeight()),i=this._sdk.getOutputDimensions(!1),n=o.clone().subtract(i).divide(2).clamp(null,new a.Vector2(0,0)),r=i.clone().subtract(o).divide(2).clamp(new a.Vector2(0,0),null);return e.clone().clamp(n,r).round()},t.prototype._tick=function(){var e=this;if(this._renderRequested){var t=this._renderCallbacks.slice(0);this._renderCallbacks=[],this._render().then(function(){t.forEach(function(e){return e()}),e._animationFrameRequest=(0,a.requestAnimationFrame)(e._tick)}).catch(function(e){a.Log.printError(e)}),this._renderRequested=!1}else this._animationFrameRequest=(0,a.requestAnimationFrame)(this._tick)},t.prototype._render=function(){var e=this;return this._ready?(this._applyOffset(),this._sdk.render().then(function(){e._lastOutputBounds=e._sdk.getSprite().getBounds()}).catch(function(t){e.emit("render-error",t)})):a.Promise.resolve()},t.prototype.reset=function(){this._sdk.reset(),this.history.reset(),this.operations.reset()},t.prototype.dispose=function(){this.stop(),this._sdk.dispose()},t.prototype.isReady=function(){return this._ready},t.prototype.getRenderer=function(){return this._sdk.getRenderer()},t.prototype.getSDK=function(){return this._sdk},t.prototype.getInputDimensions=function(){return this._sdk.getInputDimensions(!1)},t.prototype.getPadding=function(){return this._padding},t.prototype.setPadding=function(e){this._padding=e||[0,0,0,0]},t.prototype.getImage=function(){return this._options.editor.image},t.prototype.getOptions=function(){return this._options},t.prototype.getUI=function(){return this._ui},t.prototype.getMediator=function(){return this._mediator},t.prototype.broadcastTransform=function(e,t){var o=this,i=new a.SDK.Operations.TransformOperation.TransformChange(e,t);["sprite","selective-blur","radial-focus","mirrored-focus","linear-focus","blur"].forEach(function(e){var t=o.operations.get(e);t&&t.transform(i)})},t.prototype.broadcastFlip=function(e){var t=this;["mirrored-focus","radial-focus","sprite","selective-blur"].forEach(function(o){var i=t.operations.get(o);i&&i.flip(e)})},t.prototype.broadcastRotate=function(e){var t=this;["transform","mirrored-focus","radial-focus","sprite","selective-blur"].forEach(function(o){var i=t.operations.get(o);i&&i.rotate(e)})},t}(a.EventEmitter);t.default=w},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(119);Object.defineProperty(t,"adjustments",{enumerable:!0,get:function(){return i(n).default}});var r=o(122);Object.defineProperty(t,"transform",{enumerable:!0,get:function(){return i(r).default}});var s=o(126);Object.defineProperty(t,"filter",{enumerable:!0,get:function(){return i(s).default}});var a=o(129);Object.defineProperty(t,"focus",{enumerable:!0,get:function(){return i(a).default}});var c=o(134);Object.defineProperty(t,"sticker",{enumerable:!0,get:function(){return i(c).default}});var l=o(142);Object.defineProperty(t,"text",{enumerable:!0,get:function(){return i(l).default}});var u=o(152);Object.defineProperty(t,"brush",{enumerable:!0,get:function(){return i(u).default}});var p=o(156);Object.defineProperty(t,"selectiveBlur",{enumerable:!0,get:function(){return i(p).default}});var f=o(159);Object.defineProperty(t,"frame",{enumerable:!0,get:function(){return i(f).default}})},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(128),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){i(this,t);var o=n(this,e.call(this));return o._bindAll("_onButtonClick"),o.state={overlayVisible:!1},o}return r(t,e),t.prototype._onButtonClick=function(e){e.preventDefault(),e.stopPropagation(),this.setState({overlayVisible:!this.state.overlayVisible})},t.prototype.renderWithBEM=function(){var e=null;this.state.overlayVisible&&(e=s.ReactBEM.createElement(c.default,{items:this.props.items,selectedItem:this.props.selectedItem,onChange:this.props.onChange}));var t=this.state.overlayVisible?"is-active":null;return s.ReactBEM.createElement("bem",{specifier:"$b:controls"},s.ReactBEM.createElement("div",{bem:"$e:categoryDropdown",className:t,onClick:this._onButtonClick},s.ReactBEM.createElement("img",{bem:"e:icon",src:this.props.selectedItem.icon}),s.ReactBEM.createElement("div",{bem:"e:label"},this.props.selectedItem.label),e))},t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._renderCanvas()},t.prototype.componentDidUpdate=function(){this._renderCanvas()},t.prototype._renderCanvas=function(){var e=this.refs.canvas,t=this.context.editor,o=t.getSDK(),i=o.getPixelRatio();e.width=e.offsetWidth*i,e.height=e.offsetHeight*i,e.style.width=e.offsetWidth+"px",e.style.height=e.offsetHeight+"px";var n=e.getContext("2d");n.fillStyle="red",n.clearRect(0,0,e.width,e.height),n.font=(this.props.fontStyle||"")+" "+(this.props.fontWeight||"")+" "+24*i+"px "+this.props.fontFamily,n.textBaseline="middle",n.textAlign="center",n.fillStyle="white",n.fillText("Abc",e.width/2,e.height/2)},t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("canvas",{bem:"b:fontFamily e:canvas",ref:"canvas"})},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=o(151),a=i(s),c=o(19),l=i(c),u=o(47),p=i(u),f=function(){function e(t,o){n(this,e),this._ui=t,this._options=o,this._fonts=[],this._variationsByIdentifier={},this._fontsByFontFamily={},this._initFonts()}return e.prototype._initFonts=function(){var e=this,t=this._options,o=t.fonts,i=t.replaceFonts,n=t.availableVariations,s=r.Constants.DEFAULTS.FONTS;s=i?o:s.concat(o||[]);var c=void 0;s=s.map(function(t){var o=t.fontFamily,i=t.variations;if(n&&(i=i.filter(function(e){return-1!==n.indexOf(e.identifier)})),0===i.length)return null;var r=new a.default({fontFamily:o});return i=i.map(function(t){var i=new p.default(t);return i.setFontFamily(o),i.setFont(r),t.default&&!c&&(c=i),null==i.getTextMetrics()&&l.default.warn("Missing font metrics for "+i.getIdentifier()+". The SDK will fall back to basic font rendering, which may lead to layout issues. Please provide font metrics for your custom fonts. See https://docs.photoeditorsdk.com/guides/html5/ for more details."),e._variationsByIdentifier[i.getIdentifier()]=i,i}),r.setVariations(i),e._fontsByFontFamily[o]=r,r}).filter(function(e){return e}),c||(c=s[0].getVariations()[0]),this._defaultVariation=c,this._fonts=s},e.prototype.getFonts=function(){return this._fonts},e.prototype.getFontByFontFamily=function(e){return this._fontsByFontFamily[e]},e.prototype.getVariationByIdentifier=function(e){return this._variationsByIdentifier[e]},e.prototype.getDefaultVariation=function(){return this._defaultVariation},e}();t.default=f},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(7),a={100:"Extra Light",200:"Light",300:"Book",400:"Regular",500:"Medium",600:"Semibold",700:"Bold",800:"Black",900:"Extra Black",bold:"Bold",normal:"Regular"},c=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.getLabel=function(){var e=a[this._options.fontWeight];switch(this._options.fontStyle){case"italic":e+=" Italic"}return e},t}(s.Configurable);t.default=c,c.prototype.availableOptions={identifier:{type:s.OptionType.STRING,required:!0},fontFamily:{type:s.OptionType.STRING,required:!0},fontWeight:{type:s.OptionType.ALL,default:400},fontStyle:{type:s.OptionType.STRING,default:"normal"},textMetrics:{type:s.OptionType.OBJECT,default:null},provider:{type:s.OptionType.STRING,available:["google","file"]},filePath:{type:s.OptionType.STRING},default:{type:s.OptionType.BOOLEAN,default:!1},font:{type:s.OptionType.OBJECT}}},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),r=function(){function e(t,o){i(this,e),this._ui=t,this._options=o,this._categoriesById={},this._categories=[],this._framesById={},this._addCategories(n.SharedConstants.DEFAULTS.FRAME_CATEGORIES);var r=this._options,s=r.categories,a=r.replaceCategories;this._options.categories?this._addCategories(s,a):this._updateAllCategory()}return e.prototype._addCategories=function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._categories=o?e.slice(0):n.Utils.mergeCategories(this._categories,e,"frames"),this._categoriesById={},this._categories.forEach(function(e){t._categoriesById[e.identifier]=e});var i=this._options.availableFrames;i&&this._categories.forEach(function(e){e.frames=e.frames.filter(function(e){return-1!==i.indexOf(e.identifier)})}),this._categories.forEach(function(e){e.frames.forEach(function(e){t._framesById[e.identifier]=e})}),this._updateAllCategory()},e.prototype._updateAllCategory=function(){this._allCategory={identifier:"all",defaultName:"All",frames:this._categories.map(function(e){return e.frames}).reduce(function(e,t){return e.concat(t)},[])},this._categoriesById.all=this._allCategory},e.prototype.getFramesForCategory=function(e){if(!this._categoriesById[e])throw new Error("Unknown frame category '"+e+"'");return this._categoriesById[e].frames},e.prototype.getFrameByIdentifier=function(e){return this._framesById[e]},e.prototype.getCategories=function(){return this._categories},e.prototype.getCategory=function(e){return this._categoriesById[e]},e}();t.default=r},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=s.SDK.OptionType,c=function(e){function t(o){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,t);var a=n(this,e.call(this,r));return a._loaded=!1,a._loading=!1,a._ui=o,a._frame=s.SDK.Utils.deepClone(a._options),a}return r(t,e),t.prototype.load=function(){var e=this;if(this._loaded)return Promise.resolve();if(this._loading)return Promise.reject(new Error("Called Frame#load while it's already loading"));this._loading=!0;var t=this._frame.imageGroups,o=[];return["top","left","right","bottom"].forEach(function(i){if(i in t){var n=t[i];["start","mid","end"].forEach(function(t){t in n&&o.push(e._loadPart(i,t))})}}),Promise.all(o).then(function(){e._loaded=!0,e._loading=!1}).catch(function(t){e._loaded=!1,e._loading=!1})},t.prototype._loadPart=function(e,t){var o=this;return new Promise(function(i,n){var r=o._frame.imageGroups,s=r[e][t],a=s;"string"!=typeof s&&"image"in s&&(a=s.image);var c=new window.Image;c.addEventListener("load",function(){"string"!=typeof s?o._frame.imageGroups[e][t].image=c:o._frame.imageGroups[e][t]=c,i(c)}),c.addEventListener("error",function(){n(new Error("Failed to load image at "+a))}),c.crossOrigin="Anonymous",c.src=o._ui.getAssetPath(a)})},t.prototype.getFrame=function(){return this._frame},t}(s.SDK.Configurable);t.default=c,c.prototype.availableOptions={identifier:{type:a.STRING,required:!0},defaultName:{type:a.STRING},thumbnail:{type:a.STRING},tintable:{type:a.BOOLEAN,default:!1},layoutMode:{type:a.STRING,default:"horizontal-inside",available:["horizontal-inside","vertical-inside"]},imageGroups:{type:a.OBJECT,required:!0}}},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),r=2*Math.PI,s=function(){function e(t){i(this,e),this._editor=t,this._serializeOperations=this._serializeOperations.bind(this)}return e.prototype.serialize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._options=n.SDKUtils.defaults(e,{image:!0});var t={version:this.constructor.version};return this._serializeInputImage(t).then(this._serializeOperations)},e.prototype._serializeInputImage=function(e){var t=this._editor.getImage(),o=t.width,i=t.height;if(!this._options.image)return e.inputImage={width:o,height:i},Promise.resolve(e);var r=n.SDKUtils.createCanvas();r.width=t.width,r.height=t.height,r.getContext("2d").drawImage(t,0,0);var s=r.toDataURL(n.ImageFormat.PNG);return e.inputImage={type:n.ImageFormat.PNG,data:s.replace(/^data:image\/(.*?);base64,/,""),width:o,height:i},Promise.resolve(e)},e.prototype._serializeOperations=function(e){var t=this,o=[];return this._editor.operations.getStack().forEach(function(e){var i=t._serializeOperation(e,o);i&&o.push(i)}),e.operations=o.filter(function(e){return e}),Promise.resolve(e)},e.prototype._serializeOperation=function(e,t){switch(e.constructor.identifier){case"transform":return this._serializeTransformOperation(e);case"orientation":return this._serializeOrientationOperation(e);case"filter":return this._serializeFilterOperation(e);case"adjustments":return this._serializeAdjustmentsOperation(e);case"sprite":return this._serializeSpriteOperation(e,t);case"radial-focus":return this._serializeRadialFocusOperation(e);case"mirrored-focus":return this._serializeLinearFocusOperation(e);default:n.Log.warn("Unable to serialize operation of type "+e.constructor.identifier)}},e.prototype._serializeTransformOperation=function(e){var t=e.serializeOptions(["start","end","rotation"],!0);return t.rotation=(t.rotation+r)%r,{type:"crop",options:t}},e.prototype._serializeOrientationOperation=function(e){return{type:"orientation",options:e.serializeOptions(["flipVertically","flipHorizontally","rotation"],!0)}},e.prototype._serializeFilterOperation=function(e){return"identity"===e.getIdentifier()?null:{type:"filter",options:{intensity:e.getIntensity(),name:e.getIdentifier()}}},e.prototype._serializeAdjustmentsOperation=function(e){var t=e.availableOptions,o=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"],i={};return o.forEach(function(o){var n=t[o],r=e.getOption(o),s=n.minValue,a=n.midValue,c=n.maxValue;i[o]=r<=a?(r-s)/(a-s)-1:(r-a)/(c-a)}),{type:"adjustments",options:i}},e.prototype._serializeSpriteOperation=function(e,t){var o=this,i=t.filter(function(e){return"sprite"===e.type}),n=void 0,r=!0;if(i.length?(n=i.pop(),r=!1):n={type:"sprite",options:{sprites:[]}},e.getSprites().forEach(function(t){var i=null;t instanceof e.constructor.StickerSprite?i=o._serializeSticker(e,t):t instanceof e.constructor.TextSprite?i=o._serializeText(e,t):t instanceof e.constructor.BrushSprite&&(i=o._serializeBrush(e,t)),i&&n.options.sprites.push(i)}),r)return n},e.prototype._serializeSticker=function(e,t){var o=t.getAdjustments(),i=t.serializeOptions(["identifier","position","dimensions","flipVertically","flipHorizontally","rotation"],!0);i.name=i.identifier,delete i.identifier,i.rotation=(i.rotation+r)%r;var n=o.availableOptions;return i.adjustments={brightness:o.getBrightness()-n.brightness.default,saturation:o.getSaturation()-n.saturation.default,contrast:o.getContrast()-n.contrast.default},{type:"sticker",options:i}},e.prototype._serializeText=function(e,t){var o=t.serializeOptions(["fontSize","lineHeight","fontFamily","fontWeight","alignment","color","backgroundColor","position","rotation","text","maxWidth"],!0);return o.rotation=(o.rotation+r)%r,{type:"text",options:o}},e.prototype._serializeBrush=function(e,t){var o=this;return{type:"brush",options:{paths:t.getPaths().map(function(e){return o._serializePath(e)})}}},e.prototype._serializePath=function(e){var t=e.getBrush().serializeOptions(["color","size"],!0);return t.points=e.getControlPoints().map(function(e){return e.getPosition().toObject()}),t},e.prototype._serializeRadialFocusOperation=function(e){return{type:"focus",options:{type:"radial",options:e.serializeOptions(["position","radius","gradientRadius","blurRadius"],!0)}}},e.prototype._serializeLinearFocusOperation=function(e){return{type:"focus",options:{type:"linear",options:e.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}},e.prototype._getInputDimensionsForOperation=function(e){var t=!1,o=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(function(i){i===e&&(t=!0),t||(o=i.getNewDimensions(o))}),o},e}();t.default=s,s.version="1.0.0"},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(26),l=i(c),u=o(11),p=i(u),f=o(166),h=i(f),d=o(46),m=i(d),_=o(29),g=i(_),y=void 0;void 0!==a.SDK.Operations.SpriteOperation&&(y=a.SDK.Operations.SpriteOperation.BrushSprite);var b=function(){function e(t,o){s(this,e),this._editor=t,this._ui=this._editor.getUI(),this._data=o,this._filterManager=new l.default(this._ui,this._getOptions("filter")),this._stickerManager=new p.default(this._ui,this._getOptions("sticker")),this._brushManager=new h.default(this._ui,this._getOptions("brush")),this._fontManager=new m.default(this._ui,this._getOptions("text"))}return e.prototype._getOptions=function(e){var t=this._editor.controls,o={};t&&t.get(e)&&(o=t.get(e).defaultOptions);var i=this._editor.getOptions();return a.SDKUtils.deepDefaults({},i.editor.controlsOptions[e]||{},o)},e.prototype.deserialize=function(){var e=this;return this._validateVersion().then(function(){return e._deserializeInputImage()}).then(function(){return e._deserializeOperations()})},e.prototype._validateVersion=function(){return this._data.version!==this.constructor.version?Promise.reject(new Error("Invalid version "+this._data.version+", expected "+this.constructor.version)):Promise.resolve()},e.prototype._deserializeInputImage=function(){var e=this;return new Promise(function(t,o){var i=e._data.inputImage,n=i.data,r=i.type;if(n&&r){var s=new window.Image;s.addEventListener("load",function(){e._editor.setImage(s),t()}),s.src="data:"+r+";base64,"+n}else t()})},e.prototype._deserializeOperations=function(){var e=this,t=this._data.operations.map(function(t){return e._deserializeOperation(t).then(function(t){return t&&e._editor.getMediator().emit(a.Constants.EVENTS.OPERATION_UPDATED,t),t})});return Promise.all(t)},e.prototype._deserializeOperation=function(e){switch(e.type){case"crop":return this._deserializeCropOperation(e);case"orientation":return this._deserializeOrientationOperation(e);case"filter":return this._deserializeFilterOperation(e);case"adjustments":return this._deserializeAdjustmentsOperation(e);case"sprite":return this._deserializeSpriteOperation(e);case"focus":return this._deserializeFocusOperation(e)}},e.prototype._deserializeCropOperation=function(e){var t=e.options,o=t.rotation,i=a.Vector2.fromObject(t.start),n=a.Vector2.fromObject(t.end);o>Math.PI&&(o-=2*Math.PI);var r={start:i,end:n};void 0!==o&&(r.rotation=o);var s=this._editor.operations.getOrCreate("transform");return this._editor.broadcastTransform(s,r),s.set(r),Promise.resolve(s)},e.prototype._deserializeOrientationOperation=function(e){var t=e.options,o=this._editor.operations.getOrCreate("orientation");return o?(o.set(t),Promise.resolve(o)):Promise.resolve()},e.prototype._deserializeFilterOperation=function(e){var t=this,o=e.options;return this._filterManager.getFilterByIdentifier(o.name)?this._filterManager.instantiateFilterWithIdentifier(o.name).then(function(e){var i=t._editor.operations.getOrCreate("filter");return i.set({identifier:o.name,filter:e,intensity:o.intensity}),i}):(a.Log.warn("Deserializer","Unknown filter `"+o.name+"`"),Promise.resolve())},e.prototype._deserializeAdjustmentsOperation=function(e){var t=a.SDK.Operations.AdjustmentsOperation,o=e.options,i=["brightness","saturation","contrast","exposure","shadows","highlights","clarity"],n={};return i.forEach(function(e){if(void 0!==o[e]){var i=t.prototype.availableOptions[e],r=i.minValue,s=i.midValue,a=i.maxValue,c=o[e];c=c<0?s+(s-r)*c:s+(a-s)*c,n[e]=c}}),Promise.resolve(this._editor.operations.getOrCreate("adjustments",n))},e.prototype._deserializeSpriteOperation=function(e){var t=this,o=e.options,i=this._editor.operations.getOrCreate("sprite");if(!i)return Promise.resolve();var n=o.sprites.map(function(e){return t._deserializeSprite(i,e)}).filter(function(e){return e});return Promise.all(n).then(function(e){return i.setSprites(e.filter(function(e){return e})),i})},e.prototype._deserializeSprite=function(e,t){switch(t.type){case"sticker":return this._deserializeSticker(e,t);case"text":return this._deserializeText(e,t);case"brush":return this._deserializeBrush(e,t)}},e.prototype._deserializeSticker=function(e,t){var o=this,i=a.SDK.Operations.SpriteOperation,n=t.options,r=this._stickerManager.getStickerByIdentifier(n.name),s=this._stickerManager.getURLForSticker(r);return r?new Promise(function(t,r){var c=new window.Image;c.addEventListener("load",function(){var o=i.StickerSprite.prototype.availableOptions.adjustments.structure,r=n.rotation,s=n.flipHorizontally,l=n.flipVertically,u={identifier:n.name,image:c,position:a.Vector2.fromObject(n.position),dimensions:a.Vector2.fromObject(n.dimensions),rotation:r,flipHorizontally:s,flipVertically:l,adjustments:{}};void 0!==n.adjustments&&["brightness","contrast","saturation"].forEach(function(e){void 0!==n.adjustments[e]&&(u.adjustments[e]=n.adjustments[e]+o[e].default)}),t(e.createSticker(u))}),c.crossOrigin="Anonymous",c.src=o._editor.getUI().getAssetPath(s)}):(a.Log.warn("Deserializer","Unknown sticker '"+n.name+"'. Skipping sprite."),Promise.resolve())},e.prototype._deserializeText=function(e,t){var o=t.options,i=o.fontSize,n=o.lineHeight,r=o.fontFamily,s=o.fontWeight,c=o.alignment,l=o.rotation,u=o.maxWidth,p=o.color,f=o.backgroundColor,h=new g.default(this._ui),d=this._fontManager.getFontByFontFamily(r);return d||(d=this._fontManager.getDefaultFont()),h.setFonts([d]),h.load().then(function(){return e.createText({fontSize:i,lineHeight:n,fontFamily:r,fontWeight:s,alignment:c,rotation:l,maxWidth:u,text:o.text,color:a.Color.fromArray(p),backgroundColor:a.Color.fromArray(f),position:a.Vector2.fromObject(o.position)})})},e.prototype._deserializeBrush=function(e,t){var o=this,i=t.options,n=i.paths,r=e.createBrush();return n.forEach(function(e){o._deserializeBrushPath(r,e)}),Promise.resolve(r)},e.prototype._deserializeBrushPath=function(e,t){var o=t.points,i=this._createBrushForPath(t),n=e.createPath(i);n.setClosed(!0),o.forEach(function(e){n.addControlPoint(a.Vector2.fromObject(e))})},e.prototype._createBrushForPath=function(e){var t=e.color,o=e.size,i=a.Color.fromArray(t),c={color:i,size:o},l=this._brushManager.getFirstBrush();if(l.prototype&&l.prototype instanceof y){return new l(c)}var u=a.SDKUtils.extend({},l);delete u.image;var p=function(e){function t(){return s(this,t),n(this,e.apply(this,arguments))}return r(t,e),t}(y);return p.identifier=l.identifier,new p(a.SDKUtils.extend({},u,c))},e.prototype._deserializeFocusOperation=function(e){var t=e.options.options;switch(e.options.type){case"radial":var o=t.position,i=t.radius,n=t.gradientRadius,r=t.blurRadius;return Promise.resolve(this._editor.operations.getOrCreate("radial-focus",{position:a.Vector2.fromObject(o),radius:i,gradientRadius:n,blurRadius:r}));case"linear":var s=t.start,c=t.end,l=t.size,u=t.gradientSize,p=t.blurRadius;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:a.Vector2.fromObject(s),end:a.Vector2.fromObject(c),size:l,gradientSize:u,blurRadius:p}))}},e.prototype._getInputDimensionsForOperation=function(e){var t=!1,o=this._editor.getInputDimensions();return this._editor.operations.getStack().forEach(function(i){i===e&&(t=!0),t||(o=i.getNewDimensions(o))}),o},e}();t.default=b,b.version="1.0.0"},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=o(168),r=function(e){return e&&e.__esModule?e:{default:e}}(n),s=function(){function e(t){i(this,e),this._ui=t,this._fonts=[],this._observers=[]}return e.prototype.add=function(e){this._fonts.push(e)},e.prototype.load=function(){var e=this;return 0===this._fonts.length?Promise.resolve():(this._observers=[],this._fonts.forEach(function(t){e._observers.push(new r.default(t))}),Promise.all(this._observers.map(function(e){return e.observe()})))},e.prototype.dispose=function(){this._observers.forEach(function(e){return e.dispose()})},e}();t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(50),a=function(e){return e&&e.__esModule?e:{default:e}}(s),c=2*Math.PI,l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype._serializeTransformOperation=function(e){var t=e.serializeOptions(["start","end","rotation","textureScale"],!0);return t.rotation=(t.rotation+c)%c,1!==t.textureScale&&(t.dimensions=e.getNewDimensions(e.getInputDimensions(!1))),delete t.textureScale,{type:"crop",options:t}},t}(a.default);t.default=l,l.version="1.0.1"},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(51),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype._deserializeOperation=function(t){return"selective-blur"===t.type?this._deserializeSelectiveBlurOperation(t):e.prototype._deserializeOperation.call(this,t)},t.prototype._deserializeCropOperation=function(e){var t=e.options,o=t.rotation,i=s.Vector2.fromObject(t.start),n=s.Vector2.fromObject(t.end),r=t.dimensions?s.Vector2.fromObject(t.dimensions):null;o>Math.PI&&(o-=2*Math.PI);var a={start:i,end:n};void 0!==o&&(a.rotation=o);var c=this._editor.operations.getOrCreate("transform");if(!c)return Promise.resolve();if(this._editor.broadcastTransform(c,a),c.set(a),r){var l=n.clone().subtract(i),u=c.getInputDimensions(!1).multiply(l);c.setTextureScale(r.x/u.x)}return Promise.resolve(c)},t}(c.default);t.default=l,l.version="1.0.1"},function(e,t,o){"use strict";function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}Object.defineProperty(t,"__esModule",{value:!0});var n,r=o(0),s=r.SDK.Engine.Filters.OverlayFilter;t.default=(n={},i(n,s.BLEND_MODES.NORMAL,"normal"),i(n,s.BLEND_MODES.OVERLAY,"overlay"),i(n,s.BLEND_MODES.HARD_LIGHT,"hard light"),i(n,s.BLEND_MODES.SOFT_LIGHT,"soft light"),i(n,s.BLEND_MODES.MULTIPLY,"multiply"),i(n,s.BLEND_MODES.DARKEN,"darken"),i(n,s.BLEND_MODES.LIGHTEN,"lighten"),i(n,s.BLEND_MODES.SCREEN,"screen"),i(n,s.BLEND_MODES.COLOR_BURN,"color burn"),n)},function(e,t,o){"use strict";/*!
 * This file is part of PhotoEditorSDK.
 *
 * Copyright (C) 2016-2017 9elements GmbH <contact@9elements.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, without
 * modification, are permitted provided that the following license agreement
 * is approved and a legal/financial contract was signed by the user.
 * The license agreement can be found under following link:
 *
 * https://www.photoeditorsdk.com/LICENSE.txt
 */
o(57),e.exports=o(58).default},function(e,t){},function(e,t,o){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),l=o(0),u=o(80),p=n(u),f=o(2),h=n(f),d=o(3),m=n(d),_=o(1),g=n(_),y=o(21),b=n(y),v=o(185),E=n(v),w=o(186),k=i(w),S=o(4),O=n(S),C=o(43),M=i(C),R=o(13),B=n(R),x=o(6),T=n(x),P=o(29),j=n(P),D=function(e){return l.SDKUtils.byteArrayToString(l.Base64.decode(e))},I=function(e){function t(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,t);var i=s(this,e.call(this));return i._mediator=new l.EventEmitter,i._fontLoader=new j.default(i),i._options=o,i._initOptions(),i._initLanguage(),i._initEvents(),i._disposed=!1,i._preloader=new E.default(i,i._options,i._mediator),l.Log.setLevel(i._options.logLevel),i._v()&&i.run(),i}return a(t,e),t.prototype.run=function(){this._registerWebFonts(),this._options.container.style.position="relative",this._render()},t.prototype._render=function(){var e=l.React.createElement(p.default,{ui:this,mediator:this._mediator,options:this._options});if(this._options.renderReturnsComponent)return e;this._component=l.ReactDOM.render(e,this._options.container)},t.prototype.export=function(){var e;return(e=this._component).export.apply(e,arguments)},t.prototype.serialize=function(){var e;return(e=this._component).serialize.apply(e,arguments)},t.prototype.deserialize=function(e){return this._component.deserialize(e)},t.prototype.getEditor=function(){return this._component.getEditor()},t.prototype._initOptions=function(){this._options=l.SDKUtils.defaults(this._options,{language:"en",title:"PhotoEditor SDK",logLevel:"warn",preloader:!0,editor:{},assets:{},photoRoll:{},enableUpload:!0,enableWebcam:!0,showCloseButton:!1,showHeader:!0,showTopBar:!0,responsive:!1}),this._options.editor=l.SDKUtils.defaults(this._options.editor||{},{pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1,preferredRenderer:"webgl",enableZoom:!0,enableDrag:!0,smoothDownscaling:!1,smoothUpscaling:!1,displayResizeMessage:!0,maxMegaPixels:{},forceControls:[],watermarkImage:null,tools:["transform","filter","brightness","saturation","contrast","clarity","exposure","shadows","highlights","gamma","text","sticker","brush","radial-focus","mirrored-focus","frame"],controlsOrder:["transform",["filter","adjustments"],["text","sticker","brush"],["selectiveBlur","focus","frame"]],operationsOrder:["exif-orientation","orientation","transform","filter","adjustments","radial-focus","mirrored-focus","selective-blur","sprite","frame","watermark"],controlsOptions:{}}),this._options.editor.maxMegaPixels=l.SDKUtils.defaults(this._options.editor.maxMegaPixels,{mobile:5,desktop:10}),this._options.editor.export=l.SDKUtils.defaults(this._options.editor.export||{},{showButton:!0,format:"image/png",type:l.RenderType.IMAGE,download:!0,fileBasename:"photoeditorsdk-export",quality:.8}),this._options.photoRoll=l.SDKUtils.defaults(this._options.photoRoll||{},{provider:null}),this._options.extensions=l.SDKUtils.defaults(this._options.extensions||{},{languages:{},operations:[],controls:[]}),this._options.assets=l.SDKUtils.defaults(this._options.assets||{},{baseUrl:"assets",resolver:null})},t.prototype._v=function(){return!!this[D("X29wdGlvbnM=")][D("bGljZW5zZQ==")]||(l.Log.error(D("TGljZW5zaW5n"),D("Tm8gYGxpY2Vuc2VgIG9wdGlvbiBnaXZlbi4=")),l.Log.error(D("TGljZW5zaW5n"),D("SW4gY2FzZSB5b3UgZG9uJ3QgaGF2ZSBhIGxpY2Vuc2UgeWV0LCBwbGVhc2UgY29udGFjdCBvdXIgc2FsZXMgc3RhZmYgYXQgc2FsZXNAcGhvdG9lZGl0b3JzZGsuY29tIHRvIG9idGFpbiBhIGxpY2Vuc2Ugb3IgbG9nIGluIHRvIHlvdXIgY3VzdG9tZXIgZGFzaGJvYXJkLg==")),!1)},t.prototype._registerWebFonts=function(){var e=this.getAssetPath("fonts/montserrat-regular.woff",!0,!0),t=this.getAssetPath("fonts/montserrat-light.woff",!0,!0),o='\n      // Injected by PhotoEditorSDK\n      @font-face {\n        font-family: "__pesdk_Montserrat";\n        src: url(\''+e+"') format('woff');\n        font-weight: normal;\n        font-style: normal;\n      }\n\n      @font-face {\n        font-family: \"__pesdk_Montserrat\";\n        src: url('"+t+"') format('woff');\n        font-weight: 100;\n        font-style: normal;\n      }\n    ";this._webFontsStyle=document.createElement("style"),this._webFontsStyle.innerHTML=o,document.getElementsByTagName("head")[0].appendChild(this._webFontsStyle)},t.prototype._initEvents=function(){this._mediator.pipeEvents(this)},t.prototype._disposeEvents=function(){this._mediator.unpipeEvents(this)},t.prototype._initLanguage=function(){this._languages=l.SDKUtils.deepDefaults(this._options.extensions.languages,{de:o(191),en:o(192)}),this._language=this._languages[this._options.language],this._language||l.Log.error(this.constructor.name,"Language `"+this._options.language+"` not found!")},t.prototype.translate=function(e,t){return l.Utils.translate(this._language,e,t)},t.prototype.setImage=function(e){this._component&&this._component.setImage(e)},t.prototype.getAssetPath=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this._options.assets,n=i.baseUrl,r=i.resolver,s=n+"/"+e;if(e.match(/(ftp|http|https):\/\//)&&(s=e),t){if(!o){if(("undefined"!=typeof window&&window.devicePixelRatio||1)>1){var a=/\.[\w?=]+$/;e=e.replace(a,function(e){return"@2x"+e})}}s=n+"/ui/react/"+e}return void 0!==r&&null!==r&&(s=r(s)),s},t.prototype.getFontLoader=function(){return this._fontLoader},t.prototype.getPreloader=function(){return this._preloader},t.prototype.dispose=function(){if(this._disposed)throw new Error("This instance of PhotoEditorSDK is already disposed.");this._disposed=!0,this._webFontsStyle.parentNode.removeChild(this._webFontsStyle),l.ReactDOM.unmountComponentAtNode(this._options.container),this._disposeEvents()},t}(l.EventEmitter);I.prototype.identifier="react",I.BaseComponent=l.BaseComponent,I.BaseControls=O.default,I.ControlsComponent=m.default,I.React=l.React,I.ReactBEM=l.ReactBEM,I.SharedState=l.SharedState,I.Constants=l.Constants,I.Utils=l.Utils,I.ScrollbarComponent=h.default,I.ModalManager=g.default,I.JSONLoader=b.default,I.PhotoRoll=k,I.Controls=M,I.SliderComponent=B.default,I.SliderOverlayComponent=T.default;var F=function(e){function t(){return r(this,t),s(this,e.apply(this,arguments))}return a(t,e),t.prototype.componentDidMount=function(){this._ui=new I(l.SDKUtils.extend({},this.props,{container:this.refs.container}))},t.prototype.render=function(){var e=l.SDKUtils.extend({},this.props.style||{});return l.React.createElement("div",{style:e,ref:"container"})},c(t,[{key:"ui",get:function(){return this._ui}}]),t}(l.React.Component);I.ReactComponent=F,l.SDK.UI=l.SDK.UI||{},l.SDK.UI.ReactUI=I,t.default=I},function(e,t){e.exports=o},function(e,t,o){"use strict";var i=o(16),n=o(17),r=o(33),s=o(61),a=o(18),c=o(62);e.exports=function(e,t){function o(e){var t=e&&(C&&e[C]||e[M]);if("function"==typeof t)return t}function l(e,t){return e===t?0!==e||1/e==1/t:e!==e&&t!==t}function u(e){this.message=e,this.stack=""}function p(e){function o(o,c,l,p,f,h,d){if(p=p||R,h=h||l,d!==a)if(t)n(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");else if("production"!=={ENV:'"production"'}.NODE_ENV&&"undefined"!=typeof console){var m=p+":"+l;!i[m]&&s<3&&(r(!1,"You are manually calling a React.PropTypes validation function for the `%s` prop on `%s`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.",h,p),i[m]=!0,s++)}return null==c[l]?o?new u(null===c[l]?"The "+f+" `"+h+"` is marked as required in `"+p+"`, but its value is `null`.":"The "+f+" `"+h+"` is marked as required in `"+p+"`, but its value is `undefined`."):null:e(c,l,p,f,h)}if("production"!=={ENV:'"production"'}.NODE_ENV)var i={},s=0;var c=o.bind(null,!1);return c.isRequired=o.bind(null,!0),c}function f(e){function t(t,o,i,n,r,s){var a=t[o];if(w(a)!==e)return new u("Invalid "+n+" `"+r+"` of type `"+k(a)+"` supplied to `"+i+"`, expected `"+e+"`.");return null}return p(t)}function h(e){function t(t,o,i,n,r){if("function"!=typeof e)return new u("Property `"+r+"` of component `"+i+"` has invalid PropType notation inside arrayOf.");var s=t[o];if(!Array.isArray(s)){return new u("Invalid "+n+" `"+r+"` of type `"+w(s)+"` supplied to `"+i+"`, expected an array.")}for(var c=0;c<s.length;c++){var l=e(s,c,i,n,r+"["+c+"]",a);if(l instanceof Error)return l}return null}return p(t)}function d(e){function t(t,o,i,n,r){if(!(t[o]instanceof e)){var s=e.name||R;return new u("Invalid "+n+" `"+r+"` of type `"+O(t[o])+"` supplied to `"+i+"`, expected instance of `"+s+"`.")}return null}return p(t)}function m(e){function t(t,o,i,n,r){for(var s=t[o],a=0;a<e.length;a++)if(l(s,e[a]))return null;return new u("Invalid "+n+" `"+r+"` of value `"+s+"` supplied to `"+i+"`, expected one of "+JSON.stringify(e)+".")}return Array.isArray(e)?p(t):("production"!=={ENV:'"production"'}.NODE_ENV&&r(!1,"Invalid argument supplied to oneOf, expected an instance of array."),i.thatReturnsNull)}function _(e){function t(t,o,i,n,r){if("function"!=typeof e)return new u("Property `"+r+"` of component `"+i+"` has invalid PropType notation inside objectOf.");var s=t[o],c=w(s);if("object"!==c)return new u("Invalid "+n+" `"+r+"` of type `"+c+"` supplied to `"+i+"`, expected an object.");for(var l in s)if(s.hasOwnProperty(l)){var p=e(s,l,i,n,r+"."+l,a);if(p instanceof Error)return p}return null}return p(t)}function g(e){function t(t,o,i,n,r){for(var s=0;s<e.length;s++){if(null==(0,e[s])(t,o,i,n,r,a))return null}return new u("Invalid "+n+" `"+r+"` supplied to `"+i+"`.")}if(!Array.isArray(e))return"production"!=={ENV:'"production"'}.NODE_ENV&&r(!1,"Invalid argument supplied to oneOfType, expected an instance of array."),i.thatReturnsNull;for(var o=0;o<e.length;o++){var n=e[o];if("function"!=typeof n)return r(!1,"Invalid argument supplied to oneOfType. Expected an array of check functions, but received %s at index %s.",S(n),o),i.thatReturnsNull}return p(t)}function y(e){function t(t,o,i,n,r){var s=t[o],c=w(s);if("object"!==c)return new u("Invalid "+n+" `"+r+"` of type `"+c+"` supplied to `"+i+"`, expected `object`.");for(var l in e){var p=e[l];if(p){var f=p(s,l,i,n,r+"."+l,a);if(f)return f}}return null}return p(t)}function b(e){function t(t,o,i,n,r){var c=t[o],l=w(c);if("object"!==l)return new u("Invalid "+n+" `"+r+"` of type `"+l+"` supplied to `"+i+"`, expected `object`.");var p=s({},t[o],e);for(var f in p){var h=e[f];if(!h)return new u("Invalid "+n+" `"+r+"` key `"+f+"` supplied to `"+i+"`.\nBad object: "+JSON.stringify(t[o],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var d=h(c,f,i,n,r+"."+f,a);if(d)return d}return null}return p(t)}function v(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(v);if(null===t||e(t))return!0;var i=o(t);if(!i)return!1;var n,r=i.call(t);if(i!==t.entries){for(;!(n=r.next()).done;)if(!v(n.value))return!1}else for(;!(n=r.next()).done;){var s=n.value;if(s&&!v(s[1]))return!1}return!0;default:return!1}}function E(e,t){return"symbol"===e||("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}function w(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":E(t,e)?"symbol":t}function k(e){if(void 0===e||null===e)return""+e;var t=w(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function S(e){var t=k(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}function O(e){return e.constructor&&e.constructor.name?e.constructor.name:R}var C="function"==typeof Symbol&&Symbol.iterator,M="@@iterator",R="<<anonymous>>",B={array:f("array"),bool:f("boolean"),func:f("function"),number:f("number"),object:f("object"),string:f("string"),symbol:f("symbol"),any:function(){return p(i.thatReturnsNull)}(),arrayOf:h,element:function(){function t(t,o,i,n,r){var s=t[o];if(!e(s)){return new u("Invalid "+n+" `"+r+"` of type `"+w(s)+"` supplied to `"+i+"`, expected a single ReactElement.")}return null}return p(t)}(),instanceOf:d,node:function(){function e(e,t,o,i,n){return v(e[t])?null:new u("Invalid "+i+" `"+n+"` supplied to `"+o+"`, expected a ReactNode.")}return p(e)}(),objectOf:_,oneOf:m,oneOfType:g,shape:y,exact:b};return u.prototype=Error.prototype,B.checkPropTypes=c,B.PropTypes=B,B}},function(e,t,o){"use strict";function i(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
var n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},o=0;o<10;o++)t["_"+String.fromCharCode(o)]=o;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(e){i[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var o,a,c=i(e),l=1;l<arguments.length;l++){o=Object(arguments[l]);for(var u in o)r.call(o,u)&&(c[u]=o[u]);if(n){a=n(o);for(var p=0;p<a.length;p++)s.call(o,a[p])&&(c[a[p]]=o[a[p]])}}return c}},function(e,t,o){"use strict";function i(e,t,o,i,c){if("production"!=={ENV:'"production"'}.NODE_ENV)for(var l in e)if(e.hasOwnProperty(l)){var u;try{n("function"==typeof e[l],"%s: %s type `%s` is invalid; it must be a function, usually from the `prop-types` package, but received `%s`.",i||"React class",o,l,typeof e[l]),u=e[l](t,l,i,o,null,s)}catch(e){u=e}if(r(!u||u instanceof Error,"%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",i||"React class",o,l,typeof u),u instanceof Error&&!(u.message in a)){a[u.message]=!0;var p=c?c():"";r(!1,"Failed %s type: %s%s",o,u.message,null!=p?p:"")}}}if("production"!=={ENV:'"production"'}.NODE_ENV)var n=o(17),r=o(33),s=o(18),a={};e.exports=i},function(e,t,o){"use strict";var i=o(16),n=o(17),r=o(18);e.exports=function(){function e(e,t,o,i,s,a){a!==r&&n(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function t(){return e}e.isRequired=e;var o={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return o.checkPropTypes=i,o.PropTypes=o,o}},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(15),c=i(a),l=o(32),u=i(l),p=o(36),f=i(p),h=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var a=r(this,e.call.apply(e,[this].concat(i)));return a._events={},a._needsStyleFixes=!1,a._bindAll("_onSharedStateUpdate","fixStyles"),a}return s(t,e),t.prototype.fixStyles=function(){},t.prototype.componentDidMount=function(){this._bindEvents(),this.props.sharedState&&this.props.sharedState.on("update",this._onSharedStateUpdate),this._needsStyleFixes&&(this.fixStyles(),this.context.options.responsive&&window.addEventListener("resize",this.fixStyles))},t.prototype.componentWillUnmount=function(){this._unbindEvents(),this.props.sharedState&&this.props.sharedState.off("update",this._onSharedStateUpdate),this.context.options.responsive&&this._needsStyleFixes&&window.removeEventListener("resize",this.fixStyles)},t.prototype.componentWillReceiveProps=function(e){e.sharedState&&(this.props.sharedState&&this.props.sharedState.off("update",this._onSharedStateUpdate),e.sharedState.on("update",this._onSharedStateUpdate))},t.prototype._bindAll=function(){for(var e=this,t=arguments.length,o=Array(t),i=0;i<t;i++)o[i]=arguments[i];o.forEach(function(t){if("function"!=typeof e[t])throw new Error("_bindAll: "+e.constructor.name+"."+t+" is not a function.");e[t]=e[t].bind(e)})},t.prototype._t=function(e,t){return this.context.ui.translate(e,t)},t.prototype._getAssetPath=function(){var e;return(e=this.context.ui).getAssetPath.apply(e,arguments)},t.prototype._onSharedStateUpdate=function(e,t){this.sharedStateDidChange(t),this.shouldSharedComponentUpdate(e,t)&&this.forceUpdate()},t.prototype.shouldSharedComponentUpdate=function(e,t){return!0},t.prototype.sharedStateDidChange=function(e){},t.prototype.setSharedState=function(e,t){this.props.sharedState.set(e,t)},t.prototype.getSharedState=function(e){return this.props.sharedState.get(e)},t.prototype.forceSharedUpdate=function(){this.props.sharedState.broadcastUpdate()},t.prototype._bindEvents=function(){for(var e in this._events){var t=this._events[e];this.context.mediator.on(e,t)}},t.prototype._unbindEvents=function(){for(var e in this._events){var t=this._events[e];this.context.mediator.off(e,t)}},t.prototype._emitEvent=function(e){for(var t,o=arguments.length,i=Array(o>1?o-1:0),n=1;n<o;n++)i[n-1]=arguments[n];(t=this.context.mediator).emit.apply(t,[e].concat(i))},t.prototype.renderWithBEM=function(){return f.default.createElement("div")},t.prototype.render=function(){return f.default.transform(this.renderWithBEM())},t}(c.default.Component);t.default=h,h.contextTypes={editor:u.default.object,ui:u.default.object,options:u.default.object,mediator:u.default.object,editorScreen:u.default.object},h.propTypes={sharedState:u.default.any}},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(7),r=i(n),s=o(19),a=i(s),c=o(66),l=i(c),u=o(21),p=i(u),f=r.default.Utils,h=r.default.Math.Vector2,d={getInnerDimensionsForElement:function(e){var t=new h(e.offsetWidth,e.offsetHeight),o=window.getComputedStyle(e,null);return t.x-=parseInt(o.getPropertyValue("padding-left"),10),t.x-=parseInt(o.getPropertyValue("padding-right"),10),t.y-=parseInt(o.getPropertyValue("padding-top"),10),t.y-=parseInt(o.getPropertyValue("padding-bottom"),10),t},getEventPosition:function(e){var t=e.clientX,o=e.clientY;if(-1!==e.type.indexOf("touch")){if(!e.touches.length)return;t=e.touches[0].clientX,o=e.touches[0].clientY}return new h(t,o)},createTransparentPatternCanvas:function(){var e=document.createElement("canvas"),t=e.getContext("2d");return e.width=10,e.height=10,t.fillStyle="white",t.fillRect(0,0,e.width,e.height),t.fillStyle="#cccccc",t.fillRect(0,0,e.width/2,e.height/2),t.fillRect(e.width/2,e.height/2,e.width,e.height),e},supportsMSBlob:function(){return void 0!==document.createElement("canvas").msToBlob},translate:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.fetch(e,t);if(!i)return a.default.info("Utils#translate","Unable to translate `"+t+"`"),null;for(var n in o)i=i.replace("${"+n+"}",o[n]);return i},fetch:function(e,t,o){t=t.replace(/\[(\w+)]/g,".$1"),t=t.replace(/^\./,"");for(var i=t.split("."),n=0;n<i.length;n++){if(!(e=e[i[n]]))break}return void 0!==e&&e},isMobile:function(){var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))},isTouchDevice:function(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)},select:function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o||(o=function(e){return e});var i=[];return t.forEach(function(t){e.forEach(function(e){o(e)===t&&i.push(e)})}),i},getJSONP:function(e){return new p.default(e).load()},cloneCategories:function(e,t){return e.map(function(e){return e=f.clone(e),e[t]=e[t].slice(0),e})},mergeCategories:function(e,t,o){e=this.cloneCategories(e,o);var i=null;return t.forEach(function(t){e.forEach(function(e){t.identifier===e.identifier&&(i=e)}),i?i[o]=i[o].concat(t[o]):e.push(t)}),e},getStyleObject:function(e){var t=window.getComputedStyle(e),o={};for(var i in t){var n=t.getPropertyValue(i),r=i.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()});""!==n&&(o[r]=n)}return o},debounce:function(e,t,o){var i;return function(){var n=this,r=arguments,s=function(){i=null,o||e.apply(n,r)},a=o&&!i;clearTimeout(i),i=setTimeout(s,t),a&&e.apply(this,r)}},getScrollbarWidth:function(){var e=document.createElement("div");e.style.visibility="hidden",e.style.width="100px",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);var t=e.offsetWidth;e.style.overflow="scroll";var o=document.createElement("div");o.style.width="100%",e.appendChild(o);var i=o.offsetWidth;return e.parentNode.removeChild(e),t-i},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},Browser:l.default};t.default=d},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={getIEVersion:function(){var e=navigator,t=e.userAgent,o=e.appVersion;return-1!==o.indexOf("MSIE")?o.match(/MSIE\s+?([0-9]+)/i)[1]:-1!==t.indexOf("Trident")&&t.match(/rv:([0-9]+)/i)[1]},isIE10:function(){var e=this.getIEVersion();return!1!==e&&10===e},isIE11:function(){var e=this.getIEVersion();return!1!==e&&11===e},isIElte:function(e){var t=this.getIEVersion();return!1!==t&&t<=e}}},function(e,t,o){"use strict";(function(e,o){Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=void 0===o?window:o,r="undefined"!=typeof Promise?Promise:function(){function t(e,t){d.add(e,t),h||(h=_(d.drain))}function o(e){var t,o=void 0===e?"undefined":i(e);return null==e||"object"!=o&&"function"!=o||(t=e.then),"function"==typeof t&&t}function n(){for(var e=0;e<this.chain.length;e++)r(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function r(e,t,i){var n,r;try{!1===t?i.reject(e.msg):(n=!0===t?e.msg:t.call(void 0,e.msg),n===i.promise?i.reject(TypeError("Promise-chain cycle")):(r=o(n))?r.call(n,i.resolve,i.reject):i.resolve(n))}catch(e){i.reject(e)}}function s(e){var i,r=this;if(!r.triggered){r.triggered=!0,r.def&&(r=r.def);try{(i=o(e))?t(function(){var t=new l(r);try{i.call(e,function(){s.apply(t,arguments)},function(){a.apply(t,arguments)})}catch(e){a.call(t,e)}}):(r.msg=e,r.state=1,r.chain.length>0&&t(n,r))}catch(e){a.call(new l(r),e)}}}function a(e){var o=this;o.triggered||(o.triggered=!0,o.def&&(o=o.def),o.msg=e,o.state=2,o.chain.length>0&&t(n,o))}function c(e,t,o,i){for(var n=0;n<t.length;n++)!function(n){e.resolve(t[n]).then(function(e){o(n,e)},i)}(n)}function l(e){this.def=e,this.triggered=!1}function u(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function p(e){if("function"!=typeof e)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var o=new u(this);this.then=function(e,i){var r={success:"function"!=typeof e||e,failure:"function"==typeof i&&i};return r.promise=new this.constructor(function(e,t){if("function"!=typeof e||"function"!=typeof t)throw TypeError("Not a function");r.resolve=e,r.reject=t}),o.chain.push(r),0!==o.state&&t(n,o),r.promise},this.catch=function(e){return this.then(void 0,e)};try{e.call(void 0,function(e){s.call(o,e)},function(e){a.call(o,e)})}catch(e){a.call(o,e)}}var f,h,d,m=Object.prototype.toString,_=void 0!==e?function(t){return e(t)}:setTimeout;try{Object.defineProperty({},"x",{}),f=function(e,t,o,i){return Object.defineProperty(e,t,{value:o,writable:!0,configurable:!1!==i})}}catch(e){f=function(e,t,o){return e[t]=o,e}}d=function(){function e(e,t){this.fn=e,this.self=t,this.next=void 0}var t,o,i;return{add:function(n,r){i=new e(n,r),o?o.next=i:t=i,o=i,i=void 0},drain:function(){var e=t;for(t=o=h=void 0;e;)e.fn.call(e.self),e=e.next}}}();var g=f({},"constructor",p,!1);return p.prototype=g,f(g,"__NPO__",0,!1),f(p,"resolve",function(e){var t=this;return e&&"object"==(void 0===e?"undefined":i(e))&&1===e.__NPO__?e:new t(function(t,o){if("function"!=typeof t||"function"!=typeof o)throw TypeError("Not a function");t(e)})}),f(p,"reject",function(e){return new this(function(t,o){if("function"!=typeof t||"function"!=typeof o)throw TypeError("Not a function");o(e)})}),f(p,"all",function(e){var t=this;return"[object Array]"!=m.call(e)?t.reject(TypeError("Not an array")):0===e.length?t.resolve([]):new t(function(o,i){if("function"!=typeof o||"function"!=typeof i)throw TypeError("Not a function");var n=e.length,r=Array(n),s=0;c(t,e,function(e,t){r[e]=t,++s===n&&o(r)},i)})}),f(p,"race",function(e){var t=this;return"[object Array]"!=m.call(e)?t.reject(TypeError("Not an array")):new t(function(o,i){if("function"!=typeof o||"function"!=typeof i)throw TypeError("Not a function");c(t,e,function(e,t){o(t)},i)})}),p}();n.Promise=n.Promise||r,t.default=r}).call(t,o(68).setImmediate,o(10))},function(e,t,o){function i(e,t){this._id=e,this._clearFn=t}var n=Function.prototype.apply;t.setTimeout=function(){return new i(n.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new i(n.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},o(69),t.setImmediate=setImmediate,t.clearImmediate=clearImmediate},function(e,t,o){(function(e,t){!function(e,o){"use strict";function i(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),o=0;o<t.length;o++)t[o]=arguments[o+1];var i={callback:e,args:t};return l[c]=i,a(c),c++}function n(e){delete l[e]}function r(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(o,i)}}function s(e){if(u)setTimeout(s,0,e);else{var t=l[e];if(t){u=!0;try{r(t)}finally{n(e),u=!1}}}}if(!e.setImmediate){var a,c=1,l={},u=!1,p=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?function(){a=function(e){t.nextTick(function(){s(e)})}}():function(){if(e.postMessage&&!e.importScripts){var t=!0,o=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=o,t}}()?function(){var t="setImmediate$"+Math.random()+"$",o=function(o){o.source===e&&"string"==typeof o.data&&0===o.data.indexOf(t)&&s(+o.data.slice(t.length))};e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),a=function(o){e.postMessage(t+o,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){s(e.data)},a=function(t){e.port2.postMessage(t)}}():p&&"onreadystatechange"in p.createElement("script")?function(){var e=p.documentElement;a=function(t){var o=p.createElement("script");o.onreadystatechange=function(){s(t),o.onreadystatechange=null,e.removeChild(o),o=null},e.appendChild(o)}}():function(){a=function(e){setTimeout(s,0,e)}}(),f.setImmediate=i,f.clearImmediate=n}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,o(10),o(20))},function(e,t,o){"use strict";function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function n(e,t,o){if(e&&l.isObject(e)&&e instanceof i)return e;var n=new i;return n.parse(e,t,o),n}function r(e){return l.isString(e)&&(e=n(e)),e instanceof i?e.format():i.prototype.format.call(e)}function s(e,t){return n(e,!1,!0).resolve(t)}function a(e,t){return e?n(e,!1,!0).resolveObject(t):t}var c=o(71),l=o(73);t.parse=n,t.resolve=s,t.resolveObject=a,t.format=r,t.Url=i;var u=/^([a-z0-9.+-]+:)/i,p=/:[0-9]*$/,f=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,h=["<",">",'"',"`"," ","\r","\n","\t"],d=["{","}","|","\\","^","`"].concat(h),m=["'"].concat(d),_=["%","/","?",";","#"].concat(m),g=["/","?","#"],y=/^[+a-z0-9A-Z_-]{0,63}$/,b=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},E={javascript:!0,"javascript:":!0},w={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},k=o(74);i.prototype.parse=function(e,t,o){if(!l.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),n=-1!==i&&i<e.indexOf("#")?"?":"#",r=e.split(n),s=/\\/g;r[0]=r[0].replace(s,"/"),e=r.join(n);var a=e;if(a=a.trim(),!o&&1===e.split("#").length){var p=f.exec(a);if(p)return this.path=a,this.href=a,this.pathname=p[1],p[2]?(this.search=p[2],this.query=t?k.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var h=u.exec(a);if(h){h=h[0];var d=h.toLowerCase();this.protocol=d,a=a.substr(h.length)}if(o||h||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var S="//"===a.substr(0,2);!S||h&&E[h]||(a=a.substr(2),this.slashes=!0)}if(!E[h]&&(S||h&&!w[h])){for(var O=-1,C=0;C<g.length;C++){var M=a.indexOf(g[C]);-1!==M&&(-1===O||M<O)&&(O=M)}var R,B;B=-1===O?a.lastIndexOf("@"):a.lastIndexOf("@",O),-1!==B&&(R=a.slice(0,B),a=a.slice(B+1),this.auth=decodeURIComponent(R)),O=-1;for(var C=0;C<_.length;C++){var M=a.indexOf(_[C]);-1!==M&&(-1===O||M<O)&&(O=M)}-1===O&&(O=a.length),this.host=a.slice(0,O),a=a.slice(O),this.parseHost(),this.hostname=this.hostname||"";var x="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!x)for(var T=this.hostname.split(/\./),C=0,P=T.length;C<P;C++){var j=T[C];if(j&&!j.match(y)){for(var D="",I=0,F=j.length;I<F;I++)j.charCodeAt(I)>127?D+="x":D+=j[I];if(!D.match(y)){var A=T.slice(0,C),z=T.slice(C+1),N=j.match(b);N&&(A.push(N[1]),z.unshift(N[2])),z.length&&(a="/"+z.join(".")+a),this.hostname=A.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),x||(this.hostname=c.toASCII(this.hostname));var V=this.port?":"+this.port:"",L=this.hostname||"";this.host=L+V,this.href+=this.host,x&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!v[d])for(var C=0,P=m.length;C<P;C++){var U=m[C];if(-1!==a.indexOf(U)){var W=encodeURIComponent(U);W===U&&(W=escape(U)),a=a.split(U).join(W)}}var K=a.indexOf("#");-1!==K&&(this.hash=a.substr(K),a=a.slice(0,K));var H=a.indexOf("?");if(-1!==H?(this.search=a.substr(H),this.query=a.substr(H+1),t&&(this.query=k.parse(this.query)),a=a.slice(0,H)):t&&(this.search="",this.query={}),a&&(this.pathname=a),w[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var V=this.pathname||"",$=this.search||"";this.path=V+$}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",o=this.pathname||"",i=this.hash||"",n=!1,r="";this.host?n=e+this.host:this.hostname&&(n=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&l.isObject(this.query)&&Object.keys(this.query).length&&(r=k.stringify(this.query));var s=this.search||r&&"?"+r||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||w[t])&&!1!==n?(n="//"+(n||""),o&&"/"!==o.charAt(0)&&(o="/"+o)):n||(n=""),i&&"#"!==i.charAt(0)&&(i="#"+i),s&&"?"!==s.charAt(0)&&(s="?"+s),o=o.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),s=s.replace("#","%23"),t+n+o+s+i},i.prototype.resolve=function(e){return this.resolveObject(n(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if(l.isString(e)){var t=new i;t.parse(e,!1,!0),e=t}for(var o=new i,n=Object.keys(this),r=0;r<n.length;r++){var s=n[r];o[s]=this[s]}if(o.hash=e.hash,""===e.href)return o.href=o.format(),o;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),c=0;c<a.length;c++){var u=a[c];"protocol"!==u&&(o[u]=e[u])}return w[o.protocol]&&o.hostname&&!o.pathname&&(o.path=o.pathname="/"),o.href=o.format(),o}if(e.protocol&&e.protocol!==o.protocol){if(!w[e.protocol]){for(var p=Object.keys(e),f=0;f<p.length;f++){var h=p[f];o[h]=e[h]}return o.href=o.format(),o}if(o.protocol=e.protocol,e.host||E[e.protocol])o.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),o.pathname=d.join("/")}if(o.search=e.search,o.query=e.query,o.host=e.host||"",o.auth=e.auth,o.hostname=e.hostname||e.host,o.port=e.port,o.pathname||o.search){var m=o.pathname||"",_=o.search||"";o.path=m+_}return o.slashes=o.slashes||e.slashes,o.href=o.format(),o}var g=o.pathname&&"/"===o.pathname.charAt(0),y=e.host||e.pathname&&"/"===e.pathname.charAt(0),b=y||g||o.host&&e.pathname,v=b,k=o.pathname&&o.pathname.split("/")||[],d=e.pathname&&e.pathname.split("/")||[],S=o.protocol&&!w[o.protocol];if(S&&(o.hostname="",o.port=null,o.host&&(""===k[0]?k[0]=o.host:k.unshift(o.host)),o.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),b=b&&(""===d[0]||""===k[0])),y)o.host=e.host||""===e.host?e.host:o.host,o.hostname=e.hostname||""===e.hostname?e.hostname:o.hostname,o.search=e.search,o.query=e.query,k=d;else if(d.length)k||(k=[]),k.pop(),k=k.concat(d),o.search=e.search,o.query=e.query;else if(!l.isNullOrUndefined(e.search)){if(S){o.hostname=o.host=k.shift();var O=!!(o.host&&o.host.indexOf("@")>0)&&o.host.split("@");O&&(o.auth=O.shift(),o.host=o.hostname=O.shift())}return o.search=e.search,o.query=e.query,l.isNull(o.pathname)&&l.isNull(o.search)||(o.path=(o.pathname?o.pathname:"")+(o.search?o.search:"")),o.href=o.format(),o}if(!k.length)return o.pathname=null,o.search?o.path="/"+o.search:o.path=null,o.href=o.format(),o;for(var C=k.slice(-1)[0],M=(o.host||e.host||k.length>1)&&("."===C||".."===C)||""===C,R=0,B=k.length;B>=0;B--)C=k[B],"."===C?k.splice(B,1):".."===C?(k.splice(B,1),R++):R&&(k.splice(B,1),R--);if(!b&&!v)for(;R--;R)k.unshift("..");!b||""===k[0]||k[0]&&"/"===k[0].charAt(0)||k.unshift(""),M&&"/"!==k.join("/").substr(-1)&&k.push("");var x=""===k[0]||k[0]&&"/"===k[0].charAt(0);if(S){o.hostname=o.host=x?"":k.length?k.shift():"";var O=!!(o.host&&o.host.indexOf("@")>0)&&o.host.split("@");O&&(o.auth=O.shift(),o.host=o.hostname=O.shift())}return b=b||o.host&&k.length,b&&!x&&k.unshift(""),k.length?o.pathname=k.join("/"):(o.pathname=null,o.path=null),l.isNull(o.pathname)&&l.isNull(o.search)||(o.path=(o.pathname?o.pathname:"")+(o.search?o.search:"")),o.auth=e.auth||o.auth,o.slashes=o.slashes||e.slashes,o.href=o.format(),o},i.prototype.parseHost=function(){var e=this.host,t=p.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,o){(function(e,i){var n;!function(r){function s(e){throw new RangeError(P[e])}function a(e,t){for(var o=e.length,i=[];o--;)i[o]=t(e[o]);return i}function c(e,t){var o=e.split("@"),i="";return o.length>1&&(i=o[0]+"@",e=o[1]),e=e.replace(T,"."),i+a(e.split("."),t).join(".")}function l(e){for(var t,o,i=[],n=0,r=e.length;n<r;)t=e.charCodeAt(n++),t>=55296&&t<=56319&&n<r?(o=e.charCodeAt(n++),56320==(64512&o)?i.push(((1023&t)<<10)+(1023&o)+65536):(i.push(t),n--)):i.push(t);return i}function u(e){return a(e,function(e){var t="";return e>65535&&(e-=65536,t+=I(e>>>10&1023|55296),e=56320|1023&e),t+=I(e)}).join("")}function p(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:E}function f(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function h(e,t,o){var i=0;for(e=o?D(e/O):e>>1,e+=D(e/t);e>j*k>>1;i+=E)e=D(e/j);return D(i+(j+1)*e/(e+S))}function d(e){var t,o,i,n,r,a,c,l,f,d,m=[],_=e.length,g=0,y=M,b=C;for(o=e.lastIndexOf(R),o<0&&(o=0),i=0;i<o;++i)e.charCodeAt(i)>=128&&s("not-basic"),m.push(e.charCodeAt(i));for(n=o>0?o+1:0;n<_;){for(r=g,a=1,c=E;n>=_&&s("invalid-input"),l=p(e.charCodeAt(n++)),(l>=E||l>D((v-g)/a))&&s("overflow"),g+=l*a,f=c<=b?w:c>=b+k?k:c-b,!(l<f);c+=E)d=E-f,a>D(v/d)&&s("overflow"),a*=d;t=m.length+1,b=h(g-r,t,0==r),D(g/t)>v-y&&s("overflow"),y+=D(g/t),g%=t,m.splice(g++,0,y)}return u(m)}function m(e){var t,o,i,n,r,a,c,u,p,d,m,_,g,y,b,S=[];for(e=l(e),_=e.length,t=M,o=0,r=C,a=0;a<_;++a)(m=e[a])<128&&S.push(I(m));for(i=n=S.length,n&&S.push(R);i<_;){for(c=v,a=0;a<_;++a)(m=e[a])>=t&&m<c&&(c=m);for(g=i+1,c-t>D((v-o)/g)&&s("overflow"),o+=(c-t)*g,t=c,a=0;a<_;++a)if(m=e[a],m<t&&++o>v&&s("overflow"),m==t){for(u=o,p=E;d=p<=r?w:p>=r+k?k:p-r,!(u<d);p+=E)b=u-d,y=E-d,S.push(I(f(d+b%y,0))),u=D(b/y);S.push(I(f(u,0))),r=h(o,g,i==n),o=0,++i}++o,++t}return S.join("")}function _(e){return c(e,function(e){return B.test(e)?d(e.slice(4).toLowerCase()):e})}function g(e){return c(e,function(e){return x.test(e)?"xn--"+m(e):e})}var y=("object"==typeof t&&t&&t.nodeType,"object"==typeof e&&e&&e.nodeType,"object"==typeof i&&i);var b,v=2147483647,E=36,w=1,k=26,S=38,O=700,C=72,M=128,R="-",B=/^xn--/,x=/[^\x20-\x7E]/,T=/[\x2E\u3002\uFF0E\uFF61]/g,P={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},j=E-w,D=Math.floor,I=String.fromCharCode;b={version:"1.4.1",ucs2:{decode:l,encode:u},decode:d,encode:m,toASCII:g,toUnicode:_},void 0!==(n=function(){return b}.call(t,o,t,e))&&(e.exports=n)}()}).call(t,o(72)(e),o(10))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,o){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,o){"use strict";t.decode=t.parse=o(75),t.encode=t.stringify=o(76)},function(e,t,o){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,o,r){t=t||"&",o=o||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var c=1e3;r&&"number"==typeof r.maxKeys&&(c=r.maxKeys);var l=e.length;c>0&&l>c&&(l=c);for(var u=0;u<l;++u){var p,f,h,d,m=e[u].replace(a,"%20"),_=m.indexOf(o);_>=0?(p=m.substr(0,_),f=m.substr(_+1)):(p=m,f=""),h=decodeURIComponent(p),d=decodeURIComponent(f),i(s,h)?n(s[h])?s[h].push(d):s[h]=[s[h],d]:s[h]=d}return s};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,o){"use strict";function i(e,t){if(e.map)return e.map(t);for(var o=[],i=0;i<e.length;i++)o.push(t(e[i],i));return o}var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,o,a){return t=t||"&",o=o||"=",null===e&&(e=void 0),"object"==typeof e?i(s(e),function(s){var a=encodeURIComponent(n(s))+o;return r(e[s])?i(e[s],function(e){return a+encodeURIComponent(n(e))}).join(t):a+encodeURIComponent(n(e[s]))}).join(t):a?encodeURIComponent(n(a))+o+encodeURIComponent(n(e)):""};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=Object.keys||function(e){var t=[];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.push(o);return t}},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(7),n=function(e){return e&&e.__esModule?e:{default:e}}(i);t.default={EVENTS:{RENDER:"render",EXPORT:"export",CLOSE:"close",ZOOM_DONE:"zoom:done",OPERATION_CREATED:"operation:created",OPERATION_UPDATED:"operation:updated",OPERATION_REMOVED:"operation:removed",FEATURES_DISABLED:"editor:features:disabled",FEATURES_ENABLED:"editor:features:enabled",FEATURES_UPDATED:"editor:features:updated",COLORPICKER_OPEN:"colorpicker:open",HISTORY_UPDATED:"history:update",HISTORY_BEFORE_UNDO:"history:before_undo",HISTORY_UNDO:"history:undo",WINDOW_RESIZE:"window:resize",CONTROLS_SWITCHED:"controls:switched",TRANSFORM_REAPPLY_RATIO:"transform:reapply_ratio"},DEFAULTS:{TRANSFORM_RATIOS:[[{identifier:"imgly_transform_common_custom",defaultName:"Custom",ratio:"*",selected:!0},{identifier:"imgly_transform_common_square",defaultName:"Square",ratio:1},{identifier:"imgly_transform_common_4-3",defaultName:"4:3",ratio:1.33},{identifier:"imgly_transform_common_16-9",defaultName:"16:9",ratio:1.77}],[{identifier:"imgly_transform_facebook_profile",defaultName:"FB Profile",ratio:1},{identifier:"imgly_transform_facebook_ad",defaultName:"FB Ad",dimensions:new n.default.Math.Vector2(1200,627)},{identifier:"imgly_transform_facebook_post",defaultName:"FB Post",dimensions:new n.default.Math.Vector2(940,788)},{identifier:"imgly_transform_facebook_cover",defaultName:"FB Cover",dimensions:new n.default.Math.Vector2(851,315)}]],BRUSHES:[n.default.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush],FONTS:[{fontFamily:"Aleo",variations:[{identifier:"imgly_font_aleo_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_aleo_bold.woff"}]},{fontFamily:"Amatic SC",variations:[{identifier:"imgly_font_amaticsc",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_amaticsc.woff"}]},{fontFamily:"Bernier",variations:[{identifier:"imgly_font_bernier_regular",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_bernier_regular.woff"}]},{fontFamily:"Cheque",variations:[{identifier:"imgly_font_cheque_regular",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_cheque_regular.woff"}]},{fontFamily:"Open Sans",variations:[{identifier:"imgly_font_open_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_open_sans_bold.woff",default:!0}]},{fontFamily:"Gagalin",variations:[{identifier:"imgly_font_gagalin_regular",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_gagalin_regular.woff"}]},{fontFamily:"Hagin",variations:[{identifier:"imgly_font_hagin_caps_thin",fontWeight:200,provider:"file",filePath:"fonts/imgly_font_hagin_caps_thin.woff"}]},{fontFamily:"Intro",variations:[{identifier:"imgly_font_intro_inline",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_intro_inline.woff"}]},{fontFamily:"Lobster",variations:[{identifier:"imgly_font_lobster",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_lobster.woff"}]},{fontFamily:"Nexa",variations:[{identifier:"imgly_font_nexa_script",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_nexa_script.woff"}]},{fontFamily:"Ostrich",variations:[{identifier:"imgly_font_ostrich_sans_black",fontWeight:800,provider:"file",filePath:"fonts/imgly_font_ostrich_sans_black.woff"},{identifier:"imgly_font_ostrich_sans_bold",fontWeight:"bold",provider:"file",filePath:"fonts/imgly_font_ostrich_sans_bold.woff"}]},{fontFamily:"Panton",variations:[{identifier:"imgly_font_panton_blackitalic_caps",fontWeight:800,fontStyle:"italic",provider:"file",filePath:"fonts/imgly_font_panton_blackitalic_caps.woff"},{identifier:"imgly_font_panton_lightitalic_caps",fontWeight:200,fontStyle:"italic",provider:"file",filePath:"fonts/imgly_font_panton_lightitalic_caps.woff"}]},{fontFamily:"Perfograma",variations:[{identifier:"imgly_font_perfograma",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_perfograma.woff"}]},{fontFamily:"Trashhand",variations:[{identifier:"imgly_font_trash_hand",fontWeight:"normal",provider:"file",filePath:"fonts/imgly_font_trash_hand.woff"}]}]}}},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=o(7),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=c.default.EventEmitter,u=c.default.Utils,p=c.default.Log,f=function(e){function t(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,t);var r=n(this,e.call(this));return r._state=o,r}return r(t,e),t.prototype.set=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];"object"!==(void 0===e?"undefined":s(e))&&p.warn("SharedState#set expects an object as first parameter");var o=u.extend({},this._state);this._state=u.extend(this._state,e),t&&this.broadcastUpdate(o,this._state)},t.prototype.get=function(e){return this._state[e]},t.prototype.broadcastUpdate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.emit("update",e,t)},t.prototype.clear=function(){this._state={}},t}(l);t.default=f},function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});for(var o="undefined"==typeof window?e:window,i=o.requestAnimationFrame,n=o.cancelAnimationFrame,r=0,s=["ms","moz","webkit","o"],a=0;a<s.length&&!i;++a)t.requestAnimationFrame=i=o[s[a]+"RequestAnimationFrame"],t.cancelAnimationFrame=n=o[s[a]+"CancelAnimationFrame"]||o[s[a]+"CancelRequestAnimationFrame"];i&&(t.requestAnimationFrame=i=i.bind(o)),n&&(t.cancelAnimationFrame=n=n.bind(o)),i||(t.requestAnimationFrame=i=function(e,t){var o=(new Date).getTime(),i=Math.max(0,16-(o-r)),n=setTimeout(function(){e(o+i)},i);return r=o+i,n}),n||(t.cancelAnimationFrame=n=function(e){clearTimeout(e)}),t.requestAnimationFrame=i,t.cancelAnimationFrame=n}).call(t,o(10))},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(0),l=o(81),u=i(l),p=o(83),f=i(p),h=o(90),d=i(h),m=o(100),_=i(m),g=o(103),y=i(g),b=o(8),v=i(b),E=o(180),w=i(E),k=o(1),S=i(k),O=function(e){function t(){r(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];var c=s(this,e.call.apply(e,[this].concat(i)));c._screens={loading:u.default,splash:f.default,photoRoll:d.default,webcam:_.default,editor:y.default,empty:v.default};var l=void 0;return c.props.options.preloader&&(l="loading"),c._screenAfterLoading="splash",c.props.options.editor.image&&(c._screenAfterLoading="editor"),l||(l=c._screenAfterLoading),c._previousScreensStack=[],c.state={activeScreen:c._screens[l],activeScreenName:l,screens:n({},l,c._screens[l])},c}return a(t,e),t.prototype.hasPreviousScreen=function(){return!!this._previousScreensStack.length},t.prototype.getPreviousScreen=function(){var e=this._previousScreensStack;return e[e.length-1]},t.prototype.switchToScreen=function(e){var t=this,o=null;if("back"===e){if(!(o=this._previousScreensStack.pop()))throw new Error("Unable to switch to previous screen - no previous screen found.")}else{if("post-loading"===e&&(e=this._screenAfterLoading),!(o=this._screens[e]))throw new Error("Unknown screen `"+e+"`");this._previousScreensStack.push(this.state.activeScreen)}return this.state.screens[e]||(this.state.screens[e]=o),"editor"!==this.state.activeScreenName&&delete this.state.screens[this.state.activeScreenName],new c.Promise(function(i){t.setState({activeScreen:o,activeScreenName:e},function(){i()})})},t.prototype.setImage=function(e,t){var o=this;this.props.options.editor.image=e;var i=!this.refs.editorScreen;this.switchToScreen("editor").then(function(){i||o.refs.editorScreen.setImage(e,t)})},t.prototype.export=function(){if(this.state.activeScreen!==this._screens.editor)return c.Promise.reject(new Error("Unable to export: Active screen is not the editor screen."));if(this.state.screens.editor){var e;return(e=this.refs.editorScreen).export.apply(e,arguments)}},t.prototype.getEditor=function(){return this.state.activeScreen!==this._screens.editor?c.Promise.reject(new Error("Unable to get editor: Active screen is not the editor screen.")):this.state.screens.editor?this.refs.editorScreen.getEditor():void 0},t.prototype.serialize=function(){var e;return this.state.screens.editor?(e=this.refs.editorScreen).serialize.apply(e,arguments):c.Promise.reject(new Error("Editor screen unavailable"))},t.prototype.deserialize=function(e){return this.state.screens.editor?this.refs.editorScreen.deserialize(e):c.Promise.reject(new Error("Editor screen unavailable"))},t.prototype.getChildContext=function(){return{ui:this.props.ui,options:this.props.options,mediator:this.props.mediator}},t.prototype._renderScreens=function(){var e=[];for(var t in this.state.screens){var o=this.state.screens[t],i=this.state.activeScreen===o;e.push(c.ReactBEM.createElement(o,{ref:t+"Screen",app:this,visible:i}))}return e},t.prototype.render=function(){return c.ReactBEM.transform(c.ReactBEM.createElement("div",{bem:"b:editor"},c.ReactBEM.createElement(w.default,{modalManager:S.default.instance}),this._renderScreens()))},t}(c.React.Component);t.default=O,O.childContextTypes={ui:c.PropTypes.object.isRequired,mediator:c.PropTypes.object.isRequired,options:c.PropTypes.object.isRequired},O.propTypes={ui:c.PropTypes.object.isRequired,mediator:c.PropTypes.object.isRequired,options:c.PropTypes.object.isRequired}},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(8),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a.state={progress:0},a._preloader=a.context.ui.getPreloader(),a._preloader.on("progress",function(e){a.state.progress=e}),a._preloader.on("done",function(){a.props.app.switchToScreen("post-loading")}),a}return r(t,e),t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this);var o=window,i=o.devicePixelRatio;this._canvas=this.refs.canvas,this._canvas.width=this._canvas.offsetWidth*i,this._canvas.height=this._canvas.offsetHeight*i,this._context=this._canvas.getContext("2d"),this._preloaderImage=new window.Image,this._preloaderImage.addEventListener("load",function(){t._preloader.load(),(0,s.requestAnimationFrame)(t._tick)}),this._preloaderImage.crossOrigin="Anonymous",this._preloaderImage.src=this.context.ui.getAssetPath("preloader.png",!0),this._running=!0,this._tick=this._tick.bind(this)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this._running=!1},t.prototype._tick=function(){this._renderLoadingIndicator(),this._running&&(0,s.requestAnimationFrame)(this._tick)},t.prototype._renderLoadingIndicator=function(){var e=this._canvas,t=e.width,o=e.height,i=this._context;i.clearRect(0,0,t,o),i.save(),i.beginPath(),i.moveTo(t/2,o/2),i.arc(t/2,o/2,t/2,.5*-Math.PI,2*Math.PI*this.state.progress-.5*Math.PI,!1),i.lineTo(t/2,o/2),i.clip(),i.drawImage(this._preloaderImage,0,0,this._preloaderImage.width,this._preloaderImage.height,0,0,t,o),i.restore(),i.save(),i.globalAlpha=.05,i.drawImage(this._preloaderImage,0,0,this._preloaderImage.width,this._preloaderImage.height,0,0,t,o),i.restore()},t.prototype._renderScreen=function(){return s.ReactBEM.createElement("div",{bem:"$b:loadingScreen"},s.ReactBEM.createElement("div",{bem:"e:container"},s.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"})))},t}(c.default);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a._bindAll("_onCloseClick"),a}return r(t,e),t.prototype._onCloseClick=function(){this.context.mediator.emit(s.Constants.EVENTS.CLOSE)},t.prototype.renderWithBEM=function(){var e=void 0;return this.context.options.showCloseButton&&(e=s.ReactBEM.createElement("div",{bem:"$e:close",onClick:this._onCloseClick},s.ReactBEM.createElement("img",{bem:"e:image",src:this._getAssetPath("close.png",!0)}))),s.ReactBEM.createElement("div",{bem:"$b:header"},s.ReactBEM.createElement("div",{bem:"e:label"},this.context.options.title),e)},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(8),l=i(c),u=o(84),p=i(u),f=o(88),h=i(f),d=o(89),m=i(d),_=function(e){function t(){n(this,t);var o=r(this,e.call(this));return o._bindAll("_onWebcamClick","_onPhotoRollClick","_onImage"),o}return s(t,e),t.prototype._onPhotoRollClick=function(){this.props.app.switchToScreen("photoRoll")},t.prototype._onWebcamClick=function(){this.props.app.switchToScreen("webcam")},t.prototype._onImage=function(e){this.props.app.setImage(e)},t.prototype._isWebcamAvailable=function(){return!a.Utils.isMobile()&&!1!==this.context.options.enableWebcam},t.prototype._isPhotoRollAvailable=function(){return!!this.context.options.photoRoll.provider},t.prototype._renderScreen=function(){var e=[],t=0,o=this.context.options.enableUpload;o&&t++;var i=this._isWebcamAvailable();i&&t++;var n=this._isPhotoRollAvailable();return n&&t++,o&&e.push(a.ReactBEM.createElement(p.default,{onImage:this._onImage,totalRows:t})),i&&e.push(a.ReactBEM.createElement(h.default,{onClick:this._onWebcamClick,totalRows:t})),n&&e.push(a.ReactBEM.createElement(m.default,{onClick:this._onPhotoRollClick,totalRows:t})),a.ReactBEM.createElement("div",{bem:"$b:splashScreen"},a.ReactBEM.createElement("div",{bem:"e:container"},e))},t}(l.default);t.default=_,_.contextTypes=a.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},c=o(0),l=o(1),u=i(l),p=o(23),f=i(p),h=o(85),d=i(h),m=o(24),_=i(m),g=function(e){function t(){n(this,t);var o=r(this,e.call(this));return o._modifier="upload",o._bindAll("_onImage","_onDragEnter","_onDragOver","_onDragLeave","_onDrop"),o._dragCounter=0,o.state={dragAreaHovered:!1},o}return s(t,e),t.prototype._onDragEnter=function(e){e.preventDefault(),this._dragCounter++,this.setState({dragAreaHovered:!0})},t.prototype._onDragOver=function(e){e.preventDefault()},t.prototype._onDragLeave=function(e){e.preventDefault(),0===--this._dragCounter&&this.setState({dragAreaHovered:!1})},t.prototype._onDrop=function(e){var t=this;e.stopPropagation(),e.preventDefault(),e=e.nativeEvent,e.returnValue=!1,this.setState({dragAreaHovered:!1},function(){if(e.dataTransfer)return e.dataTransfer.files[0].type.match(/^image\//i)?void t._handleFile(e.dataTransfer.files[0]):u.default.instance.displayError(t._t("errors.title"),t._t("errors.invalidFileType.text",{fileType:e.dataTransfer.files[0].type}))})},t.prototype._onClick=function(e){this.refs.upload.open()},t.prototype._handleFile=function(e){var t=this,o=new window.FileReader;o.onload=function(){return function(e){var o=e.target.result,i=new window.Image;i.addEventListener("load",function(){t._onImage(i)}),i.src=o}}(),o.readAsDataURL(e)},t.prototype._onImage=function(e){this.props.onImage&&this.props.onImage(e)},t.prototype._renderContent=function(){var e={onDragEnter:this._onDragEnter,onDragOver:this._onDragOver,onDragLeave:this._onDragLeave,onDrop:this._onDrop};this.state.dragAreaHovered&&(e.className="is-hovered");var t="e:contentCell";return!1===this.context.options.enableWebcam&&null===this.context.options.photoRoll.provider||(t+=" m:withBorder"),c.ReactBEM.createElement("div",{bem:"e:contentWrapper"},c.ReactBEM.createElement("div",{bem:"e:contentRow"},c.ReactBEM.createElement("div",a({bem:t,onClick:this._onClick},e),c.ReactBEM.createElement(_.default,{ref:"upload",onNewFile:this._onImage}),c.ReactBEM.createElement(d.default,{bem:"e:button",uppercase:!0},this._t("splash.upload.button")),c.ReactBEM.createElement("div",{bem:"e:description"},this._t("splash.upload.description")))))},t}(f.default);t.default=g,g.propTypes={onImage:c.PropTypes.func.isRequired},g.contextTypes=f.default.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.renderWithBEM=function(){var e="b:button";return this.props.uppercase&&(e+=" m:uppercase"),s.ReactBEM.createElement("button",{bem:e,className:this.props.className,onClick:this.props.onClick},this.props.children)},t}(s.BaseComponent);t.default=a,a.propTypes={onClick:s.PropTypes.func,children:s.PropTypes.any.isRequired,className:s.PropTypes.string},a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(87),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(o){i(this,t);var r=n(this,e.call(this));return r._input=o,r._onFileChange=r._onFileChange.bind(r),r._input.addEventListener("change",r._onFileChange),r}return r(t,e),t.prototype.open=function(){this._input.value=null,this._input.click()},t.prototype._handleFile=function(e){var t=this,o=new window.FileReader;o.onload=function(){return function(e){var o=e.target.result,i=new window.Image;i.addEventListener("load",function(){t.emit("file",i)}),i.addEventListener("error",function(e){return c.default.instance.displayError(t._t("errors.title"),t._t("errors.imageLoadingError.text"))}),i.src=o}}(),o.readAsDataURL(e)},t.prototype._onFileChange=function(){var e=this._input.files;e.length&&this._handleFile(e[0])},t.prototype.dispose=function(){this._input.removeEventListener("change",this._onFileChange)},t}(s.EventEmitter);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,o,i){return o&&e(t.prototype,o),i&&e(t,i),t}}(),a=o(0),c=function(e){function t(o,r,s){var c=arguments.length>3&&void 0!==arguments[3]&&arguments[3];i(this,t);var l=n(this,e.call(this));return l.id=a.SDKUtils.getUUID(),l.type=o,l.title=r,l.text=s,l.overlay=c,l.visible=!0,l.data=null,l}return r(t,e),t.prototype.setData=function(e){this.data=e,this.emit("update")},t.prototype.close=function(){this.visible=!1,this.emit("close")},t.prototype.remove=function(){this.emit("remove")},t}(a.EventEmitter),l=function(e){function t(){i(this,t);var o=n(this,e.call(this));return o._modals=[],o}return r(t,e),t.prototype.displayLoading=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=new c("loading",e,null,t);return this.addModal(o),o},t.prototype.displayProgress=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=new c("progress",null,e);return o.setData({progress:t}),this.addModal(o),o},t.prototype.displayWarning=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["OK"],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=new c("warning",e,t,i);return n.setData({buttons:o}),this.addModal(n),n},t.prototype.displayError=function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=new c("error",e,t,o);return this.addModal(i),i},t.prototype.addModal=function(e){var t=this;this._modals.push(e),e.on("close",function(){t.emit("update")}),e.on("remove",function(){t.removeModal(e)}),e.on("update",function(){t.emit("update")}),this.emit("update")},t.prototype.removeModal=function(e){var t=this._modals.indexOf(e);this._modals.splice(t,1),this.emit("update")},t.prototype.getModals=function(){return this._modals},s(t,null,[{key:"instance",get:function(){return this._instance||(this._instance=new t),this._instance}}]),t}(a.EventEmitter);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(23),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a._needsStyleFixes=!0,a._modifier="webcam",a}return r(t,e),t.prototype.fixStyles=function(){if(s.Utils.Browser.isIElte(11)){var e=this.refs,t=e.cell,o=e.overlay,i=t.offsetHeight;o.style.height=i+"px"}},t.prototype._renderContent=function(){var e={backgroundImage:"url("+this._getAssetPath("splash/webcam.png",!0,!0)+")"};return s.ReactBEM.createElement("div",{bem:"e:contentWrapper"},s.ReactBEM.createElement("div",{bem:"e:contentRow"},s.ReactBEM.createElement("div",{bem:"e:contentCell",onClick:this._onClick,style:e,ref:"cell"},s.ReactBEM.createElement("div",{bem:"e:overlay",ref:"overlay"}),s.ReactBEM.createElement("div",{bem:"e:headline"},this._t("splash.webcam.headline")),s.ReactBEM.createElement("div",{bem:"e:description"},this._t("splash.webcam.description")))))},t}(c.default);t.default=l,l.contextTypes=c.default.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(23),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a._needsStyleFixes=!0,a._modifier="photoRoll",a}return r(t,e),t.prototype.fixStyles=function(){if(s.Utils.Browser.isIElte(11)){var e=this.refs,t=e.cell,o=e.overlay,i=t.offsetHeight;o.style.height=i+"px"}},t.prototype._renderContent=function(){var e={backgroundImage:"url("+this._getAssetPath("splash/photo-roll.png",!0,!0)+")"};return s.ReactBEM.createElement("div",{bem:"e:contentWrapper"},s.ReactBEM.createElement("div",{bem:"e:contentRow"},s.ReactBEM.createElement("div",{bem:"e:contentCell",onClick:this._onClick,style:e,ref:"cell"},s.ReactBEM.createElement("div",{bem:"e:overlay",ref:"overlay"}),s.ReactBEM.createElement("div",{bem:"e:headline"},this._t("splash.photoRoll.headline")),s.ReactBEM.createElement("div",{bem:"e:description"},this._t("splash.photoRoll.description")))))},t}(c.default);t.default=l,l.contextTypes=c.default.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(8),l=i(c),u=o(91),p=i(u),f=o(95),h=i(f),d=o(40),m=i(d),_=o(98),g=i(_),y=o(1),b=i(y),v=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var a=r(this,e.call.apply(e,[this].concat(i)));return a.state={section:"overview",sectionsHistory:[]},a._bindAll("_onLibraryClicked","_onSearchSuggestionClicked","_onPhotoClicked","_onFileUpload","_onWebcamClick","_onBackClicked","_onSearch"),a}return s(t,e),t.prototype.hasPreviousSection=function(){return!!this.state.sectionsHistory.length},t.prototype.switchToSection=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if("back"===e){if(!this.hasPreviousSection())return t?this.props.app.switchToScreen("back"):this.switchToSection("overview");e=this.state.sectionsHistory.pop()}else this.state.section!==e&&o&&this.state.sectionsHistory.push(this.state.section);this.setState({section:e})},t.prototype._onLibraryClicked=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.state.library=e,this.switchToSection("library",!0,!t)},t.prototype._onSearchSuggestionClicked=function(e){this.state.searchQuery=e.query,this.switchToSection("search")},t.prototype._onPhotoClicked=function(e){var t=this,o=b.default.instance.displayLoading(this._t("loading.loading")),i=new window.Image;i.addEventListener("load",function(){o.close(),t.props.app.setImage(i,!0)}),i.addEventListener("error",function(){o.close(),b.default.instance.displayError(t._t("errors.imageLoadFail.title"),t._t("errors.imageLoadFail.text",{path:i.src}))}),i.crossOrigin="Anonymous",i.src=e.urls.raw},t.prototype._onBackClicked=function(){this.switchToSection("back")},t.prototype._onSearch=function(e){if(!e.trim().length)return this.state.searchQuery=null,this.switchToSection("back",!1);this.state.searchQuery=e,this.switchToSection("search")},t.prototype._onWebcamClick=function(){this.props.app.switchToScreen("webcam")},t.prototype._onFileUpload=function(e){this.props.app.setImage(e)},t.prototype._isBackButtonVisible=function(){return 0!==this.state.sectionsHistory.length||this.props.app.hasPreviousScreen()},t.prototype._renderContent=function(){switch(this.state.section){case"search":return a.ReactBEM.createElement(g.default,{query:this.state.searchQuery,onPhotoClicked:this._onPhotoClicked,onSearchSuggestionClicked:this._onSearchSuggestionClicked});case"library":return a.ReactBEM.createElement(m.default,{library:this.state.library,onPhotoClicked:this._onPhotoClicked});case"overview":return a.ReactBEM.createElement(h.default,{onLibraryClicked:this._onLibraryClicked,onSearchSuggestionClicked:this._onSearchSuggestionClicked})}},t.prototype._renderScreen=function(){var e=this._renderContent();return a.ReactBEM.createElement("div",{bem:"$b:photoRollScreen"},a.ReactBEM.createElement(p.default,{onBackClicked:this._onBackClicked,onSearch:this._onSearch,searchQuery:this.state.searchQuery,onFileUpload:this._onFileUpload,onWebcamClick:this._onWebcamClick,backButton:this._isBackButtonVisible(),backButtonLabel:this._t("generic.back"),ref:"topBarControls"}),e)},t}(l.default);t.default=v,v.childContextTypes={ui:a.PropTypes.object.isRequired,editor:a.PropTypes.object.isRequired,mediator:a.PropTypes.object.isRequired,options:a.PropTypes.object.isRequired,editorScreen:a.PropTypes.object.isRequired},v.contextTypes=l.default.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(12),l=i(c),u=o(92),p=i(u),f=o(24),h=i(f),d=o(93),m=i(d),_=o(94),g=i(_),y=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var c=r(this,e.call.apply(e,[this].concat(i)));return c._bindAll("_onUploadButtonClicked","_onWebcamButtonClicked","_onBackClicked","_onSearchValueChange","_onNewFile"),c._onSearchValueChange=a.Utils.debounce(c._onSearchValueChange,250),c}return s(t,e),t.prototype._onBackClicked=function(){this.props.onBackClicked&&this.props.onBackClicked()},t.prototype._onSearchValueChange=function(e){this.props.onSearch&&this.props.onSearch(e)},t.prototype._onUploadButtonClicked=function(){this.refs.upload.open()},t.prototype._onWebcamButtonClicked=function(){this.props.onWebcamClick&&this.props.onWebcamClick()},t.prototype._onNewFile=function(e){this.props.onFileUpload&&this.props.onFileUpload(e)},t.prototype._isWebcamAvailable=function(){return!a.Utils.isMobile()&&!1!==this.context.options.enableWebcam},t.prototype._renderRightButtons=function(){var e=this.context.options,t=[];return e.enableUpload&&t.push(a.ReactBEM.createElement(p.default,{icon:this._getAssetPath("photo-roll/upload.png",!0),onClick:this._onUploadButtonClicked})),this._isWebcamAvailable()&&t.push(a.ReactBEM.createElement(p.default,{icon:this._getAssetPath("photo-roll/webcam.png",!0),onClick:this._onWebcamButtonClicked})),t},t.prototype.renderWithBEM=function(){var e=void 0;return this.props.backButton&&(e=a.ReactBEM.createElement(g.default,{label:this.props.backButtonLabel,onClick:this._onBackClicked})),a.ReactBEM.createElement("div",{bem:"$b:topBar e:row"},a.ReactBEM.createElement("div",{bem:"e:cell"},a.ReactBEM.createElement("div",{bem:"e:table"},a.ReactBEM.createElement("div",{bem:"e:cell m:left"},e),a.ReactBEM.createElement("div",{bem:"e:cell m:fullWidth"},a.ReactBEM.createElement(m.default,{searchQuery:this.props.searchQuery,onChange:this._onSearchValueChange}),a.ReactBEM.createElement(h.default,{onNewFile:this._onNewFile,ref:"upload"})),a.ReactBEM.createElement("div",{bem:"e:cell m:right"},this._renderRightButtons()))))},t}(l.default);t.default=y,y.contextTypes=l.default.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("bem",{specifier:"$b:topBar"},s.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this.props.onClick},s.ReactBEM.createElement("img",{bem:"e:icon",src:this.props.icon})))},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a._bindAll("_onFocus","_onBlur","_onChange","_onBarClick"),a.state={active:!1,placeholder:a._t("photoRoll.search.placeholder"),value:a.props.searchQuery||""},a}return r(t,e),t.prototype.componentWillReceiveProps=function(e){e.searchQuery||this.state.value?this.state.active=!0:this.state.active=!1,this.setState({value:e.searchQuery||""})},t.prototype.componentDidUpdate=function(){this.refs.input.value=this.state.value},t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this),this._hiddenInputDummy=document.createElement("div");var o=s.Utils.getStyleObject(this.refs.input);["font","lineHeight","textAlign","textIndent","textTransform","textDecoration","textRendering","textShadow","textOverflow","wordSpacing","letterSpacing","whiteSpace"].forEach(function(e){t._hiddenInputDummy.style[e]=o[e]}),this._hiddenInputDummy.style.position="absolute",this._hiddenInputDummy.style.top="-9999px",this._hiddenInputDummy.style.left="-9999px",this.refs.root.appendChild(this._hiddenInputDummy),this._updateInputWidth()},t.prototype._updateInputWidth=function(){var e=this;this._hiddenInputDummy.innerHTML=this.state.value||this.state.placeholder,setTimeout(function(){e.setState({inputWidth:e._hiddenInputDummy.offsetWidth+5})},0)},t.prototype._onBarClick=function(){this.refs.input.focus()},t.prototype._onFocus=function(){this.setState({active:!0})},t.prototype._onBlur=function(){""!==this.state.value||this.props.searchQuery||this.setState({active:!1})},t.prototype._onChange=function(e){this.state.value=e.target.value,this.forceUpdate(),this.props.onChange&&this.props.onChange(this.state.value)},t.prototype.renderWithBEM=function(){var e="$e:searchBar",t="photo-roll/search-light.png";this.state.active&&(e+=" m:active",t="photo-roll/search-dark.png"),t=this._getAssetPath(t,!0);var o={width:this.state.inputWidth+"px"};return s.ReactBEM.createElement("bem",{specifier:"$b:photoRollScreen"},s.ReactBEM.createElement("div",{bem:e,ref:"root",onClick:this._onBarClick},s.ReactBEM.createElement("div",{bem:"e:content"},s.ReactBEM.createElement("div",{bem:"$e:icon"},s.ReactBEM.createElement("img",{src:t,bem:"e:image"})),s.ReactBEM.createElement("div",{bem:"e:inputContainer"},s.ReactBEM.createElement("input",{bem:"e:input",ref:"input",placeholder:this.state.placeholder,onBlur:this._onBlur,onFocus:this._onFocus,onChange:this._onChange,defaultValue:this.state.value,style:o})))))},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("bem",{specifier:"$b:topBar"},s.ReactBEM.createElement("div",{bem:"$e:backButton",onClick:this.props.onClick},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("top-bar/back.png",!0)}),s.ReactBEM.createElement("div",{bem:"e:label"},this.props.label)))},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){var o=[],i=!0,n=!1,r=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done)&&(o.push(s.value),!t||o.length!==t);i=!0);}catch(e){n=!0,r=e}finally{try{!i&&a.return&&a.return()}finally{if(n)throw r}}return o}return function(t,o){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=o(0),l=o(1),u=i(l),p=o(96),f=i(p),h=o(39),d=i(h),m=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var a=r(this,e.call.apply(e,[this].concat(i)));a._needsStyleFixes=!0,a.state={loading:!0,libraries:[],searchSuggestions:[]},a._bindAll("_onLibraryClick","_onSearchSuggestionClick");var c=a.context.options.photoRoll.provider;return a._provider=new c,a}return s(t,e),t.prototype.fixStyles=function(){if(c.Utils.Browser.isIElte(11)){var e=this.refs,t=e.cell,o=e.container;if(!t||!o)return;var i=t.offsetHeight;o.style.height=i+"px"}},t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this);var o=u.default.instance.displayLoading(this._t("loading.loading"));this._load().then(function(e){var i=a(e,2),n=i[0],r=i[1];o.close(),1===n.length?t._onLibraryClick(n[0],!0):t.setState({loading:!1,libraries:n,searchSuggestions:r})})},t.prototype._onLibraryClick=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.props.onLibraryClicked&&this.props.onLibraryClicked(e,t)},t.prototype._onSearchSuggestionClick=function(e){this.props.onSearchSuggestionClicked&&this.props.onSearchSuggestionClicked(e)},t.prototype._load=function(){var e=[this._provider.getLibraries(),this._provider.getSearchSuggestions()];return c.Promise.all(e)},t.prototype._renderLibraries=function(){var e=this,t=this.state.libraries.map(function(t){return c.ReactBEM.createElement(f.default,{onClick:e._onLibraryClick,library:t})});return c.ReactBEM.createElement("li",{bem:"e:item"},c.ReactBEM.createElement("bem",{specifier:"b:photoRoll"},c.ReactBEM.createElement("div",{bem:"e:headline"},"Browse libraries"),c.ReactBEM.createElement("ul",{bem:"$e:libraryList"},t)))},t.prototype._renderSearchSuggestions=function(){var e=this;if(!this.state.searchSuggestions.length)return null;var t=this.state.searchSuggestions.map(function(t){return c.ReactBEM.createElement(d.default,{onClick:e._onSearchSuggestionClick,searchSuggestion:t})});return c.ReactBEM.createElement("li",{bem:"e:item"},c.ReactBEM.createElement("bem",{specifier:"b:photoRoll"},c.ReactBEM.createElement("div",{bem:"e:headline"},"Search suggestions"),c.ReactBEM.createElement("ul",{bem:"$e:libraryList"},t)))},t.prototype._renderContent=function(){return c.ReactBEM.createElement("div",{bem:"$b:photoRoll e:row m:fullHeight"},c.ReactBEM.createElement("div",{bem:"e:cell",ref:"cell"},c.ReactBEM.createElement("div",{bem:"e:container",ref:"container"},c.ReactBEM.createElement("div",{bem:"e:innerContainer"},c.ReactBEM.createElement("ul",{bem:"$e:groupList"},this._renderLibraries(),this._renderSearchSuggestions())))))},t.prototype.renderWithBEM=function(){return this.state.loading?c.ReactBEM.createElement("div",null):this._renderContent()},t}(c.BaseComponent);t.default=m,m.contextTypes=c.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a._bindAll("_onClick"),a}return r(t,e),t.prototype._onClick=function(){this.props.onClick&&this.props.onClick(this.props.library)},t.prototype.renderWithBEM=function(){var e=this.props.library,t={backgroundImage:"url("+e.coverImage+")"};return s.ReactBEM.createElement("bem",{specifier:"b:photoRoll e:libraryList"},s.ReactBEM.createElement("li",{bem:"e:item",style:t,onClick:this._onClick},s.ReactBEM.createElement("div",{bem:"e:overlay"}),s.ReactBEM.createElement("div",{bem:"e:name"},e.name)))},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.renderWithBEM=function(){var e=this.props.photo;return s.ReactBEM.createElement("bem",{specifier:"b:photoRoll e:photoList"},s.ReactBEM.createElement("li",{bem:"$e:item",onClick:this.props.onClick},s.ReactBEM.createElement("div",{bem:"e:overlay"}),s.ReactBEM.createElement("div",{bem:"e:title"},e.title),s.ReactBEM.createElement("img",{bem:"e:image",src:e.urls.thumb})))},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(40),l=i(c),u=o(99),p=i(u),f=o(1),h=i(f),d=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.prototype.componentWillReceiveProps=function(e){e.query!==this.props.query&&this._loadPhotos(e.query)},t.prototype._getHeadline=function(){return this._t("photoRoll.search.results.headline",{query:this.props.query})},t.prototype._loadPhotos=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props.query;this._totalPhotosHeight=0;var o=h.default.instance.displayProgress(this._t("loading.loading"));(new(0,this.context.options.photoRoll.provider)).searchPhotos(t).then(function(t){return e._preloadPhotos(t,o)}).then(function(t){e.setState({photos:t,loading:!1}),o.close()})},t.prototype._renderNotFound=function(){return a.ReactBEM.createElement(p.default,{query:this.props.query,onSearchSuggestionClicked:this.props.onSearchSuggestionClicked})},t.prototype.renderWithBEM=function(){return this.state.loading?a.ReactBEM.createElement("div",null):0===this.state.photos.length?this._renderNotFound():this._renderPhotos()},t}(l.default);t.default=d,d.contextTypes=l.default.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(39),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));a._bindAll("_onSearchSuggestionClick");var c=a.context.options.photoRoll.provider;return a._provider=new c,a.state={searchSuggestions:[]},a}return r(t,e),t.prototype._onSearchSuggestionClick=function(e){this.props.onSearchSuggestionClicked&&this.props.onSearchSuggestionClicked(e)},t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this),this._provider.getSearchSuggestions().then(function(e){t.setState({searchSuggestions:e})})},t.prototype._renderMessage=function(){return{__html:this._t("photoRoll.search.noSearchResults",{query:this.props.query})}},t.prototype._renderSearchSuggestions=function(){var e=this;if(!this.state.searchSuggestions.length)return null;var t=this.state.searchSuggestions.map(function(t){return s.ReactBEM.createElement(c.default,{onClick:e._onSearchSuggestionClick,searchSuggestion:t})});return s.ReactBEM.createElement("div",null,s.ReactBEM.createElement("div",{bem:"e:headline"},"Search suggestions"),s.ReactBEM.createElement("ul",{bem:"$e:libraryList"},t))},t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("div",{bem:"$b:photoRoll e:row m:fullHeight"},s.ReactBEM.createElement("div",{bem:"e:cell"},s.ReactBEM.createElement("div",{bem:"e:container"},s.ReactBEM.createElement("div",{bem:"e:innerContainer"},s.ReactBEM.createElement("div",{bem:"e:noSearchResults",dangerouslySetInnerHTML:this._renderMessage()}),this._renderSearchSuggestions()))))},t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(8),l=i(c),u=o(12),p=i(u),f=o(101),h=i(f),d=function(e){function t(){n(this,t);var o=r(this,e.call(this));return o._bindAll("_onCancel","_onWebcamReady","_onShutterClicked"),o.state={webcamReady:!1},o}return s(t,e),t.prototype._onWebcamReady=function(){this.setState({webcamReady:!0})},t.prototype._onCancel=function(){this.props.app.switchToScreen("back")},t.prototype._onShutterClicked=function(){var e=this;this.refs.webcam.makePhoto().then(function(t){e.props.app.setImage(t)}).catch(function(e){a.Log.error(e)})},t.prototype._renderScreen=function(){return a.ReactBEM.createElement("div",{bem:"$b:webcamScreen"},a.ReactBEM.createElement(p.default,{label:this._t("webcam.headline")},a.ReactBEM.createElement("bem",{specifier:"$b:topBar"},a.ReactBEM.createElement("div",{bem:"e:cancelButton",onClick:this._onCancel},this._t("generic.cancel")),a.ReactBEM.createElement("div",{bem:"e:label"},this._t("webcam.headline")))),a.ReactBEM.createElement("div",{bem:"$b:canvas e:container e:row"},a.ReactBEM.createElement("div",{bem:"e:container e:cell"},a.ReactBEM.createElement(h.default,{ref:"webcam",onReady:this._onWebcamReady,onBack:this._onCancel}))),a.ReactBEM.createElement("div",{bem:"$b:controls $e:container e:row"},a.ReactBEM.createElement("div",{bem:"e:cell"},a.ReactBEM.createElement("bem",{specifier:"b:webcamScreen"},a.ReactBEM.createElement("div",{bem:"$e:shutterButton",onClick:this._onShutterClicked,className:!!this.state.webcamReady&&"is-active"},a.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/webcam/shutter.png",!0)}))))))},t}(l.default);t.default=d,d.contextTypes=l.default.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(1),l=i(c),u=o(102),p=i(u),f=function(e){function t(){n(this,t);var o=r(this,e.call(this));return o._bindAll("_onWebcamReady","_onWebcamError"),o.state={webcamReady:!1},o}return s(t,e),t.prototype.shouldComponentUpdate=function(e,t){return!1},t.prototype._onWebcamReady=function(){this.props.onReady&&this.props.onReady(),this.setState({webcamReady:!0})},t.prototype._onWebcamError=function(e){var t=this;l.default.instance.displayError(this._t("errors.title"),this._t("errors.webcamUnavailable.text",{error:e})).on("close",function(){return t.props.onBack()})},t.prototype.makePhoto=function(){if(this.state.webcamReady)return this._webcam.capture()},t.prototype.renderWithBEM=function(){var e=this;return a.ReactBEM.createElement("div",{bem:"$b:webcam",ref:"container"},a.ReactBEM.createElement(p.default,{flashURL:this._getAssetPath("fallback/webcam.swf"),ref:function(t){e._webcam=t},onWebcamError:this._onWebcamError,onWebcamAvailable:this._onWebcamReady}))},t}(a.BaseComponent);t.default=f,f.propTypes={onReady:a.PropTypes.func},f.contextTypes=a.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(o){i(this,t);var r=n(this,e.call(this,o));return r._bindAll("_onLoadedMetadata"),r.state={webcamAvailable:!1,useFlashFallback:!1,containerWidth:null,containerHeight:null},r._getUserMedia=null,r._webcamStream=null,r}return r(t,e),t.prototype.componentDidMount=function(){var e=this;if(this._initGetUserMedia(),this._calculateFlashDimensions(),this._getUserMedia)this._getUserMedia({video:{optional:[{minWidth:320},{minWidth:640},{minWidth:1024},{minWidth:1280},{minWidth:1920},{minWidth:2560}]},audio:!1}).then(function(t){e._webcamStream=t;var o=e._videoElement;"srcObject"in o?o.srcObject=t:o.src=window.URL.createObjectURL(t)}).catch(function(t){e.props.onWebcamError&&e.props.onWebcamError(t)});else{var t=!1;window.Webcam||(window.Webcam={},t=!0),window.Webcam.flashNotify=function(o,i){switch(o){case"cameraLive":e.setState({webcamAvailable:!0},function(){e.props.onWebcamAvailable&&e.props.onWebcamAvailable()}),delete window.Webcam.flashNotify,t&&delete window.Webcam;break;case"error":e.props.onWebcamError&&e.props.onWebcamError(i),delete window.Webcam.flashNotify,t&&delete window.Webcam}}}},t.prototype.componentWillUnmount=function(){this._disposeWebcam()},t.prototype._initGetUserMedia=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&(this._getUserMedia=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices)),!this._getUserMedia){var e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;e&&(this._getUserMedia=function(t){return new Promise(function(o,i){return e.call(navigator,t,o,i)})})}this._getUserMedia||this.setState({useFlashFallback:!0})},t.prototype._disposeWebcam=function(){if(this._webcamStream){var e=this._webcamStream,t=e.getTracks()[0];t?t.stop():e.stop&&e.stop()}else this._flashWebcam&&this._flashWebcam._releaseCamera()},t.prototype.capture=function(){var e=this;return this.state.webcamAvailable?this._videoElement&&!this._flashWebcam?new Promise(function(t,o){var i=e._videoElement;if(0===i.readyState)o(new Error("Webcam video not available"));else{var n=document.createElement("canvas");n.width=i.videoWidth,n.height=i.videoHeight;n.getContext("2d").drawImage(i,0,0);var r=new window.Image;r.addEventListener("load",function(){t(r)}),r.src=n.toDataURL("image/jpeg")}}):this._flashWebcam?new Promise(function(t,o){var i=e._flashWebcam._snap(),n=new Image;n.onload=function(){t(n)},n.src="data:image/jpeg;base64,"+i}):Promise.reject(new Error("Webcam video not available")):Promise.reject(new Error("Webcam video not available"))},t.prototype._getIEHeight=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=this._container,o=0;o<1e3&&!(t.clientHeight>e)&&t.parentNode;o++)t=t.parentNode;return t.clientHeight>e?t.clientHeight:null},t.prototype._calculateFlashDimensions=function(){var e=.9*(this._getIEHeight()||window.innerHeight),t=4/3*e||640,o=e||480;this.setState({containerWidth:t,containerHeight:o})},t.prototype._getFlashFallbackComponent=function(){var e=this,t=this.state.containerWidth||640,o=this.state.containerHeight||480,i="width="+t+"&height="+o+"&dest_width=1024&dest_height=768&jpeg_quality=100&fps=24";return React.createElement("object",{classID:"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000",type:"application/x-shockwave-flash",width:t,height:o,ref:function(t){e._flashWebcam=t},align:"middle"},React.createElement("param",{name:"wmode",value:"transparent"}),React.createElement("param",{name:"allowScriptAccess",value:"always"}),React.createElement("param",{name:"allowFullScreen",value:"false"}),React.createElement("param",{name:"movie",value:this.props.flashURL}),React.createElement("param",{name:"loop",value:"false"}),React.createElement("param",{name:"menu",value:"false"}),React.createElement("param",{name:"quality",value:"best"}),React.createElement("param",{name:"bgcolor",value:"#ffffff"}),React.createElement("param",{name:"flashvars",value:i}))},t.prototype._onLoadedMetadata=function(){var e=this;this.setState({webcamAvailable:!0},function(){e.props.onWebcamAvailable&&e.props.onWebcamAvailable()})},t.prototype.render=function(){var e=this,t=this.state.useFlashFallback?this._getFlashFallbackComponent():React.createElement("video",{style:{width:"100%"},autoPlay:!0,ref:function(t){e._videoElement=t},onLoadedMetadata:this._onLoadedMetadata});return React.createElement("div",{style:{width:this.state.useFlashFallback?this.state.containerWidth:"100%",height:this.state.useFlashFallback?this.state.containerHeight:"100%",display:"block",margin:"auto",overflow:"hidden"},ref:function(t){e._container=t}},t)},t}(s.BaseComponent);t.default=a,a.propTypes={flashURL:s.PropTypes.string,onWebcamAvailable:s.PropTypes.func,onWebcamError:s.PropTypes.func}},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(41),l=i(c),u=o(8),p=i(u),f=o(106),h=i(f),d=o(1),m=i(d),_=o(107),g=i(_),y=o(42),b=i(y),v=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var c=r(this,e.call.apply(e,[this].concat(i)));return c._overviewControls=l.default,c._bindAll("switchToControls","_startEditor","_onWindowResize","_onWindowResizeDone","_onImageResize","_onNewImage","_onRenderError"),c._previousControlsStack=[],c.state={zoom:null,controls:g.default,dragEnabled:!0,sharedState:new a.SharedState},c._editor=new b.default(c.context.ui,c.context.options,c.context.mediator),c._editor.on("new-image",c._onNewImage),c._editor.on("ready",c._startEditor),c._editor.on("resize",c._onImageResize),c._editor.on("render-error",c._onRenderError),c._forceControls=c.context.options.editor.forceControls,c._forceControlIndex=0,c}return s(t,e),t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this);var o=this.context.options.editor.image;this.setImage(o),this._editor.render(),this._editor.on("ready",function(){t._switchToNextForceControl()}),this.context.options.responsive&&window.addEventListener("resize",this._onWindowResize)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this._editor.dispose(),this.context.options.responsive&&window.removeEventListener("resize",this._onWindowResize)},t.prototype._startEditor=function(){this._editor.start()},t.prototype._switchToNextForceControl=function(){if(this._forceControlIndex<this._forceControls.length){var e=this._forceControls[this._forceControlIndex],t=e.control,o=e.options,i=this._editor.controls.getAvailable(),n=i[t],r=a.SDKUtils.defaults({forcedControl:!0},o);if(!n)throw new Error("Force controls: Could not find control with identifier `"+t+"`");this.switchToControls(n,{},null,r),this._forceControlIndex++}},t.prototype._onRenderError=function(e){m.default.instance.displayError(this._t("errors.renderingError.title"),this._t("errors.renderingError.text"),!0),a.Log.error(this.constructor.name,"An error occurred while rendering: "+e.message),a.Log.printError(e)},t.prototype._onNewImage=function(){this.switchToControls(g.default)},t.prototype._onImageResize=function(){var e=this,t=m.default.instance.displayLoading(this._t("loading.resizing"));this._editor.once("resized",function(o){var i=o.dimensions,n=o.reason;t.close(),e.context.options.editor.displayResizeMessage&&m.default.instance.displayWarning(e._t("warnings.imageResized_"+n+".title"),e._t("warnings.imageResized_"+n+".text",{maxMegaPixels:e._editor.getMaxMegapixels(),width:i.x,height:i.y}))})},t.prototype._onWindowResize=function(){this._resizeTimeout&&(window.clearTimeout(this._resizeTimeout),this._resizeTimeout=null),this._resizeTimeout=window.setTimeout(this._onWindowResizeDone,500)},t.prototype._onWindowResizeDone=function(){this._emitEvent(a.Constants.EVENTS.WINDOW_RESIZE)},t.prototype.switchToControls=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=null;if("back"===e)n=this._previousControlsStack.pop();else if("home"===e||e===g.default){if(this._forceControlIndex<this._forceControls.length)return this._switchToNextForceControl();n=g.default,this._previousControlsStack=[]}else n=e,this._previousControlsStack.push(this.state.controls);var r=this.state.controls!==n;this.state.controls.onExit&&this.state.controls.onExit.call(this.refs.controls),this.state.sharedState.clear(),this.state.sharedState.set(t,!1);var s=a.SDKUtils.defaults(a.SDKUtils.defaults(i,this.context.options.editor.controlsOptions[n.identifier]),n.defaultOptions);if(n.onEnter&&n.onEnter.call(this.refs.controls,this.state.sharedState,s),!r)return o&&o();this.setState({controls:n,controlsOptions:s},o)},t.prototype.getZoom=function(){return this.state.zoom},t.prototype.export=function(){for(var e=this,t=arguments.length,o=Array(t),i=0;i<t;i++)o[i]=arguments[i];return new Promise(function(t,i){e.switchToControls("home",{},function(){var n;(n=e._editor).export.apply(n,o).then(t).catch(i)})})},t.prototype.getEditor=function(){return this._editor},t.prototype.serialize=function(){var e;return(e=this._editor).serialize.apply(e,arguments)},t.prototype.deserialize=function(e){return this._editor.deserialize(e)},t.prototype._showUndoButton=function(){return this._editor.history.isAvailable()},t.prototype.getChildContext=function(){return{editor:this._editor,ui:this.context.ui,options:this.context.options,editorScreen:this,mediator:this.context.mediator}},t.prototype.setImage=function(e,t){this._forceControlIndex=0,this._editor.setImage(e,t)},t.prototype._renderScreen=function(){var e=this.state.controls.controlsComponent,t=this.state.controls.canvasControlsComponent;t||(t=g.default.canvasControlsComponent);var o=this.state.controls.topBarControlsComponent;o||(o=g.default.topBarControlsComponent);var i=void 0,n=void 0,r=void 0;o&&this.context.options.showTopBar&&(r=a.ReactBEM.createElement(o,{sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,ref:"topBarControls"})),e&&(i=a.ReactBEM.createElement(e,{onSwitchControls:this.switchToControls,sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,key:this.state.controls.identifier+"-controls",ref:"controls"})),t&&(n=a.ReactBEM.createElement(t,{onSwitchControls:this.switchToControls,sharedState:this.state.sharedState,options:this.state.controlsOptions,app:this.props.app,key:this.state.controls.identifier+"-canvasControls",ref:"canvasControls"}));var s="$b:editorScreen";return this.context.options.showHeader||(s+=" m:noHeader"),a.ReactBEM.createElement("div",{bem:s},r,a.ReactBEM.createElement(h.default,{ref:"canvas",largeControls:this.state.controls.largeCanvasControls},n),a.ReactBEM.createElement("div",{bem:"$b:controls $e:container e:row"},a.ReactBEM.createElement("div",{bem:"e:cell"},i)))},t}(p.default);t.default=v,v.childContextTypes={ui:a.PropTypes.object.isRequired,editor:a.PropTypes.object.isRequired,mediator:a.PropTypes.object.isRequired,options:a.PropTypes.object.isRequired,editorScreen:a.PropTypes.object.isRequired},v.contextTypes=p.default.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("bem",{specifier:"$b:controls"},s.ReactBEM.createElement("div",{bem:"e:cell m:largeButton"},s.ReactBEM.createElement("div",{bem:"$e:largeButton",onClick:this.props.onClick},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/back.png",!0)}))))},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("bem",{specifier:"$b:controls"},s.ReactBEM.createElement("div",{bem:"e:cell m:largeButton"},s.ReactBEM.createElement("div",{bem:"$e:largeButton",onClick:this.props.onClick},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/tick.png",!0)}))))},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=function(e){function t(){var o;n(this,t);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];var u=r(this,e.call.apply(e,[this].concat(c)));return u._bindAll("_onDragStart","_onDragMove","_onDragEnd","_onWindowResize","_onFeaturesUpdated","_onZoomChange"),u._events=(o={},i(o,a.Constants.EVENTS.WINDOW_RESIZE,u._onWindowResize),i(o,a.Constants.EVENTS.FEATURES_UPDATED,u._onFeaturesUpdated),o),u._initialRenderDone=!1,u.state={canvasPosition:new a.Vector2,canvasOffset:new a.Vector2},u}return s(t,e),t.prototype._onWindowResize=function(){var e=this.context.editor;e.getSDK().resizeTo(this._getContainerDimensions()),e.zoom.set("auto")},t.prototype._onFeaturesUpdated=function(e){-1!==e.indexOf("drag")&&this.forceUpdate()},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this);var t=this.context.editor,o=t.getRenderer(),i=this.refs,n=i.canvasCell,r=i.canvas,s=n.offsetWidth,c=n.offsetHeight;o.setCanvas(r),o.resizeTo(new a.Vector2(s,c),!0),t.zoom.on("set",this._onZoomChange)},t.prototype.componentWillUnmount=function(){this.context.editor.zoom.off("set",this._onZoomChange)},t.prototype._onZoomChange=function(){this.forceUpdate()},t.prototype._onDragStart=function(e){var t=this.context.editor;t.features.isEnabled("drag")&&(e.preventDefault(),this._dragStartPosition=a.Utils.getEventPosition(e.nativeEvent),this._dragInitialOffset=t.getOffset().clone(),document.addEventListener("mousemove",this._onDragMove),document.addEventListener("touchmove",this._onDragMove),document.addEventListener("mouseup",this._onDragEnd),document.addEventListener("touchend",this._onDragEnd))},t.prototype._onDragMove=function(e){var t=a.Utils.getEventPosition(e),o=t.clone().subtract(this._dragStartPosition),i=this._dragInitialOffset.clone().add(o),n=this.context.editor,r=n.getOffset().clone();n.setOffset(i),n.getOffset().equals(r)||n.render()},t.prototype._onDragEnd=function(e){document.removeEventListener("mousemove",this._onDragMove),document.removeEventListener("touchmove",this._onDragMove),document.removeEventListener("mouseup",this._onDragEnd),document.removeEventListener("touchend",this._onDragEnd)},t.prototype._getContainerDimensions=function(){var e=this.refs.canvasCell;return new a.Vector2(e.offsetWidth,e.offsetHeight)},t.prototype._getDraggableStyle=function(){return{top:this.state.canvasPosition.y+this.state.canvasOffset.y,left:this.state.canvasPosition.x+this.state.canvasOffset.x}},t.prototype.renderWithBEM=function(){var e=null,t=null;this.props.largeControls?t=this.props.children:e=this.props.children;var o=this.context.editor,i=o.isReady()&&o.zoom.get()>o.zoom.getDefault(),n=o.features.isEnabled("drag")&&i;return a.ReactBEM.createElement("div",{bem:"$b:canvas e:container e:row"},a.ReactBEM.createElement("div",{bem:"e:container e:cell",ref:"canvasCell"},a.ReactBEM.createElement("div",{bem:"e:innerContainer",className:n?"is-draggable":null,onTouchStart:this._onDragStart,onMouseDown:this._onDragStart,style:this._getDraggableStyle()},a.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),e),t))},t}(a.BaseComponent);t.default=c,c.contextTypes=a.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(4),c=i(a),l=o(108),u=i(l),p=o(41),f=i(p),h=o(113),d=i(h),m=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t}(c.default);m.topBarControlsComponent=u.default,m.controlsComponent=f.default,m.canvasControlsComponent=d.default,t.default=m},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(12),l=i(c),u=o(109),p=i(u),f=o(110),h=i(f),d=o(111),m=i(d),_=o(112),g=i(_),y=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.prototype.renderContent=function(){var e=null;this.context.options.enableUpload&&(e=a.ReactBEM.createElement(p.default,{app:this.props.app}));var t=null;return this.context.options.editor.enableZoom&&(t=a.ReactBEM.createElement(g.default,null)),a.ReactBEM.createElement("bem",{specifier:"$b:topBar"},a.ReactBEM.createElement("div",{bem:"e:left"},e),a.ReactBEM.createElement("div",{bem:"e:right"},a.ReactBEM.createElement(m.default,null),a.ReactBEM.createElement(h.default,null)),t)},t}(l.default);t.default=y,y.contextTypes=l.default.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(25),l=i(c),u=o(24),p=i(u),f=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var a=r(this,e.call.apply(e,[this].concat(i)));return a._bindAll("_onNewFile","_onButtonClick"),a}return s(t,e),t.prototype._onNewFile=function(e){var t=this.context.editor;t.reset(),t.setImage(e),t.zoom.set("auto")},t.prototype._onButtonClick=function(){var e=this.context.options,t=!1===e.enableWebcam||a.Utils.isMobile(),o=!!e.photoRoll.provider;t&&!o?this.refs.upload.open():o?this.props.app.switchToScreen("photoRoll"):this.props.app.switchToScreen("splash")},t.prototype.renderWithBEM=function(){var e=this.context.options,t=null;return t=e.photoRoll.provider?this._t("editor.backgroundImage"):this._t("editor.new"),a.ReactBEM.createElement("div",null,a.ReactBEM.createElement(p.default,{onNewFile:this._onNewFile,ref:"upload"}),a.ReactBEM.createElement(l.default,{label:t,icon:"editor/new.png",onClick:this._onButtonClick}))},t}(a.BaseComponent);t.default=f,f.contextTypes=a.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(1),l=i(c),u=o(25),p=i(u),f=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var a=r(this,e.call.apply(e,[this].concat(i)));return a._bindAll("_onButtonClick"),a}return s(t,e),t.prototype._onButtonClick=function(){var e=this,t=this.context,o=t.options,i=t.editor,n=t.editorScreen,r=o.editor.export;n.switchToControls("home",null,function(){var t=l.default.instance.displayLoading(e._t("loading.exporting"));setTimeout(function(){i.export(r.download).then(function(){t.close()}).catch(function(o){l.default.instance.displayError(e._t("errors.title"),o.message),t.close()})},100)})},t.prototype.renderWithBEM=function(){return this.context.options.editor.export.showButton?a.ReactBEM.createElement(p.default,{style:"blue",label:this._t("editor.export"),icon:"editor/export.png",onClick:this._onButtonClick}):null},t}(a.BaseComponent);t.default=f,f.contextTypes=a.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(25),l=function(e){return e&&e.__esModule?e:{default:e}}(c),u=function(e){function t(){var o;n(this,t);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];var u=r(this,e.call.apply(e,[this].concat(c)));return u._bindAll("_onButtonClick","_onHistoryUpdated","_onFeaturesUpdated"),u._events=(o={},i(o,a.Constants.EVENTS.HISTORY_UPDATED,u._onHistoryUpdated),i(o,a.Constants.EVENTS.FEATURES_UPDATED,u._onFeaturesUpdated),o),u}return s(t,e),t.prototype._onFeaturesUpdated=function(){this.forceUpdate()},t.prototype._onHistoryUpdated=function(){this.forceUpdate()},t.prototype._onButtonClick=function(){this.context.editor.history.undo()},t.prototype.renderWithBEM=function(){return this.context.editor.history.isAvailable()?a.ReactBEM.createElement(l.default,{label:this._t("editor.undo"),icon:"editor/undo.png",onClick:this._onButtonClick}):null},t}(a.BaseComponent);t.default=u,u.contextTypes=a.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=function(e){function t(){var o;n(this,t);for(var s=arguments.length,c=Array(s),l=0;l<s;l++)c[l]=arguments[l];var u=r(this,e.call.apply(e,[this].concat(c)));return u._bindAll("_onZoomOutClick","_onZoomInClick","_onZoomDone","_onFeaturesUpdated"),u._events=(o={},i(o,a.Constants.EVENTS.ZOOM_DONE,u._onZoomDone),i(o,a.Constants.EVENTS.FEATURES_UPDATED,u._onFeaturesUpdated),o),u}return s(t,e),t.prototype._onFeaturesUpdated=function(){this.forceUpdate()},t.prototype._onZoomDone=function(){this.forceUpdate()},t.prototype._onZoomOutClick=function(e){var t=this.context.editor;t.features.isEnabled("zoom")&&t.zoom.out()},t.prototype._onZoomInClick=function(e){var t=this.context.editor;t.features.isEnabled("zoom")&&t.zoom.in()},t.prototype.renderWithBEM=function(){var e=this.context.editor,t=e.zoom.get(),o=e.features.isEnabled("zoom");return a.ReactBEM.createElement("bem",{specifier:"b:editorScreen"},a.ReactBEM.createElement("div",{bem:"$e:zoom"},a.ReactBEM.createElement("div",{bem:"$e:button m:zoomOut",onClick:this._onZoomOutClick,className:o?null:"is-disabled"},a.ReactBEM.createElement("img",{bem:"e:image",src:this._getAssetPath("controls/minus.png",!0)})),a.ReactBEM.createElement("div",{bem:"e:label"},this._t("editor.zoom"),a.ReactBEM.createElement("br",null),Math.round(100*t),"%"),a.ReactBEM.createElement("div",{bem:"$e:button m:zoomIn",onClick:this._onZoomInClick,className:o?null:"is-disabled"},a.ReactBEM.createElement("img",{bem:"e:image",src:this._getAssetPath("controls/plus.png",!0)}))))},t}(a.BaseComponent);t.default=c,c.contextTypes=a.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(9),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a._bindAll("_onClick"),a}return r(t,e),t.prototype._onClick=function(e){this._performHitTest(s.Utils.getEventPosition(e))},t.prototype._getContainerStyle=function(){if(!this.context.editor.isReady())return{left:0,top:0,width:1,height:1};var e=this.context.editor.getSDK().getSprite().getBounds();return{left:e.x,top:e.y,width:e.width,height:e.height}},t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("div",{bem:"$b:canvasControls e:container m:full",ref:"container"},s.ReactBEM.createElement("div",{bem:"$b:canvasControls e:innerContainer",ref:"innerContainer",style:this._getContainerStyle(),onClick:this._onClick,onTouchStart:this._onClick}))},t}(c.default);t.default=l,l.contextTypes=c.default.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),r=o(115),s=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function(){function e(t,o,n){i(this,e),this._sdk=t,this._options=o,this._download=n}return e.prototype.export=function(){var e=this,t=this._getRenderType();return this._sdk.export(t,this._options.format,this._options.quality).then(function(o){return e._download&&e._downloadData(t,o),o})},e.prototype._downloadData=function(e,t){switch(e){case n.RenderType.DATAURL:s.default.downloadDataURL(t,this._options.fileBasename);break;case n.RenderType.MSBLOB:s.default.downloadMSBlob(t,this._options.fileBasename)}},e.prototype._getRenderType=function(){var e=this._options;return e.type===n.RenderType.IMAGE&&this._download?n.Utils.supportsMSBlob()?n.RenderType.MSBLOB:n.RenderType.DATAURL:e.type},e}();t.default=a},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),r=function(){function e(){i(this,e)}return e.downloadDataURL=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"photoeditorsdk-export",o=this.createBlobURLFromDataURL(e),i=this.getExtensionFromDataURL(e),n=document.createElement("a");n.download=t+"."+i,n.href=o,document.body.appendChild(n),n.click(),document.body.removeChild(n)},e.downloadMSBlob=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"photoeditorsdk-export";navigator.msSaveBlob(e,t+".png")},e.getExtensionFromDataURL=function(e){return e.split(",")[0].split(":")[1].split(";")[0].split("/").pop()},e.createBlobURLFromDataURL=function(e){if(!(window.Blob&&window.URL&&ArrayBuffer&&Uint8Array))return e;for(var t=n.Base64.decode(e.split(",")[1]),o=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(t.length),r=new Uint8Array(i),s=0;s<t.length;s++)r[s]=t[s];var a=new window.Blob([i],{type:o});return window.URL.createObjectURL(a)},e}();t.default=r},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),r=function(){function e(t,o,n){i(this,e),this._image=t,this._maxPixels=o,this._maxDimensions=n}return e.prototype.needsResize=function(){var e=new n.Vector2(this._image.width,this._image.height),t=e.x*e.y,o=t>this._maxPixels,i=null!==this._maxDimensions&&(e.x>this._maxDimensions||e.y>this._maxDimensions);return o||i},e.prototype.resize=function(){var e=this,t=null,o=null,i=this._maxDimensions;return new n.Promise(function(r,s){window.setTimeout(function(){var s=new n.Vector2(e._image.width,e._image.height),a=s.clone();if(a.x*a.y>e._maxPixels&&(a.copy(e._getDimensionsByMaxPixels()),t="maxMegaPixels"),null!==i&&(a.x>i||a.y>i)){var c=Math.min(i/a.x,i/a.y);a.multiply(c),t="maxDimensions"}a.floor(),o=e._createResizedImageCanvas(a),r({canvas:o,dimensions:a,reason:t})},1e3)})},e.prototype._createResizedImageCanvas=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=this._image,i=document.createElement("canvas");i.width=e.x,i.height=e.y;var n=e.clone().subtract(t).divide(2);return i.getContext("2d").drawImage(o,0,0,o.width,o.height,n.x,n.y,t.x,t.y),i},e.prototype._getDimensionsByMaxPixels=function(){var e=this._image,t=this._maxPixels,o=e.width/e.height,i=e.height/e.width;return new n.Vector2(Math.sqrt(t*o),Math.sqrt(t*i)).floor()},e}();t.default=r},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=o(7),r=function(e){return e&&e.__esModule?e:{default:e}}(n),s=o(0),a=function(){function e(t,o,n){i(this,e),this._editor=t,this._sdk=o,this._mediator=n,this._map={},this._stack=this._sdk&&this._sdk.getOperationsStack(),this._preferredOrder=this._editor.getOptions().editor.operationsOrder,this._available={};var s=r.default.Operations;for(var a in s){var c=s[a];this._available[c.identifier]=c}var l=t.getOptions(),u=l.extensions.operations;for(var p in u){var f=u[p];this._available[f.identifier]=f}this._stack&&this._fixStack()}return e.prototype.exists=function(e){return!!this._map[e]},e.prototype.add=function(e){var t=this,o=e.constructor.identifier;e.on("update",function(){t._mediator.emit(s.Constants.EVENTS.OPERATION_UPDATED,e)});var i=this._preferredOrder.indexOf(o);if(-1===i)throw new Error("EditorOperations#add: `"+o+"` does not appear in `operationsOrder`");this._stack.set(i,e),this._map[o]=e,this._mediator.emit(s.Constants.EVENTS.OPERATION_CREATED,e)},e.prototype.remove=function(e){var t=e.constructor.identifier,o=this._stack.getStack();delete this._map[t];var i=o.map(function(e){return e.constructor.identifier}).indexOf(e.constructor.identifier);if(-1!==i){this._stack.removeAt(i);for(var n=i+1;n<o.length;n++){var r=o[n];r&&r.setDirty(!0)}this._mediator.emit(s.Constants.EVENTS.OPERATION_REMOVED,e)}},e.prototype.get=function(e){return this._map[e]},e.prototype.getOrCreate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._map[e]){var o=this._map[e];return o.set(t,!1),o}var i=this._available[e],n=new i(this._sdk,t);return this.add(n),n},e.prototype.getStack=function(){return this._stack},e.prototype.isAvailable=function(e){return!!this._available[e]},e.prototype.getAvailable=function(){return this._available},e.prototype.reset=function(){this._map={}},e.prototype._fixStack=function(){var e=this,t=this._stack.getStack().slice();this._stack.clear(),t.forEach(function(t){e.add(t)})},e}();t.default=a},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=o(43),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}(n),s=o(0),a=function(){function e(t,o,n){i(this,e),this._editor=t,this._sdk=o,this._mediator=n,this._invalidOperationsSeen=[],this._options=this._editor.getOptions(),this._available=s.SDKUtils.extend({},r,this._options.extensions.controls)}return e.prototype.isEnabled=function(e){var t=this,o=this.get(e);if(!o)return s.Log.info("EditorControls#isEnabled: Unknown control: "+e),!1;var i=o.requiredOperations||[],n=[];return i.forEach(function(e){t._editor.operations.isAvailable(e)||n.push(e)}),n.length?(-1===this._invalidOperationsSeen.indexOf(e)&&(this._invalidOperationsSeen.push(e),s.Log.error("Control `"+e+"` can not be used because "+(1===n.length?"operation is":"operations are")+" missing: "+n.map(function(e){return"`"+e+"`"}).join(", "))),!1):o.isAvailable&&o.isAvailable(this._editor)},e.prototype.get=function(e){return this._available[e]},e.prototype.getAvailable=function(){return this._available},e}();t.default=a},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(4),c=i(a),l=o(120),u=i(l),p=["brightness","clarity","contrast","exposure","highlights","saturation","shadows","gamma"],f=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.onEnter=function(e){var t=this.context.editor,o=t.operations.exists("adjustments"),i=t.operations.getOrCreate("adjustments"),n=i.serializeOptions();this.setSharedState({operation:i,operationExistedBefore:o,initialOptions:n})},t.isAvailable=function(e){return e.isToolAllowed("adjustment")&&p.filter(function(t){return e.isToolEnabled(t)}).length>0},t.getPreloadAssets=function(e){return p.filter(function(t){return e.isToolEnabled(t)}).map(function(e){return"controls/adjustments/"+e+".png"})},t}(c.default);f.controlsComponent=u.default,f.identifier="adjustments",f.iconPath="controls/overview/adjustments.png",f.languageKey="controls.overview.adjustments",f.defaultOptions={},f.requiredOperations=["adjustments"],t.default=f},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(3),l=i(c),u=o(2),p=i(u),f=o(6),h=i(f),d=o(121),m=(i(d),a.SDK.Operations.AdjustmentsOperation),_=["brightness","saturation","contrast","gamma","clarity","exposure","shadows","highlights"],g=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var a=r(this,e.call.apply(e,[this].concat(i)));a._bindAll("_onSliderValueChange");var c=a.context.editor;return a._operation=c.operations.getOrCreate("adjustments"),a.state={selectedControls:null},a}return s(t,e),t.prototype._onBackClick=function(t){var o=this.context.editor,i=this.getSharedState("operationExistedBefore"),n=this.getSharedState("initialOptions");this._operation.optionsEqual(n)||o.history.add(this._operation,n,i);var r=this._operation.getDefaultOptions();this._operation.optionsEqual(r)&&o.operations.remove(this._operation),e.prototype._onBackClick.call(this,t)},t.prototype._onSliderValueChange=function(e){var t=this.state.selectedControls,o=m.prototype.availableOptions[t],i=o.minValue,n=o.midValue,r=o.maxValue;e=e<0?n+(n-i)*e/100:n+(r-n)*e/100,this._operation.setOption(t,e),this.context.editor.render()},t.prototype._onButtonClick=function(e,t){this.setState({selectedControls:e})},t.prototype._buildSliderProps=function(e){var t=m.prototype.availableOptions[e],o=t.minValue,i=t.midValue,n=t.maxValue,r=this._operation?this._operation.getOption(e):i;return{minValue:-100,maxValue:100,value:100*(r<=i?(r-o)/(i-o)-1:(r-i)/(n-i)),valueUnit:"%",positiveValuePrefix:"+",label:this._t("controls.adjustments."+e),middleDot:!0,onChange:this._onSliderValueChange}},t.prototype.renderOverlayControls=function(){var e=this.state.selectedControls;if(e){var t=this._buildSliderProps(e);return a.ReactBEM.createElement(h.default,t)}},t.prototype._renderListItems=function(){var e=this;return _.filter(function(t){return e.context.editor.isToolEnabled(t)}).map(function(t){var o=e.state.selectedControls===t,i=o?"is-active":null,n=void 0;return a.ReactBEM.createElement("li",{bem:"e:item",key:t,"data-identifier":t},a.ReactBEM.createElement("bem",{specifier:"$b:controls"},a.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",onClick:e._onButtonClick.bind(e,t),className:i},a.ReactBEM.createElement("img",{bem:"e:icon",src:e._getAssetPath("controls/adjustments/"+t+".png",!0)}),a.ReactBEM.createElement("div",{bem:"e:label"},e._t("controls.adjustments."+t)),n)))})},t.prototype.renderControls=function(){var e=this._renderListItems();return a.ReactBEM.createElement("div",{bem:"e:cell m:list"},a.ReactBEM.createElement(p.default,null,a.ReactBEM.createElement("ul",{bem:"$e:list"},e)))},t}(l.default);t.default=g,g.contextTypes=l.default.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},a=o(0),c=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a.state={value:a.props.value||0,sliderPosition:0,foregroundLeft:0,foregroundWidth:0},a}return r(t,e),t.prototype.componentDidMount=function(){this._setValue(this.state.value,!1)},t.prototype.componentWillReceiveProps=function(e){e.value!==this.state.value&&this._setValue(e.value,!1)},t.prototype._getKnobStyle=function(){return{left:this.state.sliderPosition}},t.prototype._getForegroundStyle=function(){return{left:this.state.foregroundLeft,width:this.state.foregroundWidth}},t.prototype._displayMiddleDot=function(){return!1!==this.props.middleDot},t.prototype._setValue=function(e){!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e=Math.round(e);var t=this.props,o=t.minValue,i=t.maxValue,n=(e-o)/(i-o),r=this.refs.bar,s=r.offsetWidth,a=s*n,c=n*s,l=0;this._displayMiddleDot()&&(c=Math.abs(n-.5)*s,l=n<.5?.5*s-c:"50%"),this.setState({value:e,sliderPosition:a,foregroundWidth:c,foregroundLeft:l})},t.prototype.renderWithBEM=function(){var e={style:this._getForegroundStyle()};return a.ReactBEM.createElement("div",{bem:"$b:miniSlider"},a.ReactBEM.createElement("div",{bem:"$e:bar",ref:"bar"},a.ReactBEM.createElement("div",{bem:"$e:background"}),a.ReactBEM.createElement("div",s({bem:"$e:foreground"},e)),a.ReactBEM.createElement("div",{bem:"e:knob",style:this._getKnobStyle()})))},t}(a.BaseComponent);t.default=c,c.contextTypes=a.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(4),l=i(c),u=o(123),p=i(u),f=o(124),h=i(f),d=o(125),m=i(d),_=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.onEnter=function(e){var t=this.context.editor,o=t.operations.exists("transform"),i=t.operations.getOrCreate("transform");i.setEnabled(!1,!1);var n=t.operations.exists("orientation"),r=t.operations.getOrCreate("orientation"),s={end:new a.Vector2(1,1),rotation:0,start:new a.Vector2(0,0),textureScale:1},c=i.getInputDimensions(!1),l=i.getNewDimensions(c),u=s;if(o){u=i.serializeOptions(),delete u.enabled;var p=u,f=p.start,h=p.end,d=p.rotation,m=i.calculateScale(d),_=i.getInputDimensions(!1),g=Math.cos(d),y=Math.sin(d),b=h.clone().subtract(f).divide(2),v=f.clone().add(b).multiply(_),E=v.subtract(_.clone().multiply(.5)),w=new a.Vector2(E.x*g-E.y*y,E.x*y+E.y*g).multiply(m),k=_.clone().multiply(.5).add(w),S=k.clone().divide(_),O=S.clone().subtract(b.clone().multiply(m)),C=S.clone().add(b.clone().multiply(m));u.start=O,u.end=C}t.broadcastTransform(i,s);var M=r.serializeOptions(),R=[10,0,68,0];t.setSpriteScale(i.calculateScale()),t.setRotation(u.rotation),t.setPadding(R),i.set(s,o),t.zoom.set("auto",function(){t.features.disable("zoom","drag")},!1),this.setSharedState({initialTransformOptions:u,initialOrientationOptions:M,operation:i,orientationOperation:r,activePadding:R,orientationOperationExistedBefore:n,transformOperationExistedBefore:o,start:a.Vector2.fromObject(u.start),end:a.Vector2.fromObject(u.end),rotation:u.rotation,orientationRotation:r.getRotation(),flipVertically:r.getFlipVertically(),flipHorizontally:r.getFlipHorizontally(),initialDimensions:l,inputDimensions:c})},t.isAvailable=function(e){return e.isToolAllowed("transform")&&e.isToolEnabled("transform")},t.getPreloadAssets=function(e){var t=e.getOptions(),o=a.SDKUtils.defaults(t.editor.controlsOptions.transform,this.defaultOptions),i=["controls/transform/rotate-ccw.png","controls/transform/rotate-cw.png","controls/transform/flip-h.png","controls/transform/flip-v.png"];return p.default.getRatios(o).forEach(function(e){Array.isArray(e)?e.forEach(function(e){var t=e.identifier;i.push("controls/transform/"+t+".png")}):i.push("controls/transform/"+e.identifier+".png")}),i},t}(l.default);_.topBarControlsComponent=m.default,_.controlsComponent=p.default,_.canvasControlsComponent=h.default,_.identifier="transform",_.iconPath="controls/overview/transform.png",_.languageKey="controls.overview.transform",_.defaultOptions={},_.requiredOperations=["transform"],t.default=_},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(0),l=o(3),u=i(l),p=o(2),f=i(p),h=o(6),d=i(h),m=function(e){function t(){r(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];var l=s(this,e.call.apply(e,[this].concat(i)));return l._bindAll("_selectRatio","_onRotationChange","_reapplyRatio"),l.state={ratio:null},l._ratios=l.constructor.getRatios(l.props.options),l._events=n({},c.Constants.EVENTS.TRANSFORM_REAPPLY_RATIO,l._reapplyRatio),l._selectInitialRatio(!l.getSharedState("transformOperationExistedBefore")),l}return a(t,e),t.getRatios=function(e){var t=e.ratios,o=e.replaceRatios,i=e.availableRatios;t=t||[];var n=void 0;if(n=c.Constants.DEFAULTS.TRANSFORM_RATIOS,n=o?t:n.concat(t),i&&i.length){var r=function e(t){return Array.isArray(t)?t.map(e).filter(function(e){return e}):-1===i.indexOf(t.identifier)?null:t};n=n.map(r).filter(function(e){return e})}return n},t.prototype.shouldSharedComponentUpdate=function(e,t){return e.ratio!==t.ratio},t.prototype._onRotationChange=function(e){var t=this.getSharedState("operation"),o=this.context.editor;e=e*Math.PI/180,o.setRotation(e),o.setSpriteScale(t.calculateScale(e)),o.render(),this.setSharedState({rotation:e})},t.prototype._getRotatedSpriteDimensions=function(){var e=this.context.editor,t=e.getRotation(),o=e.getOutputDimensions(!1);return new c.Vector2(Math.abs(o.x*Math.cos(t))+Math.abs(o.y*Math.sin(t)),Math.abs(o.x*Math.sin(t))+Math.abs(o.y*Math.cos(t)))},t.prototype._calculateTextureScale=function(){var e=this.getSharedState("operation"),t=this.getSharedState("ratio");if(!t||!t.dimensions)return 1;var o=this.getSharedState("start"),i=this.getSharedState("end"),n=i.clone().subtract(o),r=e.getInputDimensions(!1).multiply(n);return t.dimensions.x/r.x},t.prototype._getHistoryItems=function(){var e=[],t=this._getTransformHistoryItem();t&&e.push(t);var o=this._getOrientationHistoryItem();return o&&e.push(o),e},t.prototype._getTransformHistoryItem=function(){var e=this.context.editor,t=this.getSharedState("operation"),o=this.getSharedState("initialTransformOptions"),i=this.getSharedState("transformOperationExistedBefore");if(!t.optionsEqual(o))return{operation:t,options:o,existent:i,undo:function(t,o){e.broadcastTransform(t,o)}}},t.prototype._getOrientationHistoryItem=function(){var e=this.context.editor,t=this.getSharedState("orientationOperation"),o=this.getSharedState("initialOrientationOptions"),i=this.getSharedState("orientationOperationExistedBefore");if(!t.optionsEqual(o))return{operation:t,options:o,existent:i,undo:function(t,o){t.getRotation()!==o.rotation&&e.broadcastRotate(o.rotation-t.getRotation());var i=o.rotation,n=90===i||270===i;t.getFlipVertically()!==o.flipVertically?e.broadcastFlip(n?"horizontal":"vertical"):t.getFlipHorizontally()!==o.flipHorizontally&&e.broadcastFlip(n?"vertical":"horizontal")}}},t.prototype._reapplyRatio=function(){var e=this.getSharedState("ratio");this._selectRatio(e)},t.prototype._onBackClick=function(t){var o=this.context.editor,i=this.getSharedState("ratio"),n=this.getSharedState("operation"),r=this.getSharedState("orientationOperation"),s=o.getRotation(),a=this.getSharedState("start").clone(),l=this.getSharedState("end").clone();if((null===i||a.equals(0,0)&&l.equals(1,1))&&0===s)o.operations.remove(n);else{var u=this._calculateTextureScale(),p={rotation:s,start:a,end:l,textureScale:u,enabled:!0},f=n.calculateScale(s),h=n.getInputDimensions(!1),d=Math.cos(-s),m=Math.sin(-s),_=l.clone().subtract(a).divide(2),g=a.clone().add(_).multiply(h),y=g.subtract(h.clone().multiply(.5)),b=new c.Vector2(y.x*d-y.y*m,y.x*m+y.y*d).divide(f),v=h.clone().multiply(.5).add(b),E=v.clone().divide(h);p.start=E.clone().subtract(_.clone().divide(f)),p.end=E.clone().add(_.clone().divide(f)),o.broadcastTransform(n,p),n.set(p)}0!==r.getRotation()||r.getFlipVertically()||r.getFlipHorizontally()||o.operations.remove(r),o.setPadding(!1),o.setRotation(0),o.setSpriteScale(1);var w=this._getHistoryItems();w.length&&o.history.add(w),o.features.enable("zoom","drag"),o.zoom.set("auto"),e.prototype._onBackClick.call(this,t)},t.prototype._selectInitialRatio=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.getSharedState("operation"),o=null,i=c.SDKUtils.flatten(this._ratios),n=t._ratio;if(n){o=i.filter(function(e){return e===n})[0]}if(!o){o=i.filter(function(e){return e.selected}).pop()}return o||(o=i[0]),this._selectRatio(o,e,!1)},t.prototype._selectRatio=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.getSharedState("operation");t&&e&&this._setDefaultOptionsForRatio(e,o),i._ratio=e;var n={ratio:e},r=this.context.editor;e?r.setPadding(this.getSharedState("activePadding")):(r.setPadding(!1),r.setRotation(0),r.setSpriteScale(1),n.rotation=0,n.start=new c.Vector2(0,0),n.end=new c.Vector2(1,1)),r.render(),this.setSharedState(n,o)},t.prototype._setDefaultOptionsForRatio=function(e){var t=e.ratio,o=(e.name,e.dimensions),i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.context.editor,r=new c.Vector2,s=new c.Vector2;if(o&&!t&&(t=o.x/o.y),"*"===t)r=new c.Vector2(0,0),s=new c.Vector2(1,1);else{var a=n.getOutputDimensions();if(a.x/a.y<=t){var l=1/a.y*(a.x/t);r.set(0,(1-l)/2),s.set(1,1-r.y)}else{var u=1/a.x*(t*a.y);r.set((1-u)/2,0),s.set(1-r.x,1)}}this.setSharedState({start:r,end:s},i)},t.prototype.renderOverlayControls=function(){var e=180*this.getSharedState("rotation")/Math.PI;return this.getSharedState("ratio")?c.ReactBEM.createElement(d.default,{value:e,minValue:-45,middleDot:!0,maxValue:45,valueUnit:"",label:this._t("controls.transform.rotation"),onChange:this._onRotationChange}):null},t.prototype._renderListItems=function(){var e=this,t=[],o=function(t){return c.ReactBEM.createElement("li",{bem:"e:item",key:t.identifier,"data-identifier":t.identifier},c.ReactBEM.createElement("bem",{specifier:"$b:controls"},c.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:e.getSharedState("ratio")===t?"is-active":null,onClick:e._selectRatio.bind(e,t)},c.ReactBEM.createElement("img",{bem:"e:icon",src:e._getAssetPath("controls/transform/"+t.identifier+".png",!0)}),c.ReactBEM.createElement("div",{bem:"e:label"},e._t("controls.transform.ratios."+t.identifier)||t.defaultName))))};this._ratios.forEach(function(e){if(Array.isArray(e)){var i=e,n=[];i.forEach(function(e){n.push(o(e))}),n.length&&t.push(n)}else{var r=e;t.push(o(r))}});var i=[];return t.forEach(function(e){i=i.concat(e),Array.isArray(e)&&e!==t[t.length-1]&&i.push(c.ReactBEM.createElement("li",{bem:"e:separator"}))}),[c.ReactBEM.createElement("li",{bem:"e:item","data-identifier":"none",key:"noTransform"},c.ReactBEM.createElement("bem",{specifier:"$b:controls"},c.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:this.getSharedState("ratio")?null:"is-active",onClick:this._selectRatio.bind(this,null)},c.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/transform/no-transform.png",!0)}),c.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.transform.none"))))),c.ReactBEM.createElement("li",{bem:"e:separator"})].concat(i)},t.prototype.renderControls=function(){var e=this._renderListItems();return c.ReactBEM.createElement("div",{bem:"e:cell m:list"},c.ReactBEM.createElement(f.default,null,c.ReactBEM.createElement("ul",{bem:"$e:list"},e)))},t}(u.default);t.default=m,m.contextTypes=u.default.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(5),l=i(c),u=o(9),p=i(u),f=new a.Vector2(50,50),h=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var a=r(this,e.call.apply(e,[this].concat(i)));return a._needsStyleFixes=!0,a._bindAll("_onCenterDragStart","_onCenterDrag"),a.state={dimensions:a.getSharedState("initialDimensions")},a}return s(t,e),t.prototype.fixStyles=function(){if(a.Utils.Browser.isIElte(11)){var e=this.context.editor,t=this.refs.container,o=e.getCanvasDimensions(!1),i=o.y;t.style.height=i+"px"}},t.prototype.sharedStateDidChange=function(e){e!==this.getSharedState("ratio")&&this._updateDimensions()},t.prototype._updateDimensions=function(){var e=this.getSharedState("operation"),t=this.getSharedState("ratio")||{ratio:"*"},o=void 0;if(t.dimensions)o=t.dimensions.clone();else{var i=e.getInputDimensions(!1),n=this.getSharedState("start");o=this.getSharedState("end").clone().subtract(n).multiply(i).floor()}this.setState({dimensions:o})},t.prototype._onCenterDragStart=function(){var e=this.getSharedState("start"),t=this.getSharedState("end");this._initialValues={start:e.clone(),end:t.clone(),size:t.clone().subtract(e)}},t.prototype._onCenterDrag=function(e){var t=this.context.editor,o=this._initialValues,i=o.start,n=o.size,r=t.getOutputDimensions(),s=e.clone().divide(r),c=new a.Vector2(0,0),l=new a.Vector2(1,1).subtract(n),u=i.clone().add(s).clamp(c,l),p=u.clone().add(n);this.setSharedState({start:u,end:p})},t.prototype._onKnobDragStart=function(e){this._currentDragOption=e,this._initialValues={start:this.getSharedState("start").clone(),end:this.getSharedState("end").clone()}},t.prototype._onKnobDrag=function(e,t){var o=this.context.editor,i=o.getOutputDimensions(),n=this.getSharedState("ratio")||{ratio:"*"},r=n.ratio,s=n.dimensions;s&&!r&&(r=s.x/s.y);var c=this._initialValues.end.clone().subtract(this._initialValues.start).multiply(i),l=void 0;"start"===e?(c.subtract(t),l=this._initialValues.end.clone().multiply(i)):"end"===e&&(c.add(t),l=new a.Vector2(1,1).subtract(this._initialValues.start).multiply(i));var u=i;if(void 0!==r&&"*"!==r&&(u=r>i.x/i.y?new a.Vector2(i.x,i.x/r):new a.Vector2(i.y*r,i.y)),c.x=Math.min(Math.max(Math.min(f.x,u.x),c.x),l.x),"*"!==r&&(c.y=c.x/r),c.y=Math.min(Math.max(Math.min(f.y,u.y),c.y),l.y),"*"!==r&&(c.x=c.y*r),"start"===e){var p=this._initialValues.end.clone().subtract(c.clone().divide(i));this.setSharedState({start:p},!1),this._updateDimensions()}else if("end"===e){var h=this._initialValues.start.clone().add(c.clone().divide(i));this.setSharedState({end:h},!1),this._updateDimensions()}},t.prototype._calculateDimensions=function(){var e=this.context.editor,t=this.getSharedState("start");return this.getSharedState("end").clone().subtract(t).multiply(e.getInputDimensions(!1)).round()},t.prototype._getAreaStyles=function(){var e=this.context.editor,t=e.getOutputDimensions(),o=e.getCanvasDimensions(),i=this.getSharedState("start").clone().multiply(t).floor(),n=this.getSharedState("end").clone().multiply(t).ceil(),r=n.clone().subtract(i),s=o.clone().subtract(t).divide(2).floor(),a=e.getPadding();return i.add(s).add(0,a[0]),{topLeft:this._getDimensionsStyles(i.x,i.y),topCenter:this._getDimensionsStyles(r.x,i.y),centerLeft:this._getDimensionsStyles(i.x,r.y),center:this._getDimensionsStyles(r.x,r.y)}},t.prototype._getDimensionsStyles=function(e,t){return{width:Math.max(1,e),height:Math.max(1,t)}},t.prototype.renderWithBEM=function(){var e=this.getSharedState("ratio"),t=this.state.dimensions,o=void 0;if(e){var i=this._getAreaStyles();o=a.ReactBEM.createElement("div",{bem:"$b:transformCanvasControls"},a.ReactBEM.createElement("div",{bem:"e:row"},a.ReactBEM.createElement("div",{bem:"e:cell m:dark",style:i.topLeft},""),a.ReactBEM.createElement("div",{bem:"e:cell m:dark",style:i.topCenter},""),a.ReactBEM.createElement("div",{bem:"e:cell m:dark"})),a.ReactBEM.createElement("div",{bem:"e:row"},a.ReactBEM.createElement("div",{bem:"e:cell m:dark",style:i.centerLeft},""),a.ReactBEM.createElement(l.default,{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},a.ReactBEM.createElement("div",{bem:"e:cell m:bordered",style:i.center},a.ReactBEM.createElement(l.default,{onStart:this._onKnobDragStart.bind(this,"start"),onDrag:this._onKnobDrag.bind(this,"start")},a.ReactBEM.createElement("div",{bem:"e:knob m:topLeft $b:knob"},a.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-down.png",!0)}))),a.ReactBEM.createElement("div",{bem:"e:dimensions"},t.x+"x"+t.y),a.ReactBEM.createElement(l.default,{onStart:this._onKnobDragStart.bind(this,"end"),onDrag:this._onKnobDrag.bind(this,"end")},a.ReactBEM.createElement("div",{bem:"e:knob m:bottomRight $b:knob"},a.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-down.png",!0)}))))),a.ReactBEM.createElement("div",{bem:"e:cell m:dark"},"")),a.ReactBEM.createElement("div",{bem:"e:row"},a.ReactBEM.createElement("div",{bem:"e:cell m:dark"},""),a.ReactBEM.createElement("div",{bem:"e:cell m:dark"},""),a.ReactBEM.createElement("div",{bem:"e:cell m:dark"},"")))}else o=a.ReactBEM.createElement("div",{bem:"$b:transformCanvasControls"},a.ReactBEM.createElement("div",{bem:"e:dimensions"},t.x+"x"+t.y));return a.ReactBEM.createElement("div",{bem:"b:canvasControls e:container m:full",ref:"container"},o)},t}(p.default);t.default=h,h.contextTypes=p.default.contextTypes},function(e,t,o){"use strict";function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(12),l=function(e){return e&&e.__esModule?e:{default:e}}(c),u=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.prototype._onRotateClick=function(e){var t=void 0;"cw"===e?t=90:"ccw"===e&&(t=-90);var o=this.context.editor,i=this.getSharedState("orientationOperation"),n=(i.getRotation()+t)%360;i.set({rotation:n});var r={orientationRotation:n},s=this.getSharedState("ratio");if(s&&!s.dimensions){var c=this.getSharedState("start"),l=this.getSharedState("end"),u=c.clone();"cw"===e?(c.set(1-l.y,u.x),l.set(1-u.y,l.x)):"ccw"===e&&(c.set(u.y,1-l.x),l.set(l.y,1-u.x)),r.start=c,r.end=l}s&&s.dimensions&&this._emitEvent(a.Constants.EVENTS.TRANSFORM_REAPPLY_RATIO),this.setSharedState(r),o.broadcastRotate(t),o.zoom.set("auto")},t.prototype._onFlipClick=function(e){var t,o=this.context.editor,n=this.getSharedState("orientationOperation"),r=!this.getSharedState("flip"+e),s=-1*this.getSharedState("rotation");this.setSharedState((t={},i(t,"flip"+e,r),i(t,"rotation",s),t)),o.setRotation(s),n.flip(e);var a=this.getSharedState("start"),c=this.getSharedState("end"),l=a.clone();"horizontal"===e?(a.set(1-c.x,a.y),c.set(1-l.x,c.y)):"vertical"===e&&(a.set(a.x,1-c.y),c.set(c.x,1-l.y)),this.setSharedState({start:a,end:c}),o.broadcastFlip(e),o.render()},t.prototype.shouldSharedComponentUpdate=function(e,t){return!1},t.prototype.renderContent=function(){return a.ReactBEM.createElement("bem",{specifier:"$b:topBar"},a.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this._onFlipClick.bind(this,"vertical")},a.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/transform/flip-v.png",!0)})),a.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this._onFlipClick.bind(this,"horizontal")},a.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/transform/flip-h.png",!0)})),a.ReactBEM.createElement("div",{bem:"e:space"}),a.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this._onRotateClick.bind(this,"ccw")},a.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/transform/rotate-ccw.png",!0)})),a.ReactBEM.createElement("div",{bem:"$e:iconButton",onClick:this._onRotateClick.bind(this,"cw")},a.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/transform/rotate-cw.png",!0)})))},t}(l.default);t.default=u,u.contextTypes=l.default.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(4),l=i(c),u=o(127),p=i(u),f=o(26),h=i(f),d=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.onEnter=function(e){var t=this.context.editor,o=t.operations.exists("filter"),i=t.operations.getOrCreate("filter"),n=i.serializeOptions(["identifier","filter","intensity"]);this.setSharedState({operation:i,operationExistedBefore:o,initialOptions:n})},t.onExit=function(){var e=this.getSharedState("initialOptions"),t=this._operation.getFilter().constructor,o=e.filter.constructor,i=void 0;"3d-lut"===o.identifier&&(i=e.filter.getImage());var n=this._operation.getIntensity();if(this._operation.getIdentifier()!==e.identifier||n!==e.intensity){var r=this.context.editor;r.history.add(this._operation,{identifier:e.identifier,intensity:n},this.getSharedState("operationExistedBefore"),function(){var e=r.operations.getOrCreate("filter");"3d-lut"===o.identifier?e.setFilter(new o({image:i})):e.setFilter(new o)})}if(t.isIdentity){this.context.editor.operations.remove(this._operation)}},t.isAvailable=function(e){return e.isToolAllowed("filter")&&e.isToolEnabled(this.identifier)},t.getPreloadAssets=function(e){var t=e.getOptions(),o=a.SDKUtils.defaults(t.editor.controlsOptions.filter,this.defaultOptions),i=new h.default(e.getUI(),o),n=[];return i.getCategories().forEach(function(e){n.push("controls/filters/categories/"+e.identifier+".png"),i.getFiltersForCategory(e.identifier).forEach(function(e){n.push("controls/filters/"+e.identifier+".png"),e.lutImage&&n.push([e.lutImage,!1,!1])})}),n},t}(l.default);d.controlsComponent=p.default,d.identifier="filter",d.iconPath="controls/overview/filters.png",d.languageKey="controls.overview.filters",d.defaultOptions={categories:[],replaceCategories:!1,availableFilters:null,hideCategories:!1},d.requiredOperations=["filter"],t.default=d},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(0),l=o(3),u=i(l),p=o(2),f=i(p),h=o(44),d=i(h),m=o(6),_=i(m),g=o(26),y=i(g),b=c.SDK.Operations.FilterOperation.Filters,v=function(e){function t(){r(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];var l=s(this,e.call.apply(e,[this].concat(i)));return l._bindAll("_onItemClick","_onOperationUpdated","_onSliderValueChange","_onCategoryChange"),l._operation=l.getSharedState("operation"),l._events=n({},c.Constants.EVENTS.OPERATION_UPDATED,l._onOperationUpdated),l._initFilterManager(),l.state={category:l._filterManager.getCategoryByIdentifier("all")},l}return a(t,e),t.prototype._initFilterManager=function(){this._filterManager=new y.default(this.context.ui,this.props.options)},t.prototype._onSliderValueChange=function(e){this._operation.setIntensity(e/100),this.context.editor.render()},t.prototype._onCategoryChange=function(e){var t=this;this.setState({category:e},function(){t.refs.scrollbar.update()})},t.prototype._onOperationUpdated=function(e){e===this._operation&&this.forceUpdate()},t.prototype._onItemClick=function(e,t){var o=this;this._filterManager.instantiateFilterWithIdentifier(e).then(function(t){o._operation.set({filter:t,identifier:e,intensity:1}),o.context.editor.render(),o.forceUpdate()})},t.prototype.renderOverlayControls=function(){if(this._operation.getFilter().isIdentity)return null;var e=this._operation.getIntensity();return c.ReactBEM.createElement(_.default,{minValue:0,maxValue:100,value:100*e,valueUnit:"%",positiveValuePrefix:"+",label:this._t("controls.filter.intensity"),onChange:this._onSliderValueChange})},t.prototype._renderListItems=function(){var e=this,t=this._operation.getIdentifier(),o=this._filterManager.getFiltersForCategory(this.state.category.identifier);return[b.IdentityFilter].concat(o).map(function(o){var i=o.identifier;return c.ReactBEM.createElement("li",{bem:"e:item",key:i,onClick:e._onItemClick.bind(e,i)},c.ReactBEM.createElement("bem",{specifier:"$b:controls"},c.ReactBEM.createElement("div",{bem:"$e:button m:withInlineLabel"},c.ReactBEM.createElement("img",{bem:"e:icon",src:e._getAssetPath("controls/filters/"+i+".png",!0)}),c.ReactBEM.createElement("div",{bem:"$e:inlineLabel",className:i===t?"is-active":null},c.ReactBEM.createElement("div",{bem:"e:label"},e._t("controls.filter.filters."+o.identifier)||o.defaultName)))))})},t.prototype._renderCategoryDropdown=function(){var e=this,t=this._filterManager.getCategories();if(this.props.options.hideCategories||!(t.length>1))return null;var o=t.map(function(t){return{identifier:t.identifier,item:t,label:e._t("controls.filter.categories."+t.identifier)||t.defaultName,icon:e._getAssetPath("controls/filters/categories/"+t.identifier+".png",!0)}}),i={identifier:this.state.category.identifier,item:this.state.category,label:this._t("controls.filter.categories."+this.state.category.identifier)||this.state.category.defaultName,icon:this._getAssetPath("controls/filters/categories/"+this.state.category.identifier+".png",!0)};return c.ReactBEM.createElement("div",{bem:"e:cell m:categoryDropdown"},c.ReactBEM.createElement(d.default,{items:o,selectedItem:i,onChange:this._onCategoryChange}))},t.prototype.renderControls=function(){var e=this._renderListItems();return[this._renderCategoryDropdown(),c.ReactBEM.createElement("div",{bem:"e:cell m:list"},c.ReactBEM.createElement(f.default,{ref:"scrollbar"},c.ReactBEM.createElement("ul",{bem:"$e:list"},e)))]},t}(u.default);t.default=v,v.contextTypes=u.default.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype._onItemClick=function(e){this.props.onChange&&this.props.onChange(e.item)},t.prototype._renderListItems=function(){var e=this;return this.props.items.map(function(t){var o=t.identifier===e.props.selectedItem.identifier;return s.ReactBEM.createElement("li",{bem:"$e:item",className:o?" is-active":"",onClick:e._onItemClick.bind(e,t)},s.ReactBEM.createElement("img",{bem:"e:icon",src:t.icon}),s.ReactBEM.createElement("div",{bem:"e:label"},t.label))})},t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("div",{bem:"$b:categoryDropdown $e:overlay"},s.ReactBEM.createElement("ul",{bem:"$e:list"},this._renderListItems()))},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(4),c=i(a),l=o(130),u=i(l),p=o(131),f=i(p),h=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.isAvailable=function(e){return e.isToolAllowed("focus")&&(e.isToolEnabled("radial-focus")||e.isToolEnabled("mirrored-focus"))},t.onExit=function(){var e=this.context.editor;e.features.enable("zoom","drag");var t=this.getSharedState("initialOptions"),o=this.getSharedState("initialOperation"),i=this.getSharedState("operation");(!i&&o||i&&o&&i.constructor===o.constructor)&&e.history.add(o,t,!0),i&&!o&&e.history.add(i,{},!1),i&&o&&i.constructor!==o.constructor&&e.history.add([{operation:o,options:t,existent:!0},{operation:i,options:{},existent:!1}])},t.onEnter=function(e){var t=this.context.editor,o=t.operations.get("mirrored-focus")||t.operations.get("radial-focus"),i={};o&&(i=o.serializeOptions(),delete i.enabled),this.setSharedState({operation:o,initialOperation:o,operationExistedBefore:!!o,initialOptions:i,inputDimensions:t.getOutputDimensions()})},t.getPreloadAssets=function(e){var t=[];return e.isToolEnabled("radial-focus")&&t.push("controls/focus/radial.png"),e.isToolEnabled("mirrored-focus")&&t.push("controls/focus/mirrored.png"),t},t}(c.default);h.controlsComponent=u.default,h.canvasControlsComponent=f.default,h.identifier="focus",h.iconPath="controls/overview/focus.png",h.languageKey="controls.overview.focus",h.defaultOptions={},h.requiredOperations=["radial-focus","mirrored-focus","linear-focus","blur"],t.default=h},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(0),l=o(3),u=i(l),p=o(2),f=i(p),h=o(6),d=i(h),m=[{toolName:"radial-focus",iconName:"radial",languageKey:"controls.focus.radial"},{toolName:"mirrored-focus",iconName:"mirrored",languageKey:"controls.focus.mirrored"}],_=function(e){function t(){r(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];var l=s(this,e.call.apply(e,[this].concat(i)));return l._bindAll("_onBlurRadiusChange","_onOperationRemoved"),l._removedOperation=null,l._events=n({},c.Constants.EVENTS.OPERATION_REMOVED,l._onOperationRemoved),l}return a(t,e),t.prototype._onBlurRadiusChange=function(e){var t=this.getSharedState("operation"),o=this.getSharedState("inputDimensions");t.setBlurRadius(e/o.min()),this.context.editor.render()},t.prototype._onButtonClick=function(e,t){var o=this.context.editor,i=this.getSharedState("operation");i&&(this._removedOperation=i,o.operations.remove(i));var n=null;e&&(n=o.operations.getOrCreate(e)),this.setSharedState({operation:n}),o.render()},t.prototype._onOperationRemoved=function(e){var t=this.getSharedState("operation");if(t&&e===t&&e!==this._removedOperation&&!this._backButtonClicked){var o=this.context.editor,i=t.constructor.identifier,n=o.operations.getOrCreate(i);this.setSharedState({operation:n,operationExistedBefore:!1,initialOptions:{}})}},t.prototype.renderOverlayControls=function(){var e=this.getSharedState("operation");if(!e)return null;var t=this.getSharedState("inputDimensions"),o=t.min(),i=e.getBlurRadius()*o;return c.ReactBEM.createElement(d.default,{minValue:0,maxValue:Math.min(180,Math.round(.1*o)),valueUnit:"px",middleDot:!1,label:this._t("controls.focus.blurRadius"),onChange:this._onBlurRadiusChange,value:i})},t.prototype._renderListItems=function(){var e=this,t=this.getSharedState("operation"),o=this.context.editor;return[c.ReactBEM.createElement("li",{bem:"e:item",key:"none"},c.ReactBEM.createElement("bem",{specifier:"$b:controls"},c.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:t?null:"is-active",onClick:this._onButtonClick.bind(this,null)},c.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/focus/none.png",!0)}),c.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.focus.none")))))].concat(m.filter(function(e){var t=e.toolName;return o.isToolEnabled(t)}).map(function(o){var i=o.toolName,n=o.iconName,r=o.languageKey,s=t&&t.constructor.identifier===i;return c.ReactBEM.createElement("li",{bem:"e:item","data-identifier":i,key:i},c.ReactBEM.createElement("bem",{specifier:"$b:controls"},c.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:s?"is-active":null,onClick:e._onButtonClick.bind(e,i)},c.ReactBEM.createElement("img",{bem:"e:icon",src:e._getAssetPath("controls/focus/"+n+".png",!0)}),c.ReactBEM.createElement("div",{bem:"e:label"},e._t(r)))))}))},t.prototype.renderControls=function(){var e=this._renderListItems();return c.ReactBEM.createElement("div",{bem:"e:cell m:list"},c.ReactBEM.createElement(f.default,null,c.ReactBEM.createElement("ul",{bem:"$e:list"},e)))},t}(u.default);t.default=_,_.contextTypes=u.default.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(9),l=i(c),u=o(132),p=i(u),f=o(133),h=i(f),d=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.prototype._getControlsForOperation=function(e){if(!e)return null;switch(e.constructor.identifier){case"mirrored-focus":return p.default;case"radial-focus":return h.default}},t.prototype.renderWithBEM=function(){var e=this.getSharedState("operation"),t=this._getControlsForOperation(e);return t?a.ReactBEM.createElement(t,this.props):a.ReactBEM.createElement("div",null)},t}(l.default);t.default=d,d.contextTypes=l.default.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(0),l=o(5),u=i(l),p=o(9),f=i(p),h=function(e){function t(){r(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];var l=s(this,e.call.apply(e,[this].concat(i)));return l._bindAll("_onCenterDragStart","_onCenterDrag","_onKnobDragStart","_onKnobDrag","_onOperationUpdated"),l.state={areaPosition:new c.Vector2,areaDimensions:new c.Vector2,knobPosition:new c.Vector2},l._operation=l.getSharedState("operation"),l._events=n({},c.Constants.EVENTS.OPERATION_UPDATED,l._onOperationUpdated),l}return a(t,e),t.prototype._onCanvasZoomDone=function(){this._setStylesFromOptions()},t.prototype._onOperationUpdated=function(e){e===this.getSharedState("operation")&&this._setStylesFromOptions()},t.prototype.sharedStateDidChange=function(e){e.operation&&(this._operation=e.operation,"mirrored-focus"===this._operation.constructor.identifier&&this._setStylesFromOptions())},t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this);var o=this.context.editor;o.zoom.set("auto",function(){o.features.disable("zoom","drag"),t._setStylesFromOptions()})},t.prototype._onCenterDragStart=function(){this._initialStart=this._operation.getStart(),this._initialEnd=this._operation.getEnd(),this._initialDist=this._initialEnd.clone().subtract(this._initialStart)},t.prototype._onCenterDrag=function(e){var t=this.context.editor,o=t.getOutputDimensions(),i=e.clone().divide(o),n=this._initialStart.clone().add(i).clamp(new c.Vector2(0,0),new c.Vector2(1,1).subtract(this._initialDist)),r=n.clone().add(this._initialDist);this._operation.set({start:n,end:r}),t.render(),this._setStylesFromOptions(),this.forceUpdate()},t.prototype._onKnobDragStart=function(e){this._initialKnobPosition=this.state.knobPosition.clone()},t.prototype._onKnobDrag=function(e){var t=this.context.editor,o=t.getOutputDimensions(),i=this._initialKnobPosition.clone().add(e).clamp(new c.Vector2(0,0),o),n=i.clone().subtract(this.state.areaPosition),r=this.state.areaPosition.clone().add(-n.y,n.x).divide(o),s=this.state.areaPosition.clone().add(n.y,-n.x).divide(o),a=2*n.len();this._operation.set({start:r,end:s,size:a/o.min(),gradientSize:a/o.min()}),this.setState({knobPosition:i,areaDimensions:new c.Vector2(this.state.areaDimensions.x,a)}),t.render()},t.prototype._getAreaStyle=function(){var e=this.state.knobPosition.clone().subtract(this.state.areaPosition),t=Math.atan2(e.x,e.y)*(180/Math.PI),o="rotate("+(-t).toFixed(2)+"deg)";return{width:this.state.areaDimensions.x,height:this.state.areaDimensions.y,left:this.state.areaPosition.x,top:this.state.areaPosition.y,marginLeft:-.5*this.state.areaDimensions.x,marginTop:-.5*this.state.areaDimensions.y,transform:o,MozTransform:o,msTransform:o,WebkitTransform:o}},t.prototype._getKnobStyle=function(){return{left:this.state.knobPosition.x,top:this.state.knobPosition.y}},t.prototype._setStylesFromOptions=function(){var e=this.context.editor,t=e.getOutputDimensions(),o=this._operation.getStart().clone().multiply(t),i=this._operation.getEnd().clone().multiply(t),n=this._operation.getSize()*t.min(),r=i.clone().subtract(o),s=o.clone().add(r.clone().divide(2)),a=new c.Vector2(2*t.len(),n),l=r.len(),u=r.clone().divide(l).divide(2);this.setState({areaDimensions:a,areaPosition:s.clone(),knobPosition:s.clone().add(-n*u.y,n*u.x)})},t.prototype._getContainerStyle=function(){var e=this.context.editor.getSDK().getSprite().getBounds();return{left:e.x,top:e.y,width:e.width,height:e.height}},t.prototype.renderWithBEM=function(){return c.ReactBEM.createElement("div",{bem:"b:canvasControls e:container m:full",ref:"container",style:this._getContainerStyle()},c.ReactBEM.createElement("div",{bem:"$b:linearFocusCanvasControls"},c.ReactBEM.createElement(u.default,{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},c.ReactBEM.createElement("div",{bem:"e:area",style:this._getAreaStyle()})),c.ReactBEM.createElement(u.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},c.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getKnobStyle()}))))},t}(f.default);t.default=h,h.contextTypes=f.default.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(0),l=o(5),u=i(l),p=o(9),f=i(p),h=function(e){function t(){r(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];var l=s(this,e.call.apply(e,[this].concat(i)));return l._bindAll("_onCenterDragStart","_onCenterDrag","_onKnobDragStart","_onKnobDrag","_onOperationUpdated"),l.state={areaPosition:new c.Vector2,areaDimensions:new c.Vector2,knobPosition:new c.Vector2},l._knobChangedManually=!1,l._operation=l.getSharedState("operation"),l._events=n({},c.Constants.EVENTS.OPERATION_UPDATED,l._onOperationUpdated),l}return a(t,e),t.prototype._onCanvasZoomDone=function(){this._setStylesFromOptions()},t.prototype._onOperationUpdated=function(e){e===this.getSharedState("operation")&&(this._knobChangedManually=!1,this._setStylesFromOptions())},t.prototype.sharedStateDidChange=function(e){e.operation&&(this._operation=e.operation,"radial-focus"===this._operation.constructor.identifier&&this._setStylesFromOptions())},t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this);var o=this.context.editor;o.zoom.set("auto",function(){o.features.disable("zoom","drag"),t._setStylesFromOptions()})},t.prototype._onCenterDragStart=function(){this._initialPosition=this._operation.getPosition(),this._initialKnobPosition=this.state.knobPosition.clone()},t.prototype._onCenterDrag=function(e){var t=this.context.editor,o=t.getOutputDimensions(),i=e.clone().divide(o),n=this._initialPosition.clone().add(i),r=this._initialKnobPosition.clone().add(e);this._operation.set({position:n}),this.state.knobPosition=r,t.render(),this._setStylesFromOptions()},t.prototype._onKnobDragStart=function(e){this._knobChangedManually=!0,this._initialKnobPosition=this.state.knobPosition.clone()},t.prototype._onKnobDrag=function(e){var t=this.context.editor,o=t.getOutputDimensions(),i=this._initialKnobPosition.clone().add(e).clamp(new c.Vector2(0,0),o),n=this._operation.getPosition().clone().multiply(o),r=i.clone().subtract(n).abs().len(),s=r/2;this.setState({knobPosition:i,areaDimensions:new c.Vector2(2*r,2*r)}),this._operation.set({radius:r/o.min(),gradientRadius:s/o.min()}),t.render()},t.prototype._getAreaStyle=function(){return{width:this.state.areaDimensions.x,height:this.state.areaDimensions.y,left:this.state.areaPosition.x,top:this.state.areaPosition.y,marginLeft:-.5*this.state.areaDimensions.x,marginTop:-.5*this.state.areaDimensions.y}},t.prototype._getKnobStyle=function(){return{left:this.state.knobPosition.x,top:this.state.knobPosition.y}},t.prototype._setStylesFromOptions=function(){var e=this.context.editor,t=e.getOutputDimensions(),o=this._operation.getPosition().clone().multiply(t),i=this._operation.getRadius()*t.min(),n=2*i,r=new c.Vector2(n,n),s={areaDimensions:r,areaPosition:o};this._knobChangedManually||(s.knobPosition=o.clone().add(i,0)),this.setState(s)},t.prototype._getContainerStyle=function(){var e=this.context.editor,t=e.getSDK().getSprite().getBounds();return{left:t.x,top:t.y,width:t.width,height:t.height}},t.prototype.renderWithBEM=function(){return c.ReactBEM.createElement("div",{bem:"b:canvasControls e:container m:full",ref:"container",style:this._getContainerStyle()},c.ReactBEM.createElement("div",{bem:"$b:radialFocusCanvasControls"},c.ReactBEM.createElement(u.default,{onStart:this._onCenterDragStart,onDrag:this._onCenterDrag},c.ReactBEM.createElement("div",{bem:"e:area",style:this._getAreaStyle()})),c.ReactBEM.createElement(u.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},c.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getKnobStyle()}))))},t}(f.default);t.default=h,h.contextTypes=f.default.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(4),l=i(c),u=o(135),p=i(u),f=o(137),h=i(f),d=a.SDK.Operations.SpriteOperation,m=d.StickerSprite,_=d.BrushSprite,g=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.onExit=function(){var e=this.context.editor,t=this.getSharedState("operation");this.getSharedState("skipHistory")||e.history.add(t,this.getSharedState("initialOptions"),this.getSharedState("operationExistedBefore")),e.zoom.restore(),e.features.enable("zoom","drag"),e.render()},t.onEnter=function(e){var t=this.context.editor,o=t.operations.exists("sprite"),i=t.operations.getOrCreate("sprite"),n=i.getSprites(),r=i.getSpritesOfType(m),s=i.serializeOptions();t.zoom.save(),t.zoom.set("auto"),t.features.disable("zoom","drag"),this.setSharedState({operationExistedBefore:o,operation:i,sprites:n,stickers:r,initialOptions:s})},t.clickAtPosition=function(e,t){if(!t.operations.exists("sprite"))return!1;var o=t.operations.getOrCreate("sprite"),i=o.getSpritesAtPosition(e,t.getOutputTextureDimensions()).filter(function(e){return!(e instanceof _)});return!!(i.length&&i[0]instanceof m)&&{selectedSprite:i[0]}},t.isAvailable=function(e){return e.isToolAllowed("sticker")&&e.isToolEnabled("sticker")},t}(l.default);g.controlsComponent=p.default,g.canvasControlsComponent=h.default,g.identifier="sticker",g.iconPath="controls/overview/sticker.png",g.languageKey="controls.overview.sticker",g.defaultOptions={categories:null,replaceCategories:!1,availableStickers:null,tooltips:!1,hideCategories:!1,fixedRatio:!0,snapRotation:90,snapRotationTolerance:5,smoothDownscaling:!1},g.requiredOperations=["sprite"],g.getPreloadAssets=l.default.getPreloadAssets,t.default=g},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},l=o(0),u=o(3),p=i(u),f=o(2),h=i(f),d=o(44),m=i(d),_=o(1),g=i(_),y=o(11),b=i(y),v=o(136),E=i(v),w=function(e){function t(){r(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];var c=s(this,e.call.apply(e,[this].concat(i)));return c._bindAll("_onStickerMouseLeave","_renderTooltipCanvas","_onCategoryChange","_onBeforeHistoryUndo"),c._events=n({},l.Constants.EVENTS.HISTORY_BEFORE_UNDO,c._onBeforeHistoryUndo),c._operation=c.getSharedState("operation"),c._sprites=c.getSharedState("sprites"),c._stickers=c.getSharedState("stickers"),c._initStickerManager(),c.state={category:c._stickerManager.getCategory("all")},c}return a(t,e),t.prototype._onBeforeHistoryUndo=function(e){var t=e.operation,o=e.options;if(t===this.getSharedState("operation")){-1===o.sprites.indexOf(this.getSharedState("selectedSprite"))&&(this.setSharedState({skipHistory:!0},!1),this.props.onSwitchControls("home"))}},t.prototype._onCategoryChange=function(e){var t=this;this.setState({category:e},function(){t.refs.scrollbar.update()})},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.props.options.stickersJSONPath&&this._loadExternalStickers();var t=this.context.editor;t.zoom.set("auto",function(){t.features.disable("zoom","drag")})},t.prototype._loadExternalStickers=function(){var e=this,t=null,o=setTimeout(function(){t=g.default.instance.displayLoading(e._t("loading.loading"))},100),i=function(){o&&(clearTimeout(o),o=null),t&&t.close(),e._jsonLoaded=!0};this._stickerManager.loadExternal(this.props.options.stickersJSONPath).then(function(t){i(),e.forceUpdate(function(){e.refs.scrollbar.update()})}).catch(function(t){i(),g.default.instance.displayError(e._t("errors.loadingStickersFailed.title"),t.message).on("close",function(){e.props.onBack()})})},t.prototype._renderTooltipCanvas=function(){var e=this,t=this.state.hoveredSticker,o=new window.Image,i=t.images.mediaBase;o.addEventListener("load",function(){if(e.state.tooltipVisible&&e.state.hoveredSticker===t){void 0!==i.width&&void 0!==i.height&&(o.width=i.width,o.height=i.height);var n=e.refs.tooltipCanvas;n.width=n.offsetWidth,n.height=n.offsetHeight;var r=n.getContext("2d"),s=Math.min(n.width/o.width,n.height/o.height),a=new l.Vector2(o.width,o.height).multiply(s),c=new l.Vector2(n.width,n.height).divide(2).subtract(a.clone().divide(2));r.drawImage(o,0,0,o.width,o.height,c.x,c.y,a.x,a.y)}});var n=this._getAssetPath(b.default.getURLForSticker(t,"base"));o.crossOrigin="Anonymous",o.src=n},t.prototype._initStickerManager=function(){this._stickerManager=new b.default(this.context.ui,this.props.options)},t.prototype._onBackClick=function(e){this._backButtonClicked=!0,this.props.onSwitchControls("home")},t.prototype._onStickerClick=function(e){var t=this,o=e.images.mediaBase,i=b.default.getURLForSticker(e,"base"),n=this._getAssetPath(i),r=new window.Image,s=void 0,a=setTimeout(function(){s=g.default.instance.displayLoading(t._t("loading.loading"))},100);r.addEventListener("load",function(){s&&s.close(),a&&(clearTimeout(a),a=null),void 0!==o.width&&void 0!==o.height&&(r.width=o.width,r.height=o.height);var i=t.context.editor,n=t._calculateInitialStickerScale(e,r),c=t._operation.createSticker({identifier:e.identifier,image:r,position:new l.Vector2(.5,.5),dimensions:new l.Vector2(r.width,r.height).multiply(n),rotation:0,smoothDownscaling:t.props.options.smoothDownscaling});t._operation.addSprite(c),t._stickers.push(c),i.render(function(){t.setSharedState({selectedSprite:c,sprites:t._sprites,stickers:t._stickers})})}),r.addEventListener("error",function(){s&&s.close(),a&&(clearTimeout(a),a=null),g.default.instance.displayError(t._t("errors.imageLoadFail.title"),t._t("errors.imageLoadFail.text",{path:r.src}))}),r.crossOrigin="Anonymous",r.src=n},t.prototype._calculateInitialStickerScale=function(e,t){var o=this.getSharedState("operation"),i=o.getInputDimensions(!1),n=new l.Vector2(t.width,t.height);return l.SDKUtils.resizeVectorToFit(n,i.clone().multiply(.5)).x/n.x},t.prototype._onStickerMouseEnter=function(e,t){var o=this;this.setState({tooltipVisible:!0,hoveredSticker:e,hoveredStickerElement:t.currentTarget},function(){o._renderTooltipCanvas(),o._updateTooltipPosition()})},t.prototype._updateTooltipPosition=function(){var e=this.state.hoveredStickerElement,t=this.refs.root,o=e.getBoundingClientRect(),i=t.getBoundingClientRect();this.setState({tooltipPosition:o.left-i.left})},t.prototype._onStickerMouseLeave=function(){this.setState({tooltipVisible:!1,hoveredSticker:null})},t.prototype._renderListItems=function(){var e=this,t=this.props.options,o=t.stickersJSONPath,i=t.replaceCategories;if(!o||!i||this._jsonLoaded){return this._stickerManager.getStickersForCategory(this.state.category.identifier).map(function(t,o){var i=e.props.options,n=i.tooltips?{onMouseEnter:e._onStickerMouseEnter.bind(e,t),onMouseLeave:e._onStickerMouseLeave}:null;return l.ReactBEM.createElement(E.default,c({sticker:t,onClick:e._onStickerClick.bind(e,t)},n))})}},t.prototype._renderTooltip=function(){var e=this.props.options.tooltips&&this.state.tooltipVisible,t={left:this.state.tooltipPosition};return e?l.ReactBEM.createElement("div",{bem:"e:cell m:empty"},l.ReactBEM.createElement("div",{bem:"$b:stickersControls $e:tooltip",style:t},l.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"tooltipCanvas"}))):null},t.prototype._renderCategoryDropdown=function(){var e=this,t=this.props.options,o=t.stickersJSONPath,i=t.replaceCategories;if(!o||!i||this._jsonLoaded){var n=this._stickerManager.getCategories(!0);if(!(!this.props.options.hideCategories&&n.length>1))return null;var r=n.map(function(t){return{identifier:t.identifier,item:t,label:e._t("controls.sticker.categories."+t.identifier)||t.defaultName,icon:e._getAssetPath("controls/stickers/categories/"+t.identifier+".png",!0)}}),s=this.state.category,a={identifier:s.identifier,item:s,label:this._t("controls.sticker.categories."+s.identifier)||s.defaultName,icon:this._getAssetPath("controls/stickers/categories/"+s.identifier+".png",!0)};return l.ReactBEM.createElement("div",{bem:"e:cell m:categoryDropdown"},l.ReactBEM.createElement(m.default,{items:r,selectedItem:a,onChange:this._onCategoryChange}))}},t.prototype.renderControls=function(){var e=this._renderListItems();return[this._renderTooltip(),this._renderCategoryDropdown(),l.ReactBEM.createElement("div",{bem:"e:cell m:list"},l.ReactBEM.createElement(h.default,{ref:"scrollbar"},l.ReactBEM.createElement("ul",{bem:"$e:list"},e)))]},t}(p.default);t.default=w,w.contextTypes=p.default.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(11),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a.state={sticker:a.props.sticker},a}return r(t,e),t.prototype.componentDidMount=function(){this._renderSticker()},t.prototype.componentWillReceiveProps=function(e){var t=this;this.props.sticker!==e.sticker&&this.setState({sticker:e.sticker},function(){t._renderSticker()})},t.prototype._renderSticker=function(){var e=this.context.editor,t=e.getSDK(),o=this.props.sticker,i=o.images.mediaThumb,n=c.default.getURLForSticker(o,"thumb"),r=this._getAssetPath(n),a=this.refs["canvas-"+o.name],l=t.getPixelRatio();a.width=a.offsetWidth*l,a.height=a.offsetHeight*l,a.style.width=a.offsetWidth+"px",a.style.height=a.offsetHeight+"px";var u=a.getContext("2d"),p=new window.Image;p.addEventListener("load",function(){void 0===i.width||void 0===i.height||s.Utils.Browser.getIEVersion()||(p.width=i.width,p.height=i.height);var e=Math.min(a.width/p.width,a.height/p.height),t=new s.Vector2(p.width,p.height).multiply(e),o=new s.Vector2(a.width,a.height).divide(2).subtract(t.clone().divide(2));u.drawImage(p,0,0,p.width,p.height,o.x,o.y,t.x,t.y)}),p.crossOrigin="Anonymous",p.src=r},t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("li",{bem:"$b:stickersControls $e:item",key:this.props.sticker.name,onClick:this.props.onClick,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},s.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas-"+this.props.sticker.name}))},t}(s.BaseComponent);t.default=l},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(14),l=i(c),u=o(141),p=i(u),f=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.prototype._renderOverlayControls=function(){if(this.getSharedState("selectedSprite"))return a.ReactBEM.createElement(p.default,{onFlip:this._onSpriteFlip,onTakeToFront:this._onSpriteTakeToFront,onRemove:this._onSpriteRemove})},t}(l.default);t.default=f,f.contextTypes=l.default.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(5),l=i(c),u=o(27),p=i(u),f=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var a=r(this,e.call.apply(e,[this].concat(i)));return a._bindAll("_onTextChange","_onItemDoubleClick","_onItemTouchStart","_onItemTouchEnd","_onResizeKnobDragStart","_onResizeKnobDrag","_onResizeKnobDragStop","_onRotationKnobDragStart","_onRotationKnobDrag","_onRotationKnobDragStop","_onBlur"),a.state={editMode:!1,text:a.props.sprite.getText()},a}return s(t,e),t.prototype.componentWillReceiveProps=function(t){e.prototype.componentWillReceiveProps.call(this,t),t.sprite!==this.props.sprite&&(this.refs.textarea.blur(),this.setState({text:t.sprite.getText(),editMode:!1}))},t.prototype._onTextChange=function(e){this.props.sprite.setText(e.target.value),this.setState({text:e.target.value})},t.prototype._onItemDoubleClick=function(){this.enterEditMode()},t.prototype.enterEditMode=function(){var e=this,t=this.props.sprite;t.setVisible(!1),t._edited||(t.setText(""),this.refs.textarea.value="",t._edited=!0,this.setState({text:""})),this.setState({editMode:!0},function(){e.refs.textarea.focus(),e.refs.textarea.select()})},t.prototype.leaveEditMode=function(){this.props.sprite.setVisible(!0)},t.prototype._onItemTouchStart=function(e){this._initialTouchPosition=a.Utils.getEventPosition(e),this._tapStartAt=(0,a.now)()},t.prototype._onItemTouchEnd=function(){(0,a.now)()-this._tapStartAt<=100&&(void 0!==this._lastTapAt&&(0,a.now)()-this._lastTapAt<=300&&this._onItemDoubleClick(),this._lastTapAt=(0,a.now)())},t.prototype._onRotationKnobDragStart=function(e,t){this._dragging=!0,this._initialPosition=this._getRotationKnobPosition(),this.props.onDragStart&&this.props.onDragStart()},t.prototype._onRotationKnobDrag=function(e,t){var o=this.props.sprite,i=this.context.editor,n=this._getAbsoluteSpritePosition(),r=this._initialPosition.clone().add(e),s=r.clone().subtract(n),a=o.getDimensions(i.getSDK(),i.getOutputDimensions()),c=Math.atan2(s.y/2,s.x/2)-Math.atan2(a.y/2,a.x/2);o.setRotation(c),i.render(),this.forceUpdate()},t.prototype._onRotationKnobDragStop=function(e){this.props.onDragStop&&this.props.onDragStop()},t.prototype._onResizeKnobDragStart=function(e,t){this._initialPosition=this._getResizeKnobPosition(),this.props.onDragStart&&this.props.onDragStart()},t.prototype._onResizeKnobDrag=function(e,t){var o=this.props.sprite,i=o.getRotation(),n=this.context.editor,r=n.getOutputDimensions(),s=Math.cos(i),a=Math.sin(i),c=this._initialPosition.clone().add(e),l=this._getAbsoluteSpritePosition(),u=c.clone().subtract(l),p=Math.max((u.x*s+u.y*a)/r.x*2,.1);o.setMaxWidth(p),n.render()},t.prototype._onResizeKnobDragStop=function(e){this.props.onDragStop&&this.props.onDragStop()},t.prototype._onBlur=function(){this.leaveEditMode()},t.prototype._getRotationKnobStyle=function(){var e=this._getRotationKnobPosition();return{left:e.x,top:e.y}},t.prototype._getResizeKnobStyle=function(){var e=this._getResizeKnobPosition();return{left:e.x,top:e.y}},t.prototype._getTextStyle=function(){var e=this.context.editor,t=this.props.sprite,o=e.getSDK(),i=e.getOutputDimensions(),n=t.getDOMStyle(o,i),r=this._getAbsoluteSpritePosition(),s=t.getDimensions(o,i);return n.height=Math.min(s.y,i.y-r.y),this.state.editMode||(n.display="none"),n},t.prototype._getItemContainerStyle=function(){var e=this.context.editor,t=this.props.sprite,o=e.getOutputDimensions(),i=t.getDimensions(e.getSDK(),o),n=t.getPosition().clone().multiply(o),r=180*t.getRotation()/Math.PI,s="rotateZ("+r.toFixed(2)+"deg)",a=i.x,c=i.y;return{width:a,height:c,left:n.x-.5*a,top:n.y-.5*c,marginLeft:0,marginTop:0,transform:s,MozTransform:s,msTransform:s,WebkitTransform:s,transformOrigin:"50% 50%",MozTransformOrigin:"50% 50%",msTransformOrigin:"50% 50%",WebkitTransformOrigin:"50% 50%"}},t.prototype._getRotationKnobPosition=function(){var e=this.props.sprite,t=this.context.editor,o=Math.sin(e.getRotation()),i=Math.cos(e.getRotation()),n=t.getOutputDimensions(),r=e.getDimensions(t.getSDK(),n),s=r.clone().divide(2);return e.getPosition().clone().multiply(n).add(s.x*i-s.y*o,s.x*o+s.y*i)},t.prototype._getResizeKnobPosition=function(){var e=this.props.sprite,t=this.context.editor,o=Math.sin(e.getRotation()),i=Math.cos(e.getRotation()),n=t.getOutputDimensions(),r=e.getDimensions(t.getSDK(),n),s=r.clone().divide(2);return e.getPosition().clone().multiply(n).add(s.x*i+s.y*o,s.x*o-s.y*i)},t.prototype._renderKnobs=function(){var e=[];return this.props.selected&&!this.state.editMode&&(e=[a.ReactBEM.createElement(l.default,{onStart:this._onRotationKnobDragStart,onDrag:this._onRotationKnobDrag,onStop:this._onRotationKnobDragStop},a.ReactBEM.createElement("div",{bem:"e:knob m:rotate $b:knob",style:this._getRotationKnobStyle()},a.ReactBEM.createElement("img",{bem:"e:icon m:larger",src:this._getAssetPath("controls/knobs/rotate.png",!0)}))),a.ReactBEM.createElement(l.default,{onStart:this._onResizeKnobDragStart,onDrag:this._onResizeKnobDrag,onStop:this._onResizeKnobDragStop},a.ReactBEM.createElement("div",{bem:"e:knob m:resize $b:knob",style:this._getResizeKnobStyle()},a.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-up.png",!0)})))]),e},t.prototype._renderItem=function(){var e=this._getItemContainerStyle(),t=a.ReactBEM.createElement("textarea",{bem:"e:content",ref:"textarea",style:this._getTextStyle(),value:this.state.text,disabled:!this.state.editMode,onBlur:this._onBlur,onChange:this._onTextChange});return a.ReactBEM.createElement("bem",{specifier:"e:text"},a.ReactBEM.createElement("div",{bem:"e:container",style:e},t))},t.prototype._renderSelectedOverlay=function(){var e=[];this.props.selected&&e.push("is-selected"),this.state.editMode&&e.push("is-disabled"),e=e.join(" ");var t=this._getItemContainerStyle();return a.ReactBEM.createElement("bem",{specifier:"e:text"},a.ReactBEM.createElement(l.default,{onStart:this._onItemDragStart,onStop:this._onItemDragStop,onDrag:this._onItemDrag,disabled:!this.props.selected||this.props.selected&&this.state.editMode},a.ReactBEM.createElement("div",{bem:"e:selectedOverlay",onDoubleClick:this._onItemDoubleClick,onTouchStart:this._onItemTouchStart,onTouchEnd:this._onItemTouchEnd,style:t,className:e})))},t.prototype.renderWithBEM=function(){return a.ReactBEM.createElement("bem",{specifier:"b:spritesCanvasControls"},a.ReactBEM.createElement("div",{bem:"$e:item e:container"},this._renderItem(),this._renderSelectedOverlay(),this._renderKnobs()))},t}(p.default);t.default=f,f.contextTypes=p.default.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(5),l=i(c),u=o(27),p=i(u),f=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var c=r(this,e.call.apply(e,[this].concat(i)));return c._bindAll("_onRotateKnobDragStart","_onRotateKnobDrag","_onRotateKnobDragStop"),c._id=a.SDKUtils.getUUID(),c}return s(t,e),t.prototype._onKnobDragStart=function(e,t,o){var i=this.props.sprite;switch(e){case"bottom":this._initialPosition=this._getBottomDragKnobPosition();break;case"top":this._initialPosition=this._getTopDragKnobPosition()}this._initialDimensions=i.getDimensions().clone(),this.props.onDragStart&&this.props.onDragStart()},t.prototype._onKnobDrag=function(e,t,o){var i=this.props.sprite,n=this.context.editor,r=this._getAbsoluteSpritePosition(),s=this._initialPosition.clone().add(t),c=s.clone().subtract(r),l=this._initialPosition.clone().subtract(r);if(this.props.options.fixedRatio){var u=this._getStickerDimensions().divide(2).abs(),p=this._initialPosition.clone().subtract(r),f=void 0;switch(e){case"bottom":f=Math.atan2(c.y,c.x)-Math.atan2(u.y,u.x);break;case"top":f=Math.atan2(c.y,c.x)-Math.atan2(-u.y,-u.x)}var h=this._initialDimensions.clone().multiply(c.len()/p.len()),d=this.props.options,m=d.snapRotation,_=d.snapRotationTolerance,g=Math.round(180*f/Math.PI),y=Math.round(g/m)*m,b=g-y;Math.abs(b)<_&&(f=y*Math.PI/180),i.set({dimensions:h,rotation:f})}else{var v=this.context.editor.zoom.get(),E=i.getRotation(),w=Math.cos(-1*E),k=Math.sin(-1*E),S=new a.Vector2(c.x*w-c.y*k,c.x*k+c.y*w),O=new a.Vector2(l.x*w-l.y*k,l.x*k+l.y*w),C=void 0;switch(e){case"bottom":C=S.clone().subtract(O);break;case"top":C=O.clone().subtract(S)}var M=this._initialDimensions.clone().add(C.clone().divide(v).multiply(2));i.set({dimensions:M})}n.render()},t.prototype._onKnobDragStop=function(){this.props.onDragStop&&this.props.onDragStop()},t.prototype._onRotateKnobDragStart=function(e,t){this._initialPosition=this._getRotateKnobPosition(),this.props.onDragStart&&this.props.onDragStart()},t.prototype._onRotateKnobDragStop=function(){this.props.onDragStop&&this.props.onDragStop()},t.prototype._onRotateKnobDrag=function(e,t){var o=this.props.sprite,i=this.context.editor,n=this._getAbsoluteSpritePosition(),r=this._initialPosition.clone().add(e),s=this._getStickerDimensions().divide(2),a=r.clone().subtract(n),c=void 0;c=Math.atan2(a.y,a.x)-Math.atan2(-s.y,s.x),o.set({rotation:c}),i.render()},t.prototype._getBottomDragKnobStyle=function(){var e=this._getBottomDragKnobPosition();return{left:e.x,top:e.y}},t.prototype._getTopDragKnobStyle=function(){var e=this._getTopDragKnobPosition();return{left:e.x,top:e.y}},t.prototype._getRotateKnobStyle=function(){var e=this._getRotateKnobPosition();return{left:e.x,top:e.y}},t.prototype._getStickerStyle=function(){var e=this.props.sprite,t=this._getStickerDimensions().abs(),o=this._getAbsoluteSpritePosition().subtract(t.clone().divide(2)),i=180*e.getRotation()/Math.PI,n="rotate("+i.toFixed(2)+"deg)",r=e.getDimensions(),s=e.getFlipVertically();r.y<0&&(s=!s),s&&(n+=" scaleY(-1)");var a=e.getFlipHorizontally();return r.x<0&&(a=!a),a&&(n+=" scaleX(-1)"),{top:o.y,left:o.x,width:t.x,height:t.y,WebkitTransform:n,msTransform:n,MozTransform:n,OTransform:n}},t.prototype._getStickerDimensions=function(){var e=this.props.sprite,t=this.context.editor;return e.getDimensions().clone().multiply(t.zoom.get())},t.prototype._getRotateKnobPosition=function(){var e=this.props.sprite,t=this._getAbsoluteSpritePosition(),o=e.getRotation(),i=Math.sin(o||0),n=Math.cos(o||0),r=this._getStickerDimensions().divide(2);return t.clone().add(r.x*n+r.y*i,r.x*i-r.y*n)},t.prototype._getBottomDragKnobPosition=function(){var e=this.props.sprite,t=this._getAbsoluteSpritePosition(),o=e.getRotation(),i=Math.sin(o||0),n=Math.cos(o||0),r=this._getStickerDimensions().divide(2);return t.clone().add(r.x*n-r.y*i,r.x*i+r.y*n)},t.prototype._getTopDragKnobPosition=function(){var e=this.props.sprite,t=this._getAbsoluteSpritePosition(),o=e.getRotation(),i=Math.sin(o||0),n=Math.cos(o||0),r=this._getStickerDimensions(e).divide(2);return t.clone().subtract(r.x*n-r.y*i,r.x*i+r.y*n)},t.prototype._renderKnobs=function(){var e=[];return this.props.selected&&(e=[a.ReactBEM.createElement(l.default,{onStart:this._onKnobDragStart.bind(this,"bottom"),onStop:this._onKnobDragStop.bind(this,"bottom"),onDrag:this._onKnobDrag.bind(this,"bottom")},a.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getBottomDragKnobStyle()},a.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-down.png",!0)}))),a.ReactBEM.createElement(l.default,{onStart:this._onKnobDragStart.bind(this,"top"),onStop:this._onKnobDragStop.bind(this,"top"),onDrag:this._onKnobDrag.bind(this,"top")},a.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getTopDragKnobStyle()},a.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/resize-diagonal-down.png",!0)})))],this.props.options.fixedRatio||e.push(a.ReactBEM.createElement(l.default,{onStart:this._onRotateKnobDragStart,onStop:this._onRotateKnobDragStop,onDrag:this._onRotateKnobDrag},a.ReactBEM.createElement("div",{bem:"e:knob $b:knob",style:this._getRotateKnobStyle()},a.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/knobs/rotate.png",!0)}))))),e},t.prototype._renderSVGFilter=function(){if(this.props.hideContent)return null;var e=this.props.sprite,t=e.getAdjustments(),o=t.getBrightness(),i=t.getSaturation(),n=t.getContrast(),r="<filter id='pesdk-sticker-"+this._id+"-filter'>\n        <feComponentTransfer>\n          <feFuncR type='linear' intercept='"+o+"' />\n          <feFuncG type='linear' intercept='"+o+"' />\n          <feFuncB type='linear' intercept='"+o+"' />\n        </feComponentTransfer>\n        <feColorMatrix type='saturate' values='"+i+"' />\n        <feComponentTransfer>\n          <feFuncR type='linear' slope='"+n+"' intercept='"+(-.5*n+.5)+"' />\n          <feFuncG type='linear' slope='"+n+"' intercept='"+(-.5*n+.5)+"' />\n          <feFuncB type='linear' slope='"+n+"' intercept='"+(-.5*n+.5)+"' />\n        </feComponentTransfer>\n      </filter>";return a.ReactBEM.createElement("svg",{width:"0",height:"0","color-interpolation-filters":"sRGB",is:"svg"},a.ReactBEM.createElement("defs",{key:Math.random(),dangerouslySetInnerHTML:{__html:r}}))},t.prototype._renderSelectedOverlay=function(){var e=[];this.props.selected&&e.push("is-selected"),e=e.join(" ");var t=this._getStickerStyle();return a.ReactBEM.createElement("bem",{specifier:"e:text"},a.ReactBEM.createElement(l.default,{onStart:this._onItemDragStart,onStop:this._onItemDragStop,onDrag:this._onItemDrag,disabled:!this.props.selected},a.ReactBEM.createElement("div",{bem:"e:selectedOverlay",onDoubleClick:this._onItemDoubleClick,onTouchStart:this._onItemTouchStart,onTouchEnd:this._onItemTouchEnd,style:t,className:e})))},t.prototype._renderItem=function(){if(this.props.hideContent)return null;var e=this.props.sprite,t=this._getStickerStyle(),o=window.location.href.replace(window.location.hash,""),i={filter:'url("'+o+"#pesdk-sticker-"+this._id+'-filter")'},n={width:t.width,height:t.height};return a.ReactBEM.createElement("bem",{specifier:"e:sticker"},a.ReactBEM.createElement("div",{bem:"e:container",style:t},a.ReactBEM.createElement("svg",{width:parseInt(t.width),height:parseInt(t.height),"color-interpolation-filters":"sRGB",is:"svg",style:n,preserveAspectRatio:"none"},a.ReactBEM.createElement("image",{xlinkHref:e.getImage().src,width:t.width,height:t.height,style:i,preserveAspectRatio:"none"}))))},t.prototype.renderWithBEM=function(){return a.ReactBEM.createElement("bem",{specifier:"b:spritesCanvasControls"},a.ReactBEM.createElement("div",{bem:"$e:item e:container"},this._renderSVGFilter(),this._renderItem(),this._renderSelectedOverlay(),this._renderKnobs()))},t}(p.default);t.default=f,f.contextTypes=p.default.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(27),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.componentDidMount=function(){if(e.prototype.componentDidMount.call(this),!this.props.hideContent){var t=this.props.sprite.getCanvas();this._appendCanvas(t)}},t.prototype.componentWillReceiveProps=function(e){if(!this.props.hideContent&&e.sprite!==this.props.sprite){var t=this.props.sprite.getCanvas();t.parentNode.removeChild(t);var o=e.sprite.getCanvas();this._appendCanvas(o)}},t.prototype._isSelected=function(){return this.getSharedState("brush")===this.props.sprite},t.prototype._appendCanvas=function(e){var t=this.context.editor,o=t.getOutputDimensions();e.style.width=o.x+"px",e.style.height=o.y+"px",this.refs.brush.appendChild(e)},t.prototype.renderWithBEM=function(){if(this.props.hideContent)return null;var e=this._isSelected()?"is-selected":null;return s.ReactBEM.createElement("bem",{specifier:"b:spritesCanvasControls"},s.ReactBEM.createElement("div",{bem:"$e:item e:container m:full",ref:"container"},s.ReactBEM.createElement("div",{bem:"$e:brush",className:e,ref:"brush"})))},t}(c.default);t.default=l,l.contextTypes=c.default.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype._onFlipClick=function(e,t){t.preventDefault(),t.stopPropagation(),this.props.onFlip&&this.props.onFlip(e)},t.prototype._onTakeToFrontClick=function(e){e.preventDefault(),e.stopPropagation(),this.props.onTakeToFront&&this.props.onTakeToFront()},t.prototype._onRemoveClick=function(e){e.preventDefault(),e.stopPropagation(),this.props.onRemove&&this.props.onRemove()},t.prototype._renderItems=function(){return[s.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onFlipClick.bind(this,"h")},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/flip-h.png",!0)})),s.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onFlipClick.bind(this,"v")},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/flip-v.png",!0)})),s.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onTakeToFrontClick.bind(this)},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/take-to-front.png",!0)})),s.ReactBEM.createElement("div",{bem:"$e:separator"}),s.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onRemoveClick.bind(this)},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/remove.png",!0)}))]},t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("div",{bem:"$b:spritesControlsOverlay"},this._renderItems())},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(4),l=i(c),u=o(143),p=i(u),f=o(145),h=i(f),d=o(46),m=i(d),_=a.SDK.Operations.SpriteOperation,g=_.TextSprite,y=_.BrushSprite,b=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.onExit=function(){var e=this.context.editor,t=this.getSharedState("operation");this.getSharedState("skipHistory")||e.history.add(t,this.getSharedState("initialOptions"),this.getSharedState("operationExistedBefore")),e.zoom.restore(),e.features.enable("zoom","drag"),e.render()},t.onEnter=function(e,t){var o=this.context,i=o.editor,n=o.ui,r=i.operations.exists("sprite"),s=i.operations.getOrCreate("sprite"),a=s.getSprites(),c=s.serializeOptions(),l=new m.default(n,t),u=l.getDefaultVariation();this.setSharedState({operationExistedBefore:r,operation:s,sprites:a,initialOptions:c,fontManager:l,defaultFontVariation:u,fonts:l.getFonts()}),i.zoom.save(),i.render()},t.clickAtPosition=function(e,t){if(!t.operations.exists("sprite"))return!1;var o=t.operations.getOrCreate("sprite"),i=o.getSpritesAtPosition(e,t.getOutputTextureDimensions()).filter(function(e){return!(e instanceof y)});return!!(i.length&&i[0]instanceof g)&&{selectedSprite:i[0]}},t.isAvailable=function(e){return e.isToolAllowed("text")&&e.isToolEnabled("text")},t.getPreloadAssets=function(e){return["controls/text/align_left.png","controls/text/align_right.png","controls/text/align_center.png","controls/text/minus.png","controls/text/plus.png"]},t}(l.default);b.controlsComponent=h.default,b.canvasControlsComponent=p.default,b.identifier="text",b.iconPath="controls/overview/text.png",b.languageKey="controls.overview.text",b.defaultOptions={fonts:[],replaceFonts:!1,availableVariations:null},b.requiredOperations=["sprite"],t.default=b},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(14),l=i(c),u=o(144),p=i(u),f=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var a=r(this,e.call.apply(e,[this].concat(i)));return a._bindAll("_onTextEdit"),a}return s(t,e),t.prototype._onItemBlur=function(){var e=this.getSharedState("selectedSprite");e&&""===e.getText()&&(e.setText(this._t("controls.text.defaultText")),e._edited=!1)},t.prototype._onSpriteRemove=function(){e.prototype._onSpriteRemove.call(this),this.props.onSwitchControls("home")},t.prototype._onTextEdit=function(){var e=this.getSharedState("selectedSprite");this.refs["sprite-"+e.getId()].enterEditMode()},t.prototype._renderOverlayControls=function(){if(this.getSharedState("selectedSprite"))return a.ReactBEM.createElement(p.default,{onTakeToFront:this._onSpriteTakeToFront,onRemove:this._onSpriteRemove,onEdit:this._onTextEdit})},t}(l.default);t.default=f,f.contextTypes=l.default.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype._onEditClick=function(e){e.preventDefault(),e.stopPropagation(),this.props.onEdit&&this.props.onEdit()},t.prototype._onTakeToFrontClick=function(e){e.preventDefault(),e.stopPropagation(),this.props.onTakeToFront&&this.props.onTakeToFront()},t.prototype._onRemoveClick=function(e){e.preventDefault(),e.stopPropagation(),this.props.onRemove&&this.props.onRemove()},t.prototype._renderItems=function(){var e=[s.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onTakeToFrontClick.bind(this)},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/take-to-front.png",!0)}))];return s.Utils.isTouchDevice()&&(e=e.concat([s.ReactBEM.createElement("div",{bem:"$e:separator"}),s.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onEditClick.bind(this)},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/edit.png",!0)}))])),e=e.concat([s.ReactBEM.createElement("div",{bem:"$e:separator"}),s.ReactBEM.createElement("div",{bem:"$e:item",onClick:this._onRemoveClick.bind(this)},s.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/remove.png",!0)}))])},t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("div",{bem:"$b:spritesControlsOverlay"},this._renderItems())},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(0),l=o(3),u=i(l),p=o(2),f=i(p),h=o(28),d=i(h),m=o(6),_=i(m),g=o(45),y=i(g),b=o(150),v=i(b),E=o(1),w=i(E),k=["left","center","right"],S=function(e){function t(){r(this,t);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];var l=s(this,e.call.apply(e,[this].concat(i)));return l._bindAll("_onFontSizeChange","_onFontChange","_onAlignmentClick","_onTakeToFrontClick","_onForegroundColorChange","_onBackgroundColorChange","_onBeforeHistoryUndo"),l._events=n({},c.Constants.EVENTS.HISTORY_BEFORE_UNDO,l._onBeforeHistoryUndo),l._operation=l.getSharedState("operation"),l._fontLoader=l.context.ui.getFontLoader(),l._fontLoader.setFonts(l.getSharedState("fonts")),l.state={mode:null,loading:!0},l.context.editor.render(),l._fonts=l.getSharedState("fonts"),l}return a(t,e),t.prototype.componentDidMount=function(){var t=this;e.prototype.componentDidMount.call(this);var o=this.context.editor;o.zoom.set("auto",function(){o.features.disable("zoom","drag")});var i=function(){t._createText(),t.setState({loading:!1})};this._fontLoader.needsToLoad()?this._loadFonts().then(i.bind(this)):i()},t.prototype._loadFonts=function(){var e=this,t=w.default.instance.displayLoading(this._t("loading.loading"));return this._fontLoader.load().then(function(){t.close()}).catch(function(o){t.close(),w.default.instance.displayWarning(e._t("errors.loadingFontsFailed.title"),e._t("errors.loadingFontsFailed.text"))})},t.prototype._createText=function(){var e=this.context.editor,t=this.getSharedState("selectedSprite"),o=this.getSharedState("operation"),i=this.getSharedState("defaultFontVariation"),n=e.getOutputDimensions();if(!t){var r=e.getSDK(),s=r.getRenderer(),a=s.getMaxTextureSize(),l=o.createText({fontIdentifier:i.getIdentifier(),text:this._t("controls.text.defaultText"),position:new c.Vector2(.5,.5),pivot:new c.Vector2(.5,.5),maxWidth:.5,maxHeight:a?a/n.y:3,fontSize:.08,fontFamily:i.getFont().getFontFamily(),fontWeight:i.getFontWeight(),fontStyle:i.getFontStyle(),alignment:"center"});o.addSprite(l),this.setSharedState({selectedSprite:l}),e.render()}},t.prototype._onBeforeHistoryUndo=function(e){var t=e.operation,o=e.options;if(t===this.getSharedState("operation")){-1===o.sprites.indexOf(this.getSharedState("selectedSprite"))&&(this.setSharedState({skipHistory:!0},!1),this.props.onSwitchControls("home"))}},t.prototype._onBackClick=function(e){this.context.editor.render(),this._backButtonClicked=!0,this.props.onSwitchControls("home")},t.prototype.sharedStateDidChange=function(e){"selectedSprite"in e&&this.forceUpdate()},t.prototype._onFontSizeChange=function(e){var t=this.context.editor,o=this.context.editor.getOutputDimensions();this.getSharedState("selectedSprite").setFontSize(e/o.y),this.forceUpdate(),t.render()},t.prototype._onFontChange=function(e){var t=this.context.editor,o=this.getSharedState("selectedSprite");o.setFontFamily(e.getFont().getFontFamily()),o.setFontWeight(e.getFontWeight()),o.setFontStyle(e.getFontStyle()),o.setFontIdentifier(e.getIdentifier()),this.forceUpdate(),t.render()},t.prototype._onAlignmentClick=function(e){var t=this.context.editor,o=this.getSharedState("selectedSprite"),i=o.getAlignment(),n=k.indexOf(i),r=(n+1)%k.length,s=k[r];o.setAlignment(s),this.forceSharedUpdate(),t.render()},t.prototype._onTakeToFrontClick=function(e){var t=this.context.editor;this.getSharedState("operation").takeSpriteToFront(this.getSharedState("selectedSprite")),this.forceSharedUpdate(),t.render()},t.prototype._onForegroundColorChange=function(e){var t=this.context.editor;this.getSharedState("selectedSprite").setColor(e),t.render()},t.prototype._onBackgroundColorChange=function(e){var t=this.context.editor;this.getSharedState("selectedSprite").setBackgroundColor(e),t.render()},t.prototype._switchToMode=function(e){e===this.state.mode&&(e=null),this.setState({mode:e})},t.prototype.renderOverlayControls=function(){switch(this.state.mode){case"size":return this._renderFontSizeOverlayControl();case"font":return this._renderFontFamilyOverlayControl();default:return null}},t.prototype._renderFontSizeOverlayControl=function(){var e=this.getSharedState("selectedSprite");if(e){var t=this.context.editor,o=t.getOutputDimensions(),i=Math.round(o.y),n=Math.round(e.getFontSize()*o.y);return c.ReactBEM.createElement(_.default,{value:n,minValue:.05*o.y,maxValue:i,label:this._t("controls.text.size"),onChange:this._onFontSizeChange})}},t.prototype._renderSizeItem=function(){var e=this.getSharedState("selectedSprite");if(e){var t=this.context.editor.getOutputDimensions(),o=e.getFontSize(),i="size"===this.state.mode?"is-active":null;return c.ReactBEM.createElement("li",{bem:"e:item",key:"size"},c.ReactBEM.createElement("bem",{specifier:"$b:controls"},c.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:i,"data-identifier":"fontSize",onClick:this._switchToMode.bind(this,"size")},c.ReactBEM.createElement("div",{bem:"b:fontSize e:text"},Math.round(o*t.y)),c.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.text.size")))))}},t.prototype._renderFontFamilyOverlayControl=function(){var e=this.getSharedState("selectedSprite");if(e)return c.ReactBEM.createElement(v.default,{fontFamily:e.getFontFamily(),fontWeight:e.getFontWeight(),fontStyle:e.getFontStyle(),fonts:this._fonts,onChange:this._onFontChange})},t.prototype._renderFontItem=function(){var e=this.getSharedState("selectedSprite");if(e){var t="font"===this.state.mode?"is-active":null;return c.ReactBEM.createElement("li",{bem:"e:item",key:"font"},c.ReactBEM.createElement("bem",{specifier:"$b:controls"},c.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:t,"data-identifier":"font",onClick:this._switchToMode.bind(this,"font")},c.ReactBEM.createElement(y.default,{fontFamily:e.getFontFamily(),fontWeight:e.getFontWeight(),fontStyle:e.getFontStyle()}),c.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.text.font")))))}},t.prototype._renderAlignmentItem=function(){var e=this.getSharedState("selectedSprite");if(e){var t=e.getAlignment();return c.ReactBEM.createElement("li",{bem:"e:item",key:"alignment"},c.ReactBEM.createElement("bem",{specifier:"$b:controls"},c.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",onClick:this._onAlignmentClick,"data-identifier":"alignment"},c.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/text/align_"+t+".png",!0)}),c.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.text.alignment")))))}},t.prototype._renderTakeToFrontItem=function(){return c.ReactBEM.createElement("li",{bem:"e:item",key:"takeToFront"},c.ReactBEM.createElement("bem",{specifier:"$b:controls"},c.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",onClick:this._onTakeToFrontClick},c.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/sprites/take_to_front.png",!0)}),c.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.text.takeToFront")))))},t.prototype.renderControls=function(){if(this.state.loading)return c.ReactBEM.createElement("div",null);var e=[this._renderSizeItem(),this._renderFontItem(),this._renderAlignmentItem()],t=this.getSharedState("selectedSprite"),o=t.getColor().clone(),i=t.getBackgroundColor().clone();return[c.ReactBEM.createElement("div",{bem:"e:cell m:list"},c.ReactBEM.createElement(f.default,{ref:"scrollbar"},c.ReactBEM.createElement("ul",{bem:"$e:list"},e))),c.ReactBEM.createElement("div",{bem:"e:cell m:colorPicker"},c.ReactBEM.createElement(d.default,{initialValue:o,label:this._t("controls.text.foreground"),onChange:this._onForegroundColorChange})),c.ReactBEM.createElement("div",{bem:"e:cell m:colorPicker"},c.ReactBEM.createElement(d.default,{initialValue:i,label:this._t("controls.text.background"),onChange:this._onBackgroundColorChange}))]},t}(u.default);t.default=S,S.contextTypes=u.default.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(147),l=i(c),u=o(148),p=i(u),f=o(149),h=i(f),d=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var a=r(this,e.call.apply(e,[this].concat(i)));a._value=a.props.initialValue.clone();var c=a._value.toHSV(),l=c[0],u=c[1],p=c[2];return a._hsv={h:l,s:u,v:p},a._bindAll("_onElementClick","_onColorChange","_onDocumentClick"),a}return s(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),document.addEventListener("click",this._onDocumentClick)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),document.removeEventListener("click",this._onDocumentClick)},t.prototype._onDocumentClick=function(e){for(var t=e.target;t;t=t.parentNode)if(t===this.refs.root)return;this.props.onClose&&this.props.onClose()},t.prototype._onElementClick=function(e){e.stopPropagation()},t.prototype._onColorChange=function(e){this._value=e,this.props.onChange&&this.props.onChange(e)},t.prototype.renderWithBEM=function(){var e=void 0;return!1!==this.props.alpha&&(e=a.ReactBEM.createElement(l.default,{initialValue:this._value,onChange:this._onColorChange})),a.ReactBEM.createElement("div",{bem:"$b:colorPicker $e:overlay",onClick:this._onElementClick,ref:"root"},e,a.ReactBEM.createElement("div",{bem:"e:bottom"},a.ReactBEM.createElement(p.default,{initialValue:this._value,onChange:this._onColorChange}),a.ReactBEM.createElement(h.default,{initialValue:this._value,onChange:this._onColorChange})))},t}(a.BaseComponent);t.default=d,d.contextTypes=a.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(5),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),a=0;a<o;a++)r[a]=arguments[a];var c=n(this,e.call.apply(e,[this].concat(r)));return c._bindAll("_onKnobDrag","_onKnobDragStart"),c._value=c.props.initialValue.clone(),c._transparentPatternCanvas=s.Utils.createTransparentPatternCanvas(),c}return r(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._renderCanvas()},t.prototype.shouldComponentUpdate=function(e){var t=e.initialValue;return t!==this._value&&(this._value=t.clone(),this._renderCanvas(),!0)},t.prototype._onKnobDragStart=function(e,t){t.target===this.refs.knob?this._initialAlpha=this._value.a:this._setAlphaFromPosition(e)},t.prototype._onKnobDrag=function(e,t){var o=this.refs.canvas,i=o.offsetWidth,n=e.x/i;this._setAlpha(this._initialAlpha+n)},t.prototype._getKnobStyle=function(){return{left:(100*this._value.a).toFixed(2)+"%",top:"50%"}},t.prototype._setAlpha=function(e){this._value.a=e,this._value.a=Math.min(1,Math.max(0,this._value.a)),this.forceUpdate(),this.props.onChange&&this.props.onChange(this._value)},t.prototype._setAlphaFromPosition=function(e){var t=this.refs.canvas;this._initialAlpha=e.x/t.offsetWidth,this._setAlpha(this._initialAlpha)},t.prototype._renderCanvas=function(){var e=this.refs.canvas,t=e.getContext("2d");e.width=e.offsetWidth,e.height=e.offsetHeight;var o=t.createPattern(this._transparentPatternCanvas,"repeat");t.fillStyle=o,t.fillRect(0,0,e.width,e.height);var i=t.createLinearGradient(0,0,e.width,e.height),n=this._value.clone();n.a=0,i.addColorStop(0,n.toRGBA()),i.addColorStop(1,this._value.toHex()),t.fillStyle=i,t.fillRect(0,0,e.width,e.height)},t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("div",{bem:"$b:colorPicker $e:alpha"},s.ReactBEM.createElement(c.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},s.ReactBEM.createElement("div",null,s.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),s.ReactBEM.createElement("div",{bem:"e:knob $b:knob m:transparent",ref:"knob",style:this._getKnobStyle()}))))},t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(5),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));a._bindAll("_onKnobDrag","_onKnobDragStart"),a._value=a.props.initialValue.clone();var c=a._value.toHSV(),l=c[0],u=c[1],p=c[2];return a._hsvColor={h:l,s:u,v:p},a}return r(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._renderCanvas()},t.prototype.shouldComponentUpdate=function(e){var t=e.initialValue;if(t!==this._value){this._value=t.clone();var o=this._value.toHSV(),i=o[0],n=o[1],r=o[2];return this._hsvColor={h:i,s:n,v:r},this._renderCanvas(),!0}return!1},t.prototype._onKnobDragStart=function(e,t){t.target===this.refs.knob?(this._initialValue=this._hsvColor.v,this._initialSaturation=this._hsvColor.s):this._setValuesFromPosition(e)},t.prototype._onKnobDrag=function(e,t){var o=this.refs.canvas,i=o.offsetWidth,n=o.offsetHeight,r=e.x/i,s=e.y/n*-1,a=this._hsvColor.h;this._setHSV(a,this._initialSaturation+r,this._initialValue+s)},t.prototype._getKnobStyle=function(){var e=this._hsvColor,t=e.s,o=e.v;return{left:(100*t).toFixed(2)+"%",top:(100*(1-o)).toFixed(2)+"%"}},t.prototype._setHSV=function(e,t,o){t=Math.max(.01,Math.min(t,.99)),o=Math.max(.01,Math.min(o,.99)),this._value=s.Color.fromHSV(e,t,o,this._value.a),this._hsvColor={h:e,s:t,v:o},this.forceUpdate(),this.props.onChange&&this.props.onChange(this._value)},t.prototype._setValuesFromPosition=function(e){var t=this.refs.canvas;this._initialSaturation=e.x/t.offsetWidth,this._initialValue=1-e.y/t.offsetHeight;var o=this._hsvColor.h;this._setHSV(o,this._initialSaturation,this._initialValue)},t.prototype._renderCanvas=function(){var e=this.refs.canvas,t=e.getContext("2d");e.width=e.offsetWidth,e.height=e.offsetHeight;for(var o=t.getImageData(0,0,e.width,e.height),i=0;i<e.height;i++)for(var n=(e.height-i)/e.height,r=0;r<e.width;r++){var a=r/e.width,c=s.Color.fromHSV(this._hsvColor.h,a,n),l=c.r,u=c.g,p=c.b,f=c.a,h=4*(i*e.width+r);o.data[h]=255*l,o.data[h+1]=255*u,o.data[h+2]=255*p,o.data[h+3]=255*f}t.putImageData(o,0,0)},t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("div",{bem:"$b:colorPicker $e:saturation"},s.ReactBEM.createElement(c.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},s.ReactBEM.createElement("div",null,s.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),s.ReactBEM.createElement("div",{bem:"e:knob $b:knob m:transparent",ref:"knob",style:this._getKnobStyle()}))))},t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(5),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));a._bindAll("_onKnobDrag","_onKnobDragStart"),a._value=a.props.initialValue.clone();var c=a._value.toHSV(),l=c[0],u=c[1],p=c[2];return a._hsvColor={h:l,s:u,v:p},a.state={value:a.props.initialValue},a}return r(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._renderCanvas()},t.prototype.shouldComponentUpdate=function(e){var t=e.initialValue;if(t!==this._value){this._value=t.clone();var o=this._value.toHSV(),i=o[0],n=o[1],r=o[2];return this._hsvColor={h:i,s:n,v:r},this._renderCanvas(),!0}return!1},t.prototype._onKnobDragStart=function(e,t){t.target===this.refs.knob?this._initialHue=this._hsvColor.h:this._setValueFromPosition(e)},t.prototype._onKnobDrag=function(e,t){var o=this.refs.canvas,i=o.offsetHeight,n=e.y/i;this._setHue(this._initialHue+n)},t.prototype._getKnobStyle=function(){return{left:"50%",top:(100*this._hsvColor.h).toFixed(2)+"%"}},t.prototype._setHue=function(e){var t=this._hsvColor,o=t.s,i=t.v;e=Math.min(1,Math.max(0,e)),o=Math.max(.01,Math.min(o,.99)),i=Math.max(.01,Math.min(i,.99)),this._value=s.Color.fromHSV(e,o,i,this._value.a),this._hsvColor={h:e,s:o,v:i},this.forceUpdate(),this.props.onChange&&this.props.onChange(this._value)},t.prototype._setValueFromPosition=function(e){var t=this.refs.canvas;this._initialHue=e.y/t.offsetHeight,this._setHue(this._initialHue)},t.prototype._renderCanvas=function(){var e=this.refs.canvas,t=e.getContext("2d");e.width=e.offsetWidth,e.height=e.offsetHeight;for(var o=0;o<e.height;o++){var i=o/e.height,n=s.Color.fromHSV(i,1,1);t.strokeStyle=n.toRGBA(),t.beginPath(),t.moveTo(0,o),t.lineTo(e.width,o),t.stroke()}},t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("div",{bem:"$b:colorPicker $e:hue"},s.ReactBEM.createElement(c.default,{onStart:this._onKnobDragStart,onDrag:this._onKnobDrag},s.ReactBEM.createElement("div",null,s.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),s.ReactBEM.createElement("div",{bem:"e:knob $b:knob m:transparent",ref:"knob",style:this._getKnobStyle()}))))},t}(s.BaseComponent);t.default=l,l.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(2),l=i(c),u=o(45),p=i(u),f=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.prototype._onListItemClick=function(e,t){this.props.onChange&&this.props.onChange(e)},t.prototype._renderListItems=function(){var e=this;return this.props.fonts.map(function(t){var o=e.props.selectedIdentifier;return t.getVariations().map(function(i){var n=o===i.getIdentifier(),r=n?"is-active":null;return a.ReactBEM.createElement("li",{bem:"e:item",key:i.getIdentifier(),className:r,onClick:e._onListItemClick.bind(e,i)},a.ReactBEM.createElement(p.default,{fontFamily:i.getFontFamily(),fontWeight:i.getFontWeight(),fontStyle:i.getFontStyle()}),a.ReactBEM.createElement("div",{bem:"e:label"},t.getFontFamily()))})})},t.prototype.renderWithBEM=function(){var e=this._renderListItems();return a.ReactBEM.createElement("div",{bem:"$b:controls e:overlay m:dark m:large"},a.ReactBEM.createElement(l.default,null,a.ReactBEM.createElement("ul",{bem:"$b:fontFamily e:list"},e)))},t}(a.BaseComponent);t.default=f,f.contextTypes=a.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(7),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t}(s.Configurable);t.default=a,a.prototype.availableOptions={fontFamily:{type:s.OptionType.STRING,required:!0},variations:{type:s.OptionType.ARRAY,required:!0}}},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(4),l=i(c),u=o(153),p=i(u),f=o(155),h=i(f),d=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.onExit=function(){var e=this.context.editor;e.zoom.restore(),e.features.enable("zoom","drag"),e.render()},t.onEnter=function(e,t){var o=this.context.editor;o.zoom.save(),o.zoom.set("auto",function(){o.render()});var i=o.getOutputDimensions(),n=o.operations.exists("sprite"),r=o.operations.getOrCreate("sprite"),s=r.createBrush(),c=r.serializeOptions(void 0,!0);r.addSprite(s);var l=Math.max(.05*i.min(),1);t.sizePresets&&t.sizePresets.length>0&&(l=t.sizePresets[0]);var u=new a.Color(1,0,0,1);this.setSharedState({operationExistedBefore:n,operation:r,brush:s,initialOptions:c,size:l,color:u,hardness:1})},t.isAvailable=function(e){return e.isToolAllowed("brush")&&e.isToolEnabled("brush")},t.getPreloadAssets=function(){return[]},t}(l.default);d.controlsComponent=p.default,d.canvasControlsComponent=h.default,d.identifier="brush",d.iconPath="controls/overview/brush.png",d.languageKey="controls.overview.brush",d.defaultOptions={sizePresets:[]},d.requiredOperations=["sprite"],t.default=d},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(0),l=o(3),u=i(l),p=o(13),f=i(p),h=o(2),d=i(h),m=o(28),_=i(m),g=o(154),y=i(g),b=function(e){function t(){var o;r(this,t);for(var i=arguments.length,a=Array(i),l=0;l<i;l++)a[l]=arguments[l];var u=s(this,e.call.apply(e,[this].concat(a)));return u._hasDoneButton=!1,u._brushOptions={size:u.getSharedState("size"),color:u.getSharedState("color").clone()},u._hasPresets=u.props.options.sizePresets&&u.props.options.sizePresets.length>0,u._hasSlider=!u._hasPresets,u._bindAll("_onSizeUpdated","_onColorUpdated","_onOperationUpdated","_onOperationRemoved"),u.state={sizeControlsEnabled:!1},u._events=(o={},n(o,c.Constants.EVENTS.OPERATION_UPDATED,u._onOperationUpdated),n(o,c.Constants.EVENTS.OPERATION_REMOVED,u._onOperationRemoved),o),u}return a(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this);var t=this.context.editor;t.zoom.set("auto"),t.features.disable("zoom","drag")},t.prototype._onSizeClick=function(e){this._onSizeUpdated(e),this.forceUpdate()},t.prototype._onOperationRemoved=function(e){if(e===this.getSharedState("operation")&&!this._backButtonClicked){var t=this.context.editor,o=t.operations.getOrCreate("sprite"),i=o.createBrush();o.addSprite(i),this.setSharedState({operation:o,brush:i,operationExistedBefore:!1,initialOptions:{}}),t.render()}},t.prototype._onOperationUpdated=function(e){if(e===this.getSharedState("operation")){var t=this.getSharedState("brush");if(t){var o=e.getSprites().filter(function(e){return e.getId()===t.getId()})[0];this.setSharedState({brush:o})}this.context.editor.render()}},t.prototype._onSizeUpdated=function(e){this.setSharedState({size:e}),this._brushOptions.size=e},t.prototype._onColorUpdated=function(e){this.setSharedState({color:e}),this._brushOptions.color=e.clone()},t.prototype._renderSizeItems=function(){var e=this,t=this.props.options.sizePresets,o=Math.max.apply(null,t);return t.map(function(t){var i=e.getSharedState("size")===t;return c.ReactBEM.createElement(y.default,{size:t,maxSize:o,active:i,key:t,onClick:e._onSizeClick.bind(e,t)})})},t.prototype.renderControls=function(){var e=this.context.editor,t=e.zoom.get(),o=[];if(this._hasSlider){var i=e.getFinalDimensions(),n=Math.round(i.clone().multiply(t).min()/2),r=this._brushOptions.size;o.push(c.ReactBEM.createElement("div",{bem:"e:cell m:slider"},c.ReactBEM.createElement(f.default,{style:"large",minValue:1,maxValue:n,valueUnit:"px",middleDot:!1,label:this._t("controls.brush.size"),onChange:this._onSizeUpdated,value:r})))}else this._hasPresets&&o.push(c.ReactBEM.createElement("div",{bem:"e:cell m:list"},c.ReactBEM.createElement(d.default,null,c.ReactBEM.createElement("ul",{bem:"$e:list"},this._renderSizeItems()))));return o.push(c.ReactBEM.createElement("div",{bem:"e:cell m:colorPicker"},c.ReactBEM.createElement(_.default,{initialValue:this._brushOptions.color.clone(),onChange:this._onColorUpdated}))),o},t}(u.default);t.default=b,b.contextTypes=u.default.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._renderCanvas()},t.prototype.componentDidUpdate=function(){this._renderCanvas()},t.prototype._renderCanvas=function(){var e=this.refs.canvas,t=e.getContext("2d");e.width=e.offsetWidth,e.height=e.offsetHeight;var o=this.props,i=o.maxSize,n=o.size,r=e.width*(n/i),s=r/2;t.fillStyle="white",t.beginPath(),t.arc(e.width/2,e.height/2,s,0,2*Math.PI),t.fill()},t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("bem",{specifier:"$b:controls $e:list"},s.ReactBEM.createElement("li",{bem:"e:item",onClick:this.props.onClick},s.ReactBEM.createElement("bem",{specifier:"$b:controls"},s.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:this.props.active?"is-active":null},s.ReactBEM.createElement("canvas",{bem:"e:canvas",ref:"canvas"}),s.ReactBEM.createElement("div",{bem:"e:label"},this.props.size)))))},t}(s.BaseComponent);t.default=a,a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(14),l=function(e){return e&&e.__esModule?e:{default:e}}(c),u=a.SDK.Operations.SpriteOperation.BrushSprite,p=a.SDK.Operations.SpriteOperation.BrushSprite.Brushes.RadialBrush,f=function(e){function t(){n(this,t);for(var o=arguments.length,s=Array(o),c=0;c<o;c++)s[c]=arguments[c];var l=r(this,e.call.apply(e,[this].concat(s)));return l._windowResized=!1,l._drawing=!1,l._bindAll("_onMouseEnter","_onMouseLeave","_onMouseDown","_onMouseMove","_onMouseUp","_onMouseMoveOnCanvas","_onWindowResize"),l._lastDrawPosition=null,l._events=a.SDKUtils.extend(l._events,i({},a.Constants.EVENTS.WINDOW_RESIZE,l._onWindowResize)),l.state={cursorVisible:!1,cursorPosition:new a.Vector2},l}return s(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._updateContainerRect()},t.prototype.componentDidUpdate=function(){this._windowResized&&(this._updateContainerRect(),this._windowResized=!1)},t.prototype._onWindowResize=function(){this._windowResized=!0},t.prototype._onOperationRemoved=function(e){},t.prototype._onOperationUpdated=function(e){e===this.getSharedState("operation")&&this.forceUpdate()},t.prototype._onMouseDown=function(e){e.preventDefault(),this._optionsBeforeDraw=this.getSharedState("operation").serializeOptions(),this._operationExistedBeforeDraw=this.getSharedState("operationExistedBefore"),this.setSharedState({operationExistedBefore:!0},!1);var t=this.context.editor.getOutputDimensions(),o=this._getCursorPosition(e),i=this.getSharedState("brush"),n=this.getSharedState("size")/t.min(),r=this.getSharedState("color"),s=this.getSharedState("hardness");this._drawing=!0;var a=new p({size:n,hardness:s,color:r});this._currentPath=i.createPath(a),this._currentPath.addControlPoint(o.clone().divide(t)),document.addEventListener("mousemove",this._onMouseMove),document.addEventListener("touchmove",this._onMouseMove),document.addEventListener("mouseup",this._onMouseUp),document.addEventListener("touchend",this._onMouseUp)},t.prototype._onMouseUp=function(){this._currentPath.setClosed(!0);var e=this.context.editor,t=e.getOutputTextureDimensions();this.getSharedState("brush").render(t),this._currentPath=null,this._drawing=!1,e.history.add(this.getSharedState("operation"),this._optionsBeforeDraw,this._operationExistedBeforeDraw),document.removeEventListener("mousemove",this._onMouseMove),document.removeEventListener("touchmove",this._onMouseMove),document.removeEventListener("mouseup",this._onMouseUp),document.removeEventListener("touchend",this._onMouseUp)},t.prototype._onMouseEnter=function(e){var t=this._getCursorPosition(e);this.setState({cursorVisible:!0,cursorPosition:t}),this._onMouseMove(e)},t.prototype._onMouseLeave=function(){this.setState({cursorVisible:!1})},t.prototype._onMouseMove=function(e){var t=this.context.editor,o=t.getOutputDimensions(),i=t.getOutputTextureDimensions(),n=t.zoom.get(),r=this._getCursorPosition(e);this.setState({cursorPosition:r});var s=void 0;if(this._lastDrawPosition){var a=this.getSharedState("size");s=this._lastDrawPosition.clone().subtract(r).abs().len()/n>=a/10}else s=!0;this._drawing&&s&&(this._currentPath.addControlPoint(r.clone().divide(o)),this.getSharedState("brush").render(i),this._lastDrawPosition=r.clone())},t.prototype._onMouseMoveOnCanvas=function(e){var t=this._getCursorPosition(e);this.setState({cursorPosition:t})},t.prototype._getPropsForSprite=function(t){var o=e.prototype._getPropsForSprite.call(this,t);return t instanceof u&&(o.hideContent=!1),o},t.prototype._getCursorStyle=function(){var e=this.getSharedState("size"),t=this.getSharedState("color"),o=this.state.cursorPosition;return{left:o.x,top:o.y,width:e,height:e,background:t.toRGBA(),marginLeft:-.5*e,marginTop:-.5*e}},t.prototype._updateContainerRect=function(){this._containerBoundingRect=this.refs.innerContainer.getBoundingClientRect()},t.prototype._getCursorPosition=function(e){var t=a.Utils.getEventPosition(e),o=this._containerBoundingRect;return t.subtract(o.left,o.top)},t.prototype._getContainerProps=function(){var t=e.prototype._getContainerProps.call(this);return t.onMouseDown=t.onTouchStart=this._onMouseDown,t},t.prototype._getInnerContainerProps=function(){var t=e.prototype._getInnerContainerProps.call(this);return delete t.onClick,t.onMouseEnter=this._onMouseEnter,t.onMouseLeave=this._onMouseLeave,t.onMouseMove=this._onMouseMoveOnCanvas,t},t.prototype._renderOverlayControls=function(){var e=this.state.cursorVisible?"is-visible":null;return a.ReactBEM.createElement("div",{bem:"$b:brushCanvasControls"},a.ReactBEM.createElement("div",{bem:"e:cursor",className:e,style:this._getCursorStyle()}))},t}(l.default);t.default=f,f.contextTypes=l.default.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(4),c=i(a),l=o(157),u=i(l),p=o(158),f=i(p),h=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.onExit=function(){var e=this.context.editor,t=this.getSharedState("operation");0===t.getPaths().length&&e.operations.remove(t),e.zoom.restore(),e.features.enable("zoom","drag"),e.render()},t.onEnter=function(e,t){var o=this.context.editor;o.zoom.save(),o.zoom.set("auto",function(){o.render()});var i=o.getOutputDimensions(),n=o.operations.exists("selective-blur"),r=o.operations.getOrCreate("selective-blur"),s=r.serializeOptions(),a=r.getBrush(),c=.1*i.min(),l=r.getInputDimensions();this.setSharedState({operationExistedBefore:n,operation:r,brush:a,initialOptions:s,size:c,hardness:1,inputDimensions:l})},t.isAvailable=function(e){return e.isToolEnabled("selective-blur")},t}(c.default);h.controlsComponent=u.default,h.canvasControlsComponent=f.default,h.identifier="selective-blur",h.iconPath="controls/overview/selective-blur.png",h.languageKey="controls.overview.selective-blur",h.defaultOptions={},h.requiredOperations=["selective-blur"],t.default=h},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(0),l=o(3),u=i(l),p=o(13),f=i(p),h=o(6),d=i(h),m=function(e){function t(){var o;r(this,t);for(var i=arguments.length,a=Array(i),l=0;l<i;l++)a[l]=arguments[l];var u=s(this,e.call.apply(e,[this].concat(a)));return u._hasDoneButton=!1,u._brushSize=u.getSharedState("size"),u._bindAll("_onOperationUpdated","_onOperationRemoved","_onSizeUpdated","_onBlurRadiusChange"),u.state={sizeControlsEnabled:!1},u._events=(o={},n(o,c.Constants.EVENTS.OPERATION_UPDATED,u._onOperationUpdated),n(o,c.Constants.EVENTS.OPERATION_REMOVED,u._onOperationRemoved),o),u}return a(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this);var t=this.context.editor;t.zoom.set("auto"),t.features.disable("zoom","drag")},t.prototype._onOperationRemoved=function(e){if(e===this.getSharedState("operation")&&!this._backButtonClicked){var t=this.context.editor,o=t.operations.getOrCreate("selective-blur"),i=o.getBrush();this.setSharedState({operation:o,brush:i,operationExistedBefore:!1,initialOptions:{}}),t.render()}},t.prototype._onOperationUpdated=function(e){if(e===this.getSharedState("operation")){this.context.editor.render(),this.forceUpdate()}},t.prototype._onSizeUpdated=function(e){this.setSharedState({size:e}),this._brushSize=e},t.prototype._onBlurRadiusChange=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getSharedState("inputDimensions");this.getSharedState("operation").setBlurRadius(e/i.min());var n=this.context.editor;n.render(),o&&n.history.add(this.getSharedState("operation"),{blurRadius:t/i.min()},!0)},t.prototype.renderOverlayControls=function(){var e=this.getSharedState("inputDimensions"),t=e.min(),o=this.getSharedState("operation").getBlurRadius()*t;return c.ReactBEM.createElement(d.default,{minValue:0,maxValue:Math.min(180,Math.round(.1*t)),value:o,valueUnit:"px",label:this._t("controls.selectiveBlur.blurRadius"),onChange:this._onBlurRadiusChange})},t.prototype.renderControls=function(){var e=this.context.editor,t=e.zoom.get(),o=[],i=e.getFinalDimensions(),n=Math.round(i.clone().multiply(t).min()/2),r=this._brushSize;return o.push(c.ReactBEM.createElement("div",{bem:"e:cell m:slider"},c.ReactBEM.createElement(f.default,{style:"large",minValue:1,maxValue:n,valueUnit:"px",middleDot:!1,label:this._t("controls.brush.size"),onChange:this._onSizeUpdated,value:r}))),o},t}(u.default);t.default=m,m.contextTypes=u.default.contextTypes},function(e,t,o){"use strict";function i(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(14),l=function(e){return e&&e.__esModule?e:{default:e}}(c),u=function(e){function t(){n(this,t);for(var o=arguments.length,s=Array(o),c=0;c<o;c++)s[c]=arguments[c];var l=r(this,e.call.apply(e,[this].concat(s)));return l._windowResized=!1,l._drawing=!1,l._bindAll("_onMouseEnter","_onMouseLeave","_onMouseDown","_onMouseMove","_onMouseUp","_onMouseMoveOnCanvas","_onWindowResize"),l._lastDrawPosition=null,l._events=a.SDKUtils.extend(l._events,i({},a.Constants.EVENTS.WINDOW_RESIZE,l._onWindowResize)),l.state={cursorVisible:!1,cursorPosition:new a.Vector2},l}return s(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._updateContainerRect()},t.prototype.componentDidUpdate=function(){this._windowResized&&(this._updateContainerRect(),this._windowResized=!1)},t.prototype._onWindowResize=function(){this._windowResized=!0},t.prototype._onOperationRemoved=function(e){},t.prototype._onOperationUpdated=function(e){e===this.getSharedState("operation")&&this.forceUpdate()},t.prototype._onMouseDown=function(e){e.preventDefault();var t=this.getSharedState("operation");this._optionsBeforeDraw=t.serializeOptions(),this._operationExistedBeforeDraw=this.getSharedState("operationExistedBefore"),this.setSharedState({operationExistedBefore:!0},!1);var o=this.context.editor.getOutputDimensions(),i=this._getCursorPosition(e),n=this.getSharedState("size")/o.min(),r=this.getSharedState("hardness");this._drawing=!0,this._currentPath=t.createPath(n,r),this._currentPath.addControlPoint(i.clone().divide(o)),document.addEventListener("mousemove",this._onMouseMove),document.addEventListener("touchmove",this._onMouseMove),document.addEventListener("mouseup",this._onMouseUp),document.addEventListener("touchend",this._onMouseUp)},t.prototype._onMouseUp=function(){this._currentPath.setClosed(!0);var e=this.context.editor;e.render(),this._currentPath=null,this._drawing=!1,e.history.add(this.getSharedState("operation"),this._optionsBeforeDraw,this._operationExistedBeforeDraw),document.removeEventListener("mousemove",this._onMouseMove),document.removeEventListener("touchmove",this._onMouseMove),document.removeEventListener("mouseup",this._onMouseUp),document.removeEventListener("touchend",this._onMouseUp)},t.prototype._onMouseEnter=function(e){var t=this._getCursorPosition(e);this.setState({cursorVisible:!0,cursorPosition:t}),this._onMouseMove(e)},t.prototype._onMouseLeave=function(){this.setState({cursorVisible:!1})},t.prototype._onMouseMove=function(e){var t=this.context.editor,o=t.getOutputDimensions(),i=t.zoom.get(),n=this._getCursorPosition(e);this.setState({cursorPosition:n});var r=void 0;if(this._lastDrawPosition){var s=this.getSharedState("size");r=this._lastDrawPosition.clone().subtract(n).abs().len()/i>=s/10}else r=!0;this._drawing&&r&&(this._currentPath.addControlPoint(n.clone().divide(o)),this._lastDrawPosition=n.clone(),t.render())},t.prototype._onMouseMoveOnCanvas=function(e){var t=this._getCursorPosition(e);this.setState({cursorPosition:t})},t.prototype._getCursorStyle=function(){var e=this.getSharedState("size"),t=this.state.cursorPosition;return{left:t.x,top:t.y,width:e,height:e,marginLeft:-.5*e,marginTop:-.5*e}},t.prototype._updateContainerRect=function(){this._containerBoundingRect=this.refs.innerContainer.getBoundingClientRect()},t.prototype._getCursorPosition=function(e){var t=a.Utils.getEventPosition(e),o=this._containerBoundingRect;return t.subtract(o.left,o.top)},t.prototype._getContainerProps=function(){var t=e.prototype._getContainerProps.call(this);return t.onMouseDown=t.onTouchStart=this._onMouseDown,t},t.prototype._getInnerContainerProps=function(){var t=e.prototype._getInnerContainerProps.call(this);return delete t.onClick,t.onMouseEnter=this._onMouseEnter,t.onMouseLeave=this._onMouseLeave,t.onMouseMove=this._onMouseMoveOnCanvas,t},t.prototype._renderSpriteItems=function(){return null},t.prototype._renderOverlayControls=function(){var e=this.state.cursorVisible?"is-visible":null;return a.ReactBEM.createElement("div",{bem:"$b:selectiveBlurCanvasControls"},a.ReactBEM.createElement("div",{bem:"e:cursor",className:e,style:this._getCursorStyle()}))},t}(l.default);t.default=u,u.contextTypes=l.default.contextTypes},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(4),c=i(a),l=o(160),u=i(l),p=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.onExit=function(){var e=this.context.editor,t=this.getSharedState("operation"),o=this.getSharedState("initialOptions"),i=t.getFrame(),n=t.getScale();(i&&i.identifier)===(o.frame&&o.frame.identifier)&&n===o.scale||e.history.add(t,this.getSharedState("initialOptions"),this.getSharedState("operationExistedBefore")),t.getFrame()||e.operations.remove(t),e.render()},t.onEnter=function(e){var t=this.context.editor,o=t.operations.exists("frame"),i=t.operations.getOrCreate("frame"),n=i.serializeOptions();this.setSharedState({operation:i,operationExistedBefore:o,initialOptions:n,inputDimensions:i.getInputDimensions(),frame:i.getFrame()})},t.isAvailable=function(e){return e.isToolAllowed("frame")&&e.isToolEnabled("frame")},t}(c.default);p.controlsComponent=u.default,p.identifier="frame",p.iconPath="controls/overview/frame.png",p.languageKey="controls.overview.frame",p.defaultOptions={frames:[]},p.requiredOperations=["sprite"],p.getPreloadAssets=c.default.getPreloadAssets,t.default=p},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=o(0),l=o(3),u=i(l),p=o(2),f=i(p),h=o(1),d=i(h),m=o(48),_=i(m),g=o(161),y=i(g),b=o(28),v=i(b),E=o(6),w=i(E),k=o(49),S=i(k),O=function(e){function t(){var o;r(this,t);for(var i=arguments.length,a=Array(i),l=0;l<i;l++)a[l]=arguments[l];var u=s(this,e.call.apply(e,[this].concat(a)));return u._operation=u.getSharedState("operation"),u._bindAll("_onScaleChange","_onColorChange","_onOperationUpdated","_onOperationRemoved"),u._events=(o={},n(o,c.Constants.EVENTS.OPERATION_UPDATED,u._onOperationUpdated),n(o,c.Constants.EVENTS.OPERATION_REMOVED,u._onOperationRemoved),o),u._initFrameManager(),u}return a(t,e),t.prototype._initFrameManager=function(){this._frameManager=new _.default(this.context.ui,this.props.options)},t.prototype._onOperationUpdated=function(e){e===this.getSharedState("operation")&&this.forceSharedUpdate()},t.prototype._onOperationRemoved=function(e){if(e===this.getSharedState("operation")&&!this._backButtonClicked){var t=this.context.editor,o=t.operations.getOrCreate("frame");this.setSharedState({operation:o,frame:null,operationExistedBefore:!1,initialOptions:{}}),t.render()}},t.prototype._onScaleChange=function(e){var t=this.context.editor,o=this.getSharedState("inputDimensions");this._operation.setScale(e/o.min()),t.render()},t.prototype._onColorChange=function(e){this.getSharedState("operation").setTintColor(e.clone()),this.context.editor.render()},t.prototype._onBackClick=function(e){this._backButtonClicked=!0,this.props.onSwitchControls("home")},t.prototype._onFrameClick=function(e){var t=this,o=this.context.editor,i=this.getSharedState("operation");if(null===e)return i.setFrame(null),o.render(),this.setSharedState({frame:null});var n=void 0,r=setTimeout(function(){n=d.default.instance.displayLoading(t._t("loading.loading"))},100),s=new S.default(this.context.ui,e);s.load().then(function(){n&&n.close(),r&&(clearTimeout(r),r=null);var e=s.getFrame();i.setFrame(e),t.context.editor.render(),t.setSharedState({frame:s})})},t.prototype.renderOverlayControls=function(){if(!this.getSharedState("frame"))return null;var e=this.getSharedState("inputDimensions"),t=Math.round(.3*e.min()),o=this._operation.getScale()*e.min();return c.ReactBEM.createElement(w.default,{minValue:5,maxValue:t,value:o,valueUnit:"px",middleDot:!1,label:this._t("controls.frame.scale"),onChange:this._onScaleChange})},t.prototype._renderListItems=function(){var e=this,t=this._frameManager.getFramesForCategory("all"),o=this.getSharedState("operation").getFrame();return[c.ReactBEM.createElement("li",{bem:"e:item",key:"no-frame",onClick:this._onFrameClick.bind(this,null)},c.ReactBEM.createElement("bem",{specifier:"$b:controls"},c.ReactBEM.createElement("div",{bem:"$e:button m:withLabel",className:o?null:"is-active"},c.ReactBEM.createElement("img",{bem:"e:icon",src:this._getAssetPath("controls/frame/no-frame.png",!0)}),c.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.frame.noFrame")))))].concat(t.map(function(t,i){return c.ReactBEM.createElement(y.default,{frame:t,active:o&&o.identifier===t.identifier,onClick:e._onFrameClick.bind(e,t)})}))},t.prototype.renderControls=function(){var e=this.getSharedState("operation").getFrame(),t=this._renderListItems(),o=[c.ReactBEM.createElement("div",{bem:"e:cell m:list"},c.ReactBEM.createElement(f.default,{ref:"scrollbar"},c.ReactBEM.createElement("ul",{bem:"$e:list"},t)))];if(e&&e.tintable){var i=this.getSharedState("operation");o.push(c.ReactBEM.createElement("div",{bem:"e:cell m:colorPicker"},c.ReactBEM.createElement(v.default,{initialValue:i.getTintColor().clone(),onChange:this._onColorChange})))}return o},t}(u.default);t.default=O,O.contextTypes=u.default.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a.state={frame:a.props.frame},a}return r(t,e),t.prototype.componentDidMount=function(){this._renderFrame()},t.prototype.componentWillReceiveProps=function(e){var t=this;this.props.frame!==e.frame&&this.setState({frame:e.frame},function(){t._renderFrame()})},t.prototype._renderFrame=function(){var e=this.context.editor,t=e.getSDK(),o=this.props.frame,i=this._getAssetPath(o.thumbnail),n=this.refs["canvas-"+o.identifier],r=t.getPixelRatio();n.width=n.offsetWidth*r,n.height=n.offsetHeight*r,n.style.width=n.offsetWidth+"px",n.style.height=n.offsetHeight+"px";var a=n.getContext("2d"),c=new window.Image;c.addEventListener("load",function(){var e=Math.min(n.width/c.width,n.height/c.height),t=new s.Vector2(c.width,c.height).multiply(e),o=new s.Vector2(n.width,n.height).divide(2).subtract(t.clone().divide(2));a.drawImage(c,0,0,c.width,c.height,o.x,o.y,t.x,t.y)}),c.crossOrigin="Anonymous",c.src=i},t.prototype.renderWithBEM=function(){return s.ReactBEM.createElement("bem",{specifier:"b:controls e:list"},s.ReactBEM.createElement("li",{bem:"e:item",key:this.props.frame.identifier,onClick:this.props.onClick},s.ReactBEM.createElement("bem",{specifier:"$b:controls"},s.ReactBEM.createElement("div",{bem:"$e:button m:withInlineLabel"},s.ReactBEM.createElement("canvas",{bem:"e:canvas m:large",ref:"canvas-"+this.props.frame.identifier}),s.ReactBEM.createElement("div",{bem:"$e:inlineLabel",className:this.props.active?"is-active":null},s.ReactBEM.createElement("div",{bem:"e:label"},this._t("controls.frame.frames."+this.props.frame.identifier)||this.props.frame.defaultName))))))},t}(s.BaseComponent);t.default=a},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),r=function(){function e(t,o,n){i(this,e),this._editor=t,this._sdk=o,this._mediator=n,this._options=this._editor.getOptions(),this._features={drag:this._options.editor.enableDrag,zoom:this._options.editor.enableZoom}}return e.prototype.isEnabled=function(e){var t=e.charAt(0).toUpperCase()+e.slice(1),o=this._options.editor["enable"+t];return this._features[e]&&o},e.prototype.enable=function(){for(var e=this,t=arguments.length,o=Array(t),i=0;i<t;i++)o[i]=arguments[i];o.forEach(function(t){e._features[t]=!0}),this._mediator.emit(n.Constants.EVENTS.FEATURES_ENABLED,o),this._mediator.emit(n.Constants.EVENTS.FEATURES_UPDATED,o)},e.prototype.disable=function(){for(var e=this,t=arguments.length,o=Array(t),i=0;i<t;i++)o[i]=arguments[i];o.forEach(function(t){e._features[t]=!1}),this._mediator.emit(n.Constants.EVENTS.FEATURES_DISABLED,o),this._mediator.emit(n.Constants.EVENTS.FEATURES_UPDATED,o)},e}();t.default=r},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(o,r,s){i(this,t);var a=n(this,e.call(this));return a._editor=o,a._sdk=r,a._mediator=s,a._isDefaultZoom=!1,a._zoom=a._sdk.getZoom(),a._options=a._editor.getOptions(),a._zoomLevels=[1,2,3,4,5,6.25,8.33,12.5,16.66,25,33.33,50,66.66,100,200,300,400,500,600,700,800,1200,1600,3200].map(function(e){return e/100}),a}return r(t,e),t.prototype.in=function(){var e=this._getClosestZoomLevel(this._zoom+.001,1);if(!e)return this._zoomLevels[this._zoomLevels.length-1];this.set(e)},t.prototype.out=function(){var e=this._getClosestZoomLevel(this._zoom-.001,-1);if(!e)return this._zoomLevels[0];this.set(e)},t.prototype._getClosestZoomLevel=function(e,t){return-1===t?this._zoomLevels.filter(function(t){return t<e}).pop():1===t?this._zoomLevels.filter(function(t){return t>e})[0]:void 0},t.prototype.restore=function(){this._previousZoom&&(this.set(this._previousZoom),this._previousZoom=null)},t.prototype.save=function(){this._previousZoom=this._zoom},t.prototype.set=function(e,t){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this._editor.isReady()){var i=e,n=this.getDefault();"auto"===e||i===n?(i=n,e="auto",this._isDefaultZoom=!0):this._isDefaultZoom=!1;var r=Math.max(1,2*n),s=o?this.getMinimum():0;i=Math.max(s,Math.min(r,i)),this._zoom=i,this._sdk.setZoom(this._zoom),this._sdk.setTextureQuality(Math.min(this._zoom,1)),this.emit("set",this._zoom,t)}},t.prototype.getDefault=function(){var e=this._editor.getFinalDimensions(!1),t=this._editor.getCanvasDimensions();return s.SDKUtils.resizeVectorToFit(e,t).divide(e).x},t.prototype.getMinimum=function(){var e=this._editor.getFinalDimensions();return s.SDKUtils.resizeVectorToFit(e,new s.Vector2(300,300)).divide(e).x},t.prototype.isDefault=function(){return this._isDefaultZoom},t.prototype.get=function(){return this._zoom},t}(s.EventEmitter);t.default=a},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(o,r,s){i(this,t);var a=n(this,e.call(this));return a._editor=o,a._sdk=r,a._mediator=s,a._history=[],a}return r(t,e),t.prototype.isAvailable=function(){return 0!==this._history.length},t.prototype.add=function(e,t,o){var i=this,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=void 0;if(e instanceof Array){var a=e;this._history.push(a),a.forEach(function(e){i._mediator.emit(s.Constants.EVENTS.HISTORY_UPDATED,e.operation)}),r=a}else r={operation:e,options:t,existent:o,undo:n},this._history.push(r),this._mediator.emit(s.Constants.EVENTS.HISTORY_UPDATED,e);return r},t.prototype.undo=function(){var e=this,t=this._editor.operations,o=this._history.pop();if(o){[].concat(o).forEach(function(o){var i=o.operation,n=o.existent,r=o.options,a=o.undo;e._mediator.emit(s.Constants.EVENTS.HISTORY_BEFORE_UNDO,o),n?(i=t.getOrCreate(i.constructor.identifier),i.set(r),e._mediator.emit(s.Constants.EVENTS.OPERATION_UPDATED,i)):t.remove(i),"function"==typeof a&&a(i,r),e._mediator.emit(s.Constants.EVENTS.HISTORY_UPDATED,i),e._mediator.emit(s.Constants.EVENTS.HISTORY_UNDO,i)}),this.emit("undo")}},t.prototype.reset=function(){this._history=[]},t}(s.EventEmitter);t.default=a},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=o(50),s=i(r),a=o(51),c=i(a),l=function(){function e(t){n(this,e),this._editor=t}return e.prototype.serialize=function(){var e=new s.default(this._editor);return e.serialize.apply(e,arguments)},e.prototype.deserialize=function(e){return new c.default(this._editor,e).deserialize()},e}();t.default=l,l.version="1.0.0"},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),r=function(){function e(t,o){i(this,e),this._ui=t,this._options=o,this._brushes=[],this._brushesById={},this._addBrushes(n.Constants.DEFAULTS.BRUSHES);var r=this._options,s=r.brushes,a=r.replaceBrushes,c=r.availableBrushes;this._options.brushes&&this._addBrushes(s,a),c&&(this._brushes=this._brushes.filter(function(e){return-1!==c.indexOf(e.identifier)}))}return e.prototype._addBrushes=function(e,t){var o=this;t&&(this._brushes=[],this._brushesById={}),e.forEach(function(e){o._brushes.push(e),o._brushesById[e.identifier]=e})},e.prototype.getBrushByIdentifier=function(e){return this._brushesById[e]},e.prototype.getBrushes=function(){return this._brushes},e.prototype.getFirstBrush=function(){return this._brushes[0]},e}();t.default=r},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(52),a=function(e){return e&&e.__esModule?e:{default:e}}(s),c={italic:"i"},l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.load=function(){return this._fonts.length&&this._addStylesheetTag(),e.prototype.load.call(this)},t.prototype._addStylesheetTag=function(){var e=this._getFamiliesString(),t=document.createElement("link");t.rel="stylesheet",t.href="https://fonts.googleapis.com/css?family="+e,document.getElementsByTagName("head")[0].appendChild(t)},t.prototype._getFamiliesString=function(){var e={};this._fonts.forEach(function(t){var o=t.getFontFamily(),i=t.getFontStyle(),n=t.getFontWeight();e[o]=e[o]||[],void 0!==n?e[o].push(""+n+(c[i]||"")):e[o].push(400)});var t=[];for(var o in e){var i=e[o],n=i.length?":"+i.join(","):"",r=o.replace(" ","+")+n;t.push(r)}return t.join("|")},t}(a.default);t.default=l},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=o(169),r=function(e){return e&&e.__esModule?e:{default:e}}(n),s="undefined"!=typeof window&&window.performance&&window.performance.now?window.performance.now.bind(window.performance):o(38),a=function(){function e(t){i(this,e),this._fontVariation=t,this._defaultFontRuler=new r.default,this._customFontRuler=new r.default(this._fontVariation)}return e.prototype.observe=function(){var e=this,t=s();return new Promise(function(o,i){var n=window.setInterval(function(){if(e._defaultFontRuler.getWidth()!==e._customFontRuler.getWidth())return window.clearInterval(n),o();if(s()-t>=5e3){var r=new Error("Failed to load font "+e._fontVariation.getFontFamily()+".");return r.font=e._fontVariation,i(r)}},50)})},e.prototype.dispose=function(){this._defaultFontRuler.dispose(),this._customFontRuler.dispose()},e}();t.default=a},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=o(47),r=function(e){return e&&e.__esModule?e:{default:e}}(n),s=function(){function e(t){i(this,e),this._fontVariation=t||new r.default({fontFamily:"Times New Roman",fontWeight:"normal",fontStyle:"normal"}),this._createRuler()}return e.prototype._createRuler=function(){this._ruler=document.createElement("div"),this._ruler.innerText="abcdefghijklmnopqrstuvwxzy",document.body.appendChild(this._ruler),this._setRulerStyle()},e.prototype._setRulerStyle=function(){this._ruler.style.cssText="\n      position: absolute;\n      top: -9999px;\n      left: -9999px;\n      opacity: 0;\n      display: inline-block;\n      font: "+this._fontVariation.getFontStyle()+" "+this._fontVariation.getFontWeight()+" 30px "+this._fontVariation.getFontFamily()+";\n    "},e.prototype.setFontVariation=function(e){this._fontVariation=e,this._setRulerStyle()},e.prototype.getWidth=function(){return this._ruler.offsetWidth},e.prototype.dispose=function(){this._ruler&&(this._ruler.parentNode.removeChild(this._ruler),this._ruler=null)},e}();t.default=s},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(52),a=function(e){return e&&e.__esModule?e:{default:e}}(s),c=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.load=function(){var t=this,o=[];this._fonts.forEach(function(e){var i=t._ui.getAssetPath(e.getFilePath(),!1,!0);o.push('@font-face {\n        font-family: "'+e.getFontFamily()+"\";\n        src: url('"+i+"') format('woff');\n        font-weight: "+e.getFontWeight()+";\n        font-style: "+e.getFontStyle()+";\n      }")});var i=o.join("\n"),n=document.createElement("style");return n.innerHTML=i,document.getElementsByTagName("head")[0].appendChild(n),e.prototype.load.call(this)},t}(a.default);t.default=c},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=o(53),s=i(r),a=o(54),c=i(a),l=function(){function e(t){n(this,e),this._editor=t}return e.prototype.serialize=function(){var e=new s.default(this._editor);return e.serialize.apply(e,arguments)},e.prototype.deserialize=function(e){return new c.default(this._editor,e).deserialize()},e}();t.default=l,l.version="1.0.1"},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=o(30),s=i(r),a=o(31),c=i(a),l=function(){function e(t){n(this,e),this._editor=t}return e.prototype.serialize=function(){var e=new s.default(this._editor);return e.serialize.apply(e,arguments)},e.prototype.deserialize=function(e){return new c.default(this._editor,e).deserialize()},e}();t.default=l,l.version="2.0.0"},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),r=function(){function e(t,o){var r=this;i(this,e),this._ui=t,this._options=o,this._overlays=n.SharedConstants.DEFAULTS.OVERLAYS.slice(0),this._overlaysByIdentifier={},o.overlays&&(o.replaceOverlays?this._overlays=o.overlays:this._overlays=this._overlays.concat(o.overlays)),o.availableOverlays&&(this._overlays=this._overlays.filter(function(e){return-1!==o.availableOverlays.indexOf(e.identifier)})),this._overlays.forEach(function(e){r._overlaysByIdentifier[e.identifier]=e})}return e.prototype.getOverlays=function(){return this._overlays},e.prototype.getOverlayByIdentifier=function(e){return this._overlaysByIdentifier[e]},e}();t.default=r},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=o(175),s=i(r),a=o(176),c=i(a),l=function(){function e(t){n(this,e),this._editor=t}return e.prototype.serialize=function(){var e=new s.default(this._editor);return e.serialize.apply(e,arguments)},e.prototype.deserialize=function(e){return new c.default(this._editor,e).deserialize()},e}();t.default=l,l.version="2.0.1"},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(30),a=function(e){return e&&e.__esModule?e:{default:e}}(s),c=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t}(a.default);t.default=c,c.version="2.0.0"},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(31),a=function(e){return e&&e.__esModule?e:{default:e}}(s),c=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t}(a.default);t.default=c,c.version="2.0.1"},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=o(178),s=i(r),a=o(179),c=i(a),l=function(){function e(t){n(this,e),this._editor=t}return e.prototype.serialize=function(){var e=new s.default(this._editor);return e.serialize.apply(e,arguments)},e.prototype.deserialize=function(e){return new c.default(this._editor,e).deserialize()},e}();t.default=l,l.version="3.0.0"},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(30),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.serialize=function(){var t=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.prototype.serialize.call(this,o).then(function(e){return e.meta={platform:"html5",version:t._editor.getSDK().version,createdAt:s.SDKUtils.ISODateString(new Date)},e.image=e.inputImage,delete e.inputImage,e})},t.prototype._serializeSticker=function(t,o){var i=e.prototype._serializeSticker.call(this,t,o);return i.options.alpha=o.getAlpha(),i.options.tintColor&&(i.options.tintColor={rgba:i.options.tintColor}),i},t.prototype._serializeText=function(t,o){var i=e.prototype._serializeText.call(this,t,o);return i.options.color={rgba:i.options.color},i.options.backgroundColor={rgba:i.options.backgroundColor},i.options.flipHorizontally=!1,i.options.flipVertically=!1,delete i.options.fontWeight,i},t.prototype._serializePath=function(t){var o=e.prototype._serializePath.call(this,t);delete o.hardness,delete o.size,delete o.color;var i=t.getBrush();o.brush=i.serializeOptions(["identifier","size","color"],!0),void 0===o.brush.identifier&&delete o.brush.identifier,o.brush.color={rgba:o.brush.color};var n=i.getOption("hardness");return"undefined"!==n&&(o.brush.hardness=n),o},t.prototype._serializeFrameOperation=function(t,o){e.prototype._serializeFrameOperation.call(this,t,o);var i=o.filter(function(e){return"sprite"===e.type}),n=void 0;if(i.length){n=i.pop();var r=n.options.sprites.filter(function(e){return"frame"===e.type})[0];t.getTintColor().equals(new s.Color(1,1,1,0))||(r.options.tintColor={rgba:t.serializeOption("tintColor",!0)});var a=t.serializeOptions(["scale","alpha"],!0);r.options=s.SDKUtils.extend(r.options,a),r.options.size=r.options.scale,delete r.options.scale}},t.prototype._serializeTransformOperation=function(t){var o=e.prototype._serializeTransformOperation.call(this,t);return t._ratio&&(o.options.meta={identifier:t._ratio.identifier}),delete o.options.scale,o},t.prototype._serializeAdjustmentsOperation=function(t){var o=e.prototype._serializeAdjustmentsOperation.call(this,t),i=t.availableOptions,n=i.gamma,r=t.getGamma(),s=n.minValue,a=n.midValue,c=n.maxValue;return o.options.gamma=r<=a?(r-s)/(a-s)-1:(r-a)/(c-a),o},t.prototype._serializeOperation=function(t,o){switch(t.constructor.identifier){case"mirrored-focus":return this._serializeMirroredFocusOperation(t);case"linear-focus":return this._serializeLinearFocusOperation(t);case"blur":return this._serializeBlurOperation(t);default:return e.prototype._serializeOperation.call(this,t,o)}},t.prototype._serializeMirroredFocusOperation=function(e){return{type:"focus",options:{type:"mirrored",options:e.serializeOptions(["start","end","blurRadius","size","gradientSize"],!0)}}},t.prototype._serializeLinearFocusOperation=function(e){var t=e.serializeOptions(["controlPoint1","controlPoint2","blurRadius"],!0);return t.start=t.controlPoint1,delete t.controlPoint1,t.end=t.controlPoint2,delete t.controlPoint2,{type:"focus",options:{type:"linear",options:t}}},t.prototype._serializeBlurOperation=function(e){return{type:"focus",options:{type:"gaussian",options:e.serializeOptions(["blurRadius"],!0)}}},t}(c.default);t.default=l,l.version="3.0.0"},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(31),l=i(c),u=o(11),p=i(u),f=o(22),h=i(f),d=void 0;void 0!==a.SDK.Operations.SpriteOperation&&(d=a.SDK.Operations.SpriteOperation.BrushSprite.Brush);var m=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t.prototype._deserializeSticker=function(e,t){var o=a.SDK.Operations.SpriteOperation,i=t.options,n=this._stickerManager.getStickerByIdentifier(i.identifier);if(!n)return a.Log.warn("Deserializer","Unknown sticker `"+i.identifier+"`. Skipping sprite."),Promise.resolve();var r=p.default.getURLForSticker(n,"base"),s=this._editor.getUI().getAssetPath(r),c=e.getInputDimensions(!1);return h.default.load(s).then(function(t){var r=o.StickerSprite.prototype.availableOptions.adjustments.structure,s=i.rotation,l=i.flipHorizontally,u=i.flipVertically,p={identifier:i.identifier,image:t,position:a.Vector2.fromObject(i.position),dimensions:a.Vector2.fromObject(i.dimensions).multiply(c.min()),rotation:s||0,flipHorizontally:l,flipVertically:u,adjustments:{}};return void 0!==i.adjustments&&["brightness","contrast","saturation"].forEach(function(e){void 0!==i.adjustments[e]&&(p.adjustments[e]=i.adjustments[e]+r[e].default)}),void 0!==i.tintColor&&void 0!==n.tintMode&&(p.tintColor=a.Color.fromArray(i.tintColor.rgba),p.tintMode=n.tintMode),void 0!==i.alpha&&(p.alpha=i.alpha),e.createSticker(p)})},t.prototype._deserializeTransformOperation=function(t){return e.prototype._deserializeTransformOperation.call(this,t).then(function(e){if(e)return e._ratio=null,e})},t.prototype._deserializeInputImage=function(){var e=this,t=this._data.image,o=t.data,i=t.type,n=t.uri;return o&&i&&(n="data:"+i+";base64,"+o),n?h.default.load(n).then(function(t){e._editor.setImage(t)}):Promise.resolve()},t.prototype._deserializeAdjustmentsOperation=function(t){var o=a.SDK.Operations.AdjustmentsOperation;return e.prototype._deserializeAdjustmentsOperation.call(this,t).then(function(e){if(!e)return null;var i=t.options;if(void 0!==i.gamma){var n=o.prototype.availableOptions.gamma,r=n.minValue,s=n.midValue,a=n.maxValue;e.setGamma(i.gamma<0?s+(s-r)*i.gamma:s+(a-s)*i.gamma)}return e})},t.prototype._deserializeFocusOperation=function(t){var o=t.options.options;switch(t.options.type){case"radial":return e.prototype._deserializeFocusOperation.call(this,t);case"linear":var i=o.start,n=o.end,r=o.blurRadius;return Promise.resolve(this._editor.operations.getOrCreate("linear-focus",{controlPoint1:a.Vector2.fromObject(i),controlPoint2:a.Vector2.fromObject(n),blurRadius:r}));case"mirrored":var s=o.start,c=o.end,l=o.size,u=o.gradientSize,p=o.blurRadius;return Promise.resolve(this._editor.operations.getOrCreate("mirrored-focus",{start:a.Vector2.fromObject(s),end:a.Vector2.fromObject(c),size:l,gradientSize:u,blurRadius:p}));case"gaussian":var f=o.blurRadius;return Promise.resolve(this._editor.operations.getOrCreate("blur",{blurRadius:f}))}},t.prototype._deserializeText=function(e,t){var o=t.options,i=o.fontSize,n=o.lineHeight,r=o.fontIdentifier,s=o.alignment,c=o.rotation,l=o.maxWidth,u=o.color,p=o.backgroundColor,f=this._ui.getFontLoader(),h=this._fontManager.getVariationByIdentifier(r);return h?f.setFonts([h.getFont()]):h=this._fontManager.getDefaultVariation(),f.load().then(function(){var t=e.getInputDimensions(!1),r=l*t.min()/t.x;return e.createText({fontSize:i,lineHeight:n,fontFamily:h.getFontFamily(),fontWeight:h.getFontWeight(),fontIdentifier:h.getIdentifier(),textMetrics:h.getTextMetrics(),alignment:s,rotation:c,maxWidth:r,text:o.text,color:a.Color.fromArray(u.rgba),backgroundColor:a.Color.fromArray(p.rgba),position:a.Vector2.fromObject(o.position)})})},t.prototype._createBrushForPath=function(e){var t=e.brush,o=t.identifier,i=t.color,c=t.size,l=t.hardness,u=a.Color.fromArray(i.rgba),p={color:u,size:c};void 0!==l&&(p.hardness=l);var f=this._brushManager.getBrushByIdentifier(o);if(f||(f=this._brushManager.getFirstBrush()),f.prototype&&f.prototype instanceof d){return new f(p)}var h=a.SDKUtils.extend({},f);delete h.image;var m=function(e){function t(){return n(this,t),r(this,e.apply(this,arguments))}return s(t,e),t}(d);return m.identifier=f.identifier,new m(a.SDKUtils.extend({},h,p))},t.prototype._deserializeFrame=function(t,o){var i=this;return e.prototype._deserializeFrame.call(this,t,o).then(function(){var e=i._editor.operations.get("frame"),t=o.options,n=t.size,r=t.alpha,s=t.tintColor,c={};void 0!==n&&(c.scale=n),void 0!==r&&(c.alpha=r),void 0!==s&&(c.tintColor=a.Color.fromArray(s.rgba)),e.set(c)})},t}(l.default);t.default=m,m.version="3.0.0"},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=o(0),c=o(181),l=i(c),u=o(182),p=i(u),f=o(183),h=i(f),d=o(184),m=i(d),_=function(e){function t(){n(this,t);for(var o=arguments.length,i=Array(o),s=0;s<o;s++)i[s]=arguments[s];var a=r(this,e.call.apply(e,[this].concat(i)));return a._modalManager=a.props.modalManager,a._bindAll("_onModalManagerUpdate"),a}return s(t,e),t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this._modalManager.on("update",this._onModalManagerUpdate)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this._modalManager.off("update",this._onModalManagerUpdate)},t.prototype._onModalManagerUpdate=function(){this.forceUpdate()},t.prototype._onModalClosed=function(e){this._modalManager.removeModal(e)},t.prototype._renderModals=function(){var e=this;return this._modalManager.getModals().map(function(t){var o=void 0;switch(t.type){case"loading":o=l.default;break;case"warning":o=p.default;break;case"error":o=h.default;break;case"progress":o=m.default}return a.ReactBEM.createElement(o,{modal:t,onClose:e._onModalClosed.bind(e,t)})})},t.prototype.renderWithBEM=function(){return a.ReactBEM.createElement("div",null,this._renderModals())},t}(a.BaseComponent);t.default=_,_.contextTypes=a.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.renderWithBEM=function(){var e=this.props.modal;return s.ReactBEM.createElement("bem",{specifier:"$b:modals"},s.ReactBEM.createElement("div",{bem:"e:overlay"},s.ReactBEM.createElement("div",{bem:"e:modal m:loading"},s.ReactBEM.createElement("div",{bem:"e:text"},e.text))))},t}(s.BaseComponent);t.default=a,a.propTypes={modal:s.PropTypes.object},a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.renderWithBEM=function(){var e=this.props.modal;return s.ReactBEM.createElement("bem",{specifier:"$b:modals"},s.ReactBEM.createElement("div",{bem:"e:modal m:warning"},s.ReactBEM.createElement("div",{bem:"e:title"},e.title),s.ReactBEM.createElement("div",{bem:"e:text"},e.text),s.ReactBEM.createElement("div",{bem:"e:button b:button m:inline",onClick:this.props.onClose},"OK")))},t}(s.BaseComponent);t.default=a,a.propTypes={modal:s.PropTypes.object},a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){i(this,t);for(var o=arguments.length,r=Array(o),s=0;s<o;s++)r[s]=arguments[s];var a=n(this,e.call.apply(e,[this].concat(r)));return a._bindAll("_onClose"),a}return r(t,e),t.prototype._onClose=function(){this.props.modal.close()},t.prototype.renderWithBEM=function(){var e=this.props.modal,t=s.ReactBEM.createElement("div",{bem:"e:modal m:error"},s.ReactBEM.createElement("div",{bem:"e:title"},e.title),s.ReactBEM.createElement("div",{bem:"e:text"},e.text),s.ReactBEM.createElement("div",{bem:"e:button b:button m:inline",onClick:this._onClose},"OK")),o=e.overlay?s.ReactBEM.createElement("div",{bem:"e:overlay"},t):t;return s.ReactBEM.createElement("bem",{specifier:"$b:modals"},o)},t}(s.BaseComponent);t.default=a,a.propTypes={modal:s.PropTypes.object},a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=function(e){function t(){return i(this,t),n(this,e.apply(this,arguments))}return r(t,e),t.prototype.renderWithBEM=function(){var e=this.props.modal,t=e.data.progress,o={width:(100*(t||0)).toFixed(2)+"%"};return s.ReactBEM.createElement("bem",{specifier:"$b:modals"},s.ReactBEM.createElement("div",{bem:"e:overlay"},s.ReactBEM.createElement("div",{bem:"e:modal m:loading"},s.ReactBEM.createElement("div",{bem:"e:text"},e.text),s.ReactBEM.createElement("bem",{specifier:"b:loadingModal"},s.ReactBEM.createElement("div",{bem:"$e:progressBar"},s.ReactBEM.createElement("div",{bem:"e:progress",style:o}))))))},t}(s.BaseComponent);t.default=a,a.propTypes={modal:s.PropTypes.object},a.contextTypes=s.BaseComponent.contextTypes},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),a=o(42),c=function(e){return e&&e.__esModule?e:{default:e}}(a),l=function(e){function t(o,r,s){i(this,t);var a=n(this,e.call(this));return a._ui=o,a._options=r,a._mediator=s,a._assets={},a._editor=new c.default(o,r,s,!0),a._assets=["controls/back.png","controls/minus.png","controls/plus.png","controls/tick.png","controls/webcam/shutter.png","controls/knobs/remove.png","controls/knobs/resize-diagonal-down.png","controls/knobs/resize-diagonal-up.png","controls/knobs/rotate.png","editor/export.png","editor/new.png","editor/undo.png",["splash/photo-roll.png",!1,!0],["splash/webcam.png",!1,!0],"top-bar/back.png","close.png"],a._appendControlsAssets(),a}return r(t,e),t.prototype._appendControlsAssets=function(){var e=this._editor.controls.getAvailable();for(var t in e){var o=e[t];this._editor.controls.isEnabled(t)&&(this._assets=this._assets.concat(o.getPreloadAssets(this._editor)),this._assets.push(o.iconPath))}},t.prototype.load=function(){var e=this,t=this._assets.slice(),o=t.length,i=0,n=function(){i++,e.emit("progress",i/o),i===o&&e.emit("done")},r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"timed out";s.Log.warn("Preloader",e+" "+t+"."),n()},a=function(e){return window.setTimeout(function(){r(e)},5e3)};t.forEach(function(t){var o=!0,i=!0;s.SDKUtils.isArray(t)&&(i=t[2],o=t[1],t=t[0]);var c=e._ui.getAssetPath(t,i,!o),l=new window.Image,u=a(c);l.addEventListener("load",function(){e._assets[c]=l,window.clearTimeout(u),n()}),l.addEventListener("error",function(){window.clearTimeout(u),r(c,"was not found")}),l.crossOrigin="Anonymous",l.src=c})},t.prototype.getAsset=function(e){return this._assets[e]},t}(s.EventEmitter);t.default=l},function(e,t,o){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=o(187);Object.defineProperty(t,"Provider",{enumerable:!0,get:function(){return i(n).default}});var r=o(188);Object.defineProperty(t,"Library",{enumerable:!0,get:function(){return i(r).default}});var s=o(189);Object.defineProperty(t,"SearchSuggestion",{enumerable:!0,get:function(){return i(s).default}});var a=o(190);Object.defineProperty(t,"Photo",{enumerable:!0,get:function(){return i(a).default}})},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),r=function(){function e(){i(this,e)}return e.prototype.getLibraries=function(){return n.Log.warn(this.constructor.name,"`getLibraries` is abstract and not implemented."),n.Promise.resolve([])},e.prototype.getSearchSuggestions=function(){return n.Log.warn(this.constructor.name,"`getSearchSuggestions` is abstract and not implemented."),n.Promise.resolve([])},e.prototype.getPhotosForLibrary=function(e){return n.Log.warn(this.constructor.name,"`getPhotosForLibrary` is abstract and not implemented."),n.Promise.resolve([])},e.prototype.searchPhotos=function(e){return n.Log.warn(this.constructor.name,"`searchPhotos` is abstract and not implemented."),n.Promise.resolve([])},e}();t.default=r},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function e(t){i(this,e),this.name=t.name,this.coverImage=t.coverImage};t.default=n},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function e(t){i(this,e),this.query=t.query,this.name=this.query,this.coverImage=t.coverImage};t.default=n},function(e,t,o){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function e(t,o){i(this,e),this.library=t,this.title=o.title,this.urls=o.urls};t.default=n},function(e,t){e.exports={controls:{overview:{filters:"Filter",adjustments:"Korrekturen",transform:"Zuschneiden",blur:"Weichzeichnen",frame:"Rahmen",sticker:"Sticker",text:"Text",brush:"Malen",focus:"Focus","selective-blur":"Sel. Unschrfe"},text:{foreground:"Vordergrund",background:"Hintergrund",size:"Gre",font:"Schriftart",alignment:"Ausrichtung",takeToFront:"Nach oben",defaultText:"Doppelklick zum Bearbeiten!"},adjustments:{brightness:"Helligkeit",contrast:"Kontrast",saturation:"Sttigung",gamma:"Gamma",exposure:"Belichtung",shadows:"Schatten",highlights:"Lichter",clarity:"Klarheit"},transform:{none:"Original",rotation:"Drehung"},focus:{none:"Original",radial:"Kreisfrmig",mirrored:"Gespiegelt",blurRadius:"Radius"},selectiveBlur:{blurRadius:"Radius",size:"Dicke"},filters:{intensity:"Intensitt",filters:{identity:"Original"}},sticker:{flip:"Spiegeln","flip-v":"Spiegeln (V)","flip-h":"Spiegeln (H)",takeToFront:"Nach oben",categories:{all:"Alle"}},brush:{size:"Dicke",color:"Farbe"},frame:{noFrame:"Kein Rahmen",scale:"Gre"}},webcam:{headline:"Mache ein Foto!"},editor:{headline:"Foto editieren",new:"Neu",backgroundImage:"Hintergrundbild",undo:"Rckgngig",export:"Speichern",zoom:"Zoom"},splash:{upload:{button:"Lade ein Foto hoch",description:"Klicke hier, um ein Foto von deinem Rechner hochzuladen oder lade es per Drag-and-Drop hoch"},webcam:{headline:"Webcam",description:"Klicke hier, um ein Foto mit deiner Webcam zu machen"},photoRoll:{headline:"Kostenloses Bildmaterial",description:"Suche dir eines von tausenden Stock Photos aus."}},photoRoll:{search:{placeholder:"Nach Fotos suchen",noSearchResults:'Entschuldigung, aber wir konnten fr <strong>"${query}"</strong> leider keine Ergebnisse finden.',results:{headline:'Suchergebnisse fr "${query}"'}}},generic:{back:"Zurck",cancel:"Abbrechen",color:"Farbe"},loading:{resizing:"Bild wird bearbeitet...",exporting:"Exportiere...",loading:"Lade..."},warnings:{imageResized_maxMegaPixels:{title:"Bild verkleinert",text:"Da dein Bild die maximale Gre von ${maxMegaPixels} Megapixeln berschreitet, wurde es auf ${width}x${height} Pixel verkleinert."},imageResized_maxDimensions:{title:"Bild verkleinert",text:"Aufgrund von Hardware-Beschrnkungen wurde das Bild auf ${width}x${height} Pixel verkleinert."}},errors:{imageLoadFail:{title:"Bild konnte nicht geladen werden",text:"Beim Laden des Bildes unter ${path} ist ein Fehler aufgetreten."},webcamUnavailable:{title:"Webcam nicht verfgbar",text:"Webcam-Bild kann nicht dargestellt werden. (Fehler: ${error})"},webcamNotSupported:{title:"Webcam nicht untersttzt",text:"Dein Browser untersttzt das Webcam-Feature leider noch nicht."},renderingError:{title:"Rendering-Fehler",text:"Beim Rendern des Bildes ist ein Fehler aufgetreten."},context_lost:{title:"Es ist ein Fehler aufgetreten",text:"Dein Browser hat zu lange gebraucht, um das Bild zu generieren. Bitte versuche es noch einmal."},context_lost_limit:{title:"Es ist ein Fehler aufgetreten",text:"Bild-Generierung ist mehrmals fehlgeschlagen."},loadingStickersFailed:{title:"Laden der Sticker fehlgeschlagen"},loadingFontsFailed:{title:"Laden der Schriftarten fehlgeschlagen",text:"Einige Schriftarten sind mglicherweise nicht verfgbar."},photoRollLoadFail:{title:"Laden der Photo Roll fehlgeschlagen",text:"Die Photo Roll konnte nicht geladen werden: ${error}"},invalidFileType:{text:"Der Dateityp ${fileType} wird nicht untersttzt."},title:"Es ist ein Fehler aufgetreten"}}},function(e,t){e.exports={controls:{overview:{filters:"Filters",adjustments:"Adjust",transform:"Transform",focus:"Focus",frame:"Frame",sticker:"Sticker",text:"Text",brush:"Brush","selective-blur":"Selective Blur"},text:{foreground:"Foreground",background:"Background",size:"Size",font:"Font",alignment:"Alignment",takeToFront:"To Front",defaultText:"Double-click to edit"},adjustments:{brightness:"Brightness",contrast:"Contrast",saturation:"Saturation",exposure:"Exposure",gamma:"Gamma",shadows:"Shadows",highlights:"Highlights",clarity:"Clarity"},transform:{none:"Original",rotation:"Rotation"},focus:{none:"None",radial:"Radial",mirrored:"Mirrored",blurRadius:"Blur radius"},selectiveBlur:{blurRadius:"Blur radius",size:"Size"},filter:{intensity:"Intensity",filters:{identity:"None"}},sticker:{flip:"Flip","flip-v":"Flip (V)","flip-h":"Flip (H)",takeToFront:"To Front",categories:{all:"All"}},brush:{size:"Size",color:"Color"},frame:{noFrame:"No Frame",scale:"Scale"}},webcam:{headline:"Take a photo!"},editor:{headline:"Edit Photo",new:"New",backgroundImage:"Background Image",undo:"Undo",export:"Export",zoom:"Zoom"},splash:{upload:{button:"Upload your image",description:"Upload a picture from your library or just drag and drop"},webcam:{headline:"Webcam",description:"Take a picture with your webcam or phone"},photoRoll:{headline:"Free stock footage",description:"Select from thousands of Free Stock Photos"}},photoRoll:{search:{placeholder:"Search for photos",noSearchResults:'Sorry, but we couldn\'t find any photos for <strong>"${query}"</strong>.',results:{headline:'Search results for "${query}"'}}},generic:{back:"Back",cancel:"Cancel",color:"Color"},loading:{resizing:"Resizing...",exporting:"Exporting...",loading:"Loading..."},warnings:{imageResized_maxMegaPixels:{title:"Image resized",text:"Your image exceeds the maximum size of ${maxMegaPixels} megapixels and has therefore been resized to ${width}x${height} pixels."},imageResized_maxDimensions:{title:"Image resized",text:"Due to hardware limitations your image has been resized to ${width}x${height} pixels."}},errors:{imageLoadFail:{title:"Failed to load image",text:"Failed to load the image at ${path}"},webcamUnavailable:{title:"Webcam unavailable",text:"Unable to display webcam image (Error: ${error})"},webcamNotSupported:{title:"Webcam not supported",text:"The webcam feature is not supported by your browser."},renderingError:{title:"Error while rendering",text:"An error has occurred while rendering the image."},context_lost:{title:"An error has occurred",text:"Your browser took too long to render the image. Please try applying less operations."},context_lost_limit:{title:"An error has occurred",text:"Your browser failed multiple times while rendering the image."},loadingStickersFailed:{title:"Failed to load stickers"},loadingFontsFailed:{title:"Failed to load fonts",text:"Some fonts might not be available."},photoRollLoadFail:{title:"Failed to load Photo Roll",text:"Failed to load photos for the photo roll: ${error}"},invalidFileType:{text:"The file type ${fileType} is not supported."},title:"An error has occurred"}}}])});